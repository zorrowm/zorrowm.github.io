import{d as O,V as Y,O as G,i as H,j as W,k as E,a1 as J,M as K,a2 as D,e as X,aa as Z}from"./quasar-exp-BsaNoQ7w.js";import{A as $,P as ee,T as ae}from"./TopFunBar-DoB4Gx3Q.js";import{b as te,i as ne,j as oe,_ as le}from"./index-BQ7ovaqR.js";import{T as F}from"./TableEvent-Bxu_GHGl.js";import{d as re}from"./WidgetsTool-TGcRel5R.js";import{a as ie,S as se,D as I,G as de}from"./ApiExampleDemo-fezgN7i-.js";import{B as ue}from"./BaseContent-Bj_GXZNN.js";import{B as g,p as ce}from"./xframelib-exp-CMLeiWD4.js";import{r as s,d as me,c as Q,w as fe,o as pe,a as ge,b as f,f as C,a4 as l,j as r,k as be,e as v,F as ve,ab as we,ac as he,a7 as _e,v as ke,l as ye,a1 as Me}from"./@vue-exp-Bws36Ke9.js";import"./vendor-DJm_4oaR.js";import"./lottie-web-exp-CIY4INm7.js";import"./monaco-editor-exp-BNK_u0iZ.js";import"./xgis-cesium-exp-Hv7oMXHX.js";import"./vue-router-exp-CO9L2VdX.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-Q9Q0SWJB.js";const Se=[{value:"preview",name:"查看",icon:"ant-design:eye-outlined"},{value:"upload",name:"上传档案",icon:"ant-design:upload-outlined"},{value:"edit",name:"编辑",icon:"ant-design:form-outlined"},{value:"delete",name:"删除",icon:"ant-design:delete-outlined",isdelete:!0}],De=[{name:"查看关联对象",icon:"ant-design:apartment-outlined",value:"relateView"},{name:"发布服务",icon:"ant-design:aim-outlined",value:"publishService"},{name:"清理缓存",icon:"ant-design:clear-outlined",value:"clearCache"}];function Ce(){return Se}function Pe(){return De}const R=[{name:"id",align:"center",label:"索引",field:"id",sortable:!0},{name:"name",align:"center",label:"姓名",field:"name"},{name:"age",align:"center",label:"年龄",field:"age",sortable:!0},{name:"picture",required:!0,label:"照片",align:"center",field:"picture"},{name:"profile",required:!0,label:"档案",align:"center",field:"pid"},{name:"modifytime",required:!0,label:"更新时间",align:"center",field:"lastModified",format:d=>d?O.formatDate(d,"YYYY-MM-DD"):"无",sortable:!0},{name:"opt",align:"center",label:"操作",field:"opt"}],U=s([]);R.forEach(({name:d})=>{U.value.push(d)});const Be=me({name:"StandardTable",__name:"index",setup(d,{expose:u}){u();const w=te(),e=Q(()=>w.showTabMenu?"padding-bottom: 30px;":""),p=s({sortBy:"id",descending:!1,page:1,rowsPerPage:10}),m=s(1),t=s(0),c=Q(()=>Math.ceil(t.value/p.value.rowsPerPage)),h=s(""),_=s([]),k=s("");fe(()=>m.value,a=>{i()});let b="";const y=s(null);async function L(a){const n=a[0],o=await se(b,n);if(y.value?.reset(),o){g.Message.info("档案上传成功！"),i();return}g.Message.info("档案上传失败！")}function M(a,n){let o="",S;switch(a){case"add":o="addEditForm2",S={title:"新建",footer:"true"};break;case"edit":o="addEditForm2",S={title:"编辑",footer:"true"};break}o&&re({modalID:o,extraData:S,rowData:n,width:700})}function V(a){return[...Ce()]}function q(a){return Pe()}const z=async(a,n)=>{switch(g.Logger().trace("表格菜单点击",a,n),a){case"preview":break;case"upload":b=n.id,y.value?.pickFiles();break;case"edit":x(n);break;case"delete":const o=await I([n.id]);o&&o.data&&(i(),g.Message.info("删除成功"));break}},N=(a,n)=>{switch(a){case"searchWord":k.value=n,i();break;case"creatNew":T();break;case"batchDelete":B();break;case"refresh":i();break}},P=s([]);async function i(a=void 0){a&&(a.page&&(m.value=a.page),a.pageSize&&(p.value.rowsPerPage=a.pageSize));var n=await ie("",k.value,m.value,p.value.rowsPerPage).catch(o=>{});n&&n.response?.status==200&&(t.value=n.data.totalCount,P.value=n.data.datas),m.value>c.value&&(m.value=c.value)}async function B(){if(_.value.length>0){const a=_.value.map(o=>o.id),n=await I(a);n&&n.data&&(i(),g.Message.info("删除成功"))}}function T(){M("add",{name:"",age:10})}function x(a){M("edit",a)}async function j(a,n){const o=await de(a);o&&o.response?.status==200&&o.data&&ce(o.data,n)}pe(()=>{ne(F.RefeshTable,i),i()}),ge(()=>{oe(F.RefeshTable,i)});const A={appState:w,sizeStyle:e,pagination:p,currentPage:m,rowSum:t,pagesNumber:c,filter:h,selected:_,keywordRef:k,get currentSelectId(){return b},set currentSelectId(a){b=a},profileUploader2:y,UploadFileToProfile:L,showModal:M,getRightDefaultMenus:V,getRightMoreMenus:q,doActionClick:z,topBarClick:N,rows:P,query:i,batchDelete:B,add:T,edit:x,doDowload:j,ActionMenu:$,PaginationLine:ee,TopFunBar:ae,BaseContent:ue,get columns(){return R},get visibleColumns(){return U}};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),Te=["src"],xe={key:1},Ae={key:1},Ee={class:"full-width row justify-end"};function Fe(d,u,w,e,p,m){return f(),C(e.BaseContent,{class:"q-pa-sm",style:Me(e.sizeStyle)},{default:l(()=>[r(Y,{class:"fit sticky-header-table",selection:"multiple",selected:e.selected,"onUpdate:selected":u[1]||(u[1]=t=>e.selected=t),dense:d.$q.screen.lt.md,separator:"cell",flat:"",bordered:"",rows:e.rows,filter:e.filter,columns:e.columns,"row-key":"name","visible-columns":e.visibleColumns,pagination:e.pagination,"onUpdate:pagination":u[2]||(u[2]=t=>e.pagination=t)},{top:l(t=>[r(e.TopFunBar,{target:t,batch:e.selected.length===0,title:"服务列表",onTopBarClick:e.topBarClick},{rightAppend:l(()=>[be(r(G,{outlined:"",label:"自选列",icon:"view_list","no-wrap":""},{default:l(()=>[r(H,null,{default:l(()=>[(f(!0),v(ve,null,we(e.columns,c=>(f(),C(W,{tag:"label",key:c.name},{default:l(()=>[r(E,{avatar:""},{default:l(()=>[r(J,{modelValue:e.visibleColumns,"onUpdate:modelValue":u[0]||(u[0]=h=>e.visibleColumns=h),val:c.name},null,8,["modelValue","val"])]),_:2},1024),r(E,null,{default:l(()=>[r(K,null,{default:l(()=>[he(_e(c.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},512),[[ke,d.$q.screen.gt.sm]])]),_:2},1032,["target","batch"])]),"body-cell-picture":l(t=>[r(D,{props:t},{default:l(()=>[t.row.picture?(f(),v("img",{key:0,src:t.row.picture,width:"80",height:"80"},null,8,Te)):(f(),v("span",xe,"暂无"))]),_:2},1032,["props"])]),"body-cell-profile":l(t=>[r(D,{props:t},{default:l(()=>[t.row.pid?(f(),C(X,{key:0,label:"下载档案",color:"primary",onClick:c=>e.doDowload(t.row.id,t.row.pname)},null,8,["onClick"])):(f(),v("span",Ae,"暂无"))]),_:2},1032,["props"])]),"body-cell-opt":l(t=>[r(D,{props:t,"auto-width":!0},{default:l(()=>[r(e.ActionMenu,{currentRow:t.row,onDoActionClick:e.doActionClick,"default-menus":e.getRightDefaultMenus(t.row),"append-menus":e.getRightMoreMenus(t.row)},null,8,["currentRow","default-menus","append-menus"])]),_:2},1032,["props"])]),bottom:l(()=>[ye("div",Ee,[r(e.PaginationLine,{"rows-number":e.rowSum,"rows-per-page":e.pagination.rowsPerPage,max:e.pagesNumber},null,8,["rows-number","rows-per-page","max"])])]),_:1},8,["selected","dense","rows","filter","columns","visible-columns","pagination"]),r(Z,{ref:"profileUploader2","max-files":1,class:"hidden",accept:".doc, .docx, .pdf","field-name":"file",onAdded:e.UploadFileToProfile},null,512)]),_:1},8,["style"])}const Xe=le(Be,[["render",Fe],["__file","index.vue"]]);export{Xe as default};
