import{ct as H,cu as ie,bu as G,bw as J,bA as K,bB as Z,bC as Q,bc as se,bX as A,cv as re,cl as ue,bI as ce,bU as de,ci as me,c8 as fe,c4 as pe,cj as ge,c3 as _e,ck as F}from"./vendor-B1f7FUIB.js";import{d as S,c as x,r as _,$ as D,af as $,b as s,e as p,V as R,aa as z,k as y,f as h,a3 as i,l as v,j as a,a6 as V,g as L,ah as be,n as E,v as ee,w as ve,o as we,a as ke,ab as he,a0 as Ce}from"./@vue-exp-DMKPrOh0.js";import{_ as T,k as q,b as ye,i as Be,j as Me}from"./index-CvUQtR9N.js";import{B as Pe}from"./BaseContent-YPVzmYb3.js";import{B as X,p as Se}from"./xframelib-exp-B9KgMBHw.js";import{D as M}from"./DBService-CNScdGN7.js";import{T as P}from"./TableEvent-Bxu_GHGl.js";import{d as De}from"./WidgetsTool-D2n2VlBU.js";import"./@hprose-exp-BEudjurc.js";import"./pdfjs-dist-exp-C7mOU4gj.js";import"./vue-router-exp-DWvvxSx9.js";import"./axios-exp-B_zfNCMU.js";import"./@iconify/vue-exp-5llPk3YT.js";import"./WidgetsEvent-e0lOKT5_.js";const xe=S({__name:"ActionMenu",props:{defaultMenus:H().def([]),appendMenus:H().def([]),currentRow:ie().def(null)},emits:["doActionClick"],setup(u,{expose:t,emit:o}){t();const e=u,f=o,c=G(),n=x(()=>e.appendMenus.length>0),r=l=>{f("doActionClick",l.value,e.currentRow)},m=_(!1),b={props:e,emit:f,$q:c,hasAppendMenus:n,doClick:r,showing:m};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),Ve={class:"actionMenuLine"},Te={class:"row no-wrap items-center q-pa-sm"},Ie={key:0};function Ae(u,t,o,e,f,c){const n=D("Icon"),r=D("FVDropdown"),m=D("FVMenu"),b=$("tooltip");return s(),p("div",Ve,[(s(!0),p(R,null,z(o.defaultMenus,(l,w)=>y((s(),p("div",{key:w},[l.isdelete||l.value==="delete"?(s(),h(r,{key:0,placement:"bottom"},{popper:i(({hide:C})=>[v("div",Te,[t[0]||(t[0]=v("span",{class:"text-no-wrap"},"确认删除该条记录?",-1)),a(J,{flat:"",round:"",dense:"",color:"negative",icon:"delete",onClick:j=>C()&e.doClick(l)},null,8,["onClick"])])]),default:i(()=>[a(n,{icon:l.icon,class:"operationIcon"},null,8,["icon"])]),_:2},1024)):(s(),h(n,{key:1,icon:l.icon,class:"operationIcon",onClick:C=>e.doClick(l)},null,8,["icon","onClick"]))])),[[b,l.name]])),128)),e.hasAppendMenus?(s(),p("div",Ie,[a(m,{placement:"bottom-start",shown:e.showing},{popper:i(()=>[a(K,{style:{"min-width":"100px"}},{default:i(()=>[(s(!0),p(R,null,z(o.appendMenus,(l,w)=>(s(),h(Z,{key:w,clickable:"",onClick:C=>e.doClick(l)},{default:i(()=>[a(Q,{class:"moreMenuItem"},{default:i(()=>[a(n,{icon:l.icon,class:"operationIcon"},null,8,["icon"]),v("span",null,V(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:i(()=>[v("div",null,[a(n,{icon:"ic:baseline-more-horiz",class:"operationIcon"})])]),_:1},8,["shown"])])):L("",!0)])}const Fe=T(xe,[["render",Ae],["__scopeId","data-v-f22a159c"],["__file","ActionMenu.vue"]]),Ee=[{value:"preview",name:"查看",icon:"ant-design:eye-outlined"},{value:"edit",name:"编辑",icon:"ant-design:form-outlined"},{value:"delete",name:"删除",icon:"ant-design:delete-outlined",isdelete:!0}],qe=[{name:"查看关联对象",icon:"ant-design:apartment-outlined",value:"relateView"},{name:"发布服务",icon:"ant-design:aim-outlined",value:"publishService"},{name:"清理缓存",icon:"ant-design:clear-outlined",value:"clearCache"}];function Qe(){return Ee}function Re(){return qe}const ne=[{name:"id",align:"center",label:"索引",field:"id",sortable:!0},{name:"name",align:"center",label:"姓名",field:"name"},{name:"age",align:"center",label:"年龄",field:"age",sortable:!0},{name:"picture",required:!0,label:"照片",align:"center",field:"picture"},{name:"profile",required:!0,label:"档案",align:"center",field:"pid"},{name:"modifytime",required:!0,label:"更新时间",align:"center",field:"lastModified",format:u=>u?se.formatDate(u,"YYYY-MM-DD"):"无",sortable:!0},{name:"opt",align:"center",label:"操作",field:"opt"}],te=_([]);ne.forEach(({name:u})=>{te.value.push(u)});const ze=S({__name:"PaginationLine",props:{rowsNumber:A().isRequired,rowsPerPage:A().def(10),max:A().def(0)},setup(u,{expose:t}){t();const o=u,e=_([{label:"10条/页",value:10},{label:"20条/页",value:20},{label:"30条/页",value:30},{label:"50条/页",value:50},{label:"80条/页",value:80},{label:"100条/页",value:100}]),f=_({label:o.rowsPerPage+"条/页",value:o.rowsPerPage}),c=_(1),n=_(1),r=x(()=>o.max);function m(C){q(P.RefeshTable,{page:C})}function b(){q(P.RefeshTable,{page:1,pageSize:f.value.value})}function l(){n.value&&(c.value=n.value,q(P.RefeshTable,{page:c.value}))}const w={props:o,pageSizeOptions:e,pageSize:f,page:c,toPage:n,pages:r,changePagination:m,changePageSize:b,refreshTableData:l};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),Le={class:"q-pa-sm row items-center"},je={class:"row justify-center items-center"},Ne={class:"infoLine"},Oe=["max"];function Ue(u,t,o,e,f,c){return s(),p("div",Le,[v("div",je,[v("div",Ne,"总共 "+V(o.rowsNumber)+" 条",1),a(re,{borderless:"",modelValue:e.pageSize,"onUpdate:modelValue":[t[0]||(t[0]=n=>e.pageSize=n),e.changePageSize],options:e.pageSizeOptions,"option-value":"value","option-label":"label"},null,8,["modelValue","options"])]),a(ue,{modelValue:e.page,"onUpdate:modelValue":[t[1]||(t[1]=n=>e.page=n),e.changePagination],max:e.pages,"max-pages":6,ellipsess:"","direction-links":!0},null,8,["modelValue","max"]),t[3]||(t[3]=v("div",{class:"infoLine"},"转到",-1)),y(v("input",{class:"inputPage",type:"number","onUpdate:modelValue":t[2]||(t[2]=n=>e.toPage=n),max:e.pages,min:"1",onChange:e.refreshTableData},null,40,Oe),[[be,e.toPage]]),t[4]||(t[4]=v("div",{class:"infoLine"}," 页",-1))])}const Ye=T(ze,[["render",Ue],["__scopeId","data-v-484cbba5"],["__file","PaginationLine.vue"]]),We=S({__name:"TopFunBar",props:{title:{type:String,default:""},ifTask:{type:Boolean,default:!0},target:{type:Object,required:!0},batch:{type:Boolean,required:!0}},emits:["topBarClick"],setup(u,{expose:t,emit:o}){t();const e=G(),f=u,c=o,n=_("");function r(){e.dialog({title:"批量删除",message:"确认删除选中记录吗？",cancel:!0,persistent:!0}).onOk(()=>{m("batchDelete")}).onCancel(()=>{})}const m=l=>{l==="searchWord"?c("topBarClick",l,n.value):c("topBarClick",l)},b={$q:e,props:f,emit:c,searchValue:n,deleteConfirm:r,doClick:m};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),He={class:"row no-wrap full-width justify-center items-center"},Xe={class:"toptitle"},Ge={class:"q-gutter-xs row no-wrap items-center"},Je={key:1,class:"funBtn"},Ke={class:"funBtn"},Ze={class:"funBtn"};function $e(u,t,o,e,f,c){const n=D("Icon"),r=$("tooltip");return s(),p("div",He,[E(u.$slots,"left",{},()=>[v("div",Xe,V(o.title),1)],!0),a(ce),v("div",Ge,[E(u.$slots,"right",{},()=>[a(me,{clearable:"",outlined:"",dense:"",placeholder:"请输入关键字搜索",debounce:"300",modelValue:e.searchValue,"onUpdate:modelValue":[t[0]||(t[0]=m=>e.searchValue=m),t[1]||(t[1]=m=>e.doClick("searchWord"))]},{append:i(()=>[a(de,{name:"search"})]),_:1},8,["modelValue"]),o.ifTask?y((s(),p("div",{key:0,class:"funBtn",onClick:t[2]||(t[2]=m=>e.doClick("creatNew"))},[a(n,{icon:"ant-design:plus-outlined"})])),[[r,"新建"]]):L("",!0),o.ifTask?y((s(),p("div",Je,[o.batch?(s(),h(n,{key:0,icon:"ant-design:delete-outlined",disabled:""})):(s(),h(n,{key:1,icon:"ant-design:delete-outlined",onClick:e.deleteConfirm}))])),[[r,"批量删除"]]):L("",!0),y((s(),p("div",Ke,[a(n,{icon:"ant-design:sync-outlined",onClick:t[3]||(t[3]=m=>e.doClick("refresh"))})])),[[r,"刷新"]]),y((s(),p("div",Ze,[a(n,{icon:o.target.inFullscreen?"ant-design:fullscreen-exit-outlined":"ant-design:fullscreen-outlined",onClick:o.target.toggleFullscreen},null,8,["icon","onClick"])])),[[r,"刷新"],[ee,e.$q.screen.gt.sm]]),E(u.$slots,"rightAppend",{},void 0,!0)],!0)])])}const en=T(We,[["render",$e],["__scopeId","data-v-ce90b1ff"],["__file","TopFunBar.vue"]]),nn=S({name:"StandardTable"}),tn=S({...nn,setup(u,{expose:t}){t();const o=ye(),e=x(()=>o.showTabMenu?"padding-bottom: 30px;":""),f=_({sortBy:"id",descending:!1,page:1,rowsPerPage:10}),c=_(1),n=_(0),r=x(()=>Math.ceil(n.value/f.value.rowsPerPage)),m=_(""),b=_([]),l=_("");ve(()=>c.value,d=>{k()});function w(d,g){let B="",I;switch(d){case"add":B="addEditForm",I={title:"新建",footer:"true"};break;case"edit":B="addEditForm",I={title:"编辑",footer:"true"};break}B&&De({modalID:B,extraData:I,rowData:g,width:700})}function C(d){return[...Qe()]}function j(d){return Re()}const ae=(d,g)=>{switch(X.Logger().trace("表格菜单点击",d,g),d){case"preview":break;case"edit":Y(g);break;case"delete":M.deleteItem(g.id).then(B=>{k(),X.Message.info("删除成功")});break}},oe=(d,g)=>{switch(d){case"searchWord":l.value=g,k();break;case"creatNew":U();break;case"batchDelete":O();break;case"refresh":k();break}},N=_([]);async function k(d=void 0){d&&(d.page&&(c.value=d.page),d.pageSize&&(f.value.rowsPerPage=d.pageSize)),n.value=await M.getCount(),c.value>r.value&&(c.value=r.value),M.getPageList(l.value,c.value,f.value.rowsPerPage).then(g=>{N.value=g})}function O(){b.value.length>0&&M.batchDelete(b.value).then(()=>k())}function U(){w("add",{name:"",age:10})}function Y(d){w("edit",d)}async function le(d){const g=await M.getProfile(d);g&&Se(g.file,g.name)}we(()=>{Be(P.RefeshTable,k),k()}),ke(()=>{Me(P.RefeshTable,k)});const W={appState:o,sizeStyle:e,pagination:f,currentPage:c,rowSum:n,pagesNumber:r,filter:m,selected:b,keywordRef:l,showModal:w,getRightDefaultMenus:C,getRightMoreMenus:j,doActionClick:ae,topBarClick:oe,rows:N,query:k,batchDelete:O,add:U,edit:Y,doDowload:le,ActionMenu:Fe,BaseContent:Pe,get columns(){return ne},get visibleColumns(){return te},PaginationLine:Ye,TopFunBar:en};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),an=["src"],on={key:1},ln={key:1},sn={class:"full-width row justify-end"};function rn(u,t,o,e,f,c){return s(),h(e.BaseContent,{class:"q-pa-sm",style:Ce(e.sizeStyle)},{default:i(()=>[a(fe,{class:"fit sticky-header-table",selection:"multiple",selected:e.selected,"onUpdate:selected":t[1]||(t[1]=n=>e.selected=n),dense:u.$q.screen.lt.md,separator:"cell",flat:"",bordered:"",rows:e.rows,filter:e.filter,columns:e.columns,"row-key":"name","visible-columns":e.visibleColumns,pagination:e.pagination,"onUpdate:pagination":t[2]||(t[2]=n=>e.pagination=n)},{top:i(n=>[a(e.TopFunBar,{target:n,batch:e.selected.length===0,title:"服务列表",onTopBarClick:e.topBarClick},{rightAppend:i(()=>[y(a(pe,{outlined:"",label:"自选列",icon:"view_list","no-wrap":""},{default:i(()=>[a(K,null,{default:i(()=>[(s(!0),p(R,null,z(e.columns,r=>(s(),h(Z,{tag:"label",key:r.name},{default:i(()=>[a(Q,{avatar:""},{default:i(()=>[a(ge,{modelValue:e.visibleColumns,"onUpdate:modelValue":t[0]||(t[0]=m=>e.visibleColumns=m),val:r.name},null,8,["modelValue","val"])]),_:2},1024),a(Q,null,{default:i(()=>[a(_e,null,{default:i(()=>[he(V(r.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},512),[[ee,u.$q.screen.gt.sm]])]),_:2},1032,["target","batch"])]),"body-cell-picture":i(n=>[a(F,{props:n},{default:i(()=>[n.row.picture?(s(),p("img",{key:0,src:n.row.picture,width:"80",height:"80"},null,8,an)):(s(),p("span",on,"暂无"))]),_:2},1032,["props"])]),"body-cell-profile":i(n=>[a(F,{props:n},{default:i(()=>[n.row.pid?(s(),h(J,{key:0,label:"下载档案",color:"primary",onClick:r=>e.doDowload(n.row.pid)},null,8,["onClick"])):(s(),p("span",ln,"暂无"))]),_:2},1032,["props"])]),"body-cell-opt":i(n=>[a(F,{props:n,"auto-width":!0},{default:i(()=>[a(e.ActionMenu,{currentRow:n.row,onDoActionClick:e.doActionClick,"default-menus":e.getRightDefaultMenus(n.row),"append-menus":e.getRightMoreMenus(n.row)},null,8,["currentRow","default-menus","append-menus"])]),_:2},1032,["props"])]),bottom:i(()=>[v("div",sn,[a(e.PaginationLine,{"rows-number":e.rowSum,"rows-per-page":e.pagination.rowsPerPage,max:e.pagesNumber},null,8,["rows-number","rows-per-page","max"])])]),_:1},8,["selected","dense","rows","filter","columns","visible-columns","pagination"])]),_:1},8,["style"])}const Bn=T(tn,[["render",rn],["__file","index.vue"]]);export{Bn as default};
