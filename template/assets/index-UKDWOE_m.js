import{d as U,U as j,O as z,i as H,j as Y,k as S,a1 as $,M as O,a2 as h,e as W}from"./quasar-exp-B7YDMHDE.js";import{r as i,d as G,c as C,w as J,o as K,a as X,b as s,f as k,a3 as n,i as l,I as g,j as Z,e as v,F as ee,a9 as ae,n as te,aa as ne,a6 as le,v as oe,k as re,a0 as ie}from"./@vue-exp-CzdoyapG.js";import{T as se,A as ue,P as de}from"./TopFunBar-uic0jLak.js";import{_ as ce}from"./BaseContent.vue_vue_type_script_setup_true_lang-CHGumBnk.js";import{b as me,i as fe,j as pe}from"./index-DylLUN-r.js";import{W as T,H as ge}from"./xframelib-exp-uSJ3EBow.js";import{D as f}from"./DBService-DJHD52el.js";import{T as B}from"./TableEvent-Bxu_GHGl.js";import{d as ve}from"./WidgetsTool-D0-2VvAI.js";import"./vendor-CSzZZ-de.js";import"./lottie-web-exp-CIY4INm7.js";import"./monaco-editor-exp-BNK_u0iZ.js";import"./vue-router-exp-B23Vo4Jw.js";import"./xgis-cesium-exp-Cbv1lISI.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-BLEeEXwl.js";import"./dexie-exp-BSZCzc8U.js";const be=[{value:"preview",name:"查看",icon:"ant-design:eye-outlined"},{value:"edit",name:"编辑",icon:"ant-design:form-outlined"},{value:"delete",name:"删除",icon:"ant-design:delete-outlined",isdelete:!0}],we=[{name:"查看关联对象",icon:"ant-design:apartment-outlined",value:"relateView"},{name:"发布服务",icon:"ant-design:aim-outlined",value:"publishService"},{name:"清理缓存",icon:"ant-design:clear-outlined",value:"clearCache"}];function he(){return be}function ke(){return we}const y=[{name:"id",align:"center",label:"索引",field:"id",sortable:!0},{name:"name",align:"center",label:"姓名",field:"name"},{name:"age",align:"center",label:"年龄",field:"age",sortable:!0},{name:"picture",required:!0,label:"照片",align:"center",field:"picture"},{name:"profile",required:!0,label:"档案",align:"center",field:"pid"},{name:"modifytime",required:!0,label:"更新时间",align:"center",field:"lastModified",format:d=>d?U.formatDate(d,"YYYY-MM-DD"):"无",sortable:!0},{name:"opt",align:"center",label:"操作",field:"opt"}],p=i([]);y.forEach(({name:d})=>{p.value.push(d)});const ye=["src"],_e={key:1},De={key:1},Me={class:"full-width row justify-end"},je=G({name:"StandardTable",__name:"index",setup(d){const Q=me(),x=C(()=>Q.showTabMenu?"padding-bottom: 30px;":""),u=i({sortBy:"id",descending:!1,page:1,rowsPerPage:10}),c=i(1),b=i(0),w=C(()=>Math.ceil(b.value/u.value.rowsPerPage)),I=i(""),m=i([]),_=i("");J(()=>c.value,a=>{o()});function D(a,t){let e="",r;switch(a){case"add":e="addEditForm",r={title:"新建",footer:"true"};break;case"edit":e="addEditForm",r={title:"编辑",footer:"true"};break}e&&ve({modalID:e,extraData:r,rowData:t,width:700})}function R(a){return[...he()]}function q(a){return ke()}const A=(a,t)=>{switch(T.Logger().trace("表格菜单点击",a,t),a){case"preview":break;case"edit":F(t);break;case"delete":f.deleteItem(t.id).then(e=>{o(),T.Message.info("删除成功")});break}},E=(a,t)=>{switch(a){case"searchWord":_.value=t,o();break;case"creatNew":V();break;case"batchDelete":L();break;case"refresh":o();break}},M=i([]);async function o(a=void 0){a&&(a.page&&(c.value=a.page),a.pageSize&&(u.value.rowsPerPage=a.pageSize)),b.value=await f.getCount(),c.value>w.value&&(c.value=w.value),f.getPageList(_.value,c.value,u.value.rowsPerPage).then(t=>{M.value=t})}function L(){m.value.length>0&&f.batchDelete(m.value).then(()=>o())}function V(){D("add",{name:"",age:10})}function F(a){D("edit",a)}async function N(a){const t=await f.getProfile(a);t&&ge(t.file,t.name)}return K(()=>{fe(B.RefeshTable,o),o()}),X(()=>{pe(B.RefeshTable,o)}),(a,t)=>(s(),k(ce,{class:"q-pa-sm",style:ie(x.value)},{default:n(()=>[l(j,{class:"fit sticky-header-table",selection:"multiple",selected:m.value,"onUpdate:selected":t[1]||(t[1]=e=>m.value=e),dense:a.$q.screen.lt.md,separator:"cell",flat:"",bordered:"",rows:M.value,filter:I.value,columns:g(y),"row-key":"name","visible-columns":g(p),pagination:u.value,"onUpdate:pagination":t[2]||(t[2]=e=>u.value=e)},{top:n(e=>[l(se,{target:e,batch:m.value.length===0,title:"服务列表",onTopBarClick:E},{rightAppend:n(()=>[Z(l(z,{outlined:"",label:"自选列",icon:"view_list","no-wrap":""},{default:n(()=>[l(H,null,{default:n(()=>[(s(!0),v(ee,null,ae(g(y),r=>(s(),k(Y,{tag:"label",key:r.name},{default:n(()=>[l(S,{avatar:""},{default:n(()=>[l($,{modelValue:g(p),"onUpdate:modelValue":t[0]||(t[0]=P=>te(p)?p.value=P:null),val:r.name},null,8,["modelValue","val"])]),_:2},1024),l(S,null,{default:n(()=>[l(O,null,{default:n(()=>[ne(le(r.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},512),[[oe,a.$q.screen.gt.sm]])]),_:2},1032,["target","batch"])]),"body-cell-picture":n(e=>[l(h,{props:e},{default:n(()=>[e.row.picture?(s(),v("img",{key:0,src:e.row.picture,width:"80",height:"80"},null,8,ye)):(s(),v("span",_e,"暂无"))]),_:2},1032,["props"])]),"body-cell-profile":n(e=>[l(h,{props:e},{default:n(()=>[e.row.pid?(s(),k(W,{key:0,label:"下载档案",color:"primary",onClick:r=>N(e.row.pid)},null,8,["onClick"])):(s(),v("span",De,"暂无"))]),_:2},1032,["props"])]),"body-cell-opt":n(e=>[l(h,{props:e,"auto-width":!0},{default:n(()=>[l(ue,{currentRow:e.row,onDoActionClick:A,"default-menus":R(e.row),"append-menus":q(e.row)},null,8,["currentRow","default-menus","append-menus"])]),_:2},1032,["props"])]),bottom:n(()=>[re("div",Me,[l(de,{"rows-number":b.value,"rows-per-page":u.value.rowsPerPage,max:w.value},null,8,["rows-number","rows-per-page","max"])])]),_:1},8,["selected","dense","rows","filter","columns","visible-columns","pagination"])]),_:1},8,["style"]))}});export{je as default};
