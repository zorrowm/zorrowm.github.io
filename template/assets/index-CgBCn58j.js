import{d as H,U as Y,O as $,i as G,j as O,k as C,a1 as W,M as J,a2 as k,e as K,aa as X}from"./quasar-exp-B7YDMHDE.js";import{r,d as Z,c as x,w as ee,o as ae,a as te,b as s,f as y,a3 as n,i as l,I as g,j as ne,e as v,F as le,a9 as oe,n as re,aa as ie,a6 as se,v as ue,k as de,a0 as ce}from"./@vue-exp-CzdoyapG.js";import{T as me,A as fe,P as pe}from"./TopFunBar-uic0jLak.js";import{b as ge,i as ve,j as be}from"./index-DylLUN-r.js";import{T as B}from"./TableEvent-Bxu_GHGl.js";import{d as we}from"./WidgetsTool-D0-2VvAI.js";import{a as he,S as ke,D as Q,G as ye}from"./ApiExampleDemo-RYYSybrp.js";import{_ as _e}from"./BaseContent.vue_vue_type_script_setup_true_lang-CHGumBnk.js";import{W as f,H as Me}from"./xframelib-exp-uSJ3EBow.js";import"./vendor-CSzZZ-de.js";import"./lottie-web-exp-CIY4INm7.js";import"./monaco-editor-exp-BNK_u0iZ.js";import"./xgis-cesium-exp-Cbv1lISI.js";import"./vue-router-exp-B23Vo4Jw.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-BLEeEXwl.js";const De=[{value:"preview",name:"查看",icon:"ant-design:eye-outlined"},{value:"upload",name:"上传档案",icon:"ant-design:upload-outlined"},{value:"edit",name:"编辑",icon:"ant-design:form-outlined"},{value:"delete",name:"删除",icon:"ant-design:delete-outlined",isdelete:!0}],Se=[{name:"查看关联对象",icon:"ant-design:apartment-outlined",value:"relateView"},{name:"发布服务",icon:"ant-design:aim-outlined",value:"publishService"},{name:"清理缓存",icon:"ant-design:clear-outlined",value:"clearCache"}];function Pe(){return De}function Te(){return Se}const _=[{name:"id",align:"center",label:"索引",field:"id",sortable:!0},{name:"name",align:"center",label:"姓名",field:"name"},{name:"age",align:"center",label:"年龄",field:"age",sortable:!0},{name:"picture",required:!0,label:"照片",align:"center",field:"picture"},{name:"profile",required:!0,label:"档案",align:"center",field:"pid"},{name:"modifytime",required:!0,label:"更新时间",align:"center",field:"lastModified",format:d=>d?H.formatDate(d,"YYYY-MM-DD"):"无",sortable:!0},{name:"opt",align:"center",label:"操作",field:"opt"}],p=r([]);_.forEach(({name:d})=>{p.value.push(d)});const Ce=["src"],xe={key:1},Be={key:1},Qe={class:"full-width row justify-end"},Oe=Z({name:"StandardTable",__name:"index",setup(d){const I=ge(),U=x(()=>I.showTabMenu?"padding-bottom: 30px;":""),u=r({sortBy:"id",descending:!1,page:1,rowsPerPage:10}),c=r(1),b=r(0),w=x(()=>Math.ceil(b.value/u.value.rowsPerPage)),A=r(""),m=r([]),M=r("");ee(()=>c.value,t=>{o()});let D="";const h=r(null);async function F(t){const a=t[0],e=await ke(D,a);if(h.value?.reset(),e){f.Message.info("档案上传成功！"),o();return}f.Message.info("档案上传失败！")}function S(t,a){let e="",i;switch(t){case"add":e="addEditForm2",i={title:"新建",footer:"true"};break;case"edit":e="addEditForm2",i={title:"编辑",footer:"true"};break}e&&we({modalID:e,extraData:i,rowData:a,width:700})}function R(t){return[...Pe()]}function q(t){return Te()}const E=async(t,a)=>{switch(f.Logger().trace("表格菜单点击",t,a),t){case"preview":break;case"upload":D=a.id,h.value?.pickFiles();break;case"edit":j(a);break;case"delete":const e=await Q([a.id]);e&&e.data&&(o(),f.Message.info("删除成功"));break}},L=(t,a)=>{switch(t){case"searchWord":M.value=a,o();break;case"creatNew":N();break;case"batchDelete":V();break;case"refresh":o();break}},P=r([]);async function o(t=void 0){t&&(t.page&&(c.value=t.page),t.pageSize&&(u.value.rowsPerPage=t.pageSize));var a=await he("",M.value,c.value,u.value.rowsPerPage).catch(e=>{});a&&a.response?.status==200&&(b.value=a.data.totalCount,P.value=a.data.datas),c.value>w.value&&(c.value=w.value)}async function V(){if(m.value.length>0){const t=m.value.map(e=>e.id),a=await Q(t);a&&a.data&&(o(),f.Message.info("删除成功"))}}function N(){S("add",{name:"",age:10})}function j(t){S("edit",t)}async function z(t,a){const e=await ye(t);e&&e.response?.status==200&&e.data&&Me(e.data,a)}return ae(()=>{ve(B.RefeshTable,o),o()}),te(()=>{be(B.RefeshTable,o)}),(t,a)=>(s(),y(_e,{class:"q-pa-sm",style:ce(U.value)},{default:n(()=>[l(Y,{class:"fit sticky-header-table",selection:"multiple",selected:m.value,"onUpdate:selected":a[1]||(a[1]=e=>m.value=e),dense:t.$q.screen.lt.md,separator:"cell",flat:"",bordered:"",rows:P.value,filter:A.value,columns:g(_),"row-key":"name","visible-columns":g(p),pagination:u.value,"onUpdate:pagination":a[2]||(a[2]=e=>u.value=e)},{top:n(e=>[l(me,{target:e,batch:m.value.length===0,title:"服务列表",onTopBarClick:L},{rightAppend:n(()=>[ne(l($,{outlined:"",label:"自选列",icon:"view_list","no-wrap":""},{default:n(()=>[l(G,null,{default:n(()=>[(s(!0),v(le,null,oe(g(_),i=>(s(),y(O,{tag:"label",key:i.name},{default:n(()=>[l(C,{avatar:""},{default:n(()=>[l(W,{modelValue:g(p),"onUpdate:modelValue":a[0]||(a[0]=T=>re(p)?p.value=T:null),val:i.name},null,8,["modelValue","val"])]),_:2},1024),l(C,null,{default:n(()=>[l(J,null,{default:n(()=>[ie(se(i.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},512),[[ue,t.$q.screen.gt.sm]])]),_:2},1032,["target","batch"])]),"body-cell-picture":n(e=>[l(k,{props:e},{default:n(()=>[e.row.picture?(s(),v("img",{key:0,src:e.row.picture,width:"80",height:"80"},null,8,Ce)):(s(),v("span",xe,"暂无"))]),_:2},1032,["props"])]),"body-cell-profile":n(e=>[l(k,{props:e},{default:n(()=>[e.row.pid?(s(),y(K,{key:0,label:"下载档案",color:"primary",onClick:i=>z(e.row.id,e.row.pname)},null,8,["onClick"])):(s(),v("span",Be,"暂无"))]),_:2},1032,["props"])]),"body-cell-opt":n(e=>[l(k,{props:e,"auto-width":!0},{default:n(()=>[l(fe,{currentRow:e.row,onDoActionClick:E,"default-menus":R(e.row),"append-menus":q(e.row)},null,8,["currentRow","default-menus","append-menus"])]),_:2},1032,["props"])]),bottom:n(()=>[de("div",Qe,[l(pe,{"rows-number":b.value,"rows-per-page":u.value.rowsPerPage,max:w.value},null,8,["rows-number","rows-per-page","max"])])]),_:1},8,["selected","dense","rows","filter","columns","visible-columns","pagination"]),l(X,{ref_key:"profileUploader2",ref:h,"max-files":1,class:"hidden",accept:".doc, .docx, .pdf","field-name":"file",onAdded:F},null,512)]),_:1},8,["style"]))}});export{Oe as default};
