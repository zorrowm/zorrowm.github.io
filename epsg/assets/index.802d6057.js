import{r as P,B as U}from"./xframelib-exp.e4d795a1.js";import{t as Z}from"./lodash-es-exp.d3c3d62f.js";import{d as C,a as y,o as S,b as F,g as e,e as V,C as m,a2 as G,a3 as W,y as q,D as u,j as Q,k as v,l as x,at as ee,aC as te,aD as oe,c as $,u as g,A as M,B as A,f as ne,v as ae}from"./vendor.de069ad6.js";import{_ as k}from"./index.f27a7adf.js";import{u as N}from"./vue-router-exp.aee9d5fb.js";import{e as R}from"./SpatialService.fe9450b1.js";import{l as I}from"./scrollRef.11fe2605.js";import{F as se,P as ie,V as ue,S as le,a as re,b as ce,c as de,t as pe}from"./ol-exp.3a6fa810.js";import{g as T,Y as j,k as _e,L as me,F as ve,D as fe}from"./xgis-ol-exp.3bd12352.js";import"./axios-exp.cd5cf947.js";import"./@iconify/vue-exp.b199edd5.js";const he=C({name:"SplitPanel",setup(){const n=y(null);let c,d;const t=Z(function(_){n.value&&(n.value.style.width=d+_.clientX-c+"px")},20),p=()=>{document.documentElement.style.userSelect="unset",document.documentElement.removeEventListener("mousemove",t),document.documentElement.removeEventListener("mouseup",p),P.dispatchWindowResize()};return{startDrag:_=>{c=_.clientX,n.value&&(d=parseInt(window.getComputedStyle(n.value).width,10)),document.documentElement.style.userSelect="none",document.documentElement.addEventListener("mousemove",t),document.documentElement.addEventListener("mouseup",p)},scalable:n}}});const Y=n=>(G("data-v-dac80ee6"),n=n(),W(),n),ge={class:"split-wrapper"},ye={ref:"scalable",class:"scalable"},we={class:"left-content"},xe=Y(()=>e("i",null,null,-1)),be=Y(()=>e("i",null,null,-1)),Se=[xe,be],Ee={class:"right-content"};function De(n,c,d,t,p,w){return S(),F("div",ge,[e("div",ye,[e("div",we,[V(n.$slots,"left-content",{},()=>[m("\u53F3\u8FB9\u5185\u5BB9\u533A")],!0)]),e("div",{ref:"separator",class:"separator",onMousedown:c[0]||(c[0]=(..._)=>n.startDrag&&n.startDrag(..._))},Se,544)],512),e("div",Ee,[V(n.$slots,"right-content",{},()=>[m("\u53F3\u8FB9\u5185\u5BB9\u533A")],!0)])])}const Fe=k(he,[["render",De],["__scopeId","data-v-dac80ee6"]]),L=n=>(G("data-v-df2ac719"),n=n(),W(),n),Ce={class:"info"},Be={class:"contentWords"},$e={style:{"margin-left":"10px"}},ke=L(()=>e("br",null,null,-1)),Le={key:0},Ve=L(()=>e("br",null,null,-1)),Me={class:"info2"},Ae=L(()=>e("span",null,"\u5B9A\u4E49:",-1)),Ie=C({__name:"leftEPSG",setup(n){const c=N(),d=Number(c.params.id),t=y(),p=y(""),w=l=>{R(d).then(a=>{a&&(t.value=a,t.value.revisionDate=ee(t.value.revisionDate).format("YYYY-MM-DD"),l==="1"?p.value=t.value.wkt:p.value=t.value.proj4)})},_=y("1"),E=l=>{w(l)},B=async()=>{P.copyText(p.value),U.Message?.msg("\u5DF2\u590D\u5236!")};q(()=>{w(),E(1)});function f(l){if(l){const a=l.split(",");if(a?.length===4)return a[0]+" , "+a[1]+" ; "+a[2]+" , "+a[3]}return""}return(l,a)=>{const s=te,b=oe;return S(),F("div",Ce,[e("div",null,[e("h4",null,u(t.value?.authority)+":"+u(t.value?.code),1),e("h5",null,u(t.value?.name),1),e("ul",Be,[e("li",null,[m("\u6570\u636E\u6E90\uFF1A"+u(t.value?.authority)+" ",1),e("span",$e,"\u7C7B\u578B\uFF1A"+u(t.value?.kind),1)]),e("li",null,[m("WGS84\u8303\u56F4:"),ke,m(" "+u(f(t.value?.bbox)),1)]),t.value?.pbox?(S(),F("li",Le,[m("\u6295\u5F71\u8303\u56F4:"),Ve,m(" "+u(f(t.value?.pbox)),1)])):Q("",!0),e("li",null,"\u5355\u4F4D\uFF1A"+u(t.value?.unit),1),e("li",null,"\u6765\u6E90: "+u(t.value?.source),1),e("li",null,"\u4FEE\u8BA2\u65E5\u671F\uFF1A"+u(t.value?.revisionDate),1)])]),e("div",Me,[e("div",{class:"dingyi"},[Ae,e("div",null,[e("a",{onClick:B,style:{"font-size":"16px"}},"\u590D\u5236\u6587\u672C")])]),v(b,{activeKey:_.value,"onUpdate:activeKey":a[0]||(a[0]=D=>_.value=D),"tab-position":"top",onChange:E},{default:x(()=>[v(s,{key:"1",tab:"OGC WKT"},{default:x(()=>[m(u(t.value?.wkt),1)]),_:1}),v(s,{key:"2",tab:"PROJ4","force-render":""},{default:x(()=>[m(u(t.value?.proj4),1)]),_:1})]),_:1},8,["activeKey"])])])}}});const Te=k(Ie,[["__scopeId","data-v-df2ac719"]]),je={style:{position:"relative"}},Pe={class:"topBarContent"},Ge={style:{"margin-left":"10px"}},We=C({__name:"mapView",setup(n){const c=N(),d=Number(c.params.id),t=y("EPSG:"+d),p=y(""),w=$(()=>`position:relative;width:100%;height:${I.value}px`),_=$(()=>T.drawTool),E=$(()=>T.measureTool),B=y(1);let f,l;const a=y();let s;function b(){if(s){const i=s.MapView;if(i){let o=i.getCenter();if(o){o=j.fromLonLat(o,l);const h=pe(o,4);p.value=`\u4E2D\u5FC3\u70B9:${h} `}}}}function D(){if(s===void 0||l===void 0)return;const i=f.bbox;if(i){const r=i.split(","),o=[+r[0],+r[1],+r[2],+r[3]],h=[[o[0],o[1]],[o[2],o[1]],[o[2],o[3]],[o[0],o[3]]],X=[new se({geometry:new ie([h])})],z=new ue({features:X}),O=new le({fill:new re({color:"rgba(255,0,0,.2)"}),stroke:new ce({color:"rgba(255,0,0,.2)",width:1})}),J=new de({source:z,style:O});s.map.addLayer(J),s.zoomToExtent(o),s.map.on("change:view",b),s.map.on("pointerdrag",b),s.MapView.on("change:resolution",b)}}R(d).then(i=>{if(i){f=i;const r=f.pbox??f.bbox;if(r){const o=r.split(","),h=[+o[0],+o[1],+o[2],+o[3]];l=j.getProjection({epsg:"EPSG:"+d,proj4:f.proj4,prjExtent:h}),s&&D()}}});function K(i){s=i.xmap,a.value=s,l&&D()}function H(i,r,o){if(s.map){const h=s.map.getView();h.setCenter([i,r]),o&&o>=0&&h.setZoom(o)}}return(i,r)=>(S(),F("div",{style:ne(g(w))},[v(g(fe),{viewHeight:g(I),viewWidth:B.value,initTDTLayers:["vec_c","cva_c"],onMapInited:K},{extendMenuGroup:x(()=>[e("div",je,[v(g(_e),{xmap:a.value,onLocate:H},null,8,["xmap"]),M(v(g(me),{xmap:a.value},null,8,["xmap"]),[[A,g(_)]]),M(v(g(ve),{xmap:a.value},null,8,["xmap"]),[[A,g(E)]])])]),_:1},8,["viewHeight","viewWidth"]),e("div",Pe,[e("span",null,u(t.value),1),e("span",Ge,u(p.value),1)])],4))}});const Ne=k(We,[["__scopeId","data-v-cef9632e"]]),Qe=C({__name:"index",setup(n){return(c,d)=>(S(),ae(Fe,null,{"left-content":x(()=>[v(Te)]),"right-content":x(()=>[v(Ne)]),_:1}))}});export{Qe as default};
