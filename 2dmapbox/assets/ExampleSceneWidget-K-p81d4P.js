import{a0 as P,a6 as j,a7 as A,a8 as T,a9 as G}from"./vendor-qEPl7M71.js";import{d as H,_ as Q}from"./index-XTFg7KW3.js";import{W as q}from"./WidgetsEvent-e0lOKT5_.js";import{B as o,f as N,n as R}from"./xframelib-exp-CBRV2soX.js";import{M as y}from"./MapTool-lkJYUbBB.js";import{d as U,a as _,o as J,C as V,M as d,D as K,K as O,e as f,_ as w,F as S,L as u,N as v,a6 as D,Y as X,a2 as k,a7 as z}from"./@vue-exp-Cbz_CXqa.js";import"./monaco-editor-exp-B01XOe8A.js";import"./vue-router-exp-U1sBIDGE.js";import"./axios-exp-B_zfNCMU.js";import"./@iconify/vue-exp-BeT9ZUzB.js";const Y=[{id:"1",label:"全球数据展示",type:"style",source:"https://map.gis.digsur.com/Resource/styles/%E5%85%A8%E7%90%83%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA/style.json?tk=undefined",img:"img/mapbox/全球.png"},{id:"2",label:"北京都市黑风格",type:"style",source:"https://map.gis.digsur.com/Resource/styles/China_DuShiHei/style.json?tk=undefined",img:"img/mapbox/都市黑.png"},{id:"3",label:"北京马卡龙风格",type:"style",source:"https://map.gis.digsur.com/Resource/styles/MaKaLong/style.json?tk=undefined",img:"img/mapbox/马卡龙.png"}],Z=U({__name:"ExampleSceneWidget",setup(L,{expose:n}){let l=_(""),t="ExampleSceneWidget",c="";function I(e){c=e.id}function i(e){t=e.pid,e.pid&&H(q.WidgetClosed,t)}let a;function m(e){let s="";return l.value&&e.id===l.value&&(s="cardSelected"),s}async function E(e){if(a||o.Message.info("地图配置未加载完成"),l.value===e.id){l.value="";const s=y.GetTDTBaseStyle([116.383125473,39.9114357]);s&&(y.UpdateStyleJson(o.map,s),GetMapLayer(s)),r&&(r=!1,a.off("click",h));return}l.value=e.id;try{switch(e.type){case"style":const s=await(await fetch(e.source)).json().catch(x=>{o.Message.info("地址存在问题")});s&&y.UpdateStyleJson(a,s);break;case"image":id=1;break;case"vector":id=2;break;default:o.Message.err("该类型暂不支持");return}r=!0,a.on("click",h)}catch{o.Message.err("该示例加载失败"),l.value=""}}let r=!1;const b=_(!1),g=_([]);function h(e){var s=a.queryRenderedFeatures(e.point);if(s&&s.length>0)if(g.value.length=0,s.forEach(p=>{if(p.properties&&Object.keys(p.properties).length>0){const F=[];for(var W in p.properties)F.push({key:W,value:p.properties[W]});g.value.push({id:p.layer.id,properties:F})}else g.value.push({id:p.layer.id,properties:[]})}),g.value.length==0)o.Message.info("点击要素暂无信息");else{var x=document.getElementById("clickFeaturePopup");x&&(x.style.top=e.point.y+"px",x.style.left=e.point.x+"px"),b.value=!b.value}}J(()=>{o.map&&(a=o.map)}),V(()=>{if(l.value){l.value="";const e=y.GetTDTBaseStyle([116.383125473,39.9114357]);e&&(y.UpdateStyleJson(o.map,e),GetMapLayer(e))}r&&(r=!1,a.off("click",h))});const C=_(!0);function M(e=!1){C.value=e,c&&e&&R.openWindowPanel(c)}n({changeVisible:M,isShow:C});const B={get itemSelected(){return l},set itemSelected(e){l=e},get widgetID(){return t},set widgetID(e){t=e},get windowID(){return c},set windowID(e){c=e},loadedHandle:I,doClosePanel:i,get map(){return a},set map(e){a=e},getSelectedStyle:m,selectItem:E,get isEnable(){return r},set isEnable(e){r=e},visible:b,featuresInfo:g,GetFeatureInfo:h,isShow:C,changeVisible:M,get XWindow(){return N},get exampleList(){return Y}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),$={class:"row q-col-gutter-sm"},ee={class:"text-center textContent"},te={class:"row q-pa-sm justify-between items-center"},se={style:{"max-width":"300px","max-height":"400px",overflow:"auto"}};function ae(L,n,l,t,c,I){return u(),d(S,null,[K(f(t.XWindow,{isDark:!1,top:"10px",left:"10px",nWidth:"280px",hHeight:"350px",title:"示例",pid:"ExampleSceneWidget",onLoaded:t.loadedHandle,onClose:t.doClosePanel},{default:w(()=>[f(j,{style:{height:"100%"}},{default:w(()=>[v("div",$,[(u(!0),d(S,null,D(t.exampleList,(i,a)=>(u(),d("div",{class:"col-6",key:a},[f(A,{class:X(["cardContent",t.getSelectedStyle(i)]),onClick:m=>t.selectItem(i)},{default:w(()=>[f(T,{src:i.img,height:"75px"},null,8,["src"]),v("div",ee,k(i.label),1)]),_:2},1032,["class","onClick"])]))),128))])]),_:1})]),_:1},512),[[O,t.isShow]]),f(P,{"model-value":t.visible,target:"#clickFeaturePopup","transition-show":"flip-up","transition-hide":"flip-down",onHide:n[1]||(n[1]=i=>t.visible=!1)},{default:w(()=>[v("div",te,[n[2]||(n[2]=z(" 要素信息 ")),f(G,{class:"cursor-pointer",name:"close",onClick:n[0]||(n[0]=i=>t.visible=!1)})]),v("div",se,[(u(!0),d(S,null,D(t.featuresInfo,(i,a)=>(u(),d("div",{class:"q-pa-sm",key:a},[v("div",null," 图层名称:"+k(i.id),1),(u(!0),d(S,null,D(i.properties,(m,E)=>(u(),d("div",{key:E},k(m.key)+":"+k(m.value),1))),128))]))),128))])]),_:1},8,["model-value"])],64)}const me=Q(Z,[["render",ae],["__scopeId","data-v-4d5fef67"],["__file","ExampleSceneWidget.vue"]]);export{me as default};
