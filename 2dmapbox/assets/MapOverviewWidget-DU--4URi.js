import{O as h}from"./vendor-qEPl7M71.js";import{B as t}from"./xframelib-exp-CBRV2soX.js";import{d as x,o as M,a as N,C as S,M as C,D as O,K as E,N as k,L as z}from"./@vue-exp-Cbz_CXqa.js";import{_ as j}from"./index-8yyKnfk0.js";import"./axios-exp-B_zfNCMU.js";import"./@iconify/vue-exp-BeT9ZUzB.js";import"./monaco-editor-exp-B01XOe8A.js";import"./vue-router-exp-U1sBIDGE.js";const g="overview",W=x({__name:"MapOverviewWidget",setup(w,{expose:d}){d();let o;function n(){if(!o)return;const e=t.map.getZoom();o.getZoom()!=e-3&&o.setZoom(e-3);const a=t.map.getCenter();o.setCenter(a),u()}function m(){if(!t.map)return;const e=t.map.getStyle();o=new h.Map({container:g,style:e,center:e.center,zoom:e.zoom-3,attributionControl:!1,accessToken:"pk.eyJ1IjoiY2hyaXNuaW5nIiwiYSI6ImNrZzk3dmNveTA2cGUycXAyNXJ3bWNsOHMifQ._4oFj3iqj5yWWvbuONDYnw"}),t.overviewMap=o}async function p(){if(!t.map)return;const e=t.map.getBounds(),r=[[[e._sw.lng,e._ne.lat],[e._ne.lng,e._ne.lat],[e._ne.lng,e._sw.lat],[e._sw.lng,e._sw.lat],[e._sw.lng,e._ne.lat]]],a=await window.turfAsync.polygon(r);o.addSource("mainExtent",{type:"geojson",data:a}),o.addLayer({id:"mainExtent",type:"fill",source:"mainExtent",paint:{"fill-color":"red","fill-opacity":.3,"fill-outline-color":"red"},layout:{visibility:"visible"}}),o.scrollZoom.disable(),o.dragPan.disable(),o.on("mousedown","mainExtent",function(l){o.on("mousemove",i),o.once("mouseup",_)}),o.on("touchstart","mainExtent",function(l){o.on("touchmove",i),o.once("touchend",_)}),t.map.on("drag",n),t.map.on("zoom",n)}async function u(){if(!t.map)return;const e=t.map.getBounds(),r=[[[e._sw.lng,e._ne.lat],[e._ne.lng,e._ne.lat],[e._ne.lng,e._sw.lat],[e._sw.lng,e._sw.lat],[e._sw.lng,e._ne.lat]]],a=await window.turfAsync.polygon(r);if(o){const l=o.getSource("mainExtent"),b={type:"FeatureCollection",features:[a]};l&&l.setData(b)}}function i(e){u();var r=e.lngLat,a=t.map.getCanvasContainer();a.style.cursor="grab",t.map.setCenter(r)}function _(e){o.off("mousemove",i),o.off("touchmove",i)}function f(){m(),setTimeout(()=>{p()},300)}M(()=>{f()});const s=N(!0);let c="keyboard_double_arrow_left";const y=()=>{s.value=!s.value,s.value?c="keyboard_double_arrow_right":c="keyboard_double_arrow_left"};S(()=>{t.map&&(t.map.off("drag",n),t.map.off("zoom",n)),o&&(o.remove(),o=void 0)});const v={mapid:g,get overviewMap(){return o},set overviewMap(e){o=e},onDragZoomHandler:n,init:m,initOverview:p,changeExtent:u,onMove:i,onUp:_,LoadMap:f,isShow:s,get iconName(){return c},set iconName(e){c=e},toggleShow:y};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),B={class:"overviewContanier"},Z={id:"overview"};function D(w,d,o,n,m,p){return z(),C("div",B,[O(k("div",Z,null,512),[[E,n.isShow]])])}const $=j(W,[["render",D],["__scopeId","data-v-10766e14"],["__file","MapOverviewWidget.vue"]]);export{$ as default};
