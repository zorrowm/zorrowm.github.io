import{_ as I,f as T,b as P}from"./index.e6271ee2.js";import{d as R,r as E,l as y,o as V,M as C,N as G,Q as n,Z as m,q as v,a7 as S,a8 as B}from"./@vue-exp.a4e706db.js";import{P as F,Q as A}from"./vendor.d3cc975b.js";import{M as o,b as f,c as D,f as O,G as U,l as $,a as x,u as N,p as q}from"./xframelib-exp.54ed976b.js";import{_ as H}from"./logo.3da8610b.js";import"./ant-design-vue-exp.fcd30b7a.js";import"./lodash-es-exp.01017e5f.js";import"./axios-exp.e066e043.js";import"./@hprose-exp.37e63ca6.js";const L="ee8c674b066737ab15fceca4bba78669",j="\u540E\u53F0\u4E1A\u52A1\u670D\u52A1\u5E73\u53F0",z="YSServiceAPIPlatform",J="0.0.1",K=[{path:"/",name:"BackLayout",title:"",type:1,children:[{path:"/hprose",name:"hprose",title:"HproseAPI\u5728\u7EBF\u6D4B\u8BD5",type:0,index:0},{path:"webapi",name:"webapi",title:"SwaggerAPI\u751F\u6210",type:0,index:1}]}],Q=[{name:"\u6F2B\u6E38",index:0,type:0,children:[{name:"\u98DE\u884C",path:"flyGroupMenuWidget",type:0,children:[{name:"\u5168\u7403\u65CB\u8F6C",path:"earthRotationWidget",type:0},{name:"\u4E2D\u5FC3\u70B9\u65CB\u8F6C",path:"centerRotationWidget",type:0}]},{name:"\u89C6\u89D2",path:"viewGroupMenuWidget",type:0,children:[{name:"\u5168\u7403",path:"globalViewWidget",type:0},{name:"\u5168\u56FD\u89C6\u89D2",path:"chinaViewWidget",type:0}]},{name:"\u5B9A\u4F4D",path:"locationWidget",type:0}]},{name:"\u89C6\u56FE",index:1,type:0,children:[{name:"\u56FE\u5C42\u7BA1\u7406",path:"layerManageWidget",type:0},{name:"\u5728\u7EBF\u5F71\u50CF\u5E95\u56FE",path:"imageBaseLayerWidget",type:0},{name:"\u56FE\u5C42\u5377\u5E18",path:"splitWidget",type:0},{name:"\u5206\u5C4F\u6D4B\u8BD5",path:"twoViewWidget",type:0}]},{name:"\u5730\u5F62",index:10,type:0,children:[{name:"\u5730\u5F62\u6570\u636E\u6E90",path:"demSourceWidget",type:0,children:[{name:"\u663E\u793A\u5730\u7403",path:"showWidget",type:0},{name:"\u5730\u5F62\u5149\u7167",path:"terrainlightWidget",type:0},{name:"\u6DF1\u5EA6\u68C0\u6D4B",path:"depthmeasurementWidget",type:0},{name:"\u5730\u5F62\u5938\u5F20",path:"terrainhyperboleWidget",type:0},{name:"\u5730\u4E0B\u6A21\u5F0F",path:"undergroundmodeWidget",type:0},{name:"\u4E09\u89D2\u7F51",path:"networkWidget",type:0},{name:"\u5730\u8868\u4E0D\u900F\u660E",path:"notransparencyWidget",type:0},{name:"\u5730\u8868\u900F\u660E",path:"transparencyWidget",type:0},{name:"\u9AD8\u7A0B",path:"elevationWidget",type:0},{name:"\u5761\u5EA6",path:"slopeWidget",type:0},{name:"\u5761\u5411",path:"exposureWidget",type:0},{name:"\u7B49\u9AD8\u7EBF",path:"contourlineWidget",type:0},{name:"\u5730\u5F62\u88C1\u526A",path:"terraincuttingWidget",type:0},{name:"\u52A0\u8F7D\u5730\u5F62",path:"loadterrain",type:0}]},{name:"\u53EF\u89C6\u5316\u8BBE\u7F6E",path:"demSettingWidget",type:0}]},{name:"\u6548\u679C",index:20,type:0,children:[{name:"\u5929\u6C14",path:"weatherMenuWidget",type:0,children:[{name:"\u96E8",path:"rainWidget",type:0},{name:"\u96EA",path:"snowWidget",type:0},{name:"\u96FE",path:"fog1Widget",type:0},{name:"\u5168\u5C4F\u96FE",path:"fogWidget",type:0},{name:"\u4E91",path:"cloudWidget",type:0},{name:"\u98CE",path:"windyWidget",type:0},{name:"\u661F\u7A7A",path:"ControlSkyVisible",type:3},{name:"\u592A\u9633",path:"sunWidget",type:0},{name:"\u5927\u6C14",path:"atmosphereWidget",type:0}]},{name:"\u77E2\u91CF\u6570\u636E",path:"vectorMenuWidget",type:0,children:[{name:"kml\u6570\u636E",path:"kmlWidget",type:0},{name:"czml\u6570\u636E",path:"czmlWidget",type:0},{name:"topoJSON\u6570\u636E",path:"topojsonWidget",type:0},{name:"geoJSON\u6570\u636E",path:"geojsonWidget",type:0}]},{name:"\u6805\u683C\u6570\u636E",path:"rasterMenuWidget",type:0,children:[{name:"OGC WMTS\u670D\u52A1",path:"wmtsWidget",type:0},{name:"OGC WMS\u670D\u52A1",path:"wmsWidget",type:0},{name:"ArcGIS \u74E6\u7247",path:"arcgisWidget",type:0}]}]},{name:"\u6807\u7ED8",index:21,path:"leftMenuWidget",type:0,children:[{name:"\u6807\u8BB0\u70B9",path:"markPointEdit",type:0},{name:"\u591A\u8FB9\u5F62",path:"polygonEdit",type:0},{name:"\u6298\u7EBF",path:"polylineEdit",type:0},{name:"\u5706\u5F62",path:"circleEdit",type:0},{name:"\u77E9\u5F62",path:"rectangleEdit",type:0},{name:"\u6E05\u7A7A",path:"removeEntities",type:0}]},{name:"demo",index:30,type:0,children:[{name:"GIF\u5E7F\u544A\u724C",path:"gifBillboardWidget",type:0},{name:"\u8F68\u8FF9\u98DE\u884C",path:"planeFlyWidget",type:0}]},{name:"\u793A\u4F8B",index:99,path:"rightMenuWidget",type:0},{name:"\u8BBE\u7F6E",index:100,path:"widgetSetting",type:0}];var Y={id:L,name:j,product:z,version:J,routes:K,widgetMenu:Q},Z="./img/login/name.png",X="./img/login/password.png";const ee=R({setup(){const e=o.t,t=E({username:"",password:""}),g=y(),c=y(),W=y(o.Config.UI?.SiteTitle),i=F(),a=A();let p=decodeURIComponent(a.query?.redirect||"/");const w=f();let h;if(w){D(w),i&&i.replace(p).then(l=>{a.name=="login"&&i.replace("/")});return}const _=async()=>{if(t.username.trim()===""||t.password.trim()=="")return o.Message?.warn(e("sys.login.loginEmtyWarnInfo"));let l={username:t.username.trim(),pwd:x.MD5(t.password)};const s=await N(l);if(!s){o.Message?.warn(e("sys.login.loginFailTitle"));return}if(s.isSuccess){const r=T();await q(r,o.Config.APIPath?.GET_AUTH_ROLE_RIGHT,void 0,Y)&&P()?.forEach(M=>{i.addRoute(M)});const d=decodeURIComponent(a.query?.redirect||"/");if(i)if(console.log(d,"toPath"),d.startsWith("http://")||d.startsWith("https://")){const u=f();window.open(d+"#/?tk="+u.token,"_self")}else i.replace(d).then(u=>{a.name=="login"&&i.replace("/")});o.Message?.msg(e("sys.login.loginSuccessTitle"))}else o.Message?.warn(s.ResultDescription||e("sys.login.loginFailTitle"))};V(async()=>{if(p&&(h=a.query?.tk?.toString()),h){const l=await O(h);console.log(l,"\u8F93\u51FAcheckToken\u7684\u7ED3\u679C00");const s=l?.data;if(s)if(s.isSuccess){U(s.resultValue),$(s.resultValue.doubleToken),o.Message?.msg(e("sys.login.loginSuccessTitle"));const r=f();r&&(p?.indexOf("?")>0?p+="&tk="+r.token:p+="?tk="+r.token,i.replace(p).then(b=>{a.name=="login"&&i.replace("/")}))}else o.Message?.warn(e("sys.login.loginTokenFailInfo"))}});function k(){g.value&&(g.value.placeholder=e("sys.login.accountPlaceholder")),c.value&&(c.value.placeholder=e("sys.login.passwordPlaceholder"))}return{formState:t,systemTitle:W,handleSubmit:_,t:e,onblur:k,nameInput:g,pwdInput:c}}}),te={class:"container"},ne={class:"login-logo"},ae=n("img",{src:H,alt:""},null,-1),ie={class:"login-title"},oe={class:"login"},se={class:"login-top"},pe={class:"login-center clearfix"},le=n("div",{class:"login-center-img"},[n("img",{src:Z})],-1),re={class:"login-center-input"},de=["placeholder"],me={class:"login-center-input-text"},ge={class:"login-center clearfix"},ce=n("div",{class:"login-center-img"},[n("img",{src:X})],-1),he={class:"login-center-input"},ue=["placeholder"],ye={class:"login-center-input-text"};function fe(e,t,g,c,W,i){return C(),G("div",te,[n("div",ne,[ae,n("span",ie,m(e.systemTitle),1)]),n("div",oe,[n("div",se,m(e.t("sys.login.signInFormTitle")),1),n("div",pe,[le,n("div",re,[v(n("input",{ref:"nameInput",type:"text",placeholder:e.t("sys.login.accountPlaceholder"),onfocus:"this.placeholder=''",onBlur:t[0]||(t[0]=a=>e.onblur()),"onUpdate:modelValue":t[1]||(t[1]=a=>e.formState.username=a)},null,40,de),[[S,e.formState.username]]),n("div",me,m(e.t("sys.login.userName")),1)])]),n("div",ge,[ce,n("div",he,[v(n("input",{ref:"pwdInput",type:"password",placeholder:e.t("sys.login.passwordPlaceholder"),onfocus:"this.placeholder=''",onBlur:t[2]||(t[2]=a=>e.onblur()),"onUpdate:modelValue":t[3]||(t[3]=a=>e.formState.password=a),onKeyup:t[4]||(t[4]=B((...a)=>e.handleSubmit&&e.handleSubmit(...a),["enter"]))},null,40,ue),[[S,e.formState.password]]),n("div",ye,m(e.t("sys.login.password")),1)])]),n("div",{class:"login-button",onClick:t[5]||(t[5]=(...a)=>e.handleSubmit&&e.handleSubmit(...a))},m(e.t("sys.login.loginButton")),1)])])}var Te=I(ee,[["render",fe]]);export{Te as default};
