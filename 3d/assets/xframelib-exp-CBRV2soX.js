import{M as de,W as ie,O as ge,a4 as Dn,S as Z,E as vr,_ as we,a5 as Fo,N as J,F as Ee,a6 as Be,X as ne,a as Y,d as Pe,L as X,D as yr,K as wr,a7 as Yt,a2 as on,a8 as Xo,e as lt,P as _r,a9 as ye,w as xe,r as Vo,c as Ne,o as sn,z as Ko,Y as ke,I as Yo,C as Go,u as At,b as Jo,V as mt,m as Qo,n as br,B as Zo}from"./@vue-exp-Cbz_CXqa.js";import{a as ei}from"./axios-exp-B_zfNCMU.js";import{B as Ie,W as Bn,R as Gt,V as ti,X as ni,C as Mt,H as ri,d as oi}from"./vendor-qEPl7M71.js";import{I as Pt}from"./@iconify/vue-exp-BeT9ZUzB.js";function Dt(n){return window.TouchEvent&&n instanceof TouchEvent}class ce{e;constructor(e){this.e=e}stopPropagation(){this.e.stopPropagation()}preventDefault(){this.e.preventDefault()}get clientX(){return Dt(this.e)?(this.e.type==="touchend"?this.e.changedTouches:this.e.touches).item(0).clientX:this.e.clientX}get clientY(){return Dt(this.e)?(this.e.type==="touchend"?this.e.changedTouches:this.e.touches).item(0).clientY:this.e.clientY}get clientCoord(){return new an(this.clientX,this.clientY)}static bindDown(e,t,r,o=!1){const i=c=>{t(new ce(c))},s=c=>{c.touches.length===1&&t(new ce(c)),c.touches.length>1&&r&&r(new ce(c))};return e.addEventListener("mousedown",i,o),e.addEventListener("touchstart",s,o),()=>{e.removeEventListener("mousedown",i,o),e.removeEventListener("touchstart",s,o)}}static bindMove(e,t,r=!1){const o=s=>{t(new ce(s))},i=s=>{s.touches.length===1&&t(new ce(s))};return e.addEventListener("mousemove",o,r),e.addEventListener("touchmove",i,r),()=>{e.removeEventListener("mousemove",o,r),e.removeEventListener("touchmove",i,r)}}static bindUp(e,t,r=!1){const o=s=>{t(new ce(s))},i=s=>{s.touches.length===0&&t(new ce(s))};return e.addEventListener("mouseup",o,r),e.addEventListener("touchend",i,r),()=>{e.removeEventListener("mouseup",o,r),e.removeEventListener("touchend",i,r)}}originalEvent({mouse:e,touch:t}){Dt(this.e)?t&&t(this.e):e&&e(this.e)}}class an{x;y;constructor(e,t){this.x=e,this.y=t}clone(){return new an(this.x,this.y)}}class ii{handle;container;options;unbindDown;unbindMove;unbindUp;constructor(e,t,r={}){this.handle=e,this.container=t,this.options=r,e&&(this.unbindDown=ce.bindDown(e,this.mousedown),e.classList.add("draggable-handle"))}teardown(){this.handle?.classList.remove("draggable-handle"),this.unbindDown&&this.unbindDown(),this.unbindUp&&this.unbindUp(),this.unbindMove&&this.unbindMove()}offsetX;offsetY;mousedown=e=>{e.preventDefault(),this.handle&&(this.offsetX=e.clientX,this.offsetY=e.clientY),this.options.onMoveStart&&this.options.onMoveStart(),this.unbindMove=ce.bindMove(document,this.mousemove),this.unbindUp=ce.bindUp(document,this.mouseup)};mousemove=e=>{this.container&&(this.container.style.left=`calc(${e.clientX-this.offsetX}px + ${this.container.style.left})`,this.container.style.top=`calc(${e.clientY-this.offsetY}px + ${this.container.style.top})`,this.offsetX=e.clientX,this.offsetY=e.clientY),this.options.onMove&&this.options.onMove()};mouseup=e=>{this.options.onMoveEnd&&this.options.onMoveEnd(),this.unbindUp(),this.unbindMove(),this.unbindUp=this.unbindMove=void 0}}class si{_group;onChange;zIndex;constructor(e,t){this._group=e,this.onChange=t,this.a(r=>r.push(this))}set group(e){this._group=e;const t=it(this._group),r=it(e);t.splice(t.indexOf(this),1),r.push(this),$n()}get group(){return this._group}unregister(){this.a(e=>e.splice(e.indexOf(this),1))}raise(){this.a(e=>{e.splice(e.indexOf(this),1),e.push(this)})}a(e){e(it(this._group)),$n()}}const ot=new Map;function it(n){return ot.has(n)||ot.set(n,[]),ot.get(n)}function Sr(n,e){return n>e?-Sr(e,n):n<0&&e>=0?1:n-e}function $n(){let n=0;for(const e of function(t){const r=[];return t.forEach((o,i)=>r.push(i)),r}(ot).sort(Sr))for(const t of it(e))n!=t.zIndex&&(t.zIndex=n,t.onChange(n)),n++}function Jt(n){if(n){const{width:e,height:t}=n.style;n.style.width="auto",n.style.height="auto";const r=st(n);return n.style.width=e,n.style.height=t,r}return{width:0,height:0,top:0,left:0,bottom:0,right:0}}function st(n){const e=n.getBoundingClientRect(),t=e.width,r=e.height,o=e.top,i=e.left;return{width:t,height:r,top:o,left:i,bottom:o+r,right:i+t}}class ai{container;options;handles;constructor(e,t){if(this.container=e,this.options=t,e&&t){this.handles=Cr.map(p=>new p(e,this));const{width:r,height:o}=Jt(e),i=t.maxWidth||window.innerWidth,s=t.maxHeight||window.innerHeight;let c=!1;(r<t.minWidth||r>i)&&(e.style.width=`${Nn(r,t.minWidth,i)}px`,c=!0),(o<t.minHeight||o>s)&&(e.style.height=`${Nn(o,t.minHeight,s)}px`,c=!0),c&&t.onResize&&t.onResize()}}teardown(){this.handles?.forEach(e=>e.teardown())}}const Cr=[];class Ce{container;helper;handle;handleSize=8;unbindDown;unbindMove;unbindUp;constructor(e,t){this.container=e,this.helper=t,this.handle=this.createHandleElement(),this.unbindDown=ce.bindDown(this.handle,this.mousedown)}teardown(){this.unbindDown(),this.unbindUp&&this.unbindUp(),this.unbindMove&&this.unbindMove(),this.handle.parentElement.removeChild(this.handle)}x0;y0;left0;top0;width0;height0;mousedown=e=>{e.preventDefault(),e.stopPropagation();const{left:t,top:r,width:o,height:i}=st(this.container);this.x0=e.clientX,this.y0=e.clientY,this.left0=t,this.top0=r,this.width0=o,this.height0=i,this.calcSafeBoundaries(),this.helper.options&&this.helper.options.onResizeStart&&this.helper.options.onResizeStart(),this.unbindMove=ce.bindMove(document,this.mousemove),this.unbindUp=ce.bindUp(document,this.mouseup)};minLeft;maxLeft;minRight;maxRight;minTop;maxTop;minBottom;maxBottom;calcSafeBoundaries(){if(!this.helper.options)return;const{left:e,top:t,right:r,bottom:o}=st(this.container),i=this.helper.options,s=i.maxWidth||window.innerWidth,c=i.maxHeight||window.innerHeight;this.minLeft=Math.max(r-s,0),this.maxLeft=r-i.minWidth,this.minRight=e+i.minWidth,this.maxRight=Math.min(e+s,window.innerWidth),this.minTop=Math.max(o-c,0),this.maxTop=o-i.minHeight,this.minBottom=t+i.minHeight,this.maxBottom=Math.min(t+c,window.innerHeight)}mousemove=e=>{e.preventDefault(),e.stopPropagation(),this.setPosition(e),this.fixPosition(),this.helper.options&&this.helper.options.onResize&&this.helper.options.onResize()};fixPosition(){const{width:e,height:t,left:r,top:o,right:i,bottom:s}=st(this.container),c=this.helper.options;c&&(r<this.minLeft?(this.container.style.width=e+r-this.minLeft+"px",this.container.style.left=`${this.minLeft}px`):r>this.maxLeft?(this.container.style.width=`${c.minWidth}px`,this.container.style.left=`${this.maxLeft}px`):i<this.minRight?this.container.style.width=`${c.minWidth}px`:i>this.maxRight&&(this.container.style.width=this.maxRight-r+"px"),o<this.minTop?(this.container.style.height=t+o-this.minTop+"px",this.container.style.top=`${this.minTop}px`):o>this.maxTop?(this.container.style.height=`${c.minHeight}px`,this.container.style.top=`${this.maxTop}px`):s<this.minBottom?this.container.style.height=`${c.minHeight}px`:s>this.maxBottom&&(this.container.style.height=this.maxBottom-o+"px"))}mouseup=e=>{e.preventDefault(),e.stopPropagation(),this.helper.options&&this.helper.options.onResizeEnd&&this.helper.options.onResizeEnd(),this.unbindUp(),this.unbindMove(),this.unbindUp=this.unbindMove=void 0};createHandleElement(){const e=document.createElement("div"),t=e.style;return t.position="absolute",this.applyStyle(t),this.container.appendChild(e),e}}function Nn(n,e,t){return n<e?e:n>t?t:n}Cr.push(class extends Ce{setPosition(n){this.container.style.width=this.width0+n.clientX-this.x0+"px",this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.right=-this.handleSize+"px",n.bottom=-this.handleSize+"px",n.cursor="nwse-resize"}},class extends Ce{setPosition(n){this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.right=`${this.handleSize}px`,n.left=`${this.handleSize}px`,n.height=2*this.handleSize+"px",n.bottom=-this.handleSize+"px",n.cursor="ns-resize"}},class extends Ce{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px",this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.bottom=-this.handleSize+"px",n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.cursor="nesw-resize"}},class extends Ce{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.bottom=`${this.handleSize}px`,n.width=2*this.handleSize+"px",n.top=`${this.handleSize}px`,n.cursor="ew-resize"}},class extends Ce{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px",this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.top=-this.handleSize+"px",n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.cursor="nwse-resize"}},class extends Ce{setPosition(n){this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px"}applyStyle(n){n.left=`${this.handleSize}px`,n.right=`${this.handleSize}px`,n.height=2*this.handleSize+"px",n.top=-this.handleSize+"px",n.cursor="ns-resize"}},class extends Ce{setPosition(n){this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px",this.container.style.width=this.width0+n.clientX-this.x0+"px"}applyStyle(n){n.right=-this.handleSize+"px",n.top=-this.handleSize+"px",n.height=2*this.handleSize+"px",n.width=2*this.handleSize+"px",n.cursor="nesw-resize"}},class extends Ce{setPosition(n){this.container.style.width=this.width0+n.clientX-this.x0+"px"}applyStyle(n){n.right=-this.handleSize+"px",n.top=`${this.handleSize}px`,n.bottom=`${this.handleSize}px`,n.width=2*this.handleSize+"px",n.cursor="ew-resize"}});var at=Pe({name:"",props:{disabled:{type:Boolean,default:!1},windowStyle:{type:Object,required:!0}},components:{},setup(n){const e=Y(!1),t=Y(!1);return{hover:e,active:t,style:function(){let r=n.windowStyle.button;return e.value&&(r={...r,...this.windowStyle.buttonHover}),t.value&&(r={...r,...this.windowStyle.buttonActive}),r},mouseup:function(r){this.active&&this.$emit("click")},mousedown:function(r){r.preventDefault(),t.value=!0;const o=ce.bindUp(document,()=>{t.value=!1,o()})}}}});const ci=["disabled"];at.render=function(n,e,t,r,o,i){return X(),de("div",{class:"btn",style:ge(n.style()),onMouseenter:e[0]||(e[0]=s=>n.hover=!0),onMouseleave:e[1]||(e[1]=s=>n.hover=!1),onMousedown:e[2]||(e[2]=Dn((...s)=>n.mousedown&&n.mousedown(...s),["stop"])),onTouchstart:e[3]||(e[3]=Dn((...s)=>n.mousedown&&n.mousedown(...s),["stop"])),onMouseup:e[4]||(e[4]=(...s)=>n.mouseup&&n.mouseup(...s)),onTouchend:e[5]||(e[5]=(...s)=>n.mouseup&&n.mouseup(...s)),disabled:n.disabled},[ie(n.$slots,"default")],44,ci)},at.__scopeId="data-v-71662210",at.__file="src/controls/vuewindow/window/Button.vue";const li=Object.prototype.toString;function vt(n,e){return li.call(n)===`[object ${e}]`}function ui(n){return vt(n,"Function")}const cn=n=>n!=null&&n!==null&&vt(n,"Object");function Wn(n){return vt(n,"Number")}function Er(n){return vt(n,"String")}const xs=n=>/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(n);var $e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var On,zn={exports:{}},hi=On?zn.exports:(On=1,zn.exports=function(n){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function t(f,l){var y=f[0],v=f[1],h=f[2],m=f[3];v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&h|~v&m)+l[0]-680876936|0)<<7|y>>>25)+v|0)&v|~y&h)+l[1]-389564586|0)<<12|m>>>20)+y|0)&y|~m&v)+l[2]+606105819|0)<<17|h>>>15)+m|0)&m|~h&y)+l[3]-1044525330|0)<<22|v>>>10)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&h|~v&m)+l[4]-176418897|0)<<7|y>>>25)+v|0)&v|~y&h)+l[5]+1200080426|0)<<12|m>>>20)+y|0)&y|~m&v)+l[6]-1473231341|0)<<17|h>>>15)+m|0)&m|~h&y)+l[7]-45705983|0)<<22|v>>>10)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&h|~v&m)+l[8]+1770035416|0)<<7|y>>>25)+v|0)&v|~y&h)+l[9]-1958414417|0)<<12|m>>>20)+y|0)&y|~m&v)+l[10]-42063|0)<<17|h>>>15)+m|0)&m|~h&y)+l[11]-1990404162|0)<<22|v>>>10)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&h|~v&m)+l[12]+1804603682|0)<<7|y>>>25)+v|0)&v|~y&h)+l[13]-40341101|0)<<12|m>>>20)+y|0)&y|~m&v)+l[14]-1502002290|0)<<17|h>>>15)+m|0)&m|~h&y)+l[15]+1236535329|0)<<22|v>>>10)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&m|h&~m)+l[1]-165796510|0)<<5|y>>>27)+v|0)&h|v&~h)+l[6]-1069501632|0)<<9|m>>>23)+y|0)&v|y&~v)+l[11]+643717713|0)<<14|h>>>18)+m|0)&y|m&~y)+l[0]-373897302|0)<<20|v>>>12)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&m|h&~m)+l[5]-701558691|0)<<5|y>>>27)+v|0)&h|v&~h)+l[10]+38016083|0)<<9|m>>>23)+y|0)&v|y&~v)+l[15]-660478335|0)<<14|h>>>18)+m|0)&y|m&~y)+l[4]-405537848|0)<<20|v>>>12)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&m|h&~m)+l[9]+568446438|0)<<5|y>>>27)+v|0)&h|v&~h)+l[14]-1019803690|0)<<9|m>>>23)+y|0)&v|y&~v)+l[3]-187363961|0)<<14|h>>>18)+m|0)&y|m&~y)+l[8]+1163531501|0)<<20|v>>>12)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v&m|h&~m)+l[13]-1444681467|0)<<5|y>>>27)+v|0)&h|v&~h)+l[2]-51403784|0)<<9|m>>>23)+y|0)&v|y&~v)+l[7]+1735328473|0)<<14|h>>>18)+m|0)&y|m&~y)+l[12]-1926607734|0)<<20|v>>>12)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v^h^m)+l[5]-378558|0)<<4|y>>>28)+v|0)^v^h)+l[8]-2022574463|0)<<11|m>>>21)+y|0)^y^v)+l[11]+1839030562|0)<<16|h>>>16)+m|0)^m^y)+l[14]-35309556|0)<<23|v>>>9)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v^h^m)+l[1]-1530992060|0)<<4|y>>>28)+v|0)^v^h)+l[4]+1272893353|0)<<11|m>>>21)+y|0)^y^v)+l[7]-155497632|0)<<16|h>>>16)+m|0)^m^y)+l[10]-1094730640|0)<<23|v>>>9)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v^h^m)+l[13]+681279174|0)<<4|y>>>28)+v|0)^v^h)+l[0]-358537222|0)<<11|m>>>21)+y|0)^y^v)+l[3]-722521979|0)<<16|h>>>16)+m|0)^m^y)+l[6]+76029189|0)<<23|v>>>9)+h|0,v=((v+=((h=((h+=((m=((m+=((y=((y+=(v^h^m)+l[9]-640364487|0)<<4|y>>>28)+v|0)^v^h)+l[12]-421815835|0)<<11|m>>>21)+y|0)^y^v)+l[15]+530742520|0)<<16|h>>>16)+m|0)^m^y)+l[2]-995338651|0)<<23|v>>>9)+h|0,v=((v+=((m=((m+=(v^((y=((y+=(h^(v|~m))+l[0]-198630844|0)<<6|y>>>26)+v|0)|~h))+l[7]+1126891415|0)<<10|m>>>22)+y|0)^((h=((h+=(y^(m|~v))+l[14]-1416354905|0)<<15|h>>>17)+m|0)|~y))+l[5]-57434055|0)<<21|v>>>11)+h|0,v=((v+=((m=((m+=(v^((y=((y+=(h^(v|~m))+l[12]+1700485571|0)<<6|y>>>26)+v|0)|~h))+l[3]-1894986606|0)<<10|m>>>22)+y|0)^((h=((h+=(y^(m|~v))+l[10]-1051523|0)<<15|h>>>17)+m|0)|~y))+l[1]-2054922799|0)<<21|v>>>11)+h|0,v=((v+=((m=((m+=(v^((y=((y+=(h^(v|~m))+l[8]+1873313359|0)<<6|y>>>26)+v|0)|~h))+l[15]-30611744|0)<<10|m>>>22)+y|0)^((h=((h+=(y^(m|~v))+l[6]-1560198380|0)<<15|h>>>17)+m|0)|~y))+l[13]+1309151649|0)<<21|v>>>11)+h|0,v=((v+=((m=((m+=(v^((y=((y+=(h^(v|~m))+l[4]-145523070|0)<<6|y>>>26)+v|0)|~h))+l[11]-1120210379|0)<<10|m>>>22)+y|0)^((h=((h+=(y^(m|~v))+l[2]+718787259|0)<<15|h>>>17)+m|0)|~y))+l[9]-343485551|0)<<21|v>>>11)+h|0,f[0]=y+f[0]|0,f[1]=v+f[1]|0,f[2]=h+f[2]|0,f[3]=m+f[3]|0}function r(f){var l,y=[];for(l=0;l<64;l+=4)y[l>>2]=f.charCodeAt(l)+(f.charCodeAt(l+1)<<8)+(f.charCodeAt(l+2)<<16)+(f.charCodeAt(l+3)<<24);return y}function o(f){var l,y=[];for(l=0;l<64;l+=4)y[l>>2]=f[l]+(f[l+1]<<8)+(f[l+2]<<16)+(f[l+3]<<24);return y}function i(f){var l,y,v,h,m,B,M=f.length,P=[1732584193,-271733879,-1732584194,271733878];for(l=64;l<=M;l+=64)t(P,r(f.substring(l-64,l)));for(y=(f=f.substring(l-64)).length,v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;l<y;l+=1)v[l>>2]|=f.charCodeAt(l)<<(l%4<<3);if(v[l>>2]|=128<<(l%4<<3),l>55)for(t(P,v),l=0;l<16;l+=1)v[l]=0;return h=(h=8*M).toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(h[2],16),B=parseInt(h[1],16)||0,v[14]=m,v[15]=B,t(P,v),P}function s(f){var l,y,v,h,m,B,M=f.length,P=[1732584193,-271733879,-1732584194,271733878];for(l=64;l<=M;l+=64)t(P,o(f.subarray(l-64,l)));for(y=(f=l-64<M?f.subarray(l-64):new Uint8Array(0)).length,v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;l<y;l+=1)v[l>>2]|=f[l]<<(l%4<<3);if(v[l>>2]|=128<<(l%4<<3),l>55)for(t(P,v),l=0;l<16;l+=1)v[l]=0;return h=(h=8*M).toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(h[2],16),B=parseInt(h[1],16)||0,v[14]=m,v[15]=B,t(P,v),P}function c(f){var l,y="";for(l=0;l<4;l+=1)y+=e[f>>8*l+4&15]+e[f>>8*l&15];return y}function p(f){var l;for(l=0;l<f.length;l+=1)f[l]=c(f[l]);return f.join("")}function g(f){return/[\u0080-\uFFFF]/.test(f)&&(f=unescape(encodeURIComponent(f))),f}function S(f,l){var y,v=f.length,h=new ArrayBuffer(v),m=new Uint8Array(h);for(y=0;y<v;y+=1)m[y]=f.charCodeAt(y);return l?m:h}function k(f){return String.fromCharCode.apply(null,new Uint8Array(f))}function N(f,l,y){var v=new Uint8Array(f.byteLength+l.byteLength);return v.set(new Uint8Array(f)),v.set(new Uint8Array(l),f.byteLength),v}function j(f){var l,y=[],v=f.length;for(l=0;l<v-1;l+=2)y.push(parseInt(f.substr(l,2),16));return String.fromCharCode.apply(String,y)}function T(){this.reset()}return p(i("hello")),typeof ArrayBuffer>"u"||ArrayBuffer.prototype.slice||function(){function f(l,y){return(l=0|l||0)<0?Math.max(l+y,0):Math.min(l,y)}ArrayBuffer.prototype.slice=function(l,y){var v,h,m,B,M=this.byteLength,P=f(l,M),A=M;return y!==n&&(A=f(y,M)),P>A?new ArrayBuffer(0):(v=A-P,h=new ArrayBuffer(v),m=new Uint8Array(h),B=new Uint8Array(this,P,v),m.set(B),h)}}(),T.prototype.append=function(f){return this.appendBinary(g(f)),this},T.prototype.appendBinary=function(f){this._buff+=f,this._length+=f.length;var l,y=this._buff.length;for(l=64;l<=y;l+=64)t(this._hash,r(this._buff.substring(l-64,l)));return this._buff=this._buff.substring(l-64),this},T.prototype.end=function(f){var l,y,v=this._buff,h=v.length,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(l=0;l<h;l+=1)m[l>>2]|=v.charCodeAt(l)<<(l%4<<3);return this._finish(m,h),y=p(this._hash),f&&(y=j(y)),this.reset(),y},T.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},T.prototype.setState=function(f){return this._buff=f.buff,this._length=f.length,this._hash=f.hash,this},T.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},T.prototype._finish=function(f,l){var y,v,h,m=l;if(f[m>>2]|=128<<(m%4<<3),m>55)for(t(this._hash,f),m=0;m<16;m+=1)f[m]=0;y=(y=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),v=parseInt(y[2],16),h=parseInt(y[1],16)||0,f[14]=v,f[15]=h,t(this._hash,f)},T.hash=function(f,l){return T.hashBinary(g(f),l)},T.hashBinary=function(f,l){var y=p(i(f));return l?j(y):y},T.ArrayBuffer=function(){this.reset()},T.ArrayBuffer.prototype.append=function(f){var l,y=N(this._buff.buffer,f),v=y.length;for(this._length+=f.byteLength,l=64;l<=v;l+=64)t(this._hash,o(y.subarray(l-64,l)));return this._buff=l-64<v?new Uint8Array(y.buffer.slice(l-64)):new Uint8Array(0),this},T.ArrayBuffer.prototype.end=function(f){var l,y,v=this._buff,h=v.length,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(l=0;l<h;l+=1)m[l>>2]|=v[l]<<(l%4<<3);return this._finish(m,h),y=p(this._hash),f&&(y=j(y)),this.reset(),y},T.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.ArrayBuffer.prototype.getState=function(){var f=T.prototype.getState.call(this);return f.buff=k(f.buff),f},T.ArrayBuffer.prototype.setState=function(f){return f.buff=S(f.buff,!0),T.prototype.setState.call(this,f)},T.ArrayBuffer.prototype.destroy=T.prototype.destroy,T.ArrayBuffer.prototype._finish=T.prototype._finish,T.ArrayBuffer.hash=function(f,l){var y=p(s(new Uint8Array(f)));return l?j(y):y},T}()),Bt=yt(hi);const $t=[];class he{static addHandler(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}static removeHandler(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent?e.detachEvent("on"+t,r):delete e["on"+t]}static windowResizeHandler(e){he.addHandler(window,"resize",e)}static offWindowResizeHandler(e){he.removeHandler(window,"resize",e)}static fullscreenEnabled(){const e=window.document;return document.fullscreenEnabled||window.fullScreen||e.mozFullscreenEnabled||e.webkitIsFullScreen}static fullScreen(e,t){if(t){const r=window.document;let o=window.document.exitFullscreen||r.msExitFullscreen||r.mozCancelFullScreen||r.webkitCancelFullScreen;typeof o<"u"&&o?o.call(window.document):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("WScript.Shell")?.SendKeys("{F11}")}else{let r=e;r||(r=window.document.documentElement);let o=r.requestFullScreen||r.webkitRequestFullScreen||r.mozRequestFullScreen||r.msRequestFullScreen;typeof o<"u"&&o?o.call(r):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("WScript.Shell")?.SendKeys("{F11}")}}static requestFullScreen(e=window.document.documentElement){let t=e;var r=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(r)r.call(t);else if(typeof window.ActiveXObject<"u"){var o=new window.ActiveXObject("WScript.Shell");o!==null&&o.SendKeys("{F11}")}}static exitFullScreen(){const e=window.document;var t=document.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.webkitExitFullscreen;if(t)t.call(document);else if(typeof window.ActiveXObject<"u"){var r=new window.ActiveXObject("WScript.Shell");r!==null&&r.SendKeys("{F11}")}}static fullScreenElement(){return window.document.fullscreenElement||window.document.webkitFullscreenElement||window.document.mozFullscreenElement||window.document.msFullscreenElement}static isFullScreen(){return!!he.fullScreenElement()}static onFullScreenChanged(e){let t;"onfullscreenchange"in window.document?t="fullscreenchange":"onwebkitfullscreenchange"in window.document?t="webkitfullscreenchange":"onmozfullscreenchange"in window.document&&(t="mozfullscreenchange"),t?document.addEventListener(t,function(){const r=he.isFullScreen();e(r)}):document.addEventListener("MSFullscreenChange",function(){const r=he.isFullScreen();e(r)})}static stringifyCircularHandler(e,t){if(typeof t=="object"&&t!==null){if($t.indexOf(t)!==-1)return;$t.push(t)}return t}static jsonStringify(e){if(!e)return"";const t=JSON.stringify(e,he.stringifyCircularHandler);return $t.length=0,t}static jsonParse(e){const t=he.jsonStringify(e);if(t.length>1)return JSON.parse(t)}static getObjectURL(e){let t;const r=window;return r.createObjcectURL!=null?t=r.createOjcectURL(e):window.URL!=null?t=window.URL.createObjectURL(e):window.webkitURL!=null&&(t=window.webkitURL.createObjectURL(e)),t}static getFileShortMD5(e,t){const r=File.prototype,o=r.slice||r.mozSlice||r.webkitSlice,i=e,s=2097152,c=new Bt.ArrayBuffer,p=new FileReader;p.onload=function(g){c.append(g.target?.result);const S=c.end();t({isOK:!0,data:S})},p.onerror=function(){t({isOK:!1,data:"计算文件简单摘要错误！"})},function(){const g=0+s>=i.size?i.size:0+s;p.readAsArrayBuffer(o.call(i,0,g))}()}static getFileMD5(e,t){const r=File.prototype,o=r.slice||r.mozSlice||r.webkitSlice,i=e,s=2097152,c=Math.ceil(i.size/s);let p=0;const g=new Bt.ArrayBuffer,S=new FileReader;function k(){const N=p*s,j=N+s>=i.size?i.size:N+s;S.readAsArrayBuffer(o.call(i,N,j))}S.onload=function(N){if(g.append(N.target?.result),p++,p<c)k();else{const j=g.end();t({isOK:!0,data:j})}},S.onerror=function(){const N=`${i.name}:计算文件简单摘要错误！`;t({isOK:!1,data:N})},k()}static MD5(e,t=!1){return Bt.hash(e,t)}static copyTextByCommand(e){return new Promise((t,r)=>{const o=document.createElement("input");o.value=e,document.body.appendChild(o),o.select(),document.execCommand("copy"),o.remove(),t(!0)})}static copyText=e=>navigator.clipboard?navigator.clipboard.writeText(e).then(function(){return!0},function(t){return!1}):he.copyTextByCommand(e);static copyElementTextByCommand(e){const t=document.createRange();t.selectNode(document.getElementById(e));const r=window.getSelection();r.rangeCount>0&&r.removeAllRanges(),r.addRange(t);try{return document.execCommand("copy"),r.removeRange(t),!0}catch{return r.removeRange(t),!1}}static copyElementText(e){if(!navigator.clipboard)return he.copyElementTextByCommand(e);const t=document.createRange();t.selectNode(document.getElementById(e));const r=window.getSelection();return r.rangeCount>0&&r.removeAllRanges(),r.addRange(t),navigator.clipboard.writeText(r).then(function(){return r.removeRange(t),!0},function(o){return r.removeRange(t),!1})}static setGrayMode(e){he.toggleClass(e,"grayMode",document.documentElement)}static toggleClass(e,t,r){const o=r||document.body;let{className:i}=o;i=i.replace(t,""),o.className=e?`${i} ${t} `:i}static setCssVar(e,t,r=document.documentElement){r.style.setProperty(e,t)}static dispatchWindowResize(){const e=new Event("resize");window.dispatchEvent(e)}static dispatchElementEvent(e,t="click",r){let o;if(o=Er(e)?document.getElementById(e):e,o){const i=new Event(t,{bubbles:!0,cancelable:!0});r&&o.addEventListener("ev",s=>{r(s)},!1),o.dispatchEvent(i)}}static getRandomNum(e,t){var r=t-e,o=Math.random();return e+Math.round(o*r)}static merge(e={},t={}){let r,o,i,s;for(e||(e={}),o=0,i=t.length;o<i;o++)for(r in s=t[o],s)e[r]=s[r];return e}static setOptions(e,t){e.hasOwnProperty("options")||(e.options=e.options?Object.create(e.options):{});for(let r in t)e.options[r]=t[r];return e.options}static formatNum(e,t){let r=Math.pow(10,t===void 0?6:t);return Math.round(e*r)/r}static trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}static splitWords(e){return this.trim(e).split(/\s+/)}static emptyImageUrl(){return"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}static debounce(e,t){let r=null;return function(){r&&clearTimeout(r),r=setTimeout(e,t)}}static throttle(e,t){let r=!0;return function(){if(!r)return!1;r=!1,setTimeout(()=>{e(),r=!0},t)}}static dataURLtoBlob(e){let t=e.split(",");if(!t||t.length===0)return;let r=t[0].match(/:(.*?);/)[1],o=atob(t[1]),i=o.length,s=new Uint8Array(i);for(;i--;)s[i]=o.charCodeAt(i);return new Blob([s],{type:r})}static getElement(e){return typeof e=="string"?document.getElementById(e):e}static getStyle(e,t){let r=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!r||r==="auto")&&document.defaultView){let o=document.defaultView.getComputedStyle(e,null);r=o?o[t]:null}return r==="auto"?null:r}static create(e,t,r){let o=document.createElement(e);return o.className=t||"",r&&r.appendChild(o),o}static removeElement(e){let t=e.parentNode;t&&t.removeChild(e)}static emptyElement(e){for(;e.firstChild;)e.removeChild(e.firstChild)}static hasClass(e,t){if(e.classList!==void 0)return e.classList.contains(t);let r=this.getClass(e);return r.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}static addClass(e,t){if(e.classList!==void 0){let r=this.splitWords(t);for(let o=0,i=r.length;o<i;o++)e.classList.add(r[o])}else if(!this.hasClass(e,t)){let r=this.getClass(e);this.setClass(e,(r?r+" ":"")+t)}}static removeClass(e,t){e.classList!==void 0?e.classList.remove(t):this.setClass(e,this.trim((" "+this.getClass(e)+" ").replace(" "+t+" "," ")))}static setClass(e,t){e.className.baseVal===void 0?e.className=t:e.className.baseVal=t}static getClass(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}static createSvgElement(e,t,r,o){let i=document.createElementNS("http://www.w3.org/2000/svg","svg:svg");i.setAttribute("class","svg-path"),i.setAttribute("width",e),i.setAttribute("height",t),i.setAttribute("viewBox",`0 0 ${e} ${t}`);let s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",r),i.appendChild(s),o&&o.appendChild(i),i}static parseDom(e,t=!0,r=""){t=t??!1;let o=document.createElement("div");return o.className=r||"",o.innerHTML=e,t?o:o.childNodes}static createVideoHTML(e,t,r){let o=this.create("video",t,r),i=this.create("source","",o);i.setAttribute("src",e),i.setAttribute("type","video/map4");let s=this.create("source","",o);return s.setAttribute("src",e),s.setAttribute("type","video/quicktime"),o}}class kr{static isNullOrEmpty=e=>e===null||e===""||e===void 0||e.length===0;static isNotEmpty=e=>!(e===null||e===""||e===void 0||e.length===0);static toHump(e){return e.replace(/[\-\/\_](\w)/g,(t,r)=>r.toUpperCase()).replace("views","")}}class xr{prefixKey;storage;constructor(e="",t=localStorage){this.prefixKey=e,this.storage=t}getKey(e){return`${this.prefixKey}${e}`.toUpperCase()}set(e,t,r=604800){const o=JSON.stringify({value:t,expire:r!==null?new Date().getTime()+1e3*r:null});this.storage.setItem(this.getKey(e),o)}get(e,t=null){const r=this.storage.getItem(this.getKey(e));if(r)try{const o=JSON.parse(r),{value:i,expire:s}=o;if(s===null||s>=Date.now())return i;this.remove(this.getKey(e))}catch{return t}return t}getJsonObject(e){const t=this.storage.getItem(this.getKey(e));if(t)try{const r=JSON.parse(t);if(r.expire===null||r.expire>=Date.now())return r;this.remove(this.getKey(e))}catch{return}}remove(e){this.storage.removeItem(this.getKey(e))}clear(){this.storage.clear()}setCookie(e,t,r=604800){document.cookie=`${this.getKey(e)}=${t}; Max-Age=${r}`}getCookie(e){const t=document.cookie.split("; ");for(let r=0,o=t.length;r<o;r++){const i=t[r].split("=");if(i[0]===this.getKey(e))return i[1]}return""}removeCookie(e){this.setCookie(e,1,-1)}clearCookie(){const e=document.cookie.match(/[^ =;]+(?==)/g);if(e)for(let t=e.length;t--;)document.cookie=e[t]+"=0;expire="+new Date(0).toUTCString()}}function di(){let n=[];const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var t=0;t<36;t++){const o=Math.floor(16*Math.random());n[t]=e.substring(o,o+1)}n[14]="4";const r=3&Number(n[19])|8;return n[19]=e.substring(r,r+1),n[8]=n[13]=n[18]=n[23]="-",n.join("")}function Is(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?r:3&r|8).toString(16)});return e}var jn;function fi(n){return{all:n=n||new Map,on(e,t){const r=n?.get(e);r&&r.push(t)||n?.set(e,[t])},off(e,t){const r=n?.get(e);r&&r.splice(r.indexOf(t)>>>0,1)},emit(e,t){(n?.get(e)||[]).slice().map(r=>{r(t)}),(n?.get("*")||[]).slice().map(r=>{r(e,t)})}}}(function(n){n[n.RGBA=0]="RGBA",n[n.Hex=1]="Hex",n[n.Hsla=2]="Hsla"})(jn||(jn={}));const Xe=fi(),ue={HproseServiceErrorEvent:"HproseServiceError",WebAPIErrorEvent:"WebAPIError",AlertInfoEvent:"AlertInfoEvent",CommonWarnEvent:"CommonWarnEvent",WidgetLoadedEvent:"WidgetLoaded",WidgetLoaded:"WidgetLoaded",WidgetUnLoadedEvent:"WidgetUnLoaded",WidgetLoadedErrorEvent:"WidgetLoadedError",WidgetVisibleChanged:"WidgetVisibleChanged",AxiosRequestErrorEvent:"AxiosRequestErrorEvent",LayoutContainerLoaded:"LayoutContainerLoaded"},Ir=(n,e)=>{const t=document.createElement("a");t.download=e,t.style.display="none";const r=new Blob([n],{type:"application/octet-stream"});t.href=URL.createObjectURL(r),document.body.appendChild(t),t.click(),document.body.removeChild(t)},pi=(n,e)=>{const t=JSON.stringify(n,null,2);Ir(t,e+".json")},Ts=(n,e,t)=>{n.get(e,{responseType:"blob"}).then(function(r){Ir(r.data,t)}).catch(r=>{Xe.emit(ue.CommonWarnEvent,"下载文件报错！")})};var Hn,Nt={exports:{}},Un,qn,Wt,Ot=(Hn||(Hn=1,qn=Nt.exports,Wt=function(){var n=function(){},e="undefined",t=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function s(T,f){var l=T[f];if(typeof l.bind=="function")return l.bind(T);try{return Function.prototype.bind.call(l,T)}catch{return function(){return Function.prototype.apply.apply(l,[T,arguments])}}}function c(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments]))}function p(T){return T==="debug"&&(T="log"),typeof console!==e&&(T==="trace"&&t?c:console[T]!==void 0?s(console,T):console.log!==void 0?s(console,"log"):n)}function g(){for(var T=this.getLevel(),f=0;f<r.length;f++){var l=r[f];this[l]=f<T?n:this.methodFactory(l,T,this.name)}if(this.log=this.debug,typeof console===e&&T<this.levels.SILENT)return"No console available for logging"}function S(T){return function(){typeof console!==e&&(g.call(this),this[T].apply(this,arguments))}}function k(T,f,l){return p(T)||S.apply(this,arguments)}function N(T,f){var l,y,v,h=this,m="loglevel";function B(){var A;if(typeof window!==e&&m){try{A=window.localStorage[m]}catch{}if(typeof A===e)try{var $=window.document.cookie,z=encodeURIComponent(m),R=$.indexOf(z+"=");R!==-1&&(A=/^([^;]+)/.exec($.slice(R+z.length+1))[1])}catch{}return h.levels[A]===void 0&&(A=void 0),A}}function M(A){var $=A;if(typeof $=="string"&&h.levels[$.toUpperCase()]!==void 0&&($=h.levels[$.toUpperCase()]),typeof $=="number"&&$>=0&&$<=h.levels.SILENT)return $;throw new TypeError("log.setLevel() called with invalid level: "+A)}typeof T=="string"?m+=":"+T:typeof T=="symbol"&&(m=void 0),h.name=T,h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},h.methodFactory=f||k,h.getLevel=function(){return v??y??l},h.setLevel=function(A,$){return v=M(A),$!==!1&&function(z){var R=(r[z]||"silent").toUpperCase();if(typeof window!==e&&m){try{return void(window.localStorage[m]=R)}catch{}try{window.document.cookie=encodeURIComponent(m)+"="+R+";"}catch{}}}(v),g.call(h)},h.setDefaultLevel=function(A){y=M(A),B()||h.setLevel(A,!1)},h.resetLevel=function(){v=null,function(){if(typeof window!==e&&m){try{window.localStorage.removeItem(m)}catch{}try{window.document.cookie=encodeURIComponent(m)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}(),g.call(h)},h.enableAll=function(A){h.setLevel(h.levels.TRACE,A)},h.disableAll=function(A){h.setLevel(h.levels.SILENT,A)},h.rebuild=function(){if(i!==h&&(l=M(i.getLevel())),g.call(h),i===h)for(var A in o)o[A].rebuild()},l=M(i?i.getLevel():"WARN");var P=B();P!=null&&(v=M(P)),g.call(h)}(i=new N).getLogger=function(T){if(typeof T!="symbol"&&typeof T!="string"||T==="")throw new TypeError("You must supply a name when creating a logger.");var f=o[T];return f||(f=o[T]=new N(T,i.methodFactory)),f};var j=typeof window!==e?window.log:void 0;return i.noConflict=function(){return typeof window!==e&&window.log===i&&(window.log=j),i},i.getLoggers=function(){return o},i.default=i,i},(Un=Nt).exports?Un.exports=Wt():qn.log=Wt()),Nt.exports);class Tr{message;eventBus;constructor(e,t){e&&(this.message=e),t&&(this.eventBus=t)}msg(e,t=3,r="success"){if(this.message)if(typeof this.message=="function")this.message({type:r,message:e,duration:t});else switch(r){case"info":this.message.info(e,t);break;case"success":this.message.success(e,t);break;case"warning":this.message.warn?this.message.warn(e,t):this.message.warning&&this.message.warning(e,t);break;case"error":this.message.error(e,t)}else{switch(r){case"info":case"success":break;case"warning":break;case"error":r="dark"}this.eventBus&&this.eventBus.emit(ue.AlertInfoEvent,{type:r,info:e})}}info(e,t=3){this.msg(e,t,"info")}warn(e,t=3){this.msg(e,t,"warning")}err(e,t=3){this.msg(e,t,"error")}success(e,t=3){this.msg(e,t,"success")}}let Fn=!1;const W={Config:SysConfig,EventBus:Xe,DefaultProxyClient:null,Axios:ei,Message:new Tr(void 0,Xe),LayoutMap:new Map,getLayoutManager:n=>{if(!W.WidgetConfigList||W.WidgetConfigList.length===0)return;const e=W.WidgetConfigList.find(t=>t.id===n);if(e){const t=e.layoutID;if(t&&W.LayoutMap.has(t))return W.LayoutMap.get(t)}},Logger:n=>{Fn||(SysConfig.UI.ProductLog?Ot.enableAll():Ot.setDefaultLevel("warn"),Fn=!0);const e=n||"default";return Ot.getLogger(e)}},Rr="access_token",Ae=new xr("user",localStorage);function We(){return Ae.get(Rr)}function Lr(){Ae.remove(Rr)}function gi(){return We()?.refresh}function Ar(n,e,t,r="json",o){const i={baseURL:W.Config.ServiceURL.DefaultWebAPI,timeout:6e4,params:n,paramsSerializer:{serialize:function(s){return ni.stringify(s,{indices:!1,arrayFormat:"repeat"})}},headers:{"Content-Type":"application/json",Authorization:"bearer "+We()?.token},responseType:r,cancelToken:o};if(t)for(let s in t)i.headers[s]=t[s];return W.SystemID&&(i.headers.sysid=W.SystemID,W.SystemGroup&&(i.headers.sysgroup=W.SystemGroup)),e&&(i.baseURL=e),i}function ze(n,e,t,r,o="json",i,s){const c=Ar(t,e,r,o,i);return s&&s>=2e4&&(c.timeout=s),W.Axios?.get(n,c).catch(function(p){Mr(p,e,n,"Get")})}function Mr(n,e,t,r="Get"){const o=`${e}${t}`;if(n&&n.response){let i=!1;const s=n.response.status;switch(s){case 400:n.message="错误请求";break;case 401:n.message="未授权，请重新登录";break;case 403:n.message="拒绝访问";break;case 404:n.message="请求错误,未找到该资源";break;case 405:n.message="请求方法未允许";break;case 408:n.message="请求超时";break;case 500:const p=n.response.data;if(p){const g=p.indexOf(":"),S=p.indexOf(`
`);if(g>0&&S-g>2){const k=p.substring(g+2,S);k.indexOf("System.Exception")>0?n.message="后台服务内部出错！":(i=!0,n.message=k)}else i=!0,n.message=p}else n.message="服务器端出错";break;case 501:n.message="网络未实现";break;case 502:n.message="网络错误";break;case 503:n.message="服务不可用";break;case 504:n.message="网络超时";break;case 505:n.message="http版本不支持该请求";break;default:n.message=`连接错误${n.response.status}`}let c={address:o,code:s,isExceptionInfo:i,message:n.message,result:n.response.data};if(W.EventBus.emit(ue.AxiosRequestErrorEvent,c),i)throw new Error(n.message)}else if(n?.message)throw new Error(n.message)}function mi(n,e,t,r,o,i="json",s){const c=Ar(r,e,o,i);return W.Axios?.post(n,t,c).catch(function(p){Mr(p,e,n,"Post")})}function Rs(n,e){return ze(n,void 0,e)}var Xn,Vn,zt,Kn,jt,Yn,Ht,Gn,Jn,Qe={exports:{}};function vi(){return Vn?Xn:(Vn=1,n=typeof window<"u"?window:$e!==void 0?$e:typeof self<"u"?self:{},Xn=n);var n}function yi(){if(Kn)return zt;Kn=1,zt=function(e){if(!e)return!1;var t=n.call(e);return t==="[object Function]"||typeof e=="function"&&t!=="[object RegExp]"||typeof window<"u"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString;return zt}function wi(){if(Yn)return jt;Yn=1;var n=function(e){return e.replace(/^\s+|\s+$/g,"")};return jt=function(e){if(!e)return{};for(var t,r={},o=n(e).split(`
`),i=0;i<o.length;i++){var s=o[i],c=s.indexOf(":"),p=n(s.slice(0,c)).toLowerCase(),g=n(s.slice(c+1));r[p]===void 0?r[p]=g:(t=r[p],Object.prototype.toString.call(t)==="[object Array]"?r[p].push(g):r[p]=[r[p],g])}return r},jt}var _i=function(){if(Jn)return Qe.exports;Jn=1;var n=vi(),e=yi(),t=wi(),r=function(){if(Gn)return Ht;Gn=1,Ht=function(){for(var p={},g=0;g<arguments.length;g++){var S=arguments[g];for(var k in S)c.call(S,k)&&(p[k]=S[k])}return p};var c=Object.prototype.hasOwnProperty;return Ht}();function o(c,p,g){var S=c;return e(p)?(g=p,typeof c=="string"&&(S={uri:c})):S=r(p,{uri:c}),S.callback=g,S}function i(c,p,g){return s(p=o(c,p,g))}function s(c){if(c.callback===void 0)throw new Error("callback argument missing");var p=!1,g=function(A,$,z){p||(p=!0,c.callback(A,$,z))};function S(){var A=void 0;if(A=f.response?f.response:f.responseText||function($){try{if($.responseType==="document")return $.responseXML;var z=$.responseXML&&$.responseXML.documentElement.nodeName==="parsererror";if($.responseType===""&&!z)return $.responseXML}catch{}return null}(f),M)try{A=JSON.parse(A)}catch{}return A}function k(A){return clearTimeout(l),A instanceof Error||(A=new Error(""+(A||"Unknown XMLHttpRequest Error"))),A.statusCode=0,g(A,P)}function N(){if(!T){var A;clearTimeout(l),A=c.useXDR&&f.status===void 0?200:f.status===1223?204:f.status;var $=P,z=null;return A!==0?($={body:S(),statusCode:A,method:v,headers:{},url:y,rawRequest:f},f.getAllResponseHeaders&&($.headers=t(f.getAllResponseHeaders()))):z=new Error("Internal XMLHttpRequest Error"),g(z,$,$.body)}}var j,T,f=c.xhr||null;f||(f=c.cors||c.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var l,y=f.url=c.uri||c.url,v=f.method=c.method||"GET",h=c.body||c.data,m=f.headers=c.headers||{},B=!!c.sync,M=!1,P={body:void 0,headers:{},statusCode:0,method:v,url:y,rawRequest:f};if("json"in c&&c.json!==!1&&(M=!0,m.accept||m.Accept||(m.Accept="application/json"),v!=="GET"&&v!=="HEAD"&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),h=JSON.stringify(c.json===!0?h:c.json))),f.onreadystatechange=function(){f.readyState===4&&setTimeout(N,0)},f.onload=N,f.onerror=k,f.onprogress=function(){},f.onabort=function(){T=!0},f.ontimeout=k,f.open(v,y,!B,c.username,c.password),B||(f.withCredentials=!!c.withCredentials),!B&&c.timeout>0&&(l=setTimeout(function(){if(!T){T=!0,f.abort("timeout");var A=new Error("XMLHttpRequest timeout");A.code="ETIMEDOUT",k(A)}},c.timeout)),f.setRequestHeader)for(j in m)m.hasOwnProperty(j)&&f.setRequestHeader(j,m[j]);else if(c.headers&&!function(A){for(var $ in A)if(A.hasOwnProperty($))return!1;return!0}(c.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in c&&(f.responseType=c.responseType),"beforeSend"in c&&typeof c.beforeSend=="function"&&c.beforeSend(f),f.send(h||null),f}return Qe.exports=i,Qe.exports.default=i,i.XMLHttpRequest=n.XMLHttpRequest||function(){},i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:n.XDomainRequest,function(c,p){for(var g=0;g<c.length;g++)p(c[g])}(["get","put","post","patch","head","delete"],function(c){i[c==="delete"?"del":c]=function(p,g,S){return(g=o(p,g,S)).method=c.toUpperCase(),s(g)}}),Qe.exports}();yt(_i);class ut{hproseURL;client;hproseProxy;static httpTransport;constructor(e){if(e&&!kr.isNullOrEmpty(e)){if(ut.httpTransport||(ut.httpTransport=new ri),this.client=new oi(e),!this.client)throw Error("Hprose Client初始化错误");this.hproseURL=e,this.init()}}init(){this.client&&this.client.useServiceAsync().then(e=>{this.hproseProxy=e}).catch(e=>{String(e).indexOf("find this method ~")>0?this.hproseProxy=this.client?.useService():Xe.emit(ue.HproseServiceErrorEvent,"初始化默认Hprose!")})}async getProxy(){if(!this.hproseProxy)try{this.client&&(this.hproseProxy=await this.client.useServiceAsync())}catch{this.hproseProxy=this.client?.useService()}return this.hproseProxy}async invoke(e,t,r){if(this.client)return await this.client.invoke(e,t,r)}encode(e,t,r){if(this.client)return this.client.codec.encode(e,t,r)}decode(e,t){if(this.client)return this.client.codec.decode(e,t)}}class bi{hproseClient;hpProxyObj;defaultContext=new Mt;constructor(e){this.hproseClient=new ut(e),this.hpProxyObj=null}getClientContext(e,t){const r={};t&&(r.requestHeaders=t);const o=We();r.httpRequestHeaders=e||{};const i=r.httpRequestHeaders;return o&&(i.token=o.token),W.SystemID&&(i.sysid=W.SystemID,W.SystemGroup&&(i.sysgroup=W.SystemGroup)),new Mt(r)}async getHproseProxy(){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");if(!this.hpProxyObj){const e=await this.hproseClient.getProxy();this.hpProxyObj=e}return this.hpProxyObj||Xe.emit(ue.HproseServiceErrorEvent,"HproseProxy对象为空，无法调用Hprose方法！"),this.hpProxyObj}async hproseInvoke(e,t,r){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");return await this.hproseClient.invoke(e,t,r)}async hproseInvokeContext(e,t,...r){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");const o=We();return o&&(t||(t=new Mt({httpRequestHeaders:{token:o.token}}))),await this.hproseClient.invoke(e,r,t)}async hproseInvokeEncode(e){const t=new Ie(e).toBytes(),r=await this.hproseClient.client?.request(t,this.defaultContext);return r&&this.hproseClient.client?.codec.decode(r,this.defaultContext)}encodeRequest(e,...t){const r=this.hproseClient.client?.codec?.encode(e,t,this.defaultContext);return Ie.toString(r)}}const Ls=function(n,e,t){!W.Config.DefaultHproseAPI&&W.Config.ServiceURL&&(W.Config.DefaultHproseAPI=W.Config.ServiceURL.DefaultHproseAPI),W.Config.DefaultHproseAPI&&kr.isNotEmpty(W.Config.DefaultHproseAPI)&&(W.DefaultProxyClient=new bi(W.Config.DefaultHproseAPI));const r=W.Config.UI.GrayMode;r&&he.setGrayMode(r);const o=new Tr(n,W.EventBus);W.Message=o,W.SystemID=e,W.SystemGroup=t,W.EventBus.on(ue.HproseServiceErrorEvent,i=>{const s=`当前后台业务服务不可用!${i}`}),W.EventBus.on(ue.WebAPIErrorEvent,i=>{const s=`WebAPI后台服务不可用!${i}`}),W.EventBus.on(ue.AxiosRequestErrorEvent,i=>{const s=`Http请求'${i.code}'错误: ${i.message}`}),W.EventBus.on(ue.CommonWarnEvent,i=>{o.warn(i)})},Pr="is_LockScreen",Qn=Ae.get(Pr,!1),qe={isLock:Qn,lockTime:Qn=="true"?Dr():0};function Zn(n){qe.isLock=n,Ae.set(Pr,n,10),n&&Lr()}function Dr(){let n=3600;return W.Config.UI?.LockTime&&W.Config.UI?.LockTime>=10&&(n=W.Config.UI.LockTime),n}let Ut;function Qt(){clearInterval(Ut),!(window.location.href.indexOf("/login")>0||qe.isLock)&&(Zn(!1),qe.lockTime=Dr(),Ut=setInterval(()=>{if(qe.lockTime--,qe.lockTime<=0)return Zn(!0),clearInterval(Ut)},1e3))}function As(){Qt(),document.addEventListener("mousedown",Qt)}function Ms(){document.removeEventListener("mousedown",Qt)}function qt(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var er,tr={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var nr,Si=er?tr.exports:(er=1,tr.exports=function n(e,t,r){function o(c,p){if(!t[c]){if(!e[c]){if(!p&&qt)return qt(c);if(i)return i(c,!0);var g=new Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g}var S=t[c]={exports:{}};e[c][0].call(S.exports,function(k){var N=e[c][1][k];return o(N||k)},S,S.exports,n,e,t,r)}return t[c].exports}for(var i=qt,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(n,e,t){(function(r){var o,i,s=r.MutationObserver||r.WebKitMutationObserver;if(s){var c=0,p=new s(N),g=r.document.createTextNode("");p.observe(g,{characterData:!0}),o=function(){g.data=c=++c%2}}else if(r.setImmediate||r.MessageChannel===void 0)o="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var T=r.document.createElement("script");T.onreadystatechange=function(){N(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},r.document.documentElement.appendChild(T)}:function(){setTimeout(N,0)};else{var S=new r.MessageChannel;S.port1.onmessage=N,o=function(){S.port2.postMessage(0)}}var k=[];function N(){var T,f;i=!0;for(var l=k.length;l;){for(f=k,k=[],T=-1;++T<l;)f[T]();l=k.length}i=!1}function j(T){k.push(T)!==1||i||o()}e.exports=j}).call(this,$e!==void 0?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,e,t){var r=n(1);function o(){}var i={},s=["REJECTED"],c=["FULFILLED"],p=["PENDING"];function g(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,h!==o&&j(this,h)}function S(h,m,B){this.promise=h,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof B=="function"&&(this.onRejected=B,this.callRejected=this.otherCallRejected)}function k(h,m,B){r(function(){var M;try{M=m(B)}catch(P){return i.reject(h,P)}M===h?i.reject(h,new TypeError("Cannot resolve promise with itself")):i.resolve(h,M)})}function N(h){var m=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof m=="function")return function(){m.apply(h,arguments)}}function j(h,m){var B=!1;function M(z){B||(B=!0,i.reject(h,z))}function P(z){B||(B=!0,i.resolve(h,z))}function A(){m(P,M)}var $=T(A);$.status==="error"&&M($.value)}function T(h,m){var B={};try{B.value=h(m),B.status="success"}catch(M){B.status="error",B.value=M}return B}function f(h){return h instanceof this?h:i.resolve(new this(o),h)}function l(h){var m=new this(o);return i.reject(m,h)}function y(h){var m=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var B=h.length,M=!1;if(!B)return this.resolve([]);for(var P=new Array(B),A=0,$=-1,z=new this(o);++$<B;)R(h[$],$);return z;function R(U,F){function ae(re){P[F]=re,++A!==B||M||(M=!0,i.resolve(z,P))}m.resolve(U).then(ae,function(re){M||(M=!0,i.reject(z,re))})}}function v(h){var m=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var B=h.length,M=!1;if(!B)return this.resolve([]);for(var P=-1,A=new this(o);++P<B;)$(h[P]);return A;function $(z){m.resolve(z).then(function(R){M||(M=!0,i.resolve(A,R))},function(R){M||(M=!0,i.reject(A,R))})}}e.exports=g,g.prototype.catch=function(h){return this.then(null,h)},g.prototype.then=function(h,m){if(typeof h!="function"&&this.state===c||typeof m!="function"&&this.state===s)return this;var B=new this.constructor(o);return this.state!==p?k(B,this.state===c?h:m,this.outcome):this.queue.push(new S(B,h,m)),B},S.prototype.callFulfilled=function(h){i.resolve(this.promise,h)},S.prototype.otherCallFulfilled=function(h){k(this.promise,this.onFulfilled,h)},S.prototype.callRejected=function(h){i.reject(this.promise,h)},S.prototype.otherCallRejected=function(h){k(this.promise,this.onRejected,h)},i.resolve=function(h,m){var B=T(N,m);if(B.status==="error")return i.reject(h,B.value);var M=B.value;if(M)j(h,M);else{h.state=c,h.outcome=m;for(var P=-1,A=h.queue.length;++P<A;)h.queue[P].callFulfilled(m)}return h},i.reject=function(h,m){h.state=s,h.outcome=m;for(var B=-1,M=h.queue.length;++B<M;)h.queue[B].callRejected(m);return h},g.resolve=f,g.reject=l,g.all=y,g.race=v},{1:1}],3:[function(n,e,t){(function(r){typeof r.Promise!="function"&&(r.Promise=n(2))}).call(this,$e!==void 0?$e:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,e,t){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function o(a,u){if(!(a instanceof u))throw new TypeError("Cannot call a class as a function")}function i(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var s=i();function c(){try{if(!s||!s.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),u=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||u)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function p(a,u){a=a||[],u=u||{};try{return new Blob(a,u)}catch(w){if(w.name!=="TypeError")throw w;for(var d=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),_=0;_<a.length;_+=1)d.append(a[_]);return d.getBlob(u.type)}}typeof Promise>"u"&&n(3);var g=Promise;function S(a,u){u&&a.then(function(d){u(null,d)},function(d){u(d)})}function k(a,u,d){typeof u=="function"&&a.then(u),typeof d=="function"&&a.catch(d)}function N(a){return typeof a!="string"&&(a=String(a)),a}function j(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var T="local-forage-detect-blob-support",f=void 0,l={},y=Object.prototype.toString,v="readonly",h="readwrite";function m(a){for(var u=a.length,d=new ArrayBuffer(u),_=new Uint8Array(d),w=0;w<u;w++)_[w]=a.charCodeAt(w);return d}function B(a){return new g(function(u){var d=a.transaction(T,h),_=p([""]);d.objectStore(T).put(_,"key"),d.onabort=function(w){w.preventDefault(),w.stopPropagation(),u(!1)},d.oncomplete=function(){var w=navigator.userAgent.match(/Chrome\/(\d+)/),b=navigator.userAgent.match(/Edge\//);u(b||!w||parseInt(w[1],10)>=43)}}).catch(function(){return!1})}function M(a){return typeof f=="boolean"?g.resolve(f):B(a).then(function(u){return f=u})}function P(a){var u=l[a.name],d={};d.promise=new g(function(_,w){d.resolve=_,d.reject=w}),u.deferredOperations.push(d),u.dbReady?u.dbReady=u.dbReady.then(function(){return d.promise}):u.dbReady=d.promise}function A(a){var u=l[a.name].deferredOperations.pop();if(u)return u.resolve(),u.promise}function $(a,u){var d=l[a.name].deferredOperations.pop();if(d)return d.reject(u),d.promise}function z(a,u){return new g(function(d,_){if(l[a.name]=l[a.name]||pn(),a.db){if(!u)return d(a.db);P(a),a.db.close()}var w=[a.name];u&&w.push(a.version);var b=s.open.apply(s,w);u&&(b.onupgradeneeded=function(C){var x=b.result;try{x.createObjectStore(a.storeName),C.oldVersion<=1&&x.createObjectStore(T)}catch(I){if(I.name!=="ConstraintError")throw I}}),b.onerror=function(C){C.preventDefault(),_(b.error)},b.onsuccess=function(){var C=b.result;C.onversionchange=function(x){x.target.close()},d(C),A(a)}})}function R(a){return z(a,!1)}function U(a){return z(a,!0)}function F(a,u){if(!a.db)return!0;var d=!a.db.objectStoreNames.contains(a.storeName),_=a.version<a.db.version,w=a.version>a.db.version;if(_&&(a.version,a.version=a.db.version),w||d){if(d){var b=a.db.version+1;b>a.version&&(a.version=b)}return!0}return!1}function ae(a){return new g(function(u,d){var _=new FileReader;_.onerror=d,_.onloadend=function(w){var b=btoa(w.target.result||"");u({__local_forage_encoded_blob:!0,data:b,type:a.type})},_.readAsBinaryString(a)})}function re(a){return p([m(atob(a.data))],{type:a.type})}function ve(a){return a&&a.__local_forage_encoded_blob}function Ye(a){var u=this,d=u._initReady().then(function(){var _=l[u._dbInfo.name];if(_&&_.dbReady)return _.dbReady});return k(d,a,a),d}function bt(a){P(a);for(var u=l[a.name],d=u.forages,_=0;_<d.length;_++){var w=d[_];w._dbInfo.db&&(w._dbInfo.db.close(),w._dbInfo.db=null)}return a.db=null,R(a).then(function(b){return a.db=b,F(a)?U(a):b}).then(function(b){a.db=u.db=b;for(var C=0;C<d.length;C++)d[C]._dbInfo.db=b}).catch(function(b){throw $(a,b),b})}function pe(a,u,d,_){_===void 0&&(_=1);try{var w=a.db.transaction(a.storeName,u);d(null,w)}catch(b){if(_>0&&(!a.db||b.name==="InvalidStateError"||b.name==="NotFoundError"))return g.resolve().then(function(){if(!a.db||b.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),U(a)}).then(function(){return bt(a).then(function(){pe(a,u,d,_-1)})}).catch(d);d(b)}}function pn(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Kr(a){var u=this,d={db:null};if(a)for(var _ in a)d[_]=a[_];var w=l[d.name];w||(w=pn(),l[d.name]=w),w.forages.push(u),u._initReady||(u._initReady=u.ready,u.ready=Ye);var b=[];function C(){return g.resolve()}for(var x=0;x<w.forages.length;x++){var I=w.forages[x];I!==u&&b.push(I._initReady().catch(C))}var L=w.forages.slice(0);return g.all(b).then(function(){return d.db=w.db,R(d)}).then(function(D){return d.db=D,F(d,u._defaultConfig.version)?U(d):D}).then(function(D){d.db=w.db=D,u._dbInfo=d;for(var O=0;O<L.length;O++){var q=L[O];q!==u&&(q._dbInfo.db=d.db,q._dbInfo.version=d.version)}})}function Yr(a,u){var d=this;a=N(a);var _=new g(function(w,b){d.ready().then(function(){pe(d._dbInfo,v,function(C,x){if(C)return b(C);try{var I=x.objectStore(d._dbInfo.storeName).get(a);I.onsuccess=function(){var L=I.result;L===void 0&&(L=null),ve(L)&&(L=re(L)),w(L)},I.onerror=function(){b(I.error)}}catch(L){b(L)}})}).catch(b)});return S(_,u),_}function Gr(a,u){var d=this,_=new g(function(w,b){d.ready().then(function(){pe(d._dbInfo,v,function(C,x){if(C)return b(C);try{var I=x.objectStore(d._dbInfo.storeName).openCursor(),L=1;I.onsuccess=function(){var D=I.result;if(D){var O=D.value;ve(O)&&(O=re(O));var q=a(O,D.key,L++);q!==void 0?w(q):D.continue()}else w()},I.onerror=function(){b(I.error)}}catch(D){b(D)}})}).catch(b)});return S(_,u),_}function Jr(a,u,d){var _=this;a=N(a);var w=new g(function(b,C){var x;_.ready().then(function(){return x=_._dbInfo,y.call(u)==="[object Blob]"?M(x.db).then(function(I){return I?u:ae(u)}):u}).then(function(I){pe(_._dbInfo,h,function(L,D){if(L)return C(L);try{var O=D.objectStore(_._dbInfo.storeName);I===null&&(I=void 0);var q=O.put(I,a);D.oncomplete=function(){I===void 0&&(I=null),b(I)},D.onabort=D.onerror=function(){var V=q.error?q.error:q.transaction.error;C(V)}}catch(V){C(V)}})}).catch(C)});return S(w,d),w}function Qr(a,u){var d=this;a=N(a);var _=new g(function(w,b){d.ready().then(function(){pe(d._dbInfo,h,function(C,x){if(C)return b(C);try{var I=x.objectStore(d._dbInfo.storeName).delete(a);x.oncomplete=function(){w()},x.onerror=function(){b(I.error)},x.onabort=function(){var L=I.error?I.error:I.transaction.error;b(L)}}catch(L){b(L)}})}).catch(b)});return S(_,u),_}function Zr(a){var u=this,d=new g(function(_,w){u.ready().then(function(){pe(u._dbInfo,h,function(b,C){if(b)return w(b);try{var x=C.objectStore(u._dbInfo.storeName).clear();C.oncomplete=function(){_()},C.onabort=C.onerror=function(){var I=x.error?x.error:x.transaction.error;w(I)}}catch(I){w(I)}})}).catch(w)});return S(d,a),d}function eo(a){var u=this,d=new g(function(_,w){u.ready().then(function(){pe(u._dbInfo,v,function(b,C){if(b)return w(b);try{var x=C.objectStore(u._dbInfo.storeName).count();x.onsuccess=function(){_(x.result)},x.onerror=function(){w(x.error)}}catch(I){w(I)}})}).catch(w)});return S(d,a),d}function to(a,u){var d=this,_=new g(function(w,b){a<0?w(null):d.ready().then(function(){pe(d._dbInfo,v,function(C,x){if(C)return b(C);try{var I=x.objectStore(d._dbInfo.storeName),L=!1,D=I.openKeyCursor();D.onsuccess=function(){var O=D.result;O?a===0||L?w(O.key):(L=!0,O.advance(a)):w(null)},D.onerror=function(){b(D.error)}}catch(O){b(O)}})}).catch(b)});return S(_,u),_}function no(a){var u=this,d=new g(function(_,w){u.ready().then(function(){pe(u._dbInfo,v,function(b,C){if(b)return w(b);try{var x=C.objectStore(u._dbInfo.storeName).openKeyCursor(),I=[];x.onsuccess=function(){var L=x.result;L?(I.push(L.key),L.continue()):_(I)},x.onerror=function(){w(x.error)}}catch(L){w(L)}})}).catch(w)});return S(d,a),d}function ro(a,u){u=j.apply(this,arguments);var d=this.config();(a=typeof a!="function"&&a||{}).name||(a.name=a.name||d.name,a.storeName=a.storeName||d.storeName);var _,w=this;if(a.name){var b=a.name===d.name&&w._dbInfo.db?g.resolve(w._dbInfo.db):R(a).then(function(C){var x=l[a.name],I=x.forages;x.db=C;for(var L=0;L<I.length;L++)I[L]._dbInfo.db=C;return C});_=a.storeName?b.then(function(C){if(C.objectStoreNames.contains(a.storeName)){var x=C.version+1;P(a);var I=l[a.name],L=I.forages;C.close();for(var D=0;D<L.length;D++){var O=L[D];O._dbInfo.db=null,O._dbInfo.version=x}var q=new g(function(V,K){var oe=s.open(a.name,x);oe.onerror=function(_e){oe.result.close(),K(_e)},oe.onupgradeneeded=function(){oe.result.deleteObjectStore(a.storeName)},oe.onsuccess=function(){var _e=oe.result;_e.close(),V(_e)}});return q.then(function(V){I.db=V;for(var K=0;K<L.length;K++){var oe=L[K];oe._dbInfo.db=V,A(oe._dbInfo)}}).catch(function(V){throw($(a,V)||g.resolve()).catch(function(){}),V})}}):b.then(function(C){P(a);var x=l[a.name],I=x.forages;C.close();for(var L=0;L<I.length;L++)I[L]._dbInfo.db=null;var D=new g(function(O,q){var V=s.deleteDatabase(a.name);V.onerror=function(){var K=V.result;K&&K.close(),q(V.error)},V.onblocked=function(){},V.onsuccess=function(){var K=V.result;K&&K.close(),O(K)}});return D.then(function(O){x.db=O;for(var q=0;q<I.length;q++)A(I[q]._dbInfo)}).catch(function(O){throw($(a,O)||g.resolve()).catch(function(){}),O})})}else _=g.reject("Invalid arguments");return S(_,u),_}var oo={_driver:"asyncStorage",_initStorage:Kr,_support:c(),iterate:Gr,getItem:Yr,setItem:Jr,removeItem:Qr,clear:Zr,length:eo,key:to,keys:no,dropInstance:ro};function io(){return typeof openDatabase=="function"}var be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",so="~~local_forage_type~",gn=/^~~local_forage_type~([^~]+)~/,Ge="__lfsc__:",St=Ge.length,Ct="arbf",Et="blob",mn="si08",vn="ui08",yn="uic8",wn="si16",_n="si32",bn="ur16",Sn="ui32",Cn="fl32",En="fl64",kn=St+Ct.length,xn=Object.prototype.toString;function In(a){var u,d,_,w,b,C=.75*a.length,x=a.length,I=0;a[a.length-1]==="="&&(C--,a[a.length-2]==="="&&C--);var L=new ArrayBuffer(C),D=new Uint8Array(L);for(u=0;u<x;u+=4)d=be.indexOf(a[u]),_=be.indexOf(a[u+1]),w=be.indexOf(a[u+2]),b=be.indexOf(a[u+3]),D[I++]=d<<2|_>>4,D[I++]=(15&_)<<4|w>>2,D[I++]=(3&w)<<6|63&b;return L}function kt(a){var u,d=new Uint8Array(a),_="";for(u=0;u<d.length;u+=3)_+=be[d[u]>>2],_+=be[(3&d[u])<<4|d[u+1]>>4],_+=be[(15&d[u+1])<<2|d[u+2]>>6],_+=be[63&d[u+2]];return d.length%3==2?_=_.substring(0,_.length-1)+"=":d.length%3==1&&(_=_.substring(0,_.length-2)+"=="),_}function ao(a,u){var d="";if(a&&(d=xn.call(a)),a&&(d==="[object ArrayBuffer]"||a.buffer&&xn.call(a.buffer)==="[object ArrayBuffer]")){var _,w=Ge;a instanceof ArrayBuffer?(_=a,w+=Ct):(_=a.buffer,d==="[object Int8Array]"?w+=mn:d==="[object Uint8Array]"?w+=vn:d==="[object Uint8ClampedArray]"?w+=yn:d==="[object Int16Array]"?w+=wn:d==="[object Uint16Array]"?w+=bn:d==="[object Int32Array]"?w+=_n:d==="[object Uint32Array]"?w+=Sn:d==="[object Float32Array]"?w+=Cn:d==="[object Float64Array]"?w+=En:u(new Error("Failed to get type for BinaryArray"))),u(w+kt(_))}else if(d==="[object Blob]"){var b=new FileReader;b.onload=function(){var C=so+a.type+"~"+kt(this.result);u(Ge+Et+C)},b.readAsArrayBuffer(a)}else try{u(JSON.stringify(a))}catch(C){u(null,C)}}function co(a){if(a.substring(0,St)!==Ge)return JSON.parse(a);var u,d=a.substring(kn),_=a.substring(St,kn);if(_===Et&&gn.test(d)){var w=d.match(gn);u=w[1],d=d.substring(w[0].length)}var b=In(d);switch(_){case Ct:return b;case Et:return p([b],{type:u});case mn:return new Int8Array(b);case vn:return new Uint8Array(b);case yn:return new Uint8ClampedArray(b);case wn:return new Int16Array(b);case bn:return new Uint16Array(b);case _n:return new Int32Array(b);case Sn:return new Uint32Array(b);case Cn:return new Float32Array(b);case En:return new Float64Array(b);default:throw new Error("Unkown type: "+_)}}var xt={serialize:ao,deserialize:co,stringToBuffer:In,bufferToString:kt};function Tn(a,u,d,_){a.executeSql("CREATE TABLE IF NOT EXISTS "+u.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],d,_)}function lo(a){var u=this,d={db:null};if(a)for(var _ in a)d[_]=typeof a[_]!="string"?a[_].toString():a[_];var w=new g(function(b,C){try{d.db=openDatabase(d.name,String(d.version),d.description,d.size)}catch(x){return C(x)}d.db.transaction(function(x){Tn(x,d,function(){u._dbInfo=d,b()},function(I,L){C(L)})},C)});return d.serializer=xt,w}function Se(a,u,d,_,w,b){a.executeSql(d,_,w,function(C,x){x.code===x.SYNTAX_ERR?C.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[u.storeName],function(I,L){L.rows.length?b(I,x):Tn(I,u,function(){I.executeSql(d,_,w,b)},b)},b):b(C,x)},b)}function uo(a,u){var d=this;a=N(a);var _=new g(function(w,b){d.ready().then(function(){var C=d._dbInfo;C.db.transaction(function(x){Se(x,C,"SELECT * FROM "+C.storeName+" WHERE key = ? LIMIT 1",[a],function(I,L){var D=L.rows.length?L.rows.item(0).value:null;D&&(D=C.serializer.deserialize(D)),w(D)},function(I,L){b(L)})})}).catch(b)});return S(_,u),_}function ho(a,u){var d=this,_=new g(function(w,b){d.ready().then(function(){var C=d._dbInfo;C.db.transaction(function(x){Se(x,C,"SELECT * FROM "+C.storeName,[],function(I,L){for(var D=L.rows,O=D.length,q=0;q<O;q++){var V=D.item(q),K=V.value;if(K&&(K=C.serializer.deserialize(K)),(K=a(K,V.key,q+1))!==void 0)return void w(K)}w()},function(I,L){b(L)})})}).catch(b)});return S(_,u),_}function Rn(a,u,d,_){var w=this;a=N(a);var b=new g(function(C,x){w.ready().then(function(){u===void 0&&(u=null);var I=u,L=w._dbInfo;L.serializer.serialize(u,function(D,O){O?x(O):L.db.transaction(function(q){Se(q,L,"INSERT OR REPLACE INTO "+L.storeName+" (key, value) VALUES (?, ?)",[a,D],function(){C(I)},function(V,K){x(K)})},function(q){if(q.code===q.QUOTA_ERR){if(_>0)return void C(Rn.apply(w,[a,I,d,_-1]));x(q)}})})}).catch(x)});return S(b,d),b}function fo(a,u,d){return Rn.apply(this,[a,u,d,1])}function po(a,u){var d=this;a=N(a);var _=new g(function(w,b){d.ready().then(function(){var C=d._dbInfo;C.db.transaction(function(x){Se(x,C,"DELETE FROM "+C.storeName+" WHERE key = ?",[a],function(){w()},function(I,L){b(L)})})}).catch(b)});return S(_,u),_}function go(a){var u=this,d=new g(function(_,w){u.ready().then(function(){var b=u._dbInfo;b.db.transaction(function(C){Se(C,b,"DELETE FROM "+b.storeName,[],function(){_()},function(x,I){w(I)})})}).catch(w)});return S(d,a),d}function mo(a){var u=this,d=new g(function(_,w){u.ready().then(function(){var b=u._dbInfo;b.db.transaction(function(C){Se(C,b,"SELECT COUNT(key) as c FROM "+b.storeName,[],function(x,I){var L=I.rows.item(0).c;_(L)},function(x,I){w(I)})})}).catch(w)});return S(d,a),d}function vo(a,u){var d=this,_=new g(function(w,b){d.ready().then(function(){var C=d._dbInfo;C.db.transaction(function(x){Se(x,C,"SELECT key FROM "+C.storeName+" WHERE id = ? LIMIT 1",[a+1],function(I,L){var D=L.rows.length?L.rows.item(0).key:null;w(D)},function(I,L){b(L)})})}).catch(b)});return S(_,u),_}function yo(a){var u=this,d=new g(function(_,w){u.ready().then(function(){var b=u._dbInfo;b.db.transaction(function(C){Se(C,b,"SELECT key FROM "+b.storeName,[],function(x,I){for(var L=[],D=0;D<I.rows.length;D++)L.push(I.rows.item(D).key);_(L)},function(x,I){w(I)})})}).catch(w)});return S(d,a),d}function wo(a){return new g(function(u,d){a.transaction(function(_){_.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(w,b){for(var C=[],x=0;x<b.rows.length;x++)C.push(b.rows.item(x).name);u({db:a,storeNames:C})},function(w,b){d(b)})},function(_){d(_)})})}function _o(a,u){u=j.apply(this,arguments);var d=this.config();(a=typeof a!="function"&&a||{}).name||(a.name=a.name||d.name,a.storeName=a.storeName||d.storeName);var _,w=this;return _=a.name?new g(function(b){var C;C=a.name===d.name?w._dbInfo.db:openDatabase(a.name,"","",0),a.storeName?b({db:C,storeNames:[a.storeName]}):b(wo(C))}).then(function(b){return new g(function(C,x){b.db.transaction(function(I){function L(V){return new g(function(K,oe){I.executeSql("DROP TABLE IF EXISTS "+V,[],function(){K()},function(_e,Rt){oe(Rt)})})}for(var D=[],O=0,q=b.storeNames.length;O<q;O++)D.push(L(b.storeNames[O]));g.all(D).then(function(){C()}).catch(function(V){x(V)})},function(I){x(I)})})}):g.reject("Invalid arguments"),S(_,u),_}var bo={_driver:"webSQLStorage",_initStorage:lo,_support:io(),iterate:ho,getItem:uo,setItem:fo,removeItem:po,clear:go,length:mo,key:vo,keys:yo,dropInstance:_o};function So(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ln(a,u){var d=a.name+"/";return a.storeName!==u.storeName&&(d+=a.storeName+"/"),d}function Co(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function Eo(){return!Co()||localStorage.length>0}function ko(a){var u=this,d={};if(a)for(var _ in a)d[_]=a[_];return d.keyPrefix=Ln(a,u._defaultConfig),Eo()?(u._dbInfo=d,d.serializer=xt,g.resolve()):g.reject()}function xo(a){var u=this,d=u.ready().then(function(){for(var _=u._dbInfo.keyPrefix,w=localStorage.length-1;w>=0;w--){var b=localStorage.key(w);b.indexOf(_)===0&&localStorage.removeItem(b)}});return S(d,a),d}function Io(a,u){var d=this;a=N(a);var _=d.ready().then(function(){var w=d._dbInfo,b=localStorage.getItem(w.keyPrefix+a);return b&&(b=w.serializer.deserialize(b)),b});return S(_,u),_}function To(a,u){var d=this,_=d.ready().then(function(){for(var w=d._dbInfo,b=w.keyPrefix,C=b.length,x=localStorage.length,I=1,L=0;L<x;L++){var D=localStorage.key(L);if(D.indexOf(b)===0){var O=localStorage.getItem(D);if(O&&(O=w.serializer.deserialize(O)),(O=a(O,D.substring(C),I++))!==void 0)return O}}});return S(_,u),_}function Ro(a,u){var d=this,_=d.ready().then(function(){var w,b=d._dbInfo;try{w=localStorage.key(a)}catch{w=null}return w&&(w=w.substring(b.keyPrefix.length)),w});return S(_,u),_}function Lo(a){var u=this,d=u.ready().then(function(){for(var _=u._dbInfo,w=localStorage.length,b=[],C=0;C<w;C++){var x=localStorage.key(C);x.indexOf(_.keyPrefix)===0&&b.push(x.substring(_.keyPrefix.length))}return b});return S(d,a),d}function Ao(a){var u=this.keys().then(function(d){return d.length});return S(u,a),u}function Mo(a,u){var d=this;a=N(a);var _=d.ready().then(function(){var w=d._dbInfo;localStorage.removeItem(w.keyPrefix+a)});return S(_,u),_}function Po(a,u,d){var _=this;a=N(a);var w=_.ready().then(function(){u===void 0&&(u=null);var b=u;return new g(function(C,x){var I=_._dbInfo;I.serializer.serialize(u,function(L,D){if(D)x(D);else try{localStorage.setItem(I.keyPrefix+a,L),C(b)}catch(O){O.name!=="QuotaExceededError"&&O.name!=="NS_ERROR_DOM_QUOTA_REACHED"||x(O),x(O)}})})});return S(w,d),w}function Do(a,u){if(u=j.apply(this,arguments),!(a=typeof a!="function"&&a||{}).name){var d=this.config();a.name=a.name||d.name,a.storeName=a.storeName||d.storeName}var _,w=this;return _=a.name?new g(function(b){a.storeName?b(Ln(a,w._defaultConfig)):b(a.name+"/")}).then(function(b){for(var C=localStorage.length-1;C>=0;C--){var x=localStorage.key(C);x.indexOf(b)===0&&localStorage.removeItem(x)}}):g.reject("Invalid arguments"),S(_,u),_}var Bo={_driver:"localStorageWrapper",_initStorage:ko,_support:So(),iterate:To,getItem:Io,setItem:Po,removeItem:Mo,clear:xo,length:Ao,key:Ro,keys:Lo,dropInstance:Do},$o=function(a,u){return a===u||typeof a=="number"&&typeof u=="number"&&isNaN(a)&&isNaN(u)},No=function(a,u){for(var d=a.length,_=0;_<d;){if($o(a[_],u))return!0;_++}return!1},An=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},He={},Mn={},De={INDEXEDDB:oo,WEBSQL:bo,LOCALSTORAGE:Bo},Wo=[De.INDEXEDDB._driver,De.WEBSQL._driver,De.LOCALSTORAGE._driver],Je=["dropInstance"],It=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Je),Oo={description:"",driver:Wo.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function zo(a,u){a[u]=function(){var d=arguments;return a.ready().then(function(){return a[u].apply(a,d)})}}function Tt(){for(var a=1;a<arguments.length;a++){var u=arguments[a];if(u)for(var d in u)u.hasOwnProperty(d)&&(An(u[d])?arguments[0][d]=u[d].slice():arguments[0][d]=u[d])}return arguments[0]}var jo=function(){function a(u){for(var d in o(this,a),De)if(De.hasOwnProperty(d)){var _=De[d],w=_._driver;this[d]=w,He[w]||this.defineDriver(_)}this._defaultConfig=Tt({},Oo),this._config=Tt({},this._defaultConfig,u),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(u){if((u===void 0?"undefined":r(u))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var d in u){if(d==="storeName"&&(u[d]=u[d].replace(/\W/g,"_")),d==="version"&&typeof u[d]!="number")return new Error("Database version must be a number.");this._config[d]=u[d]}return!("driver"in u)||!u.driver||this.setDriver(this._config.driver)}return typeof u=="string"?this._config[u]:this._config},a.prototype.defineDriver=function(u,d,_){var w=new g(function(b,C){try{var x=u._driver,I=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver)return void C(I);for(var L=It.concat("_initStorage"),D=0,O=L.length;D<O;D++){var q=L[D];if((!No(Je,q)||u[q])&&typeof u[q]!="function")return void C(I)}var V=function(){for(var oe=function(Uo){return function(){var qo=new Error("Method "+Uo+" is not implemented by the current driver"),Pn=g.reject(qo);return S(Pn,arguments[arguments.length-1]),Pn}},_e=0,Rt=Je.length;_e<Rt;_e++){var Lt=Je[_e];u[Lt]||(u[Lt]=oe(Lt))}};V();var K=function(oe){He[x],He[x]=u,Mn[x]=oe,b()};"_support"in u?u._support&&typeof u._support=="function"?u._support().then(K,C):K(!!u._support):K(!0)}catch(oe){C(oe)}});return k(w,d,_),w},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(u,d,_){var w=He[u]?g.resolve(He[u]):g.reject(new Error("Driver not found."));return k(w,d,_),w},a.prototype.getSerializer=function(u){var d=g.resolve(xt);return k(d,u),d},a.prototype.ready=function(u){var d=this,_=d._driverSet.then(function(){return d._ready===null&&(d._ready=d._initDriver()),d._ready});return k(_,u,u),_},a.prototype.setDriver=function(u,d,_){var w=this;An(u)||(u=[u]);var b=this._getSupportedDrivers(u);function C(){w._config.driver=w.driver()}function x(D){return w._extend(D),C(),w._ready=w._initStorage(w._config),w._ready}function I(D){return function(){var O=0;function q(){for(;O<D.length;){var V=D[O];return O++,w._dbInfo=null,w._ready=null,w.getDriver(V).then(x).catch(q)}C();var K=new Error("No available storage method found.");return w._driverSet=g.reject(K),w._driverSet}return q()}}var L=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=L.then(function(){var D=b[0];return w._dbInfo=null,w._ready=null,w.getDriver(D).then(function(O){w._driver=O._driver,C(),w._wrapLibraryMethodsWithReady(),w._initDriver=I(b)})}).catch(function(){C();var D=new Error("No available storage method found.");return w._driverSet=g.reject(D),w._driverSet}),k(this._driverSet,d,_),this._driverSet},a.prototype.supports=function(u){return!!Mn[u]},a.prototype._extend=function(u){Tt(this,u)},a.prototype._getSupportedDrivers=function(u){for(var d=[],_=0,w=u.length;_<w;_++){var b=u[_];this.supports(b)&&d.push(b)}return d},a.prototype._wrapLibraryMethodsWithReady=function(){for(var u=0,d=It.length;u<d;u++)zo(this,It[u])},a.prototype.createInstance=function(u){return new a(u)},a}(),Ho=new jo;e.exports=Ho},{3:3}]},{},[4])(4));yt(Si);var rr={exports:{}},Ci=(nr||(nr=1,function(n){((e,t)=>{n.exports=t()})(0,()=>{const e=typeof window=="object"?window:this;e.HTMLElement;let t=null,r=!1;const o=e.WebStreamsPolyfill||{},i=e.isSecureContext;let s=/constructor/i.test(e.HTMLElement)||!!e.safari||!!e.WebKitPoint;const c=i||"MozAppearance"in document.documentElement.style?"iframe":"navigate",p={createWriteStream:function(S,k,N){let j={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},T=0,f=null,l=null,y=null;if(Number.isFinite(k)?([N,k]=[k,N],j.size=N,j.writableStrategy=k):k&&k.highWaterMark?(j.size=N,j.writableStrategy=k):j=k||{},!s){t||(t=i?g(p.mitm):function(B){const M="width=200,height=100",P=document.createDocumentFragment(),A={frame:e.open(B,"popup",M),loaded:!1,isIframe:!1,isPopup:!0,remove(){A.frame.close()},addEventListener(...z){P.addEventListener(...z)},dispatchEvent(...z){P.dispatchEvent(...z)},removeEventListener(...z){P.removeEventListener(...z)},postMessage(...z){A.frame.postMessage(...z)}},$=z=>{z.source===A.frame&&(A.loaded=!0,e.removeEventListener("message",$),A.dispatchEvent(new Event("load")))};return e.addEventListener("message",$),A}(p.mitm)),l=new MessageChannel,S=encodeURIComponent(S.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const h={transferringReadable:r,pathname:j.pathname||Math.random().toString().slice(-6)+"/"+S,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+S}};j.size&&(h.headers["Content-Length"]=j.size);const m=[h,"*",[l.port2]];if(r){const B=c==="iframe"?void 0:{transform(P,A){if(!(P instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");T+=P.length,A.enqueue(P),f&&(location.href=f,f=null)},flush(){f&&(location.href=f)}};y=new p.TransformStream(B,j.writableStrategy,j.readableStrategy);const M=y.readable;l.port1.postMessage({readableStream:M},[M])}l.port1.onmessage=B=>{B.data.download?c==="navigate"?(t.remove(),t=null,T?location.href=B.data.download:f=B.data.download):(t.isPopup&&(t.remove(),t=null,c==="iframe"&&g(p.mitm)),g(B.data.download)):B.data.abort&&(v=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null)},t.loaded?t.postMessage(...m):t.addEventListener("load",()=>{t.postMessage(...m)},{once:!0})}let v=[];return!s&&y&&y.writable||new p.WritableStream({write(h){if(!(h instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");s?v.push(h):(l.port1.postMessage(h),T+=h.length,f&&(location.href=f,f=null))},close(){if(s){const h=new Blob(v,{type:"application/octet-stream; charset=utf-8"}),m=document.createElement("a");m.href=URL.createObjectURL(h),m.download=S,m.click()}else l.port1.postMessage("end")},abort(){v=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null}},j.writableStrategy)},WritableStream:e.WritableStream||o.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function g(S){if(!S)throw new Error("meh");const k=document.createElement("iframe");return k.hidden=!0,k.src=S,k.loaded=!1,k.name="iframe",k.isIframe=!0,k.postMessage=(...N)=>k.contentWindow.postMessage(...N),k.addEventListener("load",()=>{k.loaded=!0},{once:!0}),document.body.appendChild(k),k}try{new Response(new ReadableStream),i&&!("serviceWorker"in navigator)&&(s=!0)}catch{s=!0}return(S=>{try{S()}catch{}})(()=>{const{readable:S}=new TransformStream,k=new MessageChannel;k.port1.postMessage(S,[S]),k.port1.close(),k.port2.close(),r=!0,Object.defineProperty(p,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})}),p})}(rr)),rr.exports);yt(Ci);function Ei(n={},e={}){let t;for(t in e)cn(e[t])?n[t]=Ei(n[t],e[t]):n[t]=e[t];return n}function ki(n,e){const t=`${n}_${e}`;return he.MD5(t)}function xi(n){const e=function(c){if(!c)return;const p=c,g=[];if(p)for(let S of p){const k=Br(S);k&&g.push(k)}return g}(n.bussinessRoutes),t=function(c){if(!c)return;const p=c;if(p&&p.length>0){const g=[];return p.forEach(S=>{const k=$r(S);k&&g.push(k)}),g}}(n.widgetMenuConfig),r=function(c){if(c&&c.length>0){const p=[];return c.forEach(g=>{const S=function(k){return k?{id:k.id,label:k.label,container:k.container,preload:k.preload,afterid:k.afterid,bindid:k.bindid,group:k.group}:void 0}(g);S&&p.push(S)}),p}}(n.widgetConfig),o=function(c){if(c&&c.length>0)return c}(n.functionList),i=n.pkgObject.version,s=n.pkgObject.name;return{id:ki(s,i),name:W.Config.UI.SiteTitle,group:W.Config.UI.Group,product:s,version:i,routes:e,widgetMenu:t,widgets:r,functions:o}}function Br(n){if(n){let e=0;n.meta?.hidden&&(e=1);let t={path:n.path,name:n.name,title:n.meta?.title,type:e,index:n.meta?.index};if(n.children){const r=[];for(let o of n.children){const i=Br(o);i&&r.push(i)}r.length>0&&(t.children=r)}return t}}function $r(n){if(!n)return;const e={name:n.name,index:n.index,path:n.path,type:n.type};return n.children&&n.children.length>0&&(e.children=[],n.children.forEach(t=>{const r=$r(t);r&&e.children?.push(r)})),e}function Ps(n,e){const t=xi(n);pi(t,e),W.Message?.msg("导出系统功能权限文件成功！")}let Nr=!0;try{String.fromCharCode.apply(String,[1,2])}catch{Nr=!1,Object.defineProperty(Array.prototype,"subarray",{value:Array.prototype.slice})}var Zt=2654435769;function Wr(n,e){var t=n.length,r=t<<2;if(e){var o=n[t-1];if(o<(r-=4)-3||o>r)return null;r=o}for(var i=new Uint8Array(r),s=0;s<r;++s)i[s]=n[s>>2]>>((3&s)<<3);return i}function ht(n,e){var t,r=n.length,o=r>>2;3&r&&++o,e?(t=new Uint32Array(o+1))[o]=r:t=new Uint32Array(o);for(var i=0;i<r;++i)t[i>>2]|=n[i]<<((3&i)<<3);return t}function Te(n){return 4294967295&n}function dt(n,e,t,r,o,i){return(t>>>5^e<<2)+(e>>>3^t<<4)^(n^e)+(i[3&r^o]^t)}function Or(n){if(n.length<16){var e=new Uint8Array(16);e.set(n),n=e}return n}function ft(n){for(var e=n.length,t=new Uint8Array(3*e),r=0,o=0;o<e;o++){var i=n.charCodeAt(o);if(i<128)t[r++]=i;else if(i<2048)t[r++]=192|i>>6,t[r++]=128|63&i;else{if(!(i<55296||i>57343)){if(o+1<e){var s=n.charCodeAt(o+1);if(i<56320&&56320<=s&&s<=57343){var c=65536+((1023&i)<<10|1023&s);t[r++]=240|c>>18,t[r++]=128|c>>12&63,t[r++]=128|c>>6&63,t[r++]=128|63&c,o++;continue}}throw new Error("Malformed string")}t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|63&i}}return t.subarray(0,r)}function or(n){var e=n.length;return e===0?"":e<32767?function(t,r){for(var o=new Array(r),i=0,s=0,c=t.length;i<r&&s<c;i++){var p=t[s++];switch(p>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o[i]=p;break;case 12:case 13:if(!(s<c))throw new Error("Unfinished UTF-8 octet sequence");o[i]=(31&p)<<6|63&t[s++];break;case 14:if(!(s+1<c))throw new Error("Unfinished UTF-8 octet sequence");o[i]=(15&p)<<12|(63&t[s++])<<6|63&t[s++];break;case 15:if(!(s+2<c))throw new Error("Unfinished UTF-8 octet sequence");var g=((7&p)<<18|(63&t[s++])<<12|(63&t[s++])<<6|63&t[s++])-65536;if(!(0<=g&&g<=1048575))throw new Error("Character outside valid Unicode range: 0x"+g.toString(16));o[i++]=g>>10&1023|55296,o[i]=1023&g|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+p.toString(16))}}return i<r&&(o.length=i),String.fromCharCode.apply(String,o)}(n,e):function(t,r){for(var o=[],i=new Array(32768),s=0,c=0,p=t.length;s<r&&c<p;s++){var g=t[c++];switch(g>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i[s]=g;break;case 12:case 13:if(!(c<p))throw new Error("Unfinished UTF-8 octet sequence");i[s]=(31&g)<<6|63&t[c++];break;case 14:if(!(c+1<p))throw new Error("Unfinished UTF-8 octet sequence");i[s]=(15&g)<<12|(63&t[c++])<<6|63&t[c++];break;case 15:if(!(c+2<p))throw new Error("Unfinished UTF-8 octet sequence");var S=((7&g)<<18|(63&t[c++])<<12|(63&t[c++])<<6|63&t[c++])-65536;if(!(0<=S&&S<=1048575))throw new Error("Character outside valid Unicode range: 0x"+S.toString(16));i[s++]=S>>10&1023|55296,i[s]=1023&S|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+g.toString(16))}if(s>=32766){var k=s+1;i.length=k,o.push(String.fromCharCode.apply(String,i)),r-=k,s=-1}}return s>0&&(i.length=s,o.push(String.fromCharCode.apply(String,i))),o.join("")}(n,e)}function Ii(n){var e=n.length;if(e===0)return"";var t=Nr?n:function(c){for(var p=c.length,g=new Array(c.length),S=0;S<p;++S)g[S]=c[S];return g}(n);if(e<65535)return String.fromCharCode.apply(String,t);for(var r=32767&e,o=e>>15,i=new Array(r?o+1:o),s=0;s<o;++s)i[s]=String.fromCharCode.apply(String,t.subarray(s<<15,s+1<<15));return r&&(i[o]=String.fromCharCode.apply(String,t.subarray(o<<15,e))),i.join("")}function ir(n,e){return typeof n=="string"&&(n=ft(n)),typeof e=="string"&&(e=ft(e)),n==null||n.length===0?n:Wr(function(t,r){var o,i,s,c,p,g,S=t.length,k=S-1;for(i=t[k],s=0,g=0|Math.floor(6+52/S);g>0;--g){for(c=(s=Te(s+Zt))>>>2&3,p=0;p<k;++p)o=t[p+1],i=t[p]=Te(t[p]+dt(s,o,i,p,c,r));o=t[0],i=t[k]=Te(t[k]+dt(s,o,i,k,c,r))}return t}(ht(n,!0),ht(Or(e),!1)),!1)}function sr(n,e){return typeof n=="string"&&(n=function(t){for(var r=window.atob(t),o=r.length,i=new Uint8Array(o),s=0;s<o;s++)i[s]=r.charCodeAt(s);return i}(n)),typeof e=="string"&&(e=ft(e)),n==null||n.length===0?n:Wr(function(t,r){var o,i,s,c,p,g=t.length,S=g-1;for(o=t[0],s=Te(Math.floor(6+52/g)*Zt);s!==0;s=Te(s-Zt)){for(c=s>>>2&3,p=S;p>0;--p)i=t[p-1],o=t[p]=Te(t[p]-dt(s,o,i,p,c,r));i=t[S],o=t[0]=Te(t[0]-dt(s,o,i,0,c,r))}return t}(ht(n,!1),ht(Or(e),!1)),!0)}const en={toBytes:ft,toString:or,encrypt:ir,encryptToString:function(n,e){return window.btoa(Ii(ir(n,e)))},decrypt:sr,decryptToString:function(n,e){return or(sr(n,e))}};class Re extends Error{constructor(e,t){const r=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=r}}class ln extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class me extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Ti extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=r}}class Ri extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=r}}class Li extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=r}}class ar extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class Ai extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=r}}class zr{constructor(e,t,r){this.statusCode=e,this.statusText=t,this.content=r}}class wt{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var E;(function(n){n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None"})(E||(E={}));class Ve{constructor(){}log(e,t){}}Ve.instance=new Ve;class ee{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,r){if(!(e in t))throw new Error(`Unknown ${r} value: ${e}.`)}}class Q{static get isBrowser(){return!Q.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!Q.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!Q.isNode&&typeof window=="object"&&window.document===void 0}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function Ke(n,e){let t="";return Me(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function(r){const o=new Uint8Array(r);let i="";return o.forEach(s=>{i+=`0x${s<16?"0":""}${s.toString(16)} `}),i.substr(0,i.length-1)}(n)}'`)):typeof n=="string"&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function Me(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}async function jr(n,e,t,r,o,i){const s={},[c,p]=Oe();s[c]=p,n.log(E.Trace,`(${e} transport) sending data. ${Ke(o,i.logMessageContent)}.`);const g=Me(o)?"arraybuffer":"text",S=await t.post(r,{content:o,headers:{...s,...i.headers},responseType:g,timeout:i.timeout,withCredentials:i.withCredentials});n.log(E.Trace,`(${e} transport) request complete. Response status: ${S.statusCode}.`)}class Mi{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class pt{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const r=`[${new Date().toISOString()}] ${E[e]}: ${t}`;switch(e){case E.Critical:case E.Error:this.out.error(r);break;case E.Warning:this.out.warn(r);break;case E.Information:this.out.info(r);break;default:this.out.log(r)}}}}function Oe(){let n="X-SignalR-User-Agent";return Q.isNode&&(n="User-Agent"),[n,Pi("8.0.7",Di(),$i(),Bi())]}function Pi(n,e,t,r){let o="Microsoft SignalR/";const i=n.split(".");return o+=`${i[0]}.${i[1]}`,o+=` (${n}; `,o+=e&&e!==""?`${e}; `:"Unknown OS; ",o+=`${t}`,o+=r?`; ${r}`:"; Unknown Runtime Version",o+=")",o}function Di(){if(!Q.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Bi(){if(Q.isNode)return process.versions.node}function $i(){return Q.isNode?"NodeJS":"Browser"}function Ft(n){return n.stack?n.stack:n.message?n.message:`${n}`}class Ni extends wt{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||Q.isNode){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new me;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),r=new me});let o,i=null;if(e.timeout){const p=e.timeout;i=setTimeout(()=>{t.abort(),this._logger.log(E.Warning,"Timeout from HTTP request."),r=new ln},p)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},Me(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{o=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(p){throw r||(this._logger.log(E.Warning,`Error from HTTP request. ${p}.`),p)}finally{i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const p=await cr(o,"text");throw new Re(p||o.statusText,o.status)}const s=cr(o,e.responseType),c=await s;return new zr(o.status,o.statusText,c)}getCookieString(e){let t="";return Q.isNode&&this._jar&&this._jar.getCookies(e,(r,o)=>t=o.join("; ")),t}}function cr(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class Wi extends wt{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new me):e.method?e.url?new Promise((t,r)=>{const o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=e.withCredentials===void 0||e.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(Me(e.content)?o.setRequestHeader("Content-Type","application/octet-stream"):o.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const i=e.headers;i&&Object.keys(i).forEach(s=>{o.setRequestHeader(s,i[s])}),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{o.abort(),r(new me)}),e.timeout&&(o.timeout=e.timeout),o.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?t(new zr(o.status,o.statusText,o.response||o.responseText)):r(new Re(o.response||o.responseText||o.statusText,o.status))},o.onerror=()=>{this._logger.log(E.Warning,`Error from HTTP request. ${o.status}: ${o.statusText}.`),r(new Re(o.statusText,o.status))},o.ontimeout=()=>{this._logger.log(E.Warning,"Timeout from HTTP request."),r(new ln)},o.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Oi extends wt{constructor(e){if(super(),typeof fetch<"u"||Q.isNode)this._httpClient=new Ni(e);else{if(typeof XMLHttpRequest>"u")throw new Error("No usable HttpClient found.");this._httpClient=new Wi(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new me):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class fe{static write(e){return`${e}${fe.RecordSeparator}`}static parse(e){if(e[e.length-1]!==fe.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(fe.RecordSeparator);return t.pop(),t}}fe.RecordSeparatorCode=30,fe.RecordSeparator=String.fromCharCode(fe.RecordSeparatorCode);class zi{writeHandshakeRequest(e){return fe.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,r;if(Me(e)){const s=new Uint8Array(e),c=s.indexOf(fe.RecordSeparatorCode);if(c===-1)throw new Error("Message is incomplete.");const p=c+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(s.slice(0,p))),r=s.byteLength>p?s.slice(p).buffer:null}else{const s=e,c=s.indexOf(fe.RecordSeparator);if(c===-1)throw new Error("Message is incomplete.");const p=c+1;t=s.substring(0,p),r=s.length>p?s.substring(p):null}const o=fe.parse(t),i=JSON.parse(o[0]);if(i.type)throw new Error("Expected a handshake response from the server.");return[r,i]}}var H;(function(n){n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n[n.Ack=8]="Ack",n[n.Sequence=9]="Sequence"})(H||(H={}));class ji{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Mi(this,e)}}class Hi{constructor(e,t,r){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=r}async _send(e){const t=this._protocol.writeMessage(e);let r=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let o=()=>{},i=()=>{};Me(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(r=new Promise((s,c)=>{o=s,i=c})),this._messages.push(new Ui(t,this._totalMessageCount,o,i))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await r}_ack(e){let t=-1;for(let r=0;r<this._messages.length;r++){const o=this._messages[r];if(o._id<=e.sequenceId)t=r,Me(o._message)?this._bufferedByteCount-=o._message.byteLength:this._bufferedByteCount-=o._message.length,o._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;o._resolver()}}t!==-1&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type===H.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){e.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:H.Sequence,sequenceId:e}));const t=this._messages;for(const r of t)await this._connection.send(r._message);this._reconnectInProgress=!1}_dispose(e){e!=null||(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case H.Invocation:case H.StreamItem:case H.Completion:case H.StreamInvocation:case H.CancelInvocation:return!0;case H.Close:case H.Sequence:case H.Ping:case H.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:H.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class Ui{constructor(e,t,r,o){this._message=e,this._id=t,this._resolver=r,this._rejector=o}}var G;(function(n){n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting"})(G||(G={}));class un{static create(e,t,r,o,i,s,c){return new un(e,t,r,o,i,s,c)}constructor(e,t,r,o,i,s,c){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(E.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},ee.isRequired(e,"connection"),ee.isRequired(t,"logger"),ee.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=i??3e4,this.keepAliveIntervalInMilliseconds=s??15e3,this._statefulReconnectBufferSize=c??1e5,this._logger=t,this._protocol=r,this.connection=e,this._reconnectPolicy=o,this._handshakeProtocol=new zi,this.connection.onreceive=p=>this._processIncomingData(p),this.connection.onclose=p=>this._connectionClosed(p),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=G.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:H.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==G.Disconnected&&this._connectionState!==G.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==G.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=G.Connecting,this._logger.log(E.Debug,"Starting HubConnection.");try{await this._startInternal(),Q.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=G.Connected,this._connectionStarted=!0,this._logger.log(E.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=G.Disconnected,this._logger.log(E.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,r)=>{this._handshakeResolver=t,this._handshakeRejecter=r});await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const r={protocol:this._protocol.name,version:t};if(this._logger.log(E.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(r)),this._logger.log(E.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;this.connection.features.reconnect&&(this._messageBuffer=new Hi(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(t){throw this._logger.log(E.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){if(this._connectionState===G.Disconnected)return this._logger.log(E.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===G.Disconnecting)return this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=G.Disconnecting,this._logger.log(E.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(E.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===G.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new me("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._createStreamInvocation(e,t,o);let s;const c=new ji;return c.cancelCallback=()=>{const p=this._createCancelInvocation(i.invocationId);return delete this._callbacks[i.invocationId],s.then(()=>this._sendWithProtocol(p))},this._callbacks[i.invocationId]=(p,g)=>{g?c.error(g):p&&(p.type===H.Completion?p.error?c.error(new Error(p.error)):c.complete():c.next(p.item))},s=this._sendWithProtocol(i).catch(p=>{c.error(p),delete this._callbacks[i.invocationId]}),this._launchStreams(r,s),c}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._sendWithProtocol(this._createInvocation(e,t,!0,o));return this._launchStreams(r,i),i}invoke(e,...t){const[r,o]=this._replaceStreamingParams(t),i=this._createInvocation(e,t,!1,o);return new Promise((s,c)=>{this._callbacks[i.invocationId]=(g,S)=>{S?c(S):g&&(g.type===H.Completion?g.error?c(new Error(g.error)):s(g.result):c(new Error(`Unexpected message type: ${g.type}`)))};const p=this._sendWithProtocol(i).catch(g=>{c(g),delete this._callbacks[i.invocationId]});this._launchStreams(r,p)})}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const r=this._methods[e];if(r)if(t){const o=r.indexOf(t);o!==-1&&(r.splice(o,1),r.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const r of t)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(r))switch(r.type){case H.Invocation:this._invokeClientMethod(r).catch(o=>{this._logger.log(E.Error,`Invoke client method threw error: ${Ft(o)}`)});break;case H.StreamItem:case H.Completion:{const o=this._callbacks[r.invocationId];if(o){r.type===H.Completion&&delete this._callbacks[r.invocationId];try{o(r)}catch(i){this._logger.log(E.Error,`Stream callback threw error: ${Ft(i)}`)}}break}case H.Ping:break;case H.Close:{this._logger.log(E.Information,"Close message received from server.");const o=r.error?new Error("Server returned an error on close: "+r.error):void 0;r.allowReconnect===!0?this.connection.stop(o):this._stopPromise=this._stopInternal(o);break}case H.Ack:this._messageBuffer&&this._messageBuffer._ack(r);break;case H.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(r);break;default:this._logger.log(E.Warning,`Invalid message type: ${r.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,r;try{[r,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(o){const i="Error parsing handshake response: "+o;this._logger.log(E.Error,i);const s=new Error(i);throw this._handshakeRejecter(s),s}if(t.error){const o="Server returned handshake error: "+t.error;this._logger.log(E.Error,o);const i=new Error(o);throw this._handshakeRejecter(i),i}return this._logger.log(E.Debug,"Server handshake complete."),this._handshakeResolver(),r}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle!==void 0))){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===G.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),r=this._methods[t];if(!r)return this._logger.log(E.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(E.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const o=r.slice(),i=!!e.invocationId;let s,c,p;for(const g of o)try{const S=s;s=await g.apply(this,e.arguments),i&&s&&S&&(this._logger.log(E.Error,`Multiple results provided for '${t}'. Sending error to server.`),p=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),c=void 0}catch(S){c=S,this._logger.log(E.Error,`A callback for the method '${t}' threw error '${S}'.`)}p?await this._sendWithProtocol(p):i?(c?p=this._createCompletionMessage(e.invocationId,`${c}`,null):s!==void 0?p=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(E.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),p=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(p)):s&&this._logger.log(E.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(E.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new me("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===G.Disconnecting?this._completeClose(e):this._connectionState===G.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===G.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=G.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),Q.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(E.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let r=0,o=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),i=this._getNextRetryDelay(r++,0,o);if(i===null)return this._logger.log(E.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=G.Reconnecting,e?this._logger.log(E.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(E.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(s=>s.apply(this,[e]))}catch(s){this._logger.log(E.Error,`An onreconnecting callback called with error '${e}' threw error '${s}'.`)}if(this._connectionState!==G.Reconnecting)return void this._logger.log(E.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;i!==null;){if(this._logger.log(E.Information,`Reconnect attempt number ${r} will start in ${i} ms.`),await new Promise(s=>{this._reconnectDelayHandle=setTimeout(s,i)}),this._reconnectDelayHandle=void 0,this._connectionState!==G.Reconnecting)return void this._logger.log(E.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=G.Connected,this._logger.log(E.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(s=>s.apply(this,[this.connection.connectionId]))}catch(s){this._logger.log(E.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${s}'.`)}return}catch(s){if(this._logger.log(E.Information,`Reconnect attempt failed because of error '${s}'.`),this._connectionState!==G.Reconnecting)return this._logger.log(E.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===G.Disconnecting&&this._completeClose());o=s instanceof Error?s:new Error(s.toString()),i=this._getNextRetryDelay(r++,Date.now()-t,o)}}this._logger.log(E.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${r} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,r){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:r})}catch(o){return this._logger.log(E.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${o}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(r=>{const o=t[r];try{o(null,e)}catch(i){this._logger.log(E.Error,`Stream 'error' callback called with '${e}' threw error: ${Ft(i)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,r,o){if(r)return o.length!==0?{arguments:t,streamIds:o,target:e,type:H.Invocation}:{arguments:t,target:e,type:H.Invocation};{const i=this._invocationId;return this._invocationId++,o.length!==0?{arguments:t,invocationId:i.toString(),streamIds:o,target:e,type:H.Invocation}:{arguments:t,invocationId:i.toString(),target:e,type:H.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const r in e)e[r].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r)))},error:o=>{let i;i=o instanceof Error?o.message:o&&o.toString?o.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r,i)))},next:o=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(r,o)))}})}}_replaceStreamingParams(e){const t=[],r=[];for(let o=0;o<e.length;o++){const i=e[o];if(this._isObservable(i)){const s=this._invocationId;this._invocationId++,t[s]=i,r.push(s.toString()),e.splice(o,1)}}return[t,r]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,r){const o=this._invocationId;return this._invocationId++,r.length!==0?{arguments:t,invocationId:o.toString(),streamIds:r,target:e,type:H.StreamInvocation}:{arguments:t,invocationId:o.toString(),target:e,type:H.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:H.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:H.StreamItem}}_createCompletionMessage(e,t,r){return t?{error:t,invocationId:e,type:H.Completion}:{invocationId:e,result:r,type:H.Completion}}_createCloseMessage(){return{type:H.Close}}}const qi=[0,2e3,1e4,3e4,null];class lr{constructor(e){this._retryDelays=e!==void 0?[...e,null]:qi}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class Le{}Le.Authorization="Authorization",Le.Cookie="Cookie";class Fi extends wt{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const r=await this._innerClient.send(e);return t&&r.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):r}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[Le.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[Le.Authorization]&&delete e.headers[Le.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var te,se;(function(n){n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling"})(te||(te={})),function(n){n[n.Text=1]="Text",n[n.Binary=2]="Binary"}(se||(se={}));class Xi{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class ur{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,r){this._httpClient=e,this._logger=t,this._pollAbort=new Xi,this._options=r,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(ee.isRequired(e,"url"),ee.isRequired(t,"transferFormat"),ee.isIn(t,se,"transferFormat"),this._url=e,this._logger.log(E.Trace,"(LongPolling transport) Connecting."),t===se.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,o]=Oe(),i={[r]:o,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:i,timeout:1e5,withCredentials:this._options.withCredentials};t===se.Binary&&(s.responseType="arraybuffer");const c=`${e}&_=${Date.now()}`;this._logger.log(E.Trace,`(LongPolling transport) polling: ${c}.`);const p=await this._httpClient.get(c,s);p.statusCode!==200?(this._logger.log(E.Error,`(LongPolling transport) Unexpected response code: ${p.statusCode}.`),this._closeError=new Re(p.statusText||"",p.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const r=`${e}&_=${Date.now()}`;this._logger.log(E.Trace,`(LongPolling transport) polling: ${r}.`);const o=await this._httpClient.get(r,t);o.statusCode===204?(this._logger.log(E.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):o.statusCode!==200?(this._logger.log(E.Error,`(LongPolling transport) Unexpected response code: ${o.statusCode}.`),this._closeError=new Re(o.statusText||"",o.statusCode),this._running=!1):o.content?(this._logger.log(E.Trace,`(LongPolling transport) data received. ${Ke(o.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(o.content)):this._logger.log(E.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){this._running?r instanceof ln?this._logger.log(E.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=r,this._running=!1):this._logger.log(E.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{this._logger.log(E.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?jr(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(E.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(E.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,r]=Oe();e[t]=r;const o={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let i;try{await this._httpClient.delete(this._url,o)}catch(s){i=s}i?i instanceof Re&&(i.statusCode===404?this._logger.log(E.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(E.Trace,`(LongPolling transport) Error sending a DELETE request: ${i}`)):this._logger.log(E.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(E.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(E.Trace,e),this.onclose(this._closeError)}}}class Vi{constructor(e,t,r,o){this._httpClient=e,this._accessToken=t,this._logger=r,this._options=o,this.onreceive=null,this.onclose=null}async connect(e,t){return ee.isRequired(e,"url"),ee.isRequired(t,"transferFormat"),ee.isIn(t,se,"transferFormat"),this._logger.log(E.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((r,o)=>{let i,s=!1;if(t===se.Text){if(Q.isBrowser||Q.isWebWorker)i=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const c=this._httpClient.getCookieString(e),p={};p.Cookie=c;const[g,S]=Oe();p[g]=S,i=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...p,...this._options.headers}})}try{i.onmessage=c=>{if(this.onreceive)try{this._logger.log(E.Trace,`(SSE transport) data received. ${Ke(c.data,this._options.logMessageContent)}.`),this.onreceive(c.data)}catch(p){return void this._close(p)}},i.onerror=c=>{s?this._close():o(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},i.onopen=()=>{this._logger.log(E.Information,`SSE connected to ${this._url}`),this._eventSource=i,s=!0,r()}}catch(c){return void o(c)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})}async send(e){return this._eventSource?jr(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Ki{constructor(e,t,r,o,i,s){this._logger=r,this._accessTokenFactory=t,this._logMessageContent=o,this._webSocketConstructor=i,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let r;return ee.isRequired(e,"url"),ee.isRequired(t,"transferFormat"),ee.isIn(t,se,"transferFormat"),this._logger.log(E.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(r=await this._accessTokenFactory()),new Promise((o,i)=>{let s;e=e.replace(/^http/,"ws");const c=this._httpClient.getCookieString(e);let p=!1;if(Q.isNode||Q.isReactNative){const g={},[S,k]=Oe();g[S]=k,r&&(g[Le.Authorization]=`Bearer ${r}`),c&&(g[Le.Cookie]=c),s=new this._webSocketConstructor(e,void 0,{headers:{...g,...this._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);s||(s=new this._webSocketConstructor(e)),t===se.Binary&&(s.binaryType="arraybuffer"),s.onopen=g=>{this._logger.log(E.Information,`WebSocket connected to ${e}.`),this._webSocket=s,p=!0,o()},s.onerror=g=>{let S=null;S=typeof ErrorEvent<"u"&&g instanceof ErrorEvent?g.error:"There was an error with the transport",this._logger.log(E.Information,`(WebSockets transport) ${S}.`)},s.onmessage=g=>{if(this._logger.log(E.Trace,`(WebSockets transport) data received. ${Ke(g.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(g.data)}catch(S){return void this._close(S)}},s.onclose=g=>{if(p)this._close(g);else{let S=null;S=typeof ErrorEvent<"u"&&g instanceof ErrorEvent?g.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",i(new Error(S))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(E.Trace,`(WebSockets transport) sending data. ${Ke(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(E.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||e.wasClean!==!1&&e.code===1e3?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}class Yi{constructor(e,t={}){var r;if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,ee.isRequired(e,"url"),this._logger=(r=t.logger)===void 0?new pt(E.Information):r===null?Ve.instance:r.log!==void 0?r:new pt(r),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent!==void 0&&t.logMessageContent,typeof t.withCredentials!="boolean"&&t.withCredentials!==void 0)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=t.withCredentials===void 0||t.withCredentials,t.timeout=t.timeout===void 0?1e5:t.timeout;let o=null,i=null;if(Q.isNode&&typeof require<"u"){const s=typeof __webpack_require__=="function"?__non_webpack_require__:require;o=s("ws"),i=s("eventsource")}Q.isNode||typeof WebSocket>"u"||t.WebSocket?Q.isNode&&!t.WebSocket&&o&&(t.WebSocket=o):t.WebSocket=WebSocket,Q.isNode||typeof EventSource>"u"||t.EventSource?Q.isNode&&!t.EventSource&&i!==void 0&&(t.EventSource=i):t.EventSource=EventSource,this._httpClient=new Fi(t.httpClient||new Oi(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||se.Binary,ee.isIn(e,se,"transferFormat"),this._logger.log(E.Debug,`Starting connection with transfer format '${se[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(E.Error,t),await this._stopPromise,Promise.reject(new me(t))}if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(E.Error,t),Promise.reject(new me(t))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new hn(this.transport)),this._sendQueue.send(e))}async stop(e){return this._connectionState==="Disconnected"?(this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):this._connectionState==="Disconnecting"?(this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log(E.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(E.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==te.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(te.WebSockets),await this._startTransport(t,e)}else{let r=null,o=0;do{if(r=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new me("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(t=r.url),r.accessToken){const i=r.accessToken;this._accessTokenFactory=()=>i,this._httpClient._accessToken=i,this._httpClient._accessTokenFactory=void 0}o++}while(r.url&&o<100);if(o===100&&r.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,r,e)}this.transport instanceof ur&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(E.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(r){return this._logger.log(E.Error,"Failed to start the connection: "+r),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(r)}}async _getNegotiationResponse(e){const t={},[r,o]=Oe();t[r]=o;const i=this._resolveNegotiateUrl(e);this._logger.log(E.Debug,`Sending negotiation request: ${i}.`);try{const s=await this._httpClient.post(i,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(s.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${s.statusCode}'`));const c=JSON.parse(s.content);return(!c.negotiateVersion||c.negotiateVersion<1)&&(c.connectionToken=c.connectionId),c.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new ar("Client didn't negotiate Stateful Reconnect but the server did.")):c}catch(s){let c="Failed to complete negotiation with the server: "+s;return s instanceof Re&&s.statusCode===404&&(c+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(E.Error,c),Promise.reject(new ar(c))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,r,o){let i=this._createConnectUrl(e,r.connectionToken);if(this._isITransport(t))return this._logger.log(E.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(i,o),void(this.connectionId=r.connectionId);const s=[],c=r.availableTransports||[];let p=r;for(const g of c){const S=this._resolveTransportOrError(g,t,o,p?.useStatefulReconnect===!0);if(S instanceof Error)s.push(`${g.transport} failed:`),s.push(S);else if(this._isITransport(S)){if(this.transport=S,!p){try{p=await this._getNegotiationResponse(e)}catch(k){return Promise.reject(k)}i=this._createConnectUrl(e,p.connectionToken)}try{return await this._startTransport(i,o),void(this.connectionId=p.connectionId)}catch(k){if(this._logger.log(E.Error,`Failed to start the transport '${g.transport}': ${k}`),p=void 0,s.push(new Li(`${g.transport} failed: ${k}`,te[g.transport])),this._connectionState!=="Connecting"){const N="Failed to select transport before stop() was called.";return this._logger.log(E.Debug,N),Promise.reject(new me(N))}}}}return s.length>0?Promise.reject(new Ai(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case te.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Ki(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case te.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Vi(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case te.LongPolling:return new ur(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async r=>{let o=!1;if(this.features.reconnect){try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{o=!0}o&&this._stopConnection(r)}else this._stopConnection(r)}:this.transport.onclose=r=>this._stopConnection(r),this.transport.connect(e,t)}_resolveTransportOrError(e,t,r,o){const i=te[e.transport];if(i==null)return this._logger.log(E.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(s,c){return!s||(c&s)!=0}(t,i))return this._logger.log(E.Debug,`Skipping transport '${te[i]}' because it was disabled by the client.`),new Ri(`'${te[i]}' is disabled by the client.`,i);{if(!(e.transferFormats.map(s=>se[s]).indexOf(r)>=0))return this._logger.log(E.Debug,`Skipping transport '${te[i]}' because it does not support the requested transfer format '${se[r]}'.`),new Error(`'${te[i]}' does not support ${se[r]}.`);if(i===te.WebSockets&&!this._options.WebSocket||i===te.ServerSentEvents&&!this._options.EventSource)return this._logger.log(E.Debug,`Skipping transport '${te[i]}' because it is not supported in your environment.'`),new Ti(`'${te[i]}' is not supported in your environment.`,i);this._logger.log(E.Debug,`Selecting transport '${te[i]}'.`);try{return this.features.reconnect=i===te.WebSockets?o:void 0,this._constructTransport(i)}catch(s){return s}}}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(E.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState!=="Disconnected"){if(this._connectionState==="Connecting")throw this._logger.log(E.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(E.Error,`Connection disconnected with error '${e}'.`):this._logger.log(E.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(E.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(E.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(E.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!Q.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(E.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const r=new URLSearchParams(t.searchParams);return r.has("negotiateVersion")||r.append("negotiateVersion",this._negotiateVersion.toString()),r.has("useStatefulReconnect")?r.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&r.append("useStatefulReconnect","true"),t.search=r.toString(),t.toString()}}class hn{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Ze,this._transportResult=new Ze,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Ze),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Ze;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):hn._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(r){e.reject(r)}}}static _concatBuffers(e){const t=e.map(i=>i.byteLength).reduce((i,s)=>i+s),r=new Uint8Array(t);let o=0;for(const i of e)r.set(new Uint8Array(i),o),o+=i.byteLength;return r.buffer}}class Ze{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class Gi{constructor(){this.name="json",this.version=2,this.transferFormat=se.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=Ve.instance);const r=fe.parse(e),o=[];for(const i of r){const s=JSON.parse(i);if(typeof s.type!="number")throw new Error("Invalid payload.");switch(s.type){case H.Invocation:this._isInvocationMessage(s);break;case H.StreamItem:this._isStreamItemMessage(s);break;case H.Completion:this._isCompletionMessage(s);break;case H.Ping:case H.Close:break;case H.Ack:this._isAckMessage(s);break;case H.Sequence:this._isSequenceMessage(s);break;default:t.log(E.Information,"Unknown message type '"+s.type+"' ignored.");continue}o.push(s)}return o}writeMessage(e){return fe.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}}const Ji={trace:E.Trace,debug:E.Debug,info:E.Information,information:E.Information,warn:E.Warning,warning:E.Warning,error:E.Error,critical:E.Critical,none:E.None};class Qi{configureLogging(e){if(ee.isRequired(e,"logging"),e.log!==void 0)this.logger=e;else if(typeof e=="string"){const t=function(r){const o=Ji[r.toLowerCase()];if(o!==void 0)return o;throw new Error(`Unknown log level: ${r}`)}(e);this.logger=new pt(t)}else this.logger=new pt(e);return this}withUrl(e,t){return ee.isRequired(e,"url"),ee.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions=typeof t=="object"?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return ee.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new lr(e):this.reconnectPolicy=e:this.reconnectPolicy=new lr,this}withServerTimeout(e){return ee.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return ee.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e?.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Yi(this.url,e);return un.create(t,this.logger||Ve.instance,this.protocol||new Gi,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function Ds(n){const e=new Qi().configureLogging(E.Information).withUrl(n).withAutomaticReconnect({nextRetryDelayInMilliseconds:()=>5e3}).build();return e.keepAliveIntervalInMilliseconds=15e3,e.serverTimeoutInMilliseconds=18e5,e.start().then(()=>{W.Logger().info("启动SignalR连接！")}),e.onclose(async()=>{W.Logger().info("断开SignalR连接!")}),e.onreconnecting(()=>{W.Logger().warn("SignalR服务已断线，重连中...！")}),e.onreconnected(()=>{W.Logger().warn("SignalR重连成功!")}),e}const tn=new Set;function hr(n){return n!==null?parseFloat(n):0}function et(n){const e=window.getComputedStyle(n),t=Math.ceil([e.paddingLeft,e.width,e.paddingRight].map(hr).reduce((o,i)=>o+i)),r=Math.ceil([e.paddingTop,e.height,e.paddingBottom].map(hr).reduce((o,i)=>o+i));return{width:t,height:r}}class Zi{width;height;constructor(e,t){this.width=e,this.height=t}}function es(n){const e=n.windowEl;if(e){const t=parseFloat(e.style.left||"NaN"),r=parseFloat(e.style.top||"NaN");if(!isNaN(t)&&!isNaN(r))return{left:t,top:r}}return null}function ts(n,e,t,r){const o=n-t,i=e-r;return o*o+i*i}window.addEventListener("resize",n=>{tn.forEach(e=>{e&&ui(e.fixPosition)&&e.fixPosition()})});const tt=[];var dr=Pe({name:"VWindow",props:{windowStyle:{type:Object,required:!0},isOpen:{type:Boolean,required:!1,default:!0},title:{type:String,required:!0,default:""},closeButton:{type:Boolean,required:!1,default:!0},resizable:{type:Boolean,required:!1,default:!1},isScrollable:{type:Boolean,required:!1,default:!1},padding:{type:Number,required:!1,default:8},activateWhenOpen:{type:Boolean,required:!1,default:!0},positionHint:{type:String,required:!1,default:""},zGroup:{type:Number,required:!1,default:1},overflow:{type:String,required:!1,default:"visible"},minWidth:{type:Number,required:!1,default:1},minHeight:{type:Number,required:!1,default:0},maxWidth:{type:Number,required:!1,default:0},maxHeight:{type:Number,required:!1,default:0},height:{type:Number,required:!1},width:{type:Number,required:!1},top:{type:Number,required:!1},left:{type:Number,required:!1}},components:{myButton:at},setup(n,{emit:e}){const t=Zo();if(!t)return;const{proxy:r}=t;let o=0,i,s,c;const p=Y(n.isOpen),g=()=>{tt.push(r),c=new si(n.zGroup,S),n.isOpen&&function(M){br(()=>{o++==0&&(v(r),function(){const P=k.value,{width:A,height:$}=Jt(P);let z,R;if(n.left!==void 0!=(n.top!==void 0))throw new Error("Either of left or top is specified. Both must be set or not set.");if(typeof n.left=="number")z=n.left,R=n.top;else{const U=n.positionHint||"auto";switch(U){case"auto":{let F=20,ae=50,re=0;do{if(tt.every(ve=>{if(!ve.isOpen||r==ve)return!0;const Ye=es(ve);if(Ye==null)return!0;const{left:bt,top:pe}=Ye;return ts(bt,pe,F,ae)>16}))break;F=(F+40)%(window.innerWidth-200),ae=(ae+40)%(window.innerHeight-200)}while(++re<100);z=F,R=ae}break;case"center":z=(window.innerWidth-A)/2,R=(window.innerHeight-$)/2;break;default:try{const F=U.split("/").map(Number);if(F.length!=2)throw null;const[ae,re]=F;if(!isFinite(ae)||!isFinite(re))throw null;z=ae>=0?ae:window.innerWidth-A+ae,R=re>=0?re:window.innerHeight-$+re}catch{throw new Error(`invalid position string: ${U}`)}}}P&&(P.style.left=`${z}px`,P.style.top=`${R}px`)}()),n.resizable&&h(),B(),i=new ii(N.value,k.value,{onMove:()=>B(),onMoveStart:()=>e("move-start"),onMoveEnd:()=>e("move-end")}),n.resizable&&function(){const{height:P}=Jt(N.value);s=new ai(k.value,{onResize:()=>h(),onResizeStart:()=>e("resize-start"),onResizeEnd:()=>e("resize-end"),minWidth:n.minWidth,minHeight:n.minHeight+P,maxWidth:n.maxWidth,maxHeight:n.maxHeight?n.maxHeight+P:void 0})}()}),n.activateWhenOpen&&T()}(),tn.add(r)};function S(M){f.value.zIndex=`${M}`}const k=Y(null),N=Y(null),j=Y(null);function T(){c.raise(),e("activate")}const f=Y({...n.windowStyle.window,zIndex:"auto",overflow:n.overflow}),l=Ne(()=>n.windowStyle.titlebar),y=Ne(()=>{const M={...n.windowStyle.content};return n.resizable?M.padding="0":n.padding!=null&&(M.padding=`${n.padding}px`),n.isScrollable&&(M.overflow="auto"),M});function v(M){const{width:P,height:A,top:$,left:z}=M,R=k;if(R&&P!=null&&(R.value.style.width=`${P}px`),A!=null){const U=N.value;if(U){const F=et(U).height;R.value.style.height=`${A+F}px`}}R&&z!=null&&(R.value.style.left=`${z}px`),R&&$!=null&&(R.value.style.top=`${$}px`)}function h(M=!0){const P=k.value,A=N.value,$=j.value;if($&&P&&A){const{width:z,height:R}=et($),{width:U,height:F}=et(P),ae=et(A).height,re=U-($.offsetWidth-z),ve=F-ae-($.offsetHeight-R);$.style.width=`${re}px`,$.style.height=`${ve}px`,m(),e("resize",new Zi(re,ve)),M&&(e("update:width",re),e("update:height",ve))}}function m(){const M=k.value;if(M){const P=M.getBoundingClientRect();P.left<0&&(f.value.left="0px"),P.top<0&&(f.value.top="0px"),P.right>window.innerWidth&&(f.value.left=window.innerWidth-P.width+"px"),P.bottom>window.innerHeight&&(f.value.top=window.innerHeight-P.height+"px")}}function B(M=!0){m();const P=k.value;if(P){const{left:A,top:$}=P.getBoundingClientRect();M&&(e("update:left",A),e("update:top",$))}}return xe(()=>n.isOpen,M=>{p.value=M}),xe(()=>n.zGroup,M=>{c.group=M}),xe(()=>n.width,M=>{v({width:M}),h(!1)}),xe(()=>n.height,M=>{v({height:M}),h(!1)}),sn(()=>{g()}),Jo(()=>{tn.delete(this),c.unregister(),s&&s.teardown(),i&&i.teardown(),tt.splice(tt.indexOf(r),1)}),{isOpen:p,windowEl:k,titlebar:N,content:j,activate:T,styleWindow:f,styleTitlebar:l,styleContent:y,closeButtonClick:function(){p.value=!1,e("closebuttonclick")},fixPosition:m}}});const ns={class:"title"};var fr;dr.render=function(n,e,t,r,o,i){const s=mt("myButton");return X(),Z(vr,{name:"fade",onAfterLeave:e[2]||(e[2]=c=>n.$emit("close")),onAfterEnter:e[3]||(e[3]=c=>n.$emit("open")),persisted:""},{default:we(()=>[yr(J("div",{class:"window",style:ge(n.styleWindow),ref:"windowEl",onMousedown:e[0]||(e[0]=(...c)=>n.activate&&n.activate(...c)),onTouchstart:e[1]||(e[1]=(...c)=>n.activate&&n.activate(...c))},[J("div",{class:"titlebar",style:ge(n.styleTitlebar),ref:"titlebar"},[J("div",ns,[n.$slots.title?ie(n.$slots,"title",{key:0}):(X(),de(Ee,{key:1},[Yt(on(n.title),1)],64))]),n.closeButton?(X(),Z(s,{key:0,windowStyle:n.windowStyle,onClick:n.closeButtonClick},{default:we(()=>e[4]||(e[4]=[Yt("×")])),_:1},8,["windowStyle","onClick"])):ne("v-if",!0)],4),J("div",{class:"content",style:ge(n.styleContent),ref:"content"},[ie(n.$slots,"default")],4)],36),[[wr,n.isOpen]])]),_:3})},dr.__file="src/controls/vuewindow/window/index.vue",function(n){n[n.StyleBlack=0]="StyleBlack",n[n.StyleWhite=1]="StyleWhite",n[n.StyleMetal=2]="StyleMetal",n[n.StyleGrayblue=3]="StyleGrayblue"}(fr||(fr={}));var le;(function(n){n[n.top=0]="top",n[n.bottom=1]="bottom",n[n.centerBack=2]="centerBack",n[n.centerMain=3]="centerMain",n[n.centerFront=4]="centerFront",n[n.left=5]="left",n[n.right=6]="right"})(le||(le={}));class rs{layoutState;layoutMap=new Map;preConditionMap=new Map;widgetsLoadedSet=new Set;widgetConfig=new Array;_LayoutID;_mapItemRefs;constructor(e,t,r,o){this.layoutState=e,this._LayoutID=r,this._mapItemRefs=o,t.forEach(i=>{if(i.layoutID===r&&(this.widgetConfig.push(i),i.afterid))if(this.preConditionMap.has(i.afterid))this.preConditionMap.get(i.afterid)?.add(i);else{const s=new Set;s.add(i),this.preConditionMap.set(i.afterid,s)}})}getLayoutID(){return this._LayoutID}getWidgetConfig(){return this.widgetConfig}preloadWidgets(){this.widgetConfig.filter(e=>e.preload&&!e.afterid).forEach(e=>{this._loadWidget(e)})}async loadWidget(e){if(!e)return;let t;if(cn(e)?t=e:Er(e)&&(t=this.widgetConfig.find(r=>r.id===e)),t){if(t.afterid){if(this.isWidgetLoaded(t.afterid))return this._loadWidget(t);{let r=function(c){c.layoutID===o._LayoutID&&c.widgetID===i&&(o._loadWidget(s),W.EventBus.off(ue.WidgetLoadedEvent,r))};const o=this,i=t.afterid,s=t;return W.EventBus.on(ue.WidgetLoadedEvent,r),this.loadWidget(t.afterid)}}return this._loadWidget(t)}}loadOtherDependenceWidgets(e){this.preConditionMap.has(e)&&this.preConditionMap.get(e)?.forEach(t=>{t.preload&&this._loadWidget(t)})}_loadWidget(e){if(!this.widgetsLoadedSet.has(e.id))return e.component?e.component().then(t=>{if(t.default){const r=Qo(t.default);e.layout&&(r.style=e.layout),e.cssClass&&(r.cssClass=e.cssClass),this.getContainerComponents(e.container).value.set(e.id,r),this.widgetsLoadedSet.add(e.id),br().then(()=>{W.EventBus.emit(ue.WidgetLoadedEvent,{layoutID:this._LayoutID,widgetID:e.id}),this.loadOtherDependenceWidgets(e.id)})}}).catch(t=>{W.Logger().error("加载Widget失败！",e),W.EventBus.emit(ue.WidgetLoadedErrorEvent,e)}):void 0;this.changeWidgetVisible(e.id,!0)}hasDependentWidgets(e){let t=!1;if(this.preConditionMap.has(e)){const r=this.preConditionMap.get(e);if(r){for(const o of r)if(this.isWidgetLoaded(o.id)){t=!0;break}}}return t}unloadWidget(e){if(!e||!this.isWidgetLoaded(e))return;const t=this.widgetConfig.find(r=>r.id===e);if(t){if(this.preConditionMap.has(e)){const r=this.preConditionMap.get(e);if(r)for(const o of r)this.unloadWidget(o.id)}this.getContainerComponents(t.container).value.delete(e),this.widgetsLoadedSet.delete(e),this._mapItemRefs&&this._mapItemRefs.delete(e),W.EventBus.emit(ue.WidgetUnLoadedEvent,{layoutID:this._LayoutID,widgetID:e})}}isWidgetLoaded(e){return this.widgetsLoadedSet.has(e)}splitTwoContainer(e=!1){const t=this.layoutState.centerMainContainer,r=this.layoutState.centerBackContainer;e?(t&&(t.style.left="0",t.style.width="100%"),r&&(r.style.width="100%")):(t&&(t.style.left="50%",t.style.width="50%"),r&&(r.style.width="50%"))}getLayoutContainer(e){switch(e){case le.top:return this.layoutState.topContainer;case le.bottom:return this.layoutState.bottomContainer;case le.left:return this.layoutState.leftContainer;case le.right:return this.layoutState.rightContainer;case le.centerBack:return this.layoutState.centerBackContainer;case le.centerMain:return this.layoutState.centerMainContainer;case le.centerFront:return this.layoutState.centerFrontContainer}}changeContainerVisible(e,t=!1){const r=this.getLayoutContainer(e);r&&(r.style.visibility=t?"visible":"hidden")}changeWidgetVisible(e,t=!1){const r=this.getWidgetComponent(e);r&&r.changeVisible&&r.changeVisible(t)}isWidgetVisible(e){const t=this.getWidgetComponent(e);return!!t&&(!t.isShow||t.isShow.value)}getWidgetComponent(e){if(this.widgetsLoadedSet.has(e)&&this._mapItemRefs)return this._mapItemRefs.get(e)}getWigetItem(e){return this.widgetConfig.find(t=>t.id===e)}getGroupWigetItems(e){return this.widgetConfig.filter(t=>t.group===e)}getContainerComponents(e){if(this.layoutMap.has(e))return this.layoutMap.get(e);{const t=Y(new Map);return this.layoutMap.set(e,t),t}}getWidgetLoadedIDList(){const e=[];return this.widgetsLoadedSet.forEach(t=>{e.push(t)}),e}unloadAllWidgets(e){const t=[];this.widgetsLoadedSet.forEach(r=>{e&&e.length>0?e.findIndex(o=>o===r)<0&&t.push(r):t.push(r)}),t.forEach(r=>this.unloadWidget(r))}unloadWidgets(e){e&&e.length>0&&e.forEach(t=>{this.unloadWidget(t)})}static getLayoutManager(e,t){if(t){const r=t.find(o=>o.id===e);if(r&&r.layoutID)return W.LayoutMap.get(r.layoutID)}}}var gt=Pe({name:"SuspenseWithError",setup(){const n=Y(null);return Xo(e=>(n.value="当前页面存在问题，无法渲染……",!0)),{error:n}}});gt.render=function(n,e,t,r,o,i){return n.error?ie(n.$slots,"error",{key:0},()=>[Yt(on(n.error),1)]):(X(),Z(Fo,{key:1},{default:we(()=>[ie(n.$slots,"default")]),fallback:we(()=>[ie(n.$slots,"fallback")]),_:3}))},gt.__file="src/controls/routertransition/SuspenseWithError.vue";var Hr=Pe({name:"RouterTransition",__name:"RouterTransition",setup:n=>(e,t)=>{const r=mt("router-view");return X(),Z(gt,null,{default:we(()=>[lt(r,null,{default:we(({Component:o,route:i})=>[ne(" <transition> "),(X(),Z(_r,null,[i.meta.keepAlive?(X(),Z(ye(o),{key:i.name})):ne("v-if",!0)],1024)),i.meta.keepAlive?ne("v-if",!0):(X(),Z(ye(o),{key:i.name})),ne(" </transition> ")]),_:1})]),_:1})}});Hr.__file="src/controls/routertransition/RouterTransition.vue";var Xt=Pe({name:"LayoutContainer",props:{widgetConfig:{type:Array,required:!0,default:()=>[]},layoutID:{type:String,default:void 0},layoutStyle:{type:Object},enableRouterView:{type:Boolean,default:!0}},emits:["containerLoaded"],components:{RouterTransition:Hr},setup(n,{attrs:e,slots:t,emit:r}){const o=n.layoutID,i=Y(n.enableRouterView);xe(()=>n.enableRouterView,()=>{i.value=n.enableRouterView});const s=Vo({topContainer:void 0,centerBackContainer:void 0,centerMainContainer:void 0,centerFrontContainer:void 0,bottomContainer:void 0,leftContainer:void 0,rightContainer:void 0}),c=new Map,p=new rs(s,n.widgetConfig,o,c),g=f(le.top),S=f(le.centerBack),k=f(le.centerFront),N=f(le.left),j=f(le.right),T=f(le.bottom);function f(y){return p?.getContainerComponents(y)}const l=Ne(()=>n.layoutStyle);return sn(()=>{p&&(o?W.LayoutMap.set(o,p):(W.LayoutManager=p,W.LayoutMap.set("",p)),p.preloadWidgets(),r("containerLoaded",{layoutID:o,layoutManager:p}),W.EventBus.emit(ue.LayoutContainerLoaded,{layoutID:o,layoutManager:p}))}),{...Ko(s),topContainerComponents:g,centerbackComponents:S,centerfrontComponents:k,leftContainerComponents:N,rightContainerComponents:j,bottomContainerComponents:T,containerStyle:l,isEnableRouterView:i,setItemRef:(y,v)=>{y&&c.set(v,y)}}}});const os={ref:"topContainer",class:"topContainer"},is={key:0,ref:"centerMainContainer",class:"centerdiv mainContainer"},ss={ref:"centerBackContainer",class:"centerdiv backContainer"},as={ref:"centerFrontContainer",class:"centerdiv centerFrontContainer"},cs={ref:"leftContainer",class:"leftContainer"},ls={ref:"rightContainer",class:"rightContainer"},us={ref:"bottomContainer",class:"bottomContainer"};Xt.render=function(n,e,t,r,o,i){const s=mt("router-transition");return X(),de("div",{class:"layoutContainer",style:ge(n.containerStyle)},[J("div",os,[ie(n.$slots,"top"),(X(!0),de(Ee,null,Be(n.topContainerComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512),J("div",null,[ne(" 主要容器-底部 "),n.isEnableRouterView?(X(),de("div",is,[ie(n.$slots,"main",{},()=>[lt(s)])],512)):ne("v-if",!0),ne(" 上一层-主容器 "),J("div",ss,[ie(n.$slots,"back"),(X(!0),de(Ee,null,Be(n.centerbackComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512),ne(" 最上浮动-主容器 "),J("div",as,[ie(n.$slots,"front"),(X(!0),de(Ee,null,Be(n.centerfrontComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512),J("div",cs,[ie(n.$slots,"left"),(X(!0),de(Ee,null,Be(n.leftContainerComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512),J("div",ls,[ie(n.$slots,"right"),(X(!0),de(Ee,null,Be(n.rightContainerComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512)]),J("div",us,[ie(n.$slots,"bottom"),(X(!0),de(Ee,null,Be(n.bottomContainerComponents,([c,p])=>(X(),Z(ye(p),{ref_for:!0,ref:g=>n.setItemRef(g,c),key:c,style:ge(p.style),class:ke(p.cssClass)},null,8,["style","class"]))),128))],512),ne(" 增加默认插槽 "),ie(n.$slots,"default")],4)},Xt.__scopeId="data-v-4d081e5c",Xt.__file="src/controls/layoutcontainer/layout.vue";var hs=Pe({name:"RouterTransition",__name:"RouterTransitionAnimate",props:{enterActive:{type:String,required:!1,default:"animated fadeIn"},leaveActive:{type:String,required:!1,default:"animated fadeOut"}},setup:n=>(e,t)=>{const r=mt("router-view");return X(),Z(gt,null,{default:we(()=>[lt(r,null,{default:we(({Component:o,route:i})=>[lt(Yo,{appear:"","enter-active-class":e.enterActive,"leave-active-class":e.leaveActive},{default:we(()=>[(X(),Z(_r,null,[i.meta.keepAlive?(X(),Z(ye(o),{key:i.name})):ne("v-if",!0)],1024)),i.meta.keepAlive?ne("v-if",!0):(X(),Z(ye(o),{key:i.name}))]),_:2},1032,["enter-active-class","leave-active-class"])]),_:1})]),_:1})}});hs.__file="src/controls/routertransition/RouterTransitionAnimate.vue";const Ue=new Map,ct=Y(new Map);class nt{static addWindowPanel(e){Ue.set(e.id,e)}static removeWindowPanel(e){Ue.has(e)&&(Ue.delete(e),ct.value.delete(e))}static minimizeWindowPanel(e){Ue.has(e)&&ct.value.set(e,-1)}static openWindowPanel(e){Ue.has(e)&&ct.value.set(e,1)}}const ds=["src"],fs={key:1,class:"paneltitle"},ps={class:"dragPanelBar"},gs={class:"dragPanelContent"},ms={class:"drag-pointer-group"};var pr=Pe({__name:"XWindow",props:{top:{type:[String,Number],default:0},left:{type:[String,Number],default:0},nWidth:{type:[String,Number],default:"300px"},nHeight:{type:[String,Number],default:"400px"},icon:{type:String,default:"img/logo.png"},title:{type:String,default:""},titleHeight:{type:[String,Number],default:"40px"},hasMin:{type:Boolean,default:!0},hasMax:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!0},isDark:{type:Boolean,default:!1},pid:{type:String,default:""},tag:{type:[String,Array,Object,Number],default:""}},emits:["close","open","loaded","minimize"],setup(n,{expose:e,emit:t}){const r=di(),o=n,i=t,s=Y(),c=Y(),p=Ne(()=>o.isDark),g=Y({x:0,y:0}),S=250,k=100,N=Y({width:0,height:0}),j=R=>{s.value&&(s.value.style.left=`${R.x}px`,s.value.style.top=`${R.y}px`)};xe(()=>g.value,R=>{j(R)});const T=R=>{s.value&&(s.value.style.width=`${R.width}px`,s.value.style.height=`${R.height}px`)};xe(()=>N.value,R=>{T(R)});const f={eventListenerController:null,startingEdges:null,newEdges:null,clickStart:null,mount:()=>{Object.entries(f.refs).forEach(([R,U])=>{U.value&&U.value.addEventListener("mousedown",F=>{f.mouseDown(F,R)})})},mouseDown:(R,U)=>{R.button==0&&(R.preventDefault(),f.startingEdges={left:g.value.x,top:g.value.y,right:g.value.x+N.value.width,bottom:g.value.y+N.value.height},f.newEdges={...f.startingEdges},f.clickStart={x:R.clientX,y:R.clientY},f.eventListenerController=new AbortController,document.addEventListener("mousemove",F=>{f.mouseMove(F,U)},{signal:f.eventListenerController.signal}),document.addEventListener("mouseup",F=>{f.mouseUp(F,U)},{signal:f.eventListenerController.signal}))},mouseMove:(R,U)=>{if(f.startingEdges!=null&&f.newEdges!=null&&f.clickStart!=null&&f.refs[U].value){if(R.preventDefault(),U.toLowerCase().includes("north")){f.newEdges.top=Math.max(f.startingEdges.top+R.clientY-f.clickStart.y,0);const F=f.newEdges.bottom-f.newEdges.top-k;F<0&&(f.newEdges.top+=F)}else U.toLowerCase().includes("south")&&(f.newEdges.bottom=Math.min(f.startingEdges.bottom+R.clientY-f.clickStart.y,document.body.clientHeight));if(U.toLowerCase().includes("west")){f.newEdges.left=Math.max(f.startingEdges.left+R.clientX-f.clickStart.x,0);const F=f.newEdges.right-f.newEdges.left-S;F<0&&(f.newEdges.left+=F)}else U.toLowerCase().includes("east")&&(f.newEdges.right=Math.min(f.startingEdges.right+R.clientX-f.clickStart.x,document.body.clientWidth));f.update()}},update:()=>{f.newEdges==null||f.startingEdges==null||(g.value={x:Math.max(f.newEdges.left,0),y:Math.max(f.newEdges.top,0)},N.value={width:Math.min(Math.max(f.newEdges.right-f.newEdges.left,S),document.body.clientWidth),height:Math.min(Math.max(f.newEdges.bottom-f.newEdges.top,k),document.body.clientHeight)})},mouseUp:(R,U)=>{R.button!=0||f.startingEdges==null||(R.preventDefault(),f.startingEdges=null,f.newEdges=null,f.clickStart=null,f.eventListenerController&&(f.eventListenerController.abort(),f.eventListenerController=null))},refs:{northWest:Y(null),north:Y(null),northEast:Y(null),west:Y(null),east:Y(null),southWest:Y(null),south:Y(null),southEast:Y(null)}},l={startingMouse:null,startingPosition:null,mouseDown:R=>{R.button==0&&(R.preventDefault(),l.startingMouse={x:R.clientX,y:R.clientY},l.startingPosition=g.value,document.addEventListener("mousemove",l.mouseMove),document.addEventListener("mouseup",l.mouseUp))},mouseMove:R=>{!l.startingMouse||!l.startingPosition||(R.preventDefault(),g.value={x:Math.min(Math.max(l.startingPosition.x+R.clientX-l.startingMouse.x,0),document.body.clientWidth-N.value.width),y:Math.min(Math.max(l.startingPosition.y+R.clientY-l.startingMouse.y,0),document.body.clientHeight-N.value.height)})},mouseUp:R=>{R.button!=0||!l.startingMouse||!l.startingPosition||(R.preventDefault(),l.startingMouse=null,l.startingPosition=null,document.removeEventListener("mousemove",l.mouseMove),document.removeEventListener("mouseup",l.mouseUp))}};function y(R){return{id:r,icon:o.icon,title:o.title,pid:o.pid,data:R??o.tag}}const v=Ne(()=>ct.value.get(r)!==-1),h=Y(!1),m=Y(!0);function B(){i("minimize",y()),nt.minimizeWindowPanel(r)}function M(){h.value=!h.value}function P(){i("close",y(!1)),nt.removeWindowPanel(r),m.value=!1}const A=Ne(()=>h.value?"heroicons-outline:square-2-stack":"ant-design:border-outlined"),$={id:r,isShow:v,close:P,open:function(){i("open",y(!0)),m.value=!0},showHidePanel:B};function z(R){if(Wn(R))return R;{const U=Number(R);if(U==U)return U;if(R.endsWith("px")){const F=R.substring(0,R.length-2);return Number(F)}if(R.endsWith("%")){const F=R.substring(0,R.length-1);return Number(F)/100*document.body.clientWidth}return 300}}return e($),sn(()=>{(function(){let R=90;if(o.hasMin||(R-=30),o.hasMax||(R-=30),o.hasClose||(R-=30),he.setCssVar("--right-bar-width",R+"px",c.value),!c.value)return;const U=Wn(o.titleHeight)?o.titleHeight+"px":o.titleHeight;c.value.style.height=U,c.value.style.lineHeight=U})(),function(){const R=y($);nt.addWindowPanel(R),i("loaded",R)}(),g.value.x=z(o.left),g.value.y=z(o.top),j(g.value),N.value={width:z(o.nWidth),height:z(o.nHeight)},T(N.value),f.mount()}),Go(()=>{nt.removeWindowPanel(r)}),(R,U)=>(X(),Z(vr,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut"},{default:we(()=>[m.value?yr((X(),de("div",{key:0,ref_key:"dragPanelRef",ref:s,class:ke(["dragWindowPanel",{maxPanel:h.value,dragWindowPanel_dark:p.value}])},[J("div",{class:"dragPanelTitle",ref_key:"dragPanelTitleRef",ref:c,onMousedown:U[0]||(U[0]=(...F)=>l.mouseDown&&l.mouseDown(...F))},[ie(R.$slots,"title",{},()=>[o.icon?(X(),de("img",{key:0,src:o.icon,width:"24",height:"24"},null,8,ds)):ne("v-if",!0),o.title?(X(),de("span",fs,on(o.title),1)):ne("v-if",!0)]),J("div",ps,[n.hasMin?(X(),Z(At(Pt),{key:0,icon:"ant-design:minus-outlined",onClick:B})):ne("v-if",!0),n.hasMax?(X(),Z(At(Pt),{key:1,icon:A.value,onClick:M},null,8,["icon"])):ne("v-if",!0),n.hasClose?(X(),Z(At(Pt),{key:2,icon:"ant-design:close-outlined",onClick:P})):ne("v-if",!0)])],544),J("div",gs,[ie(R.$slots,"default")]),J("div",ms,[J("div",{class:"cursor-nw-resize",ref:f.refs.northWest},null,512),J("div",{class:"cursor-n-resize",ref:f.refs.north},null,512),J("div",{class:"cursor-ne-resize",ref:f.refs.northEast},null,512),J("div",{class:"cursor-w-resize",ref:f.refs.west},null,512),U[1]||(U[1]=J("span",{style:{"pointer-events":"all",visibility:"hidden"}},null,-1)),J("div",{class:"cursor-e-resize",ref:f.refs.east},null,512),J("div",{class:"cursor-sw-resize",ref:f.refs.southWest},null,512),J("div",{class:"cursor-s-resize",ref:f.refs.south},null,512),J("div",{class:"cursor-se-resize",ref:f.refs.southEast},null,512)])],2)),[[wr,v.value]]):ne("v-if",!0)]),_:3}))}});function Bs(n){return n==null||n===""?n:new Gt(new Ie(n)).deserialize()}pr.__scopeId="data-v-39ea9741",pr.__file="src/controls/xwindow/XWindow.vue";class Ur{debug=!1;simple=!1;utc=!1;longType="number";dictType="object";nullType=void 0;static Instance=new Ur;textEncoder=new TextEncoder;textDecoder=new TextDecoder;constructor(){}encodeResponse(e,t={}){var r=new Ie,o=new Bn(r,this.simple,this.utc),i=t;this.simple;var s=0;for(var c in i)s++;s>0&&(r.writeByte(72),o.serialize(i),o.reset()),e instanceof Error?(r.writeByte(69),o.serialize(this.debug&&e.stack?e.stack:e.message)):(r.writeByte(82),o.serialize(e)),r.writeByte(122);const p=r.takeBytes();return this.textDecoder.decode(p)}decodeRequest(e,t={}){const r=this.textEncoder.encode(e);if(r.length===0)return["~",[]];var o=new Ie(r),i=new Gt(o,!1);i.longType=this.longType,i.dictType=this.dictType;var s=o.readByte();if(s===72){var c=i.deserialize(this.nullType);for(var p in c)t[p]=c[p];i.reset(),s=o.readByte()}switch(s){case 67:return[i.deserialize(String),this.decodeArguments(i)];case 122:return["~",[]];default:throw new Error(`Invalid request:\r
`+o.toString())}}decodeArguments(e){var t=e.stream;let r=[];if(t.readByte()===97){e.reset();var o=ti.readCount(t);const s=new Array(o).fill(this.nullType);r=new Array(o),e.addReference(r);for(var i=0;i<o;++i)r[i]=e.deserialize(s[i]);t.readByte()}return r}encodeRequest(e,t,r={}){var o=new Ie,i=new Bn(o,this.simple,this.utc),s=r;this.simple&&(s.simple=!0);var c=0;for(var p in s)c++;c>0&&(o.writeByte(72),i.serialize(s),i.reset()),o.writeByte(67),i.serialize(e),t.length>0&&(i.reset(),i.serialize(t)),o.writeByte(122);const g=o.takeBytes();return this.textDecoder.decode(g)}decodeResponse(e,t={}){const r=this.textEncoder.encode(e);var o=new Ie(r),i=new Gt(o,!1);i.longType=this.longType,i.dictType=this.dictType;var s=o.readByte();if(s===72){var c=i.deserialize();for(var p in c)t[p]=c[p];i.reset(),s=o.readByte()}switch(s){case 82:return t.simple&&(i.simple=!0),i.deserialize();case 69:throw new Error(i.deserialize(String));case 122:return;default:throw new Error(`Invalid response:\r
`+o.toString())}}}const je={Login:"/api/User/Login",ChangeMyPwd:"/api/User/ChangeMyPwd",Logout:"/api/Check/ExitLogin",RefreshToken:"/api/Check/RefreshToken",CheckToken:"/api/Check/CheckToken",GetSystemRights:"/api/System/GetSystem"},nn="access_token",vs=W.Config.ServiceURL.LoginAuthURL;function gr(){const n=gi();n&&ze(je.RefreshToken,vs,{refreshToken:n}).then(e=>{qr(e.data)})}function ys(){const n=Ae.getJsonObject(nn);if(!n)return;const e=new Date().getTime(),t=new Date(n.expire).getTime()-e;t>0&&(t<=5e3?gr():setTimeout(gr,t-5e3))}function qr(n){const e=new Date().getTime();let t=new Date(n.accessToken.expires).getTime()-e;if((t>=36e5||t<-6e5)&&(t=18e5),t>0){let r=We();r?(r.token=n.accessToken.tokenContent,r.expire=n.accessToken.expires,r.refresh=n.refreshToken.tokenContent):r={token:n.accessToken.tokenContent,expire:n.accessToken.expires,refresh:n.refreshToken.tokenContent},Ae.set(nn,r,t/1e3),ys()}else Ae.remove(nn)}const rn="Wm314243",_t=W.Config.ServiceURL.LoginAuthURL;async function $s(n){const e={username:n.username,pwd:en.encryptToString(n.pwd,rn)},t=(await ze(je.Login,_t,e))?.data;return t&&qr(t.doubletoken),t}function Ns(n){const e={oldpwd:en.encryptToString(n.oldpwd,rn),newpwd:en.encryptToString(n.newpwd,rn)};return ze(je.ChangeMyPwd,_t,e)}function Ws(){const n=We();n&&(mi(je.Logout,_t,{token:n.token,reftoken:n.refresh}),Lr())}function Os(n){return ze(je.CheckToken,_t,{token:n})}const dn="ROLE_SYSTEM_RIGHT",fn=new xr("",sessionStorage);function ws(){return fn.get(dn)}function mr(n){fn.set(dn,n)}function _s(){fn.remove(dn)}function Fe(n){if(n)for(let e=0;e<n.length;e++){const t=n[e];t.children&&t.children.length>0?(Fe(t.children),t.children.length===0&&(n.splice(e,1),e--)):t.selected||(n.splice(e,1),e--)}}function Fr(n,e,t="name"){n&&e&&n.forEach(r=>{const o=e.find(i=>i[t]===r[t]);o&&(r.children?o.children&&Fr(r.children,o.children,t):(!o.children||o.children.length===0)&&o.selected&&(r.selected=o.selected))})}function rt(n,e,t,r="name"){const o=n[t],i=e[t];o?i&&Fr(o,i,r):i&&(n[t]=i)}function bs(n){if(n&&n.length>0){const e=n.length;let t,r=!1;if(e>0){r=cn(n[0]);const o=r?n[0]:JSON.parse(n[0]);if(e>1)for(let i=1;i<n.length;i++){const s=n[i],c=r?s:JSON.parse(s);rt(o,c,"routes","name"),rt(o,c,"widgetMenu","name"),rt(o,c,"widgets","id"),rt(o,c,"functions","id")}t=o}return t&&(Fe(t.routes),Fe(t.widgetMenu),Fe(t.widgets),Fe(t.functions)),t}}const Vt=[],Kt=[];function Xr(){return ws()}async function zs(n,e=!1){_s();const t=je.GetSystemRights,r=W.Config.ServiceURL.LoginAuthURL,o=await ze(t,r,{systemid:n});if(!o||!o.data)return void W.Message?.warn("无法获取功能授权列表！");const i=o.data;if(i&&i.length>0){if(e){const s=JSON.parse(i[0]);return mr(s),s}{const s=bs(i);return mr(s),s}}}function Vr(n,e){const t={...n};return t.meta||(t.meta={}),e.index!=null&&(t.meta.index=e.index),e.title!=null&&(t.meta.title=e.title),n.children&&(t.children=[],e.children&&e.children.forEach(r=>{const o=n.children?.find(i=>i.path===r.path);if(o){const i=Vr(o,r);i&&t.children?.push(i)}})),t}function js(n,e=2){if(e===0)return n;const t=Xr();return t&&t.routes?(Kt.length>0||n.forEach(r=>{const o=t.routes?.find(i=>i.name===r.name);if(o){const i=Vr(r,o);i&&Kt.push(i)}}),Kt):void 0}function Hs(n,e=2){if(e===0)return n;const t=Xr();return t&&t.widgets?(Vt.length>0||n?.forEach(r=>{t.widgets?.find(o=>o.id===r.id)&&Vt.push(r)}),Vt):void 0}export{js as $,Ws as A,W as B,ze as C,Os as D,Ls as G,We as L,ys as M,Rs as N,$s as P,Ms as Q,Is as S,As as Z,_s as a,zs as b,le as c,Hs as d,Xt as e,pr as f,xs as g,he as h,Ts as i,qr as j,Bs as k,Ei as l,Ps as m,nt as n,Ds as o,Ns as p,Xr as r,ue as s,Wn as u,xr as w};
