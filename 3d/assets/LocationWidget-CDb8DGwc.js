import{H as P,I as Q,J as s,j as T}from"./vendor-6kqmRazU.js";import{j as U,E as Z,d as N}from"./xframelib-exp-CPl8XRlL.js";import{f as X,_ as R}from"./index-CTmLOYTS.js";import{W as J}from"./WidgetsEvent-TR_R_5Fb.js";import{d as K,r as x,v as O,x as Y,V as h,a1 as v,R as p,L as t,M as b,a8 as _,Q as d,X as k,Z as $}from"./@vue-exp-BA8o4xMK.js";import"./@hprose-exp-BDOQuVAD.js";import"./axios-exp-BH40TtQM.js";import"./vue-router-exp-BxGuMefC.js";const ee=K({__name:"LocationWidget",setup(L,{expose:e}){let C="LocationWidget",l="",u;function z(a){l=a.id}function n(a){C=a.pid,a.pid&&X(J.WidgetClosed,C)}const f=x(!0);function V(a=!1){f.value=a,l&&a&&N.openWindowPanel(l)}e({changeVisible:V,isShow:f});const B=x([{label:"十进制",status:!0},{label:"度分秒",status:!1},{label:"平面坐标",status:!1}]),j=x([{label:"三度带",status:!0},{label:"六度带",status:!1}]),g=x(0),o=x({x:0,y:0,xdeg:0,xmin:0,xsec:0,ydeg:0,ymin:0,ysec:0,zoneType:0,zonex:0,zoney:0,height:0});let m;function W(a){var i=a.camera,M=a.scene.globe.ellipsoid,D=i.position,G=i.direction,A=new Cesium.Cartesian3;A=Cesium.Cartesian3.add(D,G,A);var I=M.cartesianToCartographic(A);o.value.x=Cesium.Math.toDegrees(I.longitude),o.value.y=Cesium.Math.toDegrees(I.latitude),o.value.height=200,y()}function F(){g.value==1?E():g.value==2&&w()}function H(){switch(g.value){case 0:y();break;case 1:E(!0),y();break;case 2:w(!0),y();break}}function E(a=!1){a?(o.value.x=o.value.xdeg+o.value.xmin/60+o.value.xsec/3600,o.value.y=o.value.ydeg+o.value.ymin/60+o.value.ysec/3600):(o.value.xdeg=Math.floor(o.value.x),o.value.xmin=Math.floor((o.value.x-o.value.xdeg)*60),o.value.xsec=Math.floor(((o.value.x-o.value.xdeg)*60-o.value.xmin)*60),o.value.ydeg=Math.floor(o.value.y),o.value.ymin=Math.floor((o.value.y-o.value.ydeg)*60),o.value.ysec=Math.floor(((o.value.y-o.value.ydeg)*60-o.value.ymin)*60))}function w(a=!1){if(a){const i=P("EPSG:3857","EPSG:4326",[o.value.zonex,o.value.zoney]);i&&(o.value.x=i[0],o.value.y=i[1])}else{const i=P("EPSG:4326","EPSG:3857",[o.value.x,o.value.y]);i&&(o.value.zonex=i[0],o.value.zoney=i[1])}}function y(){m?m.position=Cesium.Cartesian3.fromDegrees(o.value.x,o.value.y,o.value.height):m=u.entities.add({name:"localDemo",position:Cesium.Cartesian3.fromDegrees(o.value.x,o.value.y,o.value.height),point:{pixelSize:10,color:Cesium.Color.BLUE,outlineColor:Cesium.Color.WHITE,outlineWidth:2}})}async function c(){m&&u.zoomTo(m)}let r;function q(){r=new Cesium.ScreenSpaceEventHandler(u.scene.canvas),r.setInputAction(function(a){var i=u.scene.pickPosition(a.position);if(Cesium.defined(i)){var M=Cesium.Cartographic.fromCartesian(i);o.value.x=Cesium.Math.toDegrees(M.longitude),o.value.y=Cesium.Math.toDegrees(M.latitude);const D=M.height;D>0?o.value.height=Math.floor(D*100)/100:o.value.height=0,g.value==1?E():g.value==2&&w(),y(),r&&(r.destroy(),r=void 0)}},Cesium.ScreenSpaceEventType.LEFT_CLICK)}O(()=>{U.CesiumViewer?(u=U.CesiumViewer,W(u)):U.Message.info("未获取到地图")}),Y(()=>{r&&(r.destroy(),r=void 0),m&&u.entities.remove(m)});const S={get widgetID(){return C},set widgetID(a){C=a},get windowID(){return l},set windowID(a){l=a},get viewer(){return u},set viewer(a){u=a},loadedHandle:z,doClosePanel:n,isShow:f,changeVisible:V,types:B,zoneTypes:j,type:g,dataModel:o,get pointEntity(){return m},set pointEntity(a){m=a},getCurrentCenter:W,changeCoorType:F,changeValue:H,convertDegMinSec:E,convertZone:w,CreateUpdatePointEntity:y,ZoomTo:c,get handler(){return r},set handler(a){r=a},ClickPoint:q,get XWindow(){return Z}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}}),le={class:"q-pa-sm panelCls"},oe={class:"q-pb-md titleTypeCls row"},ne={class:"contentCls row justify-center items-center q-col-gutter-sm"},te={class:"col-9"},ae={class:"col-9"},de={class:"col-9"},ie={class:"col-9 row justify-between"},se={class:"col-9 row justify-between"},ue={class:"col-9"},re={class:"col-9"},me={class:"col-9"},ve={class:"col-9"},fe={class:"footerCls q-pt-md row justify-between"};function ge(L,e,C,l,u,z){return p(),h(l.XWindow,{isDark:!0,top:"10px",left:"10px",nWidth:"350px",nHeight:"270px",title:"坐标拾取",icon:"img/basicimage/arcgis_img.png",pid:"LocationWidget",onLoaded:l.loadedHandle,onClose:l.doClosePanel},{default:v(()=>[t("div",le,[t("div",oe,[(p(!0),b(k,null,_(l.types,(n,f)=>(p(),b("div",{class:"col-4",key:f},[d(Q,{modelValue:l.type,"onUpdate:modelValue":[e[0]||(e[0]=V=>l.type=V),e[1]||(e[1]=V=>l.changeCoorType())],"checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",label:n.label,val:f,dense:""},null,8,["modelValue","label","val"])]))),128))]),t("div",ne,[l.type==0?(p(),b(k,{key:0},[e[29]||(e[29]=t("div",{class:"col-3"}," 经度: ",-1)),t("div",te,[d(s,{outlined:"",modelValue:l.dataModel.x,"onUpdate:modelValue":[e[2]||(e[2]=n=>l.dataModel.x=n),e[3]||(e[3]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])]),e[30]||(e[30]=t("div",{class:"col-3"}," 纬度: ",-1)),t("div",ae,[d(s,{outlined:"",modelValue:l.dataModel.y,"onUpdate:modelValue":[e[4]||(e[4]=n=>l.dataModel.y=n),e[5]||(e[5]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])]),e[31]||(e[31]=t("div",{class:"col-3"}," 高程: ",-1)),t("div",de,[d(s,{outlined:"",modelValue:l.dataModel.height,"onUpdate:modelValue":[e[6]||(e[6]=n=>l.dataModel.height=n),e[7]||(e[7]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])])],64)):l.type==1?(p(),b(k,{key:1},[e[38]||(e[38]=t("div",{class:"col-3"}," 经度: ",-1)),t("div",ie,[d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.xdeg,"onUpdate:modelValue":[e[8]||(e[8]=n=>l.dataModel.xdeg=n),e[9]||(e[9]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[32]||(e[32]=[t("span",null,"度",-1)])),_:1},8,["modelValue"]),d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.xmin,"onUpdate:modelValue":[e[10]||(e[10]=n=>l.dataModel.xmin=n),e[11]||(e[11]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[33]||(e[33]=[t("span",null,"分",-1)])),_:1},8,["modelValue"]),d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.xsec,"onUpdate:modelValue":[e[12]||(e[12]=n=>l.dataModel.xsec=n),e[13]||(e[13]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[34]||(e[34]=[t("span",null,"秒",-1)])),_:1},8,["modelValue"])]),e[39]||(e[39]=t("div",{class:"col-3"}," 纬度: ",-1)),t("div",se,[d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.ydeg,"onUpdate:modelValue":[e[14]||(e[14]=n=>l.dataModel.ydeg=n),e[15]||(e[15]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[35]||(e[35]=[t("span",null,"度",-1)])),_:1},8,["modelValue"]),d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.ymin,"onUpdate:modelValue":[e[16]||(e[16]=n=>l.dataModel.ymin=n),e[17]||(e[17]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[36]||(e[36]=[t("span",null,"分",-1)])),_:1},8,["modelValue"]),d(s,{class:"inputCls",outlined:"",modelValue:l.dataModel.ysec,"onUpdate:modelValue":[e[18]||(e[18]=n=>l.dataModel.ysec=n),e[19]||(e[19]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},{append:v(()=>e[37]||(e[37]=[t("span",null,"秒",-1)])),_:1},8,["modelValue"])]),e[40]||(e[40]=t("div",{class:"col-3"}," 高程: ",-1)),t("div",ue,[d(s,{outlined:"",modelValue:l.dataModel.height,"onUpdate:modelValue":[e[20]||(e[20]=n=>l.dataModel.height=n),e[21]||(e[21]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])])],64)):l.type==2?(p(),b(k,{key:2},[e[41]||(e[41]=t("div",{class:"col-3"}," 纵坐标: ",-1)),t("div",re,[d(s,{outlined:"",modelValue:l.dataModel.zonex,"onUpdate:modelValue":[e[22]||(e[22]=n=>l.dataModel.zonex=n),e[23]||(e[23]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])]),e[42]||(e[42]=t("div",{class:"col-3"}," 横坐标: ",-1)),t("div",me,[d(s,{outlined:"",modelValue:l.dataModel.zoney,"onUpdate:modelValue":[e[24]||(e[24]=n=>l.dataModel.zoney=n),e[25]||(e[25]=n=>l.changeValue())],modelModifiers:{number:!0},dense:""},null,8,["modelValue"])]),e[43]||(e[43]=t("div",{class:"col-3"}," 高度值: ",-1)),t("div",ve,[d(s,{outlined:"",modelValue:l.dataModel.height,"onUpdate:modelValue":e[26]||(e[26]=n=>l.dataModel.height=n),modelModifiers:{number:!0},dense:""},null,8,["modelValue"])])],64)):$("",!0)]),t("div",fe,[d(T,{class:"btnCls",color:"primary",label:"图上拾取",onClick:e[27]||(e[27]=n=>l.ClickPoint())}),d(T,{class:"btnCls",color:"primary",label:"坐标定位",onClick:e[28]||(e[28]=n=>l.ZoomTo())})])])]),_:1})}const we=R(ee,[["render",ge],["__scopeId","data-v-0e8e5504"],["__file","LocationWidget.vue"]]);export{we as default};
