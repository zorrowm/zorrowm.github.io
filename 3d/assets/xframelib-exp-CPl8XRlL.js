import{M as fe,Y as ce,_ as me,a6 as wo,O as Nt,V as ne,a1 as Ce,A as vr,a7 as qi,L as G,X as Te,a8 as Oe,Z as se,r as Y,R as X,d as Ie,s as Ui,p as Be,w as Re,v as Wn,q as Fi,z as yr,G as wr,a9 as _n,N as Bn,aa as Hi,Q as Et,K as br,ab as Se,a as Xi,l as Ki,$ as Me,D as Vi,x as Yi,y as en,n as _r,m as Ji,h as Sn}from"./@vue-exp-BA8o4xMK.js";import{a as Gi}from"./axios-exp-BH40TtQM.js";import{U as Qi}from"./vendor-6kqmRazU.js";import{C as tn,B as bo,H as Zi,b as es}from"./@hprose-exp-BDOQuVAD.js";var Xa={name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((n,e)=>(n[e.id]=e)&&n,{})}},methods:{updatePaneComponents(){this.panes.forEach(n=>{n.update&&n.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[n.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(n,e){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=e},onMouseMove(n){this.touch.mouseDown&&(n.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(n)),this.$emit("resize",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(n=>({min:n.min,max:n.max,size:n.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(n,e){"ontouchstart"in window&&(n.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===e?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(n,e),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=e,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[e])},onSplitterDblClick(n,e){let t=0;this.panes=this.panes.map((o,r)=>(o.size=r===e?o.max:o.min,r!==e&&(t+=o.min),o)),this.panes[e].size-=t,this.$emit("pane-maximize",this.panes[e])},onPaneClick(n,e){this.$emit("pane-click",this.indexedPanes[e])},getCurrentMouseDrag(n){const e=this.container.getBoundingClientRect(),{clientX:t,clientY:o}="ontouchstart"in window&&n.touches?n.touches[0]:n;return{x:t-e.left,y:o-e.top}},getCurrentDragPercentage(n){n=n[this.horizontal?"y":"x"];const e=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(n=e-n),100*n/e},calculatePanesSize(n){const e=this.touch.activeSplitter;let t={prevPanesSize:this.sumPrevPanesSize(e),nextPanesSize:this.sumNextPanesSize(e),prevReachedMinPanes:0,nextReachedMinPanes:0};const o=0+(this.pushOtherPanes?0:t.prevPanesSize),r=100-(this.pushOtherPanes?0:t.nextPanesSize),i=Math.max(Math.min(this.getCurrentDragPercentage(n),r),o);let s=[e,e+1],a=this.panes[s[0]]||null,u=this.panes[s[1]]||null;const d=a.max<100&&i>=a.max+t.prevPanesSize,w=u.max<100&&i<=100-(u.max+this.sumNextPanesSize(e+1));if(d||w)d?(a.size=a.max,u.size=Math.max(100-a.max-t.prevPanesSize-t.nextPanesSize,0)):(a.size=Math.max(100-u.max-t.prevPanesSize-this.sumNextPanesSize(e+1),0),u.size=u.max);else{if(this.pushOtherPanes){const S=this.doPushOtherPanes(t,i);if(!S)return;({sums:t,panesToResize:s}=S),a=this.panes[s[0]]||null,u=this.panes[s[1]]||null}a!==null&&(a.size=Math.min(Math.max(i-t.prevPanesSize-t.prevReachedMinPanes,a.min),a.max)),u!==null&&(u.size=Math.min(Math.max(100-i-t.nextPanesSize-t.nextReachedMinPanes,u.min),u.max))}},doPushOtherPanes(n,e){const t=this.touch.activeSplitter,o=[t,t+1];return e<n.prevPanesSize+this.panes[o[0]].min&&(o[0]=this.findPrevExpandedPane(t).index,n.prevReachedMinPanes=0,o[0]<t&&this.panes.forEach((r,i)=>{i>o[0]&&i<=t&&(r.size=r.min,n.prevReachedMinPanes+=r.min)}),n.prevPanesSize=this.sumPrevPanesSize(o[0]),o[0]===void 0)?(n.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((r,i)=>{i>0&&i<=t&&(r.size=r.min,n.prevReachedMinPanes+=r.min)}),this.panes[o[1]].size=100-n.prevReachedMinPanes-this.panes[0].min-n.prevPanesSize-n.nextPanesSize,null):e>100-n.nextPanesSize-this.panes[o[1]].min&&(o[1]=this.findNextExpandedPane(t).index,n.nextReachedMinPanes=0,o[1]>t+1&&this.panes.forEach((r,i)=>{i>t&&i<o[1]&&(r.size=r.min,n.nextReachedMinPanes+=r.min)}),n.nextPanesSize=this.sumNextPanesSize(o[1]-1),o[1]===void 0)?(n.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((r,i)=>{i<this.panesCount-1&&i>=t+1&&(r.size=r.min,n.nextReachedMinPanes+=r.min)}),this.panes[o[0]].size=100-n.prevPanesSize-n.nextReachedMinPanes-this.panes[this.panesCount-1].min-n.nextPanesSize,null):{sums:n,panesToResize:o}},sumPrevPanesSize(n){return this.panes.reduce((e,t,o)=>e+(o<n?t.size:0),0)},sumNextPanesSize(n){return this.panes.reduce((e,t,o)=>e+(o>n+1?t.size:0),0)},findPrevExpandedPane(n){return[...this.panes].reverse().find(e=>e.index<n&&e.size>e.min)||{}},findNextExpandedPane(n){return this.panes.find(e=>e.index>n+1&&e.size>e.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(n=>{const e=n.classList.contains("splitpanes__pane"),t=n.classList.contains("splitpanes__splitter");if(!e&&!t)return n.parentNode.removeChild(n),void 0})},addSplitter(n,e,t=!1){const o=n-1,r=document.createElement("div");r.classList.add("splitpanes__splitter"),t||(r.onmousedown=i=>this.onMouseDown(i,o),typeof window<"u"&&"ontouchstart"in window&&(r.ontouchstart=i=>this.onMouseDown(i,o)),r.onclick=i=>this.onSplitterClick(i,o+1)),this.dblClickSplitter&&(r.ondblclick=i=>this.onSplitterDblClick(i,o+1)),e.parentNode.insertBefore(r,e)},removeSplitter(n){n.onmousedown=void 0,n.onclick=void 0,n.ondblclick=void 0,n.parentNode.removeChild(n)},redoSplitters(){const n=Array.from(this.container.children);n.forEach(t=>{t.className.includes("splitpanes__splitter")&&this.removeSplitter(t)});let e=0;n.forEach(t=>{t.className.includes("splitpanes__pane")&&(!e&&this.firstSplitter?this.addSplitter(e,t,!0):e&&this.addSplitter(e,t),e++)})},requestUpdate({target:n,...e}){const t=this.indexedPanes[n._.uid];Object.entries(e).forEach(([o,r])=>t[o]=r)},onPaneAdd(n){let e=-1;Array.from(n.$el.parentNode.children).some(r=>(r.className.includes("splitpanes__pane")&&e++,r===n.$el));const t=parseFloat(n.minSize),o=parseFloat(n.maxSize);this.panes.splice(e,0,{id:n._.uid,index:e,min:isNaN(t)?0:t,max:isNaN(o)?100:o,size:n.size===null?null:parseFloat(n.size),givenSize:n.size,update:n.update}),this.panes.forEach((r,i)=>r.index=i),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[e]}),this.$emit("pane-add",{index:e,panes:this.panes.map(r=>({min:r.min,max:r.max,size:r.size}))})})},onPaneRemove(n){const e=this.panes.findIndex(o=>o.id===n._.uid),t=this.panes.splice(e,1)[0];this.panes.forEach((o,r)=>o.index=r),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:{...t,index:e}}),this.$emit("pane-remove",{removed:t,panes:this.panes.map(o=>({min:o.min,max:o.max,size:o.size}))})})},resetPaneSizes(n={}){n.addedPane||n.removedPane?this.panes.some(e=>e.givenSize!==null||e.min||e.max<100)?this.equalizeAfterAddOrRemove(n):this.equalize():this.initialPanesSizing(),this.ready&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size})))},equalize(){const n=100/this.panesCount;let e=0;const t=[],o=[];this.panes.forEach(r=>{r.size=Math.max(Math.min(n,r.max),r.min),e-=r.size,r.size>=r.max&&t.push(r.id),r.size<=r.min&&o.push(r.id)}),e>.1&&this.readjustSizes(e,t,o)},initialPanesSizing(){let n=100;const e=[],t=[];let o=0;this.panes.forEach(i=>{n-=i.size,i.size!==null&&o++,i.size>=i.max&&e.push(i.id),i.size<=i.min&&t.push(i.id)});let r=100;n>.1&&(this.panes.forEach(i=>{i.size===null&&(i.size=Math.max(Math.min(n/(this.panesCount-o),i.max),i.min)),r-=i.size}),r>.1&&this.readjustSizes(n,e,t))},equalizeAfterAddOrRemove({addedPane:n}={}){let e=100/this.panesCount,t=0;const o=[],r=[];n&&n.givenSize!==null&&(e=(100-n.givenSize)/(this.panesCount-1)),this.panes.forEach(i=>{t-=i.size,i.size>=i.max&&o.push(i.id),i.size<=i.min&&r.push(i.id)}),!(Math.abs(t)<.1)&&(this.panes.forEach(i=>{n&&n.givenSize!==null&&n.id===i.id||(i.size=Math.max(Math.min(e,i.max),i.min)),t-=i.size,i.size>=i.max&&o.push(i.id),i.size<=i.min&&r.push(i.id)}),t>.1&&this.readjustSizes(t,o,r))},readjustSizes(n,e,t){let o;o=n>0?n/(this.panesCount-e.length):n/(this.panesCount-t.length),this.panes.forEach(r=>{if(n>0&&!e.includes(r.id)){const i=Math.max(Math.min(r.size+o,r.max),r.min),s=i-r.size;n-=s,r.size=i}else if(!t.includes(r.id)){const i=Math.max(Math.min(r.size+o,r.max),r.min),s=i-r.size;n-=s,r.size=i}r.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[r.id].size}%`})}),Math.abs(n)>.1&&this.$nextTick(()=>{this.ready})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(n){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((e,t)=>{e.ondblclick=n?o=>this.onSplitterDblClick(o,t):void 0})}},beforeUnmount(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.updatePaneComponents(),this.$emit("ready"),this.ready=!0},render(){return Sn("div",{ref:"container",class:["splitpanes","splitpanes--"+(this.horizontal?"horizontal":"vertical"),{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default())},__file:"src/controls/splitpanes/splitpanes.vue"},_o={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:10},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeUnmount(){this.onPaneRemove(this)},methods:{update(n){this.style=n}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(n){this.requestUpdate({target:this,size:n})},minSizeNumber(n){this.requestUpdate({target:this,min:n})},maxSizeNumber(n){this.requestUpdate({target:this,max:n})}}};function nn(n){return window.TouchEvent&&n instanceof TouchEvent}_o.render=function(n,e,t,o,r,i){return X(),fe("div",{class:"splitpanes__pane",onClick:e[0]||(e[0]=s=>i.onPaneClick(s,n._.uid)),style:me(n.style)},[ce(n.$slots,"default")],4)},_o.__file="src/controls/splitpanes/pane.vue";class ue{e;constructor(e){this.e=e}stopPropagation(){this.e.stopPropagation()}preventDefault(){this.e.preventDefault()}get clientX(){return nn(this.e)?(this.e.type==="touchend"?this.e.changedTouches:this.e.touches).item(0).clientX:this.e.clientX}get clientY(){return nn(this.e)?(this.e.type==="touchend"?this.e.changedTouches:this.e.touches).item(0).clientY:this.e.clientY}get clientCoord(){return new qn(this.clientX,this.clientY)}static bindDown(e,t,o,r=!1){const i=a=>{t(new ue(a))},s=a=>{a.touches.length===1&&t(new ue(a)),a.touches.length>1&&o&&o(new ue(a))};return e.addEventListener("mousedown",i,r),e.addEventListener("touchstart",s,r),()=>{e.removeEventListener("mousedown",i,r),e.removeEventListener("touchstart",s,r)}}static bindMove(e,t,o=!1){const r=s=>{t(new ue(s))},i=s=>{s.touches.length===1&&t(new ue(s))};return e.addEventListener("mousemove",r,o),e.addEventListener("touchmove",i,o),()=>{e.removeEventListener("mousemove",r,o),e.removeEventListener("touchmove",i,o)}}static bindUp(e,t,o=!1){const r=s=>{t(new ue(s))},i=s=>{s.touches.length===0&&t(new ue(s))};return e.addEventListener("mouseup",r,o),e.addEventListener("touchend",i,o),()=>{e.removeEventListener("mouseup",r,o),e.removeEventListener("touchend",i,o)}}originalEvent({mouse:e,touch:t}){nn(this.e)?t&&t(this.e):e&&e(this.e)}}class qn{x;y;constructor(e,t){this.x=e,this.y=t}clone(){return new qn(this.x,this.y)}}class ts{handle;container;options;unbindDown;unbindMove;unbindUp;constructor(e,t,o={}){this.handle=e,this.container=t,this.options=o,e&&(this.unbindDown=ue.bindDown(e,this.mousedown),e.classList.add("draggable-handle"))}teardown(){this.handle?.classList.remove("draggable-handle"),this.unbindDown&&this.unbindDown(),this.unbindUp&&this.unbindUp(),this.unbindMove&&this.unbindMove()}offsetX;offsetY;mousedown=e=>{if(e.preventDefault(),this.handle){const{left:t,top:o}=this.handle.getBoundingClientRect();this.offsetX=e.clientX-t,this.offsetY=e.clientY-o}this.options.onMoveStart&&this.options.onMoveStart(),this.unbindMove=ue.bindMove(document,this.mousemove),this.unbindUp=ue.bindUp(document,this.mouseup)};mousemove=e=>{this.container&&(this.container.style.left=e.clientX-this.offsetX+"px",this.container.style.top=e.clientY-this.offsetY+"px"),this.options.onMove&&this.options.onMove()};mouseup=e=>{this.options.onMoveEnd&&this.options.onMoveEnd(),this.unbindUp(),this.unbindMove(),this.unbindUp=this.unbindMove=void 0}}class ns{_group;onChange;zIndex;constructor(e,t){this._group=e,this.onChange=t,this.a(o=>o.push(this))}set group(e){this._group=e;const t=wt(this._group),o=wt(e);t.splice(t.indexOf(this),1),o.push(this),So()}get group(){return this._group}unregister(){this.a(e=>e.splice(e.indexOf(this),1))}raise(){this.a(e=>{e.splice(e.indexOf(this),1),e.push(this)})}a(e){e(wt(this._group)),So()}}const yt=new Map;function wt(n){return yt.has(n)||yt.set(n,[]),yt.get(n)}function Sr(n,e){return n>e?-Sr(e,n):n<0&&e>=0?1:n-e}function So(){let n=0;for(const e of function(t){const o=[];return t.forEach((r,i)=>o.push(i)),o}(yt).sort(Sr))for(const t of wt(e))n!=t.zIndex&&(t.zIndex=n,t.onChange(n)),n++}function Cn(n){if(n){const{width:e,height:t}=n.style;n.style.width="auto",n.style.height="auto";const o=bt(n);return n.style.width=e,n.style.height=t,o}return{width:0,height:0,top:0,left:0,bottom:0,right:0}}function bt(n){const e=n.getBoundingClientRect(),t=e.width,o=e.height,r=e.top,i=e.left;return{width:t,height:o,top:r,left:i,bottom:r+o,right:i+t}}class os{container;options;handles;constructor(e,t){if(this.container=e,this.options=t,e&&t){this.handles=Cr.map(u=>new u(e,this));const{width:o,height:r}=Cn(e),i=t.maxWidth||window.innerWidth,s=t.maxHeight||window.innerHeight;let a=!1;(o<t.minWidth||o>i)&&(e.style.width=`${Co(o,t.minWidth,i)}px`,a=!0),(r<t.minHeight||r>s)&&(e.style.height=`${Co(r,t.minHeight,s)}px`,a=!0),a&&t.onResize&&t.onResize()}}teardown(){this.handles?.forEach(e=>e.teardown())}}const Cr=[];class ke{container;helper;handle;handleSize=8;unbindDown;unbindMove;unbindUp;constructor(e,t){this.container=e,this.helper=t,this.handle=this.createHandleElement(),this.unbindDown=ue.bindDown(this.handle,this.mousedown)}teardown(){this.unbindDown(),this.unbindUp&&this.unbindUp(),this.unbindMove&&this.unbindMove(),this.handle.parentElement.removeChild(this.handle)}x0;y0;left0;top0;width0;height0;mousedown=e=>{e.preventDefault(),e.stopPropagation();const{left:t,top:o,width:r,height:i}=bt(this.container);this.x0=e.clientX,this.y0=e.clientY,this.left0=t,this.top0=o,this.width0=r,this.height0=i,this.calcSafeBoundaries(),this.helper.options&&this.helper.options.onResizeStart&&this.helper.options.onResizeStart(),this.unbindMove=ue.bindMove(document,this.mousemove),this.unbindUp=ue.bindUp(document,this.mouseup)};minLeft;maxLeft;minRight;maxRight;minTop;maxTop;minBottom;maxBottom;calcSafeBoundaries(){if(!this.helper.options)return;const{left:e,top:t,right:o,bottom:r}=bt(this.container),i=this.helper.options,s=i.maxWidth||window.innerWidth,a=i.maxHeight||window.innerHeight;this.minLeft=Math.max(o-s,0),this.maxLeft=o-i.minWidth,this.minRight=e+i.minWidth,this.maxRight=Math.min(e+s,window.innerWidth),this.minTop=Math.max(r-a,0),this.maxTop=r-i.minHeight,this.minBottom=t+i.minHeight,this.maxBottom=Math.min(t+a,window.innerHeight)}mousemove=e=>{e.preventDefault(),e.stopPropagation(),this.setPosition(e),this.fixPosition(),this.helper.options&&this.helper.options.onResize&&this.helper.options.onResize()};fixPosition(){const{width:e,height:t,left:o,top:r,right:i,bottom:s}=bt(this.container),a=this.helper.options;a&&(o<this.minLeft?(this.container.style.width=e+o-this.minLeft+"px",this.container.style.left=`${this.minLeft}px`):o>this.maxLeft?(this.container.style.width=`${a.minWidth}px`,this.container.style.left=`${this.maxLeft}px`):i<this.minRight?this.container.style.width=`${a.minWidth}px`:i>this.maxRight&&(this.container.style.width=this.maxRight-o+"px"),r<this.minTop?(this.container.style.height=t+r-this.minTop+"px",this.container.style.top=`${this.minTop}px`):r>this.maxTop?(this.container.style.height=`${a.minHeight}px`,this.container.style.top=`${this.maxTop}px`):s<this.minBottom?this.container.style.height=`${a.minHeight}px`:s>this.maxBottom&&(this.container.style.height=this.maxBottom-r+"px"))}mouseup=e=>{e.preventDefault(),e.stopPropagation(),this.helper.options&&this.helper.options.onResizeEnd&&this.helper.options.onResizeEnd(),this.unbindUp(),this.unbindMove(),this.unbindUp=this.unbindMove=void 0};createHandleElement(){const e=document.createElement("div"),t=e.style;return t.position="absolute",this.applyStyle(t),this.container.appendChild(e),e}}function Co(n,e,t){return n<e?e:n>t?t:n}Cr.push(class extends ke{setPosition(n){this.container.style.width=this.width0+n.clientX-this.x0+"px",this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.right=-this.handleSize+"px",n.bottom=-this.handleSize+"px",n.cursor="nwse-resize"}},class extends ke{setPosition(n){this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.right=`${this.handleSize}px`,n.left=`${this.handleSize}px`,n.height=2*this.handleSize+"px",n.bottom=-this.handleSize+"px",n.cursor="ns-resize"}},class extends ke{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px",this.container.style.height=this.height0+n.clientY-this.y0+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.bottom=-this.handleSize+"px",n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.cursor="nesw-resize"}},class extends ke{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.bottom=`${this.handleSize}px`,n.width=2*this.handleSize+"px",n.top=`${this.handleSize}px`,n.cursor="ew-resize"}},class extends ke{setPosition(n){this.container.style.left=this.left0+n.clientX-this.x0+"px",this.container.style.width=this.width0-(n.clientX-this.x0)+"px",this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px"}applyStyle(n){n.left=-this.handleSize+"px",n.top=-this.handleSize+"px",n.width=2*this.handleSize+"px",n.height=2*this.handleSize+"px",n.cursor="nwse-resize"}},class extends ke{setPosition(n){this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px"}applyStyle(n){n.left=`${this.handleSize}px`,n.right=`${this.handleSize}px`,n.height=2*this.handleSize+"px",n.top=-this.handleSize+"px",n.cursor="ns-resize"}},class extends ke{setPosition(n){this.container.style.top=this.top0+n.clientY-this.y0+"px",this.container.style.height=this.height0-(n.clientY-this.y0)+"px",this.container.style.width=this.width0+n.clientX-this.x0+"px"}applyStyle(n){n.right=-this.handleSize+"px",n.top=-this.handleSize+"px",n.height=2*this.handleSize+"px",n.width=2*this.handleSize+"px",n.cursor="nesw-resize"}},class extends ke{setPosition(n){this.container.style.width=this.width0+n.clientX-this.x0+"px"}applyStyle(n){n.right=-this.handleSize+"px",n.top=`${this.handleSize}px`,n.bottom=`${this.handleSize}px`,n.width=2*this.handleSize+"px",n.cursor="ew-resize"}});var _t=Ie({name:"",props:{disabled:{type:Boolean,default:!1},windowStyle:{type:Object,required:!0}},components:{},setup(n){const e=Y(!1),t=Y(!1);return{hover:e,active:t,style:function(){let o=n.windowStyle.button;return e.value&&(o={...o,...this.windowStyle.buttonHover}),t.value&&(o={...o,...this.windowStyle.buttonActive}),o},mouseup:function(o){this.active&&this.$emit("click")},mousedown:function(o){o.preventDefault(),t.value=!0;const r=ue.bindUp(document,()=>{t.value=!1,r()})}}}});const rs=["disabled"];_t.render=function(n,e,t,o,r,i){return X(),fe("div",{class:"btn",style:me(n.style()),onMouseenter:e[0]||(e[0]=s=>n.hover=!0),onMouseleave:e[1]||(e[1]=s=>n.hover=!1),onMousedown:e[2]||(e[2]=wo((...s)=>n.mousedown&&n.mousedown(...s),["stop"])),onTouchstart:e[3]||(e[3]=wo((...s)=>n.mousedown&&n.mousedown(...s),["stop"])),onMouseup:e[4]||(e[4]=(...s)=>n.mouseup&&n.mouseup(...s)),onTouchend:e[5]||(e[5]=(...s)=>n.mouseup&&n.mouseup(...s)),disabled:n.disabled},[ce(n.$slots,"default")],44,rs)},_t.__scopeId="data-v-71662210",_t.__file="src/controls/vuewindow/window/Button.vue";const is=Object.prototype.toString;function $t(n,e){return is.call(n)===`[object ${e}]`}function ss(n){return $t(n,"Function")}const Un=n=>n!=null&&n!==null&&$t(n,"Object");function xo(n){return $t(n,"Number")}function xr(n){return $t(n,"String")}const Ka=n=>/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(n);var We=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Eo,ko={exports:{}},as=Eo?ko.exports:(Eo=1,ko.exports=function(n){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function t(g,l){var v=g[0],y=g[1],h=g[2],f=g[3];y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&h|~y&f)+l[0]-680876936|0)<<7|v>>>25)+y|0)&y|~v&h)+l[1]-389564586|0)<<12|f>>>20)+v|0)&v|~f&y)+l[2]+606105819|0)<<17|h>>>15)+f|0)&f|~h&v)+l[3]-1044525330|0)<<22|y>>>10)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&h|~y&f)+l[4]-176418897|0)<<7|v>>>25)+y|0)&y|~v&h)+l[5]+1200080426|0)<<12|f>>>20)+v|0)&v|~f&y)+l[6]-1473231341|0)<<17|h>>>15)+f|0)&f|~h&v)+l[7]-45705983|0)<<22|y>>>10)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&h|~y&f)+l[8]+1770035416|0)<<7|v>>>25)+y|0)&y|~v&h)+l[9]-1958414417|0)<<12|f>>>20)+v|0)&v|~f&y)+l[10]-42063|0)<<17|h>>>15)+f|0)&f|~h&v)+l[11]-1990404162|0)<<22|y>>>10)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&h|~y&f)+l[12]+1804603682|0)<<7|v>>>25)+y|0)&y|~v&h)+l[13]-40341101|0)<<12|f>>>20)+v|0)&v|~f&y)+l[14]-1502002290|0)<<17|h>>>15)+f|0)&f|~h&v)+l[15]+1236535329|0)<<22|y>>>10)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&f|h&~f)+l[1]-165796510|0)<<5|v>>>27)+y|0)&h|y&~h)+l[6]-1069501632|0)<<9|f>>>23)+v|0)&y|v&~y)+l[11]+643717713|0)<<14|h>>>18)+f|0)&v|f&~v)+l[0]-373897302|0)<<20|y>>>12)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&f|h&~f)+l[5]-701558691|0)<<5|v>>>27)+y|0)&h|y&~h)+l[10]+38016083|0)<<9|f>>>23)+v|0)&y|v&~y)+l[15]-660478335|0)<<14|h>>>18)+f|0)&v|f&~v)+l[4]-405537848|0)<<20|y>>>12)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&f|h&~f)+l[9]+568446438|0)<<5|v>>>27)+y|0)&h|y&~h)+l[14]-1019803690|0)<<9|f>>>23)+v|0)&y|v&~y)+l[3]-187363961|0)<<14|h>>>18)+f|0)&v|f&~v)+l[8]+1163531501|0)<<20|y>>>12)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y&f|h&~f)+l[13]-1444681467|0)<<5|v>>>27)+y|0)&h|y&~h)+l[2]-51403784|0)<<9|f>>>23)+v|0)&y|v&~y)+l[7]+1735328473|0)<<14|h>>>18)+f|0)&v|f&~v)+l[12]-1926607734|0)<<20|y>>>12)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y^h^f)+l[5]-378558|0)<<4|v>>>28)+y|0)^y^h)+l[8]-2022574463|0)<<11|f>>>21)+v|0)^v^y)+l[11]+1839030562|0)<<16|h>>>16)+f|0)^f^v)+l[14]-35309556|0)<<23|y>>>9)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y^h^f)+l[1]-1530992060|0)<<4|v>>>28)+y|0)^y^h)+l[4]+1272893353|0)<<11|f>>>21)+v|0)^v^y)+l[7]-155497632|0)<<16|h>>>16)+f|0)^f^v)+l[10]-1094730640|0)<<23|y>>>9)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y^h^f)+l[13]+681279174|0)<<4|v>>>28)+y|0)^y^h)+l[0]-358537222|0)<<11|f>>>21)+v|0)^v^y)+l[3]-722521979|0)<<16|h>>>16)+f|0)^f^v)+l[6]+76029189|0)<<23|y>>>9)+h|0,y=((y+=((h=((h+=((f=((f+=((v=((v+=(y^h^f)+l[9]-640364487|0)<<4|v>>>28)+y|0)^y^h)+l[12]-421815835|0)<<11|f>>>21)+v|0)^v^y)+l[15]+530742520|0)<<16|h>>>16)+f|0)^f^v)+l[2]-995338651|0)<<23|y>>>9)+h|0,y=((y+=((f=((f+=(y^((v=((v+=(h^(y|~f))+l[0]-198630844|0)<<6|v>>>26)+y|0)|~h))+l[7]+1126891415|0)<<10|f>>>22)+v|0)^((h=((h+=(v^(f|~y))+l[14]-1416354905|0)<<15|h>>>17)+f|0)|~v))+l[5]-57434055|0)<<21|y>>>11)+h|0,y=((y+=((f=((f+=(y^((v=((v+=(h^(y|~f))+l[12]+1700485571|0)<<6|v>>>26)+y|0)|~h))+l[3]-1894986606|0)<<10|f>>>22)+v|0)^((h=((h+=(v^(f|~y))+l[10]-1051523|0)<<15|h>>>17)+f|0)|~v))+l[1]-2054922799|0)<<21|y>>>11)+h|0,y=((y+=((f=((f+=(y^((v=((v+=(h^(y|~f))+l[8]+1873313359|0)<<6|v>>>26)+y|0)|~h))+l[15]-30611744|0)<<10|f>>>22)+v|0)^((h=((h+=(v^(f|~y))+l[6]-1560198380|0)<<15|h>>>17)+f|0)|~v))+l[13]+1309151649|0)<<21|y>>>11)+h|0,y=((y+=((f=((f+=(y^((v=((v+=(h^(y|~f))+l[4]-145523070|0)<<6|v>>>26)+y|0)|~h))+l[11]-1120210379|0)<<10|f>>>22)+v|0)^((h=((h+=(v^(f|~y))+l[2]+718787259|0)<<15|h>>>17)+f|0)|~v))+l[9]-343485551|0)<<21|y>>>11)+h|0,g[0]=v+g[0]|0,g[1]=y+g[1]|0,g[2]=h+g[2]|0,g[3]=f+g[3]|0}function o(g){var l,v=[];for(l=0;l<64;l+=4)v[l>>2]=g.charCodeAt(l)+(g.charCodeAt(l+1)<<8)+(g.charCodeAt(l+2)<<16)+(g.charCodeAt(l+3)<<24);return v}function r(g){var l,v=[];for(l=0;l<64;l+=4)v[l>>2]=g[l]+(g[l+1]<<8)+(g[l+2]<<16)+(g[l+3]<<24);return v}function i(g){var l,v,y,h,f,L,A=g.length,D=[1732584193,-271733879,-1732584194,271733878];for(l=64;l<=A;l+=64)t(D,o(g.substring(l-64,l)));for(v=(g=g.substring(l-64)).length,y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;l<v;l+=1)y[l>>2]|=g.charCodeAt(l)<<(l%4<<3);if(y[l>>2]|=128<<(l%4<<3),l>55)for(t(D,y),l=0;l<16;l+=1)y[l]=0;return h=(h=8*A).toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(h[2],16),L=parseInt(h[1],16)||0,y[14]=f,y[15]=L,t(D,y),D}function s(g){var l,v,y,h,f,L,A=g.length,D=[1732584193,-271733879,-1732584194,271733878];for(l=64;l<=A;l+=64)t(D,r(g.subarray(l-64,l)));for(v=(g=l-64<A?g.subarray(l-64):new Uint8Array(0)).length,y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0;l<v;l+=1)y[l>>2]|=g[l]<<(l%4<<3);if(y[l>>2]|=128<<(l%4<<3),l>55)for(t(D,y),l=0;l<16;l+=1)y[l]=0;return h=(h=8*A).toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(h[2],16),L=parseInt(h[1],16)||0,y[14]=f,y[15]=L,t(D,y),D}function a(g){var l,v="";for(l=0;l<4;l+=1)v+=e[g>>8*l+4&15]+e[g>>8*l&15];return v}function u(g){var l;for(l=0;l<g.length;l+=1)g[l]=a(g[l]);return g.join("")}function d(g){return/[\u0080-\uFFFF]/.test(g)&&(g=unescape(encodeURIComponent(g))),g}function w(g,l){var v,y=g.length,h=new ArrayBuffer(y),f=new Uint8Array(h);for(v=0;v<y;v+=1)f[v]=g.charCodeAt(v);return l?f:h}function S(g){return String.fromCharCode.apply(null,new Uint8Array(g))}function I(g,l,v){var y=new Uint8Array(g.byteLength+l.byteLength);return y.set(new Uint8Array(g)),y.set(new Uint8Array(l),g.byteLength),y}function N(g){var l,v=[],y=g.length;for(l=0;l<y-1;l+=2)v.push(parseInt(g.substr(l,2),16));return String.fromCharCode.apply(String,v)}function k(){this.reset()}return u(i("hello")),typeof ArrayBuffer>"u"||ArrayBuffer.prototype.slice||function(){function g(l,v){return(l=0|l||0)<0?Math.max(l+v,0):Math.min(l,v)}ArrayBuffer.prototype.slice=function(l,v){var y,h,f,L,A=this.byteLength,D=g(l,A),P=A;return v!==n&&(P=g(v,A)),D>P?new ArrayBuffer(0):(y=P-D,h=new ArrayBuffer(y),f=new Uint8Array(h),L=new Uint8Array(this,D,y),f.set(L),h)}}(),k.prototype.append=function(g){return this.appendBinary(d(g)),this},k.prototype.appendBinary=function(g){this._buff+=g,this._length+=g.length;var l,v=this._buff.length;for(l=64;l<=v;l+=64)t(this._hash,o(this._buff.substring(l-64,l)));return this._buff=this._buff.substring(l-64),this},k.prototype.end=function(g){var l,v,y=this._buff,h=y.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(l=0;l<h;l+=1)f[l>>2]|=y.charCodeAt(l)<<(l%4<<3);return this._finish(f,h),v=u(this._hash),g&&(v=N(v)),this.reset(),v},k.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},k.prototype.setState=function(g){return this._buff=g.buff,this._length=g.length,this._hash=g.hash,this},k.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},k.prototype._finish=function(g,l){var v,y,h,f=l;if(g[f>>2]|=128<<(f%4<<3),f>55)for(t(this._hash,g),f=0;f<16;f+=1)g[f]=0;v=(v=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),y=parseInt(v[2],16),h=parseInt(v[1],16)||0,g[14]=y,g[15]=h,t(this._hash,g)},k.hash=function(g,l){return k.hashBinary(d(g),l)},k.hashBinary=function(g,l){var v=u(i(g));return l?N(v):v},k.ArrayBuffer=function(){this.reset()},k.ArrayBuffer.prototype.append=function(g){var l,v=I(this._buff.buffer,g),y=v.length;for(this._length+=g.byteLength,l=64;l<=y;l+=64)t(this._hash,r(v.subarray(l-64,l)));return this._buff=l-64<y?new Uint8Array(v.buffer.slice(l-64)):new Uint8Array(0),this},k.ArrayBuffer.prototype.end=function(g){var l,v,y=this._buff,h=y.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(l=0;l<h;l+=1)f[l>>2]|=y[l]<<(l%4<<3);return this._finish(f,h),v=u(this._hash),g&&(v=N(v)),this.reset(),v},k.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.ArrayBuffer.prototype.getState=function(){var g=k.prototype.getState.call(this);return g.buff=S(g.buff),g},k.ArrayBuffer.prototype.setState=function(g){return g.buff=w(g.buff,!0),k.prototype.setState.call(this,g)},k.ArrayBuffer.prototype.destroy=k.prototype.destroy,k.ArrayBuffer.prototype._finish=k.prototype._finish,k.ArrayBuffer.hash=function(g,l){var v=u(s(new Uint8Array(g)));return l?N(v):v},k}()),on=jt(as);const rn=[];class de{static addHandler(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent?e.attachEvent("on"+t,o):e["on"+t]=o}static removeHandler(e,t,o){e.removeEventListener?e.removeEventListener(t,o,!1):e.detachEvent?e.detachEvent("on"+t,o):delete e["on"+t]}static windowResizeHandler(e){de.addHandler(window,"resize",e)}static offWindowResizeHandler(e){de.removeHandler(window,"resize",e)}static fullscreenEnabled(){const e=window.document;return document.fullscreenEnabled||window.fullScreen||e.mozFullscreenEnabled||e.webkitIsFullScreen}static fullScreen(e,t){if(t){const o=window.document;let r=window.document.exitFullscreen||o.msExitFullscreen||o.mozCancelFullScreen||o.webkitCancelFullScreen;typeof r<"u"&&r?r.call(window.document):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("WScript.Shell")?.SendKeys("{F11}")}else{let o=e;o||(o=window.document.documentElement);let r=o.requestFullScreen||o.webkitRequestFullScreen||o.mozRequestFullScreen||o.msRequestFullScreen;typeof r<"u"&&r?r.call(o):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("WScript.Shell")?.SendKeys("{F11}")}}static requestFullScreen(e=window.document.documentElement){let t=e;var o=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(o)o.call(t);else if(typeof window.ActiveXObject<"u"){var r=new window.ActiveXObject("WScript.Shell");r!==null&&r.SendKeys("{F11}")}}static exitFullScreen(){const e=window.document;var t=document.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.webkitExitFullscreen;if(t)t.call(document);else if(typeof window.ActiveXObject<"u"){var o=new window.ActiveXObject("WScript.Shell");o!==null&&o.SendKeys("{F11}")}}static fullScreenElement(){return window.document.fullscreenElement||window.document.webkitFullscreenElement||window.document.mozFullscreenElement||window.document.msFullscreenElement}static isFullScreen(){return!!de.fullScreenElement()}static onFullScreenChanged(e){let t;"onfullscreenchange"in window.document?t="fullscreenchange":"onwebkitfullscreenchange"in window.document?t="webkitfullscreenchange":"onmozfullscreenchange"in window.document&&(t="mozfullscreenchange"),t?document.addEventListener(t,function(){const o=de.isFullScreen();e(o)}):document.addEventListener("MSFullscreenChange",function(){const o=de.isFullScreen();e(o)})}static stringifyCircularHandler(e,t){if(typeof t=="object"&&t!==null){if(rn.indexOf(t)!==-1)return;rn.push(t)}return t}static jsonStringify(e){if(!e)return"";const t=JSON.stringify(e,de.stringifyCircularHandler);return rn.length=0,t}static jsonParse(e){const t=de.jsonStringify(e);if(t.length>1)return JSON.parse(t)}static getObjectURL(e){let t;const o=window;return o.createObjcectURL!=null?t=o.createOjcectURL(e):window.URL!=null?t=window.URL.createObjectURL(e):window.webkitURL!=null&&(t=window.webkitURL.createObjectURL(e)),t}static getFileShortMD5(e,t){const o=File.prototype,r=o.slice||o.mozSlice||o.webkitSlice,i=e,s=2097152,a=new on.ArrayBuffer,u=new FileReader;u.onload=function(d){a.append(d.target?.result);const w=a.end();t({isOK:!0,data:w})},u.onerror=function(){t({isOK:!1,data:"计算文件简单摘要错误！"})},function(){const d=0+s>=i.size?i.size:0+s;u.readAsArrayBuffer(r.call(i,0,d))}()}static getFileMD5(e,t){const o=File.prototype,r=o.slice||o.mozSlice||o.webkitSlice,i=e,s=2097152,a=Math.ceil(i.size/s);let u=0;const d=new on.ArrayBuffer,w=new FileReader;function S(){const I=u*s,N=I+s>=i.size?i.size:I+s;w.readAsArrayBuffer(r.call(i,I,N))}w.onload=function(I){if(d.append(I.target?.result),u++,u<a)S();else{const N=d.end();t({isOK:!0,data:N})}},w.onerror=function(){const I=`${i.name}:计算文件简单摘要错误！`;t({isOK:!1,data:I})},S()}static MD5(e,t=!1){return on.hash(e,t)}static copyTextByCommand(e){return new Promise((t,o)=>{const r=document.createElement("input");r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),r.remove(),t(!0)})}static copyText=e=>navigator.clipboard?navigator.clipboard.writeText(e).then(function(){return!0},function(t){return!1}):de.copyTextByCommand(e);static copyElementTextByCommand(e){const t=document.createRange();t.selectNode(document.getElementById(e));const o=window.getSelection();o.rangeCount>0&&o.removeAllRanges(),o.addRange(t);try{return document.execCommand("copy"),o.removeRange(t),!0}catch{return o.removeRange(t),!1}}static copyElementText(e){if(!navigator.clipboard)return de.copyElementTextByCommand(e);const t=document.createRange();t.selectNode(document.getElementById(e));const o=window.getSelection();return o.rangeCount>0&&o.removeAllRanges(),o.addRange(t),navigator.clipboard.writeText(o).then(function(){return o.removeRange(t),!0},function(r){return o.removeRange(t),!1})}static setGrayMode(e){de.toggleClass(e,"grayMode",document.documentElement)}static toggleClass(e,t,o){const r=o||document.body;let{className:i}=r;i=i.replace(t,""),r.className=e?`${i} ${t} `:i}static setCssVar(e,t,o=document.documentElement){o.style.setProperty(e,t)}static dispatchWindowResize(){const e=new Event("resize");window.dispatchEvent(e)}static dispatchElementEvent(e,t="click",o){let r;if(r=xr(e)?document.getElementById(e):e,r){const i=new Event(t,{bubbles:!0,cancelable:!0});o&&r.addEventListener("ev",s=>{o(s)},!1),r.dispatchEvent(i)}}static getRandomNum(e,t){var o=t-e,r=Math.random();return e+Math.round(r*o)}static merge(e={},t={}){let o,r,i,s;for(e||(e={}),r=0,i=t.length;r<i;r++)for(o in s=t[r],s)e[o]=s[o];return e}static setOptions(e,t){e.hasOwnProperty("options")||(e.options=e.options?Object.create(e.options):{});for(let o in t)e.options[o]=t[o];return e.options}static formatNum(e,t){let o=Math.pow(10,t===void 0?6:t);return Math.round(e*o)/o}static trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}static splitWords(e){return this.trim(e).split(/\s+/)}static emptyImageUrl(){return"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}static debounce(e,t){let o=null;return function(){o&&clearTimeout(o),o=setTimeout(e,t)}}static throttle(e,t){let o=!0;return function(){if(!o)return!1;o=!1,setTimeout(()=>{e(),o=!0},t)}}static dataURLtoBlob(e){let t=e.split(",");if(!t||t.length===0)return;let o=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,s=new Uint8Array(i);for(;i--;)s[i]=r.charCodeAt(i);return new Blob([s],{type:o})}static getElement(e){return typeof e=="string"?document.getElementById(e):e}static getStyle(e,t){let o=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!o||o==="auto")&&document.defaultView){let r=document.defaultView.getComputedStyle(e,null);o=r?r[t]:null}return o==="auto"?null:o}static create(e,t,o){let r=document.createElement(e);return r.className=t||"",o&&o.appendChild(r),r}static removeElement(e){let t=e.parentNode;t&&t.removeChild(e)}static emptyElement(e){for(;e.firstChild;)e.removeChild(e.firstChild)}static hasClass(e,t){if(e.classList!==void 0)return e.classList.contains(t);let o=this.getClass(e);return o.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(o)}static addClass(e,t){if(e.classList!==void 0){let o=this.splitWords(t);for(let r=0,i=o.length;r<i;r++)e.classList.add(o[r])}else if(!this.hasClass(e,t)){let o=this.getClass(e);this.setClass(e,(o?o+" ":"")+t)}}static removeClass(e,t){e.classList!==void 0?e.classList.remove(t):this.setClass(e,this.trim((" "+this.getClass(e)+" ").replace(" "+t+" "," ")))}static setClass(e,t){e.className.baseVal===void 0?e.className=t:e.className.baseVal=t}static getClass(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}static createSvgElement(e,t,o,r){let i=document.createElementNS("http://www.w3.org/2000/svg","svg:svg");i.setAttribute("class","svg-path"),i.setAttribute("width",e),i.setAttribute("height",t),i.setAttribute("viewBox",`0 0 ${e} ${t}`);let s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",o),i.appendChild(s),r&&r.appendChild(i),i}static parseDom(e,t=!0,o=""){t=t??!1;let r=document.createElement("div");return r.className=o||"",r.innerHTML=e,t?r:r.childNodes}static createVideoHTML(e,t,o){let r=this.create("video",t,o),i=this.create("source","",r);i.setAttribute("src",e),i.setAttribute("type","video/map4");let s=this.create("source","",r);return s.setAttribute("src",e),s.setAttribute("type","video/quicktime"),r}}class Er{static isNullOrEmpty=e=>e===null||e===""||e===void 0||e.length===0;static isNotEmpty=e=>!(e===null||e===""||e===void 0||e.length===0);static toHump(e){return e.replace(/[\-\/\_](\w)/g,(t,o)=>o.toUpperCase()).replace("views","")}}class kr{prefixKey;storage;constructor(e="",t=localStorage){this.prefixKey=e,this.storage=t}getKey(e){return`${this.prefixKey}${e}`.toUpperCase()}set(e,t,o=604800){const r=JSON.stringify({value:t,expire:o!==null?new Date().getTime()+1e3*o:null});this.storage.setItem(this.getKey(e),r)}get(e,t=null){const o=this.storage.getItem(this.getKey(e));if(o)try{const r=JSON.parse(o),{value:i,expire:s}=r;if(s===null||s>=Date.now())return i;this.remove(this.getKey(e))}catch{return t}return t}getJsonObject(e){const t=this.storage.getItem(this.getKey(e));if(t)try{const o=JSON.parse(t);if(o.expire===null||o.expire>=Date.now())return o;this.remove(this.getKey(e))}catch{return}}remove(e){this.storage.removeItem(this.getKey(e))}clear(){this.storage.clear()}setCookie(e,t,o=604800){document.cookie=`${this.getKey(e)}=${t}; Max-Age=${o}`}getCookie(e){const t=document.cookie.split("; ");for(let o=0,r=t.length;o<r;o++){const i=t[o].split("=");if(i[0]===this.getKey(e))return i[1]}return""}removeCookie(e){this.setCookie(e,1,-1)}clearCookie(){const e=document.cookie.match(/[^ =;]+(?==)/g);if(e)for(let t=e.length;t--;)document.cookie=e[t]+"=0;expire="+new Date(0).toUTCString()}}function cs(){let n=[];const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var t=0;t<36;t++){const r=Math.floor(16*Math.random());n[t]=e.substring(r,r+1)}n[14]="4";const o=3&Number(n[19])|8;return n[19]=e.substring(o,o+1),n[8]=n[13]=n[18]=n[23]="-",n.join("")}function Va(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?o:3&o|8).toString(16)});return e}var Io;function ls(n){return{all:n=n||new Map,on(e,t){const o=n?.get(e);o&&o.push(t)||n?.set(e,[t])},off(e,t){const o=n?.get(e);o&&o.splice(o.indexOf(t)>>>0,1)},emit(e,t){(n?.get(e)||[]).slice().map(o=>{o(t)}),(n?.get("*")||[]).slice().map(o=>{o(e,t)})}}}(function(n){n[n.RGBA=0]="RGBA",n[n.Hex=1]="Hex",n[n.Hsla=2]="Hsla"})(Io||(Io={}));const kt=ls(),pe={HproseServiceErrorEvent:"HproseServiceError",WebAPIErrorEvent:"WebAPIError",AlertInfoEvent:"AlertInfoEvent",CommonWarnEvent:"CommonWarnEvent",WidgetLoadedEvent:"WidgetLoaded",WidgetLoaded:"WidgetLoaded",WidgetUnLoadedEvent:"WidgetUnLoaded",WidgetLoadedErrorEvent:"WidgetLoadedError",WidgetVisibleChanged:"WidgetVisibleChanged",AxiosRequestErrorEvent:"AxiosRequestErrorEvent",LayoutContainerLoaded:"LayoutContainerLoaded"},us=(n,e)=>{const t=document.createElement("a");t.download=e,t.style.display="none";const o=new Blob([n],{type:"application/octet-stream"});t.href=URL.createObjectURL(o),document.body.appendChild(t),t.click(),document.body.removeChild(t)},hs=(n,e)=>{const t=JSON.stringify(n,null,2);us(t,e+".json")};var To,sn={exports:{}},Mo,Ro,an,cn=(To||(To=1,Ro=sn.exports,an=function(){var n=function(){},e="undefined",t=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],r={},i=null;function s(k,g){var l=k[g];if(typeof l.bind=="function")return l.bind(k);try{return Function.prototype.bind.call(l,k)}catch{return function(){return Function.prototype.apply.apply(l,[k,arguments])}}}function a(){console.log&&(console.log.apply||Function.prototype.apply.apply(console.log,[console,arguments]))}function u(k){return k==="debug"&&(k="log"),typeof console!==e&&(k==="trace"&&t?a:console[k]!==void 0?s(console,k):console.log!==void 0?s(console,"log"):n)}function d(){for(var k=this.getLevel(),g=0;g<o.length;g++){var l=o[g];this[l]=g<k?n:this.methodFactory(l,k,this.name)}if(this.log=this.debug,typeof console===e&&k<this.levels.SILENT)return"No console available for logging"}function w(k){return function(){typeof console!==e&&(d.call(this),this[k].apply(this,arguments))}}function S(k,g,l){return u(k)||w.apply(this,arguments)}function I(k,g){var l,v,y,h=this,f="loglevel";function L(){var P;if(typeof window!==e&&f){try{P=window.localStorage[f]}catch{}if(typeof P===e)try{var $=window.document.cookie,O=encodeURIComponent(f),T=$.indexOf(O+"=");T!==-1&&(P=/^([^;]+)/.exec($.slice(T+O.length+1))[1])}catch{}return h.levels[P]===void 0&&(P=void 0),P}}function A(P){var $=P;if(typeof $=="string"&&h.levels[$.toUpperCase()]!==void 0&&($=h.levels[$.toUpperCase()]),typeof $=="number"&&$>=0&&$<=h.levels.SILENT)return $;throw new TypeError("log.setLevel() called with invalid level: "+P)}typeof k=="string"?f+=":"+k:typeof k=="symbol"&&(f=void 0),h.name=k,h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},h.methodFactory=g||S,h.getLevel=function(){return y??v??l},h.setLevel=function(P,$){return y=A(P),$!==!1&&function(O){var T=(o[O]||"silent").toUpperCase();if(typeof window!==e&&f){try{return void(window.localStorage[f]=T)}catch{}try{window.document.cookie=encodeURIComponent(f)+"="+T+";"}catch{}}}(y),d.call(h)},h.setDefaultLevel=function(P){v=A(P),L()||h.setLevel(P,!1)},h.resetLevel=function(){y=null,function(){if(typeof window!==e&&f){try{window.localStorage.removeItem(f)}catch{}try{window.document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}(),d.call(h)},h.enableAll=function(P){h.setLevel(h.levels.TRACE,P)},h.disableAll=function(P){h.setLevel(h.levels.SILENT,P)},h.rebuild=function(){if(i!==h&&(l=A(i.getLevel())),d.call(h),i===h)for(var P in r)r[P].rebuild()},l=A(i?i.getLevel():"WARN");var D=L();D!=null&&(y=A(D)),d.call(h)}(i=new I).getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var g=r[k];return g||(g=r[k]=new I(k,i.methodFactory)),g};var N=typeof window!==e?window.log:void 0;return i.noConflict=function(){return typeof window!==e&&window.log===i&&(window.log=N),i},i.getLoggers=function(){return r},i.default=i,i},(Mo=sn).exports?Mo.exports=an():Ro.log=an()),sn.exports);class Ir{message;eventBus;constructor(e,t){e&&(this.message=e),t&&(this.eventBus=t)}msg(e,t=3,o="success"){if(this.message)if(typeof this.message=="function")this.message({type:o,message:e,duration:t});else switch(o){case"info":this.message.info(e,t);break;case"success":this.message.success(e,t);break;case"warning":this.message.warn?this.message.warn(e,t):this.message.warning&&this.message.warning(e,t);break;case"error":this.message.error(e,t)}else{switch(o){case"info":case"success":break;case"warning":break;case"error":o="dark"}this.eventBus&&this.eventBus.emit(pe.AlertInfoEvent,{type:o,info:e})}}info(e,t=3){this.msg(e,t,"info")}warn(e,t=3){this.msg(e,t,"warning")}err(e,t=3){this.msg(e,t,"error")}success(e,t=3){this.msg(e,t,"success")}}let Po=!1;const W={Config:SysConfig,EventBus:kt,DefaultProxyClient:null,Axios:Gi,Message:new Ir(void 0,kt),LayoutMap:new Map,getLayoutManager:n=>{if(!W.WidgetConfigList||W.WidgetConfigList.length===0)return;const e=W.WidgetConfigList.find(t=>t.id===n);if(e){const t=e.layoutID;if(t&&W.LayoutMap.has(t))return W.LayoutMap.get(t)}},Logger:n=>{Po||(SysConfig.UI.ProductLog?cn.enableAll():cn.setDefaultLevel("warn"),Po=!0);const e=n||"default";return cn.getLogger(e)}},Tr="access_token",De=new kr("user",localStorage);function qe(){return De.get(Tr)}function Mr(){De.remove(Tr)}function ds(){return qe()?.refresh}function Rr(n,e,t,o="json",r){const i={baseURL:W.Config.ServiceURL.DefaultWebAPI,timeout:6e4,params:n,paramsSerializer:{serialize:function(s){return Qi.stringify(s,{indices:!1,arrayFormat:"repeat"})}},headers:{"Content-Type":"application/json",Authorization:"bearer "+qe()?.token},responseType:o,cancelToken:r};return W.SystemID&&(i.headers.sysid=W.SystemID,W.SystemGroup&&(i.headers.sysgroup=W.SystemGroup)),e&&(i.baseURL=e),i}function Fe(n,e,t,o,r="json",i,s){const a=Rr(t,e,o,r,i);return W.Axios?.get(n,a).catch(function(u){Pr(u,e,n,"Get")})}function Pr(n,e,t,o="Get"){const r=`${e}${t}`;if(n&&n.response){let i=!1;const s=n.response.status;switch(s){case 400:n.message="错误请求";break;case 401:n.message="未授权，请重新登录";break;case 403:n.message="拒绝访问";break;case 404:n.message="请求错误,未找到该资源";break;case 405:n.message="请求方法未允许";break;case 408:n.message="请求超时";break;case 500:const u=n.response.data;if(u){const d=u.indexOf(":"),w=u.indexOf(`
`);if(d>0&&w-d>2){const S=u.substring(d+2,w);S.indexOf("System.Exception")>0?n.message="后台服务内部出错！":(i=!0,n.message=S)}else i=!0,n.message=u}else n.message="服务器端出错";break;case 501:n.message="网络未实现";break;case 502:n.message="网络错误";break;case 503:n.message="服务不可用";break;case 504:n.message="网络超时";break;case 505:n.message="http版本不支持该请求";break;default:n.message=`连接错误${n.response.status}`}let a={address:r,code:s,isExceptionInfo:i,message:n.message,result:n.response.data};if(W.EventBus.emit(pe.AxiosRequestErrorEvent,a),i)throw new Error(n.message)}else if(n?.message)throw new Error(n.message)}function fs(n,e,t,o,r,i="json",s){const a=Rr(o,e,r,i);return W.Axios?.post(n,t,a).catch(function(u){Pr(u,e,n,"Post")})}function Ya(n,e){return Fe(n,void 0,e)}var Lo,zo,ln,Ao,un,Do,hn,No,$o,ut={exports:{}};function ps(){return zo?Lo:(zo=1,n=typeof window<"u"?window:We!==void 0?We:typeof self<"u"?self:{},Lo=n);var n}function gs(){if(Ao)return ln;Ao=1,ln=function(e){if(!e)return!1;var t=n.call(e);return t==="[object Function]"||typeof e=="function"&&t!=="[object RegExp]"||typeof window<"u"&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString;return ln}function ms(){if(Do)return un;Do=1;var n=function(e){return e.replace(/^\s+|\s+$/g,"")};return un=function(e){if(!e)return{};for(var t,o={},r=n(e).split(`
`),i=0;i<r.length;i++){var s=r[i],a=s.indexOf(":"),u=n(s.slice(0,a)).toLowerCase(),d=n(s.slice(a+1));o[u]===void 0?o[u]=d:(t=o[u],Object.prototype.toString.call(t)==="[object Array]"?o[u].push(d):o[u]=[o[u],d])}return o},un}var vs=function(){if($o)return ut.exports;$o=1;var n=ps(),e=gs(),t=ms(),o=function(){if(No)return hn;No=1,hn=function(){for(var u={},d=0;d<arguments.length;d++){var w=arguments[d];for(var S in w)a.call(w,S)&&(u[S]=w[S])}return u};var a=Object.prototype.hasOwnProperty;return hn}();function r(a,u,d){var w=a;return e(u)?(d=u,typeof a=="string"&&(w={uri:a})):w=o(u,{uri:a}),w.callback=d,w}function i(a,u,d){return s(u=r(a,u,d))}function s(a){if(a.callback===void 0)throw new Error("callback argument missing");var u=!1,d=function(P,$,O){u||(u=!0,a.callback(P,$,O))};function w(){var P=void 0;if(P=g.response?g.response:g.responseText||function($){try{if($.responseType==="document")return $.responseXML;var O=$.responseXML&&$.responseXML.documentElement.nodeName==="parsererror";if($.responseType===""&&!O)return $.responseXML}catch{}return null}(g),A)try{P=JSON.parse(P)}catch{}return P}function S(P){return clearTimeout(l),P instanceof Error||(P=new Error(""+(P||"Unknown XMLHttpRequest Error"))),P.statusCode=0,d(P,D)}function I(){if(!k){var P;clearTimeout(l),P=a.useXDR&&g.status===void 0?200:g.status===1223?204:g.status;var $=D,O=null;return P!==0?($={body:w(),statusCode:P,method:y,headers:{},url:v,rawRequest:g},g.getAllResponseHeaders&&($.headers=t(g.getAllResponseHeaders()))):O=new Error("Internal XMLHttpRequest Error"),d(O,$,$.body)}}var N,k,g=a.xhr||null;g||(g=a.cors||a.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var l,v=g.url=a.uri||a.url,y=g.method=a.method||"GET",h=a.body||a.data,f=g.headers=a.headers||{},L=!!a.sync,A=!1,D={body:void 0,headers:{},statusCode:0,method:y,url:v,rawRequest:g};if("json"in a&&a.json!==!1&&(A=!0,f.accept||f.Accept||(f.Accept="application/json"),y!=="GET"&&y!=="HEAD"&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),h=JSON.stringify(a.json===!0?h:a.json))),g.onreadystatechange=function(){g.readyState===4&&setTimeout(I,0)},g.onload=I,g.onerror=S,g.onprogress=function(){},g.onabort=function(){k=!0},g.ontimeout=S,g.open(y,v,!L,a.username,a.password),L||(g.withCredentials=!!a.withCredentials),!L&&a.timeout>0&&(l=setTimeout(function(){if(!k){k=!0,g.abort("timeout");var P=new Error("XMLHttpRequest timeout");P.code="ETIMEDOUT",S(P)}},a.timeout)),g.setRequestHeader)for(N in f)f.hasOwnProperty(N)&&g.setRequestHeader(N,f[N]);else if(a.headers&&!function(P){for(var $ in P)if(P.hasOwnProperty($))return!1;return!0}(a.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in a&&(g.responseType=a.responseType),"beforeSend"in a&&typeof a.beforeSend=="function"&&a.beforeSend(g),g.send(h||null),g}return ut.exports=i,ut.exports.default=i,i.XMLHttpRequest=n.XMLHttpRequest||function(){},i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:n.XDomainRequest,function(a,u){for(var d=0;d<a.length;d++)u(a[d])}(["get","put","post","patch","head","delete"],function(a){i[a==="delete"?"del":a]=function(u,d,w){return(d=r(u,d,w)).method=a.toUpperCase(),s(d)}}),ut.exports}();jt(vs);class It{hproseURL;client;hproseProxy;static httpTransport;constructor(e){if(e&&!Er.isNullOrEmpty(e)){if(It.httpTransport||(It.httpTransport=new Zi),this.client=new es(e),!this.client)throw Error("Hprose Client初始化错误");this.hproseURL=e,this.init()}}init(){this.client&&this.client.useServiceAsync().then(e=>{this.hproseProxy=e}).catch(e=>{String(e).indexOf("find this method ~")>0?this.hproseProxy=this.client?.useService():kt.emit(pe.HproseServiceErrorEvent,"初始化默认Hprose!")})}async getProxy(){if(!this.hproseProxy)try{this.client&&(this.hproseProxy=await this.client.useServiceAsync())}catch{this.hproseProxy=this.client?.useService()}return this.hproseProxy}async invoke(e,t,o){if(this.client)return await this.client.invoke(e,t,o)}encode(e,t,o){if(this.client)return this.client.codec.encode(e,t,o)}decode(e,t){if(this.client)return this.client.codec.decode(e,t)}}class ys{hproseClient;hpProxyObj;defaultContext=new tn;constructor(e){this.hproseClient=new It(e),this.hpProxyObj=null}getClientContext(e,t){const o={};t&&(o.requestHeaders=t);const r=qe();o.httpRequestHeaders=e||{};const i=o.httpRequestHeaders;return r&&(i.token=r.token),W.SystemID&&(i.sysid=W.SystemID,W.SystemGroup&&(i.sysgroup=W.SystemGroup)),new tn(o)}async getHproseProxy(){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");if(!this.hpProxyObj){const e=await this.hproseClient.getProxy();this.hpProxyObj=e}return this.hpProxyObj||kt.emit(pe.HproseServiceErrorEvent,"HproseProxy对象为空，无法调用Hprose方法！"),this.hpProxyObj}async hproseInvoke(e,t,o){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");return await this.hproseClient.invoke(e,t,o)}async hproseInvokeContext(e,t,...o){if(!this.hproseClient)throw new Error("HproseClient对象为构建，无法调用Hprose方法");const r=qe();return r&&(t||(t=new tn({httpRequestHeaders:{token:r.token}}))),await this.hproseClient.invoke(e,o,t)}async hproseInvokeEncode(e){const t=new bo(e).toBytes(),o=await this.hproseClient.client?.request(t,this.defaultContext);return o&&this.hproseClient.client?.codec.decode(o,this.defaultContext)}encodeRequest(e,...t){const o=this.hproseClient.client?.codec?.encode(e,t,this.defaultContext);return bo.toString(o)}}const Ja=function(n,e,t){!W.Config.DefaultHproseAPI&&W.Config.ServiceURL&&(W.Config.DefaultHproseAPI=W.Config.ServiceURL.DefaultHproseAPI),W.Config.DefaultHproseAPI&&Er.isNotEmpty(W.Config.DefaultHproseAPI)&&(W.DefaultProxyClient=new ys(W.Config.DefaultHproseAPI));const o=W.Config.UI.GrayMode;o&&de.setGrayMode(o);const r=new Ir(n,W.EventBus);W.Message=r,W.SystemID=e,W.SystemGroup=t,W.EventBus.on(pe.HproseServiceErrorEvent,i=>{const s=`当前后台业务服务不可用!${i}`}),W.EventBus.on(pe.WebAPIErrorEvent,i=>{const s=`WebAPI后台服务不可用!${i}`}),W.EventBus.on(pe.AxiosRequestErrorEvent,i=>{const s=`Http请求'${i.code}'错误: ${i.message}`}),W.EventBus.on(pe.CommonWarnEvent,i=>{r.warn(i)})},Lr="is_LockScreen",jo=De.get(Lr,!1),Qe={isLock:jo,lockTime:jo=="true"?zr():0};function Oo(n){Qe.isLock=n,De.set(Lr,n,10),n&&Mr()}function zr(){let n=3600;return W.Config.UI?.LockTime&&W.Config.UI?.LockTime>=10&&(n=W.Config.UI.LockTime),n}let dn;function xn(){clearInterval(dn),!(window.location.href.indexOf("/login")>0||Qe.isLock)&&(Oo(!1),Qe.lockTime=zr(),dn=setInterval(()=>{if(Qe.lockTime--,Qe.lockTime<=0)return Oo(!0),clearInterval(dn)},1e3))}function Ga(){xn(),document.addEventListener("mousedown",xn)}function Qa(){document.removeEventListener("mousedown",xn)}function fn(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wo,Bo={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var qo,ws=Wo?Bo.exports:(Wo=1,Bo.exports=function n(e,t,o){function r(a,u){if(!t[a]){if(!e[a]){if(!u&&fn)return fn(a);if(i)return i(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var w=t[a]={exports:{}};e[a][0].call(w.exports,function(S){var I=e[a][1][S];return r(I||S)},w,w.exports,n,e,t,o)}return t[a].exports}for(var i=fn,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(n,e,t){(function(o){var r,i,s=o.MutationObserver||o.WebKitMutationObserver;if(s){var a=0,u=new s(I),d=o.document.createTextNode("");u.observe(d,{characterData:!0}),r=function(){d.data=a=++a%2}}else if(o.setImmediate||o.MessageChannel===void 0)r="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var k=o.document.createElement("script");k.onreadystatechange=function(){I(),k.onreadystatechange=null,k.parentNode.removeChild(k),k=null},o.document.documentElement.appendChild(k)}:function(){setTimeout(I,0)};else{var w=new o.MessageChannel;w.port1.onmessage=I,r=function(){w.port2.postMessage(0)}}var S=[];function I(){var k,g;i=!0;for(var l=S.length;l;){for(g=S,S=[],k=-1;++k<l;)g[k]();l=S.length}i=!1}function N(k){S.push(k)!==1||i||r()}e.exports=N}).call(this,We!==void 0?We:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,e,t){var o=n(1);function r(){}var i={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function d(h){if(typeof h!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,h!==r&&N(this,h)}function w(h,f,L){this.promise=h,typeof f=="function"&&(this.onFulfilled=f,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function S(h,f,L){o(function(){var A;try{A=f(L)}catch(D){return i.reject(h,D)}A===h?i.reject(h,new TypeError("Cannot resolve promise with itself")):i.resolve(h,A)})}function I(h){var f=h&&h.then;if(h&&(typeof h=="object"||typeof h=="function")&&typeof f=="function")return function(){f.apply(h,arguments)}}function N(h,f){var L=!1;function A(O){L||(L=!0,i.reject(h,O))}function D(O){L||(L=!0,i.resolve(h,O))}function P(){f(D,A)}var $=k(P);$.status==="error"&&A($.value)}function k(h,f){var L={};try{L.value=h(f),L.status="success"}catch(A){L.status="error",L.value=A}return L}function g(h){return h instanceof this?h:i.resolve(new this(r),h)}function l(h){var f=new this(r);return i.reject(f,h)}function v(h){var f=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=h.length,A=!1;if(!L)return this.resolve([]);for(var D=new Array(L),P=0,$=-1,O=new this(r);++$<L;)T(h[$],$);return O;function T(q,H){function ie(Q){D[H]=Q,++P!==L||A||(A=!0,i.resolve(O,D))}f.resolve(q).then(ie,function(Q){A||(A=!0,i.reject(O,Q))})}}function y(h){var f=this;if(Object.prototype.toString.call(h)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=h.length,A=!1;if(!L)return this.resolve([]);for(var D=-1,P=new this(r);++D<L;)$(h[D]);return P;function $(O){f.resolve(O).then(function(T){A||(A=!0,i.resolve(P,T))},function(T){A||(A=!0,i.reject(P,T))})}}e.exports=d,d.prototype.catch=function(h){return this.then(null,h)},d.prototype.then=function(h,f){if(typeof h!="function"&&this.state===a||typeof f!="function"&&this.state===s)return this;var L=new this.constructor(r);return this.state!==u?S(L,this.state===a?h:f,this.outcome):this.queue.push(new w(L,h,f)),L},w.prototype.callFulfilled=function(h){i.resolve(this.promise,h)},w.prototype.otherCallFulfilled=function(h){S(this.promise,this.onFulfilled,h)},w.prototype.callRejected=function(h){i.reject(this.promise,h)},w.prototype.otherCallRejected=function(h){S(this.promise,this.onRejected,h)},i.resolve=function(h,f){var L=k(I,f);if(L.status==="error")return i.reject(h,L.value);var A=L.value;if(A)N(h,A);else{h.state=a,h.outcome=f;for(var D=-1,P=h.queue.length;++D<P;)h.queue[D].callFulfilled(f)}return h},i.reject=function(h,f){h.state=s,h.outcome=f;for(var L=-1,A=h.queue.length;++L<A;)h.queue[L].callRejected(f);return h},d.resolve=g,d.reject=l,d.all=v,d.race=y},{1:1}],3:[function(n,e,t){(function(o){typeof o.Promise!="function"&&(o.Promise=n(2))}).call(this,We!==void 0?We:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,e,t){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};function r(c,p){if(!(c instanceof p))throw new TypeError("Cannot call a class as a function")}function i(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var s=i();function a(){try{if(!s||!s.open)return!1;var c=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),p=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!c||p)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function u(c,p){c=c||[],p=p||{};try{return new Blob(c,p)}catch(b){if(b.name!=="TypeError")throw b;for(var m=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),_=0;_<c.length;_+=1)m.append(c[_]);return m.getBlob(p.type)}}typeof Promise>"u"&&n(3);var d=Promise;function w(c,p){p&&c.then(function(m){p(null,m)},function(m){p(m)})}function S(c,p,m){typeof p=="function"&&c.then(p),typeof m=="function"&&c.catch(m)}function I(c){return typeof c!="string"&&(c=String(c)),c}function N(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var k="local-forage-detect-blob-support",g=void 0,l={},v=Object.prototype.toString,y="readonly",h="readwrite";function f(c){for(var p=c.length,m=new ArrayBuffer(p),_=new Uint8Array(m),b=0;b<p;b++)_[b]=c.charCodeAt(b);return m}function L(c){return new d(function(p){var m=c.transaction(k,h),_=u([""]);m.objectStore(k).put(_,"key"),m.onabort=function(b){b.preventDefault(),b.stopPropagation(),p(!1)},m.oncomplete=function(){var b=navigator.userAgent.match(/Chrome\/(\d+)/),C=navigator.userAgent.match(/Edge\//);p(C||!b||parseInt(b[1],10)>=43)}}).catch(function(){return!1})}function A(c){return typeof g=="boolean"?d.resolve(g):L(c).then(function(p){return g=p})}function D(c){var p=l[c.name],m={};m.promise=new d(function(_,b){m.resolve=_,m.reject=b}),p.deferredOperations.push(m),p.dbReady?p.dbReady=p.dbReady.then(function(){return m.promise}):p.dbReady=m.promise}function P(c){var p=l[c.name].deferredOperations.pop();if(p)return p.resolve(),p.promise}function $(c,p){var m=l[c.name].deferredOperations.pop();if(m)return m.reject(p),m.promise}function O(c,p){return new d(function(m,_){if(l[c.name]=l[c.name]||_e(),c.db){if(!p)return m(c.db);D(c),c.db.close()}var b=[c.name];p&&b.push(c.version);var C=s.open.apply(s,b);p&&(C.onupgradeneeded=function(x){var M=C.result;try{M.createObjectStore(c.storeName),x.oldVersion<=1&&M.createObjectStore(k)}catch(R){if(R.name!=="ConstraintError")throw R}}),C.onerror=function(x){x.preventDefault(),_(C.error)},C.onsuccess=function(){var x=C.result;x.onversionchange=function(M){M.target.close()},m(x),P(c)}})}function T(c){return O(c,!1)}function q(c){return O(c,!0)}function H(c,p){if(!c.db)return!0;var m=!c.db.objectStoreNames.contains(c.storeName),_=c.version<c.db.version,b=c.version>c.db.version;if(_&&(c.version,c.version=c.db.version),b||m){if(m){var C=c.db.version+1;C>c.version&&(c.version=C)}return!0}return!1}function ie(c){return new d(function(p,m){var _=new FileReader;_.onerror=m,_.onloadend=function(b){var C=btoa(b.target.result||"");p({__local_forage_encoded_blob:!0,data:C,type:c.type})},_.readAsBinaryString(c)})}function Q(c){return u([f(atob(c.data))],{type:c.type})}function Z(c){return c&&c.__local_forage_encoded_blob}function be(c){var p=this,m=p._initReady().then(function(){var _=l[p._dbInfo.name];if(_&&_.dbReady)return _.dbReady});return S(m,c,c),m}function $e(c){D(c);for(var p=l[c.name],m=p.forages,_=0;_<m.length;_++){var b=m[_];b._dbInfo.db&&(b._dbInfo.db.close(),b._dbInfo.db=null)}return c.db=null,T(c).then(function(C){return c.db=C,H(c)?q(c):C}).then(function(C){c.db=p.db=C;for(var x=0;x<m.length;x++)m[x]._dbInfo.db=C}).catch(function(C){throw $(c,C),C})}function te(c,p,m,_){_===void 0&&(_=1);try{var b=c.db.transaction(c.storeName,p);m(null,b)}catch(C){if(_>0&&(!c.db||C.name==="InvalidStateError"||C.name==="NotFoundError"))return d.resolve().then(function(){if(!c.db||C.name==="NotFoundError"&&!c.db.objectStoreNames.contains(c.storeName)&&c.version<=c.db.version)return c.db&&(c.version=c.db.version+1),q(c)}).then(function(){return $e(c).then(function(){te(c,p,m,_-1)})}).catch(m);m(C)}}function _e(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function qt(c){var p=this,m={db:null};if(c)for(var _ in c)m[_]=c[_];var b=l[m.name];b||(b=_e(),l[m.name]=b),b.forages.push(p),p._initReady||(p._initReady=p.ready,p.ready=be);var C=[];function x(){return d.resolve()}for(var M=0;M<b.forages.length;M++){var R=b.forages[M];R!==p&&C.push(R._initReady().catch(x))}var z=b.forages.slice(0);return d.all(C).then(function(){return m.db=b.db,T(m)}).then(function(j){return m.db=j,H(m,p._defaultConfig.version)?q(m):j}).then(function(j){m.db=b.db=j,p._dbInfo=m;for(var B=0;B<z.length;B++){var F=z[B];F!==p&&(F._dbInfo.db=m.db,F._dbInfo.version=m.version)}})}function Ut(c,p){var m=this;c=I(c);var _=new d(function(b,C){m.ready().then(function(){te(m._dbInfo,y,function(x,M){if(x)return C(x);try{var R=M.objectStore(m._dbInfo.storeName).get(c);R.onsuccess=function(){var z=R.result;z===void 0&&(z=null),Z(z)&&(z=Q(z)),b(z)},R.onerror=function(){C(R.error)}}catch(z){C(z)}})}).catch(C)});return w(_,p),_}function Ft(c,p){var m=this,_=new d(function(b,C){m.ready().then(function(){te(m._dbInfo,y,function(x,M){if(x)return C(x);try{var R=M.objectStore(m._dbInfo.storeName).openCursor(),z=1;R.onsuccess=function(){var j=R.result;if(j){var B=j.value;Z(B)&&(B=Q(B));var F=c(B,j.key,z++);F!==void 0?b(F):j.continue()}else b()},R.onerror=function(){C(R.error)}}catch(j){C(j)}})}).catch(C)});return w(_,p),_}function rt(c,p,m){var _=this;c=I(c);var b=new d(function(C,x){var M;_.ready().then(function(){return M=_._dbInfo,v.call(p)==="[object Blob]"?A(M.db).then(function(R){return R?p:ie(p)}):p}).then(function(R){te(_._dbInfo,h,function(z,j){if(z)return x(z);try{var B=j.objectStore(_._dbInfo.storeName);R===null&&(R=void 0);var F=B.put(R,c);j.oncomplete=function(){R===void 0&&(R=null),C(R)},j.onabort=j.onerror=function(){var K=F.error?F.error:F.transaction.error;x(K)}}catch(K){x(K)}})}).catch(x)});return w(b,m),b}function Xe(c,p){var m=this;c=I(c);var _=new d(function(b,C){m.ready().then(function(){te(m._dbInfo,h,function(x,M){if(x)return C(x);try{var R=M.objectStore(m._dbInfo.storeName).delete(c);M.oncomplete=function(){b()},M.onerror=function(){C(R.error)},M.onabort=function(){var z=R.error?R.error:R.transaction.error;C(z)}}catch(z){C(z)}})}).catch(C)});return w(_,p),_}function Ke(c){var p=this,m=new d(function(_,b){p.ready().then(function(){te(p._dbInfo,h,function(C,x){if(C)return b(C);try{var M=x.objectStore(p._dbInfo.storeName).clear();x.oncomplete=function(){_()},x.onabort=x.onerror=function(){var R=M.error?M.error:M.transaction.error;b(R)}}catch(R){b(R)}})}).catch(b)});return w(m,c),m}function ve(c){var p=this,m=new d(function(_,b){p.ready().then(function(){te(p._dbInfo,y,function(C,x){if(C)return b(C);try{var M=x.objectStore(p._dbInfo.storeName).count();M.onsuccess=function(){_(M.result)},M.onerror=function(){b(M.error)}}catch(R){b(R)}})}).catch(b)});return w(m,c),m}function it(c,p){var m=this,_=new d(function(b,C){c<0?b(null):m.ready().then(function(){te(m._dbInfo,y,function(x,M){if(x)return C(x);try{var R=M.objectStore(m._dbInfo.storeName),z=!1,j=R.openKeyCursor();j.onsuccess=function(){var B=j.result;B?c===0||z?b(B.key):(z=!0,B.advance(c)):b(null)},j.onerror=function(){C(j.error)}}catch(B){C(B)}})}).catch(C)});return w(_,p),_}function st(c){var p=this,m=new d(function(_,b){p.ready().then(function(){te(p._dbInfo,y,function(C,x){if(C)return b(C);try{var M=x.objectStore(p._dbInfo.storeName).openKeyCursor(),R=[];M.onsuccess=function(){var z=M.result;z?(R.push(z.key),z.continue()):_(R)},M.onerror=function(){b(M.error)}}catch(z){b(z)}})}).catch(b)});return w(m,c),m}function Ve(c,p){p=N.apply(this,arguments);var m=this.config();(c=typeof c!="function"&&c||{}).name||(c.name=c.name||m.name,c.storeName=c.storeName||m.storeName);var _,b=this;if(c.name){var C=c.name===m.name&&b._dbInfo.db?d.resolve(b._dbInfo.db):T(c).then(function(x){var M=l[c.name],R=M.forages;M.db=x;for(var z=0;z<R.length;z++)R[z]._dbInfo.db=x;return x});_=c.storeName?C.then(function(x){if(x.objectStoreNames.contains(c.storeName)){var M=x.version+1;D(c);var R=l[c.name],z=R.forages;x.close();for(var j=0;j<z.length;j++){var B=z[j];B._dbInfo.db=null,B._dbInfo.version=M}var F=new d(function(K,V){var ae=s.open(c.name,M);ae.onerror=function(xe){ae.result.close(),V(xe)},ae.onupgradeneeded=function(){ae.result.deleteObjectStore(c.storeName)},ae.onsuccess=function(){var xe=ae.result;xe.close(),K(xe)}});return F.then(function(K){R.db=K;for(var V=0;V<z.length;V++){var ae=z[V];ae._dbInfo.db=K,P(ae._dbInfo)}}).catch(function(K){throw($(c,K)||d.resolve()).catch(function(){}),K})}}):C.then(function(x){D(c);var M=l[c.name],R=M.forages;x.close();for(var z=0;z<R.length;z++)R[z]._dbInfo.db=null;var j=new d(function(B,F){var K=s.deleteDatabase(c.name);K.onerror=function(){var V=K.result;V&&V.close(),F(K.error)},K.onblocked=function(){},K.onsuccess=function(){var V=K.result;V&&V.close(),B(V)}});return j.then(function(B){M.db=B;for(var F=0;F<R.length;F++)P(R[F]._dbInfo)}).catch(function(B){throw($(c,B)||d.resolve()).catch(function(){}),B})})}else _=d.reject("Invalid arguments");return w(_,p),_}var at={_driver:"asyncStorage",_initStorage:qt,_support:a(),iterate:Ft,getItem:Ut,setItem:rt,removeItem:Xe,clear:Ke,length:ve,key:it,keys:st,dropInstance:Ve};function Ye(){return typeof openDatabase=="function"}var ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ri="~~local_forage_type~",Zn=/^~~local_forage_type~([^~]+)~/,ct="__lfsc__:",Ht=ct.length,Xt="arbf",Kt="blob",eo="si08",to="ui08",no="uic8",oo="si16",ro="si32",io="ur16",so="ui32",ao="fl32",co="fl64",lo=Ht+Xt.length,uo=Object.prototype.toString;function ho(c){var p,m,_,b,C,x=.75*c.length,M=c.length,R=0;c[c.length-1]==="="&&(x--,c[c.length-2]==="="&&x--);var z=new ArrayBuffer(x),j=new Uint8Array(z);for(p=0;p<M;p+=4)m=ye.indexOf(c[p]),_=ye.indexOf(c[p+1]),b=ye.indexOf(c[p+2]),C=ye.indexOf(c[p+3]),j[R++]=m<<2|_>>4,j[R++]=(15&_)<<4|b>>2,j[R++]=(3&b)<<6|63&C;return z}function Vt(c){var p,m=new Uint8Array(c),_="";for(p=0;p<m.length;p+=3)_+=ye[m[p]>>2],_+=ye[(3&m[p])<<4|m[p+1]>>4],_+=ye[(15&m[p+1])<<2|m[p+2]>>6],_+=ye[63&m[p+2]];return m.length%3==2?_=_.substring(0,_.length-1)+"=":m.length%3==1&&(_=_.substring(0,_.length-2)+"=="),_}function ii(c,p){var m="";if(c&&(m=uo.call(c)),c&&(m==="[object ArrayBuffer]"||c.buffer&&uo.call(c.buffer)==="[object ArrayBuffer]")){var _,b=ct;c instanceof ArrayBuffer?(_=c,b+=Xt):(_=c.buffer,m==="[object Int8Array]"?b+=eo:m==="[object Uint8Array]"?b+=to:m==="[object Uint8ClampedArray]"?b+=no:m==="[object Int16Array]"?b+=oo:m==="[object Uint16Array]"?b+=io:m==="[object Int32Array]"?b+=ro:m==="[object Uint32Array]"?b+=so:m==="[object Float32Array]"?b+=ao:m==="[object Float64Array]"?b+=co:p(new Error("Failed to get type for BinaryArray"))),p(b+Vt(_))}else if(m==="[object Blob]"){var C=new FileReader;C.onload=function(){var x=ri+c.type+"~"+Vt(this.result);p(ct+Kt+x)},C.readAsArrayBuffer(c)}else try{p(JSON.stringify(c))}catch(x){p(null,x)}}function si(c){if(c.substring(0,Ht)!==ct)return JSON.parse(c);var p,m=c.substring(lo),_=c.substring(Ht,lo);if(_===Kt&&Zn.test(m)){var b=m.match(Zn);p=b[1],m=m.substring(b[0].length)}var C=ho(m);switch(_){case Xt:return C;case Kt:return u([C],{type:p});case eo:return new Int8Array(C);case to:return new Uint8Array(C);case no:return new Uint8ClampedArray(C);case oo:return new Int16Array(C);case io:return new Uint16Array(C);case ro:return new Int32Array(C);case so:return new Uint32Array(C);case ao:return new Float32Array(C);case co:return new Float64Array(C);default:throw new Error("Unkown type: "+_)}}var Yt={serialize:ii,deserialize:si,stringToBuffer:ho,bufferToString:Vt};function fo(c,p,m,_){c.executeSql("CREATE TABLE IF NOT EXISTS "+p.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],m,_)}function ai(c){var p=this,m={db:null};if(c)for(var _ in c)m[_]=typeof c[_]!="string"?c[_].toString():c[_];var b=new d(function(C,x){try{m.db=openDatabase(m.name,String(m.version),m.description,m.size)}catch(M){return x(M)}m.db.transaction(function(M){fo(M,m,function(){p._dbInfo=m,C()},function(R,z){x(z)})},x)});return m.serializer=Yt,b}function Ee(c,p,m,_,b,C){c.executeSql(m,_,b,function(x,M){M.code===M.SYNTAX_ERR?x.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[p.storeName],function(R,z){z.rows.length?C(R,M):fo(R,p,function(){R.executeSql(m,_,b,C)},C)},C):C(x,M)},C)}function ci(c,p){var m=this;c=I(c);var _=new d(function(b,C){m.ready().then(function(){var x=m._dbInfo;x.db.transaction(function(M){Ee(M,x,"SELECT * FROM "+x.storeName+" WHERE key = ? LIMIT 1",[c],function(R,z){var j=z.rows.length?z.rows.item(0).value:null;j&&(j=x.serializer.deserialize(j)),b(j)},function(R,z){C(z)})})}).catch(C)});return w(_,p),_}function li(c,p){var m=this,_=new d(function(b,C){m.ready().then(function(){var x=m._dbInfo;x.db.transaction(function(M){Ee(M,x,"SELECT * FROM "+x.storeName,[],function(R,z){for(var j=z.rows,B=j.length,F=0;F<B;F++){var K=j.item(F),V=K.value;if(V&&(V=x.serializer.deserialize(V)),(V=c(V,K.key,F+1))!==void 0)return void b(V)}b()},function(R,z){C(z)})})}).catch(C)});return w(_,p),_}function po(c,p,m,_){var b=this;c=I(c);var C=new d(function(x,M){b.ready().then(function(){p===void 0&&(p=null);var R=p,z=b._dbInfo;z.serializer.serialize(p,function(j,B){B?M(B):z.db.transaction(function(F){Ee(F,z,"INSERT OR REPLACE INTO "+z.storeName+" (key, value) VALUES (?, ?)",[c,j],function(){x(R)},function(K,V){M(V)})},function(F){if(F.code===F.QUOTA_ERR){if(_>0)return void x(po.apply(b,[c,R,m,_-1]));M(F)}})})}).catch(M)});return w(C,m),C}function ui(c,p,m){return po.apply(this,[c,p,m,1])}function hi(c,p){var m=this;c=I(c);var _=new d(function(b,C){m.ready().then(function(){var x=m._dbInfo;x.db.transaction(function(M){Ee(M,x,"DELETE FROM "+x.storeName+" WHERE key = ?",[c],function(){b()},function(R,z){C(z)})})}).catch(C)});return w(_,p),_}function di(c){var p=this,m=new d(function(_,b){p.ready().then(function(){var C=p._dbInfo;C.db.transaction(function(x){Ee(x,C,"DELETE FROM "+C.storeName,[],function(){_()},function(M,R){b(R)})})}).catch(b)});return w(m,c),m}function fi(c){var p=this,m=new d(function(_,b){p.ready().then(function(){var C=p._dbInfo;C.db.transaction(function(x){Ee(x,C,"SELECT COUNT(key) as c FROM "+C.storeName,[],function(M,R){var z=R.rows.item(0).c;_(z)},function(M,R){b(R)})})}).catch(b)});return w(m,c),m}function pi(c,p){var m=this,_=new d(function(b,C){m.ready().then(function(){var x=m._dbInfo;x.db.transaction(function(M){Ee(M,x,"SELECT key FROM "+x.storeName+" WHERE id = ? LIMIT 1",[c+1],function(R,z){var j=z.rows.length?z.rows.item(0).key:null;b(j)},function(R,z){C(z)})})}).catch(C)});return w(_,p),_}function gi(c){var p=this,m=new d(function(_,b){p.ready().then(function(){var C=p._dbInfo;C.db.transaction(function(x){Ee(x,C,"SELECT key FROM "+C.storeName,[],function(M,R){for(var z=[],j=0;j<R.rows.length;j++)z.push(R.rows.item(j).key);_(z)},function(M,R){b(R)})})}).catch(b)});return w(m,c),m}function mi(c){return new d(function(p,m){c.transaction(function(_){_.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(b,C){for(var x=[],M=0;M<C.rows.length;M++)x.push(C.rows.item(M).name);p({db:c,storeNames:x})},function(b,C){m(C)})},function(_){m(_)})})}function vi(c,p){p=N.apply(this,arguments);var m=this.config();(c=typeof c!="function"&&c||{}).name||(c.name=c.name||m.name,c.storeName=c.storeName||m.storeName);var _,b=this;return _=c.name?new d(function(C){var x;x=c.name===m.name?b._dbInfo.db:openDatabase(c.name,"","",0),c.storeName?C({db:x,storeNames:[c.storeName]}):C(mi(x))}).then(function(C){return new d(function(x,M){C.db.transaction(function(R){function z(K){return new d(function(V,ae){R.executeSql("DROP TABLE IF EXISTS "+K,[],function(){V()},function(xe,Qt){ae(Qt)})})}for(var j=[],B=0,F=C.storeNames.length;B<F;B++)j.push(z(C.storeNames[B]));d.all(j).then(function(){x()}).catch(function(K){M(K)})},function(R){M(R)})})}):d.reject("Invalid arguments"),w(_,p),_}var yi={_driver:"webSQLStorage",_initStorage:ai,_support:Ye(),iterate:li,getItem:ci,setItem:ui,removeItem:hi,clear:di,length:fi,key:pi,keys:gi,dropInstance:vi};function wi(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function go(c,p){var m=c.name+"/";return c.storeName!==p.storeName&&(m+=c.storeName+"/"),m}function bi(){var c="_localforage_support_test";try{return localStorage.setItem(c,!0),localStorage.removeItem(c),!1}catch{return!0}}function _i(){return!bi()||localStorage.length>0}function Si(c){var p=this,m={};if(c)for(var _ in c)m[_]=c[_];return m.keyPrefix=go(c,p._defaultConfig),_i()?(p._dbInfo=m,m.serializer=Yt,d.resolve()):d.reject()}function Ci(c){var p=this,m=p.ready().then(function(){for(var _=p._dbInfo.keyPrefix,b=localStorage.length-1;b>=0;b--){var C=localStorage.key(b);C.indexOf(_)===0&&localStorage.removeItem(C)}});return w(m,c),m}function xi(c,p){var m=this;c=I(c);var _=m.ready().then(function(){var b=m._dbInfo,C=localStorage.getItem(b.keyPrefix+c);return C&&(C=b.serializer.deserialize(C)),C});return w(_,p),_}function Ei(c,p){var m=this,_=m.ready().then(function(){for(var b=m._dbInfo,C=b.keyPrefix,x=C.length,M=localStorage.length,R=1,z=0;z<M;z++){var j=localStorage.key(z);if(j.indexOf(C)===0){var B=localStorage.getItem(j);if(B&&(B=b.serializer.deserialize(B)),(B=c(B,j.substring(x),R++))!==void 0)return B}}});return w(_,p),_}function ki(c,p){var m=this,_=m.ready().then(function(){var b,C=m._dbInfo;try{b=localStorage.key(c)}catch{b=null}return b&&(b=b.substring(C.keyPrefix.length)),b});return w(_,p),_}function Ii(c){var p=this,m=p.ready().then(function(){for(var _=p._dbInfo,b=localStorage.length,C=[],x=0;x<b;x++){var M=localStorage.key(x);M.indexOf(_.keyPrefix)===0&&C.push(M.substring(_.keyPrefix.length))}return C});return w(m,c),m}function Ti(c){var p=this.keys().then(function(m){return m.length});return w(p,c),p}function Mi(c,p){var m=this;c=I(c);var _=m.ready().then(function(){var b=m._dbInfo;localStorage.removeItem(b.keyPrefix+c)});return w(_,p),_}function Ri(c,p,m){var _=this;c=I(c);var b=_.ready().then(function(){p===void 0&&(p=null);var C=p;return new d(function(x,M){var R=_._dbInfo;R.serializer.serialize(p,function(z,j){if(j)M(j);else try{localStorage.setItem(R.keyPrefix+c,z),x(C)}catch(B){B.name!=="QuotaExceededError"&&B.name!=="NS_ERROR_DOM_QUOTA_REACHED"||M(B),M(B)}})})});return w(b,m),b}function Pi(c,p){if(p=N.apply(this,arguments),!(c=typeof c!="function"&&c||{}).name){var m=this.config();c.name=c.name||m.name,c.storeName=c.storeName||m.storeName}var _,b=this;return _=c.name?new d(function(C){c.storeName?C(go(c,b._defaultConfig)):C(c.name+"/")}).then(function(C){for(var x=localStorage.length-1;x>=0;x--){var M=localStorage.key(x);M.indexOf(C)===0&&localStorage.removeItem(M)}}):d.reject("Invalid arguments"),w(_,p),_}var Li={_driver:"localStorageWrapper",_initStorage:Si,_support:wi(),iterate:Ei,getItem:xi,setItem:Ri,removeItem:Mi,clear:Ci,length:Ti,key:ki,keys:Ii,dropInstance:Pi},zi=function(c,p){return c===p||typeof c=="number"&&typeof p=="number"&&isNaN(c)&&isNaN(p)},Ai=function(c,p){for(var m=c.length,_=0;_<m;){if(zi(c[_],p))return!0;_++}return!1},mo=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"},Je={},vo={},je={INDEXEDDB:at,WEBSQL:yi,LOCALSTORAGE:Li},Di=[je.INDEXEDDB._driver,je.WEBSQL._driver,je.LOCALSTORAGE._driver],lt=["dropInstance"],Jt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(lt),Ni={description:"",driver:Di.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function $i(c,p){c[p]=function(){var m=arguments;return c.ready().then(function(){return c[p].apply(c,m)})}}function Gt(){for(var c=1;c<arguments.length;c++){var p=arguments[c];if(p)for(var m in p)p.hasOwnProperty(m)&&(mo(p[m])?arguments[0][m]=p[m].slice():arguments[0][m]=p[m])}return arguments[0]}var ji=function(){function c(p){for(var m in r(this,c),je)if(je.hasOwnProperty(m)){var _=je[m],b=_._driver;this[m]=b,Je[b]||this.defineDriver(_)}this._defaultConfig=Gt({},Ni),this._config=Gt({},this._defaultConfig,p),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return c.prototype.config=function(p){if((p===void 0?"undefined":o(p))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var m in p){if(m==="storeName"&&(p[m]=p[m].replace(/\W/g,"_")),m==="version"&&typeof p[m]!="number")return new Error("Database version must be a number.");this._config[m]=p[m]}return!("driver"in p)||!p.driver||this.setDriver(this._config.driver)}return typeof p=="string"?this._config[p]:this._config},c.prototype.defineDriver=function(p,m,_){var b=new d(function(C,x){try{var M=p._driver,R=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!p._driver)return void x(R);for(var z=Jt.concat("_initStorage"),j=0,B=z.length;j<B;j++){var F=z[j];if((!Ai(lt,F)||p[F])&&typeof p[F]!="function")return void x(R)}var K=function(){for(var ae=function(Wi){return function(){var Bi=new Error("Method "+Wi+" is not implemented by the current driver"),yo=d.reject(Bi);return w(yo,arguments[arguments.length-1]),yo}},xe=0,Qt=lt.length;xe<Qt;xe++){var Zt=lt[xe];p[Zt]||(p[Zt]=ae(Zt))}};K();var V=function(ae){Je[M],Je[M]=p,vo[M]=ae,C()};"_support"in p?p._support&&typeof p._support=="function"?p._support().then(V,x):V(!!p._support):V(!0)}catch(ae){x(ae)}});return S(b,m,_),b},c.prototype.driver=function(){return this._driver||null},c.prototype.getDriver=function(p,m,_){var b=Je[p]?d.resolve(Je[p]):d.reject(new Error("Driver not found."));return S(b,m,_),b},c.prototype.getSerializer=function(p){var m=d.resolve(Yt);return S(m,p),m},c.prototype.ready=function(p){var m=this,_=m._driverSet.then(function(){return m._ready===null&&(m._ready=m._initDriver()),m._ready});return S(_,p,p),_},c.prototype.setDriver=function(p,m,_){var b=this;mo(p)||(p=[p]);var C=this._getSupportedDrivers(p);function x(){b._config.driver=b.driver()}function M(j){return b._extend(j),x(),b._ready=b._initStorage(b._config),b._ready}function R(j){return function(){var B=0;function F(){for(;B<j.length;){var K=j[B];return B++,b._dbInfo=null,b._ready=null,b.getDriver(K).then(M).catch(F)}x();var V=new Error("No available storage method found.");return b._driverSet=d.reject(V),b._driverSet}return F()}}var z=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=z.then(function(){var j=C[0];return b._dbInfo=null,b._ready=null,b.getDriver(j).then(function(B){b._driver=B._driver,x(),b._wrapLibraryMethodsWithReady(),b._initDriver=R(C)})}).catch(function(){x();var j=new Error("No available storage method found.");return b._driverSet=d.reject(j),b._driverSet}),S(this._driverSet,m,_),this._driverSet},c.prototype.supports=function(p){return!!vo[p]},c.prototype._extend=function(p){Gt(this,p)},c.prototype._getSupportedDrivers=function(p){for(var m=[],_=0,b=p.length;_<b;_++){var C=p[_];this.supports(C)&&m.push(C)}return m},c.prototype._wrapLibraryMethodsWithReady=function(){for(var p=0,m=Jt.length;p<m;p++)$i(this,Jt[p])},c.prototype.createInstance=function(p){return new c(p)},c}(),Oi=new ji;e.exports=Oi},{3:3}]},{},[4])(4));jt(ws);var Uo={exports:{}},bs=(qo||(qo=1,function(n){((e,t)=>{n.exports=t()})(0,()=>{const e=typeof window=="object"?window:this;e.HTMLElement;let t=null,o=!1;const r=e.WebStreamsPolyfill||{},i=e.isSecureContext;let s=/constructor/i.test(e.HTMLElement)||!!e.safari||!!e.WebKitPoint;const a=i||"MozAppearance"in document.documentElement.style?"iframe":"navigate",u={createWriteStream:function(w,S,I){let N={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},k=0,g=null,l=null,v=null;if(Number.isFinite(S)?([I,S]=[S,I],N.size=I,N.writableStrategy=S):S&&S.highWaterMark?(N.size=I,N.writableStrategy=S):N=S||{},!s){t||(t=i?d(u.mitm):function(L){const A="width=200,height=100",D=document.createDocumentFragment(),P={frame:e.open(L,"popup",A),loaded:!1,isIframe:!1,isPopup:!0,remove(){P.frame.close()},addEventListener(...O){D.addEventListener(...O)},dispatchEvent(...O){D.dispatchEvent(...O)},removeEventListener(...O){D.removeEventListener(...O)},postMessage(...O){P.frame.postMessage(...O)}},$=O=>{O.source===P.frame&&(P.loaded=!0,e.removeEventListener("message",$),P.dispatchEvent(new Event("load")))};return e.addEventListener("message",$),P}(u.mitm)),l=new MessageChannel,w=encodeURIComponent(w.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const h={transferringReadable:o,pathname:N.pathname||Math.random().toString().slice(-6)+"/"+w,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+w}};N.size&&(h.headers["Content-Length"]=N.size);const f=[h,"*",[l.port2]];if(o){const L=a==="iframe"?void 0:{transform(D,P){if(!(D instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");k+=D.length,P.enqueue(D),g&&(location.href=g,g=null)},flush(){g&&(location.href=g)}};v=new u.TransformStream(L,N.writableStrategy,N.readableStrategy);const A=v.readable;l.port1.postMessage({readableStream:A},[A])}l.port1.onmessage=L=>{L.data.download?a==="navigate"?(t.remove(),t=null,k?location.href=L.data.download:g=L.data.download):(t.isPopup&&(t.remove(),t=null,a==="iframe"&&d(u.mitm)),d(L.data.download)):L.data.abort&&(y=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null)},t.loaded?t.postMessage(...f):t.addEventListener("load",()=>{t.postMessage(...f)},{once:!0})}let y=[];return!s&&v&&v.writable||new u.WritableStream({write(h){if(!(h instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");s?y.push(h):(l.port1.postMessage(h),k+=h.length,g&&(location.href=g,g=null))},close(){if(s){const h=new Blob(y,{type:"application/octet-stream; charset=utf-8"}),f=document.createElement("a");f.href=URL.createObjectURL(h),f.download=w,f.click()}else l.port1.postMessage("end")},abort(){y=[],l.port1.postMessage("abort"),l.port1.onmessage=null,l.port1.close(),l.port2.close(),l=null}},N.writableStrategy)},WritableStream:e.WritableStream||r.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function d(w){if(!w)throw new Error("meh");const S=document.createElement("iframe");return S.hidden=!0,S.src=w,S.loaded=!1,S.name="iframe",S.isIframe=!0,S.postMessage=(...I)=>S.contentWindow.postMessage(...I),S.addEventListener("load",()=>{S.loaded=!0},{once:!0}),document.body.appendChild(S),S}try{new Response(new ReadableStream),i&&!("serviceWorker"in navigator)&&(s=!0)}catch{s=!0}return(w=>{try{w()}catch{}})(()=>{const{readable:w}=new TransformStream,S=new MessageChannel;S.port1.postMessage(w,[w]),S.port1.close(),S.port2.close(),o=!0,Object.defineProperty(u,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})}),u})}(Uo)),Uo.exports);jt(bs);function _s(n={},e={}){let t;for(t in e)Un(e[t])?n[t]=_s(n[t],e[t]):n[t]=e[t];return n}function Ss(n,e){const t=`${n}_${e}`;return de.MD5(t)}function Cs(n){const e=function(a){if(!a)return;const u=a,d=[];if(u)for(let w of u){const S=Ar(w);S&&d.push(S)}return d}(n.bussinessRoutes),t=function(a){if(!a)return;const u=a;if(u&&u.length>0){const d=[];return u.forEach(w=>{const S=Dr(w);S&&d.push(S)}),d}}(n.widgetMenuConfig),o=function(a){if(a&&a.length>0){const u=[];return a.forEach(d=>{const w=function(S){return S?{id:S.id,label:S.label,container:S.container,preload:S.preload,afterid:S.afterid,bindid:S.bindid,group:S.group}:void 0}(d);w&&u.push(w)}),u}}(n.widgetConfig),r=function(a){if(a&&a.length>0)return a}(n.functionList),i=n.pkgObject.version,s=n.pkgObject.name;return{id:Ss(s,i),name:W.Config.UI.SiteTitle,group:W.Config.UI.Group,product:s,version:i,routes:e,widgetMenu:t,widgets:o,functions:r}}function Ar(n){if(n){let e=0;n.meta?.hidden&&(e=1);let t={path:n.path,name:n.name,title:n.meta?.title,type:e,index:n.meta?.index};if(n.children){const o=[];for(let r of n.children){const i=Ar(r);i&&o.push(i)}o.length>0&&(t.children=o)}return t}}function Dr(n){if(!n)return;const e={name:n.name,index:n.index,path:n.path,type:n.type};return n.children&&n.children.length>0&&(e.children=[],n.children.forEach(t=>{const o=Dr(t);o&&e.children?.push(o)})),e}function Za(n,e){const t=Cs(n);hs(t,e),W.Message?.msg("导出系统功能权限文件成功！")}let Nr=!0;try{String.fromCharCode.apply(String,[1,2])}catch{Nr=!1,Object.defineProperty(Array.prototype,"subarray",{value:Array.prototype.slice})}var En=2654435769;function $r(n,e){var t=n.length,o=t<<2;if(e){var r=n[t-1];if(r<(o-=4)-3||r>o)return null;o=r}for(var i=new Uint8Array(o),s=0;s<o;++s)i[s]=n[s>>2]>>((3&s)<<3);return i}function Tt(n,e){var t,o=n.length,r=o>>2;3&o&&++r,e?(t=new Uint32Array(r+1))[r]=o:t=new Uint32Array(r);for(var i=0;i<o;++i)t[i>>2]|=n[i]<<((3&i)<<3);return t}function Pe(n){return 4294967295&n}function Mt(n,e,t,o,r,i){return(t>>>5^e<<2)+(e>>>3^t<<4)^(n^e)+(i[3&o^r]^t)}function jr(n){if(n.length<16){var e=new Uint8Array(16);e.set(n),n=e}return n}function Rt(n){for(var e=n.length,t=new Uint8Array(3*e),o=0,r=0;r<e;r++){var i=n.charCodeAt(r);if(i<128)t[o++]=i;else if(i<2048)t[o++]=192|i>>6,t[o++]=128|63&i;else{if(!(i<55296||i>57343)){if(r+1<e){var s=n.charCodeAt(r+1);if(i<56320&&56320<=s&&s<=57343){var a=65536+((1023&i)<<10|1023&s);t[o++]=240|a>>18,t[o++]=128|a>>12&63,t[o++]=128|a>>6&63,t[o++]=128|63&a,r++;continue}}throw new Error("Malformed string")}t[o++]=224|i>>12,t[o++]=128|i>>6&63,t[o++]=128|63&i}}return t.subarray(0,o)}function Fo(n){var e=n.length;return e===0?"":e<32767?function(t,o){for(var r=new Array(o),i=0,s=0,a=t.length;i<o&&s<a;i++){var u=t[s++];switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[i]=u;break;case 12:case 13:if(!(s<a))throw new Error("Unfinished UTF-8 octet sequence");r[i]=(31&u)<<6|63&t[s++];break;case 14:if(!(s+1<a))throw new Error("Unfinished UTF-8 octet sequence");r[i]=(15&u)<<12|(63&t[s++])<<6|63&t[s++];break;case 15:if(!(s+2<a))throw new Error("Unfinished UTF-8 octet sequence");var d=((7&u)<<18|(63&t[s++])<<12|(63&t[s++])<<6|63&t[s++])-65536;if(!(0<=d&&d<=1048575))throw new Error("Character outside valid Unicode range: 0x"+d.toString(16));r[i++]=d>>10&1023|55296,r[i]=1023&d|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+u.toString(16))}}return i<o&&(r.length=i),String.fromCharCode.apply(String,r)}(n,e):function(t,o){for(var r=[],i=new Array(32768),s=0,a=0,u=t.length;s<o&&a<u;s++){var d=t[a++];switch(d>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i[s]=d;break;case 12:case 13:if(!(a<u))throw new Error("Unfinished UTF-8 octet sequence");i[s]=(31&d)<<6|63&t[a++];break;case 14:if(!(a+1<u))throw new Error("Unfinished UTF-8 octet sequence");i[s]=(15&d)<<12|(63&t[a++])<<6|63&t[a++];break;case 15:if(!(a+2<u))throw new Error("Unfinished UTF-8 octet sequence");var w=((7&d)<<18|(63&t[a++])<<12|(63&t[a++])<<6|63&t[a++])-65536;if(!(0<=w&&w<=1048575))throw new Error("Character outside valid Unicode range: 0x"+w.toString(16));i[s++]=w>>10&1023|55296,i[s]=1023&w|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+d.toString(16))}if(s>=32766){var S=s+1;i.length=S,r.push(String.fromCharCode.apply(String,i)),o-=S,s=-1}}return s>0&&(i.length=s,r.push(String.fromCharCode.apply(String,i))),r.join("")}(n,e)}function xs(n){var e=n.length;if(e===0)return"";var t=Nr?n:function(a){for(var u=a.length,d=new Array(a.length),w=0;w<u;++w)d[w]=a[w];return d}(n);if(e<65535)return String.fromCharCode.apply(String,t);for(var o=32767&e,r=e>>15,i=new Array(o?r+1:r),s=0;s<r;++s)i[s]=String.fromCharCode.apply(String,t.subarray(s<<15,s+1<<15));return o&&(i[r]=String.fromCharCode.apply(String,t.subarray(r<<15,e))),i.join("")}function Ho(n,e){return typeof n=="string"&&(n=Rt(n)),typeof e=="string"&&(e=Rt(e)),n==null||n.length===0?n:$r(function(t,o){var r,i,s,a,u,d,w=t.length,S=w-1;for(i=t[S],s=0,d=0|Math.floor(6+52/w);d>0;--d){for(a=(s=Pe(s+En))>>>2&3,u=0;u<S;++u)r=t[u+1],i=t[u]=Pe(t[u]+Mt(s,r,i,u,a,o));r=t[0],i=t[S]=Pe(t[S]+Mt(s,r,i,S,a,o))}return t}(Tt(n,!0),Tt(jr(e),!1)),!1)}function Xo(n,e){return typeof n=="string"&&(n=function(t){for(var o=window.atob(t),r=o.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=o.charCodeAt(s);return i}(n)),typeof e=="string"&&(e=Rt(e)),n==null||n.length===0?n:$r(function(t,o){var r,i,s,a,u,d=t.length,w=d-1;for(r=t[0],s=Pe(Math.floor(6+52/d)*En);s!==0;s=Pe(s-En)){for(a=s>>>2&3,u=w;u>0;--u)i=t[u-1],r=t[u]=Pe(t[u]-Mt(s,r,i,u,a,o));i=t[w],r=t[0]=Pe(t[0]-Mt(s,r,i,0,a,o))}return t}(Tt(n,!1),Tt(jr(e),!1)),!0)}const kn={toBytes:Rt,toString:Fo,encrypt:Ho,encryptToString:function(n,e){return window.btoa(xs(Ho(n,e)))},decrypt:Xo,decryptToString:function(n,e){return Fo(Xo(n,e))}};class Le extends Error{constructor(e,t){const o=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=o}}class Fn extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class we extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Es extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=o}}class ks extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=o}}class Is extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=o}}class Ko extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class Ts extends Error{constructor(e,t){const o=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=o}}class Or{constructor(e,t,o){this.statusCode=e,this.statusText=t,this.content=o}}class Ot{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var E;(function(n){n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None"})(E||(E={}));class tt{constructor(){}log(e,t){}}tt.instance=new tt;class oe{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,o){if(!(e in t))throw new Error(`Unknown ${o} value: ${e}.`)}}class ee{static get isBrowser(){return!ee.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!ee.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!ee.isNode&&typeof window=="object"&&window.document===void 0}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function nt(n,e){let t="";return Ne(n)?(t=`Binary data of length ${n.byteLength}`,e&&(t+=`. Content: '${function(o){const r=new Uint8Array(o);let i="";return r.forEach(s=>{i+=`0x${s<16?"0":""}${s.toString(16)} `}),i.substr(0,i.length-1)}(n)}'`)):typeof n=="string"&&(t=`String data of length ${n.length}`,e&&(t+=`. Content: '${n}'`)),t}function Ne(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}async function Wr(n,e,t,o,r,i){const s={},[a,u]=Ue();s[a]=u,n.log(E.Trace,`(${e} transport) sending data. ${nt(r,i.logMessageContent)}.`);const d=Ne(r)?"arraybuffer":"text",w=await t.post(o,{content:r,headers:{...s,...i.headers},responseType:d,timeout:i.timeout,withCredentials:i.withCredentials});n.log(E.Trace,`(${e} transport) request complete. Response status: ${w.statusCode}.`)}class Ms{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class Pt{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const o=`[${new Date().toISOString()}] ${E[e]}: ${t}`;switch(e){case E.Critical:case E.Error:this.out.error(o);break;case E.Warning:this.out.warn(o);break;case E.Information:this.out.info(o);break;default:this.out.log(o)}}}}function Ue(){let n="X-SignalR-User-Agent";return ee.isNode&&(n="User-Agent"),[n,Rs("8.0.7",Ps(),zs(),Ls())]}function Rs(n,e,t,o){let r="Microsoft SignalR/";const i=n.split(".");return r+=`${i[0]}.${i[1]}`,r+=` (${n}; `,r+=e&&e!==""?`${e}; `:"Unknown OS; ",r+=`${t}`,r+=o?`; ${o}`:"; Unknown Runtime Version",r+=")",r}function Ps(){if(!ee.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function Ls(){if(ee.isNode)return process.versions.node}function zs(){return ee.isNode?"NodeJS":"Browser"}function pn(n){return n.stack?n.stack:n.message?n.message:`${n}`}class As extends Ot{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||ee.isNode){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new we;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let o;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),o=new we});let r,i=null;if(e.timeout){const u=e.timeout;i=setTimeout(()=>{t.abort(),this._logger.log(E.Warning,"Timeout from HTTP request."),o=new Fn},u)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},Ne(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{r=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(u){throw o||(this._logger.log(E.Warning,`Error from HTTP request. ${u}.`),u)}finally{i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null)}if(!r.ok){const u=await Vo(r,"text");throw new Le(u||r.statusText,r.status)}const s=Vo(r,e.responseType),a=await s;return new Or(r.status,r.statusText,a)}getCookieString(e){let t="";return ee.isNode&&this._jar&&this._jar.getCookies(e,(o,r)=>t=r.join("; ")),t}}function Vo(n,e){let t;switch(e){case"arraybuffer":t=n.arrayBuffer();break;case"text":default:t=n.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return t}class Ds extends Ot{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new we):e.method?e.url?new Promise((t,o)=>{const r=new XMLHttpRequest;r.open(e.method,e.url,!0),r.withCredentials=e.withCredentials===void 0||e.withCredentials,r.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(Ne(e.content)?r.setRequestHeader("Content-Type","application/octet-stream"):r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const i=e.headers;i&&Object.keys(i).forEach(s=>{r.setRequestHeader(s,i[s])}),e.responseType&&(r.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{r.abort(),o(new we)}),e.timeout&&(r.timeout=e.timeout),r.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),r.status>=200&&r.status<300?t(new Or(r.status,r.statusText,r.response||r.responseText)):o(new Le(r.response||r.responseText||r.statusText,r.status))},r.onerror=()=>{this._logger.log(E.Warning,`Error from HTTP request. ${r.status}: ${r.statusText}.`),o(new Le(r.statusText,r.status))},r.ontimeout=()=>{this._logger.log(E.Warning,"Timeout from HTTP request."),o(new Fn)},r.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Ns extends Ot{constructor(e){if(super(),typeof fetch<"u"||ee.isNode)this._httpClient=new As(e);else{if(typeof XMLHttpRequest>"u")throw new Error("No usable HttpClient found.");this._httpClient=new Ds(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new we):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class ge{static write(e){return`${e}${ge.RecordSeparator}`}static parse(e){if(e[e.length-1]!==ge.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(ge.RecordSeparator);return t.pop(),t}}ge.RecordSeparatorCode=30,ge.RecordSeparator=String.fromCharCode(ge.RecordSeparatorCode);class $s{writeHandshakeRequest(e){return ge.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,o;if(Ne(e)){const s=new Uint8Array(e),a=s.indexOf(ge.RecordSeparatorCode);if(a===-1)throw new Error("Message is incomplete.");const u=a+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(s.slice(0,u))),o=s.byteLength>u?s.slice(u).buffer:null}else{const s=e,a=s.indexOf(ge.RecordSeparator);if(a===-1)throw new Error("Message is incomplete.");const u=a+1;t=s.substring(0,u),o=s.length>u?s.substring(u):null}const r=ge.parse(t),i=JSON.parse(r[0]);if(i.type)throw new Error("Expected a handshake response from the server.");return[o,i]}}var U;(function(n){n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close",n[n.Ack=8]="Ack",n[n.Sequence=9]="Sequence"})(U||(U={}));class js{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Ms(this,e)}}class Os{constructor(e,t,o){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=o}async _send(e){const t=this._protocol.writeMessage(e);let o=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let r=()=>{},i=()=>{};Ne(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(o=new Promise((s,a)=>{r=s,i=a})),this._messages.push(new Ws(t,this._totalMessageCount,r,i))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await o}_ack(e){let t=-1;for(let o=0;o<this._messages.length;o++){const r=this._messages[o];if(r._id<=e.sequenceId)t=o,Ne(r._message)?this._bufferedByteCount-=r._message.byteLength:this._bufferedByteCount-=r._message.length,r._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;r._resolver()}}t!==-1&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type===U.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){e.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:U.Sequence,sequenceId:e}));const t=this._messages;for(const o of t)await this._connection.send(o._message);this._reconnectInProgress=!1}_dispose(e){e!=null||(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case U.Invocation:case U.StreamItem:case U.Completion:case U.StreamInvocation:case U.CancelInvocation:return!0;case U.Close:case U.Sequence:case U.Ping:case U.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:U.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class Ws{constructor(e,t,o,r){this._message=e,this._id=t,this._resolver=o,this._rejector=r}}var J;(function(n){n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting"})(J||(J={}));class Hn{static create(e,t,o,r,i,s,a){return new Hn(e,t,o,r,i,s,a)}constructor(e,t,o,r,i,s,a){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(E.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},oe.isRequired(e,"connection"),oe.isRequired(t,"logger"),oe.isRequired(o,"protocol"),this.serverTimeoutInMilliseconds=i??3e4,this.keepAliveIntervalInMilliseconds=s??15e3,this._statefulReconnectBufferSize=a??1e5,this._logger=t,this._protocol=o,this.connection=e,this._reconnectPolicy=r,this._handshakeProtocol=new $s,this.connection.onreceive=u=>this._processIncomingData(u),this.connection.onclose=u=>this._connectionClosed(u),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=J.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:U.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==J.Disconnected&&this._connectionState!==J.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==J.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=J.Connecting,this._logger.log(E.Debug,"Starting HubConnection.");try{await this._startInternal(),ee.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=J.Connected,this._connectionStarted=!0,this._logger.log(E.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=J.Disconnected,this._logger.log(E.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,o)=>{this._handshakeResolver=t,this._handshakeRejecter=o});await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const o={protocol:this._protocol.name,version:t};if(this._logger.log(E.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(o)),this._logger.log(E.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;this.connection.features.reconnect&&(this._messageBuffer=new Os(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(t){throw this._logger.log(E.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){if(this._connectionState===J.Disconnected)return this._logger.log(E.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===J.Disconnecting)return this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=J.Disconnecting,this._logger.log(E.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(E.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===J.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new we("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[o,r]=this._replaceStreamingParams(t),i=this._createStreamInvocation(e,t,r);let s;const a=new js;return a.cancelCallback=()=>{const u=this._createCancelInvocation(i.invocationId);return delete this._callbacks[i.invocationId],s.then(()=>this._sendWithProtocol(u))},this._callbacks[i.invocationId]=(u,d)=>{d?a.error(d):u&&(u.type===U.Completion?u.error?a.error(new Error(u.error)):a.complete():a.next(u.item))},s=this._sendWithProtocol(i).catch(u=>{a.error(u),delete this._callbacks[i.invocationId]}),this._launchStreams(o,s),a}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[o,r]=this._replaceStreamingParams(t),i=this._sendWithProtocol(this._createInvocation(e,t,!0,r));return this._launchStreams(o,i),i}invoke(e,...t){const[o,r]=this._replaceStreamingParams(t),i=this._createInvocation(e,t,!1,r);return new Promise((s,a)=>{this._callbacks[i.invocationId]=(d,w)=>{w?a(w):d&&(d.type===U.Completion?d.error?a(new Error(d.error)):s(d.result):a(new Error(`Unexpected message type: ${d.type}`)))};const u=this._sendWithProtocol(i).catch(d=>{a(d),delete this._callbacks[i.invocationId]});this._launchStreams(o,u)})}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const o=this._methods[e];if(o)if(t){const r=o.indexOf(t);r!==-1&&(o.splice(r,1),o.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const o of t)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(o))switch(o.type){case U.Invocation:this._invokeClientMethod(o).catch(r=>{this._logger.log(E.Error,`Invoke client method threw error: ${pn(r)}`)});break;case U.StreamItem:case U.Completion:{const r=this._callbacks[o.invocationId];if(r){o.type===U.Completion&&delete this._callbacks[o.invocationId];try{r(o)}catch(i){this._logger.log(E.Error,`Stream callback threw error: ${pn(i)}`)}}break}case U.Ping:break;case U.Close:{this._logger.log(E.Information,"Close message received from server.");const r=o.error?new Error("Server returned an error on close: "+o.error):void 0;o.allowReconnect===!0?this.connection.stop(r):this._stopPromise=this._stopInternal(r);break}case U.Ack:this._messageBuffer&&this._messageBuffer._ack(o);break;case U.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(o);break;default:this._logger.log(E.Warning,`Invalid message type: ${o.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,o;try{[o,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(r){const i="Error parsing handshake response: "+r;this._logger.log(E.Error,i);const s=new Error(i);throw this._handshakeRejecter(s),s}if(t.error){const r="Server returned handshake error: "+t.error;this._logger.log(E.Error,r);const i=new Error(r);throw this._handshakeRejecter(i),i}return this._logger.log(E.Debug,"Server handshake complete."),this._handshakeResolver(),o}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle!==void 0))){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===J.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),o=this._methods[t];if(!o)return this._logger.log(E.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(E.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const r=o.slice(),i=!!e.invocationId;let s,a,u;for(const d of r)try{const w=s;s=await d.apply(this,e.arguments),i&&s&&w&&(this._logger.log(E.Error,`Multiple results provided for '${t}'. Sending error to server.`),u=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),a=void 0}catch(w){a=w,this._logger.log(E.Error,`A callback for the method '${t}' threw error '${w}'.`)}u?await this._sendWithProtocol(u):i?(a?u=this._createCompletionMessage(e.invocationId,`${a}`,null):s!==void 0?u=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(E.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),u=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(u)):s&&this._logger.log(E.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(E.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new we("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===J.Disconnecting?this._completeClose(e):this._connectionState===J.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===J.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=J.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),ee.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(E.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let o=0,r=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),i=this._getNextRetryDelay(o++,0,r);if(i===null)return this._logger.log(E.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=J.Reconnecting,e?this._logger.log(E.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(E.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(s=>s.apply(this,[e]))}catch(s){this._logger.log(E.Error,`An onreconnecting callback called with error '${e}' threw error '${s}'.`)}if(this._connectionState!==J.Reconnecting)return void this._logger.log(E.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;i!==null;){if(this._logger.log(E.Information,`Reconnect attempt number ${o} will start in ${i} ms.`),await new Promise(s=>{this._reconnectDelayHandle=setTimeout(s,i)}),this._reconnectDelayHandle=void 0,this._connectionState!==J.Reconnecting)return void this._logger.log(E.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=J.Connected,this._logger.log(E.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(s=>s.apply(this,[this.connection.connectionId]))}catch(s){this._logger.log(E.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${s}'.`)}return}catch(s){if(this._logger.log(E.Information,`Reconnect attempt failed because of error '${s}'.`),this._connectionState!==J.Reconnecting)return this._logger.log(E.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===J.Disconnecting&&this._completeClose());r=s instanceof Error?s:new Error(s.toString()),i=this._getNextRetryDelay(o++,Date.now()-t,r)}}this._logger.log(E.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${o} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,o){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:o})}catch(r){return this._logger.log(E.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${r}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(o=>{const r=t[o];try{r(null,e)}catch(i){this._logger.log(E.Error,`Stream 'error' callback called with '${e}' threw error: ${pn(i)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,o,r){if(o)return r.length!==0?{arguments:t,streamIds:r,target:e,type:U.Invocation}:{arguments:t,target:e,type:U.Invocation};{const i=this._invocationId;return this._invocationId++,r.length!==0?{arguments:t,invocationId:i.toString(),streamIds:r,target:e,type:U.Invocation}:{arguments:t,invocationId:i.toString(),target:e,type:U.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const o in e)e[o].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(o)))},error:r=>{let i;i=r instanceof Error?r.message:r&&r.toString?r.toString():"Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(o,i)))},next:r=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(o,r)))}})}}_replaceStreamingParams(e){const t=[],o=[];for(let r=0;r<e.length;r++){const i=e[r];if(this._isObservable(i)){const s=this._invocationId;this._invocationId++,t[s]=i,o.push(s.toString()),e.splice(r,1)}}return[t,o]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,o){const r=this._invocationId;return this._invocationId++,o.length!==0?{arguments:t,invocationId:r.toString(),streamIds:o,target:e,type:U.StreamInvocation}:{arguments:t,invocationId:r.toString(),target:e,type:U.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:U.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:U.StreamItem}}_createCompletionMessage(e,t,o){return t?{error:t,invocationId:e,type:U.Completion}:{invocationId:e,result:o,type:U.Completion}}_createCloseMessage(){return{type:U.Close}}}const Bs=[0,2e3,1e4,3e4,null];class Yo{constructor(e){this._retryDelays=e!==void 0?[...e,null]:Bs}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class ze{}ze.Authorization="Authorization",ze.Cookie="Cookie";class qs extends Ot{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const o=await this._innerClient.send(e);return t&&o.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):o}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[ze.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[ze.Authorization]&&delete e.headers[ze.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var re,le;(function(n){n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling"})(re||(re={})),function(n){n[n.Text=1]="Text",n[n.Binary=2]="Binary"}(le||(le={}));class Us{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class Jo{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,o){this._httpClient=e,this._logger=t,this._pollAbort=new Us,this._options=o,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(oe.isRequired(e,"url"),oe.isRequired(t,"transferFormat"),oe.isIn(t,le,"transferFormat"),this._url=e,this._logger.log(E.Trace,"(LongPolling transport) Connecting."),t===le.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[o,r]=Ue(),i={[o]:r,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:i,timeout:1e5,withCredentials:this._options.withCredentials};t===le.Binary&&(s.responseType="arraybuffer");const a=`${e}&_=${Date.now()}`;this._logger.log(E.Trace,`(LongPolling transport) polling: ${a}.`);const u=await this._httpClient.get(a,s);u.statusCode!==200?(this._logger.log(E.Error,`(LongPolling transport) Unexpected response code: ${u.statusCode}.`),this._closeError=new Le(u.statusText||"",u.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const o=`${e}&_=${Date.now()}`;this._logger.log(E.Trace,`(LongPolling transport) polling: ${o}.`);const r=await this._httpClient.get(o,t);r.statusCode===204?(this._logger.log(E.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):r.statusCode!==200?(this._logger.log(E.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this._closeError=new Le(r.statusText||"",r.statusCode),this._running=!1):r.content?(this._logger.log(E.Trace,`(LongPolling transport) data received. ${nt(r.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this._logger.log(E.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(o){this._running?o instanceof Fn?this._logger.log(E.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=o,this._running=!1):this._logger.log(E.Trace,`(LongPolling transport) Poll errored after shutdown: ${o.message}`)}}finally{this._logger.log(E.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?Wr(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(E.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(E.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,o]=Ue();e[t]=o;const r={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let i;try{await this._httpClient.delete(this._url,r)}catch(s){i=s}i?i instanceof Le&&(i.statusCode===404?this._logger.log(E.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(E.Trace,`(LongPolling transport) Error sending a DELETE request: ${i}`)):this._logger.log(E.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(E.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(E.Trace,e),this.onclose(this._closeError)}}}class Fs{constructor(e,t,o,r){this._httpClient=e,this._accessToken=t,this._logger=o,this._options=r,this.onreceive=null,this.onclose=null}async connect(e,t){return oe.isRequired(e,"url"),oe.isRequired(t,"transferFormat"),oe.isIn(t,le,"transferFormat"),this._logger.log(E.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((o,r)=>{let i,s=!1;if(t===le.Text){if(ee.isBrowser||ee.isWebWorker)i=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const a=this._httpClient.getCookieString(e),u={};u.Cookie=a;const[d,w]=Ue();u[d]=w,i=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...u,...this._options.headers}})}try{i.onmessage=a=>{if(this.onreceive)try{this._logger.log(E.Trace,`(SSE transport) data received. ${nt(a.data,this._options.logMessageContent)}.`),this.onreceive(a.data)}catch(u){return void this._close(u)}},i.onerror=a=>{s?this._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},i.onopen=()=>{this._logger.log(E.Information,`SSE connected to ${this._url}`),this._eventSource=i,s=!0,o()}}catch(a){return void r(a)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})}async send(e){return this._eventSource?Wr(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Hs{constructor(e,t,o,r,i,s){this._logger=o,this._accessTokenFactory=t,this._logMessageContent=r,this._webSocketConstructor=i,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let o;return oe.isRequired(e,"url"),oe.isRequired(t,"transferFormat"),oe.isIn(t,le,"transferFormat"),this._logger.log(E.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(o=await this._accessTokenFactory()),new Promise((r,i)=>{let s;e=e.replace(/^http/,"ws");const a=this._httpClient.getCookieString(e);let u=!1;if(ee.isNode||ee.isReactNative){const d={},[w,S]=Ue();d[w]=S,o&&(d[ze.Authorization]=`Bearer ${o}`),a&&(d[ze.Cookie]=a),s=new this._webSocketConstructor(e,void 0,{headers:{...d,...this._headers}})}else o&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(o)}`);s||(s=new this._webSocketConstructor(e)),t===le.Binary&&(s.binaryType="arraybuffer"),s.onopen=d=>{this._logger.log(E.Information,`WebSocket connected to ${e}.`),this._webSocket=s,u=!0,r()},s.onerror=d=>{let w=null;w=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"There was an error with the transport",this._logger.log(E.Information,`(WebSockets transport) ${w}.`)},s.onmessage=d=>{if(this._logger.log(E.Trace,`(WebSockets transport) data received. ${nt(d.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(d.data)}catch(w){return void this._close(w)}},s.onclose=d=>{if(u)this._close(d);else{let w=null;w=typeof ErrorEvent<"u"&&d instanceof ErrorEvent?d.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",i(new Error(w))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(E.Trace,`(WebSockets transport) sending data. ${nt(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(E.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||e.wasClean!==!1&&e.code===1e3?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}class Xs{constructor(e,t={}){var o;if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,oe.isRequired(e,"url"),this._logger=(o=t.logger)===void 0?new Pt(E.Information):o===null?tt.instance:o.log!==void 0?o:new Pt(o),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent!==void 0&&t.logMessageContent,typeof t.withCredentials!="boolean"&&t.withCredentials!==void 0)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=t.withCredentials===void 0||t.withCredentials,t.timeout=t.timeout===void 0?1e5:t.timeout;let r=null,i=null;if(ee.isNode&&typeof require<"u"){const s=typeof __webpack_require__=="function"?__non_webpack_require__:require;r=s("ws"),i=s("eventsource")}ee.isNode||typeof WebSocket>"u"||t.WebSocket?ee.isNode&&!t.WebSocket&&r&&(t.WebSocket=r):t.WebSocket=WebSocket,ee.isNode||typeof EventSource>"u"||t.EventSource?ee.isNode&&!t.EventSource&&i!==void 0&&(t.EventSource=i):t.EventSource=EventSource,this._httpClient=new qs(t.httpClient||new Ns(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||le.Binary,oe.isIn(e,le,"transferFormat"),this._logger.log(E.Debug,`Starting connection with transfer format '${le[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(E.Error,t),await this._stopPromise,Promise.reject(new we(t))}if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(E.Error,t),Promise.reject(new we(t))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Xn(this.transport)),this._sendQueue.send(e))}async stop(e){return this._connectionState==="Disconnected"?(this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):this._connectionState==="Disconnecting"?(this._logger.log(E.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log(E.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(E.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==re.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(re.WebSockets),await this._startTransport(t,e)}else{let o=null,r=0;do{if(o=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new we("The connection was stopped during negotiation.");if(o.error)throw new Error(o.error);if(o.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(o.url&&(t=o.url),o.accessToken){const i=o.accessToken;this._accessTokenFactory=()=>i,this._httpClient._accessToken=i,this._httpClient._accessTokenFactory=void 0}r++}while(o.url&&r<100);if(r===100&&o.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,o,e)}this.transport instanceof Jo&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(E.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(o){return this._logger.log(E.Error,"Failed to start the connection: "+o),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(o)}}async _getNegotiationResponse(e){const t={},[o,r]=Ue();t[o]=r;const i=this._resolveNegotiateUrl(e);this._logger.log(E.Debug,`Sending negotiation request: ${i}.`);try{const s=await this._httpClient.post(i,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(s.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${s.statusCode}'`));const a=JSON.parse(s.content);return(!a.negotiateVersion||a.negotiateVersion<1)&&(a.connectionToken=a.connectionId),a.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Ko("Client didn't negotiate Stateful Reconnect but the server did.")):a}catch(s){let a="Failed to complete negotiation with the server: "+s;return s instanceof Le&&s.statusCode===404&&(a+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(E.Error,a),Promise.reject(new Ko(a))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,o,r){let i=this._createConnectUrl(e,o.connectionToken);if(this._isITransport(t))return this._logger.log(E.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(i,r),void(this.connectionId=o.connectionId);const s=[],a=o.availableTransports||[];let u=o;for(const d of a){const w=this._resolveTransportOrError(d,t,r,u?.useStatefulReconnect===!0);if(w instanceof Error)s.push(`${d.transport} failed:`),s.push(w);else if(this._isITransport(w)){if(this.transport=w,!u){try{u=await this._getNegotiationResponse(e)}catch(S){return Promise.reject(S)}i=this._createConnectUrl(e,u.connectionToken)}try{return await this._startTransport(i,r),void(this.connectionId=u.connectionId)}catch(S){if(this._logger.log(E.Error,`Failed to start the transport '${d.transport}': ${S}`),u=void 0,s.push(new Is(`${d.transport} failed: ${S}`,re[d.transport])),this._connectionState!=="Connecting"){const I="Failed to select transport before stop() was called.";return this._logger.log(E.Debug,I),Promise.reject(new we(I))}}}}return s.length>0?Promise.reject(new Ts(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case re.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Hs(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case re.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Fs(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case re.LongPolling:return new Jo(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async o=>{let r=!1;if(this.features.reconnect){try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{r=!0}r&&this._stopConnection(o)}else this._stopConnection(o)}:this.transport.onclose=o=>this._stopConnection(o),this.transport.connect(e,t)}_resolveTransportOrError(e,t,o,r){const i=re[e.transport];if(i==null)return this._logger.log(E.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(s,a){return!s||(a&s)!=0}(t,i))return this._logger.log(E.Debug,`Skipping transport '${re[i]}' because it was disabled by the client.`),new ks(`'${re[i]}' is disabled by the client.`,i);{if(!(e.transferFormats.map(s=>le[s]).indexOf(o)>=0))return this._logger.log(E.Debug,`Skipping transport '${re[i]}' because it does not support the requested transfer format '${le[o]}'.`),new Error(`'${re[i]}' does not support ${le[o]}.`);if(i===re.WebSockets&&!this._options.WebSocket||i===re.ServerSentEvents&&!this._options.EventSource)return this._logger.log(E.Debug,`Skipping transport '${re[i]}' because it is not supported in your environment.'`),new Es(`'${re[i]}' is not supported in your environment.`,i);this._logger.log(E.Debug,`Selecting transport '${re[i]}'.`);try{return this.features.reconnect=i===re.WebSockets?r:void 0,this._constructTransport(i)}catch(s){return s}}}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(E.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState!=="Disconnected"){if(this._connectionState==="Connecting")throw this._logger.log(E.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(E.Error,`Connection disconnected with error '${e}'.`):this._logger.log(E.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(E.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(E.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(E.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!ee.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(E.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const o=new URLSearchParams(t.searchParams);return o.has("negotiateVersion")||o.append("negotiateVersion",this._negotiateVersion.toString()),o.has("useStatefulReconnect")?o.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&o.append("useStatefulReconnect","true"),t.search=o.toString(),t.toString()}}class Xn{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new ht,this._transportResult=new ht,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new ht),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new ht;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):Xn._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(o){e.reject(o)}}}static _concatBuffers(e){const t=e.map(i=>i.byteLength).reduce((i,s)=>i+s),o=new Uint8Array(t);let r=0;for(const i of e)o.set(new Uint8Array(i),r),r+=i.byteLength;return o.buffer}}class ht{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}class Ks{constructor(){this.name="json",this.version=2,this.transferFormat=le.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=tt.instance);const o=ge.parse(e),r=[];for(const i of o){const s=JSON.parse(i);if(typeof s.type!="number")throw new Error("Invalid payload.");switch(s.type){case U.Invocation:this._isInvocationMessage(s);break;case U.StreamItem:this._isStreamItemMessage(s);break;case U.Completion:this._isCompletionMessage(s);break;case U.Ping:case U.Close:break;case U.Ack:this._isAckMessage(s);break;case U.Sequence:this._isSequenceMessage(s);break;default:t.log(E.Information,"Unknown message type '"+s.type+"' ignored.");continue}r.push(s)}return r}writeMessage(e){return ge.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}}const Vs={trace:E.Trace,debug:E.Debug,info:E.Information,information:E.Information,warn:E.Warning,warning:E.Warning,error:E.Error,critical:E.Critical,none:E.None};class Ys{configureLogging(e){if(oe.isRequired(e,"logging"),e.log!==void 0)this.logger=e;else if(typeof e=="string"){const t=function(o){const r=Vs[o.toLowerCase()];if(r!==void 0)return r;throw new Error(`Unknown log level: ${o}`)}(e);this.logger=new Pt(t)}else this.logger=new Pt(e);return this}withUrl(e,t){return oe.isRequired(e,"url"),oe.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions=typeof t=="object"?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return oe.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new Yo(e):this.reconnectPolicy=e:this.reconnectPolicy=new Yo,this}withServerTimeout(e){return oe.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return oe.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e?.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Xs(this.url,e);return Hn.create(t,this.logger||tt.instance,this.protocol||new Ks,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function ec(n){const e=new Ys().configureLogging(E.Information).withUrl(n).withAutomaticReconnect({nextRetryDelayInMilliseconds:()=>5e3}).build();return e.keepAliveIntervalInMilliseconds=15e3,e.serverTimeoutInMilliseconds=18e5,e.start().then(()=>{W.Logger().info("启动SignalR连接！")}),e.onclose(async()=>{W.Logger().info("断开SignalR连接!")}),e.onreconnecting(()=>{W.Logger().warn("SignalR服务已断线，重连中...！")}),e.onreconnected(()=>{W.Logger().warn("SignalR重连成功!")}),e}const In=new Set;function Go(n){return n!==null?parseFloat(n):0}function dt(n){const e=window.getComputedStyle(n),t=Math.ceil([e.paddingLeft,e.width,e.paddingRight].map(Go).reduce((r,i)=>r+i)),o=Math.ceil([e.paddingTop,e.height,e.paddingBottom].map(Go).reduce((r,i)=>r+i));return{width:t,height:o}}class Js{width;height;constructor(e,t){this.width=e,this.height=t}}function Gs(n){const e=n.windowEl;if(e){const t=parseFloat(e.style.left||"NaN"),o=parseFloat(e.style.top||"NaN");if(!isNaN(t)&&!isNaN(o))return{left:t,top:o}}return null}function Qs(n,e,t,o){const r=n-t,i=e-o;return r*r+i*i}window.addEventListener("resize",n=>{In.forEach(e=>{e&&ss(e.fixPosition)&&e.fixPosition()})});const ft=[];var Qo=Ie({name:"Window",props:{windowStyle:{type:Object,required:!0},isOpen:{type:Boolean,required:!1,default:!0},title:{type:String,required:!0,default:""},closeButton:{type:Boolean,required:!1,default:!0},resizable:{type:Boolean,required:!1,default:!1},isScrollable:{type:Boolean,required:!1,default:!1},padding:{type:Number,required:!1,default:8},activateWhenOpen:{type:Boolean,required:!1,default:!0},positionHint:{type:String,required:!1,default:""},zGroup:{type:Number,required:!1,default:1},overflow:{type:String,required:!1,default:"visible"},minWidth:{type:Number,required:!1,default:1},minHeight:{type:Number,required:!1,default:0},maxWidth:{type:Number,required:!1,default:0},maxHeight:{type:Number,required:!1,default:0},height:{type:Number,required:!1},width:{type:Number,required:!1},top:{type:Number,required:!1},left:{type:Number,required:!1}},components:{myButton:_t},setup(n,{emit:e}){const t=Ui();if(!t)return;const{proxy:o}=t;let r=0,i,s,a;const u=Y(n.isOpen),d=()=>{ft.push(o),a=new ns(n.zGroup,w),n.isOpen&&function(A){_r(()=>{r++==0&&(y(o),function(){const D=S.value,{width:P,height:$}=Cn(D);let O,T;if(n.left!==void 0!=(n.top!==void 0))throw new Error("Either of left or top is specified. Both must be set or not set.");if(typeof n.left=="number")O=n.left,T=n.top;else{const q=n.positionHint||"auto";switch(q){case"auto":{let H=20,ie=50,Q=0;do{if(ft.every(Z=>{if(!Z.isOpen||o==Z)return!0;const be=Gs(Z);if(be==null)return!0;const{left:$e,top:te}=be;return Qs($e,te,H,ie)>16}))break;H=(H+40)%(window.innerWidth-200),ie=(ie+40)%(window.innerHeight-200)}while(++Q<100);O=H,T=ie}break;case"center":O=(window.innerWidth-P)/2,T=(window.innerHeight-$)/2;break;default:try{const H=q.split("/").map(Number);if(H.length!=2)throw null;const[ie,Q]=H;if(!isFinite(ie)||!isFinite(Q))throw null;O=ie>=0?ie:window.innerWidth-P+ie,T=Q>=0?Q:window.innerHeight-$+Q}catch{throw new Error(`invalid position string: ${q}`)}}}D&&(D.style.left=`${O}px`,D.style.top=`${T}px`)}()),n.resizable&&h(),L(),i=new ts(I.value,S.value,{onMove:()=>L(),onMoveStart:()=>e("move-start"),onMoveEnd:()=>e("move-end")}),n.resizable&&function(){const{height:D}=Cn(I.value);s=new os(S.value,{onResize:()=>h(),onResizeStart:()=>e("resize-start"),onResizeEnd:()=>e("resize-end"),minWidth:n.minWidth,minHeight:n.minHeight+D,maxWidth:n.maxWidth,maxHeight:n.maxHeight?n.maxHeight+D:void 0})}()}),n.activateWhenOpen&&k()}(),In.add(o)};function w(A){g.value.zIndex=`${A}`}const S=Y(null),I=Y(null),N=Y(null);function k(){a.raise(),e("activate")}const g=Y({...n.windowStyle.window,zIndex:"auto",overflow:n.overflow}),l=Be(()=>n.windowStyle.titlebar),v=Be(()=>{const A={...n.windowStyle.content};return n.resizable?A.padding="0":n.padding!=null&&(A.padding=`${n.padding}px`),n.isScrollable&&(A.overflow="auto"),A});function y(A){const{width:D,height:P,top:$,left:O}=A,T=S;if(T&&D!=null&&(T.value.style.width=`${D}px`),P!=null){const q=I.value;if(q){const H=dt(q).height;T.value.style.height=`${P+H}px`}}T&&O!=null&&(T.value.style.left=`${O}px`),T&&$!=null&&(T.value.style.top=`${$}px`)}function h(A=!0){const D=S.value,P=I.value,$=N.value;if($&&D&&P){const{width:O,height:T}=dt($),{width:q,height:H}=dt(D),ie=dt(P).height,Q=q-($.offsetWidth-O),Z=H-ie-($.offsetHeight-T);$.style.width=`${Q}px`,$.style.height=`${Z}px`,f(),e("resize",new Js(Q,Z)),A&&(e("update:width",Q),e("update:height",Z))}}function f(){const A=S.value;if(A){const D=A.getBoundingClientRect();D.left<0&&(g.value.left="0px"),D.top<0&&(g.value.top="0px"),D.right>window.innerWidth&&(g.value.left=window.innerWidth-D.width+"px"),D.bottom>window.innerHeight&&(g.value.top=window.innerHeight-D.height+"px")}}function L(A=!0){f();const D=S.value;if(D){const{left:P,top:$}=D.getBoundingClientRect();A&&(e("update:left",P),e("update:top",$))}}return Re(()=>n.isOpen,A=>{u.value=A}),Re(()=>n.zGroup,A=>{a.group=A}),Re(()=>n.width,A=>{y({width:A}),h(!1)}),Re(()=>n.height,A=>{y({height:A}),h(!1)}),Wn(()=>{d()}),Fi(()=>{In.delete(this),a.unregister(),s&&s.teardown(),i&&i.teardown(),ft.splice(ft.indexOf(o),1)}),{isOpen:u,windowEl:S,titlebar:I,content:N,activate:k,styleWindow:g,styleTitlebar:l,styleContent:v,closeButtonClick:function(){u.value=!1,e("closebuttonclick")},fixPosition:f}}});const Zs={class:"title"};var Zo;Qo.render=function(n,e,t,o,r,i){const s=Nt("myButton");return X(),ne(vr,{name:"fade",onAfterLeave:e[2]||(e[2]=a=>n.$emit("close")),onAfterEnter:e[3]||(e[3]=a=>n.$emit("open")),persisted:""},{default:Ce(()=>[yr(G("div",{class:"window",style:me(n.styleWindow),ref:"windowEl",onMousedown:e[0]||(e[0]=(...a)=>n.activate&&n.activate(...a)),onTouchstart:e[1]||(e[1]=(...a)=>n.activate&&n.activate(...a))},[G("div",{class:"titlebar",style:me(n.styleTitlebar),ref:"titlebar"},[G("div",Zs,[n.$slots.title?ce(n.$slots,"title",{key:0}):(X(),fe(Te,{key:1},[_n(Bn(n.title),1)],64))]),n.closeButton?(X(),ne(s,{key:0,windowStyle:n.windowStyle,onClick:n.closeButtonClick},{default:Ce(()=>e[4]||(e[4]=[_n("×")])),_:1},8,["windowStyle","onClick"])):se("v-if",!0)],4),G("div",{class:"content",style:me(n.styleContent),ref:"content"},[ce(n.$slots,"default")],4)],36),[[wr,n.isOpen]])]),_:3})},Qo.__file="src/controls/vuewindow/window/index.vue",function(n){n[n.StyleBlack=0]="StyleBlack",n[n.StyleWhite=1]="StyleWhite",n[n.StyleMetal=2]="StyleMetal",n[n.StyleGrayblue=3]="StyleGrayblue"}(Zo||(Zo={}));var he;(function(n){n[n.top=0]="top",n[n.bottom=1]="bottom",n[n.centerBack=2]="centerBack",n[n.centerMain=3]="centerMain",n[n.centerFront=4]="centerFront",n[n.left=5]="left",n[n.right=6]="right"})(he||(he={}));class ea{layoutState;layoutMap=new Map;preConditionMap=new Map;widgetsLoadedSet=new Set;widgetConfig=new Array;_LayoutID;_mapItemRefs;constructor(e,t,o,r){this.layoutState=e,this._LayoutID=o,this._mapItemRefs=r,t.forEach(i=>{if(i.layoutID===o&&(this.widgetConfig.push(i),i.afterid))if(this.preConditionMap.has(i.afterid))this.preConditionMap.get(i.afterid)?.add(i);else{const s=new Set;s.add(i),this.preConditionMap.set(i.afterid,s)}})}getLayoutID(){return this._LayoutID}getWidgetConfig(){return this.widgetConfig}preloadWidgets(){this.widgetConfig.filter(e=>e.preload&&!e.afterid).forEach(e=>{this._loadWidget(e)})}async loadWidget(e){if(!e)return;let t;if(Un(e)?t=e:xr(e)&&(t=this.widgetConfig.find(o=>o.id===e)),t){if(t.afterid){if(this.isWidgetLoaded(t.afterid))return this._loadWidget(t);{let o=function(a){a.layoutID===r._LayoutID&&a.widgetID===i&&(r._loadWidget(s),W.EventBus.off(pe.WidgetLoadedEvent,o))};const r=this,i=t.afterid,s=t;return W.EventBus.on(pe.WidgetLoadedEvent,o),this.loadWidget(t.afterid)}}return this._loadWidget(t)}}loadOtherDependenceWidgets(e){this.preConditionMap.has(e)&&this.preConditionMap.get(e)?.forEach(t=>{t.preload&&this._loadWidget(t)})}_loadWidget(e){if(!this.widgetsLoadedSet.has(e.id))return e.component?e.component().then(t=>{if(t.default){const o=Ji(t.default);e.layout&&(o.style=e.layout),e.cssClass&&(o.cssClass=e.cssClass),this.getContainerComponents(e.container).value.set(e.id,o),this.widgetsLoadedSet.add(e.id),_r().then(()=>{W.EventBus.emit(pe.WidgetLoadedEvent,{layoutID:this._LayoutID,widgetID:e.id}),this.loadOtherDependenceWidgets(e.id)})}}).catch(t=>{W.Logger().error("加载Widget失败！",e),W.EventBus.emit(pe.WidgetLoadedErrorEvent,e)}):void 0;this.changeWidgetVisible(e.id,!0)}hasDependentWidgets(e){let t=!1;if(this.preConditionMap.has(e)){const o=this.preConditionMap.get(e);if(o){for(const r of o)if(this.isWidgetLoaded(r.id)){t=!0;break}}}return t}unloadWidget(e){if(!e||!this.isWidgetLoaded(e))return;const t=this.widgetConfig.find(o=>o.id===e);if(t){if(this.preConditionMap.has(e)){const o=this.preConditionMap.get(e);if(o)for(const r of o)this.unloadWidget(r.id)}this.getContainerComponents(t.container).value.delete(e),this.widgetsLoadedSet.delete(e),this._mapItemRefs&&this._mapItemRefs.delete(e),W.EventBus.emit(pe.WidgetUnLoadedEvent,{layoutID:this._LayoutID,widgetID:e})}}isWidgetLoaded(e){return this.widgetsLoadedSet.has(e)}splitTwoContainer(e=!1){const t=this.layoutState.centerMainContainer,o=this.layoutState.centerBackContainer;e?(t&&(t.style.left="0",t.style.width="100%"),o&&(o.style.width="100%")):(t&&(t.style.left="50%",t.style.width="50%"),o&&(o.style.width="50%"))}getLayoutContainer(e){switch(e){case he.top:return this.layoutState.topContainer;case he.bottom:return this.layoutState.bottomContainer;case he.left:return this.layoutState.leftContainer;case he.right:return this.layoutState.rightContainer;case he.centerBack:return this.layoutState.centerBackContainer;case he.centerMain:return this.layoutState.centerMainContainer;case he.centerFront:return this.layoutState.centerFrontContainer}}changeContainerVisible(e,t=!1){const o=this.getLayoutContainer(e);o&&(o.style.visibility=t?"visible":"hidden")}changeWidgetVisible(e,t=!1){const o=this.getWidgetComponent(e);o&&o.changeVisible&&o.changeVisible(t)}isWidgetVisible(e){const t=this.getWidgetComponent(e);return!!t&&(!t.isShow||t.isShow.value)}getWidgetComponent(e){if(this.widgetsLoadedSet.has(e)&&this._mapItemRefs)return this._mapItemRefs.get(e)}getWigetItem(e){return this.widgetConfig.find(t=>t.id===e)}getGroupWigetItems(e){return this.widgetConfig.filter(t=>t.group===e)}getContainerComponents(e){if(this.layoutMap.has(e))return this.layoutMap.get(e);{const t=Y(new Map);return this.layoutMap.set(e,t),t}}getWidgetLoadedIDList(){const e=[];return this.widgetsLoadedSet.forEach(t=>{e.push(t)}),e}unloadAllWidgets(e){const t=[];this.widgetsLoadedSet.forEach(o=>{e&&e.length>0?e.findIndex(r=>r===o)<0&&t.push(o):t.push(o)}),t.forEach(o=>this.unloadWidget(o))}unloadWidgets(e){e&&e.length>0&&e.forEach(t=>{this.unloadWidget(t)})}static getLayoutManager(e,t){if(t){const o=t.find(r=>r.id===e);if(o&&o.layoutID)return W.LayoutMap.get(o.layoutID)}}}var Lt=Ie({name:"SuspenseWithError",setup(){const n=Y(null);return Hi(e=>(n.value="当前页面存在问题，无法渲染……",!0)),{error:n}}});Lt.render=function(n,e,t,o,r,i){return n.error?ce(n.$slots,"error",{key:0},()=>[_n(Bn(n.error),1)]):(X(),ne(qi,{key:1},{default:Ce(()=>[ce(n.$slots,"default")]),fallback:Ce(()=>[ce(n.$slots,"fallback")]),_:3}))},Lt.__file="src/controls/routertransition/SuspenseWithError.vue";var Br=Ie({name:"RouterTransition",__name:"RouterTransition",setup:n=>(e,t)=>{const o=Nt("router-view");return X(),ne(Lt,null,{default:Ce(()=>[Et(o,null,{default:Ce(({Component:r,route:i})=>[se(" <transition> "),(X(),ne(br,null,[i.meta.keepAlive?(X(),ne(Se(r),{key:i.name})):se("v-if",!0)],1024)),i.meta.keepAlive?se("v-if",!0):(X(),ne(Se(r),{key:i.name})),se(" </transition> ")]),_:1})]),_:1})}});Br.__file="src/controls/routertransition/RouterTransition.vue";var gn=Ie({name:"LayoutContainer",props:{widgetConfig:{type:Array,required:!0,default:()=>[]},layoutID:{type:String,default:void 0},layoutStyle:{type:Object},enableRouterView:{type:Boolean,default:!0}},emits:["containerLoaded"],components:{RouterTransition:Br},setup(n,{attrs:e,slots:t,emit:o}){const r=n.layoutID,i=Y(n.enableRouterView);Re(()=>n.enableRouterView,()=>{i.value=n.enableRouterView});const s=Xi({topContainer:void 0,centerBackContainer:void 0,centerMainContainer:void 0,centerFrontContainer:void 0,bottomContainer:void 0,leftContainer:void 0,rightContainer:void 0}),a=new Map,u=new ea(s,n.widgetConfig,r,a),d=g(he.top),w=g(he.centerBack),S=g(he.centerFront),I=g(he.left),N=g(he.right),k=g(he.bottom);function g(v){return u?.getContainerComponents(v)}const l=Be(()=>n.layoutStyle);return Wn(()=>{u&&(r?W.LayoutMap.set(r,u):(W.LayoutManager=u,W.LayoutMap.set("",u)),u.preloadWidgets(),o("containerLoaded",{layoutID:r,layoutManager:u}),W.EventBus.emit(pe.LayoutContainerLoaded,{layoutID:r,layoutManager:u}))}),{...Ki(s),topContainerComponents:d,centerbackComponents:w,centerfrontComponents:S,leftContainerComponents:I,rightContainerComponents:N,bottomContainerComponents:k,containerStyle:l,isEnableRouterView:i,setItemRef:(v,y)=>{v&&a.set(y,v)}}}});const ta={ref:"topContainer",class:"topContainer"},na={key:0,ref:"centerMainContainer",class:"centerdiv mainContainer"},oa={ref:"centerBackContainer",class:"centerdiv backContainer"},ra={ref:"centerFrontContainer",class:"centerdiv centerFrontContainer"},ia={ref:"leftContainer",class:"leftContainer"},sa={ref:"rightContainer",class:"rightContainer"},aa={ref:"bottomContainer",class:"bottomContainer"};gn.render=function(n,e,t,o,r,i){const s=Nt("router-transition");return X(),fe("div",{class:"layoutContainer",style:me(n.containerStyle)},[G("div",ta,[ce(n.$slots,"top"),(X(!0),fe(Te,null,Oe(n.topContainerComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512),G("div",null,[se(" 主要容器-底部 "),n.isEnableRouterView?(X(),fe("div",na,[ce(n.$slots,"main",{},()=>[Et(s)])],512)):se("v-if",!0),se(" 上一层-主容器 "),G("div",oa,[ce(n.$slots,"back"),(X(!0),fe(Te,null,Oe(n.centerbackComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512),se(" 最上浮动-主容器 "),G("div",ra,[ce(n.$slots,"front"),(X(!0),fe(Te,null,Oe(n.centerfrontComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512),G("div",ia,[ce(n.$slots,"left"),(X(!0),fe(Te,null,Oe(n.leftContainerComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512),G("div",sa,[ce(n.$slots,"right"),(X(!0),fe(Te,null,Oe(n.rightContainerComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512)]),G("div",aa,[ce(n.$slots,"bottom"),(X(!0),fe(Te,null,Oe(n.bottomContainerComponents,([a,u])=>(X(),ne(Se(u),{ref_for:!0,ref:d=>n.setItemRef(d,a),key:a,style:me(u.style),class:Me(u.cssClass)},null,8,["style","class"]))),128))],512),se(" 增加默认插槽 "),ce(n.$slots,"default")],4)},gn.__scopeId="data-v-4d081e5c",gn.__file="src/controls/layoutcontainer/layout.vue";var ca=Ie({name:"RouterTransition",__name:"RouterTransitionAnimate",props:{enterActive:{type:String,required:!1,default:"animated fadeIn"},leaveActive:{type:String,required:!1,default:"animated fadeOut"}},setup:n=>(e,t)=>{const o=Nt("router-view");return X(),ne(Lt,null,{default:Ce(()=>[Et(o,null,{default:Ce(({Component:r,route:i})=>[Et(Vi,{appear:"","enter-active-class":e.enterActive,"leave-active-class":e.leaveActive},{default:Ce(()=>[(X(),ne(br,null,[i.meta.keepAlive?(X(),ne(Se(r),{key:i.name})):se("v-if",!0)],1024)),i.meta.keepAlive?se("v-if",!0):(X(),ne(Se(r),{key:i.name}))]),_:2},1032,["enter-active-class","leave-active-class"])]),_:1})]),_:1})}});ca.__file="src/controls/routertransition/RouterTransitionAnimate.vue";const et=/^[a-z0-9]+(-[a-z0-9]+)*$/,zt=(n,e,t,o="")=>{const r=n.split(":");if(n.slice(0,1)==="@"){if(r.length<2||r.length>3)return null;o=r.shift().slice(1)}if(r.length>3||!r.length)return null;if(r.length>1){const a=r.pop(),u=r.pop(),d={provider:r.length>0?r[0]:o,prefix:u,name:a};return e&&!St(d)?null:d}const i=r[0],s=i.split("-");if(s.length>1){const a={provider:o,prefix:s.shift(),name:s.join("-")};return e&&!St(a)?null:a}if(t&&o===""){const a={provider:o,prefix:"",name:i};return e&&!St(a,t)?null:a}return null},St=(n,e)=>!!n&&!(n.provider!==""&&!n.provider.match(et)||!(e&&n.prefix===""||n.prefix.match(et))||!n.name.match(et)),qr=Object.freeze({left:0,top:0,width:16,height:16}),At=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Wt=Object.freeze({...qr,...At}),Tn=Object.freeze({...Wt,body:"",hidden:!1});function er(n,e){const t=function(o,r){const i={};!o.hFlip!=!r.hFlip&&(i.hFlip=!0),!o.vFlip!=!r.vFlip&&(i.vFlip=!0);const s=((o.rotate||0)+(r.rotate||0))%4;return s&&(i.rotate=s),i}(n,e);for(const o in Tn)o in At?o in n&&!(o in t)&&(t[o]=At[o]):o in e?t[o]=e[o]:o in n&&(t[o]=n[o]);return t}function la(n,e,t){const o=n.icons,r=n.aliases||Object.create(null);let i={};function s(a){i=er(o[a]||r[a],i)}return s(e),t.forEach(s),er(n,i)}function Ur(n,e){const t=[];if(typeof n!="object"||typeof n.icons!="object")return t;n.not_found instanceof Array&&n.not_found.forEach(r=>{e(r,null),t.push(r)});const o=function(r,i){const s=r.icons,a=r.aliases||Object.create(null),u=Object.create(null);return Object.keys(s).concat(Object.keys(a)).forEach(function d(w){if(s[w])return u[w]=[];if(!(w in u)){u[w]=null;const S=a[w]&&a[w].parent,I=S&&d(S);I&&(u[w]=[S].concat(I))}return u[w]}),u}(n);for(const r in o){const i=o[r];i&&(e(r,la(n,r,i)),t.push(r))}return t}const ua={provider:"",aliases:{},not_found:{},...qr};function mn(n,e){for(const t in e)if(t in n&&typeof n[t]!=typeof e[t])return!1;return!0}function Fr(n){if(typeof n!="object"||n===null)return null;const e=n;if(typeof e.prefix!="string"||!n.icons||typeof n.icons!="object"||!mn(n,ua))return null;const t=e.icons;for(const r in t){const i=t[r];if(!r.match(et)||typeof i.body!="string"||!mn(i,Tn))return null}const o=e.aliases||Object.create(null);for(const r in o){const i=o[r],s=i.parent;if(!r.match(et)||typeof s!="string"||!t[s]&&!o[s]||!mn(i,Tn))return null}return e}const tr=Object.create(null);function Ae(n,e){const t=tr[n]||(tr[n]=Object.create(null));return t[e]||(t[e]=function(o,r){return{provider:o,prefix:r,icons:Object.create(null),missing:new Set}}(n,e))}function Kn(n,e){return Fr(e)?Ur(e,(t,o)=>{o?n.icons[t]=o:n.missing.add(t)}):[]}let ot=!1;function Hr(n){return typeof n=="boolean"&&(ot=n),ot}function ha(n,e){if(typeof n!="object")return!1;if(typeof e!="string"&&(e=n.provider||""),ot&&!e&&!n.prefix){let o=!1;return Fr(n)&&(n.prefix="",Ur(n,(r,i)=>{i&&function(s,a){const u=zt(s,!0,ot);return!!u&&function(d,w,S){try{if(typeof S.body=="string")return d.icons[w]={...S},!0}catch{}return!1}(Ae(u.provider,u.prefix),u.name,a)}(r,i)&&(o=!0)})),o}const t=n.prefix;return St({provider:e,prefix:t,name:"a"})?!!Kn(Ae(e,t),n):!1}const Xr=Object.freeze({width:null,height:null}),Kr=Object.freeze({...Xr,...At}),da=/(-?[0-9.]*[0-9]+[0-9.]*)/g,fa=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function nr(n,e,t){if(e===1)return n;if(t=t||100,typeof n=="number")return Math.ceil(n*e*t)/t;if(typeof n!="string")return n;const o=n.split(da);if(o===null||!o.length)return n;const r=[];let i=o.shift(),s=fa.test(i);for(;;){if(s){const a=parseFloat(i);isNaN(a)?r.push(i):r.push(Math.ceil(a*e*t)/t)}else r.push(i);if(i=o.shift(),i===void 0)return r.join("");s=!s}}const pa=/\sid="(\S+)"/g,ga="IconifyId"+Date.now().toString(16)+(16777216*Math.random()|0).toString(16);let ma=0;const Mn=Object.create(null);function Rn(n){return Mn[n]||Mn[""]}function Vn(n){let e;if(typeof n.resources=="string")e=[n.resources];else if(e=n.resources,!(e instanceof Array&&e.length))return null;return{resources:e,path:n.path||"/",maxURL:n.maxURL||500,rotate:n.rotate||750,timeout:n.timeout||5e3,random:n.random===!0,index:n.index||0,dataAfterTimeout:n.dataAfterTimeout!==!1}}const Yn=Object.create(null),pt=["https://api.simplesvg.com","https://api.unisvg.com"],Pn=[];for(;pt.length>0;)pt.length===1||Math.random()>.5?Pn.push(pt.shift()):Pn.push(pt.pop());function va(n,e){const t=Vn(e);return t!==null&&(Yn[n]=t,!0)}function Ln(n){return Yn[n]}Yn[""]=Vn({resources:["https://api.iconify.design"].concat(Pn)});let or=(()=>{let n;try{if(n=fetch,typeof n=="function")return n}catch{}})();const ya={prepare:(n,e,t)=>{const o=[],r=function(u,d){const w=Ln(u);if(!w)return 0;let S;if(w.maxURL){let I=0;w.resources.forEach(k=>{I=Math.max(I,k.length)});const N=d+".json?icons=";S=w.maxURL-I-w.path.length-N.length}else S=0;return S}(n,e),i="icons";let s={type:i,provider:n,prefix:e,icons:[]},a=0;return t.forEach((u,d)=>{a+=u.length+1,a>=r&&d>0&&(o.push(s),s={type:i,provider:n,prefix:e,icons:[]},a=u.length),s.icons.push(u)}),o.push(s),o},send:(n,e,t)=>{if(!or)return void t("abort",424);let o=function(i){if(typeof i=="string"){const s=Ln(i);if(s)return s.path}return"/"}(e.provider);switch(e.type){case"icons":{const i=e.prefix,s=e.icons.join(",");o+=i+".json?"+new URLSearchParams({icons:s}).toString();break}case"custom":{const i=e.uri;o+=i.slice(0,1)==="/"?i.slice(1):i;break}default:return void t("abort",400)}let r=503;or(n+o).then(i=>{const s=i.status;if(s===200)return r=501,i.json();setTimeout(()=>{t(function(a){return a===404}(s)?"abort":"next",s)})}).then(i=>{setTimeout(typeof i=="object"&&i!==null?()=>{t("success",i)}:()=>{i===404?t("abort",i):t("next",r)})}).catch(()=>{t("next",r)})}};function Vr(n,e){n.forEach(t=>{const o=t.loaderCallbacks;o&&(t.loaderCallbacks=o.filter(r=>r.id!==e))})}let wa=0;var ba={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function _a(n,e,t,o){const r=n.resources.length,i=n.random?Math.floor(Math.random()*r):n.index;let s;if(n.random){let f=n.resources.slice(0);for(s=[];f.length>1;){const L=Math.floor(Math.random()*f.length);s.push(f[L]),f=f.slice(0,L).concat(f.slice(L+1))}s=s.concat(f)}else s=n.resources.slice(i).concat(n.resources.slice(0,i));const a=Date.now();let u,d="pending",w=0,S=null,I=[],N=[];function k(){S&&(clearTimeout(S),S=null)}function g(){d==="pending"&&(d="aborted"),k(),I.forEach(f=>{f.status==="pending"&&(f.status="aborted")}),I=[]}function l(f,L){L&&(N=[]),typeof f=="function"&&N.push(f)}function v(){d="failed",N.forEach(f=>{f(void 0,u)})}function y(){I.forEach(f=>{f.status==="pending"&&(f.status="aborted")}),I=[]}function h(){if(d!=="pending")return;k();const f=s.shift();if(f===void 0)return I.length?void(S=setTimeout(()=>{k(),d==="pending"&&(y(),v())},n.timeout)):void v();const L={status:"pending",resource:f,callback:(A,D)=>{(function(P,$,O){const T=$!=="success";switch(I=I.filter(q=>q!==P),d){case"pending":break;case"failed":if(T||!n.dataAfterTimeout)return;break;default:return}if($==="abort")return u=O,void v();if(T)return u=O,void(I.length||(s.length?h():v()));if(k(),y(),!n.random){const q=n.resources.indexOf(P.resource);q!==-1&&q!==n.index&&(n.index=q)}d="completed",N.forEach(q=>{q(O)})})(L,A,D)}};I.push(L),w++,S=setTimeout(h,n.rotate),t(f,e,L.callback)}return typeof o=="function"&&N.push(o),setTimeout(h),function(){return{startTime:a,payload:e,status:d,queriesSent:w,queriesPending:I.length,subscribe:l,abort:g}}}function rr(n){const e={...ba,...n};let t=[];function o(){t=t.filter(r=>r().status==="pending")}return{query:function(r,i,s){const a=_a(e,r,i,(u,d)=>{o(),s&&s(u,d)});return t.push(a),a},find:function(r){return t.find(i=>r(i))||null},setIndex:r=>{e.index=r},getIndex:()=>e.index,cleanup:o}}function ir(){}const vn=Object.create(null);function Sa(n,e,t){let o,r;if(typeof n=="string"){const i=Rn(n);if(!i)return t(void 0,424),ir;r=i.send;const s=function(a){if(!vn[a]){const u=Ln(a);if(!u)return;const d={config:u,redundancy:rr(u)};vn[a]=d}return vn[a]}(n);s&&(o=s.redundancy)}else{const i=Vn(n);if(i){o=rr(i);const s=Rn(n.resources?n.resources[0]:"");s&&(r=s.send)}}return o&&r?o.query(e,r,t)().abort:(t(void 0,424),ir)}function zn(n,e){try{return n.getItem(e)}catch{}}function Jn(n,e,t){try{return n.setItem(e,t),!0}catch{}}function sr(n,e){try{n.removeItem(e)}catch{}}function An(n,e){return Jn(n,"iconify-count",e.toString())}function Dn(n){return parseInt(zn(n,"iconify-count"))||0}const Dt={local:!0,session:!0},Yr={local:new Set,session:new Set};let Nn=!1,gt=typeof window>"u"?{}:window;function Jr(n){const e=n+"Storage";try{if(gt&&gt[e]&&typeof gt[e].length=="number")return gt[e]}catch{}Dt[n]=!1}function Gr(n,e){const t=Jr(n);if(!t)return;const o=zn(t,"iconify-version");if(o!=="iconify2"){if(o){const a=Dn(t);for(let u=0;u<a;u++)sr(t,"iconify"+u.toString())}return Jn(t,"iconify-version","iconify2"),void An(t,0)}const r=Math.floor(Date.now()/36e5)-168,i=a=>{const u="iconify"+a.toString(),d=zn(t,u);if(typeof d=="string"){try{const w=JSON.parse(d);if(typeof w=="object"&&typeof w.cached=="number"&&w.cached>r&&typeof w.provider=="string"&&typeof w.data=="object"&&typeof w.data.prefix=="string"&&e(w,a))return!0}catch{}sr(t,u)}};let s=Dn(t);for(let a=s-1;a>=0;a--)i(a)||(a===s-1?(s--,An(t,s)):Yr[n].add(a))}function Qr(){if(!Nn){Nn=!0;for(const n in Dt)Gr(n,e=>{const t=e.data,o=Ae(e.provider,t.prefix);if(!Kn(o,t).length)return!1;const r=t.lastModified||-1;return o.lastModifiedCached=o.lastModifiedCached?Math.min(o.lastModifiedCached,r):r,!0})}}function Ca(n,e){function t(o){let r;if(!Dt[o]||!(r=Jr(o)))return;const i=Yr[o];let s;if(i.size)i.delete(s=Array.from(i).shift());else if(s=Dn(r),s>=50||!An(r,s+1))return;const a={cached:Math.floor(Date.now()/36e5),provider:n.provider,data:e};return Jn(r,"iconify"+s.toString(),JSON.stringify(a))}Nn||Qr(),e.lastModified&&!function(o,r){const i=o.lastModifiedCached;if(i&&i>=r)return i===r;if(o.lastModifiedCached=r,i)for(const s in Dt)Gr(s,a=>{const u=a.data;return a.provider!==o.provider||u.prefix!==o.prefix||u.lastModified===r});return!0}(n,e.lastModified)||Object.keys(e.icons).length&&(e.not_found&&delete(e=Object.assign({},e)).not_found,t("local")||t("session"))}function ar(){}function xa(n){n.iconsLoaderFlag||(n.iconsLoaderFlag=!0,setTimeout(()=>{n.iconsLoaderFlag=!1,function(e){e.pendingCallbacksFlag||(e.pendingCallbacksFlag=!0,setTimeout(()=>{e.pendingCallbacksFlag=!1;const t=e.loaderCallbacks?e.loaderCallbacks.slice(0):[];if(!t.length)return;let o=!1;const r=e.provider,i=e.prefix;t.forEach(s=>{const a=s.icons,u=a.pending.length;a.pending=a.pending.filter(d=>{if(d.prefix!==i)return!0;const w=d.name;if(e.icons[w])a.loaded.push({provider:r,prefix:i,name:w});else{if(!e.missing.has(w))return o=!0,!0;a.missing.push({provider:r,prefix:i,name:w})}return!1}),a.pending.length!==u&&(o||Vr([e],s.id),s.callback(a.loaded.slice(0),a.missing.slice(0),a.pending.slice(0),s.abort))})}))}(n)}))}const Ea=(n,e)=>{const t=function(u,d=!0,w=!1){const S=[];return u.forEach(I=>{const N=typeof I=="string"?zt(I,d,w):I;N&&S.push(N)}),S}(n,!0,Hr()),o=function(u){const d={loaded:[],missing:[],pending:[]},w=Object.create(null);u.sort((I,N)=>I.provider!==N.provider?I.provider.localeCompare(N.provider):I.prefix!==N.prefix?I.prefix.localeCompare(N.prefix):I.name.localeCompare(N.name));let S={provider:"",prefix:"",name:""};return u.forEach(I=>{if(S.name===I.name&&S.prefix===I.prefix&&S.provider===I.provider)return;S=I;const N=I.provider,k=I.prefix,g=I.name,l=w[N]||(w[N]=Object.create(null)),v=l[k]||(l[k]=Ae(N,k));let y;y=g in v.icons?d.loaded:k===""||v.missing.has(g)?d.missing:d.pending;const h={provider:N,prefix:k,name:g};y.push(h)}),d}(t);if(!o.pending.length){let u=!0;return e&&setTimeout(()=>{u&&e(o.loaded,o.missing,o.pending,ar)}),()=>{u=!1}}const r=Object.create(null),i=[];let s,a;return o.pending.forEach(u=>{const{provider:d,prefix:w}=u;if(w===a&&d===s)return;s=d,a=w,i.push(Ae(d,w));const S=r[d]||(r[d]=Object.create(null));S[w]||(S[w]=[])}),o.pending.forEach(u=>{const{provider:d,prefix:w,name:S}=u,I=Ae(d,w),N=I.pendingIcons||(I.pendingIcons=new Set);N.has(S)||(N.add(S),r[d][w].push(S))}),i.forEach(u=>{const{provider:d,prefix:w}=u;r[d][w].length&&function(S,I){S.iconsToLoad?S.iconsToLoad=S.iconsToLoad.concat(I).sort():S.iconsToLoad=I,S.iconsQueueFlag||(S.iconsQueueFlag=!0,setTimeout(()=>{S.iconsQueueFlag=!1;const{provider:N,prefix:k}=S,g=S.iconsToLoad;let l;delete S.iconsToLoad,g&&(l=Rn(N))&&l.prepare(N,k,g).forEach(v=>{Sa(N,v,y=>{if(typeof y!="object")v.icons.forEach(h=>{S.missing.add(h)});else try{const h=Kn(S,y);if(!h.length)return;const f=S.pendingIcons;f&&h.forEach(L=>{f.delete(L)}),Ca(S,y)}catch{}xa(S)})})}))}(u,r[d][w])}),e?function(u,d,w){const S=wa++,I=Vr.bind(null,w,S);if(!d.pending.length)return I;const N={id:S,icons:d,callback:u,abort:I};return w.forEach(k=>{(k.loaderCallbacks||(k.loaderCallbacks=[])).push(N)}),I}(e,o,i):ar},ka=/[\s,]+/;function Ia(n,e){e.split(ka).forEach(t=>{switch(t.trim()){case"horizontal":n.hFlip=!0;break;case"vertical":n.vFlip=!0}})}function Ta(n,e=0){const t=n.replace(/^-?[0-9.]*/,"");function o(r){for(;r<0;)r+=4;return r%4}if(t===""){const r=parseInt(n);return isNaN(r)?0:o(r)}if(t!==n){let r=0;switch(t){case"%":r=25;break;case"deg":r=90}if(r){let i=parseFloat(n.slice(0,n.length-t.length));return isNaN(i)?0:(i/=r,i%1==0?o(i):0)}}return e}const cr={...Kr,inline:!1},Ma={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Ra={display:"inline-block"},$n={backgroundColor:"currentColor"},Zr={backgroundColor:"transparent"},lr={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},ur={webkitMask:$n,mask:$n,background:Zr};for(const n in ur){const e=ur[n];for(const t in lr)e[n+t]=lr[t]}const Ct={};function hr(n){return n+(n.match(/^[-0-9.]+$/)?"px":"")}["horizontal","vertical"].forEach(n=>{const e=n.slice(0,1)+"Flip";Ct[n+"-flip"]=e,Ct[n.slice(0,1)+"-flip"]=e,Ct[n+"Flip"]=e});const dr=(n,e)=>{const t=function(l,v){const y={...l};for(const h in v){const f=v[h],L=typeof f;h in Xr?(f===null||f&&(L==="string"||L==="number"))&&(y[h]=f):L===typeof y[h]&&(y[h]=h==="rotate"?f%4:f)}return y}(cr,e),o={...Ma},r=e.mode||"svg",i={},s=e.style,a=typeof s!="object"||s instanceof Array?{}:s;for(let l in e){const v=e[l];if(v!==void 0)switch(l){case"icon":case"style":case"onLoad":case"mode":break;case"inline":case"hFlip":case"vFlip":t[l]=v===!0||v==="true"||v===1;break;case"flip":typeof v=="string"&&Ia(t,v);break;case"color":i.color=v;break;case"rotate":typeof v=="string"?t[l]=Ta(v):typeof v=="number"&&(t[l]=v);break;case"ariaHidden":case"aria-hidden":v!==!0&&v!=="true"&&delete o["aria-hidden"];break;default:{const y=Ct[l];y?v!==!0&&v!=="true"&&v!==1||(t[y]=!0):cr[l]===void 0&&(o[l]=v)}}}const u=function(l,v){const y={...Wt,...l},h={...Kr,...v},f={left:y.left,top:y.top,width:y.width,height:y.height};let L=y.body;[y,h].forEach(Q=>{const Z=[],be=Q.hFlip,$e=Q.vFlip;let te,_e=Q.rotate;switch(be?$e?_e+=2:(Z.push("translate("+(f.width+f.left).toString()+" "+(0-f.top).toString()+")"),Z.push("scale(-1 1)"),f.top=f.left=0):$e&&(Z.push("translate("+(0-f.left).toString()+" "+(f.height+f.top).toString()+")"),Z.push("scale(1 -1)"),f.top=f.left=0),_e<0&&(_e-=4*Math.floor(_e/4)),_e%=4,_e){case 1:te=f.height/2+f.top,Z.unshift("rotate(90 "+te.toString()+" "+te.toString()+")");break;case 2:Z.unshift("rotate(180 "+(f.width/2+f.left).toString()+" "+(f.height/2+f.top).toString()+")");break;case 3:te=f.width/2+f.left,Z.unshift("rotate(-90 "+te.toString()+" "+te.toString()+")")}_e%2==1&&(f.left!==f.top&&(te=f.left,f.left=f.top,f.top=te),f.width!==f.height&&(te=f.width,f.width=f.height,f.height=te)),Z.length&&(L=function(qt,Ut,Ft){const rt=function(ve,it="defs"){let st="";const Ve=ve.indexOf("<"+it);for(;Ve>=0;){const at=ve.indexOf(">",Ve),Ye=ve.indexOf("</"+it);if(at===-1||Ye===-1)break;const ye=ve.indexOf(">",Ye);if(ye===-1)break;st+=ve.slice(at+1,Ye).trim(),ve=ve.slice(0,Ve).trim()+ve.slice(ye+1)}return{defs:st,content:ve}}(qt);return Xe=rt.defs,Ke=Ut+rt.content+Ft,Xe?"<defs>"+Xe+"</defs>"+Ke:Ke;var Xe,Ke}(L,'<g transform="'+Z.join(" ")+'">',"</g>"))});const A=h.width,D=h.height,P=f.width,$=f.height;let O,T;A===null?(T=D===null?"1em":D==="auto"?$:D,O=nr(T,P/$)):(O=A==="auto"?P:A,T=D===null?nr(O,$/P):D==="auto"?$:D);const q={},H=(Q,Z)=>{(be=>be==="unset"||be==="undefined"||be==="none")(Z)||(q[Q]=Z.toString())};H("width",O),H("height",T);const ie=[f.left,f.top,P,$];return q.viewBox=ie.join(" "),{attributes:q,viewBox:ie,body:L}}(n,t),d=u.attributes;if(t.inline&&(i.verticalAlign="-0.125em"),r==="svg"){o.style={...i,...a},Object.assign(o,d);let l=0,v=e.id;return typeof v=="string"&&(v=v.replace(/-/g,"_")),o.innerHTML=function(y,h=ga){const f=[];let L;for(;L=pa.exec(y);)f.push(L[1]);if(!f.length)return y;const A="suffix"+(16777216*Math.random()|Date.now()).toString(16);return f.forEach(D=>{const P=typeof h=="function"?h(D):h+(ma++).toString(),$=D.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");y=y.replace(new RegExp('([#;"])('+$+')([")]|\\.[a-z])',"g"),"$1"+P+A+"$3")}),y=y.replace(new RegExp(A,"g"),"")}(u.body,v?()=>v+"ID"+l++:"iconifyVue"),Sn("svg",o)}const{body:w,width:S,height:I}=n,N=r==="mask"||r!=="bg"&&w.indexOf("currentColor")!==-1,k=function(l,v){let y=l.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const h in v)y+=" "+h+'="'+v[h]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+y+">"+l+"</svg>"}(w,{...d,width:S+"",height:I+""});var g;return o.style={...i,"--svg":(g=k,'url("'+function(l){return"data:image/svg+xml,"+function(v){return v.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}(l)}(g)+'")'),width:hr(d.width),height:hr(d.height),...Ra,...N?$n:Zr,...a},Sn("span",o)};var fr;if(Hr(!0),fr=ya,Mn[""]=fr,typeof document<"u"&&typeof window<"u"){Qr();const n=window;if(n.IconifyPreload!==void 0){const e=n.IconifyPreload,t="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(o=>{try{typeof o!="object"||o===null||o instanceof Array||typeof o.icons!="object"||typeof o.prefix!="string"||ha(o)}catch{}})}if(n.IconifyProviders!==void 0){const e=n.IconifyProviders;if(typeof e=="object"&&e!==null)for(let t in e){const o="IconifyProviders["+t+"] is invalid.";try{const r=e[t];if(typeof r!="object"||!r||r.resources===void 0)continue;va(t,r)}catch{}}}}const Pa={...Wt,body:""},yn=Ie({inheritAttrs:!1,data:()=>({_name:"",_loadingIcon:null,iconMounted:!1,counter:0}),mounted(){this.iconMounted=!0},unmounted(){this.abortLoading()},methods:{abortLoading(){this._loadingIcon&&(this._loadingIcon.abort(),this._loadingIcon=null)},getIcon(n,e){if(typeof n=="object"&&n!==null&&typeof n.body=="string")return this._name="",this.abortLoading(),{data:n};let t;if(typeof n!="string"||(t=zt(n,!1,!0))===null)return this.abortLoading(),null;const o=function(i){const s=typeof i=="string"?zt(i,!0,ot):i;if(s){const a=Ae(s.provider,s.prefix),u=s.name;return a.icons[u]||(a.missing.has(u)?null:void 0)}}(t);if(!o)return this._loadingIcon&&this._loadingIcon.name===n||(this.abortLoading(),this._name="",o!==null&&(this._loadingIcon={name:n,abort:Ea([t],()=>{this.counter++})})),null;this.abortLoading(),this._name!==n&&(this._name=n,e&&e(n));const r=["iconify"];return t.prefix!==""&&r.push("iconify--"+t.prefix),t.provider!==""&&r.push("iconify--"+t.provider),{data:o,classes:r}}},render(){this.counter;const n=this.$attrs,e=this.iconMounted||n.ssr?this.getIcon(n.icon,n.onLoad):null;if(!e)return dr(Pa,n);let t=n;return e.classes&&(t={...n,class:(typeof n.class=="string"?n.class+" ":"")+e.classes.join(" ")}),dr({...Wt,...e.data},t)}}),Ge=new Map,xt=Y(new Map);class mt{static addWindowPanel(e){Ge.set(e.id,e)}static removeWindowPanel(e){Ge.has(e)&&(Ge.delete(e),xt.value.delete(e))}static minimizeWindowPanel(e){Ge.has(e)&&xt.value.set(e,-1)}static openWindowPanel(e){Ge.has(e)&&xt.value.set(e,1)}}const La=["src"],za={key:1,class:"paneltitle"},Aa={class:"dragPanelBar"},Da={class:"dragPanelContent"},Na={class:"drag-pointer-group"};var pr=Ie({__name:"XWindow",props:{top:{type:[String,Number],default:0},left:{type:[String,Number],default:0},nWidth:{type:[String,Number],default:"300px"},nHeight:{type:[String,Number],default:"400px"},icon:{type:String,default:"img/logo.png"},title:{type:String,default:""},titleHeight:{type:[String,Number],default:"40px"},hasMin:{type:Boolean,default:!0},hasMax:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!0},isDark:{type:Boolean,default:!1},pid:{type:String,default:""},tag:{type:[String,Array,Object,Number],default:""}},emits:["close","open","loaded","minimize"],setup(n,{expose:e,emit:t}){const o=cs(),r=n,i=t,s=Y(),a=Y(),u=Be(()=>r.isDark),d=Y({x:0,y:0}),w=250,S=100,I=Y({width:0,height:0}),N=T=>{s.value&&(s.value.style.left=`${T.x}px`,s.value.style.top=`${T.y}px`)};Re(()=>d.value,T=>{N(T)});const k=T=>{s.value&&(s.value.style.width=`${T.width}px`,s.value.style.height=`${T.height}px`)};Re(()=>I.value,T=>{k(T)});const g={eventListenerController:null,startingEdges:null,newEdges:null,clickStart:null,mount:()=>{Object.entries(g.refs).forEach(([T,q])=>{q.value&&q.value.addEventListener("mousedown",H=>{g.mouseDown(H,T)})})},mouseDown:(T,q)=>{T.button==0&&(T.preventDefault(),g.startingEdges={left:d.value.x,top:d.value.y,right:d.value.x+I.value.width,bottom:d.value.y+I.value.height},g.newEdges={...g.startingEdges},g.clickStart={x:T.clientX,y:T.clientY},g.eventListenerController=new AbortController,document.addEventListener("mousemove",H=>{g.mouseMove(H,q)},{signal:g.eventListenerController.signal}),document.addEventListener("mouseup",H=>{g.mouseUp(H,q)},{signal:g.eventListenerController.signal}))},mouseMove:(T,q)=>{if(g.startingEdges!=null&&g.newEdges!=null&&g.clickStart!=null&&g.refs[q].value){if(T.preventDefault(),q.toLowerCase().includes("north")){g.newEdges.top=Math.max(g.startingEdges.top+T.clientY-g.clickStart.y,0);const H=g.newEdges.bottom-g.newEdges.top-S;H<0&&(g.newEdges.top+=H)}else q.toLowerCase().includes("south")&&(g.newEdges.bottom=Math.min(g.startingEdges.bottom+T.clientY-g.clickStart.y,document.body.clientHeight));if(q.toLowerCase().includes("west")){g.newEdges.left=Math.max(g.startingEdges.left+T.clientX-g.clickStart.x,0);const H=g.newEdges.right-g.newEdges.left-w;H<0&&(g.newEdges.left+=H)}else q.toLowerCase().includes("east")&&(g.newEdges.right=Math.min(g.startingEdges.right+T.clientX-g.clickStart.x,document.body.clientWidth));g.update()}},update:()=>{g.newEdges==null||g.startingEdges==null||(d.value={x:Math.max(g.newEdges.left,0),y:Math.max(g.newEdges.top,0)},I.value={width:Math.min(Math.max(g.newEdges.right-g.newEdges.left,w),document.body.clientWidth),height:Math.min(Math.max(g.newEdges.bottom-g.newEdges.top,S),document.body.clientHeight)})},mouseUp:(T,q)=>{T.button!=0||g.startingEdges==null||(T.preventDefault(),g.startingEdges=null,g.newEdges=null,g.clickStart=null,g.eventListenerController&&(g.eventListenerController.abort(),g.eventListenerController=null))},refs:{northWest:Y(null),north:Y(null),northEast:Y(null),west:Y(null),east:Y(null),southWest:Y(null),south:Y(null),southEast:Y(null)}},l={startingMouse:null,startingPosition:null,mouseDown:T=>{T.button==0&&(T.preventDefault(),l.startingMouse={x:T.clientX,y:T.clientY},l.startingPosition=d.value,document.addEventListener("mousemove",l.mouseMove),document.addEventListener("mouseup",l.mouseUp))},mouseMove:T=>{!l.startingMouse||!l.startingPosition||(T.preventDefault(),d.value={x:Math.min(Math.max(l.startingPosition.x+T.clientX-l.startingMouse.x,0),document.body.clientWidth-I.value.width),y:Math.min(Math.max(l.startingPosition.y+T.clientY-l.startingMouse.y,0),document.body.clientHeight-I.value.height)})},mouseUp:T=>{T.button!=0||!l.startingMouse||!l.startingPosition||(T.preventDefault(),l.startingMouse=null,l.startingPosition=null,document.removeEventListener("mousemove",l.mouseMove),document.removeEventListener("mouseup",l.mouseUp))}};function v(T){return{id:o,icon:r.icon,title:r.title,pid:r.pid,data:T??r.tag}}const y=Be(()=>xt.value.get(o)!==-1),h=Y(!1),f=Y(!0);function L(){i("minimize",v()),mt.minimizeWindowPanel(o)}function A(){h.value=!h.value}function D(){i("close",v(!1)),mt.removeWindowPanel(o),f.value=!1}const P=Be(()=>h.value?"heroicons-outline:square-2-stack":"ant-design:border-outlined"),$={id:o,isShow:y,close:D,open:function(){i("open",v(!0)),f.value=!0},showHidePanel:L};function O(T){if(xo(T))return T;{const q=Number(T);if(q==q)return q;if(T.endsWith("px")){const H=T.substring(0,T.length-2);return Number(H)}if(T.endsWith("%")){const H=T.substring(0,T.length-1);return Number(H)/100*document.body.clientWidth}return 300}}return e($),Wn(()=>{(function(){let T=90;if(r.hasMin||(T-=30),r.hasMax||(T-=30),r.hasClose||(T-=30),de.setCssVar("--right-bar-width",T+"px",a.value),!a.value)return;const q=xo(r.titleHeight)?r.titleHeight+"px":r.titleHeight;a.value.style.height=q,a.value.style.lineHeight=q})(),function(){const T=v($);mt.addWindowPanel(T),i("loaded",T)}(),d.value.x=O(r.left),d.value.y=O(r.top),N(d.value),I.value={width:O(r.nWidth),height:O(r.nHeight)},k(I.value),g.mount()}),Yi(()=>{mt.removeWindowPanel(o)}),(T,q)=>(X(),ne(vr,{appear:"","enter-active-class":"animated zoomIn","leave-active-class":"animated zoomOut"},{default:Ce(()=>[f.value?yr((X(),fe("div",{key:0,ref_key:"dragPanelRef",ref:s,class:Me(["dragWindowPanel",{maxPanel:h.value,dragWindowPanel_dark:u.value}])},[G("div",{class:"dragPanelTitle",ref_key:"dragPanelTitleRef",ref:a,onMousedown:q[0]||(q[0]=(...H)=>l.mouseDown&&l.mouseDown(...H))},[ce(T.$slots,"title",{},()=>[r.icon?(X(),fe("img",{key:0,src:r.icon,width:"24",height:"24"},null,8,La)):se("v-if",!0),r.title?(X(),fe("span",za,Bn(r.title),1)):se("v-if",!0)]),G("div",Aa,[n.hasMin?(X(),ne(en(yn),{key:0,icon:"ant-design:minus-outlined",onClick:L})):se("v-if",!0),n.hasMax?(X(),ne(en(yn),{key:1,icon:P.value,onClick:A},null,8,["icon"])):se("v-if",!0),n.hasClose?(X(),ne(en(yn),{key:2,icon:"ant-design:close-outlined",onClick:D})):se("v-if",!0)])],544),G("div",Da,[ce(T.$slots,"default")]),G("div",Na,[G("div",{class:"cursor-nw-resize",ref:g.refs.northWest},null,512),G("div",{class:"cursor-n-resize",ref:g.refs.north},null,512),G("div",{class:"cursor-ne-resize",ref:g.refs.northEast},null,512),G("div",{class:"cursor-w-resize",ref:g.refs.west},null,512),q[1]||(q[1]=G("span",{style:{"pointer-events":"all",visibility:"hidden"}},null,-1)),G("div",{class:"cursor-e-resize",ref:g.refs.east},null,512),G("div",{class:"cursor-sw-resize",ref:g.refs.southWest},null,512),G("div",{class:"cursor-s-resize",ref:g.refs.south},null,512),G("div",{class:"cursor-se-resize",ref:g.refs.southEast},null,512)])],2)),[[wr,y.value]]):se("v-if",!0)]),_:3}))}});pr.__scopeId="data-v-39ea9741",pr.__file="src/controls/xwindow/XWindow.vue";const He={Login:"/api/User/Login",ChangeMyPwd:"/api/User/ChangeMyPwd",Logout:"/api/Check/ExitLogin",RefreshToken:"/api/Check/RefreshToken",CheckToken:"/api/Check/CheckToken",GetSystemRights:"/api/System/GetSystem"},jn="access_token",$a=W.Config.ServiceURL.LoginAuthURL;function gr(){const n=ds();n&&Fe(He.RefreshToken,$a,{refreshToken:n}).then(e=>{ei(e.data)})}function ja(){const n=De.getJsonObject(jn);if(!n)return;const e=new Date().getTime(),t=new Date(n.expire).getTime()-e;t>0&&(t<=5e3?gr():setTimeout(gr,t-5e3))}function ei(n){const e=new Date().getTime();let t=new Date(n.accessToken.expires).getTime()-e;if((t>=36e5||t<-6e5)&&(t=18e5),t>0){let o=qe();o?(o.token=n.accessToken.tokenContent,o.expire=n.accessToken.expires,o.refresh=n.refreshToken.tokenContent):o={token:n.accessToken.tokenContent,expire:n.accessToken.expires,refresh:n.refreshToken.tokenContent},De.set(jn,o,t/1e3),ja()}else De.remove(jn)}const On="Wm314243",Bt=W.Config.ServiceURL.LoginAuthURL;async function tc(n){const e={username:n.username,pwd:kn.encryptToString(n.pwd,On)},t=(await Fe(He.Login,Bt,e))?.data;return t&&ei(t.doubletoken),t}function nc(n){const e={oldpwd:kn.encryptToString(n.oldpwd,On),newpwd:kn.encryptToString(n.newpwd,On)};return Fe(He.ChangeMyPwd,Bt,e)}function oc(){const n=qe();n&&(fs(He.Logout,Bt,{token:n.token,reftoken:n.refresh}),Mr())}function rc(n){return Fe(He.CheckToken,Bt,{token:n})}const Gn="ROLE_SYSTEM_RIGHT",Qn=new kr("",sessionStorage);function Oa(){return Qn.get(Gn)}function mr(n){Qn.set(Gn,n)}function Wa(){Qn.remove(Gn)}function Ze(n){if(n)for(let e=0;e<n.length;e++){const t=n[e];t.children&&t.children.length>0?(Ze(t.children),t.children.length===0&&(n.splice(e,1),e--)):t.selected||(n.splice(e,1),e--)}}function ti(n,e,t="name"){n&&e&&n.forEach(o=>{const r=e.find(i=>i[t]===o[t]);r&&(o.children?r.children&&ti(o.children,r.children,t):(!r.children||r.children.length===0)&&r.selected&&(o.selected=r.selected))})}function vt(n,e,t,o="name"){const r=n[t],i=e[t];r?i&&ti(r,i,o):i&&(n[t]=i)}function Ba(n){if(n&&n.length>0){const e=n.length;let t,o=!1;if(e>0){o=Un(n[0]);const r=o?n[0]:JSON.parse(n[0]);if(e>1)for(let i=1;i<n.length;i++){const s=n[i],a=o?s:JSON.parse(s);vt(r,a,"routes","name"),vt(r,a,"widgetMenu","name"),vt(r,a,"widgets","id"),vt(r,a,"functions","id")}t=r}return t&&(Ze(t.routes),Ze(t.widgetMenu),Ze(t.widgets),Ze(t.functions)),t}}const wn=[],bn=[];function ni(){return Oa()}async function ic(n,e=!1){Wa();const t=He.GetSystemRights,o=W.Config.ServiceURL.LoginAuthURL,r=await Fe(t,o,{systemid:n});if(!r||!r.data)return void W.Message?.warn("无法获取功能授权列表！");const i=r.data;if(i&&i.length>0){if(e){const s=JSON.parse(i[0]);return mr(s),s}{const s=Ba(i);return mr(s),s}}}function oi(n,e){const t={...n};return t.meta||(t.meta={}),e.index!=null&&(t.meta.index=e.index),e.title!=null&&(t.meta.title=e.title),n.children&&(t.children=[],e.children&&e.children.forEach(o=>{const r=n.children?.find(i=>i.path===o.path);if(r){const i=oi(r,o);i&&t.children?.push(i)}})),t}function sc(n,e=2){if(e===0)return n;const t=ni();return t&&t.routes?(bn.length>0||n.forEach(o=>{const r=t.routes?.find(i=>i.name===o.name);if(r){const i=oi(o,r);i&&bn.push(i)}}),bn):void 0}function ac(n,e=2){if(e===0)return n;const t=ni();return t&&t.widgets?(wn.length>0||n?.forEach(o=>{t.widgets?.find(r=>r.id===o.id)&&wn.push(o)}),wn):void 0}export{kr as A,pr as E,_o as I,Qa as J,Ga as K,Ya as L,qe as N,ja as O,oc as Q,ss as R,ei as T,Wa as U,Xa as V,_s as X,nc as Y,Ja as a,gn as b,Za as c,mt as d,ic as e,de as f,tc as g,he as h,Br as i,W as j,ec as k,pe as l,Ka as m,sc as n,Fe as o,ni as p,ac as r,rc as t,Va as w,xo as z};
