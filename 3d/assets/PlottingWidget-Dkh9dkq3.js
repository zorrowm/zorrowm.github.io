import{J as S,G as P,K as M,L,O as b,T as R,V as A,W as z,z as H,A as B,X,Y as F,B as K}from"./vendor-6kqmRazU.js";import{_ as O,f as G}from"./index-CTmLOYTS.js";import{W as Q}from"./WidgetsEvent-TR_R_5Fb.js";import{j as h,E as q,d as j}from"./xframelib-exp-CPl8XRlL.js";import{a as k,R as T,M as D,L as m,N as W,Q as u,a1 as p,d as N,r as E,v as Z,z as Y,G as J,V as $,a8 as ee,$ as te,X as ie}from"./@vue-exp-BA8o4xMK.js";import"./@hprose-exp-BDOQuVAD.js";import"./vue-router-exp-BxGuMefC.js";import"./axios-exp-BH40TtQM.js";const U=[{count:"5",label:"点及文字",list:[{id:"point",label:"点",img:""},{id:"pointwithtext",label:"点(标注)",img:""},{id:"definedpointwithtext",label:"自定义点(标注)",img:""},{id:"definedpoint",label:"自定义点",img:""},{id:"alltext",label:"文本",img:""}]},{count:"8",label:"二维线面类",list:[{id:"polyline",label:"线",img:""},{id:"polygon",label:"多边形",img:""},{id:"curve",label:"曲线",img:""},{id:"rectangle",label:"长方形",img:""},{id:"square",label:"正方形",img:""},{id:"circle",label:"圆",img:""},{id:"ellipse",label:"椭圆",img:""},{id:"sector",label:"扇形",img:""}]},{count:"8",label:"三维立体类",list:[{id:"polylineVolume",label:"管道",img:""},{id:"corridor",label:"走廊",img:""},{id:"wall",label:"墙",img:""},{id:"rectangleVolume",label:"长方体",img:""},{id:"squareVolume",label:"立方体",img:""},{id:"circleVolume",label:"圆柱体",img:""},{id:"ellipseVolume",label:"椭圆柱体",img:""},{id:"cylinder",label:"圆锥",img:""},{id:"halfSphere",label:"半球",img:""}]},{count:"0",label:"态势标绘",list:[]},{count:"1",label:"小模型",list:[{id:"plane",label:"飞机",img:""}]}];function w(d,e){this._definitionChanged=new Cesium.Event,this.duration=d,this.image=e,this._time=performance.now()}Object.defineProperties(w.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration")});w.prototype.getType=function(d){return"Spriteline1"};w.prototype.getValue=function(d,e){return Cesium.defined(e)||(e={}),e.image=this.image,e.time=(performance.now()-this._time)%this.duration/this.duration,e};w.prototype.equals=function(d){return this===d||d instanceof w&&this.duration===d.duration};Cesium.Material.Spriteline1Type="Spriteline1";Cesium.Material.Spriteline1Source=`
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));
material.alpha = colorImage.a;
material.diffuse = colorImage.rgb * 1.5 ;
return material;
}
`;Cesium.Material._materialCache.addMaterial(Cesium.Material.Spriteline1Type,{fabric:{type:Cesium.Material.Spriteline1Type,uniforms:{color:new Cesium.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:Cesium.Material.Spriteline1Source},translucent:function(d){return!0}});class g{constructor(e){this.viewer=e}getCatesian3FromPX(e){if(this.viewer&&e){var i=this.viewer.scene.drillPick(e),t=null,n=!1,o=!1;for(let s in i){let C=i[s];if((C&&C.primitive instanceof Cesium.Cesium3DTileFeature||C&&C.primitive instanceof Cesium.Cesium3DTileset||C&&C.primitive instanceof Cesium.Model)&&(n=!0),n&&(this.viewer.scene.pick(e),t=this.viewer.scene.pickPosition(e),t)){let a=Cesium.Cartographic.fromCartesian(t);a.height<0&&(a.height=0);let f=Cesium.Math.toDegrees(a.longitude),y=Cesium.Math.toDegrees(a.latitude),v=a.height;t=this.transformWGS84ToCartesian({lng:f,lat:y},v)}}let r=this.viewer.terrainProvider instanceof Cesium.EllipsoidTerrainProvider;if(!n&&!r){var l=this.viewer.scene.camera.getPickRay(e);if(!l)return null;t=this.viewer.scene.globe.pick(l,this.viewer.scene),o=!0}if(!n&&!o&&r&&(t=this.viewer.scene.camera.pickEllipsoid(e,this.viewer.scene.globe.ellipsoid)),t){let s=this.transformCartesianToWGS84(t);return s.alt<0&&(t=this.transformWGS84ToCartesian(s,.1)),t}return!1}}transformWGS84ToCartesian(e,i){if(this.viewer)return e?Cesium.Cartesian3.fromDegrees(e.lng||e.lon,e.lat,e.alt=i||e.alt,Cesium.Ellipsoid.WGS84):Cesium.Cartesian3.ZERO}transformCartesianToWGS84(e){if(this.viewer&&e){var i=Cesium.Ellipsoid.WGS84,t=i.cartesianToCartographic(e);return{lng:Cesium.Math.toDegrees(t.longitude),lat:Cesium.Math.toDegrees(t.latitude),alt:t.height}}}dragMove(){let e=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);e.setInputAction(i=>{var t=this.getCatesian3FromPX(i.position);if(t){polygonPoints.push(t.clone()),polygonPoints.length===1&&polygonPoints.push(t.clone());var n=this.viewer.entities.add({id:"point"+polygonPoints.length,position:t,point:{color:Cesium.Color.RED,pixelSize:10}});pointEntities.push(n);let o=t.clone(),l=Cesium.Cartographic.fromCartesian(o);allPoints.push([Cesium.Math.toDegrees(l.longitude),Cesium.Math.toDegrees(l.latitude),l.height])}},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.setInputAction(i=>{var t=this.getCatesian3FromPX(i.endPosition);polygonPoints.length>=2&&t&&t.x&&(polygonPoints.pop(),polygonPoints.push(t))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),e.setInputAction(()=>{if(polygonPoints[polygonPoints.length-1],e.destroy(),polygonPoints.length>1){polygonPoints.pop(),allPoints.pop(),allPoints.push(allPoints[0]);var i=this.viewer.entities.getById("point"+(polygonPoints.length+1));i&&this.viewer.entities.remove(i);var t=this.viewer.entities.getById("point1");t&&this.viewer.entities.remove(t)}this.viewer.entities.remove(drawingLine);let n=null,o=-1;var l=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);l.setInputAction(r=>{const s=this.viewer.scene.pick(r.position);Cesium.defined(s)&&pointEntities.includes(s.id)&&(n=s.id,o=pointEntities.indexOf(n),this.viewer.scene.screenSpaceCameraController.enableRotate=!1,this.viewer.scene.screenSpaceCameraController.enableTranslate=!1,this.viewer.scene.screenSpaceCameraController.enableZoom=!1,this.viewer.scene.screenSpaceCameraController.enableTilt=!1,this.viewer.scene.screenSpaceCameraController.enableLook=!1)},Cesium.ScreenSpaceEventType.LEFT_DOWN),l.setInputAction(r=>{if(n){const s=this.getCatesian3FromPX(r.endPosition);s&&o!==-1&&(n.position=s,polygonPoints[o]=s,(o===0||o===polygonPoints.length-2)&&(polygonPoints[polygonPoints.length-1]=s,pointEntities[polygonPoints.length-1].position.setValue(s)))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),l.setInputAction(()=>{n=null,o=-1,this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTranslate=!0,this.viewer.scene.screenSpaceCameraController.enableZoom=!0,this.viewer.scene.screenSpaceCameraController.enableTilt=!0,this.viewer.scene.screenSpaceCameraController.enableLook=!0},Cesium.ScreenSpaceEventType.LEFT_UP)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}}class le{constructor(e){this.viewer=e,this._point=null,this._pointData=null,this._entities=[],this.publicTool=new g(e)}get point(){return this._point}loadPoint(e){return this.createPoint(e)}getData(){return this._pointData}startCreate(){const e=this;this.handler=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.handler.setInputAction(function(i){const t=e.publicTool.getCatesian3FromPX(i.position);if(!t)return;const n=e.createPoint(t);e._pointData=t,e._point=n},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(()=>{this.destroy(),this.handler=null},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}createPoint(e){const i=this,t=this.viewer.entities.add({position:e,point:{pixelSize:10,color:Cesium.Color.YELLOW}});return i._entities.push(t),t}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}clear(){for(let e=0;e<this._entities.length;e++)this.viewer.entities.remove(this._entities[e]);this._entities=[],this._point=null}}class ne{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=[],t=e.entities.add({Id:"drawingPolyline",name:"画线",polyline:{positions:new Cesium.CallbackProperty(()=>i,!1),width:2,material:Cesium.Color.BLUE}}),n=e.entities.add({polyline:{positions:new Cesium.CallbackProperty(()=>o&&l?[o,l]:[],!1),width:2,material:new Cesium.PolylineDashMaterialProperty({color:Cesium.Color.BLUE,dashLength:20})}}),o=null,l=null;this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(r=>{let s=this.publicTool.getCatesian3FromPX(r.position);s&&(i.push(s),o=s,e.entities.add({position:s,point:{color:Cesium.Color.RED,pixelSize:10}}))},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.tooltip.enable=!0,e.on(Cesium.ScreenSpaceEventType.MOUSE_MOVE,r=>{e.tooltip.showAt(r.windowPosition,"鼠标左键新增节点，右键停止绘制")}),this.handler.setInputAction(r=>{l=this.publicTool.getCatesian3FromPX(r.endPosition)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(()=>{this.handler.destroy(),this.handler=null,e.entities.remove(n);const r=new w(1e3,"/img/spriteline.png");t.polyline.material=r,n.polyline.material=r,e.tooltip.enable=!1},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null,this.viewer.tooltip.enable=!1)}}class oe{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=null,t=10;e.scene.globe.depthTestAgainstTerrain=!1;let n=e.entities.add({name:"画圆",ellipse:{semiMinorAxis:new Cesium.CallbackProperty(()=>t,!1),semiMajorAxis:new Cesium.CallbackProperty(()=>t,!1),material:Cesium.Color.BLUE.withAlpha(.2),outline:!0,outlineColor:Cesium.Color.RED,outlineWidth:2,fill:!0}});this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(o=>{var l=this.publicTool.getCatesian3FromPX(o.position);l&&i===null&&(i=l,n.position=i,e.entities.add({position:l,point:{color:Cesium.Color.RED,pixelSize:10}})),this.handler.setInputAction(()=>{if(i!==null&&t>0){this.handler.destroy(),this.handler=null;let r=Cesium.Cartographic.fromCartesian(i);Cesium.Math.toDegrees(r.longitude),Cesium.Math.toDegrees(r.latitude)}},Cesium.ScreenSpaceEventType.LEFT_CLICK)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(o=>{if(i){let l=this.publicTool.getCatesian3FromPX(o.endPosition);l&&(t=Cesium.Cartesian3.distance(i,l))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class re{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=null,t=null;e.entities.add({name:"画矩形",rectangle:{coordinates:new Cesium.CallbackProperty(()=>{if(i===null||t===null)return;let n,o;i.latitude-t.latitude>0?(n=i.latitude,o=t.latitude):(n=t.latitude,o=i.latitude);let l,r;return i.longitude-t.longitude>0?(r=i.longitude,l=t.longitude):(r=t.longitude,l=i.longitude),new Cesium.Rectangle(l,o,r,n)},!1),material:Cesium.Color.BLUE.withAlpha(.2),closeTop:!0,closeBottom:!1}}),this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(n=>{var o=this.publicTool.getCatesian3FromPX(n.position);o&&(i===null&&(i=Cesium.Cartographic.fromCartesian(o)),e.entities.add({position:o,point:{color:Cesium.Color.RED,pixelSize:10}})),this.handler.setInputAction(l=>{if(i!==null&&t!==null){var r=this.publicTool.getCatesian3FromPX(l.position);e.entities.add({position:r,point:{color:Cesium.Color.RED,pixelSize:10}}),this.handler.destroy(),this.handler=null,i.latitude-t.latitude>0?(Cesium.Math.toDegrees(i.latitude),Cesium.Math.toDegrees(t.latitude)):(Cesium.Math.toDegrees(t.latitude),Cesium.Math.toDegrees(i.latitude)),i.longitude-t.longitude>0?(Cesium.Math.toDegrees(i.longitude),Cesium.Math.toDegrees(t.longitude)):(Cesium.Math.toDegrees(t.longitude),Cesium.Math.toDegrees(i.longitude))}},Cesium.ScreenSpaceEventType.LEFT_CLICK)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(n=>{i&&(t=Cesium.Cartographic.fromCartesian(this.publicTool.getCatesian3FromPX(n.endPosition)))},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class se{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e),this.allPoints=[]}startCreate(){let e=this.viewer,i=[];e.entities.add({name:"画多边形",polygon:{hierarchy:new Cesium.CallbackProperty(()=>new Cesium.PolygonHierarchy(i),!1),material:Cesium.Color.BLUE.withAlpha(.2),perPositionHeight:!1}}),e.entities.add({name:"画线",polyline:{positions:new Cesium.CallbackProperty(()=>i,!1),width:3,material:Cesium.Color.BLUE}}),this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(t=>{var n=this.publicTool.getCatesian3FromPX(t.position);if(n){i.push(n.clone()),i.length===1&&i.push(n.clone()),e.entities.add({position:n,point:{color:Cesium.Color.RED,pixelSize:10}});let o=n.clone(),l=Cesium.Cartographic.fromCartesian(o);this.allPoints.push([Cesium.Math.toDegrees(l.longitude),Cesium.Math.toDegrees(l.latitude),l.height])}},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.tooltip.enable=!0,e.on(Cesium.ScreenSpaceEventType.MOUSE_MOVE,t=>{e.tooltip.showAt(t.windowPosition,"鼠标左键新增节点，右键停止绘制")}),this.handler.setInputAction(t=>{var n=this.publicTool.getCatesian3FromPX(t.endPosition);i.length>=2&&n&&n.x&&(i.pop(),i.push(n))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(()=>{i.pop(),i.push(i[0]),this.handler.destroy(),this.handler=null,e.tooltip.enable=!1},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class ae{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=null,t=null;e.entities.add({name:"画矩形",rectangle:{coordinates:new Cesium.CallbackProperty(()=>{if(i===null||t===null)return;let n,o;i.latitude-t.latitude>0?(n=i.latitude,o=t.latitude):(n=t.latitude,o=i.latitude);let l,r;return i.longitude-t.longitude>0?(r=i.longitude,l=t.longitude):(r=t.longitude,l=i.longitude),new Cesium.Rectangle(l,o,r,n)},!1),extrudedHeight:100,material:Cesium.Color.BLUE.withAlpha(.2),outline:!0,outlineColor:Cesium.Color.BLUE.withAlpha(.5),closeTop:!0,closeBottom:!1}}),this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(n=>{const o=this.publicTool.getCatesian3FromPX(n.position);o&&(i===null&&(i=Cesium.Cartographic.fromCartesian(o)),e.entities.add({position:o,point:{color:Cesium.Color.RED,pixelSize:10}})),this.handler.setInputAction(l=>{if(i!==null&&t!==null){const r=this.publicTool.getCatesian3FromPX(l.position);e.entities.add({position:r,point:{color:Cesium.Color.RED,pixelSize:10}}),this.handler.destroy(),this.handler=null;let s,C;i.latitude-t.latitude>0?(s=Cesium.Math.toDegrees(i.latitude),C=Cesium.Math.toDegrees(t.latitude)):(s=Cesium.Math.toDegrees(t.latitude),C=Cesium.Math.toDegrees(i.latitude));let a,f;i.longitude-t.longitude>0?(f=Cesium.Math.toDegrees(i.longitude),a=Cesium.Math.toDegrees(t.longitude)):(f=Cesium.Math.toDegrees(t.longitude),a=Cesium.Math.toDegrees(i.longitude));let y=Cesium.Cartesian3.fromDegrees((f-a)/2+a,(s-C)/2+C,100);e.entities.add({position:y,point:{color:Cesium.Color.BLUE,pixelSize:10}})}},Cesium.ScreenSpaceEventType.LEFT_CLICK)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(n=>{i&&(t=Cesium.Cartographic.fromCartesian(this.publicTool.getCatesian3FromPX(n.endPosition)))},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class ue{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=[];e.entities.add({Id:"drawingCorridor",name:"绘制走廊",corridor:new Cesium.CorridorGraphics({extrudedHeight:100,width:100,material:Cesium.Color.BLUE.withAlpha(.5),positions:new Cesium.CallbackProperty(()=>i,!1)})});let t=e.entities.add({corridor:new Cesium.CorridorGraphics({extrudedHeight:100,width:100,material:Cesium.Color.BLUE.withAlpha(.5),positions:new Cesium.CallbackProperty(()=>n&&o?[n,o]:[],!1)})}),n=null,o=null;this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(l=>{let r=this.publicTool.getCatesian3FromPX(l.position);r&&(i.push(r),n=r,e.entities.add({position:r,point:{color:Cesium.Color.RED,pixelSize:10}}))},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.tooltip.enable=!0,e.on(Cesium.ScreenSpaceEventType.MOUSE_MOVE,l=>{e.tooltip.showAt(l.windowPosition,"鼠标左键新增节点，右键停止绘制")}),this.handler.setInputAction(l=>{o=this.publicTool.getCatesian3FromPX(l.endPosition)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(()=>{this.handler.destroy(),this.handler=null,e.entities.remove(t),e.tooltip.enable=!1},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class de{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(){let e=this.viewer,i=[];e.entities.add({Id:"drawingCorridor",name:"绘制走廊",wall:new Cesium.WallGraphics({material:new DynamicWallMaterialProperty({color:Cesium.Color.fromBytes(55,96,56).withAlpha(.7),duration:3e3}),maximumHeights:new Cesium.CallbackProperty(()=>new Array(i.length).fill(100),!1),minimumHeights:new Cesium.CallbackProperty(()=>new Array(i.length).fill(0),!1),positions:new Cesium.CallbackProperty(()=>i,!1)})});let t=e.entities.add({wall:new Cesium.WallGraphics({material:Cesium.Color.BLUE.withAlpha(.5),maximumHeights:new Cesium.CallbackProperty(()=>n&&o?[100,100]:[],!1),minimumHeights:new Cesium.CallbackProperty(()=>n&&o?[0,0]:[],!1),positions:new Cesium.CallbackProperty(()=>n&&o?[n,o]:[],!1)})}),n=null,o=null;this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(l=>{let r=this.publicTool.getCatesian3FromPX(l.position);r&&(i.push(r),n=r,e.entities.add({position:r,point:{color:Cesium.Color.RED,pixelSize:10}}))},Cesium.ScreenSpaceEventType.LEFT_CLICK),e.tooltip.enable=!0,e.on(Cesium.ScreenSpaceEventType.MOUSE_MOVE,l=>{e.tooltip.showAt(l.windowPosition,"鼠标左键新增节点，右键停止绘制")}),this.handler.setInputAction(l=>{o=this.publicTool.getCatesian3FromPX(l.endPosition)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(()=>{this.handler.destroy(),this.handler=null,e.entities.remove(t),e.tooltip.enable=!1},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class x{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e),this.drawType="circleVolume"}startCreate(){let e=this.viewer,i=null,t=10;e.scene.globe.depthTestAgainstTerrain=!1;let n=e.entities.add({name:"画圆柱体",cylinder:{length:100,bottomRadius:new Cesium.CallbackProperty(()=>t,!1),material:Cesium.Color.BLUE.withAlpha(.2)}});this.handler=new Cesium.ScreenSpaceEventHandler(e.canvas),this.handler.setInputAction(o=>{var l=this.publicTool.getCatesian3FromPX(o.position);if(l&&i===null){let s=Cesium.Cartographic.fromCartesian(l);s.height+=50;var r=Cesium.Ellipsoid.WGS84;i=r.cartographicToCartesian(s),n.position=i,this.drawType==="circleVolume"?n.cylinder.topRadius=new Cesium.CallbackProperty(()=>t,!1):this.drawType==="cylinder"&&(n.cylinder.topRadius=0),e.entities.add({position:l,point:{color:Cesium.Color.RED,pixelSize:10}})}this.handler.setInputAction(()=>{if(i!==null&&t>0){this.handler.destroy(),this.handler=null;let s=Cesium.Cartographic.fromCartesian(i);Cesium.Math.toDegrees(s.longitude),Cesium.Math.toDegrees(s.latitude)}},Cesium.ScreenSpaceEventType.LEFT_CLICK)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(o=>{if(i){let l=this.publicTool.getCatesian3FromPX(o.endPosition);l&&(t=Cesium.Cartesian3.distance(i,l))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}setStyle(e){this.drawType=e.drawType}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}class ce{constructor(e){this.viewer=e,this._entities=[],this.publicTool=new g(e)}startCreate(e){let i=this.viewer,t=null,n=10;i.scene.globe.depthTestAgainstTerrain=!1;let o=i.entities.add({name:"画圆柱体",ellipsoid:{radii:new Cesium.CallbackProperty(()=>new Cesium.Cartesian3(n,n,n),!1),maximumCone:Cesium.Math.PI/2,material:Cesium.Color.BLUE.withAlpha(.2)}});this.handler=new Cesium.ScreenSpaceEventHandler(i.canvas),this.handler.setInputAction(l=>{var r=this.publicTool.getCatesian3FromPX(l.position);r&&t===null&&(t=r,o.position=t,i.entities.add({position:r,point:{color:Cesium.Color.RED,pixelSize:10}})),this.handler.setInputAction(()=>{if(t!==null&&n>0){this.handler.destroy(),this.handler=null;let s=Cesium.Cartographic.fromCartesian(t);Cesium.Math.toDegrees(s.longitude),Cesium.Math.toDegrees(s.latitude)}},Cesium.ScreenSpaceEventType.LEFT_CLICK)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(l=>{if(t){let r=this.publicTool.getCatesian3FromPX(l.endPosition);r&&(n=Cesium.Cartesian3.distance(t,r))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}destroy(){this.handler&&(this.handler.destroy(),this.handler=null)}}const me={__name:"PlotEditWidget",setup(d,{expose:e}){e();const t={formData:k({type:"",size:10,color:"#FF00FF",isBorder:!1,borderColor:"#FF00FF",borderWidth:1,isScale:!1,isClamptoGround:!1,isOccluded:!1}),reactive:k};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}},pe={class:"column"},he={class:"row items-center q-mb-md"},Ce={class:"label"},ge={class:"row items-center q-mb-md"},fe={class:"row items-center q-mb-md"},we={class:"row items-center q-mb-md"},ye={class:"row items-center q-mb-md"};function ve(d,e,i,t,n,o){return T(),D("div",pe,[m("div",he,[e[11]||(e[11]=m("div",{class:"label"},"样式类型",-1)),m("div",Ce,W(t.formData.type),1)]),u(S,{outlined:"",dense:"",modelValue:t.formData.size,"onUpdate:modelValue":e[0]||(e[0]=l=>t.formData.size=l),type:"number",color:"grey"},{before:p(()=>e[12]||(e[12]=[m("div",null,"像素大小",-1)])),_:1},8,["modelValue"]),u(S,{outlined:"",dense:"",modelValue:t.formData.size,"onUpdate:modelValue":e[1]||(e[1]=l=>t.formData.size=l),type:"number",color:"grey"},{before:p(()=>e[13]||(e[13]=[m("div",null,"线宽",-1)])),_:1},8,["modelValue"]),u(S,{outlined:"",dense:"",modelValue:t.formData.color,"onUpdate:modelValue":e[3]||(e[3]=l=>t.formData.color=l),class:"my-input",color:"grey"},{before:p(()=>e[14]||(e[14]=[m("div",null,"颜色",-1)])),append:p(()=>[u(P,{name:"colorize",class:"cursor-pointer"},{default:p(()=>[u(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:p(()=>[u(L,{modelValue:t.formData.color,"onUpdate:modelValue":e[2]||(e[2]=l=>t.formData.color=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),m("div",ge,[e[15]||(e[15]=m("div",{class:"label"},"是否边框",-1)),u(b,{modelValue:t.formData.isBorder,"onUpdate:modelValue":e[4]||(e[4]=l=>t.formData.isBorder=l)},null,8,["modelValue"])]),u(S,{outlined:"",dense:"",modelValue:t.formData.borderColor,"onUpdate:modelValue":e[6]||(e[6]=l=>t.formData.borderColor=l),class:"my-input",color:"grey",disable:!t.formData.isBorder},{before:p(()=>e[16]||(e[16]=[m("div",null,"边框颜色",-1)])),append:p(()=>[u(P,{name:"colorize",class:"cursor-pointer"},{default:p(()=>[u(M,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:p(()=>[u(L,{modelValue:t.formData.borderColor,"onUpdate:modelValue":e[5]||(e[5]=l=>t.formData.borderColor=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","disable"]),u(S,{outlined:"",dense:"",modelValue:t.formData.borderWidth,"onUpdate:modelValue":e[7]||(e[7]=l=>t.formData.borderWidth=l),type:"number",color:"grey"},{before:p(()=>e[17]||(e[17]=[m("div",null,"边框宽度",-1)])),_:1},8,["modelValue"]),m("div",fe,[e[18]||(e[18]=m("div",{class:"label"},"是否按视距缩放",-1)),u(b,{modelValue:t.formData.isScale,"onUpdate:modelValue":e[8]||(e[8]=l=>t.formData.isScale=l)},null,8,["modelValue"])]),m("div",we,[e[19]||(e[19]=m("div",{class:"label"},"是否贴地",-1)),u(b,{modelValue:t.formData.isClamptoGround,"onUpdate:modelValue":e[9]||(e[9]=l=>t.formData.isClamptoGround=l)},null,8,["modelValue"])]),m("div",ye,[e[20]||(e[20]=m("div",{class:"label"},"是否被遮挡",-1)),u(b,{modelValue:t.formData.isOccluded,"onUpdate:modelValue":e[10]||(e[10]=l=>t.formData.isOccluded=l)},null,8,["modelValue"])])])}const Se=O(me,[["render",ve],["__scopeId","data-v-ccf09648"],["__file","PlotEditWidget.vue"]]),be="/img/background.png",Ee=N({__name:"PlottingWidget",setup(d,{expose:e}){const i=E("options"),t=E(U[0]);let n=E(""),o,l;function r(c){l=c.id}function s(c){o=c.pid,c.pid&&G(Q.WidgetClosed,o)}function C(c){let V="";return n.value&&c.id===n.value&&(V="cardSelected"),V}let a;async function f(c){switch(n.value=c.id,c.id){case"point":a=new le(h.CesiumViewer);break;case"polyline":a=new ne(h.CesiumViewer);break;case"curve":break;case"polygon":a=new se(h.CesiumViewer);break;case"rectangle":a=new re(h.CesiumViewer);break;case"circle":a=new oe(h.CesiumViewer);break;case"rectangleVolume":a=new ae(h.CesiumViewer);break;case"corridor":a=new ue(h.CesiumViewer);break;case"wall":a=new de(h.CesiumViewer);break;case"circleVolume":a=new x(h.CesiumViewer),a.setStyle({drawType:"circleVolume"});break;case"cylinder":a=new x(h.CesiumViewer),a.setStyle({drawType:"cylinder"});break;case"halfSphere":a=new ce(h.CesiumViewer);break;default:a&&(a.destroy(),a=null);break}a&&a.startCreate()}function y(){n.value="",h.CesiumViewer.entities.removeAll(),a.destroy()}Z(()=>{h.CesiumViewer&&(n.value=h.CesiumViewer.CurrentBasicID)});const v=E(!0);function _(c=!1){v.value=c,l&&c&&j.openWindowPanel(l)}e({changeVisible:_,isShow:v});const I={tab:i,currentType:t,defaultImg:be,get itemSelected(){return n},set itemSelected(c){n=c},get widgetID(){return o},set widgetID(c){o=c},get windowID(){return l},set windowID(c){l=c},loadedHandle:r,doClosePanel:s,getSelectedStyle:C,get drawTools(){return a},set drawTools(c){a=c},selectItem:f,handleClearAll:y,isShow:v,changeVisible:_,get XWindow(){return q},get plotOptions(){return U},PlotEditWidget:Se};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),Te={class:"q-py-md q-gutter-sm"},Pe={class:"row q-col-gutter-sm"},De={class:"text-center textContent"};function _e(d,e,i,t,n,o){return Y((T(),$(t.XWindow,{isDark:!0,top:"10px",left:"10px",nWidth:"380px",nHeight:"750px",title:"图上标绘",icon:"img/basicimage/arcgis_img.png",pid:"PlottingWidget",onLoaded:t.loadedHandle,onClose:t.doClosePanel},{default:p(()=>[u(K,{style:{height:"100%"}},{default:p(()=>[u(R,{modelValue:t.tab,"onUpdate:modelValue":e[1]||(e[1]=l=>t.tab=l),animated:""},{default:p(()=>[u(A,{name:"options"},{default:p(()=>[m("div",Te,[u(P,{name:"delete",color:"white",style:{"font-size":"26px",cursor:"pointer"},onClick:t.handleClearAll}),u(P,{name:"edit",color:"white",style:{"font-size":"26px",cursor:"pointer"}}),u(z,{filled:"",dense:"",color:"grey-14","bg-color":"grey-10",modelValue:t.currentType,"onUpdate:modelValue":e[0]||(e[0]=l=>t.currentType=l),options:t.plotOptions},null,8,["modelValue","options"])]),m("div",Pe,[(T(!0),D(ie,null,ee(t.currentType.list,(l,r)=>(T(),D("div",{class:"col-4",key:r},[u(H,{class:te(["cardContent",t.getSelectedStyle(l)]),onClick:s=>t.selectItem(l)},{default:p(()=>[u(B,{src:l.img?l.img:t.defaultImg,height:"75px"},null,8,["src"]),m("div",De,W(l.label),1)]),_:2},1032,["class","onClick"])]))),128))])]),_:1}),u(A,{name:"edit"},{default:p(()=>[u(t.PlotEditWidget)]),_:1})]),_:1},8,["modelValue"]),u(X,{modelValue:t.tab,"onUpdate:modelValue":e[2]||(e[2]=l=>t.tab=l),dense:"",align:"justify","narrow-indicator":"",style:{position:"absolute",bottom:"0",width:"100%",color:"#fff"}},{default:p(()=>[u(F,{name:"options",label:"绘制"}),u(F,{name:"edit",label:"编辑"})]),_:1},8,["modelValue"])]),_:1})]),_:1},512)),[[J,t.isShow]])}const xe=O(Ee,[["render",_e],["__scopeId","data-v-bf9b3040"],["__file","PlottingWidget.vue"]]);export{xe as default};
