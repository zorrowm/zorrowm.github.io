import{c4 as I,c5 as B,c3 as k,cm as G,cn as A,c8 as O,co as T,c9 as b,cp as R,cq as L}from"./vendor-CDV5M84i.js";import{d as z,v as V,M as E,L as $,R as q}from"./@vue-exp-YaP0LnBg.js";import{_ as F}from"./index-BTOrG-4i.js";import"./@hprose-exp-DifMA6AO.js";import"./xframelib-exp-CvTEfE5n.js";import"./axios-exp-BH40TtQM.js";import"./vue-router-exp-BeFgxScw.js";const H=z({__name:"ThreeObjectWidget",setup(P,{expose:p}){p();const o={viewer:null},t={renderer:null,camera:null,scene:null};let r=[115.23,39.55],n=[116.23,41.55];const l=[];class w{threeMesh=null;minWGS84=null;maxWGS84=null}function _(){x(),C(),W(),g()}function x(){o.viewer=new Cesium.Viewer("cesiumContainer",{useDefaultRenderLoop:!1,selectionIndicator:!1,infoBox:!1,navigationInstructionsInitiallyVisible:!1,fullscreenButton:!1,allowTextureFilterAnisotropic:!1,contextOptions:{webgl:{alpha:!1,antialias:!0,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!1,depth:!0,stencil:!1,anialias:!1}},targetFrameRate:60,resolutionScale:.1,orderIndependentTranslucency:!0,imageryProvider:void 0,baseLayerPicker:!1,automaticallyTrackDataSourceClocks:!1,dataSources:null,clock:null,terrainShadows:Cesium.ShadowMode.DISABLED});const e=Cesium.Cartesian3.fromDegrees((r[0]+n[0])/2,(r[1]+n[1])/2-1,2e5);o.viewer.camera.flyTo({destination:e,orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-60),roll:Cesium.Math.toRadians(0)},duration:3})}function C(){const e=document.querySelector("#threeContainer"),a=new I({canvas:e,alpha:!0,logarithmicDepthBuffer:!0,antialias:!0});var c=45,d=e.clientWidth,s=e.clientHeight,m=d/s,u=1,f=10*1e3*1e3;const i=new B(c,m,u,f),h=new k;t.renderer=a,t.scene=h,t.camera=i}function W(){const e={name:"Polygon",polygon:{hierarchy:Cesium.Cartesian3.fromDegreesArray([r[0],r[1],n[0],r[1],n[0],n[1],r[0],n[1]]),material:Cesium.Color.RED.withAlpha(.2)}};o.viewer.entities.add(e);for(var a=new G({side:A}),c=10,d=[],s=0;s<c;s++)d.push(new O(Math.sin(s*.2)*c+5,(s-5)*2));var m=new T(d),u=new b(m,a);u.scale.set(1500,1500,1500),u.position.z+=15e3,u.rotation.x=Math.PI/2;var f=new R;f.add(u),t.scene.add(f);var i=new w;i.threeMesh=f,i.minWGS84=r,i.maxWGS84=n,l.push(i),m=new L;var h=new b(m,new G);h.scale.set(1e4,1e4,1e4),h.position.z+=1e4,h.rotation.x=Math.PI/2;var M=new R;M.add(h),t.scene.add(M),i=new w,i.threeMesh=M,i.minWGS84=r,i.maxWGS84=n,l.push(i);for(const v in l){r=l[v].minWGS84,n=l[v].maxWGS84;const j=Cesium.Cartesian3.fromDegrees((r[0]+n[0])/2,(r[1]+n[1])/2),S=Cesium.Cartesian3.fromDegrees((r[0]+n[0])/2,(r[1]+n[1])/2,1);l[v].threeMesh.position.copy(j),l[v].threeMesh.lookAt(S.x,S.y,S.z)}}function y(){t.camera.matrixAutoUpdate=!1;const e=o.viewer.camera.viewMatrix,a=o.viewer.camera.inverseViewMatrix;t.camera.lookAt(0,0,0),t.camera.matrixWorld.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]),t.camera.matrixWorldInverse.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]);const c=t.renderer.domElement;t.renderer.setPixelRatio(window.devicePixelRatio);const d=c.clientWidth,s=c.clientHeight;(c.width!==d||c.height!==s)&&t.renderer.setSize(d,s,!1),t.camera.aspect=d/s,t.camera.fov=Cesium.Math.toDegrees(o.viewer.camera.frustum.fovy),t.camera.updateProjectionMatrix(),t.renderer.render(t.scene,t.camera)}function g(){o.viewer.render(),y(),requestAnimationFrame(g)}V(()=>{_()});const D={cesium:o,three:t,get minWGS84(){return r},set minWGS84(e){r=e},get maxWGS84(){return n},set maxWGS84(e){n=e},_3Dobjects:l,_3DObject:w,init:_,initCesium:x,initThreejs:C,init3DObject:W,threeRender:y,startRenderLoop:g};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),N={id:"cesiumContainer"};function Y(P,p,o,t,r,n){return q(),E("div",N,p[0]||(p[0]=[$("canvas",{id:"threeContainer"},null,-1)]))}const te=F(H,[["render",Y],["__scopeId","data-v-a0d4cfa8"],["__file","ThreeObjectWidget.vue"]]);export{te as default};
