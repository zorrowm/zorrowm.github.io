/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const e=Symbol("Comlink.proxy"),t=Symbol("Comlink.endpoint"),r=Symbol("Comlink.releaseProxy"),n=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),i=e=>"object"==typeof e&&null!==e||"function"==typeof e,s={canHandle:t=>i(t)&&t[e],serialize(e){const{port1:t,port2:r}=new MessageChannel;return f(e,t),[r,[r]]},deserialize:e=>(e.start(),function(e){const t=new Map;return e.addEventListener("message",function(e){const{data:r}=e;if(!r||!r.id)return;const n=t.get(r.id);if(n)try{n(r)}finally{t.delete(r.id)}}),m(e,t,[],void 0)}(e))},a=new Map([["proxy",s],["throw",{canHandle:e=>i(e)&&o in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function f(t,r=globalThis,i=["*"]){r.addEventListener("message",function s(a){if(!a||!a.data)return;if(!function(e,t){for(const r of e){if(t===r||"*"===r)return!0;if(r instanceof RegExp&&r.test(t))return!0}return!1}(i,a.origin))return void console.warn(`Invalid origin '${a.origin}' for comlink proxy`);const{id:l,type:c,path:h}=Object.assign({path:[]},a.data),p=(a.data.argumentList||[]).map(b);let m;try{const r=h.slice(0,-1).reduce((e,t)=>e[t],t),n=h.reduce((e,t)=>e[t],t);switch(c){case"GET":m=n;break;case"SET":r[h.slice(-1)[0]]=b(a.data.value),m=!0;break;case"APPLY":m=n.apply(r,p);break;case"CONSTRUCT":m=function(t){return Object.assign(t,{[e]:!0})}(new n(...p));break;case"ENDPOINT":{const{port1:e,port2:r}=new MessageChannel;f(t,r),m=function(e,t){return y.set(e,t),e}(e,[e])}break;case"RELEASE":m=void 0;break;default:return}}catch(e){m={value:e,[o]:0}}Promise.resolve(m).catch(e=>({value:e,[o]:0})).then(e=>{const[o,i]=g(e);r.postMessage(Object.assign(Object.assign({},o),{id:l}),i),"RELEASE"===c&&(r.removeEventListener("message",s),u(r),n in t&&"function"==typeof t[n]&&t[n]())}).catch(e=>{const[t,n]=g({value:new TypeError("Unserializable return value"),[o]:0});r.postMessage(Object.assign(Object.assign({},t),{id:l}),n)})}),r.start&&r.start()}function u(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function l(e){if(e)throw new Error("Proxy has been released and is not useable")}function c(e){return O(e,new Map,{type:"RELEASE"}).then(()=>{u(e)})}const h=new WeakMap,p="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(h.get(e)||0)-1;h.set(e,t),0===t&&c(e)});function m(e,n,o=[],i=function(){}){let s=!1;const a=new Proxy(i,{get(t,i){if(l(s),i===r)return()=>{!function(e){p&&p.unregister(e)}(a),c(e),n.clear(),s=!0};if("then"===i){if(0===o.length)return{then:()=>a};const t=O(e,n,{type:"GET",path:o.map(e=>e.toString())}).then(b);return t.then.bind(t)}return m(e,n,[...o,i])},set(t,r,i){l(s);const[a,f]=g(i);return O(e,n,{type:"SET",path:[...o,r].map(e=>e.toString()),value:a},f).then(b)},apply(r,i,a){l(s);const f=o[o.length-1];if(f===t)return O(e,n,{type:"ENDPOINT"}).then(b);if("bind"===f)return m(e,n,o.slice(0,-1));const[u,c]=d(a);return O(e,n,{type:"APPLY",path:o.map(e=>e.toString()),argumentList:u},c).then(b)},construct(t,r){l(s);const[i,a]=d(r);return O(e,n,{type:"CONSTRUCT",path:o.map(e=>e.toString()),argumentList:i},a).then(b)}});return function(e,t){const r=(h.get(t)||0)+1;h.set(t,r),p&&p.register(e,t,e)}(a,e),a}function d(e){const t=e.map(g);return[t.map(e=>e[0]),(r=t.map(e=>e[1]),Array.prototype.concat.apply([],r))];var r}const y=new WeakMap;function g(e){for(const[t,r]of a)if(r.canHandle(e)){const[n,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},o]}return[{type:"RAW",value:e},y.get(e)||[]]}function b(e){switch(e.type){case"HANDLER":return a.get(e.name).deserialize(e.value);case"RAW":return e.value}}function O(e,t,r,n){return new Promise(o=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(i,o),e.start&&e.start(),e.postMessage(Object.assign({id:i},r),n)})}function C(e){return null!=e}function E(e){let t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}C(Object.create)&&(E.prototype=Object.create(Error.prototype),E.prototype.constructor=E),E.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return C(this.stack)&&(e+=`\n${this.stack.toString()}`),e},E.throwInstantiationError=function(){throw new E("This function defines an interface and should not be called directly.")};const A={};function S(e,t,r){return`Expected ${r} to be typeof ${t}, actual typeof was ${e}`}var w,j;A.typeOf={},A.defined=function(e,t){if(!C(t))throw new E(function(e){return`${e} is required, actual value was undefined`}(e))},A.typeOf.func=function(e,t){if("function"!=typeof t)throw new E(S(typeof t,"function",e))},A.typeOf.string=function(e,t){if("string"!=typeof t)throw new E(S(typeof t,"string",e))},A.typeOf.number=function(e,t){if("number"!=typeof t)throw new E(S(typeof t,"number",e))},A.typeOf.number.lessThan=function(e,t,r){if(A.typeOf.number(e,t),t>=r)throw new E(`Expected ${e} to be less than ${r}, actual value was ${t}`)},A.typeOf.number.lessThanOrEquals=function(e,t,r){if(A.typeOf.number(e,t),t>r)throw new E(`Expected ${e} to be less than or equal to ${r}, actual value was ${t}`)},A.typeOf.number.greaterThan=function(e,t,r){if(A.typeOf.number(e,t),t<=r)throw new E(`Expected ${e} to be greater than ${r}, actual value was ${t}`)},A.typeOf.number.greaterThanOrEquals=function(e,t,r){if(A.typeOf.number(e,t),t<r)throw new E(`Expected ${e} to be greater than or equal to ${r}, actual value was ${t}`)},A.typeOf.object=function(e,t){if("object"!=typeof t)throw new E(S(typeof t,"object",e))},A.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new E(S(typeof t,"boolean",e))},A.typeOf.bigint=function(e,t){if("bigint"!=typeof t)throw new E(S(typeof t,"bigint",e))},A.typeOf.number.equals=function(e,t,r,n){if(A.typeOf.number(e,r),A.typeOf.number(t,n),r!==n)throw new E(`${e} must be equal to ${t}, the actual values are ${r} and ${n}`)};var F=function(){if(j)return w;j=1;var e=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};return e.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0},e.prototype.init_by_array=function(e,t){var r,n,o;for(this.init_seed(19650218),r=1,n=0,o=this.N>t?this.N:t;o;o--){var i=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(1664525*((4294901760&i)>>>16)<<16)+1664525*(65535&i))+e[n]+n,this.mt[r]>>>=0,n++,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1),n>=t&&(n=0)}for(o=this.N-1;o;o--)i=this.mt[r-1]^this.mt[r-1]>>>30,this.mt[r]=(this.mt[r]^(1566083941*((4294901760&i)>>>16)<<16)+1566083941*(65535&i))-r,this.mt[r]>>>=0,++r>=this.N&&(this.mt[0]=this.mt[this.N-1],r=1);this.mt[0]=2147483648},e.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var r;for(this.mti==this.N+1&&this.init_seed(5489),r=0;r<this.N-this.M;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+this.M]^e>>>1^t[1&e];for(;r<this.N-1;r++)e=this.mt[r]&this.UPPER_MASK|this.mt[r+1]&this.LOWER_MASK,this.mt[r]=this.mt[r+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random_int31=function(){return this.random_int()>>>1},e.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},e.prototype.random=function(){return this.random_int()*(1/4294967296)},e.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},e.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},w=e}(),z=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(F);const x={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};x.sign=Math.sign??function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1},x.signNotZero=function(e){return e<0?-1:1},x.toSNorm=function(e,t){return t=t??255,Math.round((.5*x.clamp(e,-1,1)+.5)*t)},x.fromSNorm=function(e,t){return t=t??255,x.clamp(e,0,t)/t*2-1},x.normalize=function(e,t,r){return 0===(r=Math.max(r-t,0))?0:x.clamp((e-t)/r,0,1)},x.sinh=Math.sinh??function(e){return(Math.exp(e)-Math.exp(-e))/2},x.cosh=Math.cosh??function(e){return(Math.exp(e)+Math.exp(-e))/2},x.lerp=function(e,t,r){return(1-r)*e+r*t},x.PI=Math.PI,x.ONE_OVER_PI=1/Math.PI,x.PI_OVER_TWO=Math.PI/2,x.PI_OVER_THREE=Math.PI/3,x.PI_OVER_FOUR=Math.PI/4,x.PI_OVER_SIX=Math.PI/6,x.THREE_PI_OVER_TWO=3*Math.PI/2,x.TWO_PI=2*Math.PI,x.ONE_OVER_TWO_PI=1/(2*Math.PI),x.RADIANS_PER_DEGREE=Math.PI/180,x.DEGREES_PER_RADIAN=180/Math.PI,x.RADIANS_PER_ARCSECOND=x.RADIANS_PER_DEGREE/3600,x.toRadians=function(e){if(!C(e))throw new E("degrees is required.");return e*x.RADIANS_PER_DEGREE},x.toDegrees=function(e){if(!C(e))throw new E("radians is required.");return e*x.DEGREES_PER_RADIAN},x.convertLongitudeRange=function(e){if(!C(e))throw new E("angle is required.");const t=x.TWO_PI,r=e-Math.floor(e/t)*t;return r<-Math.PI?r+t:r>=Math.PI?r-t:r},x.clampToLatitudeRange=function(e){if(!C(e))throw new E("angle is required.");return x.clamp(e,-1*x.PI_OVER_TWO,x.PI_OVER_TWO)},x.negativePiToPi=function(e){if(!C(e))throw new E("angle is required.");return e>=-x.PI&&e<=x.PI?e:x.zeroToTwoPi(e+x.PI)-x.PI},x.zeroToTwoPi=function(e){if(!C(e))throw new E("angle is required.");if(e>=0&&e<=x.TWO_PI)return e;const t=x.mod(e,x.TWO_PI);return Math.abs(t)<x.EPSILON14&&Math.abs(e)>x.EPSILON14?x.TWO_PI:t},x.mod=function(e,t){if(!C(e))throw new E("m is required.");if(!C(t))throw new E("n is required.");if(0===t)throw new E("divisor cannot be 0.");return x.sign(e)===x.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},x.equalsEpsilon=function(e,t,r,n){if(!C(e))throw new E("left is required.");if(!C(t))throw new E("right is required.");r=r??0,n=n??r;const o=Math.abs(e-t);return o<=n||o<=r*Math.max(Math.abs(e),Math.abs(t))},x.lessThan=function(e,t,r){if(!C(e))throw new E("first is required.");if(!C(t))throw new E("second is required.");if(!C(r))throw new E("absoluteEpsilon is required.");return e-t<-r},x.lessThanOrEquals=function(e,t,r){if(!C(e))throw new E("first is required.");if(!C(t))throw new E("second is required.");if(!C(r))throw new E("absoluteEpsilon is required.");return e-t<r},x.greaterThan=function(e,t,r){if(!C(e))throw new E("first is required.");if(!C(t))throw new E("second is required.");if(!C(r))throw new E("absoluteEpsilon is required.");return e-t>r},x.greaterThanOrEquals=function(e,t,r){if(!C(e))throw new E("first is required.");if(!C(t))throw new E("second is required.");if(!C(r))throw new E("absoluteEpsilon is required.");return e-t>-r};const I=[1];x.factorial=function(e){if("number"!=typeof e||e<0)throw new E("A number greater than or equal to 0 is required.");const t=I.length;if(e>=t){let r=I[t-1];for(let n=t;n<=e;n++){const e=r*n;I.push(e),r=e}}return I[e]},x.incrementWrap=function(e,t,r){if(r=r??0,!C(e))throw new E("n is required.");if(t<=r)throw new E("maximumValue must be greater than minimumValue.");return++e>t&&(e=r),e},x.isPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new E("A number between 0 and (2^32)-1 is required.");return 0!==e&&!(e&e-1)},x.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>2147483648)throw new E("A number between 0 and 2^31 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},x.previousPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new E("A number between 0 and (2^32)-1 is required.");return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,((e|=e>>32)>>>0)-(e>>>1)},x.clamp=function(e,t,r){return A.typeOf.number("value",e),A.typeOf.number("min",t),A.typeOf.number("max",r),e<t?t:e>r?r:e};let R=new z;function L(e,t,r){this.x=e??0,this.y=t??0,this.z=r??0}x.setRandomNumberSeed=function(e){if(!C(e))throw new E("seed is required.");R=new z(e)},x.nextRandomNumber=function(){return R.random()},x.randomBetween=function(e,t){return x.nextRandomNumber()*(t-e)+e},x.acosClamped=function(e){if(!C(e))throw new E("value is required.");return Math.acos(x.clamp(e,-1,1))},x.asinClamped=function(e){if(!C(e))throw new E("value is required.");return Math.asin(x.clamp(e,-1,1))},x.chordLength=function(e,t){if(!C(e))throw new E("angle is required.");if(!C(t))throw new E("radius is required.");return 2*t*Math.sin(.5*e)},x.logBase=function(e,t){if(!C(e))throw new E("number is required.");if(!C(t))throw new E("base is required.");return Math.log(e)/Math.log(t)},x.cbrt=Math.cbrt??function(e){const t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},x.log2=Math.log2??function(e){return Math.log(e)*Math.LOG2E},x.fog=function(e,t){const r=e*t;return 1-Math.exp(-r*r)},x.fastApproximateAtan=function(e){return A.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},x.fastApproximateAtan2=function(e,t){let r;A.typeOf.number("x",e),A.typeOf.number("y",t);let n=Math.abs(e);r=Math.abs(t);const o=Math.max(n,r);r=Math.min(n,r);const i=r/o;if(isNaN(i))throw new E("either x or y must be nonzero");return n=x.fastApproximateAtan(i),n=Math.abs(t)>Math.abs(e)?x.PI_OVER_TWO-n:n,n=e<0?x.PI-n:n,n=t<0?-n:n,n},L.fromSpherical=function(e,t){A.typeOf.object("spherical",e),C(t)||(t=new L);const r=e.clock,n=e.cone,o=e.magnitude??1,i=o*Math.sin(n);return t.x=i*Math.cos(r),t.y=i*Math.sin(r),t.z=o*Math.cos(n),t},L.fromElements=function(e,t,r,n){return C(n)?(n.x=e,n.y=t,n.z=r,n):new L(e,t,r)},L.clone=function(e,t){if(C(e))return C(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new L(e.x,e.y,e.z)},L.fromCartesian4=L.clone,L.packedLength=3,L.pack=function(e,t,r){return A.typeOf.object("value",e),A.defined("array",t),r=r??0,t[r++]=e.x,t[r++]=e.y,t[r]=e.z,t},L.unpack=function(e,t,r){return A.defined("array",e),t=t??0,C(r)||(r=new L),r.x=e[t++],r.y=e[t++],r.z=e[t],r},L.packArray=function(e,t){A.defined("array",e);const r=e.length,n=3*r;if(C(t)){if(!Array.isArray(t)&&t.length!==n)throw new E("If result is a typed array, it must have exactly array.length * 3 elements");t.length!==n&&(t.length=n)}else t=new Array(n);for(let o=0;o<r;++o)L.pack(e[o],t,3*o);return t},L.unpackArray=function(e,t){if(A.defined("array",e),A.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new E("array length must be a multiple of 3.");const r=e.length;C(t)?t.length=r/3:t=new Array(r/3);for(let n=0;n<r;n+=3){const r=n/3;t[r]=L.unpack(e,n,t[r])}return t},L.fromArray=L.unpack,L.maximumComponent=function(e){return A.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},L.minimumComponent=function(e){return A.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},L.minimumByComponent=function(e,t,r){return A.typeOf.object("first",e),A.typeOf.object("second",t),A.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r.z=Math.min(e.z,t.z),r},L.maximumByComponent=function(e,t,r){return A.typeOf.object("first",e),A.typeOf.object("second",t),A.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.z=Math.max(e.z,t.z),r},L.clamp=function(e,t,r,n){A.typeOf.object("value",e),A.typeOf.object("min",t),A.typeOf.object("max",r),A.typeOf.object("result",n);const o=x.clamp(e.x,t.x,r.x),i=x.clamp(e.y,t.y,r.y),s=x.clamp(e.z,t.z,r.z);return n.x=o,n.y=i,n.z=s,n},L.magnitudeSquared=function(e){return A.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},L.magnitude=function(e){return Math.sqrt(L.magnitudeSquared(e))};const T=new L;L.distance=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),L.subtract(e,t,T),L.magnitude(T)},L.distanceSquared=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),L.subtract(e,t,T),L.magnitudeSquared(T)},L.normalize=function(e,t){A.typeOf.object("cartesian",e),A.typeOf.object("result",t);const r=L.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new E("normalized result is not a number");return t},L.dot=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},L.multiplyComponents=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z,r},L.divideComponents=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z,r},L.add=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r},L.subtract=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r},L.multiplyByScalar=function(e,t,r){return A.typeOf.object("cartesian",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r},L.divideByScalar=function(e,t,r){return A.typeOf.object("cartesian",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r},L.negate=function(e,t){return A.typeOf.object("cartesian",e),A.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},L.abs=function(e,t){return A.typeOf.object("cartesian",e),A.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};const N=new L;L.lerp=function(e,t,r,n){return A.typeOf.object("start",e),A.typeOf.object("end",t),A.typeOf.number("t",r),A.typeOf.object("result",n),L.multiplyByScalar(t,r,N),n=L.multiplyByScalar(e,1-r,n),L.add(N,n,n)};const _=new L,M=new L;L.angleBetween=function(e,t){A.typeOf.object("left",e),A.typeOf.object("right",t),L.normalize(e,_),L.normalize(t,M);const r=L.dot(_,M),n=L.magnitude(L.cross(_,M,_));return Math.atan2(n,r)};const D=new L;L.mostOrthogonalAxis=function(e,t){A.typeOf.object("cartesian",e),A.typeOf.object("result",t);const r=L.normalize(e,D);return L.abs(r,r),r.x<=r.y?r.x<=r.z?L.clone(L.UNIT_X,t):L.clone(L.UNIT_Z,t):r.y<=r.z?L.clone(L.UNIT_Y,t):L.clone(L.UNIT_Z,t)},L.projectVector=function(e,t,r){A.defined("a",e),A.defined("b",t),A.defined("result",r);const n=L.dot(e,t)/L.dot(t,t);return L.multiplyByScalar(t,n,r)},L.equals=function(e,t){return e===t||C(e)&&C(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},L.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]&&e.z===t[r+2]},L.equalsEpsilon=function(e,t,r,n){return e===t||C(e)&&C(t)&&x.equalsEpsilon(e.x,t.x,r,n)&&x.equalsEpsilon(e.y,t.y,r,n)&&x.equalsEpsilon(e.z,t.z,r,n)},L.cross=function(e,t,r){A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r);const n=e.x,o=e.y,i=e.z,s=t.x,a=t.y,f=t.z,u=o*f-i*a,l=i*s-n*f,c=n*a-o*s;return r.x=u,r.y=l,r.z=c,r},L.midpoint=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=.5*(e.x+t.x),r.y=.5*(e.y+t.y),r.z=.5*(e.z+t.z),r},L.fromDegrees=function(e,t,r,n,o){return A.typeOf.number("longitude",e),A.typeOf.number("latitude",t),e=x.toRadians(e),t=x.toRadians(t),L.fromRadians(e,t,r,n,o)};let B=new L,P=new L;L._ellipsoidRadiiSquared=new L(40680631590769,40680631590769,40408299984661.445),L.fromRadians=function(e,t,r,n,o){A.typeOf.number("longitude",e),A.typeOf.number("latitude",t),r=r??0;const i=C(n)?n.radiiSquared:L._ellipsoidRadiiSquared,s=Math.cos(t);B.x=s*Math.cos(e),B.y=s*Math.sin(e),B.z=Math.sin(t),B=L.normalize(B,B),L.multiplyComponents(i,B,P);const a=Math.sqrt(L.dot(B,P));return P=L.divideByScalar(P,a,P),B=L.multiplyByScalar(B,r,B),C(o)||(o=new L),L.add(P,B,o)},L.fromDegreesArray=function(e,t,r){if(A.defined("coordinates",e),e.length<2||e.length%2!=0)throw new E("the number of coordinates must be a multiple of 2 and at least 2");const n=e.length;C(r)?r.length=n/2:r=new Array(n/2);for(let o=0;o<n;o+=2){const n=e[o],i=e[o+1],s=o/2;r[s]=L.fromDegrees(n,i,0,t,r[s])}return r},L.fromRadiansArray=function(e,t,r){if(A.defined("coordinates",e),e.length<2||e.length%2!=0)throw new E("the number of coordinates must be a multiple of 2 and at least 2");const n=e.length;C(r)?r.length=n/2:r=new Array(n/2);for(let o=0;o<n;o+=2){const n=e[o],i=e[o+1],s=o/2;r[s]=L.fromRadians(n,i,0,t,r[s])}return r},L.fromDegreesArrayHeights=function(e,t,r){if(A.defined("coordinates",e),e.length<3||e.length%3!=0)throw new E("the number of coordinates must be a multiple of 3 and at least 3");const n=e.length;C(r)?r.length=n/3:r=new Array(n/3);for(let o=0;o<n;o+=3){const n=e[o],i=e[o+1],s=e[o+2],a=o/3;r[a]=L.fromDegrees(n,i,s,t,r[a])}return r},L.fromRadiansArrayHeights=function(e,t,r){if(A.defined("coordinates",e),e.length<3||e.length%3!=0)throw new E("the number of coordinates must be a multiple of 3 and at least 3");const n=e.length;C(r)?r.length=n/3:r=new Array(n/3);for(let o=0;o<n;o+=3){const n=e[o],i=e[o+1],s=e[o+2],a=o/3;r[a]=L.fromRadians(n,i,s,t,r[a])}return r},L.ZERO=Object.freeze(new L(0,0,0)),L.ONE=Object.freeze(new L(1,1,1)),L.UNIT_X=Object.freeze(new L(1,0,0)),L.UNIT_Y=Object.freeze(new L(0,1,0)),L.UNIT_Z=Object.freeze(new L(0,0,1)),L.prototype.clone=function(e){return L.clone(this,e)},L.prototype.equals=function(e){return L.equals(this,e)},L.prototype.equalsEpsilon=function(e,t,r){return L.equalsEpsilon(this,e,t,r)},L.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};const v={};let U;v.EMPTY_OBJECT=Object.freeze({}),v.EMPTY_ARRAY=Object.freeze([]);const q={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},G={};let k,W,$,H,Y,V,K,Z,Q,X,J,ee,te,re,ne,oe,ie,se;function ae(e){const t=e.split(".");for(let r=0,n=t.length;r<n;++r)t[r]=parseInt(t[r],10);return t}function fe(){if(!C(W)&&(W=!1,!he())){const e=/ Chrome\/([\.0-9]+)/.exec(k.userAgent);null!==e&&(W=!0,$=ae(e[1]))}return W}function ue(){if(!C(H)&&(H=!1,!fe()&&!he()&&/ Safari\/[\.0-9]+/.test(k.userAgent))){const e=/ Version\/([\.0-9]+)/.exec(k.userAgent);null!==e&&(H=!0,Y=ae(e[1]))}return H}function le(){if(!C(V)){V=!1;const e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(k.userAgent);null!==e&&(V=!0,K=ae(e[1]),K.isNightly=!!e[2])}return V}function ce(){if(!C(Z)){let e;Z=!1,"Microsoft Internet Explorer"===k.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(k.userAgent),null!==e&&(Z=!0,Q=ae(e[1]))):"Netscape"===k.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(k.userAgent),null!==e&&(Z=!0,Q=ae(e[1])))}return Z}function he(){if(!C(X)){X=!1;const e=/ Edg\/([\.0-9]+)/.exec(k.userAgent);null!==e&&(X=!0,J=ae(e[1]))}return X}function pe(){if(!C(ee)){ee=!1;const e=/Firefox\/([\.0-9]+)/.exec(k.userAgent);null!==e&&(ee=!0,te=ae(e[1]))}return ee}function me(){if(!C(se)){const e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");const t=e.style.imageRendering;se=C(t)&&""!==t,se&&(ie=t)}return se}function de(){if(!de.initialized)throw new E("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return de._result}Object.defineProperties(G,{element:{get:function(){if(G.supportsFullscreen())return document[q.fullscreenElement]}},changeEventName:{get:function(){if(G.supportsFullscreen())return q.fullscreenchange}},errorEventName:{get:function(){if(G.supportsFullscreen())return q.fullscreenerror}},enabled:{get:function(){if(G.supportsFullscreen())return document[q.fullscreenEnabled]}},fullscreen:{get:function(){if(G.supportsFullscreen())return null!==G.element}}}),G.supportsFullscreen=function(){if(C(U))return U;U=!1;const e=document.body;if("function"==typeof e.requestFullscreen)return q.requestFullscreen="requestFullscreen",q.exitFullscreen="exitFullscreen",q.fullscreenEnabled="fullscreenEnabled",q.fullscreenElement="fullscreenElement",q.fullscreenchange="fullscreenchange",q.fullscreenerror="fullscreenerror",U=!0,U;const t=["webkit","moz","o","ms","khtml"];let r;for(let n=0,o=t.length;n<o;++n){const o=t[n];r=`${o}RequestFullscreen`,"function"==typeof e[r]?(q.requestFullscreen=r,U=!0):(r=`${o}RequestFullScreen`,"function"==typeof e[r]&&(q.requestFullscreen=r,U=!0)),r=`${o}ExitFullscreen`,"function"==typeof document[r]?q.exitFullscreen=r:(r=`${o}CancelFullScreen`,"function"==typeof document[r]&&(q.exitFullscreen=r)),r=`${o}FullscreenEnabled`,void 0!==document[r]?q.fullscreenEnabled=r:(r=`${o}FullScreenEnabled`,void 0!==document[r]&&(q.fullscreenEnabled=r)),r=`${o}FullscreenElement`,void 0!==document[r]?q.fullscreenElement=r:(r=`${o}FullScreenElement`,void 0!==document[r]&&(q.fullscreenElement=r)),r=`${o}fullscreenchange`,void 0!==document[`on${r}`]&&("ms"===o&&(r="MSFullscreenChange"),q.fullscreenchange=r),r=`${o}fullscreenerror`,void 0!==document[`on${r}`]&&("ms"===o&&(r="MSFullscreenError"),q.fullscreenerror=r)}return U},G.requestFullscreen=function(e,t){G.supportsFullscreen()&&e[q.requestFullscreen]({vrDisplay:t})},G.exitFullscreen=function(){G.supportsFullscreen()&&document[q.exitFullscreen]()},G._names=q,k="undefined"!=typeof navigator?navigator:{},de._promise=void 0,de._result=void 0,de.initialize=function(){return C(de._promise)||(de._promise=new Promise(e=>{const t=new Image;t.onload=function(){de._result=t.width>0&&t.height>0,e(de._result)},t.onerror=function(){de._result=!1,e(de._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),de._promise},Object.defineProperties(de,{initialized:{get:function(){return C(de._result)}}});const ye=[];"undefined"!=typeof ArrayBuffer&&(ye.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&ye.push(Uint8ClampedArray),"undefined"!=typeof Uint8ClampedArray&&ye.push(Uint8ClampedArray),"undefined"!=typeof BigInt64Array&&ye.push(BigInt64Array),"undefined"!=typeof BigUint64Array&&ye.push(BigUint64Array));const ge={isChrome:fe,chromeVersion:function(){return fe()&&$},isSafari:ue,safariVersion:function(){return ue()&&Y},isWebkit:le,webkitVersion:function(){return le()&&K},isInternetExplorer:ce,internetExplorerVersion:function(){return ce()&&Q},isEdge:he,edgeVersion:function(){return he()&&J},isFirefox:pe,firefoxVersion:function(){return pe()&&te},isWindows:function(){return C(re)||(re=/Windows/i.test(k.appVersion)),re},isIPadOrIOS:function(){return C(ne)||(ne="iPhone"===navigator.platform||"iPod"===navigator.platform||"iPad"===navigator.platform),ne},hardwareConcurrency:k.hardwareConcurrency??3,supportsPointerEvents:function(){return C(oe)||(oe=!pe()&&"undefined"!=typeof PointerEvent&&(!C(k.pointerEnabled)||k.pointerEnabled)),oe},supportsImageRenderingPixelated:me,supportsWebP:de,imageRenderingValue:function(){return me()?ie:void 0},typedArrayTypes:ye};function be(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function Oe(e,t,r,n){this.red=e??1,this.green=t??1,this.blue=r??1,this.alpha=n??1}let Ce,Ee,Ae;ge.supportsBasis=function(e){return ge.supportsWebAssembly()&&e.context.supportsBasis},ge.supportsFullscreen=function(){return G.supportsFullscreen()},ge.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},ge.supportsBigInt64Array=function(){return"undefined"!=typeof BigInt64Array},ge.supportsBigUint64Array=function(){return"undefined"!=typeof BigUint64Array},ge.supportsBigInt=function(){return"undefined"!=typeof BigInt},ge.supportsWebWorkers=function(){return"undefined"!=typeof Worker},ge.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly},ge.supportsWebgl2=function(e){return A.defined("scene",e),e.context.webgl2},ge.supportsEsmWebWorkers=function(){return!pe()||parseInt(te)>=114},Oe.fromCartesian4=function(e,t){return A.typeOf.object("cartesian",e),C(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new Oe(e.x,e.y,e.z,e.w)},Oe.fromBytes=function(e,t,r,n,o){return e=Oe.byteToFloat(e??255),t=Oe.byteToFloat(t??255),r=Oe.byteToFloat(r??255),n=Oe.byteToFloat(n??255),C(o)?(o.red=e,o.green=t,o.blue=r,o.alpha=n,o):new Oe(e,t,r,n)},Oe.fromAlpha=function(e,t,r){return A.typeOf.object("color",e),A.typeOf.number("alpha",t),C(r)?(r.red=e.red,r.green=e.green,r.blue=e.blue,r.alpha=t,r):new Oe(e.red,e.green,e.blue,t)},ge.supportsTypedArrays()&&(Ce=new ArrayBuffer(4),Ee=new Uint32Array(Ce),Ae=new Uint8Array(Ce)),Oe.fromRgba=function(e,t){return Ee[0]=e,Oe.fromBytes(Ae[0],Ae[1],Ae[2],Ae[3],t)},Oe.fromHsl=function(e,t,r,n,o){e=(e??0)%1,n=n??1;let i=r=r??0,s=r,a=r;if(0!==(t=t??0)){let n;n=r<.5?r*(1+t):r+t-r*t;const o=2*r-n;i=be(o,n,e+1/3),s=be(o,n,e),a=be(o,n,e-1/3)}return C(o)?(o.red=i,o.green=s,o.blue=a,o.alpha=n,o):new Oe(i,s,a,n)},Oe.fromRandom=function(e,t){let r=(e=e??v.EMPTY_OBJECT).red;if(!C(r)){const t=e.minimumRed??0,n=e.maximumRed??1;A.typeOf.number.lessThanOrEquals("minimumRed",t,n),r=t+x.nextRandomNumber()*(n-t)}let n=e.green;if(!C(n)){const t=e.minimumGreen??0,r=e.maximumGreen??1;A.typeOf.number.lessThanOrEquals("minimumGreen",t,r),n=t+x.nextRandomNumber()*(r-t)}let o=e.blue;if(!C(o)){const t=e.minimumBlue??0,r=e.maximumBlue??1;A.typeOf.number.lessThanOrEquals("minimumBlue",t,r),o=t+x.nextRandomNumber()*(r-t)}let i=e.alpha;if(!C(i)){const t=e.minimumAlpha??0,r=e.maximumAlpha??1;A.typeOf.number.lessThanOrEquals("minimumAlpha",t,r),i=t+x.nextRandomNumber()*(r-t)}return C(t)?(t.red=r,t.green=n,t.blue=o,t.alpha=i,t):new Oe(r,n,o,i)};const Se=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,we=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,je=/^rgba?\s*\(\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i,Fe=/^hsla?\s*\(\s*([0-9.]+)\s*[,\s]+\s*([0-9.]+%)\s*[,\s]+\s*([0-9.]+%)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i;function ze(e,t){this.x=e??0,this.y=t??0}Oe.fromCssColorString=function(e,t){A.typeOf.string("color",e),C(t)||(t=new Oe);const r=Oe[(e=e.trim()).toUpperCase()];if(C(r))return Oe.clone(r,t),t;let n=Se.exec(e);return null!==n?(t.red=parseInt(n[1],16)/15,t.green=parseInt(n[2],16)/15,t.blue=parseInt(n[3],16)/15,t.alpha=parseInt(n[4]??"f",16)/15,t):(n=we.exec(e),null!==n?(t.red=parseInt(n[1],16)/255,t.green=parseInt(n[2],16)/255,t.blue=parseInt(n[3],16)/255,t.alpha=parseInt(n[4]??"ff",16)/255,t):(n=je.exec(e),null!==n?(t.red=parseFloat(n[1])/("%"===n[1].substr(-1)?100:255),t.green=parseFloat(n[2])/("%"===n[2].substr(-1)?100:255),t.blue=parseFloat(n[3])/("%"===n[3].substr(-1)?100:255),t.alpha=parseFloat(n[4]??"1.0"),t):(n=Fe.exec(e),null!==n?Oe.fromHsl(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,parseFloat(n[4]??"1.0"),t):t=void 0)))},Oe.packedLength=4,Oe.pack=function(e,t,r){return A.typeOf.object("value",e),A.defined("array",t),r=r??0,t[r++]=e.red,t[r++]=e.green,t[r++]=e.blue,t[r]=e.alpha,t},Oe.unpack=function(e,t,r){return A.defined("array",e),t=t??0,C(r)||(r=new Oe),r.red=e[t++],r.green=e[t++],r.blue=e[t++],r.alpha=e[t],r},Oe.byteToFloat=function(e){return e/255},Oe.floatToByte=function(e){return 1===e?255:256*e|0},Oe.clone=function(e,t){if(C(e))return C(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new Oe(e.red,e.green,e.blue,e.alpha)},Oe.equals=function(e,t){return e===t||C(e)&&C(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},Oe.equalsArray=function(e,t,r){return e.red===t[r]&&e.green===t[r+1]&&e.blue===t[r+2]&&e.alpha===t[r+3]},Oe.prototype.clone=function(e){return Oe.clone(this,e)},Oe.prototype.equals=function(e){return Oe.equals(this,e)},Oe.prototype.equalsEpsilon=function(e,t){return this===e||C(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},Oe.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`},Oe.prototype.toCssColorString=function(){const e=Oe.floatToByte(this.red),t=Oe.floatToByte(this.green),r=Oe.floatToByte(this.blue);return 1===this.alpha?`rgb(${e},${t},${r})`:`rgba(${e},${t},${r},${this.alpha})`},Oe.prototype.toCssHexString=function(){let e=Oe.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=Oe.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let r=Oe.floatToByte(this.blue).toString(16);if(r.length<2&&(r=`0${r}`),this.alpha<1){let n=Oe.floatToByte(this.alpha).toString(16);return n.length<2&&(n=`0${n}`),`#${e}${t}${r}${n}`}return`#${e}${t}${r}`},Oe.prototype.toBytes=function(e){const t=Oe.floatToByte(this.red),r=Oe.floatToByte(this.green),n=Oe.floatToByte(this.blue),o=Oe.floatToByte(this.alpha);return C(e)?(e[0]=t,e[1]=r,e[2]=n,e[3]=o,e):[t,r,n,o]},Oe.bytesToRgba=function(e,t,r,n){return Ae[0]=e,Ae[1]=t,Ae[2]=r,Ae[3]=n,Ee[0]},Oe.prototype.toRgba=function(){return Oe.bytesToRgba(Oe.floatToByte(this.red),Oe.floatToByte(this.green),Oe.floatToByte(this.blue),Oe.floatToByte(this.alpha))},Oe.prototype.brighten=function(e,t){return A.typeOf.number("magnitude",e),A.typeOf.number.greaterThanOrEquals("magnitude",e,0),A.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},Oe.prototype.darken=function(e,t){return A.typeOf.number("magnitude",e),A.typeOf.number.greaterThanOrEquals("magnitude",e,0),A.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},Oe.prototype.withAlpha=function(e,t){return Oe.fromAlpha(this,e,t)},Oe.add=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.red=e.red+t.red,r.green=e.green+t.green,r.blue=e.blue+t.blue,r.alpha=e.alpha+t.alpha,r},Oe.subtract=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.red=e.red-t.red,r.green=e.green-t.green,r.blue=e.blue-t.blue,r.alpha=e.alpha-t.alpha,r},Oe.multiply=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.red=e.red*t.red,r.green=e.green*t.green,r.blue=e.blue*t.blue,r.alpha=e.alpha*t.alpha,r},Oe.divide=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.red=e.red/t.red,r.green=e.green/t.green,r.blue=e.blue/t.blue,r.alpha=e.alpha/t.alpha,r},Oe.mod=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.red=e.red%t.red,r.green=e.green%t.green,r.blue=e.blue%t.blue,r.alpha=e.alpha%t.alpha,r},Oe.lerp=function(e,t,r,n){return A.typeOf.object("start",e),A.typeOf.object("end",t),A.typeOf.number("t",r),A.typeOf.object("result",n),n.red=x.lerp(e.red,t.red,r),n.green=x.lerp(e.green,t.green,r),n.blue=x.lerp(e.blue,t.blue,r),n.alpha=x.lerp(e.alpha,t.alpha,r),n},Oe.multiplyByScalar=function(e,t,r){return A.typeOf.object("color",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.red=e.red*t,r.green=e.green*t,r.blue=e.blue*t,r.alpha=e.alpha*t,r},Oe.divideByScalar=function(e,t,r){return A.typeOf.object("color",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.red=e.red/t,r.green=e.green/t,r.blue=e.blue/t,r.alpha=e.alpha/t,r},Oe.ALICEBLUE=Object.freeze(Oe.fromCssColorString("#F0F8FF")),Oe.ANTIQUEWHITE=Object.freeze(Oe.fromCssColorString("#FAEBD7")),Oe.AQUA=Object.freeze(Oe.fromCssColorString("#00FFFF")),Oe.AQUAMARINE=Object.freeze(Oe.fromCssColorString("#7FFFD4")),Oe.AZURE=Object.freeze(Oe.fromCssColorString("#F0FFFF")),Oe.BEIGE=Object.freeze(Oe.fromCssColorString("#F5F5DC")),Oe.BISQUE=Object.freeze(Oe.fromCssColorString("#FFE4C4")),Oe.BLACK=Object.freeze(Oe.fromCssColorString("#000000")),Oe.BLANCHEDALMOND=Object.freeze(Oe.fromCssColorString("#FFEBCD")),Oe.BLUE=Object.freeze(Oe.fromCssColorString("#0000FF")),Oe.BLUEVIOLET=Object.freeze(Oe.fromCssColorString("#8A2BE2")),Oe.BROWN=Object.freeze(Oe.fromCssColorString("#A52A2A")),Oe.BURLYWOOD=Object.freeze(Oe.fromCssColorString("#DEB887")),Oe.CADETBLUE=Object.freeze(Oe.fromCssColorString("#5F9EA0")),Oe.CHARTREUSE=Object.freeze(Oe.fromCssColorString("#7FFF00")),Oe.CHOCOLATE=Object.freeze(Oe.fromCssColorString("#D2691E")),Oe.CORAL=Object.freeze(Oe.fromCssColorString("#FF7F50")),Oe.CORNFLOWERBLUE=Object.freeze(Oe.fromCssColorString("#6495ED")),Oe.CORNSILK=Object.freeze(Oe.fromCssColorString("#FFF8DC")),Oe.CRIMSON=Object.freeze(Oe.fromCssColorString("#DC143C")),Oe.CYAN=Object.freeze(Oe.fromCssColorString("#00FFFF")),Oe.DARKBLUE=Object.freeze(Oe.fromCssColorString("#00008B")),Oe.DARKCYAN=Object.freeze(Oe.fromCssColorString("#008B8B")),Oe.DARKGOLDENROD=Object.freeze(Oe.fromCssColorString("#B8860B")),Oe.DARKGRAY=Object.freeze(Oe.fromCssColorString("#A9A9A9")),Oe.DARKGREEN=Object.freeze(Oe.fromCssColorString("#006400")),Oe.DARKGREY=Oe.DARKGRAY,Oe.DARKKHAKI=Object.freeze(Oe.fromCssColorString("#BDB76B")),Oe.DARKMAGENTA=Object.freeze(Oe.fromCssColorString("#8B008B")),Oe.DARKOLIVEGREEN=Object.freeze(Oe.fromCssColorString("#556B2F")),Oe.DARKORANGE=Object.freeze(Oe.fromCssColorString("#FF8C00")),Oe.DARKORCHID=Object.freeze(Oe.fromCssColorString("#9932CC")),Oe.DARKRED=Object.freeze(Oe.fromCssColorString("#8B0000")),Oe.DARKSALMON=Object.freeze(Oe.fromCssColorString("#E9967A")),Oe.DARKSEAGREEN=Object.freeze(Oe.fromCssColorString("#8FBC8F")),Oe.DARKSLATEBLUE=Object.freeze(Oe.fromCssColorString("#483D8B")),Oe.DARKSLATEGRAY=Object.freeze(Oe.fromCssColorString("#2F4F4F")),Oe.DARKSLATEGREY=Oe.DARKSLATEGRAY,Oe.DARKTURQUOISE=Object.freeze(Oe.fromCssColorString("#00CED1")),Oe.DARKVIOLET=Object.freeze(Oe.fromCssColorString("#9400D3")),Oe.DEEPPINK=Object.freeze(Oe.fromCssColorString("#FF1493")),Oe.DEEPSKYBLUE=Object.freeze(Oe.fromCssColorString("#00BFFF")),Oe.DIMGRAY=Object.freeze(Oe.fromCssColorString("#696969")),Oe.DIMGREY=Oe.DIMGRAY,Oe.DODGERBLUE=Object.freeze(Oe.fromCssColorString("#1E90FF")),Oe.FIREBRICK=Object.freeze(Oe.fromCssColorString("#B22222")),Oe.FLORALWHITE=Object.freeze(Oe.fromCssColorString("#FFFAF0")),Oe.FORESTGREEN=Object.freeze(Oe.fromCssColorString("#228B22")),Oe.FUCHSIA=Object.freeze(Oe.fromCssColorString("#FF00FF")),Oe.GAINSBORO=Object.freeze(Oe.fromCssColorString("#DCDCDC")),Oe.GHOSTWHITE=Object.freeze(Oe.fromCssColorString("#F8F8FF")),Oe.GOLD=Object.freeze(Oe.fromCssColorString("#FFD700")),Oe.GOLDENROD=Object.freeze(Oe.fromCssColorString("#DAA520")),Oe.GRAY=Object.freeze(Oe.fromCssColorString("#808080")),Oe.GREEN=Object.freeze(Oe.fromCssColorString("#008000")),Oe.GREENYELLOW=Object.freeze(Oe.fromCssColorString("#ADFF2F")),Oe.GREY=Oe.GRAY,Oe.HONEYDEW=Object.freeze(Oe.fromCssColorString("#F0FFF0")),Oe.HOTPINK=Object.freeze(Oe.fromCssColorString("#FF69B4")),Oe.INDIANRED=Object.freeze(Oe.fromCssColorString("#CD5C5C")),Oe.INDIGO=Object.freeze(Oe.fromCssColorString("#4B0082")),Oe.IVORY=Object.freeze(Oe.fromCssColorString("#FFFFF0")),Oe.KHAKI=Object.freeze(Oe.fromCssColorString("#F0E68C")),Oe.LAVENDER=Object.freeze(Oe.fromCssColorString("#E6E6FA")),Oe.LAVENDAR_BLUSH=Object.freeze(Oe.fromCssColorString("#FFF0F5")),Oe.LAWNGREEN=Object.freeze(Oe.fromCssColorString("#7CFC00")),Oe.LEMONCHIFFON=Object.freeze(Oe.fromCssColorString("#FFFACD")),Oe.LIGHTBLUE=Object.freeze(Oe.fromCssColorString("#ADD8E6")),Oe.LIGHTCORAL=Object.freeze(Oe.fromCssColorString("#F08080")),Oe.LIGHTCYAN=Object.freeze(Oe.fromCssColorString("#E0FFFF")),Oe.LIGHTGOLDENRODYELLOW=Object.freeze(Oe.fromCssColorString("#FAFAD2")),Oe.LIGHTGRAY=Object.freeze(Oe.fromCssColorString("#D3D3D3")),Oe.LIGHTGREEN=Object.freeze(Oe.fromCssColorString("#90EE90")),Oe.LIGHTGREY=Oe.LIGHTGRAY,Oe.LIGHTPINK=Object.freeze(Oe.fromCssColorString("#FFB6C1")),Oe.LIGHTSEAGREEN=Object.freeze(Oe.fromCssColorString("#20B2AA")),Oe.LIGHTSKYBLUE=Object.freeze(Oe.fromCssColorString("#87CEFA")),Oe.LIGHTSLATEGRAY=Object.freeze(Oe.fromCssColorString("#778899")),Oe.LIGHTSLATEGREY=Oe.LIGHTSLATEGRAY,Oe.LIGHTSTEELBLUE=Object.freeze(Oe.fromCssColorString("#B0C4DE")),Oe.LIGHTYELLOW=Object.freeze(Oe.fromCssColorString("#FFFFE0")),Oe.LIME=Object.freeze(Oe.fromCssColorString("#00FF00")),Oe.LIMEGREEN=Object.freeze(Oe.fromCssColorString("#32CD32")),Oe.LINEN=Object.freeze(Oe.fromCssColorString("#FAF0E6")),Oe.MAGENTA=Object.freeze(Oe.fromCssColorString("#FF00FF")),Oe.MAROON=Object.freeze(Oe.fromCssColorString("#800000")),Oe.MEDIUMAQUAMARINE=Object.freeze(Oe.fromCssColorString("#66CDAA")),Oe.MEDIUMBLUE=Object.freeze(Oe.fromCssColorString("#0000CD")),Oe.MEDIUMORCHID=Object.freeze(Oe.fromCssColorString("#BA55D3")),Oe.MEDIUMPURPLE=Object.freeze(Oe.fromCssColorString("#9370DB")),Oe.MEDIUMSEAGREEN=Object.freeze(Oe.fromCssColorString("#3CB371")),Oe.MEDIUMSLATEBLUE=Object.freeze(Oe.fromCssColorString("#7B68EE")),Oe.MEDIUMSPRINGGREEN=Object.freeze(Oe.fromCssColorString("#00FA9A")),Oe.MEDIUMTURQUOISE=Object.freeze(Oe.fromCssColorString("#48D1CC")),Oe.MEDIUMVIOLETRED=Object.freeze(Oe.fromCssColorString("#C71585")),Oe.MIDNIGHTBLUE=Object.freeze(Oe.fromCssColorString("#191970")),Oe.MINTCREAM=Object.freeze(Oe.fromCssColorString("#F5FFFA")),Oe.MISTYROSE=Object.freeze(Oe.fromCssColorString("#FFE4E1")),Oe.MOCCASIN=Object.freeze(Oe.fromCssColorString("#FFE4B5")),Oe.NAVAJOWHITE=Object.freeze(Oe.fromCssColorString("#FFDEAD")),Oe.NAVY=Object.freeze(Oe.fromCssColorString("#000080")),Oe.OLDLACE=Object.freeze(Oe.fromCssColorString("#FDF5E6")),Oe.OLIVE=Object.freeze(Oe.fromCssColorString("#808000")),Oe.OLIVEDRAB=Object.freeze(Oe.fromCssColorString("#6B8E23")),Oe.ORANGE=Object.freeze(Oe.fromCssColorString("#FFA500")),Oe.ORANGERED=Object.freeze(Oe.fromCssColorString("#FF4500")),Oe.ORCHID=Object.freeze(Oe.fromCssColorString("#DA70D6")),Oe.PALEGOLDENROD=Object.freeze(Oe.fromCssColorString("#EEE8AA")),Oe.PALEGREEN=Object.freeze(Oe.fromCssColorString("#98FB98")),Oe.PALETURQUOISE=Object.freeze(Oe.fromCssColorString("#AFEEEE")),Oe.PALEVIOLETRED=Object.freeze(Oe.fromCssColorString("#DB7093")),Oe.PAPAYAWHIP=Object.freeze(Oe.fromCssColorString("#FFEFD5")),Oe.PEACHPUFF=Object.freeze(Oe.fromCssColorString("#FFDAB9")),Oe.PERU=Object.freeze(Oe.fromCssColorString("#CD853F")),Oe.PINK=Object.freeze(Oe.fromCssColorString("#FFC0CB")),Oe.PLUM=Object.freeze(Oe.fromCssColorString("#DDA0DD")),Oe.POWDERBLUE=Object.freeze(Oe.fromCssColorString("#B0E0E6")),Oe.PURPLE=Object.freeze(Oe.fromCssColorString("#800080")),Oe.RED=Object.freeze(Oe.fromCssColorString("#FF0000")),Oe.ROSYBROWN=Object.freeze(Oe.fromCssColorString("#BC8F8F")),Oe.ROYALBLUE=Object.freeze(Oe.fromCssColorString("#4169E1")),Oe.SADDLEBROWN=Object.freeze(Oe.fromCssColorString("#8B4513")),Oe.SALMON=Object.freeze(Oe.fromCssColorString("#FA8072")),Oe.SANDYBROWN=Object.freeze(Oe.fromCssColorString("#F4A460")),Oe.SEAGREEN=Object.freeze(Oe.fromCssColorString("#2E8B57")),Oe.SEASHELL=Object.freeze(Oe.fromCssColorString("#FFF5EE")),Oe.SIENNA=Object.freeze(Oe.fromCssColorString("#A0522D")),Oe.SILVER=Object.freeze(Oe.fromCssColorString("#C0C0C0")),Oe.SKYBLUE=Object.freeze(Oe.fromCssColorString("#87CEEB")),Oe.SLATEBLUE=Object.freeze(Oe.fromCssColorString("#6A5ACD")),Oe.SLATEGRAY=Object.freeze(Oe.fromCssColorString("#708090")),Oe.SLATEGREY=Oe.SLATEGRAY,Oe.SNOW=Object.freeze(Oe.fromCssColorString("#FFFAFA")),Oe.SPRINGGREEN=Object.freeze(Oe.fromCssColorString("#00FF7F")),Oe.STEELBLUE=Object.freeze(Oe.fromCssColorString("#4682B4")),Oe.TAN=Object.freeze(Oe.fromCssColorString("#D2B48C")),Oe.TEAL=Object.freeze(Oe.fromCssColorString("#008080")),Oe.THISTLE=Object.freeze(Oe.fromCssColorString("#D8BFD8")),Oe.TOMATO=Object.freeze(Oe.fromCssColorString("#FF6347")),Oe.TURQUOISE=Object.freeze(Oe.fromCssColorString("#40E0D0")),Oe.VIOLET=Object.freeze(Oe.fromCssColorString("#EE82EE")),Oe.WHEAT=Object.freeze(Oe.fromCssColorString("#F5DEB3")),Oe.WHITE=Object.freeze(Oe.fromCssColorString("#FFFFFF")),Oe.WHITESMOKE=Object.freeze(Oe.fromCssColorString("#F5F5F5")),Oe.YELLOW=Object.freeze(Oe.fromCssColorString("#FFFF00")),Oe.YELLOWGREEN=Object.freeze(Oe.fromCssColorString("#9ACD32")),Oe.TRANSPARENT=Object.freeze(new Oe(0,0,0,0)),ze.fromElements=function(e,t,r){return C(r)?(r.x=e,r.y=t,r):new ze(e,t)},ze.clone=function(e,t){if(C(e))return C(t)?(t.x=e.x,t.y=e.y,t):new ze(e.x,e.y)},ze.fromCartesian3=ze.clone,ze.fromCartesian4=ze.clone,ze.packedLength=2,ze.pack=function(e,t,r){return A.typeOf.object("value",e),A.defined("array",t),r=r??0,t[r++]=e.x,t[r]=e.y,t},ze.unpack=function(e,t,r){return A.defined("array",e),t=t??0,C(r)||(r=new ze),r.x=e[t++],r.y=e[t],r},ze.packArray=function(e,t){A.defined("array",e);const r=e.length,n=2*r;if(C(t)){if(!Array.isArray(t)&&t.length!==n)throw new E("If result is a typed array, it must have exactly array.length * 2 elements");t.length!==n&&(t.length=n)}else t=new Array(n);for(let o=0;o<r;++o)ze.pack(e[o],t,2*o);return t},ze.unpackArray=function(e,t){if(A.defined("array",e),A.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!=0)throw new E("array length must be a multiple of 2.");const r=e.length;C(t)?t.length=r/2:t=new Array(r/2);for(let n=0;n<r;n+=2){const r=n/2;t[r]=ze.unpack(e,n,t[r])}return t},ze.fromArray=ze.unpack,ze.maximumComponent=function(e){return A.typeOf.object("cartesian",e),Math.max(e.x,e.y)},ze.minimumComponent=function(e){return A.typeOf.object("cartesian",e),Math.min(e.x,e.y)},ze.minimumByComponent=function(e,t,r){return A.typeOf.object("first",e),A.typeOf.object("second",t),A.typeOf.object("result",r),r.x=Math.min(e.x,t.x),r.y=Math.min(e.y,t.y),r},ze.maximumByComponent=function(e,t,r){return A.typeOf.object("first",e),A.typeOf.object("second",t),A.typeOf.object("result",r),r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r},ze.clamp=function(e,t,r,n){A.typeOf.object("value",e),A.typeOf.object("min",t),A.typeOf.object("max",r),A.typeOf.object("result",n);const o=x.clamp(e.x,t.x,r.x),i=x.clamp(e.y,t.y,r.y);return n.x=o,n.y=i,n},ze.magnitudeSquared=function(e){return A.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},ze.magnitude=function(e){return Math.sqrt(ze.magnitudeSquared(e))};const xe=new ze;ze.distance=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),ze.subtract(e,t,xe),ze.magnitude(xe)},ze.distanceSquared=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),ze.subtract(e,t,xe),ze.magnitudeSquared(xe)},ze.normalize=function(e,t){A.typeOf.object("cartesian",e),A.typeOf.object("result",t);const r=ze.magnitude(e);if(t.x=e.x/r,t.y=e.y/r,isNaN(t.x)||isNaN(t.y))throw new E("normalized result is not a number");return t},ze.dot=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),e.x*t.x+e.y*t.y},ze.cross=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),e.x*t.y-e.y*t.x},ze.multiplyComponents=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x*t.x,r.y=e.y*t.y,r},ze.divideComponents=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x/t.x,r.y=e.y/t.y,r},ze.add=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r},ze.subtract=function(e,t,r){return A.typeOf.object("left",e),A.typeOf.object("right",t),A.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r},ze.multiplyByScalar=function(e,t,r){return A.typeOf.object("cartesian",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r},ze.divideByScalar=function(e,t,r){return A.typeOf.object("cartesian",e),A.typeOf.number("scalar",t),A.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r},ze.negate=function(e,t){return A.typeOf.object("cartesian",e),A.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},ze.abs=function(e,t){return A.typeOf.object("cartesian",e),A.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};const Ie=new ze;ze.lerp=function(e,t,r,n){return A.typeOf.object("start",e),A.typeOf.object("end",t),A.typeOf.number("t",r),A.typeOf.object("result",n),ze.multiplyByScalar(t,r,Ie),n=ze.multiplyByScalar(e,1-r,n),ze.add(Ie,n,n)};const Re=new ze,Le=new ze;ze.angleBetween=function(e,t){return A.typeOf.object("left",e),A.typeOf.object("right",t),ze.normalize(e,Re),ze.normalize(t,Le),x.acosClamped(ze.dot(Re,Le))};const Te=new ze;function Ne(e,t){e=e??0,this._near=e,t=t??Number.MAX_VALUE,this._far=t}ze.mostOrthogonalAxis=function(e,t){A.typeOf.object("cartesian",e),A.typeOf.object("result",t);const r=ze.normalize(e,Te);return ze.abs(r,r),r.x<=r.y?ze.clone(ze.UNIT_X,t):ze.clone(ze.UNIT_Y,t)},ze.equals=function(e,t){return e===t||C(e)&&C(t)&&e.x===t.x&&e.y===t.y},ze.equalsArray=function(e,t,r){return e.x===t[r]&&e.y===t[r+1]},ze.equalsEpsilon=function(e,t,r,n){return e===t||C(e)&&C(t)&&x.equalsEpsilon(e.x,t.x,r,n)&&x.equalsEpsilon(e.y,t.y,r,n)},ze.ZERO=Object.freeze(new ze(0,0)),ze.ONE=Object.freeze(new ze(1,1)),ze.UNIT_X=Object.freeze(new ze(1,0)),ze.UNIT_Y=Object.freeze(new ze(0,1)),ze.prototype.clone=function(e){return ze.clone(this,e)},ze.prototype.equals=function(e){return ze.equals(this,e)},ze.prototype.equalsEpsilon=function(e,t,r){return ze.equalsEpsilon(this,e,t,r)},ze.prototype.toString=function(){return`(${this.x}, ${this.y})`},Object.defineProperties(Ne.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),Ne.packedLength=2,Ne.pack=function(e,t,r){if(!C(e))throw new E("value is required");if(!C(t))throw new E("array is required");return r=r??0,t[r++]=e.near,t[r]=e.far,t},Ne.unpack=function(e,t,r){if(!C(e))throw new E("array is required");return t=t??0,C(r)||(r=new Ne),r.near=e[t++],r.far=e[t],r},Ne.equals=function(e,t){return e===t||C(e)&&C(t)&&e.near===t.near&&e.far===t.far},Ne.clone=function(e,t){if(C(e))return C(t)||(t=new Ne),t.near=e.near,t.far=e.far,t},Ne.prototype.clone=function(e){return Ne.clone(this,e)},Ne.prototype.equals=function(e){return Ne.equals(this,e)};var _e=Object.freeze({NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2,CLAMP_TO_TERRAIN:3,RELATIVE_TO_TERRAIN:4,CLAMP_TO_3D_TILE:5,RELATIVE_TO_3D_TILE:6}),Me=Object.freeze({CENTER:0,LEFT:1,RIGHT:-1}),De=Object.freeze({CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1}),Be=Object.freeze({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2});const Pe=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ve{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const o=Pe[15&r];if(!o)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new ve(s,i,o,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=Pe.indexOf(this.ArrayType),i=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+i+s+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+o]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Ue(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:s}=this,a=[0,o.length-1,0],f=[];for(;a.length;){const u=a.pop()||0,l=a.pop()||0,c=a.pop()||0;if(l-c<=s){for(let s=c;s<=l;s++){const a=i[2*s],u=i[2*s+1];a>=e&&a<=r&&u>=t&&u<=n&&f.push(o[s])}continue}const h=c+l>>1,p=i[2*h],m=i[2*h+1];p>=e&&p<=r&&m>=t&&m<=n&&f.push(o[h]),(0===u?e<=p:t<=m)&&(a.push(c),a.push(h-1),a.push(1-u)),(0===u?r>=p:n>=m)&&(a.push(h+1),a.push(l),a.push(1-u))}return f}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:o,nodeSize:i}=this,s=[0,n.length-1,0],a=[],f=r*r;for(;s.length;){const u=s.pop()||0,l=s.pop()||0,c=s.pop()||0;if(l-c<=i){for(let r=c;r<=l;r++)We(o[2*r],o[2*r+1],e,t)<=f&&a.push(n[r]);continue}const h=c+l>>1,p=o[2*h],m=o[2*h+1];We(p,m,e,t)<=f&&a.push(n[h]),(0===u?e-r<=p:t-r<=m)&&(s.push(c),s.push(h-1),s.push(1-u)),(0===u?e+r>=p:t+r>=m)&&(s.push(h+1),s.push(l),s.push(1-u))}return a}}function Ue(e,t,r,n,o,i){if(o-n<=r)return;const s=n+o>>1;qe(e,t,s,n,o,i),Ue(e,t,r,n,s-1,1-i),Ue(e,t,r,s+1,o,1-i)}function qe(e,t,r,n,o,i){for(;o>n;){if(o-n>600){const s=o-n+1,a=r-n+1,f=Math.log(s),u=.5*Math.exp(2*f/3),l=.5*Math.sqrt(f*u*(s-u)/s)*(a-s/2<0?-1:1);qe(e,t,r,Math.max(n,Math.floor(r-a*u/s+l)),Math.min(o,Math.floor(r+(s-a)*u/s+l)),i)}const s=t[2*r+i];let a=n,f=o;for(Ge(e,t,n,r),t[2*o+i]>s&&Ge(e,t,n,o);a<f;){for(Ge(e,t,a,f),a++,f--;t[2*a+i]<s;)a++;for(;t[2*f+i]>s;)f--}t[2*n+i]===s?Ge(e,t,n,f):(f++,Ge(e,t,f,o)),f<=r&&(n=f+1),r<=f&&(o=f-1)}}function Ge(e,t,r,n){ke(e,r,n),ke(t,2*r,2*n),ke(t,2*r+1,2*n+1)}function ke(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function We(e,t,r,n){const o=e-r,i=t-n;return o*o+i*i}var $e;function He(e,t){return toString.call(e)===`[object ${t}]`}function Ye(e){return He(e,"String")}function Ve(e){return He(e,"Number")}function Ke(e){return void 0!==e}function Ze(e={},t={}){let r;for(r in t)e[r]=t[r];return e}$e||($e=1,function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function t(e,t){var r=e[0],n=e[1],o=e[2],i=e[3];n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&o|~n&i)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&o)+t[1]-389564586|0)<<12|i>>>20)+r|0)&r|~i&n)+t[2]+606105819|0)<<17|o>>>15)+i|0)&i|~o&r)+t[3]-1044525330|0)<<22|n>>>10)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&o|~n&i)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&o)+t[5]+1200080426|0)<<12|i>>>20)+r|0)&r|~i&n)+t[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&r)+t[7]-45705983|0)<<22|n>>>10)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&o|~n&i)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&o)+t[9]-1958414417|0)<<12|i>>>20)+r|0)&r|~i&n)+t[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&r)+t[11]-1990404162|0)<<22|n>>>10)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&o|~n&i)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&o)+t[13]-40341101|0)<<12|i>>>20)+r|0)&r|~i&n)+t[14]-1502002290|0)<<17|o>>>15)+i|0)&i|~o&r)+t[15]+1236535329|0)<<22|n>>>10)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&i|o&~i)+t[1]-165796510|0)<<5|r>>>27)+n|0)&o|n&~o)+t[6]-1069501632|0)<<9|i>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|o>>>18)+i|0)&r|i&~r)+t[0]-373897302|0)<<20|n>>>12)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&i|o&~i)+t[5]-701558691|0)<<5|r>>>27)+n|0)&o|n&~o)+t[10]+38016083|0)<<9|i>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|o>>>18)+i|0)&r|i&~r)+t[4]-405537848|0)<<20|n>>>12)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&i|o&~i)+t[9]+568446438|0)<<5|r>>>27)+n|0)&o|n&~o)+t[14]-1019803690|0)<<9|i>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|o>>>18)+i|0)&r|i&~r)+t[8]+1163531501|0)<<20|n>>>12)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n&i|o&~i)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&o|n&~o)+t[2]-51403784|0)<<9|i>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|o>>>18)+i|0)&r|i&~r)+t[12]-1926607734|0)<<20|n>>>12)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n^o^i)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^o)+t[8]-2022574463|0)<<11|i>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|o>>>16)+i|0)^i^r)+t[14]-35309556|0)<<23|n>>>9)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n^o^i)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^o)+t[4]+1272893353|0)<<11|i>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|o>>>16)+i|0)^i^r)+t[10]-1094730640|0)<<23|n>>>9)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n^o^i)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^o)+t[0]-358537222|0)<<11|i>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|o>>>16)+i|0)^i^r)+t[6]+76029189|0)<<23|n>>>9)+o|0,n=((n+=((o=((o+=((i=((i+=((r=((r+=(n^o^i)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^o)+t[12]-421815835|0)<<11|i>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|o>>>16)+i|0)^i^r)+t[2]-995338651|0)<<23|n>>>9)+o|0,n=((n+=((i=((i+=(n^((r=((r+=(o^(n|~i))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~o))+t[7]+1126891415|0)<<10|i>>>22)+r|0)^((o=((o+=(r^(i|~n))+t[14]-1416354905|0)<<15|o>>>17)+i|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+o|0,n=((n+=((i=((i+=(n^((r=((r+=(o^(n|~i))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~o))+t[3]-1894986606|0)<<10|i>>>22)+r|0)^((o=((o+=(r^(i|~n))+t[10]-1051523|0)<<15|o>>>17)+i|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+o|0,n=((n+=((i=((i+=(n^((r=((r+=(o^(n|~i))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~o))+t[15]-30611744|0)<<10|i>>>22)+r|0)^((o=((o+=(r^(i|~n))+t[6]-1560198380|0)<<15|o>>>17)+i|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+o|0,n=((n+=((i=((i+=(n^((r=((r+=(o^(n|~i))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~o))+t[11]-1120210379|0)<<10|i>>>22)+r|0)^((o=((o+=(r^(i|~n))+t[2]+718787259|0)<<15|o>>>17)+i|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+o|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}function r(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var n,o,i,s,a,f,u=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=u;n+=64)t(l,r(e.substring(n-64,n)));for(o=(e=e.substring(n-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<o;n+=1)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(t(l,i),n=0;n<16;n+=1)i[n]=0;return s=(s=8*u).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),f=parseInt(s[1],16)||0,i[14]=a,i[15]=f,t(l,i),l}function i(e){var r,o,i,s,a,f,u=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=u;r+=64)t(l,n(e.subarray(r-64,r)));for(o=(e=r-64<u?e.subarray(r-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<o;r+=1)i[r>>2]|=e[r]<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(t(l,i),r=0;r<16;r+=1)i[r]=0;return s=(s=8*u).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),f=parseInt(s[1],16)||0,i[14]=a,i[15]=f,t(l,i),l}function s(t){var r,n="";for(r=0;r<4;r+=1)n+=e[t>>8*r+4&15]+e[t>>8*r&15];return n}function a(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function f(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function u(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function l(){this.reset()}a(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,r){var n,o,i,s,a=this.byteLength,f=e(t,a),u=a;return undefined!==r&&(u=e(r,a)),f>u?new ArrayBuffer(0):(n=u-f,o=new ArrayBuffer(n),i=new Uint8Array(o),s=new Uint8Array(this,f,n),i.set(s),o)}}(),l.prototype.append=function(e){return this.appendBinary(f(e)),this},l.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var n,o=this._buff.length;for(n=64;n<=o;n+=64)t(this._hash,r(this._buff.substring(n-64,n)));return this._buff=this._buff.substring(n-64),this},l.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),r=a(this._hash),e&&(r=u(r)),this.reset(),r},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},l.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(e,r){var n,o,i,s=r;if(e[s>>2]|=128<<(s%4<<3),s>55)for(t(this._hash,e),s=0;s<16;s+=1)e[s]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(n[2],16),i=parseInt(n[1],16)||0,e[14]=o,e[15]=i,t(this._hash,e)},l.hash=function(e,t){return l.hashBinary(f(e),t)},l.hashBinary=function(e,t){var r=a(o(e));return t?u(r):r},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(e){var r,o=function(e,t){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e)),r.set(new Uint8Array(t),e.byteLength),r}(this._buff.buffer,e),i=o.length;for(this._length+=e.byteLength,r=64;r<=i;r+=64)t(this._hash,n(o.subarray(r-64,r)));return this._buff=r-64<i?new Uint8Array(o.buffer.slice(r-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=n[t]<<(t%4<<3);return this._finish(i,o),r=a(this._hash),e&&(r=u(r)),this.reset(),r},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var e=l.prototype.getState.call(this);return e.buff=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}(e.buff),e},l.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var r,n=e.length,o=new ArrayBuffer(n),i=new Uint8Array(o);for(r=0;r<n;r+=1)i[r]=e.charCodeAt(r);return t?i:o}(e.buff,!0),l.prototype.setState.call(this,e)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(e,t){var r=a(i(new Uint8Array(e)));return t?u(r):r}}());class Qe{show=!0;minLevel;maxLevel;weight;scale=1;offset;fontColor="#000";fontFamily="";fontSize=10;backgroundColor;backgroundPadding;outlineColor;outlineAlpha;outlineWidth;imgUrl;imgWidth;imgHeight;labelField="name";filterField;includeValue;excludeValue;near;far;children;get font(){return this.fontSize+"px "+this.fontFamily}constructor(e){e&&this.copyFrom(e)}static fromOption(e){const t={};if(Ve(e.scale)&&(t.scale=e.scale),Ve(e.minLevel)&&(t.minLevel=e.minLevel),Ve(e.maxLevel)&&(t.maxLevel=e.maxLevel),Ve(e.near)&&(t.near=e.near),Ve(e.far)&&(t.far=e.far),Ke(e.fontSize)||Ye(e.fontFamily)){const r=e.fontSize??10,n=e.fontFamily??"";t.font=r+"px "+n}if(e.fontColor&&(t.fillColor=Oe.fromCssColorString(e.fontColor)),Ye(e.backgroundColor)&&(t.showBackground=!0,t.backgroundColor=Oe.fromCssColorString(e.backgroundColor),t.backgroundPadding=new ze(e.backgroundPadding,e.backgroundPadding)),e.outlineColor&&(t.style=Be.FILL_AND_OUTLINE,t.outlineColor=Oe.fromCssColorString(e.outlineColor).withAlpha(e.outlineAlpha??1),t.outlineWidth=e.outlineWidth??2),e.imgUrl){t.image=e.imgUrl,t.width=e.imgWidth,t.height=e.imgHeight;const r=Ve(e.offset)?e.offset:0;t.pixelOffset=new ze(0,r)}else""===e.imgUrl&&(t.image=void 0);return t}static fromDefaultOption(e){const t={show:!0,style:Be.FILL,pixelOffset:ze.ZERO,eyeOffset:L.ZERO,horizontalOrigin:Me.CENTER,verticalOrigin:De.CENTER,heightReference:_e.CLAMP_TO_GROUND,distanceDisplayCondition:new Ne(0,2e7),disableDepthTestDistance:1e8};if(Ve(e.scale)&&(t.scale=e.scale),Ve(e.minLevel)&&(t.minLevel=e.minLevel),Ve(e.maxLevel)&&(t.maxLevel=e.maxLevel),Ke(e.fontSize)||Ye(e.fontFamily)){const r=e.fontSize??10,n=e.fontFamily??"";t.font=r+"px "+n}if(e.fontColor&&(t.fillColor=Oe.fromCssColorString(e.fontColor)),Ye(e.backgroundColor)&&(t.showBackground=!0,t.backgroundColor=Oe.fromCssColorString(e.backgroundColor),t.backgroundPadding=new ze(e.backgroundPadding,e.backgroundPadding)),e.outlineColor&&(t.style=Be.FILL_AND_OUTLINE,t.outlineColor=Oe.fromCssColorString(e.outlineColor).withAlpha(e.outlineAlpha??1),t.outlineWidth=e.outlineWidth??2),e.imgUrl){t.image=e.imgUrl,t.width=e.imgWidth,t.height=e.imgHeight;const r=Ve(e.offset)?e.offset:0;t.pixelOffset=new ze(0,r)}else""===e.imgUrl&&(t.image=void 0);return t}clone(){const e=new Qe;return e.show=this.show,e.minLevel=this.minLevel,e.maxLevel=this.maxLevel,e.near=this.near,e.far=this.far,e.weight=this.weight,e.offset=this.offset,this.fontColor&&(e.fontColor=this.fontColor),this.fontSize&&(e.fontSize=this.fontSize),this.fontFamily&&(e.fontFamily=this.fontFamily),e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.outlineColor=this.outlineColor,e.outlineAlpha=this.outlineAlpha,e.outlineWidth=this.outlineWidth,e.imgUrl=this.imgUrl,e.imgWidth=this.imgWidth,e.imgHeight=this.imgHeight,e.labelField=this.labelField,e.filterField=this.filterField,e.includeValue=this.includeValue,e.excludeValue=this.excludeValue,e.children=this.children?[...this.children]:void 0,e}copyFrom(e){this.show=e.show,this.minLevel=e.minLevel,this.maxLevel=e.maxLevel,this.near=e.near,this.far=e.far,this.weight=e.weight,this.offset=e.offset,e.fontColor&&(this.fontColor=e.fontColor),e.fontSize&&(this.fontSize=e.fontSize),e.fontFamily&&(this.fontFamily=e.fontFamily),this.backgroundColor=e.backgroundColor,this.backgroundPadding=e.backgroundPadding,this.outlineColor=e.outlineColor,this.outlineAlpha=e.outlineAlpha,this.outlineWidth=e.outlineWidth,this.imgUrl=e.imgUrl,this.imgWidth=e.imgWidth,this.imgHeight=e.imgHeight,e.labelField&&(this.labelField=e.labelField),this.filterField=e.filterField,this.includeValue=e.includeValue,this.excludeValue=e.excludeValue,this.children=e.children?[...e.children]:void 0}getLabelOption(){const e={show:!0,font:this.font,fillColor:Oe.fromCssColorString(this.fontColor),style:Be.FILL,scale:this.scale,pixelOffset:ze.ZERO,eyeOffset:L.ZERO,horizontalOrigin:Me.CENTER,verticalOrigin:De.CENTER,heightReference:_e.CLAMP_TO_GROUND,distanceDisplayCondition:new Ne(0,2e7),disableDepthTestDistance:1e8};Ve(this.weight)&&(e.eyeOffset=new L(0,0,-100*this.weight)),this.backgroundColor&&(e.showBackground=!0,e.backgroundColor=Oe.fromCssColorString(this.backgroundColor),e.backgroundPadding=new ze(this.backgroundPadding??7,this.backgroundPadding??5)),this.outlineColor&&(e.style=Be.FILL_AND_OUTLINE,e.outlineColor=Oe.fromCssColorString(this.outlineColor).withAlpha(this.outlineAlpha??1),e.outlineWidth=this.outlineWidth??2);let t=0;return Ve(this.offset)&&(t=this.offset,e.pixelOffset=new ze(0,t)),this.imgUrl&&(e.image=this.imgUrl,e.width=this.imgWidth,e.height=this.imgHeight),e}getBillboardOption(){return this.imgUrl?{image:this.imgUrl,width:this.imgWidth,height:this.imgHeight}:{}}}let Xe=new Map,Je=new Map;function et(e,t){if(t&&t.length>0){let r,n;const o=t.length;for(let i=0;i<o;i++){const o=t[i];if(o&&o.includeValue===e){n=o.fontSize,r=r?Ze(r,Qe.fromOption(o)):Qe.fromOption(o);break}}return{childOptions:r,childFontSize:n}}}function tt(e,t){return!(e.x>t.x+t.width||t.x>e.x+e.width||e.y>t.y+t.height||t.y>e.y+e.height)}f(Object.freeze({__proto__:null,cancelPromise:function(e){Je.set(e,!0)},checkRectangleNoIntersect:function(e,t,r){const n=Xe.get(e);if(!n)return!1;const o=n.idRectMap;let i=!1;for(let[s,a]of o)if(a&&(i=tt(a,t),i))break;return i||o.set(r,t),i},clear:function(e){if(Xe.has(e)){const t=Xe.get(e);t&&(t.ptList.length=0,t.indexKDB.data=null,t.idRectMap.clear(),t.baseLabelOptions=void 0,Xe.delete(e))}},deleteLabelRectangle:function(e,t){const r=Xe.get(e);if(!r)return!1;const n=r.idRectMap;return!!n&&n.delete(t)},filterByBounds:function(e,t,r){if(!t||!Xe.has(e))return;const n=Xe.get(e);if(!n)return;Je.set(e,!1);const o=x.toDegrees(t.west),i=x.toDegrees(t.east),s=x.toDegrees(t.north),a=x.toDegrees(t.south),f=n.indexKDB.range(o,a,i,s);if(Je.get(e))throw f.length=0,new Error("0");if(null!=r){const t=f.length,o=[];for(let i=0;i<t;i++){if(Je.get(e))throw o.length=0,f.length=0,new Error("0");const t=f[i],s=n.ptList[t];null!=s.minZoom&&s.maxZoom?r>=s.minZoom&&r<=s.maxZoom&&o.push(t):o.push(t)}return f.length=0,o}return f},getFilterPointsList:function(e,t){if(!Xe.has(e))return;const r=Xe.get(e);if(!r)return;const n=[],o=t.length;for(let i=0;i<o;i++){const e=t[i],o=r.ptList[e];n.push(o)}return n},getLabelEntities:function(e,t){if(!Xe.has(e))return;const r=Xe.get(e);if(!r)return;const n=r.baseLabelOptions,o=[],i=t.length;for(let s=0;s<i;s++){const e=t[s],i=r.ptList[e];let a=n;i.childOptions&&(a=Ze({...n},i.childOptions));const f=i.position,u={labelOption:void 0,billboardOption:void 0};if(a.image){const t={id:e,show:!0,position:f,disableDepthTestDistance:Number.POSITIVE_INFINITY,image:a.image,width:a.width,height:a.height};u.billboardOption=t,delete a.image,delete a.width,delete a.height}const l=i.name;u.labelOption={position:f,text:l,id:e,...a},o.push(u)}return o},getLabelPointList:function(e,t){if(!Xe.has(e))return;const r=Xe.get(e);return r?t.map(e=>r.ptList[e]):void 0},isOverlapping:tt,isPointOnFrontOfGlobe:function(e,t){return!(L.distance(e,t)>6371e3)},loadLabelPoints:async function(e,t,r){if(!e||Xe.has(e))return;const n=await fetch(t);let o=await n.json();if(!o)return;const i=o.features;let s=r.minLevel??1,a=r.maxLevel??18;const f=r.labelField,u=r.filterField??f,l=function(e){const t=Qe.fromDefaultOption(e);let r;return Ye(e.excludeValue)&&(r=e.excludeValue.split(",")),{baseLabelOptions:t,exclude:r}}(r),c=l.exclude,h=1.2*(r.fontSize??12),p=r.children;if(i){const t=i.length,r=new ve(t),n=new Array;for(let e=0;e<t;e++){const t=i[e],o=t.properties;if(o){const i=o[f],l=o[u],m=o.minl,d=o.maxl,y=t.geometry.coordinates;let g,b=h;if(c&&c.indexOf(l)>=0){const e=et(i,p);e&&(e.childFontSize&&(b=1.2*e.childFontSize),e.childOptions&&(g=e.childOptions))}const O={id:e,name:i,minZoom:m,maxZoom:d,position:L.fromDegrees(y[0],y[1]),textWidth:b*i.length,textHeight:b,childOptions:g};r.add(y[0],y[1]),n.push(O),Ve(m)&&m<s&&(s=m),Ve(d)&&d>a&&(a=d)}}return r.finish(),Xe.set(e,{indexKDB:r,ptList:n,baseLabelOptions:l.baseLabelOptions,exclude:l.exclude,idRectMap:new Map}),i.length=0,o=void 0,{min:s,max:a}}}}));
