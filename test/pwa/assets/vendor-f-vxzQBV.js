var __defProp=Object.defineProperty,__typeError=e=>{throw TypeError(e)},__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),__accessCheck=(e,t,r)=>t.has(e)||__typeError("Cannot "+r),__privateGet=(e,t,r)=>(__accessCheck(e,t,"read from private field"),r?r.call(e):t.get(e)),__privateAdd=(e,t,r)=>t.has(e)?__typeError("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),__privateSet=(e,t,r,n)=>(__accessCheck(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{c as commonjsGlobal,g as getDefaultExportFromCjs$1,a as getAugmentedNamespace}from"./lottie-web-exp-8BOGrbHZ.js";import{r as ref$1,V as reactive,K as markRaw,d as defineComponent,a2 as createApp,a3 as onBeforeUnmount,c as onDeactivated,a4 as getCurrentInstance,n as nextTick,w as watch$2,o as onMounted,C as computed,a as onUnmounted,h as h$2,a5 as Teleport,u as unref,k as withDirectives,T as Transition,a6 as onBeforeUpdate,J as inject,b as onActivated,Z as toRaw,a7 as TransitionGroup,W as onBeforeMount,a8 as onUpdated,a9 as provide,aa as KeepAlive,E as isRef,e as createBlock,g as openBlock,v as vShow,p as createBaseVNode,i as renderSlot,ab as shallowReactive,t as resolveComponent,f as withCtx,j as createVNode,N as normalizeClass,m as createElementBlock,z as toDisplayString,ac as mergeProps,A as createCommentVNode,F as Fragment,H as normalizeStyle$1,D as withKeys,ad as pushScopeId,ae as popScopeId,af as withScopeId,ag as normalizeProps,ah as guardReactiveProps}from"./@vue-exp-CvWX4Ub_.js";import{_ as __vitePreload}from"./monaco-editor-exp-Cp7eE-b9.js";const global=globalThis||self;function injectProp(e,t,r,n){return Object.defineProperty(e,t,{get:r,set:n,enumerable:!0}),e}function injectMultipleProps(e,t){for(const r in t)injectProp(e,r,t[r]);return e}const isRuntimeSsrPreHydration=ref$1(!1);let preHydrationBrowser;function getMatch(e,t){const r=/(edg|edge|edga|edgios)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(vivaldi)[\/]([\w.]+)/.exec(e)||/(chrome|crios)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(e)||/(webkit)[\/]([\w.]+).*(version)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(e)||/(firefox|fxios)[\/]([\w.]+)/.exec(e)||/(webkit)[\/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[\/]([\w.]+)/.exec(e)||[];return{browser:r[5]||r[3]||r[1]||"",version:r[4]||r[2]||"0",platform:t[0]||""}}function getPlatformMatch(e){return/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(silk)/.exec(e)||/(android)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||/(playbook)/.exec(e)||/(bb)/.exec(e)||/(blackberry)/.exec(e)||[]}const hasTouch="ontouchstart"in window||window.navigator.maxTouchPoints>0;function getPlatform(e){const t=e.toLowerCase(),r=getMatch(t,getPlatformMatch(t)),n={mobile:!1,desktop:!1,cordova:!1,capacitor:!1,nativeMobile:!1,electron:!1,bex:!1,linux:!1,mac:!1,win:!1,cros:!1,chrome:!1,firefox:!1,opera:!1,safari:!1,vivaldi:!1,edge:!1,edgeChromium:!1,ie:!1,webkit:!1,android:!1,ios:!1,ipad:!1,iphone:!1,ipod:!1,kindle:!1,winphone:!1,blackberry:!1,playbook:!1,silk:!1};r.browser&&(n[r.browser]=!0,n.version=r.version,n.versionNumber=parseInt(r.version,10)),r.platform&&(n[r.platform]=!0);const i=n.android||n.ios||n.bb||n.blackberry||n.ipad||n.iphone||n.ipod||n.kindle||n.playbook||n.silk||n["windows phone"];if(!0===i||-1!==t.indexOf("mobile")?n.mobile=!0:n.desktop=!0,n["windows phone"]&&(n.winphone=!0,delete n["windows phone"]),n.edga||n.edgios||n.edg?(n.edge=!0,r.browser="edge"):n.crios?(n.chrome=!0,r.browser="chrome"):n.fxios&&(n.firefox=!0,r.browser="firefox"),(n.ipod||n.ipad||n.iphone)&&(n.ios=!0),n.vivaldi&&(r.browser="vivaldi",n.vivaldi=!0),(n.chrome||n.opr||n.safari||n.vivaldi||!0===n.mobile&&!0!==n.ios&&!0!==i)&&(n.webkit=!0),n.opr&&(r.browser="opera",n.opera=!0),n.safari&&(n.blackberry||n.bb?(r.browser="blackberry",n.blackberry=!0):n.playbook?(r.browser="playbook",n.playbook=!0):n.android?(r.browser="android",n.android=!0):n.kindle?(r.browser="kindle",n.kindle=!0):n.silk&&(r.browser="silk",n.silk=!0)),n.name=r.browser,n.platform=r.platform,-1!==t.indexOf("electron"))n.electron=!0;else if(-1!==document.location.href.indexOf("-extension://"))n.bex=!0;else{if(void 0!==window.Capacitor?(n.capacitor=!0,n.nativeMobile=!0,n.nativeMobileWrapper="capacitor"):void 0===window._cordovaNative&&void 0===window.cordova||(n.cordova=!0,n.nativeMobile=!0,n.nativeMobileWrapper="cordova"),!0===isRuntimeSsrPreHydration.value&&(preHydrationBrowser={is:{...n}}),!0===hasTouch&&!0===n.mac&&(!0===n.desktop&&!0===n.safari||!0===n.nativeMobile&&!0!==n.android&&!0!==n.ios&&!0!==n.ipad)){delete n.mac,delete n.desktop;const e=Math.min(window.innerHeight,window.innerWidth)>414?"ipad":"iphone";Object.assign(n,{mobile:!0,ios:!0,platform:e,[e]:!0})}!0!==n.mobile&&window.navigator.userAgentData&&window.navigator.userAgentData.mobile&&(delete n.desktop,n.mobile=!0)}return n}const userAgent=navigator.userAgent||navigator.vendor||window.opera,ssrClient={has:{touch:!1,webStorage:!1},within:{iframe:!1}},client={userAgent:userAgent,is:getPlatform(userAgent),has:{touch:hasTouch},within:{iframe:window.self!==window.top}},Platform={install(e){const{$q:t}=e;!0===isRuntimeSsrPreHydration.value?(e.onSSRHydrated.push((()=>{Object.assign(t.platform,client),isRuntimeSsrPreHydration.value=!1})),t.platform=reactive(this)):t.platform=this}};{let e;injectProp(client.has,"webStorage",(()=>{if(void 0!==e)return e;try{if(window.localStorage)return e=!0,!0}catch(t){}return e=!1,!1})),Object.assign(Platform,client),!0===isRuntimeSsrPreHydration.value&&(Object.assign(Platform,preHydrationBrowser,ssrClient),preHydrationBrowser=null)}function createComponent(e){return markRaw(defineComponent(e))}function createDirective(e){return markRaw(e)}const createReactivePlugin=(e,t)=>{const r=reactive(e);for(const n in e)injectProp(t,n,(()=>r[n]),(e=>{r[n]=e}));return t},listenOpts$1={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{const e=Object.defineProperty({},"passive",{get(){Object.assign(listenOpts$1,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,e),window.removeEventListener("qtest",null,e)}catch(_2){}function noop$2(){}function leftClick(e){return 0===e.button}function position(e){return e.touches&&e.touches[0]?e=e.touches[0]:e.changedTouches&&e.changedTouches[0]?e=e.changedTouches[0]:e.targetTouches&&e.targetTouches[0]&&(e=e.targetTouches[0]),{top:e.clientY,left:e.clientX}}function getEventPath$1(e){if(e.path)return e.path;if(e.composedPath)return e.composedPath();const t=[];let r=e.target;for(;r;){if(t.push(r),"HTML"===r.tagName)return t.push(document),t.push(window),t;r=r.parentElement}}function stop$1(e){e.stopPropagation()}function prevent(e){!1!==e.cancelable&&e.preventDefault()}function stopAndPrevent$1(e){!1!==e.cancelable&&e.preventDefault(),e.stopPropagation()}function preventDraggable(e,t){if(void 0===e||!0===t&&!0===e.__dragPrevented)return;const r=!0===t?e=>{e.__dragPrevented=!0,e.addEventListener("dragstart",prevent,listenOpts$1.notPassiveCapture)}:e=>{delete e.__dragPrevented,e.removeEventListener("dragstart",prevent,listenOpts$1.notPassiveCapture)};e.querySelectorAll("a, img").forEach(r)}function addEvt(e,t,r){const n=`__q_${t}_evt`;e[n]=void 0!==e[n]?e[n].concat(r):r,r.forEach((t=>{t[0].addEventListener(t[1],e[t[2]],listenOpts$1[t[3]])}))}function cleanEvt(e,t){const r=`__q_${t}_evt`;void 0!==e[r]&&(e[r].forEach((t=>{t[0].removeEventListener(t[1],e[t[2]],listenOpts$1[t[3]])})),e[r]=void 0)}function debounce$1(e,t=250,r){let n=null;function i(){const r=arguments;null!==n&&clearTimeout(n),n=setTimeout((()=>{n=null,e.apply(this,r)}),t)}return i.cancel=()=>{null!==n&&clearTimeout(n)},i}const SIZE_LIST=["sm","md","lg","xl"],{passive:passive$1}=listenOpts$1,Screen=createReactivePlugin({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:noop$2,setDebounce:noop$2,install({$q:e,onSSRHydrated:t}){if(e.screen=this,!0===this.__installed)return void(void 0!==e.config.screen&&(!1===e.config.screen.bodyClasses?document.body.classList.remove(`screen--${this.name}`):this.__update(!0)));const{visualViewport:r}=window,n=r||window,i=document.scrollingElement||document.documentElement,o=void 0===r||!0===client.is.mobile?()=>[Math.max(window.innerWidth,i.clientWidth),Math.max(window.innerHeight,i.clientHeight)]:()=>[r.width*r.scale+window.innerWidth-i.clientWidth,r.height*r.scale+window.innerHeight-i.clientHeight],a=!0===e.config.screen?.bodyClasses;this.__update=e=>{const[t,r]=o();if(r!==this.height&&(this.height=r),t!==this.width)this.width=t;else if(!0!==e)return;let n=this.sizes;this.gt.xs=t>=n.sm,this.gt.sm=t>=n.md,this.gt.md=t>=n.lg,this.gt.lg=t>=n.xl,this.lt.sm=t<n.sm,this.lt.md=t<n.md,this.lt.lg=t<n.lg,this.lt.xl=t<n.xl,this.xs=this.lt.sm,this.sm=!0===this.gt.xs&&!0===this.lt.md,this.md=!0===this.gt.sm&&!0===this.lt.lg,this.lg=!0===this.gt.md&&!0===this.lt.xl,this.xl=this.gt.lg,n=(!0===this.xs?"xs":!0===this.sm&&"sm")||!0===this.md&&"md"||!0===this.lg&&"lg"||"xl",n!==this.name&&(!0===a&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${n}`)),this.name=n)};let s,l={},c=16;this.setSizes=e=>{SIZE_LIST.forEach((t=>{void 0!==e[t]&&(l[t]=e[t])}))},this.setDebounce=e=>{c=e};const u=()=>{const e=getComputedStyle(document.body);e.getPropertyValue("--q-size-sm")&&SIZE_LIST.forEach((t=>{this.sizes[t]=parseInt(e.getPropertyValue(`--q-size-${t}`),10)})),this.setSizes=e=>{SIZE_LIST.forEach((t=>{e[t]&&(this.sizes[t]=e[t])})),this.__update(!0)},this.setDebounce=e=>{void 0!==s&&n.removeEventListener("resize",s,passive$1),s=e>0?debounce$1(this.__update,e):this.__update,n.addEventListener("resize",s,passive$1)},this.setDebounce(c),0!==Object.keys(l).length?(this.setSizes(l),l=void 0):this.__update(),!0===a&&"xs"===this.name&&document.body.classList.add("screen--xs")};!0===isRuntimeSsrPreHydration.value?t.push(u):u()}}),Plugin$6=createReactivePlugin({isActive:!1,mode:!1},{__media:void 0,set(e){Plugin$6.mode=e,"auto"===e?(void 0===Plugin$6.__media&&(Plugin$6.__media=window.matchMedia("(prefers-color-scheme: dark)"),Plugin$6.__updateMedia=()=>{Plugin$6.set("auto")},Plugin$6.__media.addListener(Plugin$6.__updateMedia)),e=Plugin$6.__media.matches):void 0!==Plugin$6.__media&&(Plugin$6.__media.removeListener(Plugin$6.__updateMedia),Plugin$6.__media=void 0),Plugin$6.isActive=!0===e,document.body.classList.remove("body--"+(!0===e?"light":"dark")),document.body.classList.add("body--"+(!0===e?"dark":"light"))},toggle(){Plugin$6.set(!1===Plugin$6.isActive)},install({$q:e,ssrContext:t}){const r=e.config.dark;e.dark=this,!0!==this.__installed&&this.set(void 0!==r&&r)}});function setCssVar(e,t,r=document.body){if("string"!=typeof e)throw new TypeError("Expected a string as propName");if("string"!=typeof t)throw new TypeError("Expected a string as value");if(!(r instanceof Element))throw new TypeError("Expected a DOM element");r.style.setProperty(`--q-${e}`,t)}let lastKeyCompositionStatus=!1;function onKeyDownComposition(e){lastKeyCompositionStatus=!0===e.isComposing}function shouldIgnoreKey(e){return!0===lastKeyCompositionStatus||e!==Object(e)||!0===e.isComposing||!0===e.qKeyEvent}function isKeyCode(e,t){return!0!==shouldIgnoreKey(e)&&[].concat(t).includes(e.keyCode)}function getMobilePlatform(e){return!0===e.ios?"ios":!0===e.android?"android":void 0}function getBodyClasses({is:e,has:t,within:r},n){const i=[!0===e.desktop?"desktop":"mobile",(!1===t.touch?"no-":"")+"touch"];if(!0===e.mobile){const t=getMobilePlatform(e);void 0!==t&&i.push("platform-"+t)}if(!0===e.nativeMobile){const t=e.nativeMobileWrapper;i.push(t),i.push("native-mobile"),!0!==e.ios||void 0!==n[t]&&!1===n[t].iosStatusBarPadding||i.push("q-ios-padding")}else!0===e.electron?i.push("electron"):!0===e.bex&&i.push("bex");return!0===r.iframe&&i.push("within-iframe"),i}function applyClientSsrCorrections(){const{is:e}=client,t=document.body.className,r=new Set(t.replace(/ {2}/g," ").split(" "));if(!0!==e.nativeMobile&&!0!==e.electron&&!0!==e.bex)if(!0===e.desktop)r.delete("mobile"),r.delete("platform-ios"),r.delete("platform-android"),r.add("desktop");else if(!0===e.mobile){r.delete("desktop"),r.add("mobile"),r.delete("platform-ios"),r.delete("platform-android");const t=getMobilePlatform(e);void 0!==t&&r.add(`platform-${t}`)}!0===client.has.touch&&(r.delete("no-touch"),r.add("touch")),!0===client.within.iframe&&r.add("within-iframe");const n=Array.from(r).join(" ");t!==n&&(document.body.className=n)}function setColors(e){for(const t in e)setCssVar(t,e[t])}const Body={install(e){if(!0!==this.__installed){if(!0===isRuntimeSsrPreHydration.value)applyClientSsrCorrections();else{const{$q:t}=e;void 0!==t.config.brand&&setColors(t.config.brand);const r=getBodyClasses(client,t.config);document.body.classList.add.apply(document.body.classList,r)}!0===client.is.ios&&document.body.addEventListener("touchstart",noop$2),window.addEventListener("keydown",onKeyDownComposition,!0)}}},getTrue=()=>!0;function filterInvalidPath(e){return"string"==typeof e&&""!==e&&"/"!==e&&"#/"!==e}function normalizeExitPath(e){return!0===e.startsWith("#")&&(e=e.substring(1)),!1===e.startsWith("/")&&(e="/"+e),!0===e.endsWith("/")&&(e=e.substring(0,e.length-1)),"#"+e}function getShouldExitFn(e){if(!1===e.backButtonExit)return()=>!1;if("*"===e.backButtonExit)return getTrue;const t=["#/"];return!0===Array.isArray(e.backButtonExit)&&t.push(...e.backButtonExit.filter(filterInvalidPath).map(normalizeExitPath)),()=>t.includes(window.location.hash)}const History={__history:[],add:noop$2,remove:noop$2,install({$q:e}){if(!0===this.__installed)return;const{cordova:t,capacitor:r}=client.is;if(!0!==t&&!0!==r)return;const n=e.config[!0===t?"cordova":"capacitor"];if(!1===n?.backButton)return;if(!0===r&&(void 0===window.Capacitor||void 0===window.Capacitor.Plugins.App))return;this.add=e=>{void 0===e.condition&&(e.condition=getTrue),this.__history.push(e)},this.remove=e=>{const t=this.__history.indexOf(e);t>=0&&this.__history.splice(t,1)};const i=getShouldExitFn(Object.assign({backButtonExit:!0},n)),o=()=>{if(this.__history.length){const e=this.__history[this.__history.length-1];!0===e.condition()&&(this.__history.pop(),e.handler())}else!0===i()?navigator.app.exitApp():window.history.back()};!0===t?document.addEventListener("deviceready",(()=>{document.addEventListener("backbutton",o,!1)})):window.Capacitor.Plugins.App.addListener("backButton",o)}},defaultLang={isoName:"en-US",nativeName:"English (US)",label:{clear:"Clear",ok:"OK",cancel:"Cancel",close:"Close",set:"Set",select:"Select",reset:"Reset",remove:"Remove",update:"Update",create:"Create",search:"Search",filter:"Filter",refresh:"Refresh",expand:e=>e?`Expand "${e}"`:"Expand",collapse:e=>e?`Collapse "${e}"`:"Collapse"},date:{days:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),daysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),firstDayOfWeek:0,format24h:!1,pluralDay:"days",prevMonth:"Previous month",nextMonth:"Next month",prevYear:"Previous year",nextYear:"Next year",today:"Today",prevRangeYears:e=>`Previous ${e} years`,nextRangeYears:e=>`Next ${e} years`},table:{noData:"No data available",noResults:"No matching records found",loading:"Loading...",selectedRecords:e=>1===e?"1 record selected.":(0===e?"No":e)+" records selected.",recordsPerPage:"Records per page:",allRows:"All",pagination:(e,t,r)=>e+"-"+t+" of "+r,columns:"Columns"},pagination:{first:"First page",prev:"Previous page",next:"Next page",last:"Last page"},editor:{url:"URL",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",unorderedList:"Unordered List",orderedList:"Ordered List",subscript:"Subscript",superscript:"Superscript",hyperlink:"Hyperlink",toggleFullscreen:"Toggle Fullscreen",quote:"Quote",left:"Left align",center:"Center align",right:"Right align",justify:"Justify align",print:"Print",outdent:"Decrease indentation",indent:"Increase indentation",removeFormat:"Remove formatting",formatting:"Formatting",fontSize:"Font Size",align:"Align",hr:"Insert Horizontal Rule",undo:"Undo",redo:"Redo",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",paragraph:"Paragraph",code:"Code",size1:"Very small",size2:"A bit small",size3:"Normal",size4:"Medium-large",size5:"Big",size6:"Very big",size7:"Maximum",defaultFont:"Default Font",viewSource:"View Source"},tree:{noNodes:"No nodes available",noResults:"No matching nodes found"}};function getLocale(){const e=!0===Array.isArray(navigator.languages)&&0!==navigator.languages.length?navigator.languages[0]:navigator.language;if("string"==typeof e)return e.split(/[-_]/).map(((e,t)=>0===t?e.toLowerCase():t>1||e.length<4?e.toUpperCase():e[0].toUpperCase()+e.slice(1).toLowerCase())).join("-")}const Plugin$5=createReactivePlugin({__qLang:{}},{getLocale:getLocale,set(e=defaultLang,t){const r={...e,rtl:!0===e.rtl,getLocale:getLocale};if(r.set=Plugin$5.set,void 0===Plugin$5.__langConfig||!0!==Plugin$5.__langConfig.noHtmlAttrs){const e=document.documentElement;e.setAttribute("dir",!0===r.rtl?"rtl":"ltr"),e.setAttribute("lang",r.isoName)}Object.assign(Plugin$5.__qLang,r)},install({$q:e,lang:t,ssrContext:r}){e.lang=Plugin$5.__qLang,Plugin$5.__langConfig=e.config.lang,!0===this.__installed?void 0!==t&&this.set(t):(this.props=new Proxy(this.__qLang,{get(){return Reflect.get(...arguments)},ownKeys:e=>Reflect.ownKeys(e).filter((e=>"set"!==e&&"getLocale"!==e))}),this.set(t||defaultLang))}}),materialIcons={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}},Plugin$4=createReactivePlugin({iconMapFn:null,__qIconSet:{}},{set(e,t){const r={...e};r.set=Plugin$4.set,Object.assign(Plugin$4.__qIconSet,r)},install({$q:e,iconSet:t,ssrContext:r}){void 0!==e.config.iconMapFn&&(this.iconMapFn=e.config.iconMapFn),e.iconSet=this.__qIconSet,injectProp(e,"iconMapFn",(()=>this.iconMapFn),(e=>{this.iconMapFn=e})),!0===this.__installed?void 0!==t&&this.set(t):(this.props=new Proxy(this.__qIconSet,{get(){return Reflect.get(...arguments)},ownKeys:e=>Reflect.ownKeys(e).filter((e=>"set"!==e))}),this.set(t||materialIcons))}}),quasarKey="_q_",timelineKey="_q_t_",layoutKey="_q_l_",pageContainerKey="_q_pc_",formKey="_q_fo_",tabsKey="_q_tabs_",uploaderKey="_q_u_";function emptyRenderFn(){}const globalConfig={};let globalConfigIsFrozen=!1;function freezeGlobalConfig(){globalConfigIsFrozen=!0}function isDeepEqual(e,t){if(e===t)return!0;if(null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;let r,n;if(e.constructor===Array){if(r=e.length,r!==t.length)return!1;for(n=r;0!=n--;)if(!0!==isDeepEqual(e[n],t[n]))return!1;return!0}if(e.constructor===Map){if(e.size!==t.size)return!1;let r=e.entries();for(n=r.next();!0!==n.done;){if(!0!==t.has(n.value[0]))return!1;n=r.next()}for(r=e.entries(),n=r.next();!0!==n.done;){if(!0!==isDeepEqual(n.value[1],t.get(n.value[0])))return!1;n=r.next()}return!0}if(e.constructor===Set){if(e.size!==t.size)return!1;const r=e.entries();for(n=r.next();!0!==n.done;){if(!0!==t.has(n.value[0]))return!1;n=r.next()}return!0}if(null!=e.buffer&&e.buffer.constructor===ArrayBuffer){if(r=e.length,r!==t.length)return!1;for(n=r;0!=n--;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const i=Object.keys(e).filter((t=>void 0!==e[t]));if(r=i.length,r!==Object.keys(t).filter((e=>void 0!==t[e])).length)return!1;for(n=r;0!=n--;){const r=i[n];if(!0!==isDeepEqual(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function isObject$2(e){return null!==e&&"object"==typeof e&&!0!==Array.isArray(e)}function isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}function isRegexp(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function isNumber$2(e){return"number"==typeof e&&isFinite(e)}const autoInstalledPlugins=[Platform,Body,Plugin$6,Screen,History,Plugin$5,Plugin$4];function createChildApp(e,t){const r=createApp(e);r.config.globalProperties=t.config.globalProperties;const{reload:n,...i}=t._context;return Object.assign(r._context,i),r}function installPlugins(e,t){t.forEach((t=>{t.install(e),t.__installed=!0}))}function prepareApp(e,t,r){e.config.globalProperties.$q=r.$q,e.provide(quasarKey,r.$q),installPlugins(r,autoInstalledPlugins),void 0!==t.components&&Object.values(t.components).forEach((t=>{!0===isObject$2(t)&&void 0!==t.name&&e.component(t.name,t)})),void 0!==t.directives&&Object.values(t.directives).forEach((t=>{!0===isObject$2(t)&&void 0!==t.name&&e.directive(t.name,t)})),void 0!==t.plugins&&installPlugins(r,Object.values(t.plugins).filter((e=>"function"==typeof e.install&&!1===autoInstalledPlugins.includes(e)))),!0===isRuntimeSsrPreHydration.value&&(r.$q.onSSRHydrated=()=>{r.onSSRHydrated.forEach((e=>{e()})),r.$q.onSSRHydrated=()=>{}})}const installQuasar=function(e,t={}){const r={version:"2.18.6"};!1===globalConfigIsFrozen?(void 0!==t.config&&Object.assign(globalConfig,t.config),r.config={...globalConfig},freezeGlobalConfig()):r.config=t.config||{},prepareApp(e,t,{parentApp:e,$q:r,lang:t.lang,iconSet:t.iconSet,onSSRHydrated:[]})},Quasar={name:"Quasar",version:"2.18.6",install:installQuasar,lang:Plugin$5,iconSet:Plugin$4};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var browser$4={exports:{}},process=browser$4.exports={},cachedSetTimeout,cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(r){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(r){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue$1=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue$1=currentQueue.concat(queue$1):queueIndex=-1,queue$1.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue$1.length;t;){for(currentQueue=queue$1,queue$1=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue$1.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop$1(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue$1.push(new Item(e,t)),1!==queue$1.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop$1,process.addListener=noop$1,process.once=noop$1,process.off=noop$1,process.removeListener=noop$1,process.removeAllListeners=noop$1,process.emit=noop$1,process.prependListener=noop$1,process.prependOnceListener=noop$1,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};var browserExports$1=browser$4.exports;const process$1=getDefaultExportFromCjs(browserExports$1);var buffer={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$3=0,len$1=code$1.length;i$3<len$1;++i$3)lookup[i$3]=code$1[i$3],revLookup[code$1.charCodeAt(i$3)]=i$3;function getLens(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function byteLength(e){var t=getLens(e),r=t[0],n=t[1];return 3*(r+n)/4-n}function _byteLength(e,t,r){return 3*(t+r)/4-r}function toByteArray(e){var t,r,n=getLens(e),i=n[0],o=n[1],a=new Arr(_byteLength(e,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)t=revLookup[e.charCodeAt(r)]<<18|revLookup[e.charCodeAt(r+1)]<<12|revLookup[e.charCodeAt(r+2)]<<6|revLookup[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;return 2===o&&(t=revLookup[e.charCodeAt(r)]<<2|revLookup[e.charCodeAt(r+1)]>>4,a[s++]=255&t),1===o&&(t=revLookup[e.charCodeAt(r)]<<10|revLookup[e.charCodeAt(r+1)]<<4|revLookup[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t),a}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(tripletToBase64(n));return i.join("")}function fromByteArray(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(encodeChunk(e,a,a+o>s?s:a+o));return 1===n?(t=e[r-1],i.push(lookup[t>>2]+lookup[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),i.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var ieee754={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=f,a/=256,c-=8);e[r+p-f]|=128*m}};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
!function(e){const t=base64Js,r=ieee754,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i;const{Uint8Array:o,ArrayBuffer:a,SharedArrayBuffer:s}=globalThis;function l(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new o(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|g(e,t);let n=l(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(a.isView(e))return function(e){if(X(e,o)){const t=new o(e);return f(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,a)||e&&X(e.buffer,a))return f(e,t,r);if(void 0!==s&&(X(e,s)||e&&X(e.buffer,s)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|m(e.length),r=l(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||K(e.length)?l(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),l(e<0?0:0|m(e))}function p(e){const t=e.length<0?0:0|m(e.length),r=l(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new o(e):void 0===r?new o(e,t):new o(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function m(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function g(e,t){if(c.isBuffer(e))return e.length;if(a.isView(e)||X(e,a))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Z(e).length;default:if(i)return n?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),K(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof o.prototype.indexOf?i?o.prototype.indexOf.call(e,t,r):o.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){let o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*a}else-1!==n&&(o-=o-n),n=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){let r=!0;for(let n=0;n<l;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return-1}function w(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let a;for(n>o/2&&(n=o/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(K(n))return a;e[r+a]=n}return a}function x(e,t,r,n){return Y(H(t,e.length-r),e,r,n)}function S(e,t,r,n){return Y(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return Y(Z(t),e,r,n)}function T(e,t,r,n){return Y(function(e,t){let r,n,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function A(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function C(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(o=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=a}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new o(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,o.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!c.TYPED_ARRAY_SUPPORT&&"undefined"!=typeof console&&console.error,Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,o.prototype),Object.setPrototypeOf(c,o),c.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?l(e):void 0!==t?"string"==typeof r?l(e).fill(t,r):l(e).fill(t):l(e)}(e,t,r)},c.allocUnsafe=function(e){return d(e)},c.allocUnsafeSlow=function(e){return d(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(X(e,o)&&(e=c.from(e,e.offset,e.byteLength)),X(t,o)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(X(t,o))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):o.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(c.prototype[n]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(X(e,o)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const l=Math.min(a,s),u=this.slice(n,i),h=e.slice(t,r);for(let o=0;o<l;++o)if(u[o]!==h[o]){a=u[o],s=h[o];break}return a<s?-1:s<a?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return x(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function k(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function P(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=t;o<r;++o)i+=Q[e[o]];return i}function R(e,t,r){const n=e.slice(t,r);let i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,i){U(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function B(e,t,r,n,i){U(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function $(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function z(e,t,n,i,o){return t=+t,n>>>=0,o||$(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function F(e,t,n,i,o){return t=+t,n>>>=0,o||$(e,0,n,8),r.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=J((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){O(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){O(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=J((function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let i=r-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=J((function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,r){return z(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return z(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return F(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return F(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof o.prototype.copyWithin?this.copyWithin(t,r,n):o.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};const q={};function N(e,t,r){q[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function U(e,t,r,n,i,o){if(e>r||e<t){const r="bigint"==typeof t?"n":"";let n;throw n=0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`,new q.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||G(t,e.length-(r+1))}(n,i,o)}function V(e,t){if("number"!=typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function G(e,t,r){if(Math.floor(e)!==e)throw V(e,r),new q.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}N("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),N("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),N("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Z(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?ee:e}function ee(){throw new Error("BigInt not supported")}}(buffer);const Buffer=buffer.Buffer,Buffer$1=buffer.Buffer;var lib$7={},Client={},ClientCodec={},lib$6={},ByteStream={},hasRequiredByteStream;function requireByteStream(){if(hasRequiredByteStream)return ByteStream;hasRequiredByteStream=1,Object.defineProperty(ByteStream,"__esModule",{value:!0});var e=new Uint8Array(0);function t(e,t,r){return e[t++]=r>>>24&255,e[t++]=r>>>16&255,e[t++]=r>>>8&255,e[t++]=255&r,t}function r(e,t,r){return e[t++]=255&r,e[t++]=r>>>8&255,e[t++]=r>>>16&255,e[t++]=r>>>24&255,t}function n(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1}ByteStream.writeInt32BE=t,ByteStream.writeInt32LE=r;var i=!0;try{o(new Uint8Array([1,2]))}catch(u){i=!1}function o(e){return i?String.fromCharCode.apply(String,e):String.fromCharCode.apply(String,function(e){for(var t=e.length,r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}(e))}function a(e,t){if(t<0&&(t=e.length),0===t)return["",0];var r=0,n=0,i=t<32767?t:32767,a=new Uint16Array(i+1),s=e.length,l=[];do{for(;r<i&&n<s;r++){var c=e[n++];switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a[r]=c;break;case 12:case 13:if(n<s){a[r]=(31&c)<<6|63&e[n++];break}throw new Error("Unfinished UTF-8 octet sequence");case 14:if(n+1<s){a[r]=(15&c)<<12|(63&e[n++])<<6|63&e[n++];break}throw new Error("Unfinished UTF-8 octet sequence");case 15:if(n+2<s){var u=((7&c)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;if(0<=u&&u<=1048575){a[r++]=u>>10&1023|55296,a[r]=1023&u|56320;break}throw new Error("Character outside valid Unicode range: 0x"+u.toString(16))}throw new Error("Unfinished UTF-8 octet sequence");default:throw new Error("Bad UTF-8 encoding 0x"+c.toString(16))}}l.push(o(a.subarray(0,r))),t-=r,r=0,i>t&&(i=t)}while(r<t&&n<s);return[1===l.length?l[0]:l.join(""),n]}function s(e){return a(e,e.length)[0]}function l(e){var t=e instanceof Uint8Array?e:new Uint8Array(e),r=t.length;if(0===r)return"";if(r<65535)return o(t);for(var n=32767&r,i=r>>15,a=new Array(n?i+1:i),s=0;s<i;++s)a[s]=o(t.subarray(s<<15,s+1<<15));return n&&(a[i]=o(t.subarray(i<<15,r))),a.join("")}ByteStream.fromUint8Array=s,ByteStream.toBinaryString=l;var c=function(){function i(t){this.buffer=e,this.size=0,this.offset=0,this.rmark=0,this.wmark=0,t&&("number"==typeof t?this.buffer=new Uint8Array(t):"string"==typeof t?this.writeString(t):(t instanceof i?this.buffer=t.toBytes():t instanceof Uint8Array?this.buffer=t:t instanceof Uint8ClampedArray?this.buffer=new Uint8Array(t.buffer,t.byteOffset,t.length):this.buffer=new Uint8Array(t),this.size=t.length),this.mark())}return i.toString=function(e){return void 0===e?Object.toString.apply(i):"string"==typeof e?e:e instanceof i?e.toString():e instanceof Uint8Array?s(e):e instanceof ArrayBuffer?s(new Uint8Array(e,0)):o(e)},i.prototype.grow=function(e){var t=this.capacity;if((e=this.size+e)>t)if(t>0){var r=new Uint8Array(n(e));r.set(this.buffer),this.buffer=r}else this.buffer=new Uint8Array(Math.max(n(e),1024))},Object.defineProperty(i.prototype,"capacity",{get:function(){return this.buffer.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this.buffer.subarray(0,this.size)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"remains",{get:function(){return this.buffer.subarray(this.offset,this.size)},enumerable:!0,configurable:!0}),i.prototype.mark=function(){this.wmark=this.size,this.rmark=this.offset},i.prototype.reset=function(){this.size=this.wmark,this.offset=this.rmark},i.prototype.clear=function(){this.buffer=e,this.size=0,this.offset=0,this.wmark=0,this.rmark=0},i.prototype.writeByte=function(e){this.grow(1),this.buffer[this.size++]=e},i.prototype.writeInt32BE=function(e){if(e!==(0|e))throw new TypeError("value is out of bounds");this.grow(4),this.size=t(this.buffer,this.size,e)},i.prototype.writeUInt32BE=function(e){if(e<0||e!==(0|e)&&2147483648+(2147483647&e)!==e)throw new TypeError("value is out of bounds");this.grow(4),this.size=t(this.buffer,this.size,0|e)},i.prototype.writeInt32LE=function(e){if(e!==(0|e))throw new TypeError("value is out of bounds");this.grow(4),this.size=r(this.buffer,this.size,e)},i.prototype.writeUInt32LE=function(e){if(e<0||e!==(0|e)&&2147483648+(2147483647&e)!==e)throw new TypeError("value is out of bounds");this.grow(4),this.size=r(this.buffer,this.size,0|e)},i.prototype.write=function(e){var t=e instanceof ArrayBuffer?e.byteLength:e.length;if(0!==t){this.grow(t);var r=this.buffer,n=this.size;e instanceof i?r.set(e.bytes,n):e instanceof ArrayBuffer?r.set(new Uint8Array(e),n):r.set(e,n),this.size+=t}},i.prototype.writeAsciiString=function(e){var t=e.length;if(0!==t){this.grow(t);for(var r=this.buffer.subarray(this.size),n=0;n<t;++n)r[n]=e.charCodeAt(n);this.size+=t}},i.prototype.writeString=function(e){var t=e.length;if(0!==t){this.grow(3*t);for(var r=this.buffer,n=this.size,i=0;i<t;++i){var o=e.charCodeAt(i);if(o<128)r[n++]=o;else if(o<2048)r[n++]=192|o>>6,r[n++]=128|63&o;else{if(!(o<55296||o>57343)){if(i+1<t){var a=e.charCodeAt(i+1);if(o<56320&&56320<=a&&a<=57343){var s=65536+((1023&o)<<10|1023&a);r[n++]=240|s>>18,r[n++]=128|s>>12&63,r[n++]=128|s>>6&63,r[n++]=128|63&s,++i;continue}}throw new Error("Malformed string")}r[n++]=224|o>>12,r[n++]=128|o>>6&63,r[n++]=128|63&o}}this.size=n}},i.prototype.readByte=function(){return this.offset>=this.size?-1:this.buffer[this.offset++]},i.prototype.readInt32BE=function(){var e=this.buffer,t=this.offset;if(t+3>=this.size)throw new Error("EOF");var r=e[t++]<<24|e[t++]<<16|e[t++]<<8|e[t++];return this.offset=t,r},i.prototype.readUInt32BE=function(){var e=this.readInt32BE();return e>=0?e:2147483648+(2147483647&e)},i.prototype.readInt32LE=function(){var e=this.buffer,t=this.offset;if(t+3>=this.size)throw new Error("EOF");var r=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;return this.offset=t,r},i.prototype.readUInt32LE=function(){var e=this.readInt32LE();return e>=0?e:2147483648+(2147483647&e)},i.prototype.read=function(t){return(t<0||this.offset+t>this.size)&&(t=this.size-this.offset),0===t?e:this.buffer.subarray(this.offset,this.offset+=t)},i.prototype.skip=function(e){return 0===e?0:(e<0||this.offset+e>this.size?(e=this.size-this.offset,this.offset=this.size):this.offset+=e,e)},i.prototype.readBytes=function(e){var t,r=this.buffer.indexOf(e,this.offset);return-1===r?(t=this.buffer.subarray(this.offset,this.size),this.offset=this.size):(t=this.buffer.subarray(this.offset,r+1),this.offset=r+1),t},i.prototype.readUntil=function(e){var t=this.buffer.indexOf(e,this.offset),r="";return t===this.offset?this.offset++:-1===t?(r=s(this.buffer.subarray(this.offset,this.size)),this.offset=this.size):(r=s(this.buffer.subarray(this.offset,t)),this.offset=t+1),r},i.prototype.readAsciiString=function(e){return l(this.read(e))},i.prototype.readStringAsBytes=function(t){if(0===t)return e;var r=this.buffer.subarray(this.offset,this.size);if(t<0)return this.offset=this.size,r;for(var n=0,i=0,o=r.length;i<t&&n<o;i++){var a=r[n++];switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(n<o){n++;break}throw new Error("Unfinished UTF-8 octet sequence");case 14:if(n+1<o){n+=2;break}throw new Error("Unfinished UTF-8 octet sequence");case 15:if(n+2<o){var s=((7&a)<<18|(63&r[n++])<<12|(63&r[n++])<<6|63&r[n++])-65536;if(0<=s&&s<=1048575){i++;break}throw new Error("Character outside valid Unicode range: 0x"+s.toString(16))}throw new Error("Unfinished UTF-8 octet sequence");default:throw new Error("Bad UTF-8 encoding 0x"+a.toString(16))}}return this.offset+=n,r.subarray(0,n)},i.prototype.readString=function(e){var t=a(this.buffer.subarray(this.offset,this.size),e),r=t[0],n=t[1];return this.offset+=n,r},i.prototype.takeBytes=function(){var e=this.bytes;return this.clear(),e},i.prototype.toBytes=function(){return new Uint8Array(this.bytes)},i.prototype.toString=function(){return s(this.bytes)},i.prototype.clone=function(){return new i(this.toBytes())},i.prototype.trunc=function(){this.buffer=this.remains,this.size=this.buffer.length,this.offset=0,this.wmark=0,this.rmark=0},i}();return ByteStream.ByteStream=c,ByteStream}var Writer={},Serializer={},BaseSerializer={},hasRequiredBaseSerializer;function requireBaseSerializer(){if(hasRequiredBaseSerializer)return BaseSerializer;hasRequiredBaseSerializer=1,Object.defineProperty(BaseSerializer,"__esModule",{value:!0});var e=function(){function e(){}return e.prototype.write=function(e,t){e.stream.writeByte(110)},e.prototype.serialize=function(e,t){this.write(e,t)},e}();return BaseSerializer.BaseSerializer=e,BaseSerializer}var NumberSerializer={},ValueWriter={},hasRequiredValueWriter,hasRequiredNumberSerializer;function requireValueWriter(){if(hasRequiredValueWriter)return ValueWriter;function e(e,n,i,o,a,s,l,c,u){0===a&&0===s&&0===l&&0===c?t(e,n,i,o):(1970===n&&1===i&&1===o||t(e,n,i,o),r(e,a,s,l,c)),e.writeByte(u?90:59)}function t(e,t,r,n){e.writeByte(68),e.writeAsciiString(("0000"+t).slice(-4)),e.writeAsciiString(("00"+r).slice(-2)),e.writeAsciiString(("00"+n).slice(-2))}function r(e,t,r,n,i){e.writeByte(84),e.writeAsciiString(("00"+t).slice(-2)),e.writeAsciiString(("00"+r).slice(-2)),e.writeAsciiString(("00"+n).slice(-2)),i>0&&(e.writeByte(46),e.writeAsciiString(("000"+i).slice(-3)))}return hasRequiredValueWriter=1,Object.defineProperty(ValueWriter,"__esModule",{value:!0}),ValueWriter.writeInteger=function(e,t){0<=t&&t<=9?e.writeByte(48+t):(t===(0|t)?e.writeByte(105):e.writeByte(108),e.writeAsciiString(""+t),e.writeByte(59))},ValueWriter.writeDouble=function(e,t){isNaN(t)?e.writeByte(78):isFinite(t)?(e.writeByte(100),e.writeAsciiString(""+t),e.writeByte(59)):(e.writeByte(73),e.writeByte(t>0?43:45))},ValueWriter.writeBigInt=function(e,t){0<=t&&t<=9?e.writeByte(48+Number(t)):(e.writeByte(108),e.writeAsciiString(""+t),e.writeByte(59))},ValueWriter.writeStringBody=function(e,t){var r=t.length;r>0&&e.writeAsciiString(""+r),e.writeByte(34),e.writeString(t),e.writeByte(34)},ValueWriter.writeUTCDate=function(t,r){e(t,r.getUTCFullYear(),r.getUTCMonth()+1,r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds(),!0)},ValueWriter.writeLocalDate=function(t,r){e(t,r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds(),!1)},ValueWriter.writeDateTime=e,ValueWriter.writeDate=t,ValueWriter.writeTime=r,ValueWriter}function requireNumberSerializer(){if(hasRequiredNumberSerializer)return NumberSerializer;hasRequiredNumberSerializer=1;var e=NumberSerializer&&NumberSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(NumberSerializer,"__esModule",{value:!0});var t=requireBaseSerializer(),r=requireValueWriter(),n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.write=function(e,t){t=t.valueOf(),Number.isSafeInteger(t)?r.writeInteger(e.stream,t):r.writeDouble(e.stream,t)},n}(t.BaseSerializer);return NumberSerializer.NumberSerializer=n,NumberSerializer}var BooleanSerializer={},hasRequiredBooleanSerializer;function requireBooleanSerializer(){if(hasRequiredBooleanSerializer)return BooleanSerializer;hasRequiredBooleanSerializer=1;var e=BooleanSerializer&&BooleanSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BooleanSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,t){e.stream.writeByte(t.valueOf()?116:102)},r}(requireBaseSerializer().BaseSerializer);return BooleanSerializer.BooleanSerializer=t,BooleanSerializer}var StringSerializer={},ReferenceSerializer={},hasRequiredReferenceSerializer,hasRequiredStringSerializer;function requireReferenceSerializer(){if(hasRequiredReferenceSerializer)return ReferenceSerializer;hasRequiredReferenceSerializer=1;var e=ReferenceSerializer&&ReferenceSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ReferenceSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,t){e.setReference(t)},r.prototype.serialize=function(e,t){e.writeReference(t)||this.write(e,t)},r}(requireBaseSerializer().BaseSerializer);return ReferenceSerializer.ReferenceSerializer=t,ReferenceSerializer}function requireStringSerializer(){if(hasRequiredStringSerializer)return StringSerializer;hasRequiredStringSerializer=1;var e=StringSerializer&&StringSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(StringSerializer,"__esModule",{value:!0});var t=requireReferenceSerializer(),r=requireValueWriter(),n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.write=function(e,n){t.prototype.write.call(this,e,n);var i=e.stream;i.writeByte(115),r.writeStringBody(i,n)},n.prototype.serialize=function(e,r){var n=e.stream;switch(r.length){case 0:n.writeByte(101);break;case 1:n.writeByte(117),n.writeString(r);break;default:t.prototype.serialize.call(this,e,r)}},n}(t.ReferenceSerializer);return StringSerializer.StringSerializer=n,StringSerializer}var DateSerializer={},hasRequiredDateSerializer;function requireDateSerializer(){if(hasRequiredDateSerializer)return DateSerializer;hasRequiredDateSerializer=1;var e=DateSerializer&&DateSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(DateSerializer,"__esModule",{value:!0});var t=requireReferenceSerializer(),r=requireValueWriter(),n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.write=function(e,n){t.prototype.write.call(this,e,n);var i=e.stream;e.utc?r.writeUTCDate(i,n):r.writeLocalDate(i,n)},n}(t.ReferenceSerializer);return DateSerializer.DateSerializer=n,DateSerializer}var BytesSerializer={},hasRequiredBytesSerializer;function requireBytesSerializer(){if(hasRequiredBytesSerializer)return BytesSerializer;hasRequiredBytesSerializer=1;var e=BytesSerializer&&BytesSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BytesSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(98);var i=r instanceof ArrayBuffer?r.byteLength:r.length;i>0&&n.writeAsciiString(""+i),n.writeByte(34),n.write(r),n.writeByte(34)},r}(requireReferenceSerializer().ReferenceSerializer);return BytesSerializer.BytesSerializer=t,BytesSerializer}var GuidSerializer={},hasRequiredGuidSerializer;function requireGuidSerializer(){if(hasRequiredGuidSerializer)return GuidSerializer;hasRequiredGuidSerializer=1;var e=GuidSerializer&&GuidSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(GuidSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(103),n.writeByte(123),n.writeAsciiString(r.toString()),n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return GuidSerializer.GuidSerializer=t,GuidSerializer}var TypedArraySerializer={},hasRequiredTypedArraySerializer;function requireTypedArraySerializer(){if(hasRequiredTypedArraySerializer)return TypedArraySerializer;hasRequiredTypedArraySerializer=1;var e=TypedArraySerializer&&TypedArraySerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TypedArraySerializer,"__esModule",{value:!0});var t=function(t){function r(e){var r=t.call(this)||this;return r.writeNumber=e,r}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(97);var i=r.length;i>0&&n.writeAsciiString(""+i),n.writeByte(123);for(var o=0;o<i;o++)this.writeNumber(n,r[o]);n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return TypedArraySerializer.TypedArraySerializer=t,TypedArraySerializer}var ArraySerializer={},hasRequiredArraySerializer;function requireArraySerializer(){if(hasRequiredArraySerializer)return ArraySerializer;hasRequiredArraySerializer=1;var e=ArraySerializer&&ArraySerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ArraySerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(97);var i=r.length;i>0&&n.writeAsciiString(""+i),n.writeByte(123);for(var o=0;o<i;o++)e.serialize(r[o]);n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return ArraySerializer.ArraySerializer=t,ArraySerializer}var SetSerializer={},hasRequiredSetSerializer;function requireSetSerializer(){if(hasRequiredSetSerializer)return SetSerializer;hasRequiredSetSerializer=1;var e=SetSerializer&&SetSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(SetSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(97);var i=r.size;i>0&&n.writeAsciiString(""+i),n.writeByte(123),r.forEach((function(t){return e.serialize(t)})),n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return SetSerializer.SetSerializer=t,SetSerializer}var MapSerializer={},hasRequiredMapSerializer;function requireMapSerializer(){if(hasRequiredMapSerializer)return MapSerializer;hasRequiredMapSerializer=1;var e=MapSerializer&&MapSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(MapSerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream;n.writeByte(109);var i=r.size;i>0&&n.writeAsciiString(""+i),n.writeByte(123),r.forEach((function(t,r){e.serialize(r),e.serialize(t)})),n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return MapSerializer.MapSerializer=t,MapSerializer}var DictionarySerializer={},hasRequiredDictionarySerializer;function requireDictionarySerializer(){if(hasRequiredDictionarySerializer)return DictionarySerializer;hasRequiredDictionarySerializer=1;var e=DictionarySerializer&&DictionarySerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(DictionarySerializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.write=function(e,r){t.prototype.write.call(this,e,r);var n=e.stream,i=[];if(void 0===r.hasOwnProperty)for(var o in r)"function"!=typeof r[o]&&(i[i.length]=o);else for(var o in r)r.hasOwnProperty(o)&&"function"!=typeof r[o]&&(i[i.length]=o);var a=i.length;n.writeByte(109),a>0&&n.writeAsciiString(""+a),n.writeByte(123);for(var s=0;s<a;s++)e.serialize(i[s]),e.serialize(r[i[s]]);n.writeByte(125)},r}(requireReferenceSerializer().ReferenceSerializer);return DictionarySerializer.DictionarySerializer=t,DictionarySerializer}var ObjectSerializer={},hasRequiredObjectSerializer;function requireObjectSerializer(){if(hasRequiredObjectSerializer)return ObjectSerializer;hasRequiredObjectSerializer=1;var e=ObjectSerializer&&ObjectSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ObjectSerializer,"__esModule",{value:!0});var t=requireByteStream(),r=requireReferenceSerializer(),n=requireValueWriter(),i=function(r){function i(e,i,o){void 0===o&&(o=[]);var a=r.call(this)||this;if(a.type=e.constructor,0===o.length)for(var s in e)e.hasOwnProperty(s)&&"function"!=typeof e[s]&&(o[o.length]=s.toString());a.fields=o;var l=new t.ByteStream;l.writeByte(99),n.writeStringBody(l,i);var c=o.length;c>0&&l.writeAsciiString(""+c),l.writeByte(123);for(var u=0;u<c;u++)l.writeByte(115),n.writeStringBody(l,o[u]);return l.writeByte(125),a.metadata=l.takeBytes(),a}return e(i,r),i.prototype.write=function(e,t){var n=e.stream,i=this.fields,o=this.metadata,a=i.length,s=e.writeClass(this.type,(function(){n.write(o),e.addReferenceCount(a)}));r.prototype.write.call(this,e,t),n.writeByte(111),n.writeAsciiString(""+s),n.writeByte(123);for(var l=0;l<a;l++)e.serialize(t[i[l]]);n.writeByte(125)},i}(r.ReferenceSerializer);return ObjectSerializer.ObjectSerializer=i,ObjectSerializer}var ErrorSerializer={},hasRequiredErrorSerializer;function requireErrorSerializer(){if(hasRequiredErrorSerializer)return ErrorSerializer;hasRequiredErrorSerializer=1;var e=ErrorSerializer&&ErrorSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ErrorSerializer,"__esModule",{value:!0});var t=requireReferenceSerializer(),r=requireValueWriter(),n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.write=function(e,t){e.addReferenceCount(1);var n=e.stream;n.writeByte(69),n.writeByte(115),r.writeStringBody(n,t.message)},n}(t.ReferenceSerializer);return ErrorSerializer.ErrorSerializer=n,ErrorSerializer}var TypeManager={},hasRequiredTypeManager;function requireTypeManager(){if(hasRequiredTypeManager)return TypeManager;hasRequiredTypeManager=1,Object.defineProperty(TypeManager,"__esModule",{value:!0});var e=Object.create(null),t=new WeakMap;function r(r,n){void 0===n&&(n=r.name),t.set(r,n),e[n]=r}"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var e=this.toString();return e.substr(0,e.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/gi,"")},writable:!1,enumerable:!1,configurable:!0}),TypeManager.register=r,TypeManager.isRegistered=function(t){return t in e},TypeManager.getName=function(r){if(!r)return"";var n=t.get(r);return n||(""===(n=r.name)||"Object"===n?"":(t.set(r,n),e[n]=r,n))};var n=null;try{n="object"==typeof commonjsGlobal?commonjsGlobal:window}catch(a){}function i(e){if(n){for(var t=n,r=e.split("."),i=0;i<r.length;i++)if(void 0===(t=t[r[i]]))return;if("function"==typeof t)return t}}function o(e,t,r,n){if(r<t.length){e[t[r++]]=n;var a=o(e,t,r,".");return void 0===a&&r<t.length&&(a=o(e,t,r,"_")),a}return i(e.join(""))}return TypeManager.getType=function(t){var n=e[t];if(n)return n;if(n=i(t))return r(n,t),n;for(var a=[],s=t.indexOf("_");s>=0;)a[a.length]=s,s=t.indexOf("_",s+1);if(a.length>0){var l=t.split("");if(void 0===(n=o(l,a,0,"."))&&(n=o(l,a,0,"_")),n)return r(n,t),n}return n=function(){},Object.defineProperty(n,"name",{value:t}),r(n,t),n},TypeManager}var guid$1={},hasRequiredGuid,hasRequiredSerializer;function requireGuid(){if(hasRequiredGuid)return guid$1;hasRequiredGuid=1,guid$1.__esModule=!0;var e=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var r=t.toString();return t&&(t instanceof e||e.validator.test(r))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();return guid$1.Guid=e,guid$1}function requireSerializer(){if(hasRequiredSerializer)return Serializer;hasRequiredSerializer=1;var e=Serializer&&Serializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Serializer,"__esModule",{value:!0});var t=requireByteStream(),r=requireBaseSerializer(),n=requireNumberSerializer(),i=requireBooleanSerializer(),o=requireStringSerializer(),a=requireDateSerializer(),s=requireBytesSerializer(),l=requireGuidSerializer(),c=requireTypedArraySerializer(),u=requireArraySerializer(),h=requireSetSerializer(),d=requireMapSerializer(),p=requireDictionarySerializer(),f=requireObjectSerializer(),m=requireErrorSerializer(),g=e(requireTypeManager()),y=requireValueWriter(),_=requireGuid(),v=new Map,b=new r.BaseSerializer,w=new n.NumberSerializer,x=new i.BooleanSerializer,S=new o.StringSerializer,E=new a.DateSerializer,T=new s.BytesSerializer,A=new l.GuidSerializer,C=new c.TypedArraySerializer(y.writeInteger),I=new c.TypedArraySerializer(y.writeDouble),k=new u.ArraySerializer,P=new h.SetSerializer,M=new d.MapSerializer,R=new p.DictionarySerializer,D=new m.ErrorSerializer;function O(e,t){v.set(e,t)}return Serializer.register=O,Serializer.getInstance=function(e){var r=e.constructor;switch(r){case Function:return b;case Number:return w;case Boolean:return x;case String:return S;case Date:return E;case _.Guid:return A;case Array:return k;case Set:return P;case Map:return M;case ArrayBuffer:case Uint8Array:case Uint8ClampedArray:case t.ByteStream:return T;case Int8Array:case Int16Array:case Int32Array:case Uint16Array:case Uint32Array:return C;case Float32Array:case Float64Array:return I;case Error:return D}var n=v.get(r);if(void 0!==n)return n;if(Array.isArray(e)||"[object Arguments]"===Object.prototype.toString.call(e))return k;if(e instanceof Error)return O(r,D),D;var i=g.getName(r);if(""===i)return R;if("GeneratorFunction"===i)return b;if("AsyncFunction"===i)return b;var o=new f.ObjectSerializer(e,i);return O(r,o),o},Serializer}var BigIntSerializer={},hasRequiredBigIntSerializer;function requireBigIntSerializer(){if(hasRequiredBigIntSerializer)return BigIntSerializer;hasRequiredBigIntSerializer=1;var e=BigIntSerializer&&BigIntSerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BigIntSerializer,"__esModule",{value:!0});var t=requireValueWriter(),r=requireBaseSerializer(),n=requireSerializer();if("undefined"!=typeof BigInt){var i=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return e(n,r),n.prototype.write=function(e,r){t.writeBigInt(e.stream,r)},n}(r.BaseSerializer);n.register(BigInt,new i)}return BigIntSerializer}var BigIntArraySerializer={},hasRequiredBigIntArraySerializer,hasRequiredWriter;function requireBigIntArraySerializer(){if(hasRequiredBigIntArraySerializer)return BigIntArraySerializer;hasRequiredBigIntArraySerializer=1;var e=BigIntArraySerializer&&BigIntArraySerializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(BigIntArraySerializer,"__esModule",{value:!0});var t=requireReferenceSerializer(),r=requireValueWriter(),n=requireSerializer();if("undefined"!=typeof BigInt64Array&&"undefined"!=typeof BigUint64Array){var i=new(function(t){function n(){return t.call(this)||this}return e(n,t),n.prototype.write=function(e,n){t.prototype.write.call(this,e,n);var i=e.stream;i.writeByte(97);var o=n.length;o>0&&i.writeAsciiString(""+o),i.writeByte(123);for(var a=0;a<o;a++)r.writeBigInt(i,n[a]);i.writeByte(125)},n}(t.ReferenceSerializer));n.register(BigInt64Array,i),n.register(BigUint64Array,i)}return BigIntArraySerializer}function requireWriter(){if(hasRequiredWriter)return Writer;hasRequiredWriter=1;var e=Writer&&Writer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Writer,"__esModule",{value:!0});var t=e(requireSerializer());requireBigIntSerializer(),requireBigIntArraySerializer();var r=function(){function e(){this.ref=new Map,this.last=0}return e.prototype.addCount=function(e){this.last+=e},e.prototype.set=function(e){this.ref.set(e,this.last++)},e.prototype.write=function(e,t){var r=this.ref.get(t);return void 0!==r&&(e.writeByte(114),e.writeAsciiString(""+r),e.writeByte(59),!0)},e.prototype.reset=function(){this.ref.clear(),this.last=0},e}(),n=function(){function e(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1),this.stream=e,this.utc=r,this.ref=new Map,this.last=0,this.simple=t}return Object.defineProperty(e.prototype,"simple",{get:function(){return void 0===this.refer},set:function(e){this.refer=e?void 0:new r},enumerable:!0,configurable:!0}),e.prototype.serialize=function(e){null==e?this.stream.writeByte(110):t.getInstance(e).serialize(this,e)},e.prototype.write=function(e){null==e?this.stream.writeByte(110):t.getInstance(e).write(this,e)},e.prototype.writeReference=function(e){return!!this.refer&&this.refer.write(this.stream,e)},e.prototype.setReference=function(e){this.refer&&this.refer.set(e)},e.prototype.addReferenceCount=function(e){this.refer&&this.refer.addCount(e)},e.prototype.reset=function(){this.refer&&this.refer.reset(),this.ref.clear(),this.last=0},e.prototype.writeClass=function(e,t){var r=this.ref.get(e);return void 0===r&&(t(),r=this.last++,this.ref.set(e,r)),r},e}();return Writer.Writer=n,Writer}var Reader={},ValueReader={},hasRequiredValueReader;function requireValueReader(){if(hasRequiredValueReader)return ValueReader;hasRequiredValueReader=1,Object.defineProperty(ValueReader,"__esModule",{value:!0});var e=requireGuid();function t(e,t){void 0===t&&(t=59);var r=e.readUntil(t);return 0===r.length?0:parseInt(r,10)}function r(e){return t(e,34)}function n(e){return 10*(e.readByte()-48)+e.readByte()-48}function i(e){var t=e.readByte()-48;t=10*(t=10*t+e.readByte()-48)+e.readByte()-48;var r=e.readByte();return r>=48&&r<=57&&(e.skip(2),(r=e.readByte())>=48&&r<=57&&(e.skip(2),r=e.readByte())),[t,r]}return ValueReader.readInt=t,ValueReader.readDouble=function(e){return parseFloat(e.readUntil(59))},ValueReader.readInfinity=function(e){return 45===e.readByte()?-1/0:1/0},ValueReader.readCount=function(e){return t(e,123)},ValueReader.readLength=r,ValueReader.readString=function(e){var t=r(e),n=e.readString(t);return e.readByte(),n},ValueReader.readBytes=function(e){var t=r(e),n=e.read(t);return e.readByte(),n},ValueReader.readAsciiString=function(e){var t=r(e),n=e.readAsciiString(t);return e.readByte(),n},ValueReader.readGuid=function(t){t.readByte();var r=e.Guid.parse(t.readAsciiString(36));return t.readByte(),r},ValueReader.readTime=function(e){var t,r=n(e),o=n(e),a=n(e),s=0,l=e.readByte();return 46===l&&(s=(t=i(e))[0],l=t[1]),90===l?new Date(Date.UTC(1970,0,1,r,o,a,s)):new Date(1970,0,1,r,o,a,s)},ValueReader.readDateTime=function(e){var t,r=function(e){var t=e.readByte()-48;return 10*(t=10*(t=10*t+e.readByte()-48)+e.readByte()-48)+e.readByte()-48}(e),o=n(e)-1,a=n(e),s=e.readByte();if(84===s){var l=n(e),c=n(e),u=n(e),h=0;return 46===(s=e.readByte())&&(h=(t=i(e))[0],s=t[1]),90===s?new Date(Date.UTC(r,o,a,l,c,u,h)):new Date(r,o,a,l,c,u,h)}return 90===s?new Date(Date.UTC(r,o,a)):new Date(r,o,a)},ValueReader}var Deserializer={},ArrayDeserializer={},BaseDeserializer={},hasRequiredBaseDeserializer;function requireBaseDeserializer(){if(hasRequiredBaseDeserializer)return BaseDeserializer;hasRequiredBaseDeserializer=1,Object.defineProperty(BaseDeserializer,"__esModule",{value:!0});var e=function(){function e(e){void 0===e&&(e="undefined"),this.type=e}return e.prototype.read=function(e,t){switch(t){case 110:return;case 114:return e.readReference();case 99:return e.readClass(),this.deserialize(e);case 69:throw new Error(e.deserialize(String))}throw new Error("Cannot convert "+function(e){switch(e){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 105:return"int32 number";case 108:return"long number";case 100:return"double number";case 110:return"null | undefined";case 101:return"empty string";case 116:return"true";case 102:return"false";case 78:return"NaN";case 73:return"Infinity";case 68:case 84:return"Date";case 98:return"Uint8Array";case 117:case 115:return"string";case 103:return"guid string";case 97:return"Array";case 109:return"object | Map";case 99:return"class";case 111:return"Object";case 114:return"Reference";case 69:return"Error";default:throw new Error("Unexpected Tag: 0x"+(255&e).toString(16))}}(t)+" to "+this.type+".")},e.prototype.deserialize=function(e){return this.read(e,e.stream.readByte())},e}();return BaseDeserializer.BaseDeserializer=e,BaseDeserializer}var ReferenceReader={},hasRequiredReferenceReader,hasRequiredArrayDeserializer;function requireReferenceReader(){if(hasRequiredReferenceReader)return ReferenceReader;hasRequiredReferenceReader=1;var e=ReferenceReader&&ReferenceReader.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(ReferenceReader,"__esModule",{value:!0});var t=e(requireValueReader());return ReferenceReader.readBytes=function(e){var r=t.readBytes(e.stream);return e.addReference(r),r},ReferenceReader.readAsciiString=function(e){var r=t.readAsciiString(e.stream);return e.addReference(r),r},ReferenceReader.readString=function(e){var r=t.readString(e.stream);return e.addReference(r),r},ReferenceReader.readGuid=function(e){var r=t.readGuid(e.stream);return e.addReference(r),r},ReferenceReader.readDateTime=function(e){var r=t.readDateTime(e.stream);return e.addReference(r),r},ReferenceReader.readTime=function(e){var r=t.readTime(e.stream);return e.addReference(r),r},ReferenceReader.readArray=function(e){var r=e.stream,n=t.readCount(r),i=new Array(n);e.addReference(i);for(var o=0;o<n;++o)i[o]=e.deserialize();return r.readByte(),i},ReferenceReader.readSet=function(e){var r=e.stream,n=t.readCount(r),i=new Set;e.addReference(i);for(var o=0;o<n;++o)i.add(e.deserialize());return r.readByte(),i},ReferenceReader.readMap=function(e){var r=e.stream,n=new Map;e.addReference(n);for(var i=t.readCount(r);i>0;--i){var o=e.deserialize(),a=e.deserialize();n.set(o,a)}return r.readByte(),n},ReferenceReader.readObject=function(e){var r=e.stream,n=t.readInt(r,123),i=e.getTypeInfo(n),o=i.type,a=o?new o:{};e.addReference(a);for(var s=i.names,l=s.length,c=0;c<l;++c)a[s[c]]=e.deserialize();return r.readByte(),a},ReferenceReader.readObjectAsMap=function(e){var r=e.stream,n=t.readInt(r,123),i=e.getTypeInfo(n),o=new Map;e.addReference(o);for(var a=i.names,s=a.length,l=0;l<s;++l)o.set(a[l],e.deserialize());return r.readByte(),o},ReferenceReader}function requireArrayDeserializer(){if(hasRequiredArrayDeserializer)return ArrayDeserializer;hasRequiredArrayDeserializer=1;var e=ArrayDeserializer&&ArrayDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=ArrayDeserializer&&ArrayDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(ArrayDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireReferenceReader()),i=function(t){function r(){return t.call(this,"Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 97:return n.readArray(e);case 101:return[];case 115:return n.readString(e).split("");case 98:return Array.from(n.readBytes(e));case 114:var i=e.readReference();return i instanceof Uint8Array?Array.from(i):i instanceof String?i.split(""):i;default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return ArrayDeserializer.ArrayDeserializer=i,ArrayDeserializer}var TypedArrayDeserializer={},IntDeserializer={},hasRequiredIntDeserializer;function requireIntDeserializer(){if(hasRequiredIntDeserializer)return IntDeserializer;hasRequiredIntDeserializer=1;var e=IntDeserializer&&IntDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=IntDeserializer&&IntDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(IntDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireValueReader()),i=t(requireReferenceReader()),o=function(t){function r(){return t.call(this,"int")||this}return e(r,t),r.prototype.read=function(e,r){if(r>=48&&r<=57)return r-48;var o=e.stream;switch(r){case 105:case 108:return n.readInt(o);case 100:return Math.floor(n.readDouble(o));case 116:return 1;case 102:case 101:return 0;case 115:return parseInt(i.readString(e));case 117:return o.readString(1).charCodeAt(1);case 68:return i.readDateTime(e).getTime();case 84:return i.readTime(e).getTime();case 114:var a=e.readReference();return a instanceof Date?a.getTime():parseInt(a.toString());default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return IntDeserializer.IntDeserializer=o,IntDeserializer}var NumberDeserializer={},hasRequiredNumberDeserializer,hasRequiredTypedArrayDeserializer;function requireNumberDeserializer(){if(hasRequiredNumberDeserializer)return NumberDeserializer;hasRequiredNumberDeserializer=1;var e=NumberDeserializer&&NumberDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=NumberDeserializer&&NumberDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(NumberDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireValueReader()),i=t(requireReferenceReader()),o=function(t){function r(){return t.call(this,"number")||this}return e(r,t),r.prototype.read=function(e,r){if(r>=48&&r<=57)return r-48;var o=e.stream;switch(r){case 105:case 108:return n.readInt(o);case 100:return n.readDouble(o);case 78:return NaN;case 73:return n.readInfinity(o);case 116:return 1;case 102:case 101:return 0;case 115:return Number(i.readString(e));case 117:return o.readString(1).charCodeAt(1);case 68:return i.readDateTime(e).getTime();case 84:return i.readTime(e).getTime();case 114:var a=e.readReference();return a instanceof Date?a.getTime():Number(a.toString());default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return NumberDeserializer.NumberDeserializer=o,NumberDeserializer}function requireTypedArrayDeserializer(){if(hasRequiredTypedArrayDeserializer)return TypedArrayDeserializer;hasRequiredTypedArrayDeserializer=1;var e=TypedArrayDeserializer&&TypedArrayDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TypedArrayDeserializer,"__esModule",{value:!0});var t=requireByteStream(),r=requireIntDeserializer(),n=requireNumberDeserializer(),i=requireBaseDeserializer(),o=requireValueReader(),a=requireReferenceReader();function s(e,t){var n=e.stream,i=o.readCount(n),a=new t(i);e.addReference(a);for(var s=r.IntDeserializer.instance,l=0;l<i;++l)a[l]=s.deserialize(e);return n.readByte(),a}function l(e,t){var r=e.stream,i=o.readCount(r),a=new t(i);e.addReference(a);for(var s=n.NumberDeserializer.instance,l=0;l<i;++l)a[l]=s.deserialize(e);return r.readByte(),a}TypedArrayDeserializer.readIntArray=s,TypedArrayDeserializer.readNumberArray=l;var c=new Int8Array(0),u=function(r){function n(){return r.call(this,"Int8Array")||this}return e(n,r),n.prototype.read=function(e,n){var i;switch(n){case 101:return c;case 97:return s(e,Int8Array);case 98:i=a.readBytes(e);break;case 117:i=new t.ByteStream(e.stream.readString(1)).bytes;break;case 115:i=new t.ByteStream(a.readString(e)).bytes;break;default:return r.prototype.read.call(this,e,n)}return new Int8Array(i.buffer,i.byteOffset,i.length)},n.instance=new n,n}(i.BaseDeserializer);TypedArrayDeserializer.Int8ArrayDeserializer=u;var h=new Int16Array(0),d=function(t){function r(){return t.call(this,"Int16Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return h;case 97:return s(e,Int16Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);TypedArrayDeserializer.Int16ArrayDeserializer=d;var p=new Int32Array(0),f=function(t){function r(){return t.call(this,"Int32Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return p;case 97:return s(e,Int32Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);TypedArrayDeserializer.Int32ArrayDeserializer=f;var m=new Uint8Array(0),g=function(r){function n(){return r.call(this,"Uint8Array")||this}return e(n,r),n.prototype.read=function(e,n){switch(n){case 98:return a.readBytes(e);case 101:return m;case 97:return s(e,Uint8Array);case 117:return new t.ByteStream(e.stream.readString(1)).bytes;case 115:return new t.ByteStream(a.readString(e)).bytes;case 114:var i=e.readReference();return i instanceof Uint8Array?i:new t.ByteStream(i.toString()).bytes;default:return r.prototype.read.call(this,e,n)}},n.instance=new n,n}(i.BaseDeserializer);TypedArrayDeserializer.Uint8ArrayDeserializer=g;var y=new Uint8ClampedArray(0),_=function(r){function n(){return r.call(this,"Uint8ClampedArray")||this}return e(n,r),n.prototype.read=function(e,n){var i;switch(n){case 101:return y;case 97:return s(e,Uint8ClampedArray);case 98:i=a.readBytes(e);break;case 117:i=new t.ByteStream(e.stream.readString(1)).bytes;break;case 115:i=new t.ByteStream(a.readString(e)).bytes;break;case 114:var o=e.readReference();if(o instanceof Uint8ClampedArray)return o;i=o instanceof Uint8Array?o:new t.ByteStream(o.toString()).bytes;break;default:return r.prototype.read.call(this,e,n)}return new Uint8ClampedArray(i.buffer,i.byteOffset,i.length)},n.instance=new n,n}(i.BaseDeserializer);TypedArrayDeserializer.Uint8ClampedArrayDeserializer=_;var v=new Uint16Array(0),b=function(t){function r(){return t.call(this,"Uint16Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return v;case 97:return s(e,Uint16Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);TypedArrayDeserializer.Uint16ArrayDeserializer=b;var w=new Uint32Array(0),x=function(t){function r(){return t.call(this,"Uint32Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return w;case 97:return s(e,Uint32Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);TypedArrayDeserializer.Uint32ArrayDeserializer=x;var S=new Float32Array(0),E=function(t){function r(){return t.call(this,"Float32Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return S;case 97:return l(e,Float32Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);TypedArrayDeserializer.Float32ArrayDeserializer=E;var T=new Float64Array(0),A=function(t){function r(){return t.call(this,"Float64Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return T;case 97:return l(e,Float64Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(i.BaseDeserializer);return TypedArrayDeserializer.Float64ArrayDeserializer=A,TypedArrayDeserializer}var FunctionDeserializer={},hasRequiredFunctionDeserializer;function requireFunctionDeserializer(){if(hasRequiredFunctionDeserializer)return FunctionDeserializer;hasRequiredFunctionDeserializer=1;var e=FunctionDeserializer&&FunctionDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(FunctionDeserializer,"__esModule",{value:!0});var t=function(t){function r(){return t.call(this,"function")||this}return e(r,t),r.instance=new r,r}(requireBaseDeserializer().BaseDeserializer);return FunctionDeserializer.FunctionDeserializer=t,FunctionDeserializer}var BooleanDeserializer={},hasRequiredBooleanDeserializer;function requireBooleanDeserializer(){if(hasRequiredBooleanDeserializer)return BooleanDeserializer;hasRequiredBooleanDeserializer=1;var e=BooleanDeserializer&&BooleanDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=BooleanDeserializer&&BooleanDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(BooleanDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireValueReader()),i=t(requireReferenceReader()),o=function(t){function r(){return t.call(this,"boolean")||this}return e(r,t),r.prototype.read=function(e,r){var o=e.stream;switch(r){case 116:return!0;case 102:case 101:case 78:case 48:return!1;case 105:case 108:return 0!==n.readInt(o);case 100:return 0!==n.readDouble(o);case 115:return Boolean(i.readString(e));case 117:return-1==="0\0".indexOf(o.readString(1));case 73:return o.readByte(),!0;case 114:return Boolean(e.readReference().toString());default:return r>=49&&r<=57||t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return BooleanDeserializer.BooleanDeserializer=o,BooleanDeserializer}var StringDeserializer={},hasRequiredStringDeserializer;function requireStringDeserializer(){if(hasRequiredStringDeserializer)return StringDeserializer;hasRequiredStringDeserializer=1;var e=StringDeserializer&&StringDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=StringDeserializer&&StringDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(StringDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireValueReader()),i=t(requireReferenceReader()),o=function(t){function r(){return t.call(this,"string")||this}return e(r,t),r.prototype.read=function(e,r){if(r>=48&&r<=57)return String.fromCharCode(r);var o=e.stream;switch(r){case 105:case 108:case 100:return o.readUntil(59);case 115:return i.readString(e);case 98:return i.readAsciiString(e);case 116:return"true";case 102:return"false";case 101:return"";case 68:return i.readDateTime(e).toString();case 84:return i.readTime(e).toTimeString();case 103:return i.readGuid(e).toString();case 78:return"NaN";case 73:return n.readInfinity(o).toString();case 117:return o.readString(1);case 97:return i.readArray(e).join("");case 114:return e.readReference().toString();default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return StringDeserializer.StringDeserializer=o,StringDeserializer}var DateDeserializer={},hasRequiredDateDeserializer;function requireDateDeserializer(){if(hasRequiredDateDeserializer)return DateDeserializer;hasRequiredDateDeserializer=1;var e=DateDeserializer&&DateDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=DateDeserializer&&DateDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(DateDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireValueReader()),i=t(requireReferenceReader()),o=function(t){function r(){return t.call(this,"Date")||this}return e(r,t),r.prototype.read=function(e,r){var o=e.stream;switch(r){case 68:return i.readDateTime(e);case 84:return i.readTime(e);case 105:case 108:return new Date(n.readInt(o));case 100:return new Date(Math.floor(n.readDouble(o)));case 115:return new Date(i.readString(e));case 116:return new Date(1);case 102:case 101:return new Date(0);case 114:var a=e.readReference();return a instanceof Date?a:new Date(a.toString());default:return r>=48&&r<=57?new Date(r-48):t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return DateDeserializer.DateDeserializer=o,DateDeserializer}var ByteStreamDeserializer={},hasRequiredByteStreamDeserializer;function requireByteStreamDeserializer(){if(hasRequiredByteStreamDeserializer)return ByteStreamDeserializer;hasRequiredByteStreamDeserializer=1;var e=ByteStreamDeserializer&&ByteStreamDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ByteStreamDeserializer,"__esModule",{value:!0});var t=requireByteStream(),r=requireBaseDeserializer(),n=requireTypedArrayDeserializer(),i=requireReferenceReader(),o=function(r){function o(){return r.call(this,"ByteStream")||this}return e(o,r),o.prototype.read=function(e,o){switch(o){case 98:return new t.ByteStream(i.readBytes(e));case 101:return new t.ByteStream(0);case 97:return new t.ByteStream(n.readIntArray(e,Uint8Array));case 117:return new t.ByteStream(e.stream.readString(1));case 115:return new t.ByteStream(i.readString(e));case 114:var a=e.readReference();return a instanceof Uint8Array?new t.ByteStream(a):new t.ByteStream(a.toString());default:return r.prototype.read.call(this,e,o)}},o.instance=new o,o}(r.BaseDeserializer);return ByteStreamDeserializer.ByteStreamDeserializer=o,ByteStreamDeserializer}var SetDeserializer={},hasRequiredSetDeserializer;function requireSetDeserializer(){if(hasRequiredSetDeserializer)return SetDeserializer;hasRequiredSetDeserializer=1;var e=SetDeserializer&&SetDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(SetDeserializer,"__esModule",{value:!0});var t=requireBaseDeserializer(),r=requireReferenceReader(),n=function(t){function n(){return t.call(this,"Set")||this}return e(n,t),n.prototype.read=function(e,n){switch(n){case 101:return new Set;case 97:return r.readSet(e);default:return t.prototype.read.call(this,e,n)}},n.instance=new n,n}(t.BaseDeserializer);return SetDeserializer.SetDeserializer=n,SetDeserializer}var MapDeserializer={},hasRequiredMapDeserializer;function requireMapDeserializer(){if(hasRequiredMapDeserializer)return MapDeserializer;hasRequiredMapDeserializer=1;var e=MapDeserializer&&MapDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=MapDeserializer&&MapDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(MapDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireReferenceReader()),i=function(t){function r(){return t.call(this,"Map")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return new Map;case 109:return n.readMap(e);case 111:return n.readObjectAsMap(e);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return MapDeserializer.MapDeserializer=i,MapDeserializer}var GuidDeserializer={},hasRequiredGuidDeserializer;function requireGuidDeserializer(){if(hasRequiredGuidDeserializer)return GuidDeserializer;hasRequiredGuidDeserializer=1;var e=GuidDeserializer&&GuidDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=GuidDeserializer&&GuidDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(GuidDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=t(requireReferenceReader()),i=requireGuid(),o=function(t){function r(){return t.call(this,"Guid")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 103:return n.readGuid(e);case 115:return i.Guid.parse(n.readString(e));case 114:var o=e.readReference();return o instanceof i.Guid?o:i.Guid.parse(o.toString());default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return GuidDeserializer.GuidDeserializer=o,GuidDeserializer}var ErrorDeserializer={},hasRequiredErrorDeserializer;function requireErrorDeserializer(){if(hasRequiredErrorDeserializer)return ErrorDeserializer;hasRequiredErrorDeserializer=1;var e=ErrorDeserializer&&ErrorDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ErrorDeserializer,"__esModule",{value:!0});var t=function(t){function r(){return t.call(this,"Error")||this}return e(r,t),r.prototype.read=function(e,r){return 69===r?new Error(e.deserialize(String)):t.prototype.read.call(this,e,r)},r.instance=new r,r}(requireBaseDeserializer().BaseDeserializer);return ErrorDeserializer.ErrorDeserializer=t,ErrorDeserializer}var NullDeserializer={},DefaultDeserializer={},hasRequiredDefaultDeserializer,hasRequiredNullDeserializer,hasRequiredDeserializer;function requireDefaultDeserializer(){if(hasRequiredDefaultDeserializer)return DefaultDeserializer;hasRequiredDefaultDeserializer=1;var e=DefaultDeserializer&&DefaultDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=DefaultDeserializer&&DefaultDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(DefaultDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=requireStringDeserializer(),i=t(requireValueReader()),o=t(requireReferenceReader()),a=function(t){function r(){return t.call(this,"any")||this}return e(r,t),r.prototype.read=function(e,r){if(r>=48&&r<=57)return r-48;var s=e.stream;switch(r){case 105:return i.readInt(s);case 115:return o.readString(e);case 98:return o.readBytes(e);case 116:return!0;case 102:return!1;case 101:return"";case 111:return o.readObject(e);case 68:return o.readDateTime(e);case 84:return o.readTime(e);case 103:return o.readGuid(e);case 108:switch(e.longType){case"number":return i.readInt(s);case"bigint":if("undefined"!=typeof BigInt)return BigInt(s.readUntil(59));case"string":return s.readUntil(59)}break;case 100:return i.readDouble(s);case 78:return NaN;case 73:return i.readInfinity(s);case 117:return s.readString(1);case 97:return o.readArray(e);case 109:return"map"===e.dictType?o.readMap(e):function(e){var t=e.stream,r=Object.create(null);e.addReference(r);for(var o=i.readCount(t),s=n.StringDeserializer.instance,l=a.instance;o>0;--o){var c=s.deserialize(e),u=l.deserialize(e);r[c]=u}return t.readByte(),r}(e);case 69:return new Error(e.deserialize(String));default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);return DefaultDeserializer.DefaultDeserializer=a,DefaultDeserializer}function requireNullDeserializer(){if(hasRequiredNullDeserializer)return NullDeserializer;hasRequiredNullDeserializer=1;var e=NullDeserializer&&NullDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(NullDeserializer,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.read=function(e,r){return 110===r?null:t.prototype.read.call(this,e,r)},r.instance=new r,r}(requireDefaultDeserializer().DefaultDeserializer);return NullDeserializer.NullDeserializer=t,NullDeserializer}function requireDeserializer(){if(hasRequiredDeserializer)return Deserializer;hasRequiredDeserializer=1,Object.defineProperty(Deserializer,"__esModule",{value:!0});var e=requireByteStream(),t=requireArrayDeserializer(),r=requireTypedArrayDeserializer(),n=requireFunctionDeserializer(),i=requireNumberDeserializer(),o=requireBooleanDeserializer(),a=requireStringDeserializer(),s=requireDateDeserializer(),l=requireByteStreamDeserializer(),c=requireSetDeserializer(),u=requireMapDeserializer(),h=requireGuidDeserializer(),d=requireErrorDeserializer(),p=requireNullDeserializer(),f=requireDefaultDeserializer(),m=requireGuid(),g=new Map;return Deserializer.register=function(e,t){g.set(e,t)},Deserializer.getInstance=function(y){if(y){switch(y){case Function:return n.FunctionDeserializer.instance;case Number:return i.NumberDeserializer.instance;case Boolean:return o.BooleanDeserializer.instance;case String:return a.StringDeserializer.instance;case Date:return s.DateDeserializer.instance;case Array:return t.ArrayDeserializer.instance;case e.ByteStream:return l.ByteStreamDeserializer.instance;case Uint8Array:return r.Uint8ArrayDeserializer.instance;case Uint8ClampedArray:return r.Uint8ClampedArrayDeserializer.instance;case Uint16Array:return r.Uint16ArrayDeserializer.instance;case Uint32Array:return r.Uint32ArrayDeserializer.instance;case Int8Array:return r.Int8ArrayDeserializer.instance;case Int16Array:return r.Int16ArrayDeserializer.instance;case Int32Array:return r.Int32ArrayDeserializer.instance;case Float32Array:return r.Float32ArrayDeserializer.instance;case Float64Array:return r.Float64ArrayDeserializer.instance;case Set:return c.SetDeserializer.instance;case Map:return u.MapDeserializer.instance;case m.Guid:return h.GuidDeserializer.instance;case Error:return d.ErrorDeserializer.instance}var _=g.get(y);if(void 0!==_)return _}return null===y?p.NullDeserializer.instance:f.DefaultDeserializer.instance},Deserializer}var BigIntDeserializer={},hasRequiredBigIntDeserializer;function requireBigIntDeserializer(){if(hasRequiredBigIntDeserializer)return BigIntDeserializer;hasRequiredBigIntDeserializer=1;var e=BigIntDeserializer&&BigIntDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=BigIntDeserializer&&BigIntDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(BigIntDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=requireDeserializer(),i=t(requireReferenceReader());if("undefined"!=typeof BigInt){var o=function(t){function r(){return t.call(this,"bigint")||this}return e(r,t),r.prototype.read=function(e,r){if(r>=48&&r<=57)return BigInt(r-48);var n=e.stream;switch(r){case 105:case 108:case 100:return BigInt(n.readUntil(59));case 116:return BigInt(1);case 102:case 101:return BigInt(0);case 115:return BigInt(i.readString(e));case 117:return BigInt(n.readString(1).charCodeAt(1));case 68:return BigInt(i.readDateTime(e).getTime());case 84:return BigInt(i.readTime(e).getTime());case 114:var o=e.readReference();return o instanceof Date?BigInt(o.getTime()):BigInt(o.toString());default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);n.register(BigInt,o.instance)}return BigIntDeserializer}var BigIntArrayDeserializer={},hasRequiredBigIntArrayDeserializer,hasRequiredReader;function requireBigIntArrayDeserializer(){if(hasRequiredBigIntArrayDeserializer)return BigIntArrayDeserializer;hasRequiredBigIntArrayDeserializer=1;var e=BigIntArrayDeserializer&&BigIntArrayDeserializer.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t=BigIntArrayDeserializer&&BigIntArrayDeserializer.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(BigIntArrayDeserializer,"__esModule",{value:!0});var r=requireBaseDeserializer(),n=requireDeserializer(),i=t(requireValueReader());function o(e,t){var r=e.stream,o=i.readCount(r),a=new t(o);e.addReference(a);for(var s=n.getInstance(BigInt),l=0;l<o;++l)a[l]=s.deserialize(e);return r.readByte(),a}if("undefined"!=typeof BigInt64Array){var a=new BigInt64Array(0),s=function(t){function r(){return t.call(this,"BigInt64Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return a;case 97:return o(e,BigInt64Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);n.register(BigInt64Array,s.instance)}if("undefined"!=typeof BigUint64Array){var l=new BigUint64Array(0),c=function(t){function r(){return t.call(this,"BigUint64Array")||this}return e(r,t),r.prototype.read=function(e,r){switch(r){case 101:return l;case 97:return o(e,BigUint64Array);default:return t.prototype.read.call(this,e,r)}},r.instance=new r,r}(r.BaseDeserializer);n.register(BigUint64Array,c.instance)}return BigIntArrayDeserializer}function requireReader(){if(hasRequiredReader)return Reader;hasRequiredReader=1;var e=Reader&&Reader.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Reader,"__esModule",{value:!0});var t=requireValueReader(),r=e(requireTypeManager()),n=e(requireDeserializer());requireBigIntDeserializer(),requireBigIntArrayDeserializer();var i=function(){function e(){this.ref=[]}return Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.ref.length-1},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this.ref.push(e)},e.prototype.set=function(e,t){this.ref[e]=t},e.prototype.read=function(e){return this.ref[e]},e.prototype.reset=function(){this.ref.length=0},e}(),o=function(){function e(e,t){void 0===t&&(t=!1),this.stream=e,this.ref=[],this.longType="number",this.dictType="object",this.simple=t}return Object.defineProperty(e.prototype,"simple",{get:function(){return void 0===this.refer},set:function(e){this.refer=e?void 0:new i},enumerable:!0,configurable:!0}),e.prototype.deserialize=function(e){return n.getInstance(e).deserialize(this)},e.prototype.read=function(e,t){return n.getInstance(t).read(this,e)},e.prototype.readClass=function(){for(var e=this.stream,i=t.readString(e),o=t.readCount(e),a=new Array(o),s=n.getInstance(String),l=0;l<o;++l)a[l]=s.deserialize(this);e.readByte(),this.ref.push({name:i,names:a,type:r.getType(i)})},e.prototype.getTypeInfo=function(e){return this.ref[e]},e.prototype.readReference=function(){return this.refer?this.refer.read(t.readInt(this.stream)):void 0},e.prototype.addReference=function(e){this.refer&&this.refer.add(e)},e.prototype.setReference=function(e,t){this.refer&&this.refer.set(e,t)},Object.defineProperty(e.prototype,"lastReferenceIndex",{get:function(){return this.refer?this.refer.lastIndex:-1},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.refer&&this.refer.reset(),this.ref.length=0},e}();return Reader.Reader=o,Reader}var Formatter={},hasRequiredFormatter,hasRequiredLib$6,hasRequiredClientCodec;function requireFormatter(){if(hasRequiredFormatter)return Formatter;hasRequiredFormatter=1,Object.defineProperty(Formatter,"__esModule",{value:!0});var e=requireByteStream(),t=requireWriter(),r=requireReader();return Formatter.serialize=function(r,n,i){var o=new e.ByteStream;return new t.Writer(o,n,i).serialize(r),o.bytes},Formatter.deserialize=function(t,n,i){return t instanceof e.ByteStream||(t=new e.ByteStream(t)),new r.Reader(t,i).deserialize(n)},Formatter}function requireLib$6(){if(hasRequiredLib$6)return lib$6;hasRequiredLib$6=1;var e=lib$6&&lib$6.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(lib$6,"__esModule",{value:!0});var t=requireByteStream();lib$6.ByteStream=t.ByteStream,lib$6.writeInt32BE=t.writeInt32BE,lib$6.writeInt32LE=t.writeInt32LE,lib$6.fromUint8Array=t.fromUint8Array,lib$6.toBinaryString=t.toBinaryString;var r=requireWriter();lib$6.Writer=r.Writer;var n=requireReader();lib$6.Reader=n.Reader;var i=e(requireTypeManager());lib$6.TypeManager=i;var o=e(requireSerializer());lib$6.Serializer=o;var a=e(requireDeserializer());lib$6.Deserializer=a;var s=e(requireFormatter());lib$6.Formatter=s;var l=e(requireReferenceReader());lib$6.ReferenceReader=l;var c=e(requireValueReader());lib$6.ValueReader=c;var u=e(requireValueWriter());return lib$6.ValueWriter=u,lib$6}function requireClientCodec(){if(hasRequiredClientCodec)return ClientCodec;hasRequiredClientCodec=1,Object.defineProperty(ClientCodec,"__esModule",{value:!0});var e=requireLib$6(),t=function(){function t(){this.simple=!1,this.utc=!1,this.longType="number",this.dictType="object"}return t.prototype.encode=function(t,r,n){var i=new e.ByteStream,o=new e.Writer(i,this.simple,this.utc),a=n.requestHeaders;this.simple&&(a.simple=!0);var s=0;for(var l in a)s++;return s>0&&(i.writeByte(72),o.serialize(a),o.reset()),i.writeByte(67),o.serialize(t),r.length>0&&(o.reset(),o.serialize(r)),i.writeByte(122),i.takeBytes()},t.prototype.decode=function(t,r){var n=new e.ByteStream(t),i=new e.Reader(n,!1);i.longType=this.longType,i.dictType=this.dictType;var o=n.readByte();if(72===o){var a=i.deserialize();for(var s in a)r.responseHeaders[s]=a[s];i.reset(),o=n.readByte()}switch(o){case 82:return r.responseHeaders.simple&&(i.simple=!0),i.deserialize(r.returnType);case 69:throw new Error(i.deserialize(String));case 122:return null===r.type?null:void 0;default:throw new Error("Invalid response:\r\n"+n.toString())}},t.instance=new t,t}();return ClientCodec.DefaultClientCodec=t,ClientCodec}var ClientContext={},Context={},hasRequiredContext,hasRequiredClientContext;function requireContext(){if(hasRequiredContext)return Context;hasRequiredContext=1,Object.defineProperty(Context,"__esModule",{value:!0});var e=function(){function e(){this.requestHeaders=Object.create(null),this.responseHeaders=Object.create(null)}return e.prototype.copy=function(e,t){if(e)for(var r in e)"requestHeaders"===r||"responseHeaders"===r||e.hasOwnProperty&&!e.hasOwnProperty(r)||(t[r]=e[r])},e.prototype.clone=function(){var e=Object.create(this.constructor.prototype);return this.copy(this,e),this.copy(this.requestHeaders,e.requestHeaders),this.copy(this.responseHeaders,e.responseHeaders),e},e}();return Context.Context=e,Context}function requireClientContext(){if(hasRequiredClientContext)return ClientContext;hasRequiredClientContext=1;var e=ClientContext&&ClientContext.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ClientContext,"__esModule",{value:!0});var t=function(t){function r(e){var r=t.call(this)||this;return e&&(r.copy(e,r),"requestHeaders"in e&&r.copy(e.requestHeaders,r.requestHeaders)),r}return e(r,t),r.prototype.init=function(e,t){this.client=e,e.uris.length>0&&(this.uri=e.uris[0]),void 0===this.returnType&&(this.returnType=t),void 0===this.timeout&&(this.timeout=e.timeout),this.copy(e.requestHeaders,this.requestHeaders)},r}(requireContext().Context);return ClientContext.ClientContext=t,ClientContext}var InvokeManager={},PluginManager={},hasRequiredPluginManager,hasRequiredInvokeManager;function requirePluginManager(){if(hasRequiredPluginManager)return PluginManager;hasRequiredPluginManager=1,Object.defineProperty(PluginManager,"__esModule",{value:!0});var e=function(){function e(e){this.defaultHandler=e,this.handlers=[],this.firstHandler=e}return e.prototype.rebuildHandler=function(){for(var e=this.handlers,t=this.defaultHandler,r=e.length-1;r>=0;--r)t=this.getNextHandler(e[r],t);this.firstHandler=t},Object.defineProperty(e.prototype,"handler",{get:function(){return this.firstHandler},enumerable:!0,configurable:!0}),e.prototype.use=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.handlers).push.apply(e,t),this.rebuildHandler()},e.prototype.unuse=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=!1,n=0,i=e.length;n<i;++n){var o=this.handlers.indexOf(e[n]);o>=0&&(this.handlers.splice(o,1),r=!0)}r&&this.rebuildHandler()},e}();return PluginManager.PluginManager=e,PluginManager}function requireInvokeManager(){if(hasRequiredInvokeManager)return InvokeManager;hasRequiredInvokeManager=1;var e=InvokeManager&&InvokeManager.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(InvokeManager,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.getNextHandler=function(e,t){return function(r,n,i){return e(r,n,i,t)}},r}(requirePluginManager().PluginManager);return InvokeManager.InvokeManager=t,InvokeManager}var IOManager={},hasRequiredIOManager;function requireIOManager(){if(hasRequiredIOManager)return IOManager;hasRequiredIOManager=1;var e=IOManager&&IOManager.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(IOManager,"__esModule",{value:!0});var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.getNextHandler=function(e,t){return function(r,n){return e(r,n,t)}},r}(requirePluginManager().PluginManager);return IOManager.IOManager=t,IOManager}var Utils={},hasRequiredUtils$3,hasRequiredClient;function requireUtils$3(){if(hasRequiredUtils$3)return Utils;hasRequiredUtils$3=1,Object.defineProperty(Utils,"__esModule",{value:!0}),Utils.parseURI=function(e){var t=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(r){var n=r[4].split(":",2);return{protocol:r[1],host:r[4],hostname:n[0],port:parseInt(n[1],10)||0,path:r[5],query:r[7],fragment:r[9]}}throw new Error("Invalid URI")},Utils.normalize=function(e){for(var t=[Object.create(null)],r=0,n=e.length;r<n;++r){var i=e[r].split("_"),o=i.length-1;if(o>0){for(var a=t,s=0;s<o;s++){var l=i[s];void 0===a[0][l]&&(a[0][l]=[Object.create(null)]),a=a[0][l]}a.push(i[o])}t.push(e[r])}return t},Utils.promisify=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new Promise((function(n,i){r.push(function(e,t){return function(){switch(arguments.length){case 1:var r=arguments[0];r instanceof Error?t(r):e(r);break;case 2:var n=arguments[0],i=arguments[1];n instanceof Error?t(n):i instanceof Error?t(i):e(void 0===n?i:n)}}}(n,i));try{e.apply(t,r)}catch(o){i(o)}}))}};var e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];return Utils.crc32=function(t,r){void 0===r&&(r=0),r=~r;for(var n=0,i=t.length;n<i;++n)r=r>>>8^e[255&(r^t[n])];return~r},Utils}function requireClient(){if(hasRequiredClient)return Client;hasRequiredClient=1;var e=Client&&Client.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=Client&&Client.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(Client,"__esModule",{value:!0});var r=requireClientCodec(),n=requireClientContext(),i=requireInvokeManager(),o=requireIOManager(),a=requireUtils$3();function s(e,t){return function(){var r=Array.prototype.slice.call(arguments),i=r.length>0&&r[r.length-1]instanceof n.ClientContext?r.pop():new n.ClientContext;return e.invoke(t,r,i)}}function l(e,t,r,n,i){if(void 0===t[n]){t[n]=Object.create(null),Array.isArray(i)||(i=[i]),r=r+n+"_";for(var o=0;o<i.length;o++){var a=i[o];if("string"==typeof a)t[n][a]=s(e,r+a);else for(var c in a)l(e,t[n],r,c,a[c])}}}function c(e,t){for(var r=a.normalize(t),n=Object.create(null),i=0;i<r.length;i++){var o=r[i];if("string"==typeof o)void 0===n[o]&&(n[o]=s(e,o));else for(var c in o)l(e,n,"",c,o[c])}return n}var u=function(){function e(e,t){this.client=e,this.namespace=t}return e.prototype.get=function(t,r,n){if("symbol"!=typeof r&&"then"!==r)return r in t||(t[r]=new Proxy((function(){}),new e(this.client,this.namespace?this.namespace+"_"+r:""+r))),t[r]},e.prototype.apply=function(e,t,r){if(this.namespace){var i=r.length>0&&r[r.length-1]instanceof n.ClientContext?r.pop():new n.ClientContext;return this.client.invoke(this.namespace,r,i)}throw new TypeError("target is not a function")},e}(),h=function(){function l(e){var t,n=this;this.returnTypes=Object.create(null),this.requestHeaders=Object.create(null),this.codec=r.DefaultClientCodec.instance,this.timeout=3e4,this.urilist=[],this.transports=Object.create(null),this.invokeManager=new i.InvokeManager(this.call.bind(this)),this.ioManager=new o.IOManager(this.transport.bind(this)),l.transports.forEach((function(e){var t=e.name,r=new(0,e.ctor);n.transports[t]=r,Object.defineProperty(n,t,{get:function(){return r},set:function(e){r=e,n.transports[t]=e},enumerable:!1,configurable:!1})})),e&&("string"==typeof e?this.urilist.push(e):(t=this.urilist).push.apply(t,e))}return l.register=function(e,t){l.transports.push({name:e,ctor:t}),t.schemes.forEach((function(t){return l.protocols[t+":"]=e}))},Object.defineProperty(l.prototype,"uris",{get:function(){return this.urilist},set:function(e){e.length>0&&(this.urilist=e.slice(0),this.urilist.sort((function(){return Math.random()-.5})))},enumerable:!0,configurable:!0}),l.prototype.useService=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];switch(r.length){case 1:if(Array.isArray(r[0]))return c(this,r[0]);"string"==typeof r[0]?e=r[0]:t=r[0];break;case 2:e=r[0],t=r[1]}var i=Object.create(null);if(t){for(var o in t){var a=""+o;e&&(a=e+"_"+o),this.returnTypes[a]=t[o],i[o]=s(this,a)}return i}return new Proxy(i,new u(this,e))},l.prototype.useServiceAsync=function(){return e(this,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,this.invoke("~")];case 1:return[2,c(this,e.sent())]}}))}))},l.prototype.use=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(r.length<=0)return this;switch(r[0].length){case 4:(e=this.invokeManager).use.apply(e,r);break;case 3:(t=this.ioManager).use.apply(t,r);break;default:throw new TypeError("Invalid parameter type")}return this},l.prototype.unuse=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(r.length<=0)return this;switch(r[0].length){case 4:(e=this.invokeManager).unuse.apply(e,r);break;case 3:(t=this.ioManager).unuse.apply(t,r);break;default:throw new TypeError("Invalid parameter type")}return this},l.prototype.invoke=function(r,i,o){return void 0===i&&(i=[]),void 0===o&&(o=new n.ClientContext),e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return null===i&&(i=[]),i.length>0?[4,Promise.all(i)]:[3,2];case 1:i=t.sent(),t.label=2;case 2:return(e=o instanceof n.ClientContext?o:new n.ClientContext(o)).init(this,this.returnTypes[r]),[2,this.invokeManager.handler(r,i,e)]}}))}))},l.prototype.call=function(r,n,i){return e(this,void 0,void 0,(function(){var e,o,a;return t(this,(function(t){switch(t.label){case 0:return e=this.codec,o=e.encode(r,n,i),[4,this.request(o,i)];case 1:return a=t.sent(),[2,e.decode(a,i)]}}))}))},l.prototype.request=function(e,t){return this.ioManager.handler(e,t)},l.prototype.transport=function(r,n){return e(this,void 0,void 0,(function(){var e,i;return t(this,(function(t){if(e=a.parseURI(n.uri),void 0!==(i=l.protocols[e.protocol]))return[2,this.transports[i].transport(r,n)];throw new Error('The protocol "'+e.protocol+'" is not supported.')}))}))},l.prototype.abort=function(){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:for(r in e=[],this.transports)e.push(this.transports[r].abort());return[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},l.transports=[],l.protocols=Object.create(null),l}();return Client.Client=h,Client}var CookieManager={},hasRequiredCookieManager;function requireCookieManager(){if(hasRequiredCookieManager)return CookieManager;hasRequiredCookieManager=1,Object.defineProperty(CookieManager,"__esModule",{value:!0});var e=Object.create(null);return CookieManager.setCookie=function(t,r){function n(t){var n;if(void 0!==t){var i=t.trim().split(";"),o=Object.create(null);n=i[0].trim().split("=",2),o.name=n[0],o.value=n[1];for(var a=1;a<i.length;a++){var s=i[a].trim().split("=",2),l=s[0],c=s[1];o[l.toUpperCase()]=c}if(o.PATH){var u=o.PATH.length;u>2&&'"'===o.PATH.charAt(0)&&'"'===o.PATH.charAt(u-1)&&(o.PATH=o.PATH.substr(1,u-2))}else o.PATH="/";o.EXPIRES&&(o.EXPIRES=Date.parse(o.EXPIRES)),o.DOMAIN?o.DOMAIN=o.DOMAIN.toLowerCase():o.DOMAIN=r,o.SECURE=void 0!==o.SECURE,void 0===e[o.DOMAIN]&&(e[o.DOMAIN]=Object.create(null)),e[o.DOMAIN][o.name]=o}}for(var i in void 0===r&&(r="@"),t)if("set-cookie"===(i=i.toLowerCase())||"set-cookie2"===i){var o=t[i];(Array.isArray(o)?o:[o]).forEach(n)}},CookieManager.getCookie=function(t,r,n){t=null!=t?t:"@",r=null!=r?r:"/";var i=[];for(var o in e)if(t.indexOf(o)>-1){var a=[];for(var s in e[o]){var l=e[o][s];l.EXPIRES&&(new Date).getTime()>l.EXPIRES?a.push(s):0===r.indexOf(l.PATH)&&n===l.SECURE&&null!==l.value&&i.push(l.name+"="+l.value)}for(var c=0,u=a.length;c<u;++c)delete e[o][a[c]]}return i.length>0?i.join("; "):""},CookieManager}var Deferred={},hasRequiredDeferred;function requireDeferred(){if(hasRequiredDeferred)return Deferred;return hasRequiredDeferred=1,Object.defineProperty(Deferred,"__esModule",{value:!0}),Deferred.defer=function(){var e=Object.create(null);return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e},Deferred}var Method={},hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return Method;hasRequiredMethod=1,Object.defineProperty(Method,"__esModule",{value:!0});var e=function(){return function(e,t,r,n){if(this.method=e,this.name=t,this.target=r,this.paramTypes=n,""===t||void 0===t){if(""===e.name)throw new Error("name must not be empty");t=e.name}}}();return Method.Method=e,Method}var MethodManager={},hasRequiredMethodManager;function requireMethodManager(){if(hasRequiredMethodManager)return MethodManager;hasRequiredMethodManager=1,Object.defineProperty(MethodManager,"__esModule",{value:!0});var e=requireMethod(),t=function(){function t(){this.methods=Object.create(null),this.names=[]}return t.prototype.getNames=function(){return this.names},t.prototype.get=function(e){return(e=e.toLowerCase())in this.methods?this.methods[e]:this.methods["*"]},t.prototype.remove=function(e){delete this.methods[e.toLowerCase()];var t=this.names.indexOf(e);t>-1&&this.names.splice(t,1)},t.prototype.add=function(e){var t=e.name;if(""===t||void 0===t){if((""===(t=e.fullname)||void 0===t)&&""===(t=e.method.name))throw new Error("name must not be empty");e.name=t}this.methods[t.toLowerCase()]=e,-1===this.names.indexOf(t)&&this.names.push(t)},t.prototype.addFunction=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];switch(r.length){case 0:this.add(new e.Method(t));break;case 1:"string"==typeof r[0]?this.add(new e.Method(t,r[0])):this.add(new e.Method(t,void 0,void 0,r[0]));break;case 2:this.add(new e.Method(t,r[0],void 0,r[1]))}},t.prototype.addMethod=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if("string"==typeof t[0]){var n=t[1][t[0]];if("function"!=typeof n)throw new Error("obj[name] must be a function");this.add(new e.Method(n,t[0],t[1],t[2]))}else switch(t.length){case 2:this.add(new e.Method(t[0],void 0,t[1]));break;case 3:"string"==typeof t[2]?this.add(new e.Method(t[0],t[2],t[1])):this.add(new e.Method(t[0],void 0,t[1],t[2]));break;case 4:this.add(new e.Method(t[0],t[2],t[1],t[3]))}},t.prototype.addMissingMethod=function(t,r){var n=new e.Method(t,"*",r);n.missing=!0,3===t.length&&(n.passContext=!0),this.add(n)},t.prototype.addFunctions=function(t){for(var r,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];switch(i.length){case 1:i[0].length>1&&"string"==typeof i[0][0]?r=i[0]:n=i[0];break;case 2:r=i[0],n=i[1]}var a=t.length;if(r&&r.length!==a)throw new Error("names.length must be equal to functions.length");for(var s=0;s<a;++s)this.add(new e.Method(t[s],r?r[s]:void 0,void 0,n))},t.prototype.addMethods=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0].length;if(0!==n){var i,o,a,s=t[1];if("string"!=typeof t[0][0]){switch(i=t[0],t.length){case 3:t[2].length>0&&"string"==typeof t[2][0]?o=t[2]:a=t[2];break;case 4:o=t[2],a=t[3]}if(o&&o.length!==n)throw new Error("names.length must be equal to functions.length");for(l=0;l<n;++l)this.add(new e.Method(i[l],o?o[l]:void 0,s,a))}else{o=t[0],a=t[2];for(var l=0;l<n;++l){var c=s[o[l]];if("function"!=typeof c)throw new Error("obj[name] must be a function");this.add(new e.Method(c,o[l],s,a))}}}},t.prototype.addInstanceMethods=function(t,r){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty(n))&&"function"==typeof t[n]){var i=r?r+"_"+n:n;this.add(new e.Method(t[n],i,t))}},t}();return MethodManager.MethodManager=t,MethodManager}var TimeoutError={},hasRequiredTimeoutError;function requireTimeoutError(){if(hasRequiredTimeoutError)return TimeoutError;hasRequiredTimeoutError=1;var e=TimeoutError&&TimeoutError.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(TimeoutError,"__esModule",{value:!0});var t=function(t){function r(e){return void 0===e&&(e="timeout"),t.call(this,e)||this}return e(r,t),r}(Error);return TimeoutError.TimeoutError=t,TimeoutError}var Service={},ServiceCodec={},hasRequiredServiceCodec,hasRequiredService;function requireServiceCodec(){if(hasRequiredServiceCodec)return ServiceCodec;hasRequiredServiceCodec=1,Object.defineProperty(ServiceCodec,"__esModule",{value:!0});var e=requireLib$6(),t=function(){function t(){this.debug=!1,this.simple=!1,this.utc=!1,this.longType="number",this.dictType="object",this.nullType=void 0}return t.prototype.encode=function(t,r){var n=new e.ByteStream,i=new e.Writer(n,this.simple,this.utc),o=r.responseHeaders;this.simple&&(o.simple=!0);var a=0;for(var s in o)a++;return a>0&&(n.writeByte(72),i.serialize(o),i.reset()),t instanceof Error?(n.writeByte(69),i.serialize(this.debug&&t.stack?t.stack:t.message)):(n.writeByte(82),i.serialize(t)),n.writeByte(122),n.takeBytes()},t.prototype.decodeMethod=function(e,t){var r=t.service.get(e);if(void 0===r)throw new Error("Can't find this method "+e+"().");return t.method=r,r},t.prototype.decodeArguments=function(t,r,n){var i=r.stream,o=i.readByte();if(t.missing)return 97===o?(r.reset(),r.read(o,Array)):[];var a=[];if(97===o){r.reset();var s=e.ValueReader.readCount(i),l=t.paramTypes;if(void 0===l)l=new Array(s).fill(this.nullType);else{l.length=s;for(var c=0;c<s;++c)void 0===l[c]&&(l[c]=this.nullType)}a=new Array(s),r.addReference(a);for(c=0;c<s;++c)a[c]=r.deserialize(l[c]);i.readByte()}return a},t.prototype.decode=function(t,r){if(0===t.length)return this.decodeMethod("~",r),["~",[]];var n=new e.ByteStream(t),i=new e.Reader(n,!1);i.longType=this.longType,i.dictType=this.dictType;var o=n.readByte();if(72===o){var a=i.deserialize(this.nullType);for(var s in a)r.requestHeaders[s]=a[s];i.reset(),o=n.readByte()}switch(o){case 67:r.requestHeaders.simple&&(i.simple=!0);var l=i.deserialize(String);return[l,this.decodeArguments(this.decodeMethod(l,r),i,r)];case 122:return this.decodeMethod("~",r),["~",[]];default:throw new Error("Invalid request:\r\n"+n.toString())}},t.instance=new t,t}();return ServiceCodec.DefaultServiceCodec=t,ServiceCodec}function requireService(){if(hasRequiredService)return Service;hasRequiredService=1;var e=Service&&Service.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=Service&&Service.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},r=Service&&Service.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};Object.defineProperty(Service,"__esModule",{value:!0});var n=requireServiceCodec(),i=requireInvokeManager(),o=requireIOManager(),a=requireMethod(),s=requireMethodManager(),l=function(){function l(){var e=this;this.codec=n.DefaultServiceCodec.instance,this.maxRequestLength=2147483647,this.invokeManager=new i.InvokeManager(this.execute.bind(this)),this.ioManager=new o.IOManager(this.process.bind(this)),this.methodManager=new s.MethodManager,this.handlers=Object.create(null),this.options=Object.create(null);var t=function(t){var n=new(0,l.handlers[t])(r);r.handlers[t]=n,Object.defineProperty(r,t,{get:function(){return n},set:function(r){n=r,e.handlers[t]=r},enumerable:!0,configurable:!0})},r=this;for(var c in l.handlers)t(c);this.add(new a.Method(this.methodManager.getNames.bind(this.methodManager),"~"))}return l.register=function(e,t){l.handlers[e]=t,t.serverTypes.forEach((function(t){l.serverTypes.has(t)?l.serverTypes.get(t).push(e):l.serverTypes.set(t,[e])}))},Object.defineProperty(l.prototype,"names",{get:function(){return this.methodManager.getNames()},enumerable:!0,configurable:!0}),l.prototype.bind=function(e,t){var r=e.constructor,n=l.serverTypes;if(!n.has(r))throw new Error("This type server is not supported.");for(var i=n.get(r),o=0,a=i.length;o<a;++o)void 0!==t&&t!==i[o]||this.handlers[i[o]].bind(e);return this},l.prototype.handle=function(e,t){return this.ioManager.handler(e,t)},l.prototype.process=function(r,n){return e(this,void 0,void 0,(function(){var e,i,o,a,s,l;return t(this,(function(t){switch(t.label){case 0:e=this.codec,t.label=1;case 1:return t.trys.push([1,3,,4]),o=e.decode(r,n),a=o[0],s=o[1],[4,this.invokeManager.handler(a,s,n)];case 2:return i=t.sent(),[3,4];case 3:return l=t.sent(),i=l,[3,4];case 4:return[2,e.encode(i,n)]}}))}))},l.prototype.execute=function(r,n,i){return e(this,void 0,void 0,(function(){var e,o;return t(this,(function(t){return e=i.method,o=e.method,e.missing?e.passContext?[2,o.apply(e.target,[r,n,i])]:[2,o.apply(e.target,[r,n])]:(e.passContext&&n.push(i),[2,o.apply(e.target,n)])}))}))},l.prototype.use=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(r.length<=0)return this;switch(r[0].length){case 4:(e=this.invokeManager).use.apply(e,r);break;case 3:(t=this.ioManager).use.apply(t,r);break;default:throw new TypeError("Invalid parameter type")}return this},l.prototype.unuse=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(r.length<=0)return this;switch(r[0].length){case 4:(e=this.invokeManager).unuse.apply(e,r);break;case 3:(t=this.ioManager).unuse.apply(t,r);break;default:throw new TypeError("Invalid parameter type")}return this},l.prototype.get=function(e){return this.methodManager.get(e)},l.prototype.add=function(e){return this.methodManager.add(e),this},l.prototype.remove=function(e){return this.methodManager.remove(e),this},l.prototype.addFunction=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.methodManager).addFunction.apply(t,r([e],n)),this},l.prototype.addMethod=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.methodManager).addMethod.apply(e,r([t[0],t[1]],t.slice(2))),this},l.prototype.addMissingMethod=function(e,t){return this.methodManager.addMissingMethod(e,t),this},l.prototype.addFunctions=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.methodManager).addFunctions.apply(t,r([e],n)),this},l.prototype.addMethods=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.methodManager).addMethods.apply(e,r([t[0],t[1]],t.slice(2))),this},l.prototype.addInstanceMethods=function(e,t){return this.methodManager.addInstanceMethods(e,t),this},l.handlers=Object.create(null),l.serverTypes=new Map,l}();return Service.Service=l,Service}var ServiceContext={},hasRequiredServiceContext;function requireServiceContext(){if(hasRequiredServiceContext)return ServiceContext;hasRequiredServiceContext=1;var e=ServiceContext&&ServiceContext.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ServiceContext,"__esModule",{value:!0});var t=function(t){function r(e){var r=t.call(this)||this;return r.service=e,r}return e(r,t),r}(requireContext().Context);return ServiceContext.ServiceContext=t,ServiceContext}var MockHandler={},MockAgent={},hasRequiredMockAgent,hasRequiredMockHandler;function requireMockAgent(){if(hasRequiredMockAgent)return MockAgent;hasRequiredMockAgent=1;var e=MockAgent&&MockAgent.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=MockAgent&&MockAgent.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(MockAgent,"__esModule",{value:!0});var r=function(){function r(){}return r.register=function(e,t){r.handlers[e]=t},r.cancel=function(e){delete r.handlers[e]},r.handler=function(n,i){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){if(e=r.handlers[n])return[2,e(n,i)];throw new Error("Server is stopped")}))}))},r.handlers=Object.create(null),r}();return MockAgent.MockAgent=r,MockAgent}function requireMockHandler(){if(hasRequiredMockHandler)return MockHandler;hasRequiredMockHandler=1;var e=MockHandler&&MockHandler.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=MockHandler&&MockHandler.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(MockHandler,"__esModule",{value:!0});var r=requireServiceContext(),n=requireService(),i=requireMockAgent(),o=function(){function e(e){this.address=e}return e.prototype.close=function(){i.MockAgent.cancel(this.address)},e}();MockHandler.MockServer=o;var a=function(){function n(n){var i=this;this.service=n,this.handler=function(n,o){return e(i,void 0,void 0,(function(){var e,i;return t(this,(function(t){if(o.length>this.service.maxRequestLength)throw new Error("Request entity too large");return e=new r.ServiceContext(this.service),i={family:"mock",address:n,port:0},e.remoteAddress=i,e.localAddress=i,e.handler=this,[2,this.service.handle(o,e)]}))}))}}return n.prototype.bind=function(e){i.MockAgent.register(e.address,this.handler)},n.serverTypes=[o],n}();return MockHandler.MockHandler=a,n.Service.register("mock",a),MockHandler}var MockTransport={},hasRequiredMockTransport,hasRequiredLib$5;function requireMockTransport(){if(hasRequiredMockTransport)return MockTransport;hasRequiredMockTransport=1;var e=MockTransport&&MockTransport.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=MockTransport&&MockTransport.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(MockTransport,"__esModule",{value:!0});var r=requireClient(),n=requireUtils$3(),i=requireMockAgent(),o=requireDeferred(),a=requireTimeoutError(),s=function(){function r(){}return r.prototype.transport=function(r,s){return e(this,void 0,void 0,(function(){var e,l,c;return t(this,(function(t){return e=n.parseURI(s.uri),l=o.defer(),s.timeout>0&&(c=setTimeout((function(){l.reject(new a.TimeoutError)}),s.timeout),l.promise.then((function(){clearTimeout(c)}),(function(){clearTimeout(c)}))),i.MockAgent.handler(e.hostname,r).then((function(e){return l.resolve(e)}),(function(e){return l.reject(e)})),[2,l.promise]}))}))},r.prototype.abort=function(){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2]}))}))},r.schemes=["mock"],r}();return MockTransport.MockTransport=s,r.Client.register("mock",s),MockTransport}function requireLib$5(){if(hasRequiredLib$5)return lib$7;hasRequiredLib$5=1,Object.defineProperty(lib$7,"__esModule",{value:!0});var e=requireClient();lib$7.Client=e.Client;var t=requireClientCodec();lib$7.DefaultClientCodec=t.DefaultClientCodec;var r=requireClientContext();lib$7.ClientContext=r.ClientContext;var n=requireContext();lib$7.Context=n.Context;var i=requireCookieManager();lib$7.getCookie=i.getCookie,lib$7.setCookie=i.setCookie;var o=requireDeferred();lib$7.defer=o.defer;var a=requirePluginManager();lib$7.PluginManager=a.PluginManager;var s=requireInvokeManager();lib$7.InvokeManager=s.InvokeManager;var l=requireIOManager();lib$7.IOManager=l.IOManager;var c=requireMethod();lib$7.Method=c.Method;var u=requireMethodManager();lib$7.MethodManager=u.MethodManager;var h=requireTimeoutError();lib$7.TimeoutError=h.TimeoutError;var d=requireUtils$3();lib$7.parseURI=d.parseURI,lib$7.normalize=d.normalize,lib$7.promisify=d.promisify,lib$7.crc32=d.crc32;var p=requireService();lib$7.Service=p.Service;var f=requireServiceCodec();lib$7.DefaultServiceCodec=f.DefaultServiceCodec;var m=requireServiceContext();lib$7.ServiceContext=m.ServiceContext;var g=requireMockHandler();lib$7.MockServer=g.MockServer,lib$7.MockHandler=g.MockHandler;var y=requireMockTransport();return lib$7.MockTransport=y.MockTransport,lib$7}var libExports$4=requireLib$5(),libExports$3=requireLib$6(),lib$5={},HttpTransport={},hasRequiredHttpTransport;function requireHttpTransport(){if(hasRequiredHttpTransport)return HttpTransport;hasRequiredHttpTransport=1;var e=HttpTransport&&HttpTransport.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=HttpTransport&&HttpTransport.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(HttpTransport,"__esModule",{value:!0});var r=requireLib$5();var n=function(){function n(){this.counter=0,this.requests=Object.create(null),this.httpRequestHeaders=Object.create(null),this.onprogress=null}return n.prototype.setRequestHeaders=function(e,t){for(var r in t)if(!t.hasOwnProperty||t.hasOwnProperty(r)){var n=t[r];void 0!==n&&(Array.isArray(n)?e[r]=n.join(", "):e[r]=n+"")}},n.prototype.getRequestHeaders=function(e){var t=Object.create(null);return this.setRequestHeaders(t,this.httpRequestHeaders),e&&this.setRequestHeaders(t,e),t},n.prototype.transport=function(n,i){return e(this,void 0,void 0,(function(){var e,o,a,s,l,c,u,h,d=this;return t(this,(function(t){for(u in e=this.counter<2147483647?++this.counter:this.counter=0,o=new XMLHttpRequest,a=this,this.requests[e]=o,s=i,l=this.getRequestHeaders(s.httpRequestHeaders),c=new Promise((function(t,n){o.upload.onprogress=o.onprogress=d.onprogress,o.upload.onerror=o.onerror=function(t){delete a.requests[e],n(new Error("network error"))},o.upload.onabort=o.onabort=function(t){delete a.requests[e],n(new Error("transport abort"))},o.upload.ontimeout=o.ontimeout=function(t){delete a.requests[e],n(new r.TimeoutError)},o.onload=function(r){delete a.requests[e],s.httpStatusCode=this.status,s.httpStatusText=this.statusText,this.status>=200&&this.status<300?(s.httpResponseHeaders=function(e){var t=Object.create(null);if(e)for(var r=e.split("\r\n"),n=0,i=r.length;n<i;n++)if(""!==r[n]){var o=r[n].split(": ",2).map((function(e){return e.trim()})),a=o[0],s=o[1];(t.hasOwnProperty?t.hasOwnProperty(a):a in t)?Array.isArray(t[a])?t[a].push(s):t[a]=[t[a],s]:t[a]=s}return t}(this.getAllResponseHeaders()),t(new Uint8Array(this.response))):n(new Error(this.status+":"+this.statusText))}})),o.open("POST",i.uri,!0),o.withCredentials=!0,o.responseType="arraybuffer",o.timeout=i.timeout,l)o.setRequestHeader(u,l[u]);return"function"==typeof ArrayBuffer.isView?o.send(n):"function"==typeof n.buffer.slice?o.send(n.buffer.slice(n.byteOffset,n.length)):((h=new Uint8Array(n.length)).set(n),o.send(h.buffer)),[2,c]}))}))},n.prototype.abort=function(){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){for(e in this.requests)r=this.requests[e],delete this.requests[e],r&&r.abort();return[2]}))}))},n.schemes=["http","https"],n}();return HttpTransport.HttpTransport=n,r.Client.register("http",n),HttpTransport}var WebSocketTransport={},hasRequiredWebSocketTransport,hasRequiredLib$4;function requireWebSocketTransport(){if(hasRequiredWebSocketTransport)return WebSocketTransport;hasRequiredWebSocketTransport=1;var e=WebSocketTransport&&WebSocketTransport.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},t=WebSocketTransport&&WebSocketTransport.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(WebSocketTransport,"__esModule",{value:!0});var r=requireLib$5(),n=requireLib$6(),i=function(){function i(){this.counter=0,this.results=Object.create(null),this.websockets=Object.create(null)}return i.prototype.connect=function(i){return e(this,void 0,void 0,(function(){var o,a,s,l=this;return t(this,(function(c){switch(c.label){case 0:return[4,this.websockets[i]];case 1:return void 0!==(o=c.sent())&&o.readyState!==WebSocket.CLOSING&&o.readyState!==WebSocket.CLOSED?[2,o]:(a=r.defer(),(o=new WebSocket(i,"hprose")).binaryType="arraybuffer",o.onopen=function(){return a.resolve(o)},o.onmessage=function(r){return e(l,void 0,void 0,(function(){var e,o,a;return t(this,(function(t){return e=new n.ByteStream(r.data),o=e.readInt32BE(),a=this.results[i][o],delete this.results[i][o],a&&a.resolve(e.remains),[2]}))}))},s=function(e){var t=l.results[i];if(t)for(var r in t){var n=t[r];delete t[r],n.reject(e)}delete l.websockets[i]},o.onerror=function(e){return s(new Error("error"))},o.onclose=function(e){e.reason?s(new Error(e.code+":"+e.reason)):s(new Error(""+e.code))},this.websockets[i]=a.promise,[2,a.promise])}}))}))},i.prototype.transport=function(i,o){return e(this,void 0,void 0,(function(){var e,a,s,l,c,u,h,d=this;return t(this,(function(t){switch(t.label){case 0:return e=o.uri,a=this.counter<2147483647?++this.counter:this.counter=0,s=r.defer(),[4,this.connect(e)];case 1:return l=t.sent(),void 0===this.results[e]&&(this.results[e]=Object.create(null)),this.results[e][a]=s,o.timeout>0&&(c=setTimeout((function(){delete d.results[e][a],s.reject(new r.TimeoutError)}),o.timeout),s.promise.then((function(){clearTimeout(c)}),(function(){clearTimeout(c)}))),(u=new n.ByteStream(4+i.length)).writeInt32BE(a),u.write(i),h=u.takeBytes(),"function"==typeof ArrayBuffer.isView?l.send(h):l.send(h.buffer),[2,s.promise]}}))}))},i.prototype.abort=function(){return e(this,void 0,void 0,(function(){var e,r,n,i,o;return t(this,(function(t){switch(t.label){case 0:for(r in e=[],this.websockets)e.push(r);n=0,t.label=1;case 1:return n<e.length?(i=e[n],o=this.websockets[i],delete this.websockets[i],o?[4,o]:[3,3]):[3,4];case 2:t.sent().close(1e3),t.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},i.schemes=["ws","wss"],i}();return WebSocketTransport.WebSocketTransport=i,r.Client.register("websocket",i),WebSocketTransport}function requireLib$4(){if(hasRequiredLib$4)return lib$5;hasRequiredLib$4=1,Object.defineProperty(lib$5,"__esModule",{value:!0});var e=requireHttpTransport();lib$5.HttpTransport=e.HttpTransport;var t=requireWebSocketTransport();return lib$5.WebSocketTransport=t.WebSocketTransport,lib$5}var libExports$2=requireLib$4(),lib$4={exports:{}},dist$3={},hasRequiredDist$1,safer_1,hasRequiredSafer;function requireDist$1(){return hasRequiredDist$1||(hasRequiredDist$1=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});for(var t={},r={byteLength:function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=l(e),a=n[0],s=n[1],c=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),u=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===s&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[u++]=255&t);1===s&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},fromByteArray:function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,l=r-i;s<l;s+=a)o.push(c(e,s,s+a>l?l:s+a));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")}},n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63;var u={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=f,a/=256,c-=8);e[r+p-f]|=128*m}};
/*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     */
!function(e){const t=r,n=u,i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=h,e.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},e.INSPECT_MAX_BYTES=50;const o=2147483647;e.kMaxLength=o;const{Uint8Array:a,ArrayBuffer:s,SharedArrayBuffer:l}=globalThis;function c(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new a(e);return Object.setPrototypeOf(t,h.prototype),t}function h(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return d(e,t,r)}function d(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!h.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|_(e,t);let n=c(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(s.isView(e))return function(e){if(Q(e,a)){const t=new a(e);return g(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,s)||e&&Q(e.buffer,s))return g(e,t,r);if(void 0!==l&&(Q(e,l)||e&&Q(e.buffer,l)))return g(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return h.from(n,t,r);const i=function(e){if(h.isBuffer(e)){const t=0|y(e.length),r=c(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||J(e.length)?c(0):m(e);if("Buffer"===e.type&&Array.isArray(e.data))return m(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function p(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function f(e){return p(e),c(e<0?0:0|y(e))}function m(e){const t=e.length<0?0:0|y(e.length),r=c(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function g(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new a(e):void 0===r?new a(e,t):new a(e,t,r),Object.setPrototypeOf(n,h.prototype),n}function y(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function _(e,t){if(h.isBuffer(e))return e.length;if(s.isView(e)||Q(e,s))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(e).length;default:if(i)return n?-1:Y(e).length;t=(""+t).toLowerCase(),i=!0}}function v(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,r);case"utf8":case"utf-8":return k(this,t,r);case"ascii":return M(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),J(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=h.from(t,n)),h.isBuffer(t))return 0===t.length?-1:x(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof a.prototype.indexOf?i?a.prototype.indexOf.call(e,t,r):a.prototype.lastIndexOf.call(e,t,r):x(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function x(e,t,r,n,i){let o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*a}else-1!==n&&(o-=o-n),n=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){let r=!0;for(let n=0;n<l;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return-1}function S(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let a;for(n>o/2&&(n=o/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(J(n))return a;e[r+a]=n}return a}function E(e,t,r,n){return K(Y(t,e.length-r),e,r,n)}function T(e,t,r,n){return K(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function A(e,t,r,n){return K(X(t),e,r,n)}function C(e,t,r,n){return K(function(e,t){let r,n,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function k(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(o=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=a}return function(e){const t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=P));return r}(n)}h.TYPED_ARRAY_SUPPORT=function(){try{const e=new a(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,a.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),!h.TYPED_ARRAY_SUPPORT&&"undefined"!=typeof console&&console.error,Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(e,t,r){return d(e,t,r)},Object.setPrototypeOf(h.prototype,a.prototype),Object.setPrototypeOf(h,a),h.alloc=function(e,t,r){return function(e,t,r){return p(e),e<=0?c(e):void 0!==t?"string"==typeof r?c(e).fill(t,r):c(e).fill(t):c(e)}(e,t,r)},h.allocUnsafe=function(e){return f(e)},h.allocUnsafeSlow=function(e){return f(e)},h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(Q(e,a)&&(e=h.from(e,e.offset,e.byteLength)),Q(t,a)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=h.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(Q(t,a))i+t.length>n.length?(h.isBuffer(t)||(t=h.from(t)),t.copy(n,i)):a.prototype.set.call(n,t,i);else{if(!h.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},h.byteLength=_,h.prototype._isBuffer=!0,h.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)b(this,t,t+1);return this},h.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},h.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},h.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):v.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(e){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},i&&(h.prototype[i]=h.prototype.inspect),h.prototype.compare=function(e,t,r,n,i){if(Q(e,a)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const l=Math.min(o,s),c=this.slice(n,i),u=e.slice(t,r);for(let a=0;a<l;++a)if(c[a]!==u[a]){o=c[a],s=u[a];break}return o<s?-1:s<o?1:0},h.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},h.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return S(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return T(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const P=4096;function M(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function R(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function D(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=t;o<r;++o)i+=ee[e[o]];return i}function O(e,t,r){const n=e.slice(t,r);let i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function L(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,o){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function $(e,t,r,n,i){G(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function z(e,t,r,n,i){G(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function F(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function q(e,t,r,i,o){return t=+t,r>>>=0,o||F(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function N(e,t,r,i,o){return t=+t,r>>>=0,o||F(e,0,r,8),n.write(e,t,r,i,52,8),r+8}h.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,h.prototype),n},h.prototype.readUintLE=h.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},h.prototype.readUintBE=h.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},h.prototype.readUint8=h.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readBigUInt64LE=te((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),h.prototype.readBigUInt64BE=te((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),h.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},h.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||L(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},h.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readBigInt64LE=te((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),h.prototype.readBigInt64BE=te((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||H(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),h.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),n.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),n.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),n.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),n.read(this,e,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){B(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){B(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},h.prototype.writeUint8=h.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigUInt64LE=te((function(e,t=0){return $(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeBigUInt64BE=te((function(e,t=0){return z(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+r},h.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=r-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigInt64LE=te((function(e,t=0){return $(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeBigInt64BE=te((function(e,t=0){return z(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeFloatLE=function(e,t,r){return q(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return q(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,n){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof a.prototype.copyWithin?this.copyWithin(t,r,n):a.prototype.set.call(e,this.subarray(r,n),t),i},h.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=h.isBuffer(e)?e:h.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};const j={};function U(e,t,r){j[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function V(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function G(e,t,r,n,i,o){if(e>r||e<t){const r="bigint"==typeof t?"n":"";let n;throw n=0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`,new j.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){W(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||H(t,e.length-(r+1))}(n,i,o)}function W(e,t){if("number"!=typeof e)throw new j.ERR_INVALID_ARG_TYPE(t,"number",e)}function H(e,t,r){if(Math.floor(e)!==e)throw W(e,r),new j.ERR_OUT_OF_RANGE("offset","an integer",e);if(t<0)throw new j.ERR_BUFFER_OUT_OF_BOUNDS;throw new j.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=V(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=V(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function Y(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function X(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const ee=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function te(e){return"undefined"==typeof BigInt?re:e}function re(){throw new Error("BigInt not supported")}}(t);const h=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=h,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(dist$3)),dist$3}function requireSafer(){if(hasRequiredSafer)return safer_1;hasRequiredSafer=1;var e,t=requireDist$1(),r=t.Buffer,n={};for(e in t)t.hasOwnProperty(e)&&"SlowBuffer"!==e&&"Buffer"!==e&&(n[e]=t[e]);var i=n.Buffer={};for(e in r)r.hasOwnProperty(e)&&"allocUnsafe"!==e&&"allocUnsafeSlow"!==e&&(i[e]=r[e]);if(n.Buffer.prototype=r.prototype,i.from&&i.from!==Uint8Array.from||(i.from=function(e,t,n){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return r(e,t,n)}),i.alloc||(i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var i=r(e);return t&&0!==t.length?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i}),!n.kStringMaxLength)try{n.kStringMaxLength=process$1.binding("buffer").kStringMaxLength}catch(o){}return n.constants||(n.constants={MAX_LENGTH:n.kMaxLength},n.kStringMaxLength&&(n.constants.MAX_STRING_LENGTH=n.kStringMaxLength)),safer_1=n}var bomHandling={},hasRequiredBomHandling,mergeExports,hasRequiredMergeExports;function requireBomHandling(){if(hasRequiredBomHandling)return bomHandling;hasRequiredBomHandling=1;function e(e,t){this.encoder=e,this.addBOM=!0}function t(e,t){this.decoder=e,this.pass=!1,this.options=t||{}}return bomHandling.PrependBOM=e,e.prototype.write=function(e){return this.addBOM&&(e="\ufeff"+e,this.addBOM=!1),this.encoder.write(e)},e.prototype.end=function(){return this.encoder.end()},bomHandling.StripBOM=t,t.prototype.write=function(e){var t=this.decoder.write(e);return this.pass||!t||("\ufeff"===t[0]&&(t=t.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0),t},t.prototype.end=function(){return this.decoder.end()},bomHandling}function requireMergeExports(){if(hasRequiredMergeExports)return mergeExports;hasRequiredMergeExports=1;var e=void 0===Object.hasOwn?Function.call.bind(Object.prototype.hasOwnProperty):Object.hasOwn;return mergeExports=function(t,r){for(var n in r)e(r,n)&&(t[n]=r[n])}}var encodings={},string_decoder={},safeBuffer={exports:{}},hasRequiredSafeBuffer,hasRequiredString_decoder,internal,hasRequiredInternal;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(e,t){var r=requireDist$1(),n=r.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),o.prototype=Object.create(n.prototype),i(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(safeBuffer,safeBuffer.exports)),safeBuffer.exports}function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var e=requireSafeBuffer().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(r){var n;switch(this.encoding=function(r){var n=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(r);if("string"!=typeof n&&(e.isEncoding===t||!t(r)))throw new Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=o,this.end=a,n=4;break;case"utf8":this.fillLast=i,n=4;break;case"base64":this.text=s,this.end=l,n=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(n)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function o(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function a(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function s(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return string_decoder.StringDecoder=r,r.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},r.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var o=n(t[i]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(e.lastNeed=o-2),o;if(--i<r||-2===o)return 0;if(o=n(t[i]),o>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},string_decoder}function requireInternal(){if(hasRequiredInternal)return internal;hasRequiredInternal=1;var e=requireSafer().Buffer;function t(t,r){this.enc=t.encodingName,this.bomAware=t.bomAware,"base64"===this.enc?this.encoder=o:"utf8"===this.enc?this.encoder=l:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=a,""!==e.from("eda0bdedb2a9","hex").toString()&&(this.decoder=s,this.defaultCharUnicode=r.defaultCharUnicode))}internal={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:t},t.prototype.encoder=i,t.prototype.decoder=n;var r=requireString_decoder().StringDecoder;function n(e,t){this.decoder=new r(t.enc)}function i(e,t){this.enc=t.enc}function o(e,t){this.prevStr=""}function a(e,t){}function s(e,t){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=t.defaultCharUnicode}function l(e,t){this.highSurrogate=""}return n.prototype.write=function(t){return e.isBuffer(t)||(t=e.from(t)),this.decoder.write(t)},n.prototype.end=function(){return this.decoder.end()},i.prototype.write=function(t){return e.from(t,this.enc)},i.prototype.end=function(){},o.prototype.write=function(t){var r=(t=this.prevStr+t).length-t.length%4;return this.prevStr=t.slice(r),t=t.slice(0,r),e.from(t,"base64")},o.prototype.end=function(){return e.from(this.prevStr,"base64")},a.prototype.write=function(t){for(var r=e.alloc(3*t.length),n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r[n++]=o:o<2048?(r[n++]=192+(o>>>6),r[n++]=128+(63&o)):(r[n++]=224+(o>>>12),r[n++]=128+(o>>>6&63),r[n++]=128+(63&o))}return r.slice(0,n)},a.prototype.end=function(){},s.prototype.write=function(e){for(var t=this.acc,r=this.contBytes,n=this.accBytes,i="",o=0;o<e.length;o++){var a=e[o];128!=(192&a)?(r>0&&(i+=this.defaultCharUnicode,r=0),a<128?i+=String.fromCharCode(a):a<224?(t=31&a,r=1,n=1):a<240?(t=15&a,r=2,n=1):i+=this.defaultCharUnicode):r>0?(t=t<<6|63&a,n++,0===--r&&(i+=2===n&&t<128&&t>0||3===n&&t<2048?this.defaultCharUnicode:String.fromCharCode(t))):i+=this.defaultCharUnicode}return this.acc=t,this.contBytes=r,this.accBytes=n,i},s.prototype.end=function(){var e=0;return this.contBytes>0&&(e+=this.defaultCharUnicode),e},l.prototype.write=function(t){if(this.highSurrogate&&(t=this.highSurrogate+t,this.highSurrogate=""),t.length>0){var r=t.charCodeAt(t.length-1);r>=55296&&r<56320&&(this.highSurrogate=t[t.length-1],t=t.slice(0,t.length-1))}return e.from(t,this.enc)},l.prototype.end=function(){if(this.highSurrogate){var t=this.highSurrogate;return this.highSurrogate="",e.from(t,this.enc)}},internal}var utf32={},hasRequiredUtf32;function requireUtf32(){if(hasRequiredUtf32)return utf32;hasRequiredUtf32=1;var e=requireSafer().Buffer;function t(e,t){this.iconv=t,this.bomAware=!0,this.isLE=e.isLE}function r(e,t){this.isLE=t.isLE,this.highSurrogate=0}function n(e,t){this.isLE=t.isLE,this.badChar=t.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}function i(e,t,r,n){if((r<0||r>1114111)&&(r=n),r>=65536){var i=55296|(r-=65536)>>10;e[t++]=255&i,e[t++]=i>>8;r=56320|1023&r}return e[t++]=255&r,e[t++]=r>>8,t}function o(e,t){this.iconv=t}function a(e,t){void 0===(e=e||{}).addBOM&&(e.addBOM=!0),this.encoder=t.iconv.getEncoder(e.defaultEncoding||"utf-32le",e)}function s(e,t){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=e||{},this.iconv=t.iconv}function l(e,t){var r=[],n=0,i=0,o=0,a=0,s=0;e:for(var l=0;l<e.length;l++)for(var c=e[l],u=0;u<c.length;u++)if(r.push(c[u]),4===r.length){if(0===n){if(255===r[0]&&254===r[1]&&0===r[2]&&0===r[3])return"utf-32le";if(0===r[0]&&0===r[1]&&254===r[2]&&255===r[3])return"utf-32be"}if((0!==r[0]||r[1]>16)&&o++,(0!==r[3]||r[2]>16)&&i++,0!==r[0]||0!==r[1]||0===r[2]&&0===r[3]||s++,0===r[0]&&0===r[1]||0!==r[2]||0!==r[3]||a++,r.length=0,++n>=100)break e}return s-o>a-i?"utf-32be":s-o<a-i?"utf-32le":t||"utf-32le"}return utf32._utf32=t,utf32.utf32le={type:"_utf32",isLE:!0},utf32.utf32be={type:"_utf32",isLE:!1},utf32.ucs4le="utf32le",utf32.ucs4be="utf32be",t.prototype.encoder=r,t.prototype.decoder=n,r.prototype.write=function(t){for(var r=e.from(t,"ucs2"),n=e.alloc(2*r.length),i=this.isLE?n.writeUInt32LE:n.writeUInt32BE,o=0,a=0;a<r.length;a+=2){var s=r.readUInt16LE(a),l=s>=55296&&s<56320,c=s>=56320&&s<57344;if(this.highSurrogate){if(!l&&c){var u=65536+(this.highSurrogate-55296<<10|s-56320);i.call(n,u,o),o+=4,this.highSurrogate=0;continue}i.call(n,this.highSurrogate,o),o+=4}l?this.highSurrogate=s:(i.call(n,s,o),o+=4,this.highSurrogate=0)}return o<n.length&&(n=n.slice(0,o)),n},r.prototype.end=function(){if(this.highSurrogate){var t=e.alloc(4);return this.isLE?t.writeUInt32LE(this.highSurrogate,0):t.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,t}},n.prototype.write=function(t){if(0===t.length)return"";var r=0,n=0,o=e.alloc(t.length+4),a=0,s=this.isLE,l=this.overflow,c=this.badChar;if(l.length>0){for(;r<t.length&&l.length<4;r++)l.push(t[r]);4===l.length&&(n=s?l[r]|l[r+1]<<8|l[r+2]<<16|l[r+3]<<24:l[r+3]|l[r+2]<<8|l[r+1]<<16|l[r]<<24,l.length=0,a=i(o,a,n,c))}for(;r<t.length-3;r+=4)a=i(o,a,n=s?t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24:t[r+3]|t[r+2]<<8|t[r+1]<<16|t[r]<<24,c);for(;r<t.length;r++)l.push(t[r]);return o.slice(0,a).toString("ucs2")},n.prototype.end=function(){this.overflow.length=0},utf32.utf32=o,utf32.ucs4="utf32",o.prototype.encoder=a,o.prototype.decoder=s,a.prototype.write=function(e){return this.encoder.write(e)},a.prototype.end=function(){return this.encoder.end()},s.prototype.write=function(e){if(!this.decoder){if(this.initialBufs.push(e),this.initialBufsLen+=e.length,this.initialBufsLen<32)return"";var t=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options);for(var r="",n=0;n<this.initialBufs.length;n++)r+=this.decoder.write(this.initialBufs[n]);return this.initialBufs.length=this.initialBufsLen=0,r}return this.decoder.write(e)},s.prototype.end=function(){if(!this.decoder){var e=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);for(var t="",r=0;r<this.initialBufs.length;r++)t+=this.decoder.write(this.initialBufs[r]);var n=this.decoder.end();return n&&(t+=n),this.initialBufs.length=this.initialBufsLen=0,t}return this.decoder.end()},utf32}var utf16={},hasRequiredUtf16;function requireUtf16(){if(hasRequiredUtf16)return utf16;hasRequiredUtf16=1;var e=requireSafer().Buffer;function t(){}function r(){}function n(){this.overflowByte=-1}function i(e,t){this.iconv=t}function o(e,t){void 0===(e=e||{}).addBOM&&(e.addBOM=!0),this.encoder=t.iconv.getEncoder("utf-16le",e)}function a(e,t){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=e||{},this.iconv=t.iconv}function s(e,t){var r=[],n=0,i=0,o=0;e:for(var a=0;a<e.length;a++)for(var s=e[a],l=0;l<s.length;l++)if(r.push(s[l]),2===r.length){if(0===n){if(255===r[0]&&254===r[1])return"utf-16le";if(254===r[0]&&255===r[1])return"utf-16be"}if(0===r[0]&&0!==r[1]&&o++,0!==r[0]&&0===r[1]&&i++,r.length=0,++n>=100)break e}return o>i?"utf-16be":o<i?"utf-16le":t||"utf-16le"}return utf16.utf16be=t,t.prototype.encoder=r,t.prototype.decoder=n,t.prototype.bomAware=!0,r.prototype.write=function(t){for(var r=e.from(t,"ucs2"),n=0;n<r.length;n+=2){var i=r[n];r[n]=r[n+1],r[n+1]=i}return r},r.prototype.end=function(){},n.prototype.write=function(t){if(0==t.length)return"";var r=e.alloc(t.length+1),n=0,i=0;for(-1!==this.overflowByte&&(r[0]=t[0],r[1]=this.overflowByte,n=1,i=2);n<t.length-1;n+=2,i+=2)r[i]=t[n+1],r[i+1]=t[n];return this.overflowByte=n==t.length-1?t[t.length-1]:-1,r.slice(0,i).toString("ucs2")},n.prototype.end=function(){this.overflowByte=-1},utf16.utf16=i,i.prototype.encoder=o,i.prototype.decoder=a,o.prototype.write=function(e){return this.encoder.write(e)},o.prototype.end=function(){return this.encoder.end()},a.prototype.write=function(e){if(!this.decoder){if(this.initialBufs.push(e),this.initialBufsLen+=e.length,this.initialBufsLen<16)return"";var t=s(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options);for(var r="",n=0;n<this.initialBufs.length;n++)r+=this.decoder.write(this.initialBufs[n]);return this.initialBufs.length=this.initialBufsLen=0,r}return this.decoder.write(e)},a.prototype.end=function(){if(!this.decoder){var e=s(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);for(var t="",r=0;r<this.initialBufs.length;r++)t+=this.decoder.write(this.initialBufs[r]);var n=this.decoder.end();return n&&(t+=n),this.initialBufs.length=this.initialBufsLen=0,t}return this.decoder.end()},utf16}var utf7={},hasRequiredUtf7;function requireUtf7(){if(hasRequiredUtf7)return utf7;hasRequiredUtf7=1;var e=requireSafer().Buffer;function t(e,t){this.iconv=t}utf7.utf7=t,utf7.unicode11utf7="utf7",t.prototype.encoder=n,t.prototype.decoder=i,t.prototype.bomAware=!0;var r=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function n(e,t){this.iconv=t.iconv}function i(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}n.prototype.write=function(t){return e.from(t.replace(r,function(e){return"+"+("+"===e?"":this.iconv.encode(e,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},n.prototype.end=function(){};for(var o=/[A-Za-z0-9\/+]/,a=[],s=0;s<256;s++)a[s]=o.test(String.fromCharCode(s));var l="+".charCodeAt(0),c="-".charCodeAt(0),u="&".charCodeAt(0);function h(e,t){this.iconv=t}function d(t,r){this.iconv=r.iconv,this.inBase64=!1,this.base64Accum=e.alloc(6),this.base64AccumIdx=0}function p(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}i.prototype.write=function(t){for(var r="",n=0,i=this.inBase64,o=this.base64Accum,s=0;s<t.length;s++)if(i){if(!a[t[s]]){if(s==n&&t[s]==c)r+="+";else{var u=o+this.iconv.decode(t.slice(n,s),"ascii");r+=this.iconv.decode(e.from(u,"base64"),"utf16-be")}t[s]!=c&&s--,n=s+1,i=!1,o=""}}else t[s]==l&&(r+=this.iconv.decode(t.slice(n,s),"ascii"),n=s+1,i=!0);if(i){var h=(u=o+this.iconv.decode(t.slice(n),"ascii")).length-u.length%8;o=u.slice(h),u=u.slice(0,h),r+=this.iconv.decode(e.from(u,"base64"),"utf16-be")}else r+=this.iconv.decode(t.slice(n),"ascii");return this.inBase64=i,this.base64Accum=o,r},i.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},utf7.utf7imap=h,h.prototype.encoder=d,h.prototype.decoder=p,h.prototype.bomAware=!0,d.prototype.write=function(t){for(var r=this.inBase64,n=this.base64Accum,i=this.base64AccumIdx,o=e.alloc(5*t.length+10),a=0,s=0;s<t.length;s++){var l=t.charCodeAt(s);l>=32&&l<=126?(r&&(i>0&&(a+=o.write(n.slice(0,i).toString("base64").replace(/\//g,",").replace(/=+$/,""),a),i=0),o[a++]=c,r=!1),r||(o[a++]=l,l===u&&(o[a++]=c))):(r||(o[a++]=u,r=!0),r&&(n[i++]=l>>8,n[i++]=255&l,i==n.length&&(a+=o.write(n.toString("base64").replace(/\//g,","),a),i=0)))}return this.inBase64=r,this.base64AccumIdx=i,o.slice(0,a)},d.prototype.end=function(){var t=e.alloc(10),r=0;return this.inBase64&&(this.base64AccumIdx>0&&(r+=t.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),r),this.base64AccumIdx=0),t[r++]=c,this.inBase64=!1),t.slice(0,r)};var f=a.slice();return f[",".charCodeAt(0)]=!0,p.prototype.write=function(t){for(var r="",n=0,i=this.inBase64,o=this.base64Accum,a=0;a<t.length;a++)if(i){if(!f[t[a]]){if(a==n&&t[a]==c)r+="&";else{var s=o+this.iconv.decode(t.slice(n,a),"ascii").replace(/,/g,"/");r+=this.iconv.decode(e.from(s,"base64"),"utf16-be")}t[a]!=c&&a--,n=a+1,i=!1,o=""}}else t[a]==u&&(r+=this.iconv.decode(t.slice(n,a),"ascii"),n=a+1,i=!0);if(i){var l=(s=o+this.iconv.decode(t.slice(n),"ascii").replace(/,/g,"/")).length-s.length%8;o=s.slice(l),s=s.slice(0,l),r+=this.iconv.decode(e.from(s,"base64"),"utf16-be")}else r+=this.iconv.decode(t.slice(n),"ascii");return this.inBase64=i,this.base64Accum=o,r},p.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},utf7}var sbcsCodec={},hasRequiredSbcsCodec,sbcsData,hasRequiredSbcsData,sbcsDataGenerated,hasRequiredSbcsDataGenerated;function requireSbcsCodec(){if(hasRequiredSbcsCodec)return sbcsCodec;hasRequiredSbcsCodec=1;var e=requireSafer().Buffer;function t(t,r){if(!t)throw new Error("SBCS codec is called without the data.");if(!t.chars||128!==t.chars.length&&256!==t.chars.length)throw new Error("Encoding '"+t.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===t.chars.length){for(var n="",i=0;i<128;i++)n+=String.fromCharCode(i);t.chars=n+t.chars}this.decodeBuf=e.from(t.chars,"ucs2");var o=e.alloc(65536,r.defaultCharSingleByte.charCodeAt(0));for(i=0;i<t.chars.length;i++)o[t.chars.charCodeAt(i)]=i;this.encodeBuf=o}function r(e,t){this.encodeBuf=t.encodeBuf}function n(e,t){this.decodeBuf=t.decodeBuf}return sbcsCodec._sbcs=t,t.prototype.encoder=r,t.prototype.decoder=n,r.prototype.write=function(t){for(var r=e.alloc(t.length),n=0;n<t.length;n++)r[n]=this.encodeBuf[t.charCodeAt(n)];return r},r.prototype.end=function(){},n.prototype.write=function(t){for(var r=this.decodeBuf,n=e.alloc(2*t.length),i=0,o=0,a=0;a<t.length;a++)i=2*t[a],n[o=2*a]=r[i],n[o+1]=r[i+1];return n.toString("ucs2")},n.prototype.end=function(){},sbcsCodec}function requireSbcsData(){return hasRequiredSbcsData?sbcsData:(hasRequiredSbcsData=1,sbcsData={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"})}function requireSbcsDataGenerated(){return hasRequiredSbcsDataGenerated?sbcsDataGenerated:(hasRequiredSbcsDataGenerated=1,sbcsDataGenerated={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}})}var dbcsCodec={},hasRequiredDbcsCodec;function requireDbcsCodec(){if(hasRequiredDbcsCodec)return dbcsCodec;hasRequiredDbcsCodec=1;var e=requireSafer().Buffer;dbcsCodec._dbcs=s;for(var t=-1,r=-2,n=-10,i=-1e3,o=new Array(256),a=0;a<256;a++)o[a]=t;function s(e,n){if(this.encodingName=e.encodingName,!e)throw new Error("DBCS codec is called without the data.");if(!e.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var a=e.table();this.decodeTables=[],this.decodeTables[0]=o.slice(0),this.decodeTableSeq=[];for(var s=0;s<a.length;s++)this._addDecodeChunk(a[s]);if("function"==typeof e.gb18030){this.gb18030=e.gb18030();var l=this.decodeTables.length;this.decodeTables.push(o.slice(0));var c=this.decodeTables.length;this.decodeTables.push(o.slice(0));var u=this.decodeTables[0];for(s=129;s<=254;s++)for(var h=this.decodeTables[i-u[s]],d=48;d<=57;d++){if(h[d]===t)h[d]=i-l;else if(h[d]>i)throw new Error("gb18030 decode tables conflict at byte 2");for(var p=this.decodeTables[i-h[d]],f=129;f<=254;f++){if(p[f]===t)p[f]=i-c;else{if(p[f]===i-c)continue;if(p[f]>i)throw new Error("gb18030 decode tables conflict at byte 3")}for(var m=this.decodeTables[i-p[f]],g=48;g<=57;g++)m[g]===t&&(m[g]=r)}}}this.defaultCharUnicode=n.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var y={};if(e.encodeSkipVals)for(s=0;s<e.encodeSkipVals.length;s++){var _=e.encodeSkipVals[s];if("number"==typeof _)y[_]=!0;else for(d=_.from;d<=_.to;d++)y[d]=!0}if(this._fillEncodeTable(0,0,y),e.encodeAdd)for(var v in e.encodeAdd)Object.prototype.hasOwnProperty.call(e.encodeAdd,v)&&this._setEncodeChar(v.charCodeAt(0),e.encodeAdd[v]);this.defCharSB=this.encodeTable[0][n.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===t&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===t&&(this.defCharSB="?".charCodeAt(0))}function l(e,t){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=t.encodeTable,this.encodeTableSeq=t.encodeTableSeq,this.defaultCharSingleByte=t.defCharSB,this.gb18030=t.gb18030}function c(e,t){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=t.decodeTables,this.decodeTableSeq=t.decodeTableSeq,this.defaultCharUnicode=t.defaultCharUnicode,this.gb18030=t.gb18030}function u(e,t){if(e[0]>t)return-1;for(var r=0,n=e.length;r<n-1;){var i=r+(n-r+1>>1);e[i]<=t?r=i:n=i}return r}return s.prototype.encoder=l,s.prototype.decoder=c,s.prototype._getDecodeTrieNode=function(e){for(var r=[];e>0;e>>>=8)r.push(255&e);0==r.length&&r.push(0);for(var n=this.decodeTables[0],a=r.length-1;a>0;a--){var s=n[r[a]];if(s==t)n[r[a]]=i-this.decodeTables.length,this.decodeTables.push(n=o.slice(0));else{if(!(s<=i))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+e.toString(16));n=this.decodeTables[i-s]}}return n},s.prototype._addDecodeChunk=function(e){var t=parseInt(e[0],16),r=this._getDecodeTrieNode(t);t&=255;for(var i=1;i<e.length;i++){var o=e[i];if("string"==typeof o)for(var a=0;a<o.length;){var s=o.charCodeAt(a++);if(s>=55296&&s<56320){var l=o.charCodeAt(a++);if(!(l>=56320&&l<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+e[0]);r[t++]=65536+1024*(s-55296)+(l-56320)}else if(s>4080&&s<=4095){for(var c=4095-s+2,u=[],h=0;h<c;h++)u.push(o.charCodeAt(a++));r[t++]=n-this.decodeTableSeq.length,this.decodeTableSeq.push(u)}else r[t++]=s}else{if("number"!=typeof o)throw new Error("Incorrect type '"+typeof o+"' given in "+this.encodingName+" at chunk "+e[0]);var d=r[t-1]+1;for(a=0;a<o;a++)r[t++]=d++}}if(t>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+e[0]+": too long"+t)},s.prototype._getEncodeBucket=function(e){var t=e>>8;return void 0===this.encodeTable[t]&&(this.encodeTable[t]=o.slice(0)),this.encodeTable[t]},s.prototype._setEncodeChar=function(e,r){var i=this._getEncodeBucket(e),o=255&e;i[o]<=n?this.encodeTableSeq[n-i[o]][-1]=r:i[o]==t&&(i[o]=r)},s.prototype._setEncodeSequence=function(e,r){var i,o=e[0],a=this._getEncodeBucket(o),s=255&o;a[s]<=n?i=this.encodeTableSeq[n-a[s]]:(i={},a[s]!==t&&(i[-1]=a[s]),a[s]=n-this.encodeTableSeq.length,this.encodeTableSeq.push(i));for(var l=1;l<e.length-1;l++){var c=i[o];"object"==typeof c?i=c:(i=i[o]={},void 0!==c&&(i[-1]=c))}i[o=e[e.length-1]]=r},s.prototype._fillEncodeTable=function(e,t,r){for(var o=this.decodeTables[e],a=!1,s={},l=0;l<256;l++){var c=o[l],u=t+l;if(!r[u])if(c>=0)this._setEncodeChar(c,u),a=!0;else if(c<=i){var h=i-c;if(!s[h]){var d=u<<8>>>0;this._fillEncodeTable(h,d,r)?a=!0:s[h]=!0}}else c<=n&&(this._setEncodeSequence(this.decodeTableSeq[n-c],u),a=!0)}return a},l.prototype.write=function(r){for(var i=e.alloc(r.length*(this.gb18030?4:3)),o=this.leadSurrogate,a=this.seqObj,s=-1,l=0,c=0;;){if(-1===s){if(l==r.length)break;var h=r.charCodeAt(l++)}else{h=s;s=-1}if(h>=55296&&h<57344)if(h<56320){if(-1===o){o=h;continue}o=h,h=t}else-1!==o?(h=65536+1024*(o-55296)+(h-56320),o=-1):h=t;else-1!==o&&(s=h,h=t,o=-1);var d=t;if(void 0!==a&&h!=t){var p=a[h];if("object"==typeof p){a=p;continue}"number"==typeof p?d=p:null==p&&void 0!==(p=a[-1])&&(d=p,s=h),a=void 0}else if(h>=0){var f=this.encodeTable[h>>8];if(void 0!==f&&(d=f[255&h]),d<=n){a=this.encodeTableSeq[n-d];continue}if(d==t&&this.gb18030){var m=u(this.gb18030.uChars,h);if(-1!=m){d=this.gb18030.gbChars[m]+(h-this.gb18030.uChars[m]);i[c++]=129+Math.floor(d/12600),d%=12600,i[c++]=48+Math.floor(d/1260),d%=1260,i[c++]=129+Math.floor(d/10),d%=10,i[c++]=48+d;continue}}}d===t&&(d=this.defaultCharSingleByte),d<256?i[c++]=d:d<65536?(i[c++]=d>>8,i[c++]=255&d):d<16777216?(i[c++]=d>>16,i[c++]=d>>8&255,i[c++]=255&d):(i[c++]=d>>>24,i[c++]=d>>>16&255,i[c++]=d>>>8&255,i[c++]=255&d)}return this.seqObj=a,this.leadSurrogate=o,i.slice(0,c)},l.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var t=e.alloc(10),r=0;if(this.seqObj){var n=this.seqObj[-1];void 0!==n&&(n<256?t[r++]=n:(t[r++]=n>>8,t[r++]=255&n)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(t[r++]=this.defaultCharSingleByte,this.leadSurrogate=-1),t.slice(0,r)}},l.prototype.findIdx=u,c.prototype.write=function(o){for(var a=e.alloc(2*o.length),s=this.nodeIdx,l=this.prevBytes,c=this.prevBytes.length,h=-this.prevBytes.length,d=0,p=0;d<o.length;d++){var f,m=d>=0?o[d]:l[d+c];if((f=this.decodeTables[s][m])>=0);else if(f===t)f=this.defaultCharUnicode.charCodeAt(0),d=h;else if(f===r){if(d>=3)var g=12600*(o[d-3]-129)+1260*(o[d-2]-48)+10*(o[d-1]-129)+(m-48);else g=12600*(l[d-3+c]-129)+1260*((d-2>=0?o[d-2]:l[d-2+c])-48)+10*((d-1>=0?o[d-1]:l[d-1+c])-129)+(m-48);var y=u(this.gb18030.gbChars,g);f=this.gb18030.uChars[y]+g-this.gb18030.gbChars[y]}else{if(f<=i){s=i-f;continue}if(!(f<=n))throw new Error("iconv-lite internal error: invalid decoding table value "+f+" at "+s+"/"+m);for(var _=this.decodeTableSeq[n-f],v=0;v<_.length-1;v++)f=_[v],a[p++]=255&f,a[p++]=f>>8;f=_[_.length-1]}if(f>=65536){var b=55296|(f-=65536)>>10;a[p++]=255&b,a[p++]=b>>8,f=56320|1023&f}a[p++]=255&f,a[p++]=f>>8,s=0,h=d+1}return this.nodeIdx=s,this.prevBytes=h>=0?Array.prototype.slice.call(o,h):l.slice(h+c).concat(Array.prototype.slice.call(o)),a.slice(0,p).toString("ucs2")},c.prototype.end=function(){for(var e="";this.prevBytes.length>0;){e+=this.defaultCharUnicode;var t=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,t.length>0&&(e+=this.write(t))}return this.prevBytes=[],this.nodeIdx=0,e},dbcsCodec}const require$$0$2=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],require$$1$1=JSON.parse('[["0","\\u0000",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]'),require$$2=JSON.parse('[["0","\\u0000",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]'),require$$3=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],uChars=[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],gbChars=[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3],require$$4={uChars:uChars,gbChars:gbChars},require$$5=JSON.parse('[["0","\\u0000",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]'),require$$6=JSON.parse('[["0","\\u0000",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]'),require$$7=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var dbcsData,hasRequiredDbcsData,hasRequiredEncodings,streams,hasRequiredStreams;function requireDbcsData(){return hasRequiredDbcsData?dbcsData:(hasRequiredDbcsData=1,dbcsData={shiftjis:{type:"_dbcs",table:function(){return require$$0$2},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return require$$1$1},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return require$$2}},gbk:{type:"_dbcs",table:function(){return require$$2.concat(require$$3)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return require$$2.concat(require$$3)},gb18030:function(){return require$$4},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return require$$5}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return require$$6}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return require$$6.concat(require$$7)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"})}function requireEncodings(){return hasRequiredEncodings||(hasRequiredEncodings=1,function(e){for(var t=requireMergeExports(),r=[requireInternal(),requireUtf32(),requireUtf16(),requireUtf7(),requireSbcsCodec(),requireSbcsData(),requireSbcsDataGenerated(),requireDbcsCodec(),requireDbcsData()],n=0;n<r.length;n++){t(e,r[n])}}(encodings)),encodings}function requireStreams(){if(hasRequiredStreams)return streams;hasRequiredStreams=1;var e=requireSafer().Buffer;return streams=function(t){var r=t.Transform;function n(e,t){this.conv=e,(t=t||{}).decodeStrings=!1,r.call(this,t)}function i(e,t){this.conv=e,(t=t||{}).encoding=this.encoding="utf8",r.call(this,t)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype._transform=function(e,t,r){if("string"!=typeof e)return r(new Error("Iconv encoding stream needs strings as its input."));try{var n=this.conv.write(e);n&&n.length&&this.push(n),r()}catch(i){r(i)}},n.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t),e()}catch(r){e(r)}},n.prototype.collect=function(t){var r=[];return this.on("error",t),this.on("data",(function(e){r.push(e)})),this.on("end",(function(){t(null,e.concat(r))})),this},i.prototype=Object.create(r.prototype,{constructor:{value:i}}),i.prototype._transform=function(t,r,n){if(!(e.isBuffer(t)||t instanceof Uint8Array))return n(new Error("Iconv decoding stream needs buffers as its input."));try{var i=this.conv.write(t);i&&i.length&&this.push(i,this.encoding),n()}catch(o){n(o)}},i.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t,this.encoding),e()}catch(r){e(r)}},i.prototype.collect=function(e){var t="";return this.on("error",e),this.on("data",(function(e){t+=e})),this.on("end",(function(){e(null,t)})),this},{IconvLiteEncoderStream:n,IconvLiteDecoderStream:i}}}var events$2={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events$2.exports;hasRequiredEvents=1;var e,t="object"==typeof Reflect?Reflect:null,r=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}events$2.exports=i,events$2.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&f(e,"error",t,r)}(e,i,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,o,l;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),l=o[t]),void 0===l)l=o[t]=r,++e._eventsCount;else if("function"==typeof l?l=o[t]=n?[r,l]:[l,r]:n?l.unshift(r):l.push(r),(i=s(e))>0&&l.length>i&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=l.length,console&&console.warn}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function f(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,u=p(l,c);for(n=0;n<c;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},events$2.exports}var inherits_browser={exports:{}},hasRequiredInherits_browser,streamBrowser,hasRequiredStreamBrowser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,"function"==typeof Object.create?inherits_browser.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),inherits_browser.exports}function requireStreamBrowser(){return hasRequiredStreamBrowser?streamBrowser:(hasRequiredStreamBrowser=1,streamBrowser=requireEvents().EventEmitter)}var util$1={},types$3={},shams$1,hasRequiredShams$1,shams,hasRequiredShams,esObjectAtoms,hasRequiredEsObjectAtoms,esErrors,hasRequiredEsErrors,_eval,hasRequired_eval,range$1,hasRequiredRange,ref,hasRequiredRef,syntax,hasRequiredSyntax,type,hasRequiredType,uri,hasRequiredUri,abs$1,hasRequiredAbs,floor,hasRequiredFloor,max$4,hasRequiredMax,min$3,hasRequiredMin,pow,hasRequiredPow,round$1,hasRequiredRound,_isNaN,hasRequired_isNaN,sign$1,hasRequiredSign,gOPD,hasRequiredGOPD,gopd,hasRequiredGopd,esDefineProperty,hasRequiredEsDefineProperty,hasSymbols,hasRequiredHasSymbols,Reflect_getPrototypeOf,hasRequiredReflect_getPrototypeOf,Object_getPrototypeOf,hasRequiredObject_getPrototypeOf,implementation$4,hasRequiredImplementation$4,functionBind,hasRequiredFunctionBind,functionCall,hasRequiredFunctionCall,functionApply,hasRequiredFunctionApply,reflectApply,hasRequiredReflectApply,actualApply,hasRequiredActualApply,callBindApplyHelpers,hasRequiredCallBindApplyHelpers,get$1,hasRequiredGet,getProto,hasRequiredGetProto,hasown,hasRequiredHasown,getIntrinsic,hasRequiredGetIntrinsic,callBound$1,hasRequiredCallBound$1,isArguments$1,hasRequiredIsArguments$1,isGeneratorFunction,hasRequiredIsGeneratorFunction,isCallable,hasRequiredIsCallable,forEach,hasRequiredForEach,possibleTypedArrayNames,hasRequiredPossibleTypedArrayNames,availableTypedArrays,hasRequiredAvailableTypedArrays;function requireShams$1(){return hasRequiredShams$1?shams$1:(hasRequiredShams$1=1,shams$1=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(var n in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0})}function requireShams(){if(hasRequiredShams)return shams;hasRequiredShams=1;var e=requireShams$1();return shams=function(){return e()&&!!Symbol.toStringTag}}function requireEsObjectAtoms(){return hasRequiredEsObjectAtoms?esObjectAtoms:(hasRequiredEsObjectAtoms=1,esObjectAtoms=Object)}function requireEsErrors(){return hasRequiredEsErrors?esErrors:(hasRequiredEsErrors=1,esErrors=Error)}function require_eval(){return hasRequired_eval?_eval:(hasRequired_eval=1,_eval=EvalError)}function requireRange(){return hasRequiredRange?range$1:(hasRequiredRange=1,range$1=RangeError)}function requireRef(){return hasRequiredRef?ref:(hasRequiredRef=1,ref=ReferenceError)}function requireSyntax(){return hasRequiredSyntax?syntax:(hasRequiredSyntax=1,syntax=SyntaxError)}function requireType(){return hasRequiredType?type:(hasRequiredType=1,type=TypeError)}function requireUri(){return hasRequiredUri?uri:(hasRequiredUri=1,uri=URIError)}function requireAbs(){return hasRequiredAbs?abs$1:(hasRequiredAbs=1,abs$1=Math.abs)}function requireFloor(){return hasRequiredFloor?floor:(hasRequiredFloor=1,floor=Math.floor)}function requireMax(){return hasRequiredMax?max$4:(hasRequiredMax=1,max$4=Math.max)}function requireMin(){return hasRequiredMin?min$3:(hasRequiredMin=1,min$3=Math.min)}function requirePow(){return hasRequiredPow?pow:(hasRequiredPow=1,pow=Math.pow)}function requireRound(){return hasRequiredRound?round$1:(hasRequiredRound=1,round$1=Math.round)}function require_isNaN(){return hasRequired_isNaN?_isNaN:(hasRequired_isNaN=1,_isNaN=Number.isNaN||function(e){return e!=e})}function requireSign(){if(hasRequiredSign)return sign$1;hasRequiredSign=1;var e=require_isNaN();return sign$1=function(t){return e(t)||0===t?t:t<0?-1:1}}function requireGOPD(){return hasRequiredGOPD?gOPD:(hasRequiredGOPD=1,gOPD=Object.getOwnPropertyDescriptor)}function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var e=requireGOPD();if(e)try{e([],"length")}catch(t){e=null}return gopd=e}function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch(t){e=!1}return esDefineProperty=e}function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var e="undefined"!=typeof Symbol&&Symbol,t=requireShams$1();return hasSymbols=function(){return"function"==typeof e&&("function"==typeof Symbol&&("symbol"==typeof e("foo")&&("symbol"==typeof Symbol("bar")&&t())))}}function requireReflect_getPrototypeOf(){return hasRequiredReflect_getPrototypeOf?Reflect_getPrototypeOf:(hasRequiredReflect_getPrototypeOf=1,Reflect_getPrototypeOf="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null)}function requireObject_getPrototypeOf(){return hasRequiredObject_getPrototypeOf?Object_getPrototypeOf:(hasRequiredObject_getPrototypeOf=1,Object_getPrototypeOf=requireEsObjectAtoms().getPrototypeOf||null)}function requireImplementation$4(){if(hasRequiredImplementation$4)return implementation$4;hasRequiredImplementation$4=1;var e=Object.prototype.toString,t=Math.max,r=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var i=0;i<t.length;i+=1)r[i+e.length]=t[i];return r};return implementation$4=function(n){var i=this;if("function"!=typeof i||"[object Function]"!==e.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var o,a=function(e,t){for(var r=[],n=t,i=0;n<e.length;n+=1,i+=1)r[i]=e[n];return r}(arguments,1),s=t(0,i.length-a.length),l=[],c=0;c<s;c++)l[c]="$"+c;if(o=Function("binder","return function ("+function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r}(l,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var e=i.apply(this,r(a,arguments));return Object(e)===e?e:this}return i.apply(n,r(a,arguments))})),i.prototype){var u=function(){};u.prototype=i.prototype,o.prototype=new u,u.prototype=null}return o},implementation$4}function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var e=requireImplementation$4();return functionBind=Function.prototype.bind||e}function requireFunctionCall(){return hasRequiredFunctionCall?functionCall:(hasRequiredFunctionCall=1,functionCall=Function.prototype.call)}function requireFunctionApply(){return hasRequiredFunctionApply?functionApply:(hasRequiredFunctionApply=1,functionApply=Function.prototype.apply)}function requireReflectApply(){return hasRequiredReflectApply?reflectApply:(hasRequiredReflectApply=1,reflectApply="undefined"!=typeof Reflect&&Reflect&&Reflect.apply)}function requireActualApply(){if(hasRequiredActualApply)return actualApply;hasRequiredActualApply=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireFunctionCall(),n=requireReflectApply();return actualApply=n||e.call(r,t)}function requireCallBindApplyHelpers(){if(hasRequiredCallBindApplyHelpers)return callBindApplyHelpers;hasRequiredCallBindApplyHelpers=1;var e=requireFunctionBind(),t=requireType(),r=requireFunctionCall(),n=requireActualApply();return callBindApplyHelpers=function(i){if(i.length<1||"function"!=typeof i[0])throw new t("a function is required");return n(e,r,i)}}function requireGet(){if(hasRequiredGet)return get$1;hasRequiredGet=1;var e,t=requireCallBindApplyHelpers(),r=requireGopd();try{e=[].__proto__===Array.prototype}catch(a){if(!a||"object"!=typeof a||!("code"in a)||"ERR_PROTO_ACCESS"!==a.code)throw a}var n=!!e&&r&&r(Object.prototype,"__proto__"),i=Object,o=i.getPrototypeOf;return get$1=n&&"function"==typeof n.get?t([n.get]):"function"==typeof o&&function(e){return o(null==e?e:i(e))}}function requireGetProto(){if(hasRequiredGetProto)return getProto;hasRequiredGetProto=1;var e=requireReflect_getPrototypeOf(),t=requireObject_getPrototypeOf(),r=requireGet();return getProto=e?function(t){return e(t)}:t?function(e){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("getProto: not an object");return t(e)}:r?function(e){return r(e)}:null}function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=requireFunctionBind();return hasown=r.call(e,t)}function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;var e;hasRequiredGetIntrinsic=1;var t=requireEsObjectAtoms(),r=requireEsErrors(),n=require_eval(),i=requireRange(),o=requireRef(),a=requireSyntax(),s=requireType(),l=requireUri(),c=requireAbs(),u=requireFloor(),h=requireMax(),d=requireMin(),p=requirePow(),f=requireRound(),m=requireSign(),g=Function,y=function(e){try{return g('"use strict"; return ('+e+").constructor;")()}catch(t){}},_=requireGopd(),v=requireEsDefineProperty(),b=function(){throw new s},w=_?function(){try{return b}catch(e){try{return _(arguments,"callee").get}catch(t){return b}}}():b,x=requireHasSymbols()(),S=requireGetProto(),E=requireObject_getPrototypeOf(),T=requireReflect_getPrototypeOf(),A=requireFunctionApply(),C=requireFunctionCall(),I={},k="undefined"!=typeof Uint8Array&&S?S(Uint8Array):e,P={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?e:ArrayBuffer,"%ArrayIteratorPrototype%":x&&S?S([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":I,"%AsyncGenerator%":I,"%AsyncGeneratorFunction%":I,"%AsyncIteratorPrototype%":I,"%Atomics%":"undefined"==typeof Atomics?e:Atomics,"%BigInt%":"undefined"==typeof BigInt?e:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?e:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float16Array%":"undefined"==typeof Float16Array?e:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?e:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?e:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?e:FinalizationRegistry,"%Function%":g,"%GeneratorFunction%":I,"%Int8Array%":"undefined"==typeof Int8Array?e:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?e:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":x&&S?S(S([][Symbol.iterator]())):e,"%JSON%":"object"==typeof JSON?JSON:e,"%Map%":"undefined"==typeof Map?e:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&x&&S?S((new Map)[Symbol.iterator]()):e,"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?e:Promise,"%Proxy%":"undefined"==typeof Proxy?e:Proxy,"%RangeError%":i,"%ReferenceError%":o,"%Reflect%":"undefined"==typeof Reflect?e:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?e:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&x&&S?S((new Set)[Symbol.iterator]()):e,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":x&&S?S(""[Symbol.iterator]()):e,"%Symbol%":x?Symbol:e,"%SyntaxError%":a,"%ThrowTypeError%":w,"%TypedArray%":k,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?e:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?e:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?e:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?e:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?e:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?e:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?e:WeakSet,"%Function.prototype.call%":C,"%Function.prototype.apply%":A,"%Object.defineProperty%":v,"%Object.getPrototypeOf%":E,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":d,"%Math.pow%":p,"%Math.round%":f,"%Math.sign%":m,"%Reflect.getPrototypeOf%":T};if(S)try{null.error}catch(V){var M=S(S(V));P["%Error.prototype%"]=M}var R=function e(t){var r;if("%AsyncFunction%"===t)r=y("async function () {}");else if("%GeneratorFunction%"===t)r=y("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=y("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&S&&(r=S(i.prototype))}return P[t]=r,r},D={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},O=requireFunctionBind(),L=requireHasown(),B=O.call(C,Array.prototype.concat),$=O.call(A,Array.prototype.splice),z=O.call(C,String.prototype.replace),F=O.call(C,String.prototype.slice),q=O.call(C,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,j=/\\(\\)?/g,U=function(e,t){var r,n=e;if(L(D,n)&&(n="%"+(r=D[n])[0]+"%"),L(P,n)){var i=P[n];if(i===I&&(i=R(n)),void 0===i&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new a("intrinsic "+e+" does not exist!")};return getIntrinsic=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');if(null===q(/^%?[^%]*%?$/,e))throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=F(e,0,1),r=F(e,-1);if("%"===t&&"%"!==r)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new a("invalid intrinsic syntax, expected opening `%`");var n=[];return z(e,N,(function(e,t,r,i){n[n.length]=r?z(i,j,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",i=U("%"+n+"%",t),o=i.name,l=i.value,c=!1,u=i.alias;u&&(n=u[0],$(r,B([0,1],u)));for(var h=1,d=!0;h<r.length;h+=1){var p=r[h],f=F(p,0,1),m=F(p,-1);if(('"'===f||"'"===f||"`"===f||'"'===m||"'"===m||"`"===m)&&f!==m)throw new a("property names with quotes must have matching quotes");if("constructor"!==p&&d||(c=!0),L(P,o="%"+(n+="."+p)+"%"))l=P[o];else if(null!=l){if(!(p in l)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(_&&h+1>=r.length){var g=_(l,p);l=(d=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:l[p]}else d=L(l,p),l=l[p];d&&!c&&(P[o]=l)}}return l},getIntrinsic}function requireCallBound$1(){if(hasRequiredCallBound$1)return callBound$1;hasRequiredCallBound$1=1;var e=requireGetIntrinsic(),t=requireCallBindApplyHelpers(),r=t([e("%String.prototype.indexOf%")]);return callBound$1=function(n,i){var o=e(n,!!i);return"function"==typeof o&&r(n,".prototype.")>-1?t([o]):o}}function requireIsArguments$1(){if(hasRequiredIsArguments$1)return isArguments$1;hasRequiredIsArguments$1=1;var e=requireShams()(),t=requireCallBound$1()("Object.prototype.toString"),r=function(r){return!(e&&r&&"object"==typeof r&&Symbol.toStringTag in r)&&"[object Arguments]"===t(r)},n=function(e){return!!r(e)||null!==e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==t(e)&&"callee"in e&&"[object Function]"===t(e.callee)},i=function(){return r(arguments)}();return r.isLegacyArguments=n,isArguments$1=i?r:n}function requireIsGeneratorFunction(){if(hasRequiredIsGeneratorFunction)return isGeneratorFunction;hasRequiredIsGeneratorFunction=1;var e,t=Object.prototype.toString,r=Function.prototype.toString,n=/^\s*(?:function)?\*/,i=requireShams()(),o=Object.getPrototypeOf;return isGeneratorFunction=function(a){if("function"!=typeof a)return!1;if(n.test(r.call(a)))return!0;if(!i)return"[object GeneratorFunction]"===t.call(a);if(!o)return!1;if(void 0===e){var s=function(){if(!i)return!1;try{return Function("return function*() {}")()}catch(e){}}();e=!!s&&o(s)}return o(a)===e}}function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var e,t,r=Function.prototype.toString,n="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof n&&"function"==typeof Object.defineProperty)try{e=Object.defineProperty({},"length",{get:function(){throw t}}),t={},n((function(){throw 42}),null,e)}catch(_2){_2!==t&&(n=null)}else n=null;var i=/^\s*class\b/,o=function(e){try{var t=r.call(e);return i.test(t)}catch(n){return!1}},a=function(e){try{return!o(e)&&(r.call(e),!0)}catch(t){return!1}},s=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,c=!(0 in[,]),u=function(){return!1};if("object"==typeof document){var h=document.all;s.call(h)===s.call(document.all)&&(u=function(e){if((c||!e)&&(void 0===e||"object"==typeof e))try{var t=s.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(r){}return!1})}return isCallable=n?function(r){if(u(r))return!0;if(!r)return!1;if("function"!=typeof r&&"object"!=typeof r)return!1;try{n(r,null,e)}catch(i){if(i!==t)return!1}return!o(r)&&a(r)}:function(e){if(u(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(l)return a(e);if(o(e))return!1;var t=s.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}}function requireForEach(){if(hasRequiredForEach)return forEach;hasRequiredForEach=1;var e=requireIsCallable(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty;return forEach=function(n,i,o){if(!e(i))throw new TypeError("iterator must be a function");var a,s;arguments.length>=3&&(a=o),s=n,"[object Array]"===t.call(s)?function(e,t,n){for(var i=0,o=e.length;i<o;i++)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(n,i,a):"string"==typeof n?function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)}(n,i,a):function(e,t,n){for(var i in e)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))}(n,i,a)},forEach}function requirePossibleTypedArrayNames(){return hasRequiredPossibleTypedArrayNames?possibleTypedArrayNames:(hasRequiredPossibleTypedArrayNames=1,possibleTypedArrayNames=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"])}function requireAvailableTypedArrays(){if(hasRequiredAvailableTypedArrays)return availableTypedArrays;hasRequiredAvailableTypedArrays=1;var e=requirePossibleTypedArrayNames(),t="undefined"==typeof globalThis?commonjsGlobal:globalThis;return availableTypedArrays=function(){for(var r=[],n=0;n<e.length;n++)"function"==typeof t[e[n]]&&(r[r.length]=e[n]);return r}}var callBind={exports:{}},defineDataProperty,hasRequiredDefineDataProperty,hasPropertyDescriptors_1,hasRequiredHasPropertyDescriptors,setFunctionLength,hasRequiredSetFunctionLength,applyBind,hasRequiredApplyBind,hasRequiredCallBind,whichTypedArray,hasRequiredWhichTypedArray,isTypedArray$1,hasRequiredIsTypedArray,hasRequiredTypes,isBufferBrowser,hasRequiredIsBufferBrowser,hasRequiredUtil$1,buffer_list$1,hasRequiredBuffer_list$1,destroy_1$1,hasRequiredDestroy$1;function requireDefineDataProperty(){if(hasRequiredDefineDataProperty)return defineDataProperty;hasRequiredDefineDataProperty=1;var e=requireEsDefineProperty(),t=requireSyntax(),r=requireType(),n=requireGopd();return defineDataProperty=function(i,o,a){if(!i||"object"!=typeof i&&"function"!=typeof i)throw new r("`obj` must be an object or a function`");if("string"!=typeof o&&"symbol"!=typeof o)throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new r("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],h=!!n&&n(i,o);if(e)e(i,o,{configurable:null===c&&h?h.configurable:!c,enumerable:null===s&&h?h.enumerable:!s,value:a,writable:null===l&&h?h.writable:!l});else{if(!u&&(s||l||c))throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");i[o]=a}},defineDataProperty}function requireHasPropertyDescriptors(){if(hasRequiredHasPropertyDescriptors)return hasPropertyDescriptors_1;hasRequiredHasPropertyDescriptors=1;var e=requireEsDefineProperty(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return 1!==e([],"length",{value:1}).length}catch(t){return!0}},hasPropertyDescriptors_1=t}function requireSetFunctionLength(){if(hasRequiredSetFunctionLength)return setFunctionLength;hasRequiredSetFunctionLength=1;var e=requireGetIntrinsic(),t=requireDefineDataProperty(),r=requireHasPropertyDescriptors()(),n=requireGopd(),i=requireType(),o=e("%Math.floor%");return setFunctionLength=function(e,a){if("function"!=typeof e)throw new i("`fn` is not a function");if("number"!=typeof a||a<0||a>4294967295||o(a)!==a)throw new i("`length` must be a positive 32-bit integer");var s=arguments.length>2&&!!arguments[2],l=!0,c=!0;if("length"in e&&n){var u=n(e,"length");u&&!u.configurable&&(l=!1),u&&!u.writable&&(c=!1)}return(l||c||!s)&&(r?t(e,"length",a,!0,!0):t(e,"length",a)),e},setFunctionLength}function requireApplyBind(){if(hasRequiredApplyBind)return applyBind;hasRequiredApplyBind=1;var e=requireFunctionBind(),t=requireFunctionApply(),r=requireActualApply();return applyBind=function(){return r(e,t,arguments)},applyBind}function requireCallBind(){return hasRequiredCallBind||(hasRequiredCallBind=1,e=callBind,t=requireSetFunctionLength(),r=requireEsDefineProperty(),n=requireCallBindApplyHelpers(),i=requireApplyBind(),e.exports=function(e){var r=n(arguments),i=e.length-(arguments.length-1);return t(r,1+(i>0?i:0),!0)},r?r(e.exports,"apply",{value:i}):e.exports.apply=i),callBind.exports;var e,t,r,n,i}function requireWhichTypedArray(){if(hasRequiredWhichTypedArray)return whichTypedArray;hasRequiredWhichTypedArray=1;var e=requireForEach(),t=requireAvailableTypedArrays(),r=requireCallBind(),n=requireCallBound$1(),i=requireGopd(),o=requireGetProto(),a=n("Object.prototype.toString"),s=requireShams()(),l="undefined"==typeof globalThis?commonjsGlobal:globalThis,c=t(),u=n("String.prototype.slice"),h=n("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},d={__proto__:null};e(c,s&&i&&o?function(e){var t=new l[e];if(Symbol.toStringTag in t&&o){var n=o(t),a=i(n,Symbol.toStringTag);if(!a&&n){var s=o(n);a=i(s,Symbol.toStringTag)}d["$"+e]=r(a.get)}}:function(e){var t=new l[e],n=t.slice||t.set;n&&(d["$"+e]=r(n))});return whichTypedArray=function(t){if(!t||"object"!=typeof t)return!1;if(!s){var r=u(a(t),8,-1);return h(c,r)>-1?r:"Object"===r&&function(t){var r=!1;return e(d,(function(e,n){if(!r)try{e(t),r=u(n,1)}catch(i){}})),r}(t)}return i?function(t){var r=!1;return e(d,(function(e,n){if(!r)try{"$"+e(t)===n&&(r=u(n,1))}catch(i){}})),r}(t):null}}function requireIsTypedArray(){if(hasRequiredIsTypedArray)return isTypedArray$1;hasRequiredIsTypedArray=1;var e=requireWhichTypedArray();return isTypedArray$1=function(t){return!!e(t)}}function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,function(e){var t=requireIsArguments$1(),r=requireIsGeneratorFunction(),n=requireWhichTypedArray(),i=requireIsTypedArray();function o(e){return e.call.bind(e)}var a="undefined"!=typeof BigInt,s="undefined"!=typeof Symbol,l=o(Object.prototype.toString),c=o(Number.prototype.valueOf),u=o(String.prototype.valueOf),h=o(Boolean.prototype.valueOf);if(a)var d=o(BigInt.prototype.valueOf);if(s)var p=o(Symbol.prototype.valueOf);function f(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(r){return!1}}function m(e){return"[object Map]"===l(e)}function g(e){return"[object Set]"===l(e)}function y(e){return"[object WeakMap]"===l(e)}function _(e){return"[object WeakSet]"===l(e)}function v(e){return"[object ArrayBuffer]"===l(e)}function b(e){return"undefined"!=typeof ArrayBuffer&&(v.working?v(e):e instanceof ArrayBuffer)}function w(e){return"[object DataView]"===l(e)}function x(e){return"undefined"!=typeof DataView&&(w.working?w(e):e instanceof DataView)}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=i,e.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},e.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):i(e)||x(e)},e.isUint8Array=function(e){return"Uint8Array"===n(e)},e.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===n(e)},e.isUint16Array=function(e){return"Uint16Array"===n(e)},e.isUint32Array=function(e){return"Uint32Array"===n(e)},e.isInt8Array=function(e){return"Int8Array"===n(e)},e.isInt16Array=function(e){return"Int16Array"===n(e)},e.isInt32Array=function(e){return"Int32Array"===n(e)},e.isFloat32Array=function(e){return"Float32Array"===n(e)},e.isFloat64Array=function(e){return"Float64Array"===n(e)},e.isBigInt64Array=function(e){return"BigInt64Array"===n(e)},e.isBigUint64Array=function(e){return"BigUint64Array"===n(e)},m.working="undefined"!=typeof Map&&m(new Map),e.isMap=function(e){return"undefined"!=typeof Map&&(m.working?m(e):e instanceof Map)},g.working="undefined"!=typeof Set&&g(new Set),e.isSet=function(e){return"undefined"!=typeof Set&&(g.working?g(e):e instanceof Set)},y.working="undefined"!=typeof WeakMap&&y(new WeakMap),e.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(y.working?y(e):e instanceof WeakMap)},_.working="undefined"!=typeof WeakSet&&_(new WeakSet),e.isWeakSet=function(e){return _(e)},v.working="undefined"!=typeof ArrayBuffer&&v(new ArrayBuffer),e.isArrayBuffer=b,w.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&w(new DataView(new ArrayBuffer(1),0,1)),e.isDataView=x;var S="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function E(e){return"[object SharedArrayBuffer]"===l(e)}function T(e){return void 0!==S&&(void 0===E.working&&(E.working=E(new S)),E.working?E(e):e instanceof S)}function A(e){return f(e,c)}function C(e){return f(e,u)}function I(e){return f(e,h)}function k(e){return a&&f(e,d)}function P(e){return s&&f(e,p)}e.isSharedArrayBuffer=T,e.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},e.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},e.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},e.isGeneratorObject=function(e){return"[object Generator]"===l(e)},e.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},e.isNumberObject=A,e.isStringObject=C,e.isBooleanObject=I,e.isBigIntObject=k,e.isSymbolObject=P,e.isBoxedPrimitive=function(e){return A(e)||C(e)||I(e)||k(e)||P(e)},e.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(b(e)||T(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(t){Object.defineProperty(e,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})}))}(types$3)),types$3}function requireIsBufferBrowser(){return hasRequiredIsBufferBrowser?isBufferBrowser:(hasRequiredIsBufferBrowser=1,isBufferBrowser=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8})}function requireUtil$1(){return hasRequiredUtil$1||(hasRequiredUtil$1=1,function(e){var t={},r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},n=/%[sdj%]/g;e.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var i=arguments,o=i.length,a=String(e).replace(n,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(_2){return"[Circular]"}default:return e}})),l=i[r];r<o;l=i[++r])m(l)||!b(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(t,r){if(void 0!==process$1&&!0===process$1.noDeprecation)return t;if(void 0===process$1)return function(){return e.deprecate(t,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process$1.throwDeprecation)throw new Error(r);process$1.traceDeprecation,n=!0}return t.apply(this,arguments)}};var i={},o=/^$/;if(t.NODE_DEBUG){var a=t.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+a+"$","i")}function s(t,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&e._extend(n,r),_(n.showHidden)&&(n.showHidden=!1),_(n.depth)&&(n.depth=2),_(n.colors)&&(n.colors=!1),_(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),u(n,t,n.depth)}function l(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function c(e,t){return e}function u(t,r,n){if(t.customInspect&&r&&S(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return y(i)||(i=u(t,i,n)),i}var o=function(e,t){if(_(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(t,r);if(o)return o;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),x(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(r);if(0===a.length){if(S(r)){var l=r.name?": "+r.name:"";return t.stylize("[Function"+l+"]","special")}if(v(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return t.stylize(Date.prototype.toString.call(r),"date");if(x(r))return h(r)}var c,b="",E=!1,A=["{","}"];(p(r)&&(E=!0,A=["[","]"]),S(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return v(r)&&(b=" "+RegExp.prototype.toString.call(r)),w(r)&&(b=" "+Date.prototype.toUTCString.call(r)),x(r)&&(b=" "+h(r)),0!==a.length||E&&0!=r.length?n<0?v(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),c=E?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)T(t,String(a))?o.push(d(e,t,r,n,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,r,n,i,!0))})),o}(t,r,n,s,a):a.map((function(e){return d(t,r,n,s,e,E)})),t.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,b,A)):A[0]+b+A[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),T(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(l.value)<0?(s=m(r)?u(e,l.value,null):u(e,l.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),_(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function _(e){return void 0===e}function v(e){return b(e)&&"[object RegExp]"===E(e)}function b(e){return"object"==typeof e&&null!==e}function w(e){return b(e)&&"[object Date]"===E(e)}function x(e){return b(e)&&("[object Error]"===E(e)||e instanceof Error)}function S(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}e.debuglog=function(t){if(t=t.toUpperCase(),!i[t])if(o.test(t)){process$1.pid;i[t]=function(){e.format.apply(e,arguments)}}else i[t]=function(){};return i[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.types=requireTypes(),e.isArray=p,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(e){return null==e},e.isNumber=g,e.isString=y,e.isSymbol=function(e){return"symbol"==typeof e},e.isUndefined=_,e.isRegExp=v,e.types.isRegExp=v,e.isObject=b,e.isDate=w,e.types.isDate=w,e.isError=x,e.types.isNativeError=x,e.isFunction=S,e.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},e.isBuffer=requireIsBufferBrowser();function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.log=function(){},e.inherits=requireInherits_browser(),e._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function C(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}e.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(a){r(a)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},e.promisify.custom=A,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){process$1.nextTick(o.bind(null,null,e))}),(function(e){process$1.nextTick(C.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}}(util$1)),util$1}function requireBuffer_list$1(){if(hasRequiredBuffer_list$1)return buffer_list$1;function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t,r){return t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}hasRequiredBuffer_list$1=1;var o=requireDist$1().Buffer,a=requireUtil$1().inspect,s=a&&a.custom||"inspect";return buffer_list$1=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return n(e,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0===(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:s,value:function(e,r){return a(this,t(t({},r),{},{depth:0,customInspect:!1}))}}]),e}()}function requireDestroy$1(){if(hasRequiredDestroy$1)return destroy_1$1;function e(e,n){r(e,n),t(e)}function t(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}return hasRequiredDestroy$1=1,destroy_1$1={destroy:function(n,i){var o=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?(i?i(n):n&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process$1.nextTick(r,this,n)):process$1.nextTick(r,this,n)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(n||null,(function(r){!i&&r?o._writableState?o._writableState.errorEmitted?process$1.nextTick(t,o):(o._writableState.errorEmitted=!0,process$1.nextTick(e,o,r)):process$1.nextTick(e,o,r):i?(process$1.nextTick(t,o),i(r)):process$1.nextTick(t,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}var errorsBrowser={},hasRequiredErrorsBrowser,state$1,hasRequiredState$1,browser$3,hasRequiredBrowser$3,_stream_writable,hasRequired_stream_writable,_stream_duplex,hasRequired_stream_duplex,endOfStream$1,hasRequiredEndOfStream$1,async_iterator,hasRequiredAsync_iterator,fromBrowser,hasRequiredFromBrowser,_stream_readable,hasRequired_stream_readable,_stream_transform,hasRequired_stream_transform,_stream_passthrough,hasRequired_stream_passthrough,pipeline_1$1,hasRequiredPipeline$1,streamBrowserify,hasRequiredStreamBrowserify,hasRequiredLib$3;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;var e={};function t(t,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=t,e[t]=i}function r(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}return t("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),t("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,a;if("string"==typeof t&&(o="not ",t.substr(0,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var s=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(s," ").concat(i," ").concat(r(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=e,errorsBrowser}function requireState$1(){if(hasRequiredState$1)return state$1;hasRequiredState$1=1;var e=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;return state$1={getHighWaterMark:function(t,r,n,i){var o=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(r,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new e(i?n:"highWaterMark",o);return Math.floor(o)}return t.objectMode?16:16384}}}function requireBrowser$3(){if(hasRequiredBrowser$3)return browser$3;function e(e){try{if(!commonjsGlobal.localStorage)return!1}catch(_2){return!1}var t=commonjsGlobal.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}return hasRequiredBrowser$3=1,browser$3=function(t,r){if(e("noDeprecation"))return t;var n=!1;return function(){if(!n){if(e("throwDeprecation"))throw new Error(r);e("traceDeprecation"),n=!0}return t.apply(this,arguments)}},browser$3}function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;function e(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var t;hasRequired_stream_writable=1,_stream_writable=w,w.WritableState=b;var r={deprecate:requireBrowser$3()},n=requireStreamBrowser(),i=requireDist$1().Buffer,o=(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var a,s=requireDestroy$1(),l=requireState$1().getHighWaterMark,c=requireErrorsBrowser().codes,u=c.ERR_INVALID_ARG_TYPE,h=c.ERR_METHOD_NOT_IMPLEMENTED,d=c.ERR_MULTIPLE_CALLBACK,p=c.ERR_STREAM_CANNOT_PIPE,f=c.ERR_STREAM_DESTROYED,m=c.ERR_STREAM_NULL_VALUES,g=c.ERR_STREAM_WRITE_AFTER_END,y=c.ERR_UNKNOWN_ENCODING,_=s.errorOrDestroy;function v(){}function b(r,n,i){t=t||require_stream_duplex(),r=r||{},"boolean"!=typeof i&&(i=n instanceof t),this.objectMode=!!r.objectMode,i&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=l(this,r,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===r.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if("function"!=typeof i)throw new d;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(process$1.nextTick(i,n),process$1.nextTick(C,e,t),e._writableState.errorEmitted=!0,_(e,n)):(i(n),e._writableState.errorEmitted=!0,_(e,n),C(e,t))}(e,r,n,t,i);else{var o=T(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||E(e,r),n?process$1.nextTick(S,e,r,o,i):S(e,r,o,i)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==r.emitClose,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}function w(e){var r=this instanceof(t=t||require_stream_duplex());if(!r&&!a.call(w,this))return new w(e);this._writableState=new b(e,this,r),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),n.call(this)}function x(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new f("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function S(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),C(e,t)}function E(t,r){r.bufferProcessing=!0;var n=r.bufferedRequest;if(t._writev&&n&&n.next){var i=r.bufferedRequestCount,o=new Array(i),a=r.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,x(t,r,!0,r.length,o,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new e(r),r.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(x(t,r,!1,r.objectMode?1:c.length,c,u,h),n=n.next,r.bufferedRequestCount--,r.writing)break}null===n&&(r.lastBufferedRequest=null)}r.bufferedRequest=n,r.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function A(e,t){e._final((function(r){t.pendingcb--,r&&_(e,r),t.prefinished=!0,e.emit("prefinish"),C(e,t)}))}function C(e,t){var r=T(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process$1.nextTick(A,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}return requireInherits_browser()(w,n),b.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(b.prototype,"buffer",{get:r.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_2){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(e){return!!a.call(this,e)||this===w&&(e&&e._writableState instanceof b)}})):a=function(e){return e instanceof this},w.prototype.pipe=function(){_(this,new p)},w.prototype.write=function(e,t,r){var n,a=this._writableState,s=!1,l=!a.objectMode&&(n=e,i.isBuffer(n)||n instanceof o);return l&&!i.isBuffer(e)&&(e=function(e){return i.from(e)}(e)),"function"==typeof t&&(r=t,t=null),l?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof r&&(r=v),a.ending?function(e,t){var r=new g;_(e,r),process$1.nextTick(t,r)}(this,r):(l||function(e,t,r,n){var i;return null===r?i=new m:"string"==typeof r||t.objectMode||(i=new u("chunk",["string","Buffer"],r)),!i||(_(e,i),process$1.nextTick(n,i),!1)}(this,a,e,r))&&(a.pendingcb++,s=function(e,t,r,n,o,a){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=i.from(t,r));return t}(t,n,o);n!==s&&(r=!0,o="buffer",n=s)}var l=t.objectMode?1:n.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:o,isBuf:r,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else x(e,t,!1,l,n,o,a);return c}(this,a,l,e,t,r)),s},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||E(this,e))},w.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(e,t,r){r(new h("_write()"))},w.prototype._writev=null,w.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,C(e,t),r&&(t.finished?process$1.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),w.prototype.destroy=s.destroy,w.prototype._undestroy=s.undestroy,w.prototype._destroy=function(e,t){t(e)},_stream_writable}function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var e=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};_stream_duplex=a;var t=require_stream_readable(),r=require_stream_writable();requireInherits_browser()(a,t);for(var n=e(r.prototype),i=0;i<n.length;i++){var o=n[i];a.prototype[o]||(a.prototype[o]=r.prototype[o])}function a(e){if(!(this instanceof a))return new a(e);t.call(this,e),r.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",s)))}function s(){this._writableState.ended||process$1.nextTick(l,this)}function l(e){e.end()}return Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),_stream_duplex}function requireEndOfStream$1(){if(hasRequiredEndOfStream$1)return endOfStream$1;hasRequiredEndOfStream$1=1;var e=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function t(){}return endOfStream$1=function r(n,i,o){if("function"==typeof i)return r(n,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(o||t);var a=i.readable||!1!==i.readable&&n.readable,s=i.writable||!1!==i.writable&&n.writable,l=function(){n.writable||u()},c=n._writableState&&n._writableState.finished,u=function(){s=!1,c=!0,a||o.call(n)},h=n._readableState&&n._readableState.endEmitted,d=function(){a=!1,h=!0,s||o.call(n)},p=function(e){o.call(n,e)},f=function(){var t;return a&&!h?(n._readableState&&n._readableState.ended||(t=new e),o.call(n,t)):s&&!c?(n._writableState&&n._writableState.ended||(t=new e),o.call(n,t)):void 0},m=function(){n.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(n)?s&&!n._writableState&&(n.on("end",l),n.on("close",l)):(n.on("complete",u),n.on("abort",f),n.req?m():n.on("request",m)),n.on("end",d),n.on("finish",u),!1!==i.error&&n.on("error",p),n.on("close",f),function(){n.removeListener("complete",u),n.removeListener("abort",f),n.removeListener("request",m),n.req&&n.req.removeListener("finish",u),n.removeListener("end",l),n.removeListener("close",l),n.removeListener("finish",u),n.removeListener("end",d),n.removeListener("error",p),n.removeListener("close",f)}},endOfStream$1}function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;var e;function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}hasRequiredAsync_iterator=1;var r=requireEndOfStream$1(),n=Symbol("lastResolve"),i=Symbol("lastReject"),o=Symbol("error"),a=Symbol("ended"),s=Symbol("lastPromise"),l=Symbol("handlePromise"),c=Symbol("stream");function u(e,t){return{value:e,done:t}}function h(e){var t=e[n];if(null!==t){var r=e[c].read();null!==r&&(e[s]=null,e[n]=null,e[i]=null,t(u(r,!1)))}}function d(e){process$1.nextTick(h,e)}var p=Object.getPrototypeOf((function(){})),f=Object.setPrototypeOf((t(e={get stream(){return this[c]},next:function(){var e=this,t=this[o];if(null!==t)return Promise.reject(t);if(this[a])return Promise.resolve(u(void 0,!0));if(this[c].destroyed)return new Promise((function(t,r){process$1.nextTick((function(){e[o]?r(e[o]):t(u(void 0,!0))}))}));var r,n=this[s];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[a]?r(u(void 0,!0)):t[l](r,n)}),n)}}(n,this));else{var i=this[c].read();if(null!==i)return Promise.resolve(u(i,!1));r=new Promise(this[l])}return this[s]=r,r}},Symbol.asyncIterator,(function(){return this})),t(e,"return",(function(){var e=this;return new Promise((function(t,r){e[c].destroy(null,(function(e){e?r(e):t(u(void 0,!0))}))}))})),e),p);return async_iterator=function(e){var h,p=Object.create(f,(t(h={},c,{value:e,writable:!0}),t(h,n,{value:null,writable:!0}),t(h,i,{value:null,writable:!0}),t(h,o,{value:null,writable:!0}),t(h,a,{value:e._readableState.endEmitted,writable:!0}),t(h,l,{value:function(e,t){var r=p[c].read();r?(p[s]=null,p[n]=null,p[i]=null,e(u(r,!1))):(p[n]=e,p[i]=t)},writable:!0}),h));return p[s]=null,r(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=p[i];return null!==t&&(p[s]=null,p[n]=null,p[i]=null,t(e)),void(p[o]=e)}var r=p[n];null!==r&&(p[s]=null,p[n]=null,p[i]=null,r(u(void 0,!0))),p[a]=!0})),e.on("readable",d.bind(null,p)),p}}function requireFromBrowser(){return hasRequiredFromBrowser?fromBrowser:(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")})}function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;var e;hasRequired_stream_readable=1,_stream_readable=w,w.ReadableState=b,requireEvents().EventEmitter;var t=function(e,t){return e.listeners(t).length},r=requireStreamBrowser(),n=requireDist$1().Buffer,i=(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var o,a=requireUtil$1();o=a&&a.debuglog?a.debuglog("stream"):function(){};var s,l,c,u=requireBuffer_list$1(),h=requireDestroy$1(),d=requireState$1().getHighWaterMark,p=requireErrorsBrowser().codes,f=p.ERR_INVALID_ARG_TYPE,m=p.ERR_STREAM_PUSH_AFTER_EOF,g=p.ERR_METHOD_NOT_IMPLEMENTED,y=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;requireInherits_browser()(w,r);var _=h.errorOrDestroy,v=["error","close","destroy","pause","resume"];function b(t,r,n){e=e||require_stream_duplex(),t=t||{},"boolean"!=typeof n&&(n=r instanceof e),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=d(this,t,"readableHighWaterMark",n),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(s||(s=requireString_decoder().StringDecoder),this.decoder=new s(t.encoding),this.encoding=t.encoding)}function w(t){if(e=e||require_stream_duplex(),!(this instanceof w))return new w(t);var n=this instanceof e;this._readableState=new b(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),r.call(this)}function x(e,t,r,a,s){o("readableAddChunk",t);var l,c=e._readableState;if(null===t)c.reading=!1,function(e,t){if(o("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?A(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,C(e)))}(e,c);else if(s||(l=function(e,t){var r;o=t,n.isBuffer(o)||o instanceof i||"string"==typeof t||void 0===t||e.objectMode||(r=new f("chunk",["string","Buffer","Uint8Array"],t));var o;return r}(c,t)),l)_(e,l);else if(c.objectMode||t&&t.length>0)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===n.prototype||(t=function(e){return n.from(e)}(t)),a)c.endEmitted?_(e,new y):S(e,c,t,!0);else if(c.ended)_(e,new m);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!r?(t=c.decoder.write(t),c.objectMode||0!==t.length?S(e,c,t,!1):I(e,c)):S(e,c,t,!1)}else a||(c.reading=!1,I(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function S(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&A(e)),I(e,t)}Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),w.prototype.destroy=h.destroy,w.prototype._undestroy=h.undestroy,w.prototype._destroy=function(e,t){t(e)},w.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=n.from(e,t),t=""),r=!0),x(this,e,t,!1,r)},w.prototype.unshift=function(e){return x(this,e,null,!0,!1)},w.prototype.isPaused=function(){return!1===this._readableState.flowing},w.prototype.setEncoding=function(e){s||(s=requireString_decoder().StringDecoder);var t=new s(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var E=1073741824;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function A(e){var t=e._readableState;o("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(o("emitReadable",t.flowing),t.emittedReadable=!0,process$1.nextTick(C,e))}function C(e){var t=e._readableState;o("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function I(e,t){t.readingMore||(t.readingMore=!0,process$1.nextTick(k,e,t))}function k(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(o("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function M(e){o("readable nexttick read 0"),e.read(0)}function R(e,t){o("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(o("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function L(e){var t=e._readableState;o("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process$1.nextTick(B,t,e))}function B(e,t){if(o("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function $(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}return w.prototype.read=function(e){o("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return o("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):A(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&L(this),null;var n,i=t.needReadable;return o("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&o("length less than watermark",i=!0),t.ended||t.reading?o("reading or ended",i=!1):i&&(o("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(r,t))),null===(n=e>0?O(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&L(this)),null!==n&&this.emit("data",n),n},w.prototype._read=function(e){_(this,new g("_read()"))},w.prototype.pipe=function(e,r){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,o("pipe count=%d opts=%j",i.pipesCount,r);var a=(!r||!1!==r.end)&&e!==process$1.stdout&&e!==process$1.stderr?l:m;function s(t,r){o("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,o("cleanup"),e.removeListener("close",p),e.removeListener("finish",f),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",l),n.removeListener("end",m),n.removeListener("data",h),u=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function l(){o("onend"),e.end()}i.endEmitted?process$1.nextTick(a):n.once("end",a),e.on("unpipe",s);var c=function(e){return function(){var r=e._readableState;o("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&t(e,"data")&&(r.flowing=!0,D(e))}}(n);e.on("drain",c);var u=!1;function h(t){o("ondata");var r=e.write(t);o("dest.write",r),!1===r&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==$(i.pipes,e))&&!u&&(o("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function d(r){o("onerror",r),m(),e.removeListener("error",d),0===t(e,"error")&&_(e,r)}function p(){e.removeListener("finish",f),m()}function f(){o("onfinish"),e.removeListener("close",p),m()}function m(){o("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",f),e.emit("pipe",n),i.flowing||(o("pipe resume"),n.resume()),e},w.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=$(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},w.prototype.on=function(e,t){var n=r.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,o("on readable",i.length,i.reading),i.length?A(this):i.reading||process$1.nextTick(M,this))),n},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(e,t){var n=r.prototype.removeListener.call(this,e,t);return"readable"===e&&process$1.nextTick(P,this),n},w.prototype.removeAllListeners=function(e){var t=r.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process$1.nextTick(P,this),t},w.prototype.resume=function(){var e=this._readableState;return e.flowing||(o("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process$1.nextTick(R,e,t))}(this,e)),e.paused=!1,this},w.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},w.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(o("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(o("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){o("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(w.prototype[Symbol.asyncIterator]=function(){return void 0===l&&(l=requireAsync_iterator()),l(this)}),Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(w.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(w.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),w._fromList=O,Object.defineProperty(w.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(w.from=function(e,t){return void 0===c&&(c=requireFromBrowser()),c(w,e,t)}),_stream_readable}function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=s;var e=requireErrorsBrowser().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,n=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=e.ERR_TRANSFORM_WITH_LENGTH_0,o=require_stream_duplex();function a(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(null===i)return this.emit("error",new r);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);o.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function l(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?c(this,null,null):this._flush((function(t,r){c(e,t,r)}))}function c(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new i;if(e._transformState.transforming)throw new n;return e.push(null)}return requireInherits_browser()(s,o),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,o.prototype.push.call(this,e,t)},s.prototype._transform=function(e,r,n){n(new t("_transform()"))},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},s.prototype._destroy=function(e,t){o.prototype._destroy.call(this,e,(function(e){t(e)}))},_stream_transform}function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=t;var e=require_stream_transform();function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return requireInherits_browser()(t,e),t.prototype._transform=function(e,t,r){r(null,e)},_stream_passthrough}function requirePipeline$1(){if(hasRequiredPipeline$1)return pipeline_1$1;var e;hasRequiredPipeline$1=1;var t=requireErrorsBrowser().codes,r=t.ERR_MISSING_ARGS,n=t.ERR_STREAM_DESTROYED;function i(e){if(e)throw e}function o(e){e()}function a(e,t){return e.pipe(t)}return pipeline_1$1=function(){for(var t=arguments.length,s=new Array(t),l=0;l<t;l++)s[l]=arguments[l];var c,u=function(e){return e.length?"function"!=typeof e[e.length-1]?i:e.pop():i}(s);if(Array.isArray(s[0])&&(s=s[0]),s.length<2)throw new r("streams");var h=s.map((function(t,r){var i=r<s.length-1;return function(t,r,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),void 0===e&&(e=requireEndOfStream$1()),e(t,{readable:r,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var s=!1;return function(e){if(!a&&!s)return s=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new n("pipe"))}}(t,i,r>0,(function(e){c||(c=e),e&&h.forEach(o),i||(h.forEach(o),u(c))}))}));return s.reduce(a)},pipeline_1$1}function requireStreamBrowserify(){if(hasRequiredStreamBrowserify)return streamBrowserify;hasRequiredStreamBrowserify=1,streamBrowserify=t;var e=requireEvents().EventEmitter;function t(){e.call(this)}return requireInherits_browser()(t,e),t.Readable=require_stream_readable(),t.Writable=require_stream_writable(),t.Duplex=require_stream_duplex(),t.Transform=require_stream_transform(),t.PassThrough=require_stream_passthrough(),t.finished=requireEndOfStream$1(),t.pipeline=requirePipeline$1(),t.Stream=t,t.prototype.pipe=function(t,r){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||r&&!1===r.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,t.end())}function l(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(u(),0===e.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",c),t.on("error",c),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t},streamBrowserify}function requireLib$3(){return hasRequiredLib$3||(hasRequiredLib$3=1,function(e){var t,r=requireSafer().Buffer,n=requireBomHandling(),i=requireMergeExports();e.exports.encodings=null,e.exports.defaultCharUnicode="",e.exports.defaultCharSingleByte="?",e.exports.encode=function(t,n,i){t=""+(t||"");var o=e.exports.getEncoder(n,i),a=o.write(t),s=o.end();return s&&s.length>0?r.concat([a,s]):a},e.exports.decode=function(t,n,i){"string"==typeof t&&(e.exports.skipDecodeWarning||(e.exports.skipDecodeWarning=!0),t=r.from(""+(t||""),"binary"));var o=e.exports.getDecoder(n,i),a=o.write(t),s=o.end();return s?a+s:a},e.exports.encodingExists=function(t){try{return e.exports.getCodec(t),!0}catch(r){return!1}},e.exports.toEncoding=e.exports.encode,e.exports.fromEncoding=e.exports.decode,e.exports._codecDataCache={__proto__:null},e.exports.getCodec=function(t){if(!e.exports.encodings){var r=requireEncodings();e.exports.encodings={__proto__:null},i(e.exports.encodings,r)}for(var n=e.exports._canonicalizeEncoding(t),o={};;){var a=e.exports._codecDataCache[n];if(a)return a;var s=e.exports.encodings[n];switch(typeof s){case"string":n=s;break;case"object":for(var l in s)o[l]=s[l];o.encodingName||(o.encodingName=n),n=s.type;break;case"function":return o.encodingName||(o.encodingName=n),a=new s(o,e.exports),e.exports._codecDataCache[o.encodingName]=a,a;default:throw new Error("Encoding not recognized: '"+t+"' (searched as: '"+n+"')")}}},e.exports._canonicalizeEncoding=function(e){return(""+e).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},e.exports.getEncoder=function(t,r){var i=e.exports.getCodec(t),o=new i.encoder(r,i);return i.bomAware&&r&&r.addBOM&&(o=new n.PrependBOM(o,r)),o},e.exports.getDecoder=function(t,r){var i=e.exports.getCodec(t),o=new i.decoder(r,i);return!i.bomAware||r&&!1===r.stripBOM||(o=new n.StripBOM(o,r)),o},e.exports.enableStreamingAPI=function(t){if(!e.exports.supportsStreams){var r=requireStreams()(t);e.exports.IconvLiteEncoderStream=r.IconvLiteEncoderStream,e.exports.IconvLiteDecoderStream=r.IconvLiteDecoderStream,e.exports.encodeStream=function(t,r){return new e.exports.IconvLiteEncoderStream(e.exports.getEncoder(t,r),r)},e.exports.decodeStream=function(t,r){return new e.exports.IconvLiteDecoderStream(e.exports.getDecoder(t,r),r)},e.exports.supportsStreams=!0}};try{t=requireStreamBrowserify()}catch(o){}t&&t.Transform?e.exports.enableStreamingAPI(t):e.exports.encodeStream=e.exports.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}}(lib$4)),lib$4.exports}lib$4.exports;var libExports$1=requireLib$3();const iconv=getDefaultExportFromCjs$1(libExports$1),__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(__viteBrowserExternal$1);var objectInspect,hasRequiredObjectInspect,sideChannelList,hasRequiredSideChannelList,sideChannelMap,hasRequiredSideChannelMap,sideChannelWeakmap,hasRequiredSideChannelWeakmap,sideChannel,hasRequiredSideChannel,formats,hasRequiredFormats,utils$2,hasRequiredUtils$2,stringify_1,hasRequiredStringify,parse$4,hasRequiredParse$1,lib$3,hasRequiredLib$2;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var e="function"==typeof Map&&Map.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,r=e&&t&&"function"==typeof t.get?t.get:null,n=e&&Map.prototype.forEach,i="function"==typeof Set&&Set.prototype,o=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=i&&o&&"function"==typeof o.get?o.get:null,s=i&&Set.prototype.forEach,l="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,c="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,u="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,h=Boolean.prototype.valueOf,d=Object.prototype.toString,p=Function.prototype.toString,f=String.prototype.match,m=String.prototype.slice,g=String.prototype.replace,y=String.prototype.toUpperCase,_=String.prototype.toLowerCase,v=RegExp.prototype.test,b=Array.prototype.concat,w=Array.prototype.join,x=Array.prototype.slice,S=Math.floor,E="function"==typeof BigInt?BigInt.prototype.valueOf:null,T=Object.getOwnPropertySymbols,A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,C="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===C||"symbol")?Symbol.toStringTag:null,k=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function M(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||v.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-S(-e):S(e);if(n!==e){var i=String(n),o=m.call(t,i.length+1);return g.call(i,r,"$&_")+"."+g.call(g.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return g.call(t,r,"$&_")}var R=require$$0$1,D=R.custom,O=N(D)?D:null,L={__proto__:null,double:'"',single:"'"},B={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};function $(e,t,r){var n=r.quoteStyle||t,i=L[n];return i+e+i}function z(e){return g.call(String(e),/"/g,"&quot;")}function F(e){return!("[object Array]"!==V(e)||I&&"object"==typeof e&&I in e)}function q(e){return!("[object RegExp]"!==V(e)||I&&"object"==typeof e&&I in e)}function N(e){if(C)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(t){}return!1}objectInspect=function e(t,i,o,d){var y=i||{};if(U(y,"quoteStyle")&&!U(L,y.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(U(y,"maxStringLength")&&("number"==typeof y.maxStringLength?y.maxStringLength<0&&y.maxStringLength!==1/0:null!==y.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var v=!U(y,"customInspect")||y.customInspect;if("boolean"!=typeof v&&"symbol"!==v)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(U(y,"indent")&&null!==y.indent&&"\t"!==y.indent&&!(parseInt(y.indent,10)===y.indent&&y.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(U(y,"numericSeparator")&&"boolean"!=typeof y.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var S=y.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return W(t,y);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var T=String(t);return S?M(t,T):T}if("bigint"==typeof t){var D=String(t)+"n";return S?M(t,D):D}var B=void 0===y.depth?5:y.depth;if(void 0===o&&(o=0),o>=B&&B>0&&"object"==typeof t)return F(t)?"[Array]":"[Object]";var j=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=w.call(Array(e.indent+1)," ")}return{base:r,prev:w.call(Array(t+1),r)}}(y,o);if(void 0===d)d=[];else if(G(d,t)>=0)return"[Circular]";function H(t,r,n){if(r&&(d=x.call(d)).push(r),n){var i={depth:y.depth};return U(y,"quoteStyle")&&(i.quoteStyle=y.quoteStyle),e(t,i,o+1,d)}return e(t,y,o+1,d)}if("function"==typeof t&&!q(t)){var J=function(e){if(e.name)return e.name;var t=f.call(p.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),ee=Q(t,H);return"[Function"+(J?": "+J:" (anonymous)")+"]"+(ee.length>0?" { "+w.call(ee,", ")+" }":"")}if(N(t)){var te=C?g.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):A.call(t);return"object"!=typeof t||C?te:Z(te)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var re="<"+_.call(String(t.nodeName)),ne=t.attributes||[],ie=0;ie<ne.length;ie++)re+=" "+ne[ie].name+"="+$(z(ne[ie].value),"double",y);return re+=">",t.childNodes&&t.childNodes.length&&(re+="..."),re+="</"+_.call(String(t.nodeName))+">"}if(F(t)){if(0===t.length)return"[]";var oe=Q(t,H);return j&&!function(e){for(var t=0;t<e.length;t++)if(G(e[t],"\n")>=0)return!1;return!0}(oe)?"["+K(oe,j)+"]":"[ "+w.call(oe,", ")+" ]"}if(function(e){return!("[object Error]"!==V(e)||I&&"object"==typeof e&&I in e)}(t)){var ae=Q(t,H);return"cause"in Error.prototype||!("cause"in t)||k.call(t,"cause")?0===ae.length?"["+String(t)+"]":"{ ["+String(t)+"] "+w.call(ae,", ")+" }":"{ ["+String(t)+"] "+w.call(b.call("[cause]: "+H(t.cause),ae),", ")+" }"}if("object"==typeof t&&v){if(O&&"function"==typeof t[O]&&R)return R(t,{depth:B-o});if("symbol"!==v&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!r||!e||"object"!=typeof e)return!1;try{r.call(e);try{a.call(e)}catch(re){return!0}return e instanceof Map}catch(t){}return!1}(t)){var se=[];return n&&n.call(t,(function(e,r){se.push(H(r,t,!0)+" => "+H(e,t))})),X("Map",r.call(t),se,j)}if(function(e){if(!a||!e||"object"!=typeof e)return!1;try{a.call(e);try{r.call(e)}catch(t){return!0}return e instanceof Set}catch(n){}return!1}(t)){var le=[];return s&&s.call(t,(function(e){le.push(H(e,t))})),X("Set",a.call(t),le,j)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e,l);try{c.call(e,c)}catch(re){return!0}return e instanceof WeakMap}catch(t){}return!1}(t))return Y("WeakMap");if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e,c);try{l.call(e,l)}catch(re){return!0}return e instanceof WeakSet}catch(t){}return!1}(t))return Y("WeakSet");if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{return u.call(e),!0}catch(t){}return!1}(t))return Y("WeakRef");if(function(e){return!("[object Number]"!==V(e)||I&&"object"==typeof e&&I in e)}(t))return Z(H(Number(t)));if(function(e){if(!e||"object"!=typeof e||!E)return!1;try{return E.call(e),!0}catch(t){}return!1}(t))return Z(H(E.call(t)));if(function(e){return!("[object Boolean]"!==V(e)||I&&"object"==typeof e&&I in e)}(t))return Z(h.call(t));if(function(e){return!("[object String]"!==V(e)||I&&"object"==typeof e&&I in e)}(t))return Z(H(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&t===globalThis||void 0!==commonjsGlobal&&t===commonjsGlobal)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==V(e)||I&&"object"==typeof e&&I in e)}(t)&&!q(t)){var ce=Q(t,H),ue=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,he=t instanceof Object?"":"null prototype",de=!ue&&I&&Object(t)===t&&I in t?m.call(V(t),8,-1):he?"Object":"",pe=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(de||he?"["+w.call(b.call([],de||[],he||[]),": ")+"] ":"");return 0===ce.length?pe+"{}":j?pe+"{"+K(ce,j)+"}":pe+"{ "+w.call(ce,", ")+" }"}return String(t)};var j=Object.prototype.hasOwnProperty||function(e){return e in this};function U(e,t){return j.call(e,t)}function V(e){return d.call(e)}function G(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function W(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return W(m.call(e,0,t.maxStringLength),t)+n}var i=B[t.quoteStyle||"single"];return i.lastIndex=0,$(g.call(g.call(e,i,"\\$1"),/[\x00-\x1f]/g,H),"single",t)}function H(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+y.call(t.toString(16))}function Z(e){return"Object("+e+")"}function Y(e){return e+" { ? }"}function X(e,t,r,n){return e+" ("+t+") {"+(n?K(r,n):w.call(r,", "))+"}"}function K(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+w.call(e,","+r)+"\n"+t.prev}function Q(e,t){var r=F(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=U(e,i)?t(e[i],e):""}var o,a="function"==typeof T?T(e):[];if(C){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var l in e)U(e,l)&&(r&&String(Number(l))===l&&l<e.length||C&&o["$"+l]instanceof Symbol||(v.call(/[^\w$]/,l)?n.push(t(l,e)+": "+t(e[l],e)):n.push(l+": "+t(e[l],e))));if("function"==typeof T)for(var c=0;c<a.length;c++)k.call(e,a[c])&&n.push("["+t(a[c])+"]: "+t(e[a[c]],e));return n}return objectInspect}function requireSideChannelList(){if(hasRequiredSideChannelList)return sideChannelList;hasRequiredSideChannelList=1;var e=requireObjectInspect(),t=requireType(),r=function(e,t,r){for(var n,i=e;null!=(n=i.next);i=n)if(n.key===t)return i.next=n.next,r||(n.next=e.next,e.next=n),n};return sideChannelList=function(){var n,i={assert:function(r){if(!i.has(r))throw new t("Side channel does not contain "+e(r))},delete:function(e){var t=n&&n.next,i=function(e,t){if(e)return r(e,t,!0)}(n,e);return i&&t&&t===i&&(n=void 0),!!i},get:function(e){return function(e,t){if(e){var n=r(e,t);return n&&n.value}}(n,e)},has:function(e){return function(e,t){return!!e&&!!r(e,t)}(n,e)},set:function(e,t){n||(n={next:void 0}),function(e,t,n){var i=r(e,t);i?i.value=n:e.next={key:t,next:e.next,value:n}}(n,e,t)}};return i}}function requireSideChannelMap(){if(hasRequiredSideChannelMap)return sideChannelMap;hasRequiredSideChannelMap=1;var e=requireGetIntrinsic(),t=requireCallBound$1(),r=requireObjectInspect(),n=requireType(),i=e("%Map%",!0),o=t("Map.prototype.get",!0),a=t("Map.prototype.set",!0),s=t("Map.prototype.has",!0),l=t("Map.prototype.delete",!0),c=t("Map.prototype.size",!0);return sideChannelMap=!!i&&function(){var e,t={assert:function(e){if(!t.has(e))throw new n("Side channel does not contain "+r(e))},delete:function(t){if(e){var r=l(e,t);return 0===c(e)&&(e=void 0),r}return!1},get:function(t){if(e)return o(e,t)},has:function(t){return!!e&&s(e,t)},set:function(t,r){e||(e=new i),a(e,t,r)}};return t}}function requireSideChannelWeakmap(){if(hasRequiredSideChannelWeakmap)return sideChannelWeakmap;hasRequiredSideChannelWeakmap=1;var e=requireGetIntrinsic(),t=requireCallBound$1(),r=requireObjectInspect(),n=requireSideChannelMap(),i=requireType(),o=e("%WeakMap%",!0),a=t("WeakMap.prototype.get",!0),s=t("WeakMap.prototype.set",!0),l=t("WeakMap.prototype.has",!0),c=t("WeakMap.prototype.delete",!0);return sideChannelWeakmap=o?function(){var e,t,u={assert:function(e){if(!u.has(e))throw new i("Side channel does not contain "+r(e))},delete:function(r){if(o&&r&&("object"==typeof r||"function"==typeof r)){if(e)return c(e,r)}else if(n&&t)return t.delete(r);return!1},get:function(r){return o&&r&&("object"==typeof r||"function"==typeof r)&&e?a(e,r):t&&t.get(r)},has:function(r){return o&&r&&("object"==typeof r||"function"==typeof r)&&e?l(e,r):!!t&&t.has(r)},set:function(r,i){o&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new o),s(e,r,i)):n&&(t||(t=n()),t.set(r,i))}};return u}:n}function requireSideChannel(){if(hasRequiredSideChannel)return sideChannel;hasRequiredSideChannel=1;var e=requireType(),t=requireObjectInspect(),r=requireSideChannelList(),n=requireSideChannelMap(),i=requireSideChannelWeakmap()||n||r;return sideChannel=function(){var r,n={assert:function(r){if(!n.has(r))throw new e("Side channel does not contain "+t(r))},delete:function(e){return!!r&&r.delete(e)},get:function(e){return r&&r.get(e)},has:function(e){return!!r&&r.has(e)},set:function(e,t){r||(r=i()),r.set(e,t)}};return n}}function requireFormats(){if(hasRequiredFormats)return formats;hasRequiredFormats=1;var e=String.prototype.replace,t=/%20/g,r="RFC3986";return formats={default:r,formatters:{RFC1738:function(r){return e.call(r,t,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:r}}function requireUtils$2(){if(hasRequiredUtils$2)return utils$2;hasRequiredUtils$2=1;var e=requireFormats(),t=Object.prototype.hasOwnProperty,r=Array.isArray,n=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),i=function(e,t){for(var r=t&&t.plainObjects?{__proto__:null}:{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},o=1024;return utils$2={arrayToObject:i,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],i=0;i<t.length;++i)for(var o=t[i],a=o.obj[o.prop],s=Object.keys(a),l=0;l<s.length;++l){var c=s[l],u=a[c];"object"==typeof u&&null!==u&&-1===n.indexOf(u)&&(t.push({obj:a,prop:c}),n.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(r(n)){for(var i=[],o=0;o<n.length;++o)void 0!==n[o]&&i.push(n[o]);t.obj[t.prop]=i}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(i){return n}},encode:function(t,r,i,a,s){if(0===t.length)return t;var l=t;if("symbol"==typeof t?l=Symbol.prototype.toString.call(t):"string"!=typeof t&&(l=String(t)),"iso-8859-1"===i)return escape(l).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var c="",u=0;u<l.length;u+=o){for(var h=l.length>=o?l.slice(u,u+o):l,d=[],p=0;p<h.length;++p){var f=h.charCodeAt(p);45===f||46===f||95===f||126===f||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===e.RFC1738&&(40===f||41===f)?d[d.length]=h.charAt(p):f<128?d[d.length]=n[f]:f<2048?d[d.length]=n[192|f>>6]+n[128|63&f]:f<55296||f>=57344?d[d.length]=n[224|f>>12]+n[128|f>>6&63]+n[128|63&f]:(p+=1,f=65536+((1023&f)<<10|1023&h.charCodeAt(p)),d[d.length]=n[240|f>>18]+n[128|f>>12&63]+n[128|f>>6&63]+n[128|63&f])}c+=d.join("")}return c},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(r(e)){for(var n=[],i=0;i<e.length;i+=1)n.push(t(e[i]));return n}return t(e)},merge:function e(n,o,a){if(!o)return n;if("object"!=typeof o&&"function"!=typeof o){if(r(n))n.push(o);else{if(!n||"object"!=typeof n)return[n,o];(a&&(a.plainObjects||a.allowPrototypes)||!t.call(Object.prototype,o))&&(n[o]=!0)}return n}if(!n||"object"!=typeof n)return[n].concat(o);var s=n;return r(n)&&!r(o)&&(s=i(n,a)),r(n)&&r(o)?(o.forEach((function(r,i){if(t.call(n,i)){var o=n[i];o&&"object"==typeof o&&r&&"object"==typeof r?n[i]=e(o,r,a):n.push(r)}else n[i]=r})),n):Object.keys(o).reduce((function(r,n){var i=o[n];return t.call(r,n)?r[n]=e(r[n],i,a):r[n]=i,r}),s)}}}function requireStringify(){if(hasRequiredStringify)return stringify_1;hasRequiredStringify=1;var e=requireSideChannel(),t=requireUtils$2(),r=requireFormats(),n=Object.prototype.hasOwnProperty,i={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},o=Array.isArray,a=Array.prototype.push,s=function(e,t){a.apply(e,o(t)?t:[t])},l=Date.prototype.toISOString,c=r.default,u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:t.encode,encodeValuesOnly:!1,filter:void 0,format:c,formatter:r.formatters[c],indices:!1,serializeDate:function(e){return l.call(e)},skipNulls:!1,strictNullHandling:!1},h={},d=function r(n,i,a,l,c,d,p,f,m,g,y,_,v,b,w,x,S,E){for(var T,A=n,C=E,I=0,k=!1;void 0!==(C=C.get(h))&&!k;){var P=C.get(n);if(I+=1,void 0!==P){if(P===I)throw new RangeError("Cyclic object value");k=!0}void 0===C.get(h)&&(I=0)}if("function"==typeof g?A=g(i,A):A instanceof Date?A=v(A):"comma"===a&&o(A)&&(A=t.maybeMap(A,(function(e){return e instanceof Date?v(e):e}))),null===A){if(d)return m&&!x?m(i,u.encoder,S,"key",b):i;A=""}if("string"==typeof(T=A)||"number"==typeof T||"boolean"==typeof T||"symbol"==typeof T||"bigint"==typeof T||t.isBuffer(A))return m?[w(x?i:m(i,u.encoder,S,"key",b))+"="+w(m(A,u.encoder,S,"value",b))]:[w(i)+"="+w(String(A))];var M,R=[];if(void 0===A)return R;if("comma"===a&&o(A))x&&m&&(A=t.maybeMap(A,m)),M=[{value:A.length>0?A.join(",")||null:void 0}];else if(o(g))M=g;else{var D=Object.keys(A);M=y?D.sort(y):D}var O=f?String(i).replace(/\./g,"%2E"):String(i),L=l&&o(A)&&1===A.length?O+"[]":O;if(c&&o(A)&&0===A.length)return L+"[]";for(var B=0;B<M.length;++B){var $=M[B],z="object"==typeof $&&$&&void 0!==$.value?$.value:A[$];if(!p||null!==z){var F=_&&f?String($).replace(/\./g,"%2E"):String($),q=o(A)?"function"==typeof a?a(L,F):L:L+(_?"."+F:"["+F+"]");E.set(n,I);var N=e();N.set(h,E),s(R,r(z,q,a,l,c,d,p,f,"comma"===a&&x&&o(A)?null:m,g,y,_,v,b,w,x,S,N))}}return R};return stringify_1=function(t,a){var l,c=t,h=function(e){if(!e)return u;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||u.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var a=r.default;if(void 0!==e.format){if(!n.call(r.formatters,e.format))throw new TypeError("Unknown format option provided.");a=e.format}var s,l=r.formatters[a],c=u.filter;if(("function"==typeof e.filter||o(e.filter))&&(c=e.filter),s=e.arrayFormat in i?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":u.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=void 0===e.allowDots?!0===e.encodeDotInKeys||u.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:u.addQueryPrefix,allowDots:h,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:s,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?u.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:u.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:u.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:u.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:u.encodeValuesOnly,filter:c,format:a,formatter:l,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:u.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:u.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:u.strictNullHandling}}(a);"function"==typeof h.filter?c=(0,h.filter)("",c):o(h.filter)&&(l=h.filter);var p=[];if("object"!=typeof c||null===c)return"";var f=i[h.arrayFormat],m="comma"===f&&h.commaRoundTrip;l||(l=Object.keys(c)),h.sort&&l.sort(h.sort);for(var g=e(),y=0;y<l.length;++y){var _=l[y],v=c[_];h.skipNulls&&null===v||s(p,d(v,_,f,m,h.allowEmptyArrays,h.strictNullHandling,h.skipNulls,h.encodeDotInKeys,h.encode?h.encoder:null,h.filter,h.sort,h.allowDots,h.serializeDate,h.format,h.formatter,h.encodeValuesOnly,h.charset,g))}var b=p.join(h.delimiter),w=!0===h.addQueryPrefix?"?":"";return h.charsetSentinel&&("iso-8859-1"===h.charset?w+="utf8=%26%2310003%3B&":w+="utf8=%E2%9C%93&"),b.length>0?w+b:""}}function requireParse$1(){if(hasRequiredParse$1)return parse$4;hasRequiredParse$1=1;var e=requireUtils$2(),t=Object.prototype.hasOwnProperty,r=Array.isArray,n={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:e.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},i=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},o=function(e,t,r){if(e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1)return e.split(",");if(t.throwOnLimitExceeded&&r>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(1===t.arrayLimit?"":"s")+" allowed in an array.");return e},a=function(r,n,i,a){if(r){var s=i.allowDots?r.replace(/\.([^.[]+)/g,"[$1]"):r,l=/(\[[^[\]]*])/g,c=i.depth>0&&/(\[[^[\]]*])/.exec(s),u=c?s.slice(0,c.index):s,h=[];if(u){if(!i.plainObjects&&t.call(Object.prototype,u)&&!i.allowPrototypes)return;h.push(u)}for(var d=0;i.depth>0&&null!==(c=l.exec(s))&&d<i.depth;){if(d+=1,!i.plainObjects&&t.call(Object.prototype,c[1].slice(1,-1))&&!i.allowPrototypes)return;h.push(c[1])}if(c){if(!0===i.strictDepth)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");h.push("["+s.slice(c.index)+"]")}return function(t,r,n,i){var a=0;if(t.length>0&&"[]"===t[t.length-1]){var s=t.slice(0,-1).join("");a=Array.isArray(r)&&r[s]?r[s].length:0}for(var l=i?r:o(r,n,a),c=t.length-1;c>=0;--c){var u,h=t[c];if("[]"===h&&n.parseArrays)u=n.allowEmptyArrays&&(""===l||n.strictNullHandling&&null===l)?[]:e.combine([],l);else{u=n.plainObjects?{__proto__:null}:{};var d="["===h.charAt(0)&&"]"===h.charAt(h.length-1)?h.slice(1,-1):h,p=n.decodeDotInKeys?d.replace(/%2E/g,"."):d,f=parseInt(p,10);n.parseArrays||""!==p?!isNaN(f)&&h!==p&&String(f)===p&&f>=0&&n.parseArrays&&f<=n.arrayLimit?(u=[])[f]=l:"__proto__"!==p&&(u[p]=l):u={0:l}}l=u}return l}(h,n,i,a)}};return parse$4=function(s,l){var c=function(t){if(!t)return n;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==t.throwOnLimitExceeded&&"boolean"!=typeof t.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var r=void 0===t.charset?n.charset:t.charset,i=void 0===t.duplicates?n.duplicates:t.duplicates;if("combine"!==i&&"first"!==i&&"last"!==i)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||n.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:n.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:n.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:n.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:n.arrayLimit,charset:r,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:n.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:n.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:n.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:n.decoder,delimiter:"string"==typeof t.delimiter||e.isRegExp(t.delimiter)?t.delimiter:n.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:n.depth,duplicates:i,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:n.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:n.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:n.plainObjects,strictDepth:"boolean"==typeof t.strictDepth?!!t.strictDepth:n.strictDepth,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:n.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof t.throwOnLimitExceeded&&t.throwOnLimitExceeded}}(l);if(""===s||null==s)return c.plainObjects?{__proto__:null}:{};for(var u="string"==typeof s?function(a,s){var l={__proto__:null},c=s.ignoreQueryPrefix?a.replace(/^\?/,""):a;c=c.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var u=s.parameterLimit===1/0?void 0:s.parameterLimit,h=c.split(s.delimiter,s.throwOnLimitExceeded?u+1:u);if(s.throwOnLimitExceeded&&h.length>u)throw new RangeError("Parameter limit exceeded. Only "+u+" parameter"+(1===u?"":"s")+" allowed.");var d,p=-1,f=s.charset;if(s.charsetSentinel)for(d=0;d<h.length;++d)0===h[d].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[d]?f="utf-8":"utf8=%26%2310003%3B"===h[d]&&(f="iso-8859-1"),p=d,d=h.length);for(d=0;d<h.length;++d)if(d!==p){var m,g,y=h[d],_=y.indexOf("]="),v=-1===_?y.indexOf("="):_+1;-1===v?(m=s.decoder(y,n.decoder,f,"key"),g=s.strictNullHandling?null:""):(m=s.decoder(y.slice(0,v),n.decoder,f,"key"),g=e.maybeMap(o(y.slice(v+1),s,r(l[m])?l[m].length:0),(function(e){return s.decoder(e,n.decoder,f,"value")}))),g&&s.interpretNumericEntities&&"iso-8859-1"===f&&(g=i(String(g))),y.indexOf("[]=")>-1&&(g=r(g)?[g]:g);var b=t.call(l,m);b&&"combine"===s.duplicates?l[m]=e.combine(l[m],g):b&&"last"!==s.duplicates||(l[m]=g)}return l}(s,c):s,h=c.plainObjects?{__proto__:null}:{},d=Object.keys(u),p=0;p<d.length;++p){var f=d[p],m=a(f,u[f],c,"string"==typeof s);h=e.merge(h,m,c)}return!0===c.allowSparse?h:e.compact(h)}}function requireLib$2(){if(hasRequiredLib$2)return lib$3;hasRequiredLib$2=1;var e=requireStringify(),t=requireParse$1();return lib$3={formats:requireFormats(),parse:t,stringify:e}}var libExports=requireLib$2();const require$$1=getDefaultExportFromCjs$1(libExports),wrapper=e=>e,defineBoot=wrapper,defineRouter=wrapper,defineStore=wrapper;var n$2,e$1,t$1={version:"0.2.0"},r$1=t$1.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function i$2(e,t,r){return e<t?t:e>r?r:e}function s$1(e){return 100*(-1+e)}t$1.configure=function(e){var t,r;for(t in e)void 0!==(r=e[t])&&e.hasOwnProperty(t)&&(r$1[t]=r);return this},t$1.status=null,t$1.set=function(e){var t=t$1.isStarted();e=i$2(e,r$1.minimum,1),t$1.status=1===e?null:e;var r=t$1.render(!t),n=r.querySelector(r$1.barSelector),i=r$1.speed,o=r$1.easing;return o$1((function(t){var a,s,l,c;""===r$1.positionUsing&&(r$1.positionUsing=t$1.getPositioningCSS()),a$1(n,(a=e,s=i,l=o,(c="translate3d"===r$1.positionUsing?{transform:"translate3d("+s$1(a)+"%,0,0)"}:"translate"===r$1.positionUsing?{transform:"translate("+s$1(a)+"%,0)"}:{"margin-left":s$1(a)+"%"}).transition="all "+s+"ms "+l,c)),1===e?(a$1(r,{transition:"none",opacity:1}),setTimeout((function(){a$1(r,{transition:"all "+i+"ms linear",opacity:0}),setTimeout((function(){t$1.remove(),t()}),i)}),i)):setTimeout(t,i)})),this},t$1.isStarted=function(){return"number"==typeof t$1.status},t$1.start=function(){t$1.status||t$1.set(0);var e=function(){setTimeout((function(){t$1.status&&(t$1.trickle(),e())}),r$1.trickleSpeed)};return r$1.trickle&&e(),this},t$1.done=function(e){return e||t$1.status?t$1.inc(.3+.5*Math.random()).set(1):this},t$1.inc=function(e){var t=t$1.status;return t?t>1?void 0:("number"!=typeof e&&(e=t>=0&&t<.2?.1:t>=.2&&t<.5?.04:t>=.5&&t<.8?.02:t>=.8&&t<.99?.005:0),t=i$2(t+e,0,.994),t$1.set(t)):t$1.start()},t$1.trickle=function(){return t$1.inc()},n$2=0,e$1=0,t$1.promise=function(e){return e&&"resolved"!==e.state()?(0===e$1&&t$1.start(),n$2++,e$1++,e.always((function(){0==--e$1?(n$2=0,t$1.done()):t$1.set((n$2-e$1)/n$2)})),this):this},t$1.render=function(e){if(t$1.isRendered())return document.getElementById("nprogress");c$2(document.documentElement,"nprogress-busy");var t=document.createElement("div");t.id="nprogress",t.innerHTML=r$1.template;var r,n=t.querySelector(r$1.barSelector),i=e?"-100":s$1(t$1.status||0),o=document.querySelector(r$1.parent);return a$1(n,{transition:"all 0 linear",transform:"translate3d("+i+"%,0,0)"}),r$1.showSpinner||(r=t.querySelector(r$1.spinnerSelector))&&m$3(r),o!=document.body&&c$2(o,"nprogress-custom-parent"),o.appendChild(t),t},t$1.remove=function(){l$1(document.documentElement,"nprogress-busy"),l$1(document.querySelector(r$1.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&m$3(e)},t$1.isRendered=function(){return!!document.getElementById("nprogress")},t$1.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var o$1=function(){var e=[];function t(){var r=e.shift();r&&r(t)}return function(r){e.push(r),1==e.length&&t()}}(),a$1=function(){var e=["Webkit","O","Moz","ms"],t={};function r(r,n,i){var o;o=(o=n).replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()})),n=t[o]||(t[o]=function(t){var r=document.body.style;if(t in r)return t;for(var n,i=e.length,o=t.charAt(0).toUpperCase()+t.slice(1);i--;)if((n=e[i]+o)in r)return n;return t}(o)),r.style[n]=i}return function(e,t){var n,i,o=arguments;if(2==o.length)for(n in t)void 0!==(i=t[n])&&t.hasOwnProperty(n)&&r(e,n,i);else r(e,o[1],o[2])}}();function u$1(e,t){return("string"==typeof e?e:d$2(e)).indexOf(" "+t+" ")>=0}function c$2(e,t){var r=d$2(e),n=r+t;u$1(r,t)||(e.className=n.substring(1))}function l$1(e,t){var r,n=d$2(e);u$1(e,t)&&(r=n.replace(" "+t+" "," "),e.className=r.substring(1,r.length-1))}function d$2(e){return(" "+(e&&e.className||"")+" ").replace(/\s+/gi," ")}function m$3(e){e&&e.parentNode&&e.parentNode.removeChild(e)}const units=["B","KB","MB","GB","TB","PB"];function humanStorageSize(e,t=1){let r=0;for(;parseInt(e,10)>=1024&&r<units.length-1;)e/=1024,++r;return`${e.toFixed(t)}${units[r]}`}function capitalize$1(e){return e.charAt(0).toUpperCase()+e.slice(1)}function between$1(e,t,r){return r<=t?t:Math.min(r,Math.max(t,e))}function normalizeToInterval(e,t,r){if(r<=t)return t;const n=r-t+1;let i=t+(e-t)%n;return i<t&&(i=n+i),0===i?0:i}function pad(e,t=2,r="0"){if(null==e)return e;const n=""+e;return n.length>=t?n:new Array(t-n.length+1).join(r)+n}const MILLISECONDS_IN_DAY=864e5,MILLISECONDS_IN_HOUR=36e5,MILLISECONDS_IN_MINUTE=6e4,defaultMask="YYYY-MM-DDTHH:mm:ss.SSSZ",token$1=/\[((?:[^\]\\]|\\]|\\)*)\]|do|d{1,4}|Mo|M{1,4}|m{1,2}|wo|w{1,2}|Qo|Do|DDDo|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,reverseToken=/(\[[^\]]*\])|do|d{1,4}|Mo|M{1,4}|m{1,2}|wo|w{1,2}|Qo|Do|DDDo|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,regexStore={};function getRegexData(e,t){const r="("+t.days.join("|")+")",n=e+r;if(void 0!==regexStore[n])return regexStore[n];const i="("+t.daysShort.join("|")+")",o="("+t.months.join("|")+")",a="("+t.monthsShort.join("|")+")",s={};let l=0;const c=e.replace(reverseToken,(e=>{switch(l++,e){case"YY":return s.YY=l,"(-?\\d{1,2})";case"YYYY":return s.YYYY=l,"(-?\\d{1,4})";case"M":return s.M=l,"(\\d{1,2})";case"Mo":return s.M=l++,"(\\d{1,2}(st|nd|rd|th))";case"MM":return s.M=l,"(\\d{2})";case"MMM":return s.MMM=l,a;case"MMMM":return s.MMMM=l,o;case"D":return s.D=l,"(\\d{1,2})";case"Do":return s.D=l++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return s.D=l,"(\\d{2})";case"H":return s.H=l,"(\\d{1,2})";case"HH":return s.H=l,"(\\d{2})";case"h":return s.h=l,"(\\d{1,2})";case"hh":return s.h=l,"(\\d{2})";case"m":return s.m=l,"(\\d{1,2})";case"mm":return s.m=l,"(\\d{2})";case"s":return s.s=l,"(\\d{1,2})";case"ss":return s.s=l,"(\\d{2})";case"S":return s.S=l,"(\\d{1})";case"SS":return s.S=l,"(\\d{2})";case"SSS":return s.S=l,"(\\d{3})";case"A":return s.A=l,"(AM|PM)";case"a":return s.a=l,"(am|pm)";case"aa":return s.aa=l,"(a\\.m\\.|p\\.m\\.)";case"ddd":return i;case"dddd":return r;case"Q":case"d":case"E":return"(\\d{1})";case"do":return l++,"(\\d{1}(st|nd|rd|th))";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"DDDo":return l++,"(\\d{1,3}(st|nd|rd|th))";case"w":return"(\\d{1,2})";case"wo":return l++,"(\\d{1,2}(st|nd|rd|th))";case"ww":return"(\\d{2})";case"Z":return s.Z=l,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return s.ZZ=l,"(Z|[+-]\\d{2}\\d{2})";case"X":return s.X=l,"(-?\\d+)";case"x":return s.x=l,"(-?\\d{4,})";default:return l--,"["===e[0]&&(e=e.substring(1,e.length-1)),e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}})),u={map:s,regex:new RegExp("^"+c)};return regexStore[n]=u,u}function getDateLocale(e,t){return void 0!==e?e:void 0!==t?t.date:defaultLang.date}function formatTimezone(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=n%60;return r+pad(Math.floor(n/60))+t+pad(i)}function applyYearMonthDayChange(e,t,r){let n=e.getFullYear(),i=e.getMonth();const o=e.getDate();return void 0!==t.year&&(n+=r*t.year,delete t.year),void 0!==t.month&&(i+=r*t.month,delete t.month),e.setDate(1),e.setMonth(2),e.setFullYear(n),e.setMonth(i),e.setDate(Math.min(o,daysInMonth(e))),void 0!==t.date&&(e.setDate(e.getDate()+r*t.date),delete t.date),e}function applyYearMonthDay(e,t,r){const n=void 0!==t.year?t.year:e[`get${r}FullYear`](),i=void 0!==t.month?t.month-1:e[`get${r}Month`](),o=new Date(n,i+1,0).getDate(),a=Math.min(o,void 0!==t.date?t.date:e[`get${r}Date`]());return e[`set${r}Date`](1),e[`set${r}Month`](2),e[`set${r}FullYear`](n),e[`set${r}Month`](i),e[`set${r}Date`](a),delete t.year,delete t.month,delete t.date,e}function getChange(e,t,r){const n=normalizeMod(t),i=new Date(e),o=void 0!==n.year||void 0!==n.month||void 0!==n.date?applyYearMonthDayChange(i,n,r):i;for(const a in n){const e=capitalize$1(a);o[`set${e}`](o[`get${e}`]()+r*n[a])}return o}function normalizeMod(e){const t={...e};return void 0!==e.years&&(t.year=e.years,delete t.years),void 0!==e.months&&(t.month=e.months,delete t.months),void 0!==e.days&&(t.date=e.days,delete t.days),void 0!==e.day&&(t.date=e.day,delete t.day),void 0!==e.hour&&(t.hours=e.hour,delete t.hour),void 0!==e.minute&&(t.minutes=e.minute,delete t.minute),void 0!==e.second&&(t.seconds=e.second,delete t.second),void 0!==e.millisecond&&(t.milliseconds=e.millisecond,delete t.millisecond),t}function adjustDate(e,t,r){const n=normalizeMod(t),i=!0===r?"UTC":"",o=new Date(e),a=void 0!==n.year||void 0!==n.month||void 0!==n.date?applyYearMonthDay(o,n,i):o;for(const s in n){a[`set${i}${s.charAt(0).toUpperCase()+s.slice(1)}`](n[s])}return a}function extractDate(e,t,r){const n=__splitDate(e,t,r),i=new Date(n.year,null===n.month?null:n.month-1,null===n.day?1:n.day,n.hour,n.minute,n.second,n.millisecond),o=i.getTimezoneOffset();return null===n.timezoneOffset||n.timezoneOffset===o?i:getChange(i,{minutes:n.timezoneOffset-o},1)}function __splitDate(e,t,r,n,i){const o={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(null==e||""===e||"string"!=typeof e)return o;void 0===t&&(t=defaultMask);const a=getDateLocale(r,Plugin$5.props),s=a.months,l=a.monthsShort,{regex:c,map:u}=getRegexData(t,a),h=e.match(c);if(null===h)return o;let d="";if(void 0!==u.X||void 0!==u.x){const e=parseInt(h[void 0!==u.X?u.X:u.x],10);if(!0===isNaN(e)||e<0)return o;const t=new Date(e*(void 0!==u.X?1e3:1));o.year=t.getFullYear(),o.month=t.getMonth()+1,o.day=t.getDate(),o.hour=t.getHours(),o.minute=t.getMinutes(),o.second=t.getSeconds(),o.millisecond=t.getMilliseconds()}else{if(void 0!==u.YYYY)o.year=parseInt(h[u.YYYY],10);else if(void 0!==u.YY){const e=parseInt(h[u.YY],10);o.year=e<0?e:2e3+e}if(void 0!==u.M){if(o.month=parseInt(h[u.M],10),o.month<1||o.month>12)return o}else void 0!==u.MMM?o.month=l.indexOf(h[u.MMM])+1:void 0!==u.MMMM&&(o.month=s.indexOf(h[u.MMMM])+1);if(void 0!==u.D){if(o.day=parseInt(h[u.D],10),null===o.year||null===o.month||o.day<1)return o;const e=new Date(o.year,o.month,0).getDate();if(o.day>e)return o}void 0!==u.H?o.hour=parseInt(h[u.H],10)%24:void 0!==u.h&&(o.hour=parseInt(h[u.h],10)%12,(u.A&&"PM"===h[u.A]||u.a&&"pm"===h[u.a]||u.aa&&"p.m."===h[u.aa])&&(o.hour+=12),o.hour=o.hour%24),void 0!==u.m&&(o.minute=parseInt(h[u.m],10)%60),void 0!==u.s&&(o.second=parseInt(h[u.s],10)%60),void 0!==u.S&&(o.millisecond=parseInt(h[u.S],10)*10**(3-h[u.S].length)),void 0===u.Z&&void 0===u.ZZ||(d=void 0!==u.Z?h[u.Z].replace(":",""):h[u.ZZ],o.timezoneOffset=("+"===d[0]?-1:1)*(60*d.slice(1,3)+1*d.slice(3,5)))}return o.dateHash=pad(o.year,4)+"/"+pad(o.month)+"/"+pad(o.day),o.timeHash=pad(o.hour)+":"+pad(o.minute)+":"+pad(o.second)+d,o}function isValid$1(e){return"number"==typeof e||!1===isNaN(Date.parse(e))}function buildDate(e,t){return adjustDate(new Date,e,t)}function getDayOfWeek(e){const t=new Date(e).getDay();return 0===t?7:t}function getWeekOfYear(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);const r=new Date(t.getFullYear(),0,4);r.setDate(r.getDate()-(r.getDay()+6)%7+3);const n=t.getTimezoneOffset()-r.getTimezoneOffset();t.setHours(t.getHours()-n);const i=(t-r)/(7*MILLISECONDS_IN_DAY);return 1+Math.floor(i)}function getDayIdentifier(e){return 1e4*e.getFullYear()+100*e.getMonth()+e.getDate()}function getDateIdentifier(e,t){const r=new Date(e);return!0===t?getDayIdentifier(r):r.getTime()}function isBetweenDates(e,t,r,n={}){const i=getDateIdentifier(t,n.onlyDate),o=getDateIdentifier(r,n.onlyDate),a=getDateIdentifier(e,n.onlyDate);return(a>i||!0===n.inclusiveFrom&&a===i)&&(a<o||!0===n.inclusiveTo&&a===o)}function addToDate(e,t){return getChange(e,t,1)}function subtractFromDate(e,t){return getChange(e,t,-1)}function startOfDate(e,t,r){const n=new Date(e),i="set"+(!0===r?"UTC":"");switch(t){case"year":case"years":n[`${i}Month`](0);case"month":case"months":n[`${i}Date`](1);case"day":case"days":case"date":n[`${i}Hours`](0);case"hour":case"hours":n[`${i}Minutes`](0);case"minute":case"minutes":n[`${i}Seconds`](0);case"second":case"seconds":n[`${i}Milliseconds`](0)}return n}function endOfDate(e,t,r){const n=new Date(e),i="set"+(!0===r?"UTC":"");switch(t){case"year":case"years":n[`${i}Month`](11);case"month":case"months":n[`${i}Date`](daysInMonth(n));case"day":case"days":case"date":n[`${i}Hours`](23);case"hour":case"hours":n[`${i}Minutes`](59);case"minute":case"minutes":n[`${i}Seconds`](59);case"second":case"seconds":n[`${i}Milliseconds`](999)}return n}function getMaxDate(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach((e=>{t=Math.max(t,new Date(e))})),t}function getMinDate(e){let t=new Date(e);return Array.prototype.slice.call(arguments,1).forEach((e=>{t=Math.min(t,new Date(e))})),t}function getDiff(e,t,r){return(e.getTime()-e.getTimezoneOffset()*MILLISECONDS_IN_MINUTE-(t.getTime()-t.getTimezoneOffset()*MILLISECONDS_IN_MINUTE))/r}function getDateDiff(e,t,r="days"){const n=new Date(e),i=new Date(t);switch(r){case"years":case"year":return n.getFullYear()-i.getFullYear();case"months":case"month":return 12*(n.getFullYear()-i.getFullYear())+n.getMonth()-i.getMonth();case"days":case"day":case"date":return getDiff(startOfDate(n,"day"),startOfDate(i,"day"),MILLISECONDS_IN_DAY);case"hours":case"hour":return getDiff(startOfDate(n,"hour"),startOfDate(i,"hour"),MILLISECONDS_IN_HOUR);case"minutes":case"minute":return getDiff(startOfDate(n,"minute"),startOfDate(i,"minute"),MILLISECONDS_IN_MINUTE);case"seconds":case"second":return getDiff(startOfDate(n,"second"),startOfDate(i,"second"),1e3)}}function getDayOfYear(e){return getDateDiff(e,startOfDate(e,"year"),"days")+1}function inferDateFormat(e){return!0===isDate(e)?"date":"number"==typeof e?"number":"string"}function getDateBetween(e,t,r){const n=new Date(e);if(t){const e=new Date(t);if(n<e)return e}if(r){const e=new Date(r);if(n>e)return e}return n}function isSameDate(e,t,r){const n=new Date(e),i=new Date(t);if(void 0===r)return n.getTime()===i.getTime();switch(r){case"second":case"seconds":if(n.getSeconds()!==i.getSeconds())return!1;case"minute":case"minutes":if(n.getMinutes()!==i.getMinutes())return!1;case"hour":case"hours":if(n.getHours()!==i.getHours())return!1;case"day":case"days":case"date":if(n.getDate()!==i.getDate())return!1;case"month":case"months":if(n.getMonth()!==i.getMonth())return!1;case"year":case"years":if(n.getFullYear()!==i.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${r}`)}return!0}function daysInMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function getOrdinal(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const formatter={YY(e,t,r){const n=this.YYYY(e,t,r)%100;return n>=0?pad(n):"-"+pad(Math.abs(n))},YYYY:(e,t,r)=>null!=r?r:e.getFullYear(),M:e=>e.getMonth()+1,Mo:e=>getOrdinal(e.getMonth()+1),MM:e=>pad(e.getMonth()+1),MMM:(e,t)=>t.monthsShort[e.getMonth()],MMMM:(e,t)=>t.months[e.getMonth()],Q:e=>Math.ceil((e.getMonth()+1)/3),Qo(e){return getOrdinal(this.Q(e))},D:e=>e.getDate(),Do:e=>getOrdinal(e.getDate()),DD:e=>pad(e.getDate()),DDD:e=>getDayOfYear(e),DDDo:e=>getOrdinal(getDayOfYear(e)),DDDD:e=>pad(getDayOfYear(e),3),d:e=>e.getDay(),do:e=>getOrdinal(e.getDay()),dd:(e,t)=>t.days[e.getDay()].slice(0,2),ddd:(e,t)=>t.daysShort[e.getDay()],dddd:(e,t)=>t.days[e.getDay()],E:e=>e.getDay()||7,w:e=>getWeekOfYear(e),wo:e=>getOrdinal(getWeekOfYear(e)),ww:e=>pad(getWeekOfYear(e)),H:e=>e.getHours(),HH:e=>pad(e.getHours()),h(e){const t=e.getHours();return 0===t?12:t>12?t%12:t},hh(e){return pad(this.h(e))},m:e=>e.getMinutes(),mm:e=>pad(e.getMinutes()),s:e=>e.getSeconds(),ss:e=>pad(e.getSeconds()),S:e=>Math.floor(e.getMilliseconds()/100),SS:e=>pad(Math.floor(e.getMilliseconds()/10)),SSS:e=>pad(e.getMilliseconds(),3),A:e=>e.getHours()<12?"AM":"PM",a:e=>e.getHours()<12?"am":"pm",aa:e=>e.getHours()<12?"a.m.":"p.m.",Z:(e,t,r,n)=>formatTimezone(null==n?e.getTimezoneOffset():n,":"),ZZ:(e,t,r,n)=>formatTimezone(null==n?e.getTimezoneOffset():n),X:e=>Math.floor(e.getTime()/1e3),x:e=>e.getTime()};function formatDate(e,t,r,n,i){if(0!==e&&!e||e===1/0||e===-1/0)return;const o=new Date(e);if(isNaN(o))return;void 0===t&&(t=defaultMask);const a=getDateLocale(r,Plugin$5.props);return t.replace(token$1,((e,t)=>e in formatter?formatter[e](o,a,n,i):void 0===t?e:t.split("\\]").join("]")))}function clone$5(e){return!0===isDate(e)?new Date(e.getTime()):e}const date={isValid:isValid$1,extractDate:extractDate,buildDate:buildDate,getDayOfWeek:getDayOfWeek,getWeekOfYear:getWeekOfYear,isBetweenDates:isBetweenDates,addToDate:addToDate,subtractFromDate:subtractFromDate,adjustDate:adjustDate,startOfDate:startOfDate,endOfDate:endOfDate,getMaxDate:getMaxDate,getMinDate:getMinDate,getDateDiff:getDateDiff,getDayOfYear:getDayOfYear,inferDateFormat:inferDateFormat,getDateBetween:getDateBetween,isSameDate:isSameDate,daysInMonth:daysInMonth,formatDate:formatDate,clone:clone$5},lang$1={isoName:"zh-CN",nativeName:"",label:{clear:"",ok:"",cancel:"",close:"",set:"",select:"",reset:"",remove:"",update:"",create:"",search:"",filter:"",refresh:"",expand:e=>e?`"${e}"`:"",collapse:e=>e?`"${e}"`:""},date:{days:"______".split("_"),daysShort:"______".split("_"),months:"___________".split("_"),monthsShort:"___________".split("_"),headerTitle:e=>new Intl.DateTimeFormat("zh-CN",{weekday:"short",month:"short",day:"numeric"}).format(e),firstDayOfWeek:0,format24h:!1,pluralDay:"",prevMonth:"",nextMonth:"",prevYear:"",nextYear:"",today:"",prevRangeYears:e=>`${e}`,nextRangeYears:e=>`${e}`},table:{noData:"",noResults:"",loading:"...",selectedRecords:e=>""+e+"",recordsPerPage:":",allRows:"",pagination:(e,t,r)=>e+"-"+t+" / "+r,columns:""},pagination:{first:"",prev:"",next:"",last:""},editor:{url:"URL",bold:"",italic:"",strikethrough:"",underline:"",unorderedList:"",orderedList:"",subscript:"",superscript:"",hyperlink:"",toggleFullscreen:"",quote:"",left:"",center:"",right:"",justify:"",print:"",outdent:"",indent:"",removeFormat:"",formatting:"",fontSize:"",align:"",hr:"",undo:"",redo:"",heading1:"",heading2:"",heading3:"",heading4:"",heading5:"",heading6:"",paragraph:"",code:"",size1:"",size2:"",size3:"",size4:"",size5:"",size6:"",size7:"",defaultFont:"",viewSource:""},tree:{noNodes:"",noResults:""}};function useHistory(e,t,r){let n;function i(){void 0!==n&&(History.remove(n),n=void 0)}return onBeforeUnmount((()=>{!0===e.value&&i()})),{removeFromHistory:i,addToHistory(){n={condition:()=>!0===r.value,handler:t},History.add(n)}}}function getParentProxy(e){if(Object(e.$parent)===e.$parent)return e.$parent;let{parent:t}=e.$;for(;Object(t)===t;){if(Object(t.proxy)===t.proxy)return t.proxy;t=t.parent}}function fillNormalizedVNodes(e,t){"symbol"==typeof t.type?!0===Array.isArray(t.children)&&t.children.forEach((t=>{fillNormalizedVNodes(e,t)})):e.add(t)}function getNormalizedVNodes(e){const t=new Set;return e.forEach((e=>{fillNormalizedVNodes(t,e)})),Array.from(t)}function vmHasRouter(e){return void 0!==e.appContext.config.globalProperties.$router}function vmIsDestroyed(e){return!0===e.isUnmounted||!0===e.isDeactivated}function useTimeout(){let e=null;const t=getCurrentInstance();function r(){null!==e&&(clearTimeout(e),e=null)}return onDeactivated(r),onBeforeUnmount(r),{removeTimeout:r,registerTimeout(n,i){r(),!1===vmIsDestroyed(t)&&(e=setTimeout((()=>{e=null,n()}),i))}}}function useTick(){let e;const t=getCurrentInstance();function r(){e=void 0}return onDeactivated(r),onBeforeUnmount(r),{removeTick:r,registerTick(r){e=r,nextTick((()=>{e===r&&(!1===vmIsDestroyed(t)&&e(),e=void 0)}))}}}const useModelToggleProps={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},useModelToggleEmits=["beforeShow","show","beforeHide","hide"];function useModelToggle({showing:e,canShow:t,hideOnRouteChange:r,handleShow:n,handleHide:i,processOnMount:o}){const a=getCurrentInstance(),{props:s,emit:l,proxy:c}=a;let u;function h(e){if(!0===s.disable||!0===e?.qAnchorHandled||void 0!==t&&!0!==t(e))return;const r=void 0!==s["onUpdate:modelValue"];!0===r&&(l("update:modelValue",!0),u=e,nextTick((()=>{u===e&&(u=void 0)}))),null!==s.modelValue&&!1!==r||d(e)}function d(t){!0!==e.value&&(e.value=!0,l("beforeShow",t),void 0!==n?n(t):l("show",t))}function p(e){if(!0===s.disable)return;const t=void 0!==s["onUpdate:modelValue"];!0===t&&(l("update:modelValue",!1),u=e,nextTick((()=>{u===e&&(u=void 0)}))),null!==s.modelValue&&!1!==t||f(e)}function f(t){!1!==e.value&&(e.value=!1,l("beforeHide",t),void 0!==i?i(t):l("hide",t))}function m(t){if(!0===s.disable&&!0===t)void 0!==s["onUpdate:modelValue"]&&l("update:modelValue",!1);else if(!0===t!==e.value){(!0===t?d:f)(u)}}watch$2((()=>s.modelValue),m),void 0!==r&&!0===vmHasRouter(a)&&watch$2((()=>c.$route.fullPath),(()=>{!0===r.value&&!0===e.value&&p()})),!0===o&&onMounted((()=>{m(s.modelValue)}));const g={show:h,hide:p,toggle:function(t){!0===e.value?p(t):h(t)}};return Object.assign(c,g),g}const useTransitionProps={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function useTransition(e,t=()=>{},r=()=>{}){return{transitionProps:computed((()=>{const n=`q-transition--${e.transitionShow||t()}`,i=`q-transition--${e.transitionHide||r()}`;return{appear:!0,enterFromClass:`${n}-enter-from`,enterActiveClass:`${n}-enter-active`,enterToClass:`${n}-enter-to`,leaveFromClass:`${i}-leave-from`,leaveActiveClass:`${i}-leave-active`,leaveToClass:`${i}-leave-to`}})),transitionStyle:computed((()=>`--q-transition-duration: ${e.transitionDuration}ms`))}}let queue=[],waitFlags=[];function clearFlag(e){waitFlags=waitFlags.filter((t=>t!==e))}function addFocusWaitFlag(e){clearFlag(e),waitFlags.push(e)}function removeFocusWaitFlag(e){clearFlag(e),0===waitFlags.length&&0!==queue.length&&(queue[queue.length-1](),queue=[])}function addFocusFn(e){0===waitFlags.length?e():queue.push(e)}function removeFocusFn(e){queue=queue.filter((t=>t!==e))}const nodesList=[],portalTypeList=[];let portalIndex=1,target$1=document.body;function createGlobalNode(e,t){const r=document.createElement("div");if(r.id=void 0!==t?`q-portal--${t}--${portalIndex++}`:e,void 0!==globalConfig.globalNodes){const e=globalConfig.globalNodes.class;void 0!==e&&(r.className=e)}return target$1.appendChild(r),nodesList.push(r),portalTypeList.push(t),r}function removeGlobalNode(e){const t=nodesList.indexOf(e);nodesList.splice(t,1),portalTypeList.splice(t,1),e.remove()}function changeGlobalNodesTarget(e){if(e===target$1)return;if(target$1=e,target$1===document.body||portalTypeList.reduce(((e,t)=>"dialog"===t?e+1:e),0)<2)return void nodesList.forEach((e=>{!1===e.contains(target$1)&&target$1.appendChild(e)}));const t=portalTypeList.lastIndexOf("dialog");for(let r=0;r<nodesList.length;r++){const e=nodesList[r];r!==t&&"dialog"===portalTypeList[r]||!1!==e.contains(target$1)||target$1.appendChild(e)}}const portalProxyList=[];function getPortalProxy(e){return portalProxyList.find((t=>null!==t.contentEl&&t.contentEl.contains(e)))}function closePortalMenus(e,t){do{if("QMenu"===e.$options.name){if(e.hide(t),!0===e.$props.separateClosePopup)return getParentProxy(e)}else if(!0===e.__qPortal){const r=getParentProxy(e);return"QPopupProxy"===r?.$options.name?(e.hide(t),r):e}e=getParentProxy(e)}while(null!=e)}function closePortals(e,t,r){for(;0!==r&&null!=e;){if(!0===e.__qPortal){if(r--,"QMenu"===e.$options.name){e=closePortalMenus(e,t);continue}e.hide(t)}e=getParentProxy(e)}}const QPortal=createComponent({name:"QPortal",setup:(e,{slots:t})=>()=>t.default()});function isOnGlobalDialog(e){for(e=e.parent;null!=e;){if("QGlobalDialog"===e.type.name)return!0;if("QDialog"===e.type.name||"QMenu"===e.type.name)return!1;e=e.parent}return!1}function usePortal(e,t,r,n){const i=ref$1(!1),o=ref$1(!1);let a=null;const s={},l="dialog"===n&&isOnGlobalDialog(e);function c(t){if(o.value=!1,!0!==t)return;removeFocusWaitFlag(s),i.value=!1;const r=portalProxyList.indexOf(e.proxy);-1!==r&&portalProxyList.splice(r,1),null!==a&&(removeGlobalNode(a),a=null)}return onUnmounted((()=>{c(!0)})),e.proxy.__qPortal=!0,injectProp(e.proxy,"contentEl",(()=>t.value)),{showPortal:function(t){if(!0===t)return removeFocusWaitFlag(s),void(o.value=!0);o.value=!1,!1===i.value&&(!1===l&&null===a&&(a=createGlobalNode(!1,n)),i.value=!0,portalProxyList.push(e.proxy),addFocusWaitFlag(s))},hidePortal:c,portalIsActive:i,portalIsAccessible:o,renderPortal:()=>!0===l?r():!0===i.value?[h$2(Teleport,{to:a},h$2(QPortal,r))]:void 0}}function css(e,t){const r=e.style;for(const n in t)r[n]=t[n]}function getElement(e){if(null==e)return;if("string"==typeof e)try{return document.querySelector(e)||void 0}catch(r){return}const t=unref(e);return t?t.$el||t:void 0}function childHasFocus(e,t){if(null==e||!0===e.contains(t))return!0;for(let r=e.nextElementSibling;null!==r;r=r.nextElementSibling)if(r.contains(t))return!0;return!1}const scrollTargetProp=[Element,String],scrollTargets=[null,document,document.body,document.scrollingElement,document.documentElement];function getScrollTarget(e,t){let r=getElement(t);if(void 0===r){if(null==e)return window;r=e.closest(".scroll,.scroll-y,.overflow-auto")}return scrollTargets.includes(r)?window:r}function getVerticalScrollPosition$1(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function getHorizontalScrollPosition$1(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}function animVerticalScrollTo(e,t,r=0){const n=void 0===arguments[3]?performance.now():arguments[3],i=getVerticalScrollPosition$1(e);r<=0?i!==t&&setScroll$1(e,t):requestAnimationFrame((o=>{const a=o-n,s=i+(t-i)/Math.max(a,r)*a;setScroll$1(e,s),s!==t&&animVerticalScrollTo(e,t,r-a,o)}))}function animHorizontalScrollTo(e,t,r=0){const n=void 0===arguments[3]?performance.now():arguments[3],i=getHorizontalScrollPosition$1(e);r<=0?i!==t&&setHorizontalScroll(e,t):requestAnimationFrame((o=>{const a=o-n,s=i+(t-i)/Math.max(a,r)*a;setHorizontalScroll(e,s),s!==t&&animHorizontalScrollTo(e,t,r-a,o)}))}function setScroll$1(e,t){e!==window?e.scrollTop=t:window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t)}function setHorizontalScroll(e,t){e!==window?e.scrollLeft=t:window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)}function setVerticalScrollPosition(e,t,r){r?animVerticalScrollTo(e,t,r):setScroll$1(e,t)}function setHorizontalScrollPosition(e,t,r){r?animHorizontalScrollTo(e,t,r):setHorizontalScroll(e,t)}let size$1;function getScrollbarWidth(){if(void 0!==size$1)return size$1;const e=document.createElement("p"),t=document.createElement("div");css(e,{width:"100%",height:"200px"}),css(t,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),t.appendChild(e),document.body.appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=t.clientWidth),t.remove(),size$1=r-n,size$1}function hasScrollbar$1(e,t=!0){return!(!e||e.nodeType!==Node.ELEMENT_NODE)&&(t?e.scrollHeight>e.clientHeight&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-y"])):e.scrollWidth>e.clientWidth&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-x"])))}let registered$1=0,scrollPositionX$1,scrollPositionY$1,maxScrollTop$1,vpPendingUpdate$1=!1,bodyLeft$1,bodyTop$1,href,closeTimer$1=null;function onWheel$1(e){shouldPreventScroll$1(e)&&stopAndPrevent$1(e)}function shouldPreventScroll$1(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=getEventPath$1(e),r=e.shiftKey&&!e.deltaX,n=!r&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),i=r||n?e.deltaY:e.deltaX;for(let o=0;o<t.length;o++){const e=t[o];if(hasScrollbar$1(e,n))return n?i<0&&0===e.scrollTop||i>0&&e.scrollTop+e.clientHeight===e.scrollHeight:i<0&&0===e.scrollLeft||i>0&&e.scrollLeft+e.clientWidth===e.scrollWidth}return!0}function onAppleScroll$1(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function onAppleResize$1(e){!0!==vpPendingUpdate$1&&(vpPendingUpdate$1=!0,requestAnimationFrame((()=>{vpPendingUpdate$1=!1;const{height:t}=e.target,{clientHeight:r,scrollTop:n}=document.scrollingElement;void 0!==maxScrollTop$1&&t===window.innerHeight||(maxScrollTop$1=r-t,document.scrollingElement.scrollTop=n),n>maxScrollTop$1&&(document.scrollingElement.scrollTop-=Math.ceil((n-maxScrollTop$1)/8))})))}function apply$1(e){const t=document.body,r=void 0!==window.visualViewport;if("add"===e){const{overflowY:e,overflowX:n}=window.getComputedStyle(t);scrollPositionX$1=getHorizontalScrollPosition$1(window),scrollPositionY$1=getVerticalScrollPosition$1(window),bodyLeft$1=t.style.left,bodyTop$1=t.style.top,href=window.location.href,t.style.left=`-${scrollPositionX$1}px`,t.style.top=`-${scrollPositionY$1}px`,"hidden"!==n&&("scroll"===n||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),"hidden"!==e&&("scroll"===e||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,!0===client.is.ios&&(!0===r?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",onAppleResize$1,listenOpts$1.passiveCapture),window.visualViewport.addEventListener("scroll",onAppleResize$1,listenOpts$1.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",onAppleScroll$1,listenOpts$1.passiveCapture))}!0===client.is.desktop&&!0===client.is.mac&&window[`${e}EventListener`]("wheel",onWheel$1,listenOpts$1.notPassive),"remove"===e&&(!0===client.is.ios&&(!0===r?(window.visualViewport.removeEventListener("resize",onAppleResize$1,listenOpts$1.passiveCapture),window.visualViewport.removeEventListener("scroll",onAppleResize$1,listenOpts$1.passiveCapture)):window.removeEventListener("scroll",onAppleScroll$1,listenOpts$1.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=bodyLeft$1,t.style.top=bodyTop$1,window.location.href===href&&window.scrollTo(scrollPositionX$1,scrollPositionY$1),maxScrollTop$1=void 0)}function preventScroll$1(e){let t="add";if(!0===e){if(registered$1++,null!==closeTimer$1)return clearTimeout(closeTimer$1),void(closeTimer$1=null);if(registered$1>1)return}else{if(0===registered$1)return;if(registered$1--,registered$1>0)return;if(t="remove",!0===client.is.ios&&!0===client.is.nativeMobile)return null!==closeTimer$1&&clearTimeout(closeTimer$1),void(closeTimer$1=setTimeout((()=>{apply$1(t),closeTimer$1=null}),100))}apply$1(t)}function usePreventScroll(){let e;return{preventBodyScroll(t){t===e||void 0===e&&!0!==t||(e=t,preventScroll$1(t))}}}function hSlot(e,t){return void 0!==e&&e()||t}function hUniqueSlot(e,t){if(void 0!==e){const t=e();if(null!=t)return t.slice()}return t}function hMergeSlot(e,t){return void 0!==e?t.concat(e()):t}function hMergeSlotSafely(e,t){return void 0===e?t:void 0!==t?t.concat(e()):e()}function hDir(e,t,r,n,i,o){t.key=n+i;const a=h$2(e,t,r);return!0===i?withDirectives(a,o()):a}const handlers$1=[];let escDown;function onKeydown(e){escDown=27===e.keyCode}function onBlur(){!0===escDown&&(escDown=!1)}function onKeyup(e){!0===escDown&&(escDown=!1,!0===isKeyCode(e,27)&&handlers$1[handlers$1.length-1](e))}function update$1(e){window[e]("keydown",onKeydown),window[e]("blur",onBlur),window[e]("keyup",onKeyup),escDown=!1}function addEscapeKey(e){!0===client.is.desktop&&(handlers$1.push(e),1===handlers$1.length&&update$1("addEventListener"))}function removeEscapeKey(e){const t=handlers$1.indexOf(e);-1!==t&&(handlers$1.splice(t,1),0===handlers$1.length&&update$1("removeEventListener"))}const handlers=[];function trigger(e){handlers[handlers.length-1](e)}function addFocusout(e){!0===client.is.desktop&&(handlers.push(e),1===handlers.length&&document.body.addEventListener("focusin",trigger))}function removeFocusout(e){const t=handlers.indexOf(e);-1!==t&&(handlers.splice(t,1),0===handlers.length&&document.body.removeEventListener("focusin",trigger))}let maximizedModals=0;const positionClass$1={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},defaultTransitions={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},QDialog=createComponent({name:"QDialog",inheritAttrs:!1,props:{...useModelToggleProps,...useTransitionProps,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...useModelToggleEmits,"shake","click","escapeKey"],setup(e,{slots:t,emit:r,attrs:n}){const i=getCurrentInstance(),o=ref$1(null),a=ref$1(!1),s=ref$1(!1);let l,c,u=null,h=null;const d=computed((()=>!0!==e.persistent&&!0!==e.noRouteDismiss&&!0!==e.seamless)),{preventBodyScroll:p}=usePreventScroll(),{registerTimeout:f}=useTimeout(),{registerTick:m,removeTick:g}=useTick(),{transitionProps:y,transitionStyle:_}=useTransition(e,(()=>defaultTransitions[e.position][0]),(()=>defaultTransitions[e.position][1])),v=computed((()=>_.value+(void 0!==e.backdropFilter?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:""))),{showPortal:b,hidePortal:w,portalIsAccessible:x,renderPortal:S}=usePortal(i,o,(function(){return h$2("div",{role:"dialog","aria-modal":!0===I.value?"true":"false",...n,class:P.value},[h$2(Transition,{name:"q-transition--fade",appear:!0},(()=>!0===I.value?h$2("div",{class:"q-dialog__backdrop fixed-full",style:v.value,"aria-hidden":"true",tabindex:-1,onClick:$}):null)),h$2(Transition,y.value,(()=>!0===a.value?h$2("div",{ref:o,class:C.value,style:_.value,tabindex:-1,...k.value},hSlot(t.default)):null))])}),"dialog"),{hide:E}=useModelToggle({showing:a,hideOnRouteChange:d,handleShow:function(t){T(),h=!1===e.noRefocus&&null!==document.activeElement?document.activeElement:null,L(e.maximized),b(),s.value=!0,!0!==e.noFocus?(document.activeElement?.blur(),m(M)):g();f((()=>{if(!0===i.proxy.$q.platform.is.ios){if(!0!==e.seamless&&document.activeElement){const{top:e,bottom:t}=document.activeElement.getBoundingClientRect(),{innerHeight:r}=window,n=void 0!==window.visualViewport?window.visualViewport.height:r;e>0&&t>n/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-n,t>=r?1/0:Math.ceil(document.scrollingElement.scrollTop+t-n/2))),document.activeElement.scrollIntoView()}c=!0,o.value.click(),c=!1}b(!0),s.value=!1,r("show",t)}),e.transitionDuration)},handleHide:function(t){g(),A(),O(!0),s.value=!0,w(),null!==h&&(((0===t?.type.indexOf("key")?h.closest('[tabindex]:not([tabindex^="-"])'):void 0)||h).focus(),h=null);f((()=>{w(!0),s.value=!1,r("hide",t)}),e.transitionDuration)},processOnMount:!0}),{addToHistory:T,removeFromHistory:A}=useHistory(a,E,d),C=computed((()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${!0===e.maximized?"maximized":"minimized"} q-dialog__inner--${e.position} ${positionClass$1[e.position]}`+(!0===s.value?" q-dialog__inner--animating":"")+(!0===e.fullWidth?" q-dialog__inner--fullwidth":"")+(!0===e.fullHeight?" q-dialog__inner--fullheight":"")+(!0===e.square?" q-dialog__inner--square":""))),I=computed((()=>!0===a.value&&!0!==e.seamless)),k=computed((()=>!0===e.autoClose?{onClick:B}:{})),P=computed((()=>["q-dialog fullscreen no-pointer-events q-dialog--"+(!0===I.value?"modal":"seamless"),n.class]));function M(e){addFocusFn((()=>{let t=o.value;if(null!==t){if(void 0!==e){const r=t.querySelector(e);if(null!==r)return void r.focus({preventScroll:!0})}!0!==t.contains(document.activeElement)&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))}}))}function R(e){e&&"function"==typeof e.focus?e.focus({preventScroll:!0}):M(),r("shake");const t=o.value;null!==t&&(t.classList.remove("q-animate--scale"),t.classList.add("q-animate--scale"),null!==u&&clearTimeout(u),u=setTimeout((()=>{u=null,null!==o.value&&(t.classList.remove("q-animate--scale"),M())}),170))}function D(){!0!==e.seamless&&(!0===e.persistent||!0===e.noEscDismiss?!0!==e.maximized&&!0!==e.noShake&&R():(r("escapeKey"),E()))}function O(t){null!==u&&(clearTimeout(u),u=null),!0!==t&&!0!==a.value||(L(!1),!0!==e.seamless&&(p(!1),removeFocusout(z),removeEscapeKey(D))),!0!==t&&(h=null)}function L(e){!0===e?!0!==l&&(maximizedModals<1&&document.body.classList.add("q-body--dialog"),maximizedModals++,l=!0):!0===l&&(maximizedModals<2&&document.body.classList.remove("q-body--dialog"),maximizedModals--,l=!1)}function B(e){!0!==c&&(E(e),r("click",e))}function $(t){!0!==e.persistent&&!0!==e.noBackdropDismiss?E(t):!0!==e.noShake&&R()}function z(t){!0!==e.allowFocusOutside&&!0===x.value&&!0!==childHasFocus(o.value,t.target)&&M('[tabindex]:not([tabindex="-1"])')}return watch$2((()=>e.maximized),(e=>{!0===a.value&&L(e)})),watch$2(I,(e=>{p(e),!0===e?(addFocusout(z),addEscapeKey(D)):(removeFocusout(z),removeEscapeKey(D))})),Object.assign(i.proxy,{focus:M,shake:R,__updateRefocusTarget(e){h=e||null}}),onBeforeUnmount(O),S}}),useSizeDefaults={xs:18,sm:24,md:32,lg:38,xl:46},useSizeProps={size:String};function useSize(e,t=useSizeDefaults){return computed((()=>void 0!==e.size?{fontSize:e.size in t?`${t[e.size]}px`:e.size}:null))}const defaultViewBox="0 0 24 24",sameFn=e=>e,ionFn=e=>`ionicons ${e}`,libMap={"mdi-":e=>`mdi ${e}`,"icon-":sameFn,"bt-":e=>`bt ${e}`,"eva-":e=>`eva ${e}`,"ion-md":ionFn,"ion-ios":ionFn,"ion-logo":ionFn,"iconfont ":sameFn,"ti-":e=>`themify-icon ${e}`,"bi-":e=>`bootstrap-icons ${e}`,"i-":sameFn},matMap={o_:"-outlined",r_:"-round",s_:"-sharp"},symMap={sym_o_:"-outlined",sym_r_:"-rounded",sym_s_:"-sharp"},libRE=new RegExp("^("+Object.keys(libMap).join("|")+")"),matRE=new RegExp("^("+Object.keys(matMap).join("|")+")"),symRE=new RegExp("^("+Object.keys(symMap).join("|")+")"),mRE=/^[Mm]\s?[-+]?\.?\d/,imgRE=/^img:/,svgUseRE=/^svguse:/,ionRE=/^ion-/,faRE=/^(fa-(classic|sharp|solid|regular|light|brands|duotone|thin)|[lf]a[srlbdk]?) /,QIcon=createComponent({name:"QIcon",props:{...useSizeProps,tag:{type:String,default:"i"},name:String,color:String,left:Boolean,right:Boolean},setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=useSize(e),i=computed((()=>"q-icon"+(!0===e.left?" on-left":"")+(!0===e.right?" on-right":"")+(void 0!==e.color?` text-${e.color}`:""))),o=computed((()=>{let t,n=e.name;if("none"===n||!n)return{none:!0};if(null!==r.iconMapFn){const e=r.iconMapFn(n);if(void 0!==e){if(void 0===e.icon)return{cls:e.cls,content:void 0!==e.content?e.content:" "};if(n=e.icon,"none"===n||!n)return{none:!0}}}if(!0===mRE.test(n)){const[e,t=defaultViewBox]=n.split("|");return{svg:!0,viewBox:t,nodes:e.split("&&").map((e=>{const[t,r,n]=e.split("@@");return h$2("path",{style:r,d:t,transform:n})}))}}if(!0===imgRE.test(n))return{img:!0,src:n.substring(4)};if(!0===svgUseRE.test(n)){const[e,t=defaultViewBox]=n.split("|");return{svguse:!0,src:e.substring(7),viewBox:t}}let i=" ";const o=n.match(libRE);if(null!==o)t=libMap[o[1]](n);else if(!0===faRE.test(n))t=n;else if(!0===ionRE.test(n))t=`ionicons ion-${!0===r.platform.is.ios?"ios":"md"}${n.substring(3)}`;else if(!0===symRE.test(n)){t="notranslate material-symbols";const e=n.match(symRE);null!==e&&(n=n.substring(6),t+=symMap[e[1]]),i=n}else{t="notranslate material-icons";const e=n.match(matRE);null!==e&&(n=n.substring(2),t+=matMap[e[1]]),i=n}return{cls:t,content:i}}));return()=>{const r={class:i.value,style:n.value,"aria-hidden":"true"};return!0===o.value.none?h$2(e.tag,r,hSlot(t.default)):!0===o.value.img?h$2(e.tag,r,hMergeSlot(t.default,[h$2("img",{src:o.value.src})])):!0===o.value.svg?h$2(e.tag,r,hMergeSlot(t.default,[h$2("svg",{viewBox:o.value.viewBox||"0 0 24 24"},o.value.nodes)])):!0===o.value.svguse?h$2(e.tag,r,hMergeSlot(t.default,[h$2("svg",{viewBox:o.value.viewBox},[h$2("use",{"xlink:href":o.value.src})])])):(void 0!==o.value.cls&&(r.class+=" "+o.value.cls),h$2(e.tag,r,hMergeSlot(t.default,[o.value.content])))}}}),useSpinnerProps={size:{type:[String,Number],default:"1em"},color:String};function useSpinner(e){return{cSize:computed((()=>e.size in useSizeDefaults?`${useSizeDefaults[e.size]}px`:e.size)),classes:computed((()=>"q-spinner"+(e.color?` text-${e.color}`:"")))}}const QSpinner=createComponent({name:"QSpinner",props:{...useSpinnerProps,thickness:{type:Number,default:5}},setup(e){const{cSize:t,classes:r}=useSpinner(e);return()=>h$2("svg",{class:r.value+" q-spinner-mat",width:t.value,height:t.value,viewBox:"25 25 50 50"},[h$2("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"currentColor","stroke-width":e.thickness,"stroke-miterlimit":"10"})])}});function throttle$1(e,t=250){let r,n=!1;return function(){return!1===n&&(n=!0,setTimeout((()=>{n=!1}),t),r=e.apply(this,arguments)),r}}function showRipple(e,t,r,n){!0===r.modifiers.stop&&stop$1(e);const i=r.modifiers.color;let o=r.modifiers.center;o=!0===o||!0===n;const a=document.createElement("span"),s=document.createElement("span"),l=position(e),{left:c,top:u,width:h,height:d}=t.getBoundingClientRect(),p=Math.sqrt(h*h+d*d),f=p/2,m=(h-p)/2+"px",g=o?m:l.left-c-f+"px",y=(d-p)/2+"px",_=o?y:l.top-u-f+"px";s.className="q-ripple__inner",css(s,{height:`${p}px`,width:`${p}px`,transform:`translate3d(${g},${_},0) scale3d(.2,.2,1)`,opacity:0}),a.className="q-ripple"+(i?" text-"+i:""),a.setAttribute("dir","ltr"),a.appendChild(s),t.appendChild(a);const v=()=>{a.remove(),clearTimeout(b)};r.abort.push(v);let b=setTimeout((()=>{s.classList.add("q-ripple__inner--enter"),s.style.transform=`translate3d(${m},${y},0) scale3d(1,1,1)`,s.style.opacity=.2,b=setTimeout((()=>{s.classList.remove("q-ripple__inner--enter"),s.classList.add("q-ripple__inner--leave"),s.style.opacity=0,b=setTimeout((()=>{a.remove(),r.abort.splice(r.abort.indexOf(v),1)}),275)}),250)}),50)}function updateModifiers(e,{modifiers:t,value:r,arg:n}){const i=Object.assign({},e.cfg.ripple,t,r);e.modifiers={early:!0===i.early,stop:!0===i.stop,center:!0===i.center,color:i.color||n,keyCodes:[].concat(i.keyCodes||13)}}const Ripple=createDirective({name:"ripple",beforeMount(e,t){const r=t.instance.$.appContext.config.globalProperties.$q.config||{};if(!1===r.ripple)return;const n={cfg:r,enabled:!1!==t.value,modifiers:{},abort:[],start(t){!0===n.enabled&&!0!==t.qSkipRipple&&t.type===(!0===n.modifiers.early?"pointerdown":"click")&&showRipple(t,e,n,!0===t.qKeyEvent)},keystart:throttle$1((t=>{!0===n.enabled&&!0!==t.qSkipRipple&&!0===isKeyCode(t,n.modifiers.keyCodes)&&t.type==="key"+(!0===n.modifiers.early?"down":"up")&&showRipple(t,e,n,!0)}),300)};updateModifiers(n,t),e.__qripple=n,addEvt(n,"main",[[e,"pointerdown","start","passive"],[e,"click","start","passive"],[e,"keydown","keystart","passive"],[e,"keyup","keystart","passive"]])},updated(e,t){if(t.oldValue!==t.value){const r=e.__qripple;void 0!==r&&(r.enabled=!1!==t.value,!0===r.enabled&&Object(t.value)===t.value&&updateModifiers(r,t))}},beforeUnmount(e){const t=e.__qripple;void 0!==t&&(t.abort.forEach((e=>{e()})),cleanEvt(t,"main"),delete e._qripple)}}),alignMap={left:"start",center:"center",right:"end",between:"between",around:"around",evenly:"evenly",stretch:"stretch"},alignValues$2=Object.keys(alignMap),useAlignProps={align:{type:String,validator:e=>alignValues$2.includes(e)}};function useAlign(e){return computed((()=>{const t=void 0===e.align?!0===e.vertical?"stretch":"left":e.align;return`${!0===e.vertical?"items":"justify"}-${alignMap[t]}`}))}function getOriginalPath(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}function isSameRouteRecord(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function includesParams(e,t){for(const r in t){const n=t[r],i=e[r];if("string"==typeof n){if(n!==i)return!1}else if(!1===Array.isArray(i)||i.length!==n.length||n.some(((e,t)=>e!==i[t])))return!1}return!0}function isEquivalentArray(e,t){return!0===Array.isArray(t)?e.length===t.length&&e.every(((e,r)=>e===t[r])):1===e.length&&e[0]===t}function isSameRouteLocationParamsValue(e,t){return!0===Array.isArray(e)?isEquivalentArray(e,t):!0===Array.isArray(t)?isEquivalentArray(t,e):e===t}function isSameRouteLocationParams(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!1===isSameRouteLocationParamsValue(e[r],t[r]))return!1;return!0}const useRouterLinkNonMatchingProps={to:[String,Object],replace:Boolean,href:String,target:String,disable:Boolean},useRouterLinkProps={...useRouterLinkNonMatchingProps,exact:Boolean,activeClass:{type:String,default:"q-router-link--active"},exactActiveClass:{type:String,default:"q-router-link--exact-active"}};function useRouterLink({fallbackTag:e,useDisableForRouterLinkProps:t=!0}={}){const r=getCurrentInstance(),{props:n,proxy:i,emit:o}=r,a=vmHasRouter(r),s=computed((()=>!0!==n.disable&&void 0!==n.href)),l=computed(!0===t?()=>!0===a&&!0!==n.disable&&!0!==s.value&&void 0!==n.to&&null!==n.to&&""!==n.to:()=>!0===a&&!0!==s.value&&void 0!==n.to&&null!==n.to&&""!==n.to),c=computed((()=>!0===l.value?_(n.to):null)),u=computed((()=>null!==c.value)),h=computed((()=>!0===s.value||!0===u.value)),d=computed((()=>"a"===n.type||!0===h.value?"a":n.tag||e||"div")),p=computed((()=>!0===s.value?{href:n.href,target:n.target}:!0===u.value?{href:c.value.href,target:n.target}:{})),f=computed((()=>{if(!1===u.value)return-1;const{matched:e}=c.value,{length:t}=e,r=e[t-1];if(void 0===r)return-1;const n=i.$route.matched;if(0===n.length)return-1;const o=n.findIndex(isSameRouteRecord.bind(null,r));if(-1!==o)return o;const a=getOriginalPath(e[t-2]);return t>1&&getOriginalPath(r)===a&&n[n.length-1].path!==a?n.findIndex(isSameRouteRecord.bind(null,e[t-2])):o})),m=computed((()=>!0===u.value&&-1!==f.value&&includesParams(i.$route.params,c.value.params))),g=computed((()=>!0===m.value&&f.value===i.$route.matched.length-1&&isSameRouteLocationParams(i.$route.params,c.value.params))),y=computed((()=>!0===u.value?!0===g.value?` ${n.exactActiveClass} ${n.activeClass}`:!0===n.exact?"":!0===m.value?` ${n.activeClass}`:"":""));function _(e){try{return i.$router.resolve(e)}catch(_2){}return null}function v(e,{returnRouterError:t,to:r=n.to,replace:o=n.replace}={}){if(!0===n.disable)return e.preventDefault(),Promise.resolve(!1);if(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||void 0!==e.button&&0!==e.button||"_blank"===n.target)return Promise.resolve(!1);e.preventDefault();const a=i.$router[!0===o?"replace":"push"](r);return!0===t?a:a.then((()=>{})).catch((()=>{}))}return{hasRouterLink:u,hasHrefLink:s,hasLink:h,linkTag:d,resolvedLink:c,linkIsActive:m,linkIsExactActive:g,linkClass:y,linkAttrs:p,getLink:_,navigateToRouterLink:v,navigateOnClick:function(e){if(!0===u.value){const t=t=>v(e,t);o("click",e,t),!0!==e.defaultPrevented&&t()}else o("click",e)}}}const btnPadding={none:0,xs:4,sm:8,md:16,lg:24,xl:32},defaultSizes$2={xs:8,sm:10,md:14,lg:20,xl:24},formTypes=["button","submit","reset"],mediaTypeRE=/[^\s]\/[^\s]/,btnDesignOptions=["flat","outline","push","unelevated"];function getBtnDesign(e,t){return!0===e.flat?"flat":!0===e.outline?"outline":!0===e.push?"push":!0===e.unelevated?"unelevated":t}function getBtnDesignAttr(e){const t=getBtnDesign(e);return void 0!==t?{[t]:!0}:{}}const nonRoundBtnProps={...useSizeProps,...useRouterLinkNonMatchingProps,type:{type:String,default:"button"},label:[Number,String],icon:String,iconRight:String,...btnDesignOptions.reduce(((e,t)=>(e[t]=Boolean)&&e),{}),square:Boolean,rounded:Boolean,glossy:Boolean,size:String,fab:Boolean,fabMini:Boolean,padding:String,color:String,textColor:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,tabindex:[Number,String],ripple:{type:[Boolean,Object],default:!0},align:{...useAlignProps.align,default:"center"},stack:Boolean,stretch:Boolean,loading:{type:Boolean,default:null},disable:Boolean},useBtnProps={...nonRoundBtnProps,round:Boolean};function useBtn(e){const t=useSize(e,defaultSizes$2),r=useAlign(e),{hasRouterLink:n,hasLink:i,linkTag:o,linkAttrs:a,navigateOnClick:s}=useRouterLink({fallbackTag:"button"}),l=computed((()=>{const r=!1===e.fab&&!1===e.fabMini?t.value:{};return void 0!==e.padding?Object.assign({},r,{padding:e.padding.split(/\s+/).map((e=>e in btnPadding?btnPadding[e]+"px":e)).join(" "),minWidth:"0",minHeight:"0"}):r})),c=computed((()=>!0===e.rounded||!0===e.fab||!0===e.fabMini)),u=computed((()=>!0!==e.disable&&!0!==e.loading)),h=computed((()=>!0===u.value?e.tabindex||0:-1)),d=computed((()=>getBtnDesign(e,"standard"))),p=computed((()=>{const t={tabindex:h.value};return!0===i.value?Object.assign(t,a.value):!0===formTypes.includes(e.type)&&(t.type=e.type),"a"===o.value?(!0===e.disable?t["aria-disabled"]="true":void 0===t.href&&(t.role="button"),!0!==n.value&&!0===mediaTypeRE.test(e.type)&&(t.type=e.type)):!0===e.disable&&(t.disabled="",t["aria-disabled"]="true"),!0===e.loading&&void 0!==e.percentage&&Object.assign(t,{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e.percentage}),t}));return{classes:computed((()=>{let t;void 0!==e.color?t=!0===e.flat||!0===e.outline?`text-${e.textColor||e.color}`:`bg-${e.color} text-${e.textColor||"white"}`:e.textColor&&(t=`text-${e.textColor}`);const r=!0===e.round?"round":"rectangle"+(!0===c.value?" q-btn--rounded":!0===e.square?" q-btn--square":"");return`q-btn--${d.value} q-btn--${r}`+(void 0!==t?" "+t:"")+(!0===u.value?" q-btn--actionable q-focusable q-hoverable":!0===e.disable?" disabled":"")+(!0===e.fab?" q-btn--fab":!0===e.fabMini?" q-btn--fab-mini":"")+(!0===e.noCaps?" q-btn--no-uppercase":"")+(!0===e.dense?" q-btn--dense":"")+(!0===e.stretch?" no-border-radius self-stretch":"")+(!0===e.glossy?" glossy":"")+(e.square?" q-btn--square":"")})),style:l,innerClasses:computed((()=>r.value+(!0===e.stack?" column":" row")+(!0===e.noWrap?" no-wrap text-no-wrap":"")+(!0===e.loading?" q-btn__content--hidden":""))),attributes:p,hasLink:i,linkTag:o,navigateOnClick:s,isActionable:u}}const{passiveCapture:passiveCapture}=listenOpts$1;let touchTarget=null,keyboardTarget=null,mouseTarget=null;const QBtn=createComponent({name:"QBtn",props:{...useBtnProps,percentage:Number,darkPercentage:Boolean,onTouchstart:[Function,Array]},emits:["click","keydown","mousedown","keyup"],setup(e,{slots:t,emit:r}){const{proxy:n}=getCurrentInstance(),{classes:i,style:o,innerClasses:a,attributes:s,hasLink:l,linkTag:c,navigateOnClick:u,isActionable:h}=useBtn(e),d=ref$1(null),p=ref$1(null);let f,m=null,g=null;const y=computed((()=>void 0!==e.label&&null!==e.label&&""!==e.label)),_=computed((()=>!0!==e.disable&&!1!==e.ripple&&{keyCodes:!0===l.value?[13,32]:[13],...!0===e.ripple?{}:e.ripple})),v=computed((()=>({center:e.round}))),b=computed((()=>{const t=Math.max(0,Math.min(100,e.percentage));return t>0?{transition:"transform 0.6s",transform:`translateX(${t-100}%)`}:{}})),w=computed((()=>{if(!0===e.loading)return{onMousedown:k,onTouchstart:k,onClick:k,onKeydown:k,onKeyup:k};if(!0===h.value){const t={onClick:S,onKeydown:E,onMousedown:A};if(!0===n.$q.platform.has.touch){t[`onTouchstart${void 0!==e.onTouchstart?"":"Passive"}`]=T}return t}return{onClick:stopAndPrevent$1}})),x=computed((()=>({ref:d,class:"q-btn q-btn-item non-selectable no-outline "+i.value,style:o.value,...s.value,...w.value})));function S(t){if(null!==d.value){if(void 0!==t){if(!0===t.defaultPrevented)return;const r=document.activeElement;if("submit"===e.type&&r!==document.body&&!1===d.value.contains(r)&&!1===r.contains(d.value)){!0!==t.qAvoidFocus&&d.value.focus();const e=()=>{document.removeEventListener("keydown",stopAndPrevent$1,!0),document.removeEventListener("keyup",e,passiveCapture),d.value?.removeEventListener("blur",e,passiveCapture)};document.addEventListener("keydown",stopAndPrevent$1,!0),document.addEventListener("keyup",e,passiveCapture),d.value.addEventListener("blur",e,passiveCapture)}}u(t)}}function E(e){null!==d.value&&(r("keydown",e),!0===isKeyCode(e,[13,32])&&keyboardTarget!==d.value&&(null!==keyboardTarget&&I(),!0!==e.defaultPrevented&&(!0!==e.qAvoidFocus&&d.value.focus(),keyboardTarget=d.value,d.value.classList.add("q-btn--active"),document.addEventListener("keyup",C,!0),d.value.addEventListener("blur",C,passiveCapture)),stopAndPrevent$1(e)))}function T(e){null!==d.value&&(r("touchstart",e),!0!==e.defaultPrevented&&(touchTarget!==d.value&&(null!==touchTarget&&I(),touchTarget=d.value,m=e.target,m.addEventListener("touchcancel",C,passiveCapture),m.addEventListener("touchend",C,passiveCapture)),f=!0,null!==g&&clearTimeout(g),g=setTimeout((()=>{g=null,f=!1}),200)))}function A(e){null!==d.value&&(e.qSkipRipple=!0===f,r("mousedown",e),!0!==e.defaultPrevented&&mouseTarget!==d.value&&(null!==mouseTarget&&I(),mouseTarget=d.value,d.value.classList.add("q-btn--active"),document.addEventListener("mouseup",C,passiveCapture)))}function C(e){if(null!==d.value&&("blur"!==e?.type||document.activeElement!==d.value)){if("keyup"===e?.type){if(keyboardTarget===d.value&&!0===isKeyCode(e,[13,32])){const t=new MouseEvent("click",e);t.qKeyEvent=!0,!0===e.defaultPrevented&&prevent(t),!0===e.cancelBubble&&stop$1(t),d.value.dispatchEvent(t),stopAndPrevent$1(e),e.qKeyEvent=!0}r("keyup",e)}I()}}function I(e){const t=p.value;!0===e||touchTarget!==d.value&&mouseTarget!==d.value||null===t||t===document.activeElement||(t.setAttribute("tabindex",-1),t.focus()),touchTarget===d.value&&(null!==m&&(m.removeEventListener("touchcancel",C,passiveCapture),m.removeEventListener("touchend",C,passiveCapture)),touchTarget=m=null),mouseTarget===d.value&&(document.removeEventListener("mouseup",C,passiveCapture),mouseTarget=null),keyboardTarget===d.value&&(document.removeEventListener("keyup",C,!0),d.value?.removeEventListener("blur",C,passiveCapture),keyboardTarget=null),d.value?.classList.remove("q-btn--active")}function k(e){stopAndPrevent$1(e),e.qSkipRipple=!0}return onBeforeUnmount((()=>{I(!0)})),Object.assign(n,{click:e=>{!0===h.value&&S(e)}}),()=>{let r=[];void 0!==e.icon&&r.push(h$2(QIcon,{name:e.icon,left:!0!==e.stack&&!0===y.value,role:"img"})),!0===y.value&&r.push(h$2("span",{class:"block"},[e.label])),r=hMergeSlot(t.default,r),void 0!==e.iconRight&&!1===e.round&&r.push(h$2(QIcon,{name:e.iconRight,right:!0!==e.stack&&!0===y.value,role:"img"}));const n=[h$2("span",{class:"q-focus-helper",ref:p})];return!0===e.loading&&void 0!==e.percentage&&n.push(h$2("span",{class:"q-btn__progress absolute-full overflow-hidden"+(!0===e.darkPercentage?" q-btn__progress--dark":"")},[h$2("span",{class:"q-btn__progress-indicator fit block",style:b.value})])),n.push(h$2("span",{class:"q-btn__content text-center col items-center q-anchor--skip "+a.value},r)),null!==e.loading&&n.push(h$2(Transition,{name:"q-transition--fade"},(()=>!0===e.loading?[h$2("span",{key:"loading",class:"absolute-full flex flex-center"},void 0!==t.loading?t.loading():[h$2(QSpinner)])]:null))),withDirectives(h$2(c.value,x.value,n),[[Ripple,_.value,void 0,v.value]])}}}),useDarkProps={dark:{type:Boolean,default:null}};function useDark(e,t){return computed((()=>null===e.dark?t.dark.isActive:e.dark))}const QCard=createComponent({name:"QCard",props:{...useDarkProps,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=useDark(e,r),i=computed((()=>"q-card"+(!0===n.value?" q-card--dark q-dark":"")+(!0===e.bordered?" q-card--bordered":"")+(!0===e.square?" q-card--square no-border-radius":"")+(!0===e.flat?" q-card--flat no-shadow":"")));return()=>h$2(e.tag,{class:i.value},hSlot(t.default))}}),QCardSection=createComponent({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:t}){const r=computed((()=>"q-card__section q-card__section--"+(!0===e.horizontal?"horiz row no-wrap":"vert")));return()=>h$2(e.tag,{class:r.value},hSlot(t.default))}}),QCardActions=createComponent({name:"QCardActions",props:{...useAlignProps,vertical:Boolean},setup(e,{slots:t}){const r=useAlign(e),n=computed((()=>`q-card__actions ${r.value} q-card__actions--${!0===e.vertical?"vert column":"horiz row"}`));return()=>h$2("div",{class:n.value},hSlot(t.default))}}),insetMap={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},margins={xs:2,sm:4,md:8,lg:16,xl:24},QSeparator=createComponent({name:"QSeparator",props:{...useDarkProps,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(e){const t=getCurrentInstance(),r=useDark(e,t.proxy.$q),n=computed((()=>!0===e.vertical?"vertical":"horizontal")),i=computed((()=>` q-separator--${n.value}`)),o=computed((()=>!1!==e.inset?`${i.value}-${insetMap[e.inset]}`:"")),a=computed((()=>`q-separator${i.value}${o.value}`+(void 0!==e.color?` bg-${e.color}`:"")+(!0===r.value?" q-separator--dark":""))),s=computed((()=>{const t={};if(void 0!==e.size&&(t[!0===e.vertical?"width":"height"]=e.size),!1!==e.spaced){const r=!0===e.spaced?`${margins.md}px`:e.spaced in margins?`${margins[e.spaced]}px`:e.spaced,n=!0===e.vertical?["Left","Right"]:["Top","Bottom"];t[`margin${n[0]}`]=t[`margin${n[1]}`]=r}return t}));return()=>h$2("hr",{class:a.value,style:s.value,"aria-orientation":n.value})}});let buf,bufIdx=0;const hexBytes=new Array(256);for(let I=0;I<256;I++)hexBytes[I]=(I+256).toString(16).substring(1);const randomBytes=(()=>{const e="undefined"!=typeof crypto?crypto:"undefined"!=typeof window?window.crypto||window.msCrypto:void 0;if(void 0!==e){if(void 0!==e.randomBytes)return e.randomBytes;if(void 0!==e.getRandomValues)return t=>{const r=new Uint8Array(t);return e.getRandomValues(r),r}}return e=>{const t=[];for(let r=e;r>0;r--)t.push(Math.floor(256*Math.random()));return t}})(),BUFFER_SIZE=4096;function uid$3(){(void 0===buf||bufIdx+16>BUFFER_SIZE)&&(bufIdx=0,buf=randomBytes(BUFFER_SIZE));const e=Array.prototype.slice.call(buf,bufIdx,bufIdx+=16);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,hexBytes[e[0]]+hexBytes[e[1]]+hexBytes[e[2]]+hexBytes[e[3]]+"-"+hexBytes[e[4]]+hexBytes[e[5]]+"-"+hexBytes[e[6]]+hexBytes[e[7]]+"-"+hexBytes[e[8]]+hexBytes[e[9]]+"-"+hexBytes[e[10]]+hexBytes[e[11]]+hexBytes[e[12]]+hexBytes[e[13]]+hexBytes[e[14]]+hexBytes[e[15]]}function parseValue(e){return null==e?null:e}function getId(e,t){return null==e?!0===t?`f_${uid$3()}`:null:e}function useId({getValue:e,required:t=!0}={}){if(!0===isRuntimeSsrPreHydration.value){const r=ref$1(void 0!==e?parseValue(e()):null);return!0===t&&null===r.value&&onMounted((()=>{r.value=`f_${uid$3()}`})),void 0!==e&&watch$2(e,(e=>{r.value=getId(e,t)})),r}return void 0!==e?computed((()=>getId(e(),t))):ref$1(`f_${uid$3()}`)}const listenerRE=/^on[A-Z]/;function useSplitAttrs(){const{attrs:e,vnode:t}=getCurrentInstance(),r={listeners:ref$1({}),attributes:ref$1({})};function n(){const n={},i={};for(const t in e)"class"!==t&&"style"!==t&&!1===listenerRE.test(t)&&(n[t]=e[t]);for(const e in t.props)!0===listenerRE.test(e)&&(i[e]=t.props[e]);r.attributes.value=n,r.listeners.value=i}return onBeforeUpdate(n),n(),r}function useFormChild({validate:e,resetValidation:t,requiresQForm:r}){const n=inject(formKey,!1);if(!1!==n){const{props:r,proxy:i}=getCurrentInstance();Object.assign(i,{validate:e,resetValidation:t}),watch$2((()=>r.disable),(e=>{!0===e?("function"==typeof t&&t(),n.unbindComponent(i)):n.bindComponent(i)})),onMounted((()=>{!0!==r.disable&&n.bindComponent(i)})),onBeforeUnmount((()=>{!0!==r.disable&&n.unbindComponent(i)}))}}const hex$1=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,hexa=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,hexOrHexa=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,rgb=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,rgba=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,testPattern={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>hex$1.test(e),hexaColor:e=>hexa.test(e),hexOrHexaColor:e=>hexOrHexa.test(e),rgbColor:e=>rgb.test(e),rgbaColor:e=>rgba.test(e),rgbOrRgbaColor:e=>rgb.test(e)||rgba.test(e),hexOrRgbColor:e=>hex$1.test(e)||rgb.test(e),hexaOrRgbaColor:e=>hexa.test(e)||rgba.test(e),anyColor:e=>hexOrHexa.test(e)||rgb.test(e)||rgba.test(e)},lazyRulesValues=[!0,!1,"ondemand"],useValidateProps={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>lazyRulesValues.includes(e)}};function useValidate(e,t){const{props:r,proxy:n}=getCurrentInstance(),i=ref$1(!1),o=ref$1(null),a=ref$1(!1);useFormChild({validate:m,resetValidation:f});let s,l=0;const c=computed((()=>void 0!==r.rules&&null!==r.rules&&0!==r.rules.length)),u=computed((()=>!0!==r.disable&&!0===c.value&&!1===t.value)),h=computed((()=>!0===r.error||!0===i.value)),d=computed((()=>"string"==typeof r.errorMessage&&0!==r.errorMessage.length?r.errorMessage:o.value));function p(){"ondemand"!==r.lazyRules&&!0===u.value&&!0===a.value&&g()}function f(){l++,t.value=!1,a.value=!1,i.value=!1,o.value=null,g.cancel()}function m(e=r.modelValue){if(!0===r.disable||!1===c.value)return!0;const n=++l,s=!0!==t.value?()=>{a.value=!0}:()=>{},u=(e,r)=>{!0===e&&s(),i.value=e,o.value=r||null,t.value=!1},h=[];for(let t=0;t<r.rules.length;t++){const n=r.rules[t];let i;if("function"==typeof n?i=n(e,testPattern):"string"==typeof n&&void 0!==testPattern[n]&&(i=testPattern[n](e)),!1===i||"string"==typeof i)return u(!0,i),!1;!0!==i&&void 0!==i&&h.push(i)}return 0===h.length?(u(!1),!0):(t.value=!0,Promise.all(h).then((e=>{if(void 0===e||!1===Array.isArray(e)||0===e.length)return n===l&&u(!1),!0;const t=e.find((e=>!1===e||"string"==typeof e));return n===l&&u(void 0!==t,t),void 0===t}),(e=>(n===l&&u(!0),!1))))}watch$2((()=>r.modelValue),(()=>{a.value=!0,!0===u.value&&!1===r.lazyRules&&g()})),watch$2((()=>r.reactiveRules),(e=>{!0===e?void 0===s&&(s=watch$2((()=>r.rules),p,{immediate:!0,deep:!0})):void 0!==s&&(s(),s=void 0)}),{immediate:!0}),watch$2((()=>r.lazyRules),p),watch$2(e,(e=>{!0===e?a.value=!0:!0===u.value&&"ondemand"!==r.lazyRules&&g()}));const g=debounce$1(m,0);return onBeforeUnmount((()=>{s?.(),g.cancel()})),Object.assign(n,{resetValidation:f,validate:m}),injectProp(n,"hasError",(()=>h.value)),{isDirtyModel:a,hasRules:c,hasError:h,errorMessage:d,validate:m,resetValidation:f}}function fieldValueIsFilled(e){return null!=e&&0!==(""+e).length}const useNonInputFieldProps={...useDarkProps,...useValidateProps,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},useFieldProps={...useNonInputFieldProps,maxlength:[Number,String]},useFieldEmits=["update:modelValue","clear","focus","blur"];function useFieldState({requiredForAttr:e=!0,tagProp:t,changeEvent:r=!1}={}){const{props:n,proxy:i}=getCurrentInstance(),o=useDark(n,i.$q),a=useId({required:e,getValue:()=>n.for});return{requiredForAttr:e,changeEvent:r,tag:!0===t?computed((()=>n.tag)):{value:"label"},isDark:o,editable:computed((()=>!0!==n.disable&&!0!==n.readonly)),innerLoading:ref$1(!1),focused:ref$1(!1),hasPopupOpen:!1,splitAttrs:useSplitAttrs(),targetUid:a,rootRef:ref$1(null),targetRef:ref$1(null),controlRef:ref$1(null)}}function useField(e){const{props:t,emit:r,slots:n,attrs:i,proxy:o}=getCurrentInstance(),{$q:a}=o;let s=null;void 0===e.hasValue&&(e.hasValue=computed((()=>fieldValueIsFilled(t.modelValue)))),void 0===e.emitValue&&(e.emitValue=e=>{r("update:modelValue",e)}),void 0===e.controlEvents&&(e.controlEvents={onFocusin:E,onFocusout:T}),Object.assign(e,{clearValue:A,onControlFocusin:E,onControlFocusout:T,focus:S}),void 0===e.computedCounter&&(e.computedCounter=computed((()=>{if(!1!==t.counter){const e="string"==typeof t.modelValue||"number"==typeof t.modelValue?(""+t.modelValue).length:!0===Array.isArray(t.modelValue)?t.modelValue.length:0,r=void 0!==t.maxlength?t.maxlength:t.maxValues;return e+(void 0!==r?" / "+r:"")}})));const{isDirtyModel:l,hasRules:c,hasError:u,errorMessage:h,resetValidation:d}=useValidate(e.focused,e.innerLoading),p=void 0!==e.floatingLabel?computed((()=>!0===t.stackLabel||!0===e.focused.value||!0===e.floatingLabel.value)):computed((()=>!0===t.stackLabel||!0===e.focused.value||!0===e.hasValue.value)),f=computed((()=>!0===t.bottomSlots||void 0!==t.hint||!0===c.value||!0===t.counter||null!==t.error)),m=computed((()=>!0===t.filled?"filled":!0===t.outlined?"outlined":!0===t.borderless?"borderless":t.standout?"standout":"standard")),g=computed((()=>`q-field row no-wrap items-start q-field--${m.value}`+(void 0!==e.fieldClass?` ${e.fieldClass.value}`:"")+(!0===t.rounded?" q-field--rounded":"")+(!0===t.square?" q-field--square":"")+(!0===p.value?" q-field--float":"")+(!0===_.value?" q-field--labeled":"")+(!0===t.dense?" q-field--dense":"")+(!0===t.itemAligned?" q-field--item-aligned q-item-type":"")+(!0===e.isDark.value?" q-field--dark":"")+(void 0===e.getControl?" q-field--auto-height":"")+(!0===e.focused.value?" q-field--focused":"")+(!0===u.value?" q-field--error":"")+(!0===u.value||!0===e.focused.value?" q-field--highlighted":"")+(!0!==t.hideBottomSpace&&!0===f.value?" q-field--with-bottom":"")+(!0===t.disable?" q-field--disabled":!0===t.readonly?" q-field--readonly":""))),y=computed((()=>"q-field__control relative-position row no-wrap"+(void 0!==t.bgColor?` bg-${t.bgColor}`:"")+(!0===u.value?" text-negative":"string"==typeof t.standout&&0!==t.standout.length&&!0===e.focused.value?` ${t.standout}`:void 0!==t.color?` text-${t.color}`:""))),_=computed((()=>!0===t.labelSlot||void 0!==t.label)),v=computed((()=>"q-field__label no-pointer-events absolute ellipsis"+(void 0!==t.labelColor&&!0!==u.value?` text-${t.labelColor}`:""))),b=computed((()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:p.value,modelValue:t.modelValue,emitValue:e.emitValue}))),w=computed((()=>{const r={};return e.targetUid.value&&(r.for=e.targetUid.value),!0===t.disable&&(r["aria-disabled"]="true"),r}));function x(){const t=document.activeElement;let r=e.targetRef?.value;!r||null!==t&&t.id===e.targetUid.value||(!0===r.hasAttribute("tabindex")||(r=r.querySelector("[tabindex]")),r!==t&&r?.focus({preventScroll:!0}))}function S(){addFocusFn(x)}function E(t){null!==s&&(clearTimeout(s),s=null),!0===e.editable.value&&!1===e.focused.value&&(e.focused.value=!0,r("focus",t))}function T(t,n){null!==s&&clearTimeout(s),s=setTimeout((()=>{s=null,(!0!==document.hasFocus()||!0!==e.hasPopupOpen&&void 0!==e.controlRef&&null!==e.controlRef.value&&!1===e.controlRef.value.contains(document.activeElement))&&(!0===e.focused.value&&(e.focused.value=!1,r("blur",t)),n?.())}))}function A(n){if(stopAndPrevent$1(n),!0!==a.platform.is.mobile){(e.targetRef?.value||e.rootRef.value).focus()}else!0===e.rootRef.value.contains(document.activeElement)&&document.activeElement.blur();"file"===t.type&&(e.inputRef.value.value=null),r("update:modelValue",null),!0===e.changeEvent&&r("change",null),r("clear",t.modelValue),nextTick((()=>{const e=l.value;d(),l.value=e}))}function C(e){[13,32].includes(e.keyCode)&&A(e)}function I(){const r=[];return void 0!==n.prepend&&r.push(h$2("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:prevent},n.prepend())),r.push(h$2("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},function(){const r=[];void 0!==t.prefix&&null!==t.prefix&&r.push(h$2("div",{class:"q-field__prefix no-pointer-events row items-center"},t.prefix)),void 0!==e.getShadowControl&&!0===e.hasShadow.value&&r.push(e.getShadowControl());!0===_.value&&r.push(h$2("div",{class:v.value},hSlot(n.label,t.label))),void 0!==e.getControl?r.push(e.getControl()):void 0!==n.rawControl?r.push(n.rawControl()):void 0!==n.control&&r.push(h$2("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":!0===t.autofocus||void 0},n.control(b.value)));return void 0!==t.suffix&&null!==t.suffix&&r.push(h$2("div",{class:"q-field__suffix no-pointer-events row items-center"},t.suffix)),r.concat(hSlot(n.default))}())),!0===u.value&&!1===t.noErrorIcon&&r.push(P("error",[h$2(QIcon,{name:a.iconSet.field.error,color:"negative"})])),!0===t.loading||!0===e.innerLoading.value?r.push(P("inner-loading-append",void 0!==n.loading?n.loading():[h$2(QSpinner,{color:t.color})])):!0===t.clearable&&!0===e.hasValue.value&&!0===e.editable.value&&r.push(P("inner-clearable-append",[h$2(QIcon,{class:"q-field__focusable-action",name:t.clearIcon||a.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":a.lang.label.clear,onKeyup:C,onClick:A})])),void 0!==n.append&&r.push(h$2("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:prevent},n.append())),void 0!==e.getInnerAppend&&r.push(P("inner-append",e.getInnerAppend())),void 0!==e.getControlChild&&r.push(e.getControlChild()),r}function k(){let r,i;!0===u.value?null!==h.value?(r=[h$2("div",{role:"alert"},h.value)],i=`q--slot-error-${h.value}`):(r=hSlot(n.error),i="q--slot-error"):!0===t.hideHint&&!0!==e.focused.value||(void 0!==t.hint?(r=[h$2("div",t.hint)],i=`q--slot-hint-${t.hint}`):(r=hSlot(n.hint),i="q--slot-hint"));const o=!0===t.counter||void 0!==n.counter;if(!0===t.hideBottomSpace&&!1===o&&void 0===r)return;const a=h$2("div",{key:i,class:"q-field__messages col"},r);return h$2("div",{class:"q-field__bottom row items-start q-field__bottom--"+(!0!==t.hideBottomSpace?"animated":"stale"),onClick:prevent},[!0===t.hideBottomSpace?a:h$2(Transition,{name:"q-transition--field-message"},(()=>a)),!0===o?h$2("div",{class:"q-field__counter"},void 0!==n.counter?n.counter():e.computedCounter.value):null])}function P(e,t){return null===t?null:h$2("div",{key:e,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},t)}let M=!1;return onDeactivated((()=>{M=!0})),onActivated((()=>{!0===M&&!0===t.autofocus&&o.focus()})),!0===t.autofocus&&onMounted((()=>{o.focus()})),onBeforeUnmount((()=>{null!==s&&clearTimeout(s)})),Object.assign(o,{focus:S,blur:function(){removeFocusFn(x);const t=document.activeElement;null!==t&&e.rootRef.value.contains(t)&&t.blur()}}),function(){const r=void 0===e.getControl&&void 0===n.control?{...e.splitAttrs.attributes.value,"data-autofocus":!0===t.autofocus||void 0,...w.value}:w.value;return h$2(e.tag.value,{ref:e.rootRef,class:[g.value,i.class],style:i.style,...r},[void 0!==n.before?h$2("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:prevent},n.before()):null,h$2("div",{class:"q-field__inner relative-position col self-stretch"},[h$2("div",{ref:e.controlRef,class:y.value,tabindex:-1,...e.controlEvents},I()),!0===f.value?k():null]),void 0!==n.after?h$2("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:prevent},n.after()):null])}}const NAMED_MASKS={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},{tokenMap:DEFAULT_TOKEN_MAP,tokenKeys:DEFAULT_TOKEN_MAP_KEYS}=getTokenMap({"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}});function getTokenMap(e){const t=Object.keys(e),r={};return t.forEach((t=>{const n=e[t];r[t]={...n,regex:new RegExp(n.pattern)}})),{tokenMap:r,tokenKeys:t}}function getTokenRegexMask(e){return new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+e.join("")+"])|(.)","g")}const escRegex=/[.*+?^${}()|[\]\\]/g,DEFAULT_TOKEN_REGEX_MASK=getTokenRegexMask(DEFAULT_TOKEN_MAP_KEYS),MARKER=String.fromCharCode(1),useMaskProps={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean,maskTokens:Object};function useMask(e,t,r,n){let i,o,a,s,l,c;const u=computed((()=>{if(void 0===e.maskTokens||null===e.maskTokens)return{tokenMap:DEFAULT_TOKEN_MAP,tokenRegexMask:DEFAULT_TOKEN_REGEX_MASK};const{tokenMap:t}=getTokenMap(e.maskTokens),r={...DEFAULT_TOKEN_MAP,...t};return{tokenMap:r,tokenRegexMask:getTokenRegexMask(Object.keys(r))}})),h=ref$1(null),d=ref$1(function(){if(f(),!0===h.value){const t=y(_(e.modelValue));return!1!==e.fillMask?v(t):t}return e.modelValue}());function p(e){if(e<i.length)return i.slice(-e);let t="",r=i;const n=r.indexOf(MARKER);if(-1!==n){for(let n=e-r.length;n>0;n--)t+=MARKER;r=r.slice(0,n)+t+r.slice(n)}return r}function f(){if(h.value=void 0!==e.mask&&0!==e.mask.length&&(!0===e.autogrow||["textarea","text","search","url","tel","password"].includes(e.type)),!1===h.value)return s=void 0,i="",void(o="");const t=void 0===NAMED_MASKS[e.mask]?e.mask:NAMED_MASKS[e.mask],r="string"==typeof e.fillMask&&0!==e.fillMask.length?e.fillMask.slice(0,1):"_",n=r.replace(escRegex,"\\$&"),l=[],c=[],d=[];let p=!0===e.reverseFillMask,f="",m="";t.replace(u.value.tokenRegexMask,((e,t,r,n,i)=>{if(void 0!==n){const e=u.value.tokenMap[n];d.push(e),m=e.negate,!0===p&&(c.push("(?:"+m+"+)?("+e.pattern+"+)?(?:"+m+"+)?("+e.pattern+"+)?"),p=!1),c.push("(?:"+m+"+)?("+e.pattern+")?")}else if(void 0!==r)f="\\"+("\\"===r?"":r),d.push(r),l.push("([^"+f+"]+)?"+f+"?");else{const e=void 0!==t?t:i;f="\\"===e?"\\\\\\\\":e.replace(escRegex,"\\\\$&"),d.push(e),l.push("([^"+f+"]+)?"+f+"?")}}));const g=new RegExp("^"+l.join("")+"("+(""===f?".":"[^"+f+"]")+"+)?"+(""===f?"":"["+f+"]*")+"$"),y=c.length-1,_=c.map(((t,r)=>0===r&&!0===e.reverseFillMask?new RegExp("^"+n+"*"+t):r===y?new RegExp("^"+t+"("+(""===m?".":m)+"+)?"+(!0===e.reverseFillMask?"$":n+"*")):new RegExp("^"+t)));a=d,s=t=>{const r=g.exec(!0===e.reverseFillMask?t:t.slice(0,d.length+1));null!==r&&(t=r.slice(1).join(""));const n=[],i=_.length;for(let e=0,o=t;e<i;e++){const t=_[e].exec(o);if(null===t)break;o=o.slice(t.shift().length),n.push(...t)}return 0!==n.length?n.join(""):t},i=d.map((e=>"string"==typeof e?e:MARKER)).join(""),o=i.split(MARKER).join(r)}function m(t,a,s){const c=n.value,u=c.selectionEnd,h=c.value.length-u,p=_(t);!0===a&&f();const m=y(p,a),b=!1!==e.fillMask?v(m):m,w=d.value!==b;c.value!==b&&(c.value=b),!0===w&&(d.value=b),document.activeElement===c&&nextTick((()=>{if(b!==o)if("insertFromPaste"!==s||!0===e.reverseFillMask)if(-1===["deleteContentBackward","deleteContentForward"].indexOf(s))if(!0===e.reverseFillMask)if(!0===w){const e=Math.max(0,b.length-(b===o?0:Math.min(m.length,h+1)));1===e&&1===u?c.setSelectionRange(e,e,"forward"):g.rightReverse(c,e)}else{const e=b.length-h;c.setSelectionRange(e,e,"backward")}else if(!0===w){const e=Math.max(0,i.indexOf(MARKER),Math.min(m.length,u)-1);g.right(c,e)}else{const e=u-1;g.right(c,e)}else{const t=!0===e.reverseFillMask?0===u?b.length>m.length?1:0:Math.max(0,b.length-(b===o?0:Math.min(m.length,h)+1))+1:u;c.setSelectionRange(t,t,"forward")}else{const e=c.selectionEnd;let t=u-1;for(let r=l;r<=t&&r<e;r++)i[r]!==MARKER&&t++;g.right(c,t)}else{const t=!0===e.reverseFillMask?o.length:0;c.setSelectionRange(t,t,"forward")}}));const x=!0===e.unmaskedValue?_(b):b;String(e.modelValue)===x||null===e.modelValue&&""===x||r(x,!0)}watch$2((()=>e.type+e.autogrow),f),watch$2((()=>e.mask),(r=>{if(void 0!==r)m(d.value,!0);else{const r=_(d.value);f(),e.modelValue!==r&&t("update:modelValue",r)}})),watch$2((()=>e.fillMask+e.reverseFillMask),(()=>{!0===h.value&&m(d.value,!0)})),watch$2((()=>e.unmaskedValue),(()=>{!0===h.value&&m(d.value)}));const g={left(e,t){const r=-1===i.slice(t-1).indexOf(MARKER);let n=Math.max(0,t-1);for(;n>=0;n--)if(i[n]===MARKER){t=n,!0===r&&t++;break}if(n<0&&void 0!==i[t]&&i[t]!==MARKER)return g.right(e,0);t>=0&&e.setSelectionRange(t,t,"backward")},right(e,t){const r=e.value.length;let n=Math.min(r,t+1);for(;n<=r;n++){if(i[n]===MARKER){t=n;break}i[n-1]===MARKER&&(t=n)}if(n>r&&void 0!==i[t-1]&&i[t-1]!==MARKER)return g.left(e,r);e.setSelectionRange(t,t,"forward")},leftReverse(e,t){const r=p(e.value.length);let n=Math.max(0,t-1);for(;n>=0;n--){if(r[n-1]===MARKER){t=n;break}if(r[n]===MARKER&&(t=n,0===n))break}if(n<0&&void 0!==r[t]&&r[t]!==MARKER)return g.rightReverse(e,0);t>=0&&e.setSelectionRange(t,t,"backward")},rightReverse(e,t){const r=e.value.length,n=p(r),i=-1===n.slice(0,t+1).indexOf(MARKER);let o=Math.min(r,t+1);for(;o<=r;o++)if(n[o-1]===MARKER){(t=o)>0&&!0===i&&t--;break}if(o>r&&void 0!==n[t-1]&&n[t-1]!==MARKER)return g.leftReverse(e,r);e.setSelectionRange(t,t,"forward")}};function y(t,r){if(null==t||""===t)return"";if(!0===e.reverseFillMask)return function(e,t){const r=a,n=i.indexOf(MARKER);let o=e.length-1,s="";for(let i=r.length-1;i>=0&&-1!==o;i--){const a=r[i];let l=e[o];if("string"==typeof a)s=a+s,!0===t&&l===a&&o--;else{if(void 0===l||!a.regex.test(l))return s;do{s=(void 0!==a.transform?a.transform(l):l)+s,o--,l=e[o]}while(n===i&&void 0!==l&&a.regex.test(l))}}return s}(t,r);const n=a;let o=0,s="";for(let e=0;e<n.length;e++){const i=t[o],a=n[e];if("string"==typeof a)s+=a,!0===r&&i===a&&o++;else{if(void 0===i||!a.regex.test(i))return s;s+=void 0!==a.transform?a.transform(i):i,o++}}return s}function _(e){return"string"!=typeof e||void 0===s?"number"==typeof e?s(""+e):e:s(e)}function v(t){return o.length-t.length<=0?t:!0===e.reverseFillMask&&0!==t.length?o.slice(0,-t.length)+t:t+o.slice(t.length)}return{innerValue:d,hasMask:h,moveCursorForPaste:function(e,t,r){const n=y(_(e.value));t=Math.max(0,i.indexOf(MARKER),Math.min(n.length,t)),l=t,e.setSelectionRange(t,r,"forward")},updateMaskValue:m,onMaskedKeydown:function(r){if(t("keydown",r),!0===shouldIgnoreKey(r)||!0===r.altKey)return;const i=n.value,o=i.selectionStart,a=i.selectionEnd;if(r.shiftKey||(c=void 0),37===r.keyCode||39===r.keyCode){r.shiftKey&&void 0===c&&(c="forward"===i.selectionDirection?o:a);const t=g[(39===r.keyCode?"right":"left")+(!0===e.reverseFillMask?"Reverse":"")];if(r.preventDefault(),t(i,c===o?a:o),r.shiftKey){const e=i.selectionStart;i.setSelectionRange(Math.min(c,e),Math.max(c,e),"forward")}}else 8===r.keyCode&&!0!==e.reverseFillMask&&o===a?(g.left(i,o),i.setSelectionRange(i.selectionStart,a,"backward")):46===r.keyCode&&!0===e.reverseFillMask&&o===a&&(g.rightReverse(i,a),i.setSelectionRange(o,i.selectionEnd,"forward"))},onMaskedClick:function(e){t("click",e),c=void 0}}}const useFormProps={name:String};function useFormAttrs(e){return computed((()=>({type:"hidden",name:e.name,value:e.modelValue})))}function useFormInject(e={}){return(t,r,n)=>{t[r](h$2("input",{class:"hidden"+(n||""),...e.value}))}}function useFormInputNameAttr(e){return computed((()=>e.name||e.for))}function useFileFormDomProps(e,t){return computed((()=>{if("file"===e.type)return function(){const t=e.modelValue;try{const e="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(t)===t&&("length"in t?Array.from(t):[t]).forEach((t=>{e.items.add(t)})),{files:e.files}}catch(r){return{files:void 0}}}()}))}const isJapanese=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,isChinese=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,isKorean=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,isPlainText=/[a-z0-9_ -]$/i;function useKeyComposition(e){return function(t){if("compositionend"===t.type||"change"===t.type){if(!0!==t.target.qComposing)return;t.target.qComposing=!1,e(t)}else if("compositionupdate"===t.type&&!0!==t.target.qComposing&&"string"==typeof t.data){!0===(!0===client.is.firefox?!1===isPlainText.test(t.data):!0===isJapanese.test(t.data)||!0===isChinese.test(t.data)||!0===isKorean.test(t.data))&&(t.target.qComposing=!0)}}}const QInput=createComponent({name:"QInput",inheritAttrs:!1,props:{...useFieldProps,...useMaskProps,...useFormProps,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...useFieldEmits,"paste","change","keydown","click","animationend"],setup(e,{emit:t,attrs:r}){const{proxy:n}=getCurrentInstance(),{$q:i}=n,o={};let a,s,l,c=NaN,u=null;const h=ref$1(null),d=useFormInputNameAttr(e),{innerValue:p,hasMask:f,moveCursorForPaste:m,updateMaskValue:g,onMaskedKeydown:y,onMaskedClick:_}=useMask(e,t,P,h),v=useFileFormDomProps(e),b=computed((()=>fieldValueIsFilled(p.value))),w=useKeyComposition(I),x=useFieldState({changeEvent:!0}),S=computed((()=>"textarea"===e.type||!0===e.autogrow)),E=computed((()=>!0===S.value||["text","search","url","tel","password"].includes(e.type))),T=computed((()=>{const t={...x.splitAttrs.listeners.value,onInput:I,onPaste:C,onChange:R,onBlur:D,onFocus:stop$1};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=w,!0===f.value&&(t.onKeydown=y,t.onClick=_),!0===e.autogrow&&(t.onAnimationend=k),t})),A=computed((()=>{const t={tabindex:0,"data-autofocus":!0===e.autofocus||void 0,rows:"textarea"===e.type?6:void 0,"aria-label":e.label,name:d.value,...x.splitAttrs.attributes.value,id:x.targetUid.value,maxlength:e.maxlength,disabled:!0===e.disable,readonly:!0===e.readonly};return!1===S.value&&(t.type=e.type),!0===e.autogrow&&(t.rows=1),t}));function C(r){if(!0===f.value&&!0!==e.reverseFillMask){const e=r.target;m(e,e.selectionStart,e.selectionEnd)}t("paste",r)}function I(r){if(!r||!r.target)return;if("file"===e.type)return void t("update:modelValue",r.target.files);const n=r.target.value;if(!0!==r.target.qComposing){if(!0===f.value)g(n,!1,r.inputType);else if(P(n),!0===E.value&&r.target===document.activeElement){const{selectionStart:e,selectionEnd:t}=r.target;void 0!==e&&void 0!==t&&nextTick((()=>{r.target===document.activeElement&&0===n.indexOf(r.target.value)&&r.target.setSelectionRange(e,t)}))}!0===e.autogrow&&M()}else o.value=n}function k(e){t("animationend",e),M()}function P(r,n){l=()=>{u=null,"number"!==e.type&&!0===o.hasOwnProperty("value")&&delete o.value,e.modelValue!==r&&c!==r&&(c=r,!0===n&&(s=!0),t("update:modelValue",r),nextTick((()=>{c===r&&(c=NaN)}))),l=void 0},"number"===e.type&&(a=!0,o.value=r),void 0!==e.debounce?(null!==u&&clearTimeout(u),o.value=r,u=setTimeout(l,e.debounce)):l()}function M(){requestAnimationFrame((()=>{const e=h.value;if(null!==e){const t=e.parentNode.style,{scrollTop:r}=e,{overflowY:n,maxHeight:o}=!0===i.platform.is.firefox?{}:window.getComputedStyle(e),a=void 0!==n&&"scroll"!==n;!0===a&&(e.style.overflowY="hidden"),t.marginBottom=e.scrollHeight-1+"px",e.style.height="1px",e.style.height=e.scrollHeight+"px",!0===a&&(e.style.overflowY=parseInt(o,10)<e.scrollHeight?"auto":"hidden"),t.marginBottom="",e.scrollTop=r}}))}function R(e){w(e),null!==u&&(clearTimeout(u),u=null),l?.(),t("change",e.target.value)}function D(t){void 0!==t&&stop$1(t),null!==u&&(clearTimeout(u),u=null),l?.(),a=!1,s=!1,delete o.value,"file"!==e.type&&setTimeout((()=>{null!==h.value&&(h.value.value=void 0!==p.value?p.value:"")}))}function O(){return!0===o.hasOwnProperty("value")?o.value:void 0!==p.value?p.value:""}watch$2((()=>e.type),(()=>{h.value&&(h.value.value=e.modelValue)})),watch$2((()=>e.modelValue),(t=>{if(!0===f.value){if(!0===s&&(s=!1,String(t)===c))return;g(t)}else p.value!==t&&(p.value=t,"number"===e.type&&!0===o.hasOwnProperty("value")&&(!0===a?a=!1:delete o.value));!0===e.autogrow&&nextTick(M)})),watch$2((()=>e.autogrow),(e=>{!0===e?nextTick(M):null!==h.value&&r.rows>0&&(h.value.style.height="auto")})),watch$2((()=>e.dense),(()=>{!0===e.autogrow&&nextTick(M)})),onBeforeUnmount((()=>{D()})),onMounted((()=>{!0===e.autogrow&&M()})),Object.assign(x,{innerValue:p,fieldClass:computed((()=>"q-"+(!0===S.value?"textarea":"input")+(!0===e.autogrow?" q-textarea--autogrow":""))),hasShadow:computed((()=>"file"!==e.type&&"string"==typeof e.shadowText&&0!==e.shadowText.length)),inputRef:h,emitValue:P,hasValue:b,floatingLabel:computed((()=>!0===b.value&&("number"!==e.type||!1===isNaN(p.value))||fieldValueIsFilled(e.displayValue))),getControl:()=>h$2(!0===S.value?"textarea":"input",{ref:h,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...A.value,...T.value,..."file"!==e.type?{value:O()}:v.value}),getShadowControl:()=>h$2("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(!0===S.value?"":" text-no-wrap")},[h$2("span",{class:"invisible"},O()),h$2("span",e.shadowText)])});const L=useField(x);return Object.assign(n,{focus:function(){addFocusFn((()=>{const e=document.activeElement;null===h.value||h.value===e||null!==e&&e.id===x.targetUid.value||h.value.focus({preventScroll:!0})}))},select:function(){h.value?.select()},getNativeElement:()=>h.value}),injectProp(n,"nativeEl",(()=>h.value)),L}});function useRefocusTarget(e,t){const r=ref$1(null);return{refocusTargetEl:computed((()=>!0===e.disable?null:h$2("span",{ref:r,class:"no-outline",tabindex:-1}))),refocusTarget:function(e){const n=t.value;!0!==e?.qAvoidFocus&&(0===e?.type.indexOf("key")?document.activeElement!==n&&!0===n?.contains(document.activeElement)&&n.focus():null===r.value||void 0!==e&&!0!==n?.contains(e.target)||r.value.focus())}}}const optionSizes={xs:30,sm:35,md:40,lg:50,xl:60},createSvg=()=>h$2("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[h$2("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),h$2("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]),QRadio=createComponent({name:"QRadio",props:{...useDarkProps,...useSizeProps,...useFormProps,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(e,{slots:t,emit:r}){const{proxy:n}=getCurrentInstance(),i=useDark(e,n.$q),o=useSize(e,optionSizes),a=ref$1(null),{refocusTargetEl:s,refocusTarget:l}=useRefocusTarget(e,a),c=computed((()=>toRaw(e.modelValue)===toRaw(e.val))),u=computed((()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(!0===e.disable?" disabled":"")+(!0===i.value?" q-radio--dark":"")+(!0===e.dense?" q-radio--dense":"")+(!0===e.leftLabel?" reverse":""))),h=computed((()=>{const t=void 0===e.color||!0!==e.keepColor&&!0!==c.value?"":` text-${e.color}`;return`q-radio__inner relative-position q-radio__inner--${!0===c.value?"truthy":"falsy"}${t}`})),d=computed((()=>(!0===c.value?e.checkedIcon:e.uncheckedIcon)||null)),p=computed((()=>!0===e.disable?-1:e.tabindex||0)),f=useFormInject(computed((()=>{const t={type:"radio"};return void 0!==e.name&&Object.assign(t,{".checked":!0===c.value,"^checked":!0===c.value?"checked":void 0,name:e.name,value:e.val}),t})));function m(t){void 0!==t&&(stopAndPrevent$1(t),l(t)),!0!==e.disable&&!0!==c.value&&r("update:modelValue",e.val,t)}function g(e){13!==e.keyCode&&32!==e.keyCode||stopAndPrevent$1(e)}function y(e){13!==e.keyCode&&32!==e.keyCode||m(e)}Object.assign(n,{set:m});const _=createSvg();return()=>{const r=null!==d.value?[h$2("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[h$2(QIcon,{class:"q-radio__icon",name:d.value})])]:[_];!0!==e.disable&&f(r,"unshift"," q-radio__native q-ma-none q-pa-none");const n=[h$2("div",{class:h.value,style:o.value,"aria-hidden":"true"},r)];null!==s.value&&n.push(s.value);const i=void 0!==e.label?hMergeSlot(t.default,[e.label]):hSlot(t.default);return void 0!==i&&n.push(h$2("div",{class:"q-radio__label q-anchor--skip"},i)),h$2("div",{ref:a,class:u.value,tabindex:p.value,role:"radio","aria-label":e.label,"aria-checked":!0===c.value?"true":"false","aria-disabled":!0===e.disable?"true":void 0,onClick:m,onKeydown:g,onKeyup:y},n)}}}),useCheckboxProps={...useDarkProps,...useSizeProps,...useFormProps,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>"tf"===e||"ft"===e},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},useCheckboxEmits=["update:modelValue"];function useCheckbox(e,t){const{props:r,slots:n,emit:i,proxy:o}=getCurrentInstance(),{$q:a}=o,s=useDark(r,a),l=ref$1(null),{refocusTargetEl:c,refocusTarget:u}=useRefocusTarget(r,l),h=useSize(r,optionSizes),d=computed((()=>void 0!==r.val&&Array.isArray(r.modelValue))),p=computed((()=>{const e=toRaw(r.val);return!0===d.value?r.modelValue.findIndex((t=>toRaw(t)===e)):-1})),f=computed((()=>!0===d.value?-1!==p.value:toRaw(r.modelValue)===toRaw(r.trueValue))),m=computed((()=>!0===d.value?-1===p.value:toRaw(r.modelValue)===toRaw(r.falseValue))),g=computed((()=>!1===f.value&&!1===m.value)),y=computed((()=>!0===r.disable?-1:r.tabindex||0)),_=computed((()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(!0===r.disable?" disabled":"")+(!0===s.value?` q-${e}--dark`:"")+(!0===r.dense?` q-${e}--dense`:"")+(!0===r.leftLabel?" reverse":""))),v=computed((()=>{const t=!0===f.value?"truthy":!0===m.value?"falsy":"indet",n=void 0===r.color||!0!==r.keepColor&&("toggle"===e?!0!==f.value:!0===m.value)?"":` text-${r.color}`;return`q-${e}__inner relative-position non-selectable q-${e}__inner--${t}${n}`})),b=useFormInject(computed((()=>{const e={type:"checkbox"};return void 0!==r.name&&Object.assign(e,{".checked":f.value,"^checked":!0===f.value?"checked":void 0,name:r.name,value:!0===d.value?r.val:r.trueValue}),e}))),w=computed((()=>{const t={tabindex:y.value,role:"toggle"===e?"switch":"checkbox","aria-label":r.label,"aria-checked":!0===g.value?"mixed":!0===f.value?"true":"false"};return!0===r.disable&&(t["aria-disabled"]="true"),t}));function x(e){void 0!==e&&(stopAndPrevent$1(e),u(e)),!0!==r.disable&&i("update:modelValue",function(){if(!0===d.value){if(!0===f.value){const e=r.modelValue.slice();return e.splice(p.value,1),e}return r.modelValue.concat([r.val])}if(!0===f.value){if("ft"!==r.toggleOrder||!1===r.toggleIndeterminate)return r.falseValue}else{if(!0!==m.value)return"ft"!==r.toggleOrder?r.trueValue:r.falseValue;if("ft"===r.toggleOrder||!1===r.toggleIndeterminate)return r.trueValue}return r.indeterminateValue}(),e)}function S(e){13!==e.keyCode&&32!==e.keyCode||stopAndPrevent$1(e)}function E(e){13!==e.keyCode&&32!==e.keyCode||x(e)}const T=t(f,g);return Object.assign(o,{toggle:x}),()=>{const t=T();!0!==r.disable&&b(t,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const i=[h$2("div",{class:v.value,style:h.value,"aria-hidden":"true"},t)];null!==c.value&&i.push(c.value);const o=void 0!==r.label?hMergeSlot(n.default,[r.label]):hSlot(n.default);return void 0!==o&&i.push(h$2("div",{class:`q-${e}__label q-anchor--skip`},o)),h$2("div",{ref:l,class:_.value,...w.value,onClick:x,onKeydown:S,onKeyup:E},i)}}const createBgNode=()=>h$2("div",{key:"svg",class:"q-checkbox__bg absolute"},[h$2("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[h$2("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),h$2("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),QCheckbox=createComponent({name:"QCheckbox",props:useCheckboxProps,emits:useCheckboxEmits,setup(e){const t=createBgNode();return useCheckbox("checkbox",(function(r,n){const i=computed((()=>(!0===r.value?e.checkedIcon:!0===n.value?e.indeterminateIcon:e.uncheckedIcon)||null));return()=>null!==i.value?[h$2("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[h$2(QIcon,{class:"q-checkbox__icon",name:i.value})])]:[t]}))}}),QToggle=createComponent({name:"QToggle",props:{...useCheckboxProps,icon:String,iconColor:String},emits:useCheckboxEmits,setup:e=>useCheckbox("toggle",(function(t,r){const n=computed((()=>(!0===t.value?e.checkedIcon:!0===r.value?e.indeterminateIcon:e.uncheckedIcon)||e.icon)),i=computed((()=>!0===t.value?e.iconColor:null));return()=>[h$2("div",{class:"q-toggle__track"}),h$2("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},void 0!==n.value?[h$2(QIcon,{name:n.value,color:i.value})]:void 0)]}))}),components={radio:QRadio,checkbox:QCheckbox,toggle:QToggle},typeValues=Object.keys(components);function getPropValueFn$1(e,t){if("function"==typeof e)return e;const r=void 0!==e?e:t;return e=>e[r]}const QOptionGroup=createComponent({name:"QOptionGroup",props:{...useDarkProps,modelValue:{required:!0},options:{type:Array,validator:e=>e.every(isObject$2),default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],name:String,type:{type:String,default:"radio",validator:e=>typeValues.includes(e)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{emit:t,slots:r}){const{proxy:{$q:n}}=getCurrentInstance();Array.isArray(e.modelValue);e.type;const i=useDark(e,n),o=computed((()=>components[e.type])),a=computed((()=>getPropValueFn$1(e.optionValue,"value"))),s=computed((()=>getPropValueFn$1(e.optionLabel,"label"))),l=computed((()=>getPropValueFn$1(e.optionDisable,"disable"))),c=computed((()=>e.options.map((t=>({val:a.value(t),name:void 0===t.name?e.name:t.name,disable:e.disable||l.value(t),leftLabel:void 0===t.leftLabel?e.leftLabel:t.leftLabel,color:void 0===t.color?e.color:t.color,checkedIcon:t.checkedIcon,uncheckedIcon:t.uncheckedIcon,dark:void 0===t.dark?i.value:t.dark,size:void 0===t.size?e.size:t.size,dense:e.dense,keepColor:void 0===t.keepColor?e.keepColor:t.keepColor}))))),u=computed((()=>"q-option-group q-gutter-x-sm"+(!0===e.inline?" q-option-group--inline":""))),h=computed((()=>{const t={role:"group"};return"radio"===e.type&&(t.role="radiogroup",!0===e.disable&&(t["aria-disabled"]="true")),t}));function d(e){t("update:modelValue",e)}return()=>h$2("div",{class:u.value,...h.value},e.options.map(((t,n)=>{const i=void 0!==r["label-"+n]?()=>r["label-"+n](t):void 0!==r.label?()=>r.label(t):void 0;return h$2("div",[h$2(o.value,{label:void 0===i?s.value(t):null,modelValue:e.modelValue,"onUpdate:modelValue":d,...c.value[n]},i)])})))}}),DialogPlugin=createComponent({name:"DialogPluginComponent",props:{...useDarkProps,title:String,message:String,prompt:Object,options:Object,progress:[Boolean,Object],html:Boolean,ok:{type:[String,Object,Boolean],default:!0},cancel:[String,Object,Boolean],focus:{type:String,default:"ok",validator:e=>["ok","cancel","none"].includes(e)},stackButtons:Boolean,color:String,cardClass:[String,Array,Object],cardStyle:[String,Array,Object]},emits:["ok","hide"],setup(e,{emit:t}){const{proxy:r}=getCurrentInstance(),{$q:n}=r,i=useDark(e,n),o=ref$1(null),a=ref$1(void 0!==e.prompt?e.prompt.model:void 0!==e.options?e.options.model:void 0),s=computed((()=>"q-dialog-plugin"+(!0===i.value?" q-dialog-plugin--dark q-dark":"")+(!1!==e.progress?" q-dialog-plugin--progress":""))),l=computed((()=>e.color||(!0===i.value?"amber":"primary"))),c=computed((()=>!1===e.progress?null:!0===isObject$2(e.progress)?{component:e.progress.spinner||QSpinner,props:{color:e.progress.color||l.value}}:{component:QSpinner,props:{color:l.value}})),u=computed((()=>void 0!==e.prompt||void 0!==e.options)),h=computed((()=>{if(!0!==u.value)return{};const{model:t,isValid:r,items:n,...i}=void 0!==e.prompt?e.prompt:e.options;return i})),d=computed((()=>!0===isObject$2(e.ok)||!0===e.ok?n.lang.label.ok:e.ok)),p=computed((()=>!0===isObject$2(e.cancel)||!0===e.cancel?n.lang.label.cancel:e.cancel)),f=computed((()=>void 0!==e.prompt?void 0!==e.prompt.isValid&&!0!==e.prompt.isValid(a.value):void 0!==e.options&&(void 0!==e.options.isValid&&!0!==e.options.isValid(a.value)))),m=computed((()=>({color:l.value,label:d.value,ripple:!1,disable:f.value,...!0===isObject$2(e.ok)?e.ok:{flat:!0},"data-autofocus":"ok"===e.focus&&!0!==u.value||void 0,onClick:_}))),g=computed((()=>({color:l.value,label:p.value,ripple:!1,...!0===isObject$2(e.cancel)?e.cancel:{flat:!0},"data-autofocus":"cancel"===e.focus&&!0!==u.value||void 0,onClick:v})));function y(){o.value.hide()}function _(){t("ok",toRaw(a.value)),y()}function v(){y()}function b(){t("hide")}function w(e){a.value=e}function x(t){!0!==f.value&&"textarea"!==e.prompt.type&&!0===isKeyCode(t,13)&&_()}function S(t,r){return!0===e.html?h$2(QCardSection,{class:t,innerHTML:r}):h$2(QCardSection,{class:t},(()=>r))}function E(){return[h$2(QInput,{color:l.value,dense:!0,autofocus:!0,dark:i.value,...h.value,modelValue:a.value,"onUpdate:modelValue":w,onKeyup:x})]}function T(){return[h$2(QOptionGroup,{color:l.value,options:e.options.items,dark:i.value,...h.value,modelValue:a.value,"onUpdate:modelValue":w})]}function A(){const t=[];return e.title&&t.push(S("q-dialog__title",e.title)),!1!==e.progress&&t.push(h$2(QCardSection,{class:"q-dialog__progress"},(()=>h$2(c.value.component,c.value.props)))),e.message&&t.push(S("q-dialog__message",e.message)),void 0!==e.prompt?t.push(h$2(QCardSection,{class:"scroll q-dialog-plugin__form"},E)):void 0!==e.options&&t.push(h$2(QSeparator,{dark:i.value}),h$2(QCardSection,{class:"scroll q-dialog-plugin__form"},T),h$2(QSeparator,{dark:i.value})),(e.ok||e.cancel)&&t.push(function(){const t=[];return e.cancel&&t.push(h$2(QBtn,g.value)),e.ok&&t.push(h$2(QBtn,m.value)),h$2(QCardActions,{class:!0===e.stackButtons?"items-end":"",vertical:e.stackButtons,align:"right"},(()=>t))}()),t}function C(){return[h$2(QCard,{class:[s.value,e.cardClass],style:e.cardStyle,dark:i.value},A)]}return watch$2((()=>e.prompt&&e.prompt.model),w),watch$2((()=>e.options&&e.options.model),w),Object.assign(r,{show:function(){o.value.show()},hide:y}),()=>h$2(QDialog,{ref:o,onHide:b},C)}});function merge$2(e,t){for(const r in t)"spinner"!==r&&Object(t[r])===t[r]?(e[r]=Object(e[r])!==e[r]?{}:{...e[r]},merge$2(e[r],t[r])):e[r]=t[r]}function globalDialog(e,t,r){return t=>{let n,i;const o=void 0!==t.component;if(!0===o){const{component:e,componentProps:o}=t;n="string"==typeof e?r.component(e):e,i=o||{}}else{const{class:r,style:o,...a}=t;n=e,i=a,void 0!==r&&(a.cardClass=r),void 0!==o&&(a.cardStyle=o)}let a,s=!1;const l=ref$1(null),c=createGlobalNode(!1,"dialog"),u=e=>{if(void 0!==l.value?.[e])return void l.value[e]();const t=a.$.subTree;if(t?.component){if(t.component.proxy&&t.component.proxy[e])return void t.component.proxy[e]();if(t.component.subTree&&t.component.subTree.component&&t.component.subTree.component.proxy&&t.component.subTree.component.proxy[e])return void t.component.subTree.component.proxy[e]()}},h=[],d=[],p={onOk:e=>(h.push(e),p),onCancel:e=>(d.push(e),p),onDismiss:e=>(h.push(e),d.push(e),p),hide:()=>(u("hide"),p),update(e){if(null!==a){if(!0===o)Object.assign(i,e);else{const{class:t,style:r,...n}=e;void 0!==t&&(n.cardClass=t),void 0!==r&&(n.cardStyle=r),merge$2(i,n)}a.$forceUpdate()}return p}},f=e=>{s=!0,h.forEach((t=>{t(e)}))},m=()=>{g.unmount(c),removeGlobalNode(c),g=null,a=null,!0!==s&&d.forEach((e=>{e()}))};let g=createChildApp({name:"QGlobalDialog",setup:()=>()=>h$2(n,{...i,ref:l,onOk:f,onHide:m,onVnodeMounted(...e){"function"==typeof i.onVnodeMounted&&i.onVnodeMounted(...e),nextTick((()=>u("show")))}})},r);return a=g.mount(c),p}}const Dialog={install({$q:e,parentApp:t}){e.dialog=this.create=globalDialog(DialogPlugin,!0,t)}},prefixes={};function assignFn(e){Object.assign(Plugin$3,{request:e,exit:e,toggle:e})}function getFullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||null}function updateEl(){const e=Plugin$3.activeEl=!1===Plugin$3.isActive?null:getFullscreenElement();changeGlobalNodesTarget(null===e||e===document.documentElement?document.body:e)}function togglePluginState(){Plugin$3.isActive=!1===Plugin$3.isActive,updateEl()}function promisify(e,t){try{const r=e[t]();return void 0===r?Promise.resolve():r}catch(r){return Promise.reject(r)}}const Plugin$3=createReactivePlugin({isActive:!1,activeEl:null},{isCapable:!1,install({$q:e}){e.fullscreen=this}});prefixes.request=["requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen"].find((e=>void 0!==document.documentElement[e])),Plugin$3.isCapable=void 0!==prefixes.request,!1===Plugin$3.isCapable?assignFn((()=>Promise.reject("Not capable"))):(Object.assign(Plugin$3,{request(e){const t=e||document.documentElement,{activeEl:r}=Plugin$3;if(t===r)return Promise.resolve();return(null!==r&&!0===t.contains(r)?Plugin$3.exit():Promise.resolve()).finally((()=>promisify(t,prefixes.request)))},exit:()=>!0===Plugin$3.isActive?promisify(document,prefixes.exit):Promise.resolve(),toggle:e=>!0===Plugin$3.isActive?Plugin$3.exit():Plugin$3.request(e)}),prefixes.exit=["exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen"].find((e=>document[e])),Plugin$3.isActive=Boolean(getFullscreenElement()),!0===Plugin$3.isActive&&updateEl(),["onfullscreenchange","onmsfullscreenchange","onwebkitfullscreenchange"].forEach((e=>{document[e]=togglePluginState})));let app,vm,uid$2=0,timeout=null,props$1={},activeGroups={};const originalDefaults={group:"__default_quasar_group__",delay:0,message:!1,html:!1,spinnerSize:80,spinnerColor:"",messageColor:"",backgroundColor:"",boxClass:"",spinner:QSpinner,customClass:""},defaults$2={...originalDefaults};function registerProps(e){if(void 0!==e?.group&&void 0!==activeGroups[e.group])return Object.assign(activeGroups[e.group],e);const t=!0===isObject$2(e)&&!0===e.ignoreDefaults?{...originalDefaults,...e}:{...defaults$2,...e};return activeGroups[t.group]=t,t}const Plugin$2=createReactivePlugin({isActive:!1},{show(e){props$1=registerProps(e);const{group:t}=props$1;return Plugin$2.isActive=!0,void 0!==app?(props$1.uid=uid$2,vm.$forceUpdate()):(props$1.uid=++uid$2,null!==timeout&&clearTimeout(timeout),timeout=setTimeout((()=>{timeout=null;const e=createGlobalNode("q-loading");app=createChildApp({name:"QLoading",setup(){function t(){!0!==Plugin$2.isActive&&void 0!==app&&(preventScroll$1(!1),app.unmount(e),removeGlobalNode(e),app=void 0,vm=void 0)}function r(){if(!0!==Plugin$2.isActive)return null;const e=[h$2(props$1.spinner,{class:"q-loading__spinner",color:props$1.spinnerColor,size:props$1.spinnerSize})];return props$1.message&&e.push(h$2("div",{class:"q-loading__message"+(props$1.messageColor?` text-${props$1.messageColor}`:""),[!0===props$1.html?"innerHTML":"textContent"]:props$1.message})),h$2("div",{class:"q-loading fullscreen flex flex-center z-max "+props$1.customClass.trim(),key:props$1.uid},[h$2("div",{class:"q-loading__backdrop"+(props$1.backgroundColor?` bg-${props$1.backgroundColor}`:"")}),h$2("div",{class:"q-loading__box column items-center "+props$1.boxClass},e)])}return onMounted((()=>{preventScroll$1(!0)})),()=>h$2(Transition,{name:"q-transition--fade",appear:!0,onAfterLeave:t},r)}},Plugin$2.__parentApp),vm=app.mount(e)}),props$1.delay)),e=>{void 0!==e&&Object(e)===e?Plugin$2.show({...e,group:t}):Plugin$2.hide(t)}},hide(e){if(!0===Plugin$2.isActive){if(void 0===e)activeGroups={};else{if(void 0===activeGroups[e])return;{delete activeGroups[e];const t=Object.keys(activeGroups);if(0!==t.length){const e=t[t.length-1];return void Plugin$2.show({group:e})}}}null!==timeout&&(clearTimeout(timeout),timeout=null),Plugin$2.isActive=!1}},setDefaults(e){!0===isObject$2(e)&&Object.assign(defaults$2,e)},install({$q:e,parentApp:t}){e.loading=this,Plugin$2.__parentApp=t,void 0!==e.config.loading&&this.setDefaults(e.config.loading)}}),QAvatar=createComponent({name:"QAvatar",props:{...useSizeProps,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:t}){const r=useSize(e),n=computed((()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(!0===e.square?" q-avatar--square":!0===e.rounded?" rounded-borders":""))),i=computed((()=>e.fontSize?{fontSize:e.fontSize}:null));return()=>{const o=void 0!==e.icon?[h$2(QIcon,{name:e.icon})]:void 0;return h$2("div",{class:n.value,style:r.value},[h$2("div",{class:"q-avatar__content row flex-center overflow-hidden",style:i.value},hMergeSlotSafely(t.default,o))])}}});let uid$1=0;const defaults$1={},groups={},notificationsList={},positionClass={},emptyRE=/^\s*$/,notifRefs=[],invalidTimeoutValues=[void 0,null,!0,!1,""],positionList=["top-left","top-right","bottom-left","bottom-right","top","bottom","left","right","center"],badgePositions=["top-left","top-right","bottom-left","bottom-right"],notifTypes={positive:{icon:e=>e.iconSet.type.positive,color:"positive"},negative:{icon:e=>e.iconSet.type.negative,color:"negative"},warning:{icon:e=>e.iconSet.type.warning,color:"warning",textColor:"dark"},info:{icon:e=>e.iconSet.type.info,color:"info"},ongoing:{group:!1,timeout:0,spinner:!0,color:"grey-8"}};function addNotification(e,t,r){if(!e)return logError$1("parameter required");let n;const i={textColor:"white"};if(!0!==e.ignoreDefaults&&Object.assign(i,defaults$1),!1===isObject$2(e)&&(i.type&&Object.assign(i,notifTypes[i.type]),e={message:e}),Object.assign(i,notifTypes[e.type||i.type],e),"function"==typeof i.icon&&(i.icon=i.icon(t)),i.spinner?(!0===i.spinner&&(i.spinner=QSpinner),i.spinner=markRaw(i.spinner)):i.spinner=!1,i.meta={hasMedia:Boolean(!1!==i.spinner||i.icon||i.avatar),hasText:hasContent(i.message)||hasContent(i.caption)},i.position){if(!1===positionList.includes(i.position))return logError$1("wrong position",e)}else i.position="bottom";if(!0===invalidTimeoutValues.includes(i.timeout))i.timeout=5e3;else{const t=Number(i.timeout);if(isNaN(t)||t<0)return logError$1("wrong timeout",e);i.timeout=Number.isFinite(t)?t:0}0===i.timeout?i.progress=!1:!0===i.progress&&(i.meta.progressClass="q-notification__progress"+(i.progressClass?` ${i.progressClass}`:""),i.meta.progressStyle={animationDuration:`${i.timeout+1e3}ms`});const o=(!0===Array.isArray(e.actions)?e.actions:[]).concat(!0!==e.ignoreDefaults&&!0===Array.isArray(defaults$1.actions)?defaults$1.actions:[]).concat(!0===Array.isArray(notifTypes[e.type]?.actions)?notifTypes[e.type].actions:[]),{closeBtn:a}=i;if(a&&o.push({label:"string"==typeof a?a:t.lang.label.close}),i.actions=o.map((({handler:e,noDismiss:t,...r})=>({flat:!0,...r,onClick:"function"==typeof e?()=>{e(),!0!==t&&s()}:()=>{s()}}))),void 0===i.multiLine&&(i.multiLine=i.actions.length>1),Object.assign(i.meta,{class:"q-notification row items-stretch q-notification--"+(!0===i.multiLine?"multi-line":"standard")+(void 0!==i.color?` bg-${i.color}`:"")+(void 0!==i.textColor?` text-${i.textColor}`:"")+(void 0!==i.classes?` ${i.classes}`:""),wrapperClass:"q-notification__wrapper col relative-position border-radius-inherit "+(!0===i.multiLine?"column no-wrap justify-center":"row items-center"),contentClass:"q-notification__content row items-center"+(!0===i.multiLine?"":" col"),leftClass:!0===i.meta.hasText?"additional":"single",attrs:{role:"alert",...i.attrs}}),!1===i.group?(i.group=void 0,i.meta.group=void 0):(void 0!==i.group&&!0!==i.group||(i.group=[i.message,i.caption,i.multiline].concat(i.actions.map((e=>`${e.label}*${e.icon}`))).join("|")),i.meta.group=i.group+"|"+i.position),0===i.actions.length?i.actions=void 0:i.meta.actionsClass="q-notification__actions row items-center "+(!0===i.multiLine?"justify-end":"col-auto")+(!0===i.meta.hasMedia?" q-notification__actions--with-media":""),void 0!==r){r.notif.meta.timer&&(clearTimeout(r.notif.meta.timer),r.notif.meta.timer=void 0),i.meta.uid=r.notif.meta.uid;const e=notificationsList[i.position].value.indexOf(r.notif);notificationsList[i.position].value[e]=i}else{const t=groups[i.meta.group];if(void 0===t){if(i.meta.uid=uid$1++,i.meta.badge=1,-1!==["left","right","center"].indexOf(i.position))notificationsList[i.position].value.splice(Math.floor(notificationsList[i.position].value.length/2),0,i);else{const e=-1!==i.position.indexOf("top")?"unshift":"push";notificationsList[i.position].value[e](i)}void 0!==i.group&&(groups[i.meta.group]=i)}else{if(t.meta.timer&&(clearTimeout(t.meta.timer),t.meta.timer=void 0),void 0!==i.badgePosition){if(!1===badgePositions.includes(i.badgePosition))return logError$1("wrong badgePosition",e)}else i.badgePosition="top-"+(-1!==i.position.indexOf("left")?"right":"left");i.meta.uid=t.meta.uid,i.meta.badge=t.meta.badge+1,i.meta.badgeClass=`q-notification__badge q-notification__badge--${i.badgePosition}`+(void 0!==i.badgeColor?` bg-${i.badgeColor}`:"")+(void 0!==i.badgeTextColor?` text-${i.badgeTextColor}`:"")+(i.badgeClass?` ${i.badgeClass}`:"");const r=notificationsList[i.position].value.indexOf(t);notificationsList[i.position].value[r]=groups[i.meta.group]=i}}const s=()=>{removeNotification(i),n=void 0};return i.timeout>0&&(i.meta.timer=setTimeout((()=>{i.meta.timer=void 0,s()}),i.timeout+1e3)),void 0!==i.group?t=>{void 0!==t?logError$1("trying to update a grouped one which is forbidden",e):s()}:(n={dismiss:s,config:e,notif:i},void 0===r?e=>{if(void 0!==n)if(void 0===e)n.dismiss();else{addNotification(Object.assign({},n.config,e,{group:!1,position:i.position}),t,n)}}:void Object.assign(r,n))}function removeNotification(e){e.meta.timer&&(clearTimeout(e.meta.timer),e.meta.timer=void 0);const t=notificationsList[e.position].value.indexOf(e);if(-1!==t){void 0!==e.group&&delete groups[e.meta.group];const r=notifRefs[""+e.meta.uid];if(r){const{width:e,height:t}=getComputedStyle(r);r.style.left=`${r.offsetLeft}px`,r.style.width=e,r.style.height=t}notificationsList[e.position].value.splice(t,1),"function"==typeof e.onDismiss&&e.onDismiss()}}function hasContent(e){return null!=e&&!0!==emptyRE.test(e)}function logError$1(e,t){return!1}function getComponent(){return createComponent({name:"QNotifications",devtools:{hide:!0},setup:()=>()=>h$2("div",{class:"q-notifications"},positionList.map((e=>h$2(TransitionGroup,{key:e,class:positionClass[e],tag:"div",name:`q-notification--${e}`},(()=>notificationsList[e].value.map((e=>{const t=e.meta,r=[];if(!0===t.hasMedia&&(!1!==e.spinner?r.push(h$2(e.spinner,{class:"q-notification__spinner q-notification__spinner--"+t.leftClass,color:e.spinnerColor,size:e.spinnerSize})):e.icon?r.push(h$2(QIcon,{class:"q-notification__icon q-notification__icon--"+t.leftClass,name:e.icon,color:e.iconColor,size:e.iconSize,role:"img"})):e.avatar&&r.push(h$2(QAvatar,{class:"q-notification__avatar q-notification__avatar--"+t.leftClass},(()=>h$2("img",{src:e.avatar,"aria-hidden":"true"}))))),!0===t.hasText){let t;const n={class:"q-notification__message col"};if(!0===e.html)n.innerHTML=e.caption?`<div>${e.message}</div><div class="q-notification__caption">${e.caption}</div>`:e.message;else{const r=[e.message];t=e.caption?[h$2("div",r),h$2("div",{class:"q-notification__caption"},[e.caption])]:r}r.push(h$2("div",n,t))}const n=[h$2("div",{class:t.contentClass},r)];return!0===e.progress&&n.push(h$2("div",{key:`${t.uid}|p|${t.badge}`,class:t.progressClass,style:t.progressStyle})),void 0!==e.actions&&n.push(h$2("div",{class:t.actionsClass},e.actions.map((e=>h$2(QBtn,e))))),t.badge>1&&n.push(h$2("div",{key:`${t.uid}|${t.badge}`,class:e.meta.badgeClass,style:e.badgeStyle},[t.badge])),h$2("div",{ref:e=>{notifRefs[""+t.uid]=e},key:t.uid,class:t.class,...t.attrs},[h$2("div",{class:t.wrapperClass},n)])})))))))})}const Notify={setDefaults(e){!0===isObject$2(e)&&Object.assign(defaults$1,e)},registerType(e,t){!0===isObject$2(t)&&(notifTypes[e]=t)},install({$q:e,parentApp:t}){if(e.notify=this.create=t=>addNotification(t,e),e.notify.setDefaults=this.setDefaults,e.notify.registerType=this.registerType,void 0!==e.config.notify&&this.setDefaults(e.config.notify),!0!==this.__installed){positionList.forEach((e=>{notificationsList[e]=ref$1([]);const t=!0===["left","center","right"].includes(e)?"center":-1!==e.indexOf("top")?"top":"bottom",r=-1!==e.indexOf("left")?"start":-1!==e.indexOf("right")?"end":"center",n=["left","right"].includes(e)?`items-${"left"===e?"start":"end"} justify-center`:"center"===e?"flex-center":`items-${r}`;positionClass[e]=`q-notifications__list q-notifications__list--${t} fixed column no-wrap ${n}`}));const e=createGlobalNode("q-notify");createChildApp(getComponent(),t).mount(e)}}};var isLocalhost=function(){return Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))},waitWindowLoad;function register$4(e,t){void 0===t&&(t={});var r=t.registrationOptions;void 0===r&&(r={}),delete t.registrationOptions;var n=function(e){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];t&&t[e]&&t[e].apply(t,r)};"serviceWorker"in navigator&&waitWindowLoad.then((function(){isLocalhost()?(checkValidServiceWorker(e,n,r),navigator.serviceWorker.ready.then((function(e){n("ready",e)})).catch((function(e){return handleError$1(n,e)}))):(registerValidSW(e,n,r),navigator.serviceWorker.ready.then((function(e){n("ready",e)})).catch((function(e){return handleError$1(n,e)})))}))}function handleError$1(e,t){navigator.onLine||e("offline"),e("error",t)}function registerValidSW(e,t,r){navigator.serviceWorker.register(e,r).then((function(e){t("registered",e),e.waiting?t("updated",e):e.onupdatefound=function(){t("updatefound",e);var r=e.installing;r.onstatechange=function(){"installed"===r.state&&(navigator.serviceWorker.controller?t("updated",e):t("cached",e))}}})).catch((function(e){return handleError$1(t,e)}))}function checkValidServiceWorker(e,t,r){fetch(e).then((function(n){404===n.status?(t("error",new Error("Service worker not found at "+e)),unregister()):-1===n.headers.get("content-type").indexOf("javascript")?(t("error",new Error("Expected "+e+" to have javascript content-type, but received "+n.headers.get("content-type"))),unregister()):registerValidSW(e,t,r)})).catch((function(e){return handleError$1(t,e)}))}function unregister(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){return handleError$1(emit,e)}))}"undefined"!=typeof window&&(waitWindowLoad="undefined"!=typeof Promise?new Promise((function(e){return window.addEventListener("load",e)})):{then:function(e){return window.addEventListener("load",e)}});const useRatioProps={ratio:[String,Number]};function useRatio(e,t){return computed((()=>{const r=Number(e.ratio||(void 0!==t?t.value:void 0));return!0!==isNaN(r)&&r>0?{paddingBottom:100/r+"%"}:null}))}const defaultRatio=1.7778,QImg=createComponent({name:"QImg",props:{...useRatioProps,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:defaultRatio},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:r}){const n=ref$1(e.initialRatio),i=useRatio(e,n),o=getCurrentInstance(),{registerTimeout:a,removeTimeout:s}=useTimeout(),{registerTimeout:l,removeTimeout:c}=useTimeout(),u=computed((()=>void 0!==e.placeholderSrc?{src:e.placeholderSrc}:null)),h=computed((()=>void 0!==e.errorSrc?{src:e.errorSrc,__qerror:!0}:null)),d=[ref$1(null),ref$1(u.value)],p=ref$1(0),f=ref$1(!1),m=ref$1(!1),g=computed((()=>`q-img q-img--${!0===e.noNativeMenu?"no-":""}menu`)),y=computed((()=>({width:e.width,height:e.height}))),_=computed((()=>`q-img__image ${void 0!==e.imgClass?e.imgClass+" ":""}q-img__image--with${!0===e.noTransition?"out":""}-transition q-img__image--`)),v=computed((()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position})));function b(){c(),f.value=!1}function w({target:e}){!1===vmIsDestroyed(o)&&(s(),n.value=0===e.naturalHeight?.5:e.naturalWidth/e.naturalHeight,x(e,1))}function x(e,t){1e3!==t&&!0!==vmIsDestroyed(o)&&(!0===e.complete?function(e){if(!0===vmIsDestroyed(o))return;p.value=1^p.value,d[p.value].value=null,b(),"true"!==e.getAttribute("__qerror")&&(m.value=!1);r("load",e.currentSrc||e.src)}(e):a((()=>{x(e,t+1)}),50))}function S(e){s(),b(),m.value=!0,d[p.value].value=h.value,d[1^p.value].value=u.value,r("error",e)}function E(t){const r=d[t].value,n={key:"img_"+t,class:_.value,style:v.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...r};return p.value===t?Object.assign(n,{class:n.class+"current",onLoad:w,onError:S}):n.class+="loaded",h$2("div",{class:"q-img__container absolute-full",key:"img"+t},h$2("img",n))}function T(){return!1===f.value?h$2("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},hSlot(t[!0===m.value?"error":"default"])):h$2("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},void 0!==t.loading?t.loading():!0===e.noSpinner?void 0:[h$2(QSpinner,{color:e.spinnerColor,size:e.spinnerSize})])}{let t=function(){watch$2((()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null),(t=>{s(),m.value=!1,null===t?(b(),d[1^p.value].value=u.value):(c(),0!==e.loadingShowDelay?l((()=>{f.value=!0}),e.loadingShowDelay):f.value=!0),d[p.value].value=t}),{immediate:!0})};!0===isRuntimeSsrPreHydration.value?onMounted(t):t()}return()=>{const t=[];return null!==i.value&&t.push(h$2("div",{key:"filler",style:i.value})),null!==d[0].value&&t.push(E(0)),null!==d[1].value&&t.push(E(1)),t.push(h$2(Transition,{name:"q-transition--fade"},T)),h$2("div",{key:"main",class:g.value,style:y.value,role:"img","aria-label":e.alt},t)}}}),usePageStickyProps={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>2===e.length},expand:Boolean};function usePageSticky(){const{props:e,proxy:{$q:t}}=getCurrentInstance(),r=inject(layoutKey,emptyRenderFn);if(r===emptyRenderFn)return emptyRenderFn;const n=computed((()=>{const t=e.position;return{top:-1!==t.indexOf("top"),right:-1!==t.indexOf("right"),bottom:-1!==t.indexOf("bottom"),left:-1!==t.indexOf("left"),vertical:"top"===t||"bottom"===t,horizontal:"left"===t||"right"===t}})),i=computed((()=>r.header.offset)),o=computed((()=>r.right.offset)),a=computed((()=>r.footer.offset)),s=computed((()=>r.left.offset)),l=computed((()=>{let r=0,l=0;const c=n.value,u=!0===t.lang.rtl?-1:1;!0===c.top&&0!==i.value?l=`${i.value}px`:!0===c.bottom&&0!==a.value&&(l=-a.value+"px"),!0===c.left&&0!==s.value?r=u*s.value+"px":!0===c.right&&0!==o.value&&(r=-u*o.value+"px");const h={transform:`translate(${r}, ${l})`};return e.offset&&(h.margin=`${e.offset[1]}px ${e.offset[0]}px`),!0===c.vertical?(0!==s.value&&(h[!0===t.lang.rtl?"right":"left"]=`${s.value}px`),0!==o.value&&(h[!0===t.lang.rtl?"left":"right"]=`${o.value}px`)):!0===c.horizontal&&(0!==i.value&&(h.top=`${i.value}px`),0!==a.value&&(h.bottom=`${a.value}px`)),h})),c=computed((()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${!0===e.expand?"expand":"shrink"}`));return{$layout:r,getStickyContent:function(t){const r=hSlot(t.default);return h$2("div",{class:c.value,style:l.value},!0===e.expand?r:[h$2("div",r)])}}}const QPageSticky=createComponent({name:"QPageSticky",props:usePageStickyProps,setup(e,{slots:t}){const{getStickyContent:r}=usePageSticky();return()=>r(t)}}),QPage=createComponent({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=inject(layoutKey,emptyRenderFn);if(n===emptyRenderFn)return emptyRenderFn;if(inject(pageContainerKey,emptyRenderFn)===emptyRenderFn)return emptyRenderFn;const i=computed((()=>{const t=(!0===n.header.space?n.header.size:0)+(!0===n.footer.space?n.footer.size:0);if("function"==typeof e.styleFn){const i=!0===n.isContainer.value?n.containerHeight.value:r.screen.height;return e.styleFn(t,i)}return{minHeight:!0===n.isContainer.value?n.containerHeight.value-t+"px":0===r.screen.height?0!==t?`calc(100vh - ${t}px)`:"100vh":r.screen.height-t+"px"}})),o=computed((()=>"q-page"+(!0===e.padding?" q-layout-padding":"")));return()=>h$2("main",{class:o.value,style:i.value},hSlot(t.default))}}),ScrollAreaControls=createComponent({props:["store","barStyle","verticalBarStyle","horizontalBarStyle"],setup:e=>()=>[h$2("div",{class:e.store.scroll.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:e.store.onVerticalMousedown}),h$2("div",{class:e.store.scroll.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:e.store.onHorizontalMousedown}),withDirectives(h$2("div",{ref:e.store.scroll.vertical.ref,class:e.store.scroll.vertical.thumbClass.value,style:e.store.scroll.vertical.style.value,"aria-hidden":"true"}),e.store.thumbVertDir),withDirectives(h$2("div",{ref:e.store.scroll.horizontal.ref,class:e.store.scroll.horizontal.thumbClass.value,style:e.store.scroll.horizontal.style.value,"aria-hidden":"true"}),e.store.thumbHorizDir)]});function useHydration(){const e=ref$1(!isRuntimeSsrPreHydration.value);return!1===e.value&&onMounted((()=>{e.value=!0})),{isHydrated:e}}const hasObserver="undefined"!=typeof ResizeObserver,resizeProps=!0===hasObserver?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"},QResizeObserver=createComponent({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(e,{emit:t}){let r,n=null,i={width:-1,height:-1};function o(t){!0===t||0===e.debounce||"0"===e.debounce?a():null===n&&(n=setTimeout(a,e.debounce))}function a(){if(null!==n&&(clearTimeout(n),n=null),r){const{offsetWidth:e,offsetHeight:n}=r;e===i.width&&n===i.height||(i={width:e,height:n},t("resize",i))}}const{proxy:s}=getCurrentInstance();if(s.trigger=o,!0===hasObserver){let e;const t=n=>{r=s.$el.parentNode,r?(e=new ResizeObserver(o),e.observe(r),a()):!0!==n&&nextTick((()=>{t(!0)}))};return onMounted((()=>{t()})),onBeforeUnmount((()=>{null!==n&&clearTimeout(n),void 0!==e&&(void 0!==e.disconnect?e.disconnect():r&&e.unobserve(r))})),noop$2}{let e=function(){null!==n&&(clearTimeout(n),n=null),void 0!==l&&(void 0!==l.removeEventListener&&l.removeEventListener("resize",o,listenOpts$1.passive),l=void 0)},t=function(){e(),r?.contentDocument&&(l=r.contentDocument.defaultView,l.addEventListener("resize",o,listenOpts$1.passive),a())};const{isHydrated:i}=useHydration();let l;return onMounted((()=>{nextTick((()=>{r=s.$el,r&&t()}))})),onBeforeUnmount(e),()=>{if(!0===i.value)return h$2("object",{class:"q--avoid-card-border",style:resizeProps.style,tabindex:-1,type:"text/html",data:resizeProps.url,"aria-hidden":"true",onLoad:t})}}}}),{passive:passive}=listenOpts$1,axisValues=["both","horizontal","vertical"],QScrollObserver=createComponent({name:"QScrollObserver",props:{axis:{type:String,validator:e=>axisValues.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:scrollTargetProp},emits:["scroll"],setup(e,{emit:t}){const r={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let n,i,o=null;function a(){o?.();const i=Math.max(0,getVerticalScrollPosition$1(n)),a=getHorizontalScrollPosition$1(n),s={top:i-r.position.top,left:a-r.position.left};if("vertical"===e.axis&&0===s.top||"horizontal"===e.axis&&0===s.left)return;const l=Math.abs(s.top)>=Math.abs(s.left)?s.top<0?"up":"down":s.left<0?"left":"right";r.position={top:i,left:a},r.directionChanged=r.direction!==l,r.delta=s,!0===r.directionChanged&&(r.direction=l,r.inflectionPoint=r.position),t("scroll",{...r})}function s(){n=getScrollTarget(i,e.scrollTarget),n.addEventListener("scroll",c,passive),c(!0)}function l(){void 0!==n&&(n.removeEventListener("scroll",c,passive),n=void 0)}function c(t){if(!0===t||0===e.debounce||"0"===e.debounce)a();else if(null===o){const[t,r]=e.debounce?[setTimeout(a,e.debounce),clearTimeout]:[requestAnimationFrame(a),cancelAnimationFrame];o=()=>{r(t),o=null}}}watch$2((()=>e.scrollTarget),(()=>{l(),s()}));const{proxy:u}=getCurrentInstance();return watch$2((()=>u.$q.lang.rtl),a),onMounted((()=>{i=u.$el.parentNode,s()})),onBeforeUnmount((()=>{o?.(),l()})),Object.assign(u,{trigger:c,getPosition:()=>r}),noop$2}}),modifiersAll={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},directionList=Object.keys(modifiersAll);function getModifierDirections(e){const t={};for(const r of directionList)!0===e[r]&&(t[r]=!0);return 0===Object.keys(t).length?modifiersAll:(!0===t.horizontal?t.left=t.right=!0:!0===t.left&&!0===t.right&&(t.horizontal=!0),!0===t.vertical?t.up=t.down=!0:!0===t.up&&!0===t.down&&(t.vertical=!0),!0===t.horizontal&&!0===t.vertical&&(t.all=!0),t)}modifiersAll.all=!0;const avoidNodeNamesList=["INPUT","TEXTAREA"];function shouldStart(e,t){return void 0===t.event&&void 0!==e.target&&!0!==e.target.draggable&&"function"==typeof t.handler&&!1===avoidNodeNamesList.includes(e.target.nodeName.toUpperCase())&&(void 0===e.qClonedBy||-1===e.qClonedBy.indexOf(t.uid))}function clearSelection(){if(void 0!==window.getSelection){const e=window.getSelection();void 0!==e.empty?e.empty():void 0!==e.removeAllRanges&&(e.removeAllRanges(),!0!==Platform.is.mobile&&e.addRange(document.createRange()))}else void 0!==document.selection&&document.selection.empty()}function getChanges(e,t,r){const n=position(e);let i,o=n.left-t.event.x,a=n.top-t.event.y,s=Math.abs(o),l=Math.abs(a);const c=t.direction;!0===c.horizontal&&!0!==c.vertical?i=o<0?"left":"right":!0!==c.horizontal&&!0===c.vertical?i=a<0?"up":"down":!0===c.up&&a<0?(i="up",s>l&&(!0===c.left&&o<0?i="left":!0===c.right&&o>0&&(i="right"))):!0===c.down&&a>0?(i="down",s>l&&(!0===c.left&&o<0?i="left":!0===c.right&&o>0&&(i="right"))):!0===c.left&&o<0?(i="left",s<l&&(!0===c.up&&a<0?i="up":!0===c.down&&a>0&&(i="down"))):!0===c.right&&o>0&&(i="right",s<l&&(!0===c.up&&a<0?i="up":!0===c.down&&a>0&&(i="down")));let u=!1;if(void 0===i&&!1===r){if(!0===t.event.isFirst||void 0===t.event.lastDir)return{};i=t.event.lastDir,u=!0,"left"===i||"right"===i?(n.left-=o,s=0,o=0):(n.top-=a,l=0,a=0)}return{synthetic:u,payload:{evt:e,touch:!0!==t.event.mouse,mouse:!0===t.event.mouse,position:n,direction:i,isFirst:t.event.isFirst,isFinal:!0===r,duration:Date.now()-t.event.time,distance:{x:s,y:l},offset:{x:o,y:a},delta:{x:n.left-t.event.lastX,y:n.top-t.event.lastY}}}}let uid=0;const TouchPan=createDirective({name:"touch-pan",beforeMount(e,{value:t,modifiers:r}){if(!0!==r.mouse&&!0!==client.has.touch)return;function n(e,t){!0===r.mouse&&!0===t?stopAndPrevent$1(e):(!0===r.stop&&stop$1(e),!0===r.prevent&&prevent(e))}const i={uid:"qvtp_"+uid++,handler:t,modifiers:r,direction:getModifierDirections(r),noop:noop$2,mouseStart(e){shouldStart(e,i)&&leftClick(e)&&(addEvt(i,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),i.start(e,!0))},touchStart(e){if(shouldStart(e,i)){const t=e.target;addEvt(i,"temp",[[t,"touchmove","move","notPassiveCapture"],[t,"touchcancel","end","passiveCapture"],[t,"touchend","end","passiveCapture"]]),i.start(e)}},start(t,n){if(!0===client.is.firefox&&preventDraggable(e,!0),i.lastEvt=t,!0===n||!0===r.stop){if(!0!==i.direction.all&&(!0!==n||!0!==i.modifiers.mouseAllDir&&!0!==i.modifiers.mousealldir)){const e=-1!==t.type.indexOf("mouse")?new MouseEvent(t.type,t):new TouchEvent(t.type,t);!0===t.defaultPrevented&&prevent(e),!0===t.cancelBubble&&stop$1(e),Object.assign(e,{qKeyEvent:t.qKeyEvent,qClickOutside:t.qClickOutside,qAnchorHandled:t.qAnchorHandled,qClonedBy:void 0===t.qClonedBy?[i.uid]:t.qClonedBy.concat(i.uid)}),i.initialEvent={target:t.target,event:e}}stop$1(t)}const{left:o,top:a}=position(t);i.event={x:o,y:a,time:Date.now(),mouse:!0===n,detected:!1,isFirst:!0,isFinal:!1,lastX:o,lastY:a}},move(e){if(void 0===i.event)return;const t=position(e),o=t.left-i.event.x,a=t.top-i.event.y;if(0===o&&0===a)return;i.lastEvt=e;const s=!0===i.event.mouse,l=()=>{let t;n(e,s),!0!==r.preserveCursor&&!0!==r.preservecursor&&(t=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),!0===s&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),clearSelection(),i.styleCleanup=e=>{if(i.styleCleanup=void 0,void 0!==t&&(document.documentElement.style.cursor=t),document.body.classList.remove("non-selectable"),!0===s){const t=()=>{document.body.classList.remove("no-pointer-events--children")};void 0!==e?setTimeout((()=>{t(),e()}),50):t()}else void 0!==e&&e()}};if(!0===i.event.detected){!0!==i.event.isFirst&&n(e,i.event.mouse);const{payload:t,synthetic:r}=getChanges(e,i,!1);return void(void 0!==t&&(!1===i.handler(t)?i.end(e):(void 0===i.styleCleanup&&!0===i.event.isFirst&&l(),i.event.lastX=t.position.left,i.event.lastY=t.position.top,i.event.lastDir=!0===r?void 0:t.direction,i.event.isFirst=!1)))}if(!0===i.direction.all||!0===s&&(!0===i.modifiers.mouseAllDir||!0===i.modifiers.mousealldir))return l(),i.event.detected=!0,void i.move(e);const c=Math.abs(o),u=Math.abs(a);c!==u&&(!0===i.direction.horizontal&&c>u||!0===i.direction.vertical&&c<u||!0===i.direction.up&&c<u&&a<0||!0===i.direction.down&&c<u&&a>0||!0===i.direction.left&&c>u&&o<0||!0===i.direction.right&&c>u&&o>0?(i.event.detected=!0,i.move(e)):i.end(e,!0))},end(t,r){if(void 0!==i.event){if(cleanEvt(i,"temp"),!0===client.is.firefox&&preventDraggable(e,!1),!0===r)i.styleCleanup?.(),!0!==i.event.detected&&void 0!==i.initialEvent&&i.initialEvent.target.dispatchEvent(i.initialEvent.event);else if(!0===i.event.detected){!0===i.event.isFirst&&i.handler(getChanges(void 0===t?i.lastEvt:t,i).payload);const{payload:e}=getChanges(void 0===t?i.lastEvt:t,i,!0),r=()=>{i.handler(e)};void 0!==i.styleCleanup?i.styleCleanup(r):r()}i.event=void 0,i.initialEvent=void 0,i.lastEvt=void 0}}};if(e.__qtouchpan=i,!0===r.mouse){const t=!0===r.mouseCapture||!0===r.mousecapture?"Capture":"";addEvt(i,"main",[[e,"mousedown","mouseStart",`passive${t}`]])}!0===client.has.touch&&addEvt(i,"main",[[e,"touchstart","touchStart","passive"+(!0===r.capture?"Capture":"")],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const r=e.__qtouchpan;void 0!==r&&(t.oldValue!==t.value&&("function"!=typeof value&&r.end(),r.handler=t.value),r.direction=getModifierDirections(t.modifiers))},beforeUnmount(e){const t=e.__qtouchpan;void 0!==t&&(void 0!==t.event&&t.end(),cleanEvt(t,"main"),cleanEvt(t,"temp"),!0===client.is.firefox&&preventDraggable(e,!1),t.styleCleanup?.(),delete e.__qtouchpan)}}),axisList=["vertical","horizontal"],dirProps={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},panOpts={prevent:!0,mouse:!0,mouseAllDir:!0},getMinThumbSize=e=>e>=250?50:Math.ceil(e/5),QScrollArea=createComponent({name:"QScrollArea",props:{...useDarkProps,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],verticalOffset:{type:Array,default:[0,0]},horizontalOffset:{type:Array,default:[0,0]},contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:t,emit:r}){const n=ref$1(!1),i=ref$1(!1),o=ref$1(!1),a={vertical:ref$1(0),horizontal:ref$1(0)},s={vertical:{ref:ref$1(null),position:ref$1(0),size:ref$1(0)},horizontal:{ref:ref$1(null),position:ref$1(0),size:ref$1(0)}},{proxy:l}=getCurrentInstance(),c=useDark(e,l.$q);let u,h=null;const d=ref$1(null),p=computed((()=>"q-scrollarea"+(!0===c.value?" q-scrollarea--dark":"")));Object.assign(a,{verticalInner:computed((()=>a.vertical.value-e.verticalOffset[0]-e.verticalOffset[1])),horizontalInner:computed((()=>a.horizontal.value-e.horizontalOffset[0]-e.horizontalOffset[1]))}),s.vertical.percentage=computed((()=>{const e=s.vertical.size.value-a.vertical.value;if(e<=0)return 0;const t=between$1(s.vertical.position.value/e,0,1);return Math.round(1e4*t)/1e4})),s.vertical.thumbHidden=computed((()=>!0!==(null===e.visible?o.value:e.visible)&&!1===n.value&&!1===i.value||s.vertical.size.value<=a.vertical.value+1)),s.vertical.thumbStart=computed((()=>e.verticalOffset[0]+s.vertical.percentage.value*(a.verticalInner.value-s.vertical.thumbSize.value))),s.vertical.thumbSize=computed((()=>Math.round(between$1(a.verticalInner.value*a.verticalInner.value/s.vertical.size.value,getMinThumbSize(a.verticalInner.value),a.verticalInner.value)))),s.vertical.style=computed((()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${s.vertical.thumbStart.value}px`,height:`${s.vertical.thumbSize.value}px`,right:`${e.horizontalOffset[1]}px`}))),s.vertical.thumbClass=computed((()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(!0===s.vertical.thumbHidden.value?" q-scrollarea__thumb--invisible":""))),s.vertical.barClass=computed((()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(!0===s.vertical.thumbHidden.value?" q-scrollarea__bar--invisible":""))),s.horizontal.percentage=computed((()=>{const e=s.horizontal.size.value-a.horizontal.value;if(e<=0)return 0;const t=between$1(Math.abs(s.horizontal.position.value)/e,0,1);return Math.round(1e4*t)/1e4})),s.horizontal.thumbHidden=computed((()=>!0!==(null===e.visible?o.value:e.visible)&&!1===n.value&&!1===i.value||s.horizontal.size.value<=a.horizontal.value+1)),s.horizontal.thumbStart=computed((()=>e.horizontalOffset[0]+s.horizontal.percentage.value*(a.horizontalInner.value-s.horizontal.thumbSize.value))),s.horizontal.thumbSize=computed((()=>Math.round(between$1(a.horizontalInner.value*a.horizontalInner.value/s.horizontal.size.value,getMinThumbSize(a.horizontalInner.value),a.horizontalInner.value)))),s.horizontal.style=computed((()=>({...e.thumbStyle,...e.horizontalThumbStyle,[!0===l.$q.lang.rtl?"right":"left"]:`${s.horizontal.thumbStart.value}px`,width:`${s.horizontal.thumbSize.value}px`,bottom:`${e.verticalOffset[1]}px`}))),s.horizontal.thumbClass=computed((()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(!0===s.horizontal.thumbHidden.value?" q-scrollarea__thumb--invisible":""))),s.horizontal.barClass=computed((()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(!0===s.horizontal.thumbHidden.value?" q-scrollarea__bar--invisible":"")));const f=computed((()=>!0===s.vertical.thumbHidden.value&&!0===s.horizontal.thumbHidden.value?e.contentStyle:e.contentActiveStyle));function m(){const e={};return axisList.forEach((t=>{const r=s[t];Object.assign(e,{[t+"Position"]:r.position.value,[t+"Percentage"]:r.percentage.value,[t+"Size"]:r.size.value,[t+"ContainerSize"]:a[t].value,[t+"ContainerInnerSize"]:a[t+"Inner"].value})})),e}const g=debounce$1((()=>{const e=m();e.ref=l,r("scroll",e)}),0);function y(e,t,r){if(!1===axisList.includes(e))return;("vertical"===e?setVerticalScrollPosition:setHorizontalScrollPosition)(d.value,t,r)}function _({height:e,width:t}){let r=!1;a.vertical.value!==e&&(a.vertical.value=e,r=!0),a.horizontal.value!==t&&(a.horizontal.value=t,r=!0),!0===r&&S()}function v({position:e}){let t=!1;s.vertical.position.value!==e.top&&(s.vertical.position.value=e.top,t=!0),s.horizontal.position.value!==e.left&&(s.horizontal.position.value=e.left,t=!0),!0===t&&S()}function b({height:e,width:t}){s.horizontal.size.value!==t&&(s.horizontal.size.value=t,S()),s.vertical.size.value!==e&&(s.vertical.size.value=e,S())}function w(e,t){const r=s[t];if(!0===e.isFirst){if(!0===r.thumbHidden.value)return;u=r.position.value,i.value=!0}else if(!0!==i.value)return;!0===e.isFinal&&(i.value=!1);const n=dirProps[t],o=(r.size.value-a[t].value)/(a[t+"Inner"].value-r.thumbSize.value),l=e.distance[n.dist];E(u+(e.direction===n.dir?1:-1)*l*o,t)}function x(t,r){const n=s[r];if(!0!==n.thumbHidden.value){const i="vertical"===r?e.verticalOffset[0]:e.horizontalOffset[0],o=t[dirProps[r].offset]-i,s=n.thumbStart.value-i;if(o<s||o>s+n.thumbSize.value){E(between$1((o-n.thumbSize.value/2)/(a[r+"Inner"].value-n.thumbSize.value),0,1)*Math.max(0,n.size.value-a[r].value),r)}null!==n.ref.value&&n.ref.value.dispatchEvent(new MouseEvent(t.type,t))}}function S(){n.value=!0,null!==h&&clearTimeout(h),h=setTimeout((()=>{h=null,n.value=!1}),e.delay),void 0!==e.onScroll&&g()}function E(e,t){d.value[dirProps[t].scroll]=e}let T=null;function A(){null!==T&&clearTimeout(T),T=setTimeout((()=>{T=null,o.value=!0}),l.$q.platform.is.ios?50:0)}function C(){null!==T&&(clearTimeout(T),T=null),o.value=!1}let I=null;watch$2((()=>l.$q.lang.rtl),(e=>{null!==d.value&&setHorizontalScrollPosition(d.value,Math.abs(s.horizontal.position.value)*(!0===e?-1:1))})),onDeactivated((()=>{I={top:s.vertical.position.value,left:s.horizontal.position.value}})),onActivated((()=>{if(null===I)return;const e=d.value;null!==e&&(setHorizontalScrollPosition(e,I.left),setVerticalScrollPosition(e,I.top))})),onBeforeUnmount(g.cancel),Object.assign(l,{getScrollTarget:()=>d.value,getScroll:m,getScrollPosition:()=>({top:s.vertical.position.value,left:s.horizontal.position.value}),getScrollPercentage:()=>({top:s.vertical.percentage.value,left:s.horizontal.percentage.value}),setScrollPosition:y,setScrollPercentage(e,t,r){y(e,t*(s[e].size.value-a[e].value)*("horizontal"===e&&!0===l.$q.lang.rtl?-1:1),r)}});const k={scroll:s,thumbVertDir:[[TouchPan,e=>{w(e,"vertical")},void 0,{vertical:!0,...panOpts}]],thumbHorizDir:[[TouchPan,e=>{w(e,"horizontal")},void 0,{horizontal:!0,...panOpts}]],onVerticalMousedown(e){x(e,"vertical")},onHorizontalMousedown(e){x(e,"horizontal")}};return()=>h$2("div",{class:p.value,onMouseenter:A,onMouseleave:C},[h$2("div",{ref:d,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:void 0!==e.tabindex?e.tabindex:void 0},[h$2("div",{class:"q-scrollarea__content absolute",style:f.value},hMergeSlot(t.default,[h$2(QResizeObserver,{debounce:0,onResize:b})])),h$2(QScrollObserver,{axis:"both",onScroll:v})]),h$2(QResizeObserver,{debounce:0,onResize:_}),h$2(ScrollAreaControls,{store:k,barStyle:e.barStyle,verticalBarStyle:e.verticalBarStyle,horizontalBarStyle:e.horizontalBarStyle})])}});function encode$1(e){return!0===isDate(e)?"__q_date|"+e.getTime():!0===isRegexp(e)?"__q_expr|"+e.source:"number"==typeof e?"__q_numb|"+e:"boolean"==typeof e?"__q_bool|"+(e?"1":"0"):"string"==typeof e?"__q_strn|"+e:"function"==typeof e?"__q_strn|"+e.toString():e===Object(e)?"__q_objt|"+JSON.stringify(e):e}function decode$1(e){if(e.length<9)return e;const t=e.substring(0,8),r=e.substring(9);switch(t){case"__q_date":const t=Number(r);return new Date(!0===Number.isNaN(t)?r:t);case"__q_expr":return new RegExp(r);case"__q_numb":return Number(r);case"__q_bool":return Boolean("1"===r);case"__q_strn":return""+r;case"__q_objt":return JSON.parse(r);default:return e}}function getEmptyStorage(){const e=()=>null;return{has:()=>!1,hasItem:()=>!1,getLength:()=>0,getItem:e,getIndex:e,getKey:e,getAll:()=>{},getAllKeys:()=>[],set:noop$2,setItem:noop$2,remove:noop$2,removeItem:noop$2,clear:noop$2,isEmpty:()=>!0}}function getStorage(e){const t=window[e+"Storage"],r=e=>{const r=t.getItem(e);return r?decode$1(r):null},n=e=>null!==t.getItem(e),i=(e,r)=>{t.setItem(e,encode$1(r))},o=e=>{t.removeItem(e)};return{has:n,hasItem:n,getLength:()=>t.length,getItem:r,getIndex:e=>e<t.length?r(t.key(e)):null,getKey:e=>e<t.length?t.key(e):null,getAll:()=>{let e;const n={},i=t.length;for(let o=0;o<i;o++)e=t.key(o),n[e]=r(e);return n},getAllKeys:()=>{const e=[],r=t.length;for(let n=0;n<r;n++)e.push(t.key(n));return e},set:i,setItem:i,remove:o,removeItem:o,clear:()=>{t.clear()},isEmpty:()=>0===t.length}}const storage=!1===client.has.webStorage?getEmptyStorage():getStorage("session"),Plugin$1={install({$q:e}){e.sessionStorage=storage}};Object.assign(Plugin$1,storage);const QItemSection=createComponent({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:t}){const r=computed((()=>"q-item__section column q-item__section--"+(!0===e.avatar||!0===e.side||!0===e.thumbnail?"side":"main")+(!0===e.top?" q-item__section--top justify-start":" justify-center")+(!0===e.avatar?" q-item__section--avatar":"")+(!0===e.thumbnail?" q-item__section--thumbnail":"")+(!0===e.noWrap?" q-item__section--nowrap":"")));return()=>h$2("div",{class:r.value},hSlot(t.default))}}),QItem=createComponent({name:"QItem",props:{...useDarkProps,...useRouterLinkProps,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=useDark(e,n),{hasLink:o,linkAttrs:a,linkClass:s,linkTag:l,navigateOnClick:c}=useRouterLink(),u=ref$1(null),h=ref$1(null),d=computed((()=>!0===e.clickable||!0===o.value||"label"===e.tag)),p=computed((()=>!0!==e.disable&&!0===d.value)),f=computed((()=>"q-item q-item-type row no-wrap"+(!0===e.dense?" q-item--dense":"")+(!0===i.value?" q-item--dark":"")+(!0===o.value&&null===e.active?s.value:!0===e.active?" q-item--active"+(void 0!==e.activeClass?` ${e.activeClass}`:""):"")+(!0===e.disable?" disabled":"")+(!0===p.value?" q-item--clickable q-link cursor-pointer "+(!0===e.manualFocus?"q-manual-focusable":"q-focusable q-hoverable")+(!0===e.focused?" q-manual-focusable--focused":""):""))),m=computed((()=>{if(void 0===e.insetLevel)return null;const t=!0===n.lang.rtl?"Right":"Left";return{["padding"+t]:16+56*e.insetLevel+"px"}}));function g(e){!0===p.value&&(null!==h.value&&!0!==e.qAvoidFocus&&(!0!==e.qKeyEvent&&document.activeElement===u.value?h.value.focus():document.activeElement===h.value&&u.value.focus()),c(e))}function y(e){if(!0===p.value&&!0===isKeyCode(e,[13,32])){stopAndPrevent$1(e),e.qKeyEvent=!0;const t=new MouseEvent("click",e);t.qKeyEvent=!0,u.value.dispatchEvent(t)}r("keyup",e)}return()=>{const r={ref:u,class:f.value,style:m.value,role:"listitem",onClick:g,onKeyup:y};return!0===p.value?(r.tabindex=e.tabindex||"0",Object.assign(r,a.value)):!0===d.value&&(r["aria-disabled"]="true"),h$2(l.value,r,function(){const e=hUniqueSlot(t.default,[]);return!0===p.value&&e.unshift(h$2("div",{class:"q-focus-helper",tabindex:-1,ref:h})),e}())}}}),roleAttrExceptions=["ul","ol"],QList=createComponent({name:"QList",props:{...useDarkProps,bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},setup(e,{slots:t}){const r=getCurrentInstance(),n=useDark(e,r.proxy.$q),i=computed((()=>roleAttrExceptions.includes(e.tag)?null:"list")),o=computed((()=>"q-list"+(!0===e.bordered?" q-list--bordered":"")+(!0===e.dense?" q-list--dense":"")+(!0===e.separator?" q-list--separator":"")+(!0===n.value?" q-list--dark":"")+(!0===e.padding?" q-list--padding":"")));return()=>h$2(e.tag,{class:o.value,role:i.value},hSlot(t.default))}}),useAnchorStaticProps={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},useAnchorProps={...useAnchorStaticProps,contextMenu:Boolean};function useAnchor({showing:e,avoidEmit:t,configureAnchorEl:r}){const{props:n,proxy:i,emit:o}=getCurrentInstance(),a=ref$1(null);let s=null;function l(e){return null!==a.value&&(void 0===e||void 0===e.touches||e.touches.length<=1)}const c={};function u(){cleanEvt(c,"anchor")}function h(){if(!1===n.target||""===n.target||null===i.$el.parentNode)a.value=null;else if(!0===n.target)!function(e){for(a.value=e;a.value.classList.contains("q-anchor--skip");)a.value=a.value.parentNode;r()}(i.$el.parentNode);else{let t=n.target;if("string"==typeof n.target)try{t=document.querySelector(n.target)}catch(e){t=void 0}null!=t?(a.value=t.$el||t,r()):a.value=null}}return void 0===r&&(Object.assign(c,{hide(e){i.hide(e)},toggle(e){i.toggle(e),e.qAnchorHandled=!0},toggleKey(e){!0===isKeyCode(e,13)&&c.toggle(e)},contextClick(e){i.hide(e),prevent(e),nextTick((()=>{i.show(e),e.qAnchorHandled=!0}))},prevent:prevent,mobileTouch(e){if(c.mobileCleanup(e),!0!==l(e))return;i.hide(e),a.value.classList.add("non-selectable");const t=e.target;addEvt(c,"anchor",[[t,"touchmove","mobileCleanup","passive"],[t,"touchend","mobileCleanup","passive"],[t,"touchcancel","mobileCleanup","passive"],[a.value,"contextmenu","prevent","notPassive"]]),s=setTimeout((()=>{s=null,i.show(e),e.qAnchorHandled=!0}),300)},mobileCleanup(t){a.value.classList.remove("non-selectable"),null!==s&&(clearTimeout(s),s=null),!0===e.value&&void 0!==t&&clearSelection()}}),r=function(e=n.contextMenu){if(!0===n.noParentEvent||null===a.value)return;let t;t=!0===e?!0===i.$q.platform.is.mobile?[[a.value,"touchstart","mobileTouch","passive"]]:[[a.value,"mousedown","hide","passive"],[a.value,"contextmenu","contextClick","notPassive"]]:[[a.value,"click","toggle","passive"],[a.value,"keyup","toggleKey","passive"]],addEvt(c,"anchor",t)}),watch$2((()=>n.contextMenu),(e=>{null!==a.value&&(u(),r(e))})),watch$2((()=>n.target),(()=>{null!==a.value&&u(),h()})),watch$2((()=>n.noParentEvent),(e=>{null!==a.value&&(!0===e?u():r())})),onMounted((()=>{h(),!0!==t&&!0===n.modelValue&&null===a.value&&o("update:modelValue",!1)})),onBeforeUnmount((()=>{null!==s&&clearTimeout(s),u()})),{anchorEl:a,canShow:l,anchorEvents:c}}function useScrollTarget(e,t){const r=ref$1(null);let n;function i(e,t){const r=(void 0!==t?"add":"remove")+"EventListener",i=void 0!==t?t:n;e!==window&&e[r]("scroll",i,listenOpts$1.passive),window[r]("scroll",i,listenOpts$1.passive),n=t}function o(){null!==r.value&&(i(r.value),r.value=null)}const a=watch$2((()=>e.noParentEvent),(()=>{null!==r.value&&(o(),t())}));return onBeforeUnmount(a),{localScrollTarget:r,unconfigureScrollTarget:o,changeScrollEvent:i}}const{notPassiveCapture:notPassiveCapture}=listenOpts$1,registeredList=[];function globalHandler(e){const t=e.target;if(void 0===t||8===t.nodeType||!0===t.classList.contains("no-pointer-events"))return;let r=portalProxyList.length-1;for(;r>=0;){const e=portalProxyList[r].$;if("QTooltip"!==e.type.name){if("QDialog"!==e.type.name)break;if(!0!==e.props.seamless)return;r--}else r--}for(let n=registeredList.length-1;n>=0;n--){const r=registeredList[n];if(null!==r.anchorEl.value&&!1!==r.anchorEl.value.contains(t)||t!==document.body&&(null===r.innerRef.value||!1!==r.innerRef.value.contains(t)))return;e.qClickOutside=!0,r.onClickOutside(e)}}function addClickOutside(e){registeredList.push(e),1===registeredList.length&&(document.addEventListener("mousedown",globalHandler,notPassiveCapture),document.addEventListener("touchstart",globalHandler,notPassiveCapture))}function removeClickOutside(e){const t=registeredList.findIndex((t=>t===e));-1!==t&&(registeredList.splice(t,1),0===registeredList.length&&(document.removeEventListener("mousedown",globalHandler,notPassiveCapture),document.removeEventListener("touchstart",globalHandler,notPassiveCapture)))}let vpLeft,vpTop;function validatePosition(e){const t=e.split(" ");return 2===t.length&&(!0===["top","center","bottom"].includes(t[0])&&!0===["left","middle","right","start","end"].includes(t[1]))}function validateOffset(e){return!e||2===e.length&&("number"==typeof e[0]&&"number"==typeof e[1])}const horizontalPos={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};function parsePosition(e,t){const r=e.split(" ");return{vertical:r[0],horizontal:horizontalPos[`${r[1]}#${!0===t?"rtl":"ltr"}`]}}function getAnchorProps(e,t){let{top:r,left:n,right:i,bottom:o,width:a,height:s}=e.getBoundingClientRect();return void 0!==t&&(r-=t[1],n-=t[0],o+=t[1],i+=t[0],a+=t[0],s+=t[1]),{top:r,bottom:o,height:s,left:n,right:i,width:a,middle:n+(i-n)/2,center:r+(o-r)/2}}function getAbsoluteAnchorProps(e,t,r){let{top:n,left:i}=e.getBoundingClientRect();return n+=t.top,i+=t.left,void 0!==r&&(n+=r[1],i+=r[0]),{top:n,bottom:n+1,height:1,left:i,right:i+1,width:1,middle:i,center:n}}function getTargetProps(e,t){return{top:0,center:t/2,bottom:t,left:0,middle:e/2,right:e}}function getTopLeftProps(e,t,r,n){return{top:e[r.vertical]-t[n.vertical],left:e[r.horizontal]-t[n.horizontal]}}function setPosition(e,t=0){if(null===e.targetEl||null===e.anchorEl||t>5)return;if(0===e.targetEl.offsetHeight||0===e.targetEl.offsetWidth)return void setTimeout((()=>{setPosition(e,t+1)}),10);const{targetEl:r,offset:n,anchorEl:i,anchorOrigin:o,selfOrigin:a,absoluteOffset:s,fit:l,cover:c,maxHeight:u,maxWidth:h}=e;if(!0===client.is.ios&&void 0!==window.visualViewport){const e=document.body.style,{offsetLeft:t,offsetTop:r}=window.visualViewport;t!==vpLeft&&(e.setProperty("--q-pe-left",t+"px"),vpLeft=t),r!==vpTop&&(e.setProperty("--q-pe-top",r+"px"),vpTop=r)}const{scrollLeft:d,scrollTop:p}=r,f=void 0===s?getAnchorProps(i,!0===c?[0,0]:n):getAbsoluteAnchorProps(i,s,n);Object.assign(r.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:h,maxHeight:u,visibility:"visible"});const{offsetWidth:m,offsetHeight:g}=r,{elWidth:y,elHeight:_}=!0===l||!0===c?{elWidth:Math.max(f.width,m),elHeight:!0===c?Math.max(f.height,g):g}:{elWidth:m,elHeight:g};let v={maxWidth:h,maxHeight:u};!0!==l&&!0!==c||(v.minWidth=f.width+"px",!0===c&&(v.minHeight=f.height+"px")),Object.assign(r.style,v);const b=getTargetProps(y,_);let w=getTopLeftProps(f,b,o,a);if(void 0===s||void 0===n)applyBoundaries(w,f,b,o,a);else{const{top:e,left:t}=w;applyBoundaries(w,f,b,o,a);let r=!1;if(w.top!==e){r=!0;const e=2*n[1];f.center=f.top-=e,f.bottom-=e+2}if(w.left!==t){r=!0;const e=2*n[0];f.middle=f.left-=e,f.right-=e+2}!0===r&&(w=getTopLeftProps(f,b,o,a),applyBoundaries(w,f,b,o,a))}v={top:w.top+"px",left:w.left+"px"},void 0!==w.maxHeight&&(v.maxHeight=w.maxHeight+"px",f.height>w.maxHeight&&(v.minHeight=v.maxHeight)),void 0!==w.maxWidth&&(v.maxWidth=w.maxWidth+"px",f.width>w.maxWidth&&(v.minWidth=v.maxWidth)),Object.assign(r.style,v),r.scrollTop!==p&&(r.scrollTop=p),r.scrollLeft!==d&&(r.scrollLeft=d)}function applyBoundaries(e,t,r,n,i){const o=r.bottom,a=r.right,s=getScrollbarWidth(),l=window.innerHeight-s,c=document.body.clientWidth;if(e.top<0||e.top+o>l)if("center"===i.vertical)e.top=t[n.vertical]>l/2?Math.max(0,l-o):0,e.maxHeight=Math.min(o,l);else if(t[n.vertical]>l/2){const r=Math.min(l,"center"===n.vertical?t.center:n.vertical===i.vertical?t.bottom:t.top);e.maxHeight=Math.min(o,r),e.top=Math.max(0,r-o)}else e.top=Math.max(0,"center"===n.vertical?t.center:n.vertical===i.vertical?t.top:t.bottom),e.maxHeight=Math.min(o,l-e.top);if(e.left<0||e.left+a>c)if(e.maxWidth=Math.min(a,c),"middle"===i.horizontal)e.left=t[n.horizontal]>c/2?Math.max(0,c-a):0;else if(t[n.horizontal]>c/2){const r=Math.min(c,"middle"===n.horizontal?t.middle:n.horizontal===i.horizontal?t.right:t.left);e.maxWidth=Math.min(a,r),e.left=Math.max(0,r-e.maxWidth)}else e.left=Math.max(0,"middle"===n.horizontal?t.middle:n.horizontal===i.horizontal?t.left:t.right),e.maxWidth=Math.min(a,c-e.left)}["left","middle","right"].forEach((e=>{horizontalPos[`${e}#ltr`]=e,horizontalPos[`${e}#rtl`]=e}));const QMenu=createComponent({name:"QMenu",inheritAttrs:!1,props:{...useAnchorProps,...useModelToggleProps,...useDarkProps,...useTransitionProps,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:validatePosition},self:{type:String,validator:validatePosition},offset:{type:Array,validator:validateOffset},scrollTarget:scrollTargetProp,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...useModelToggleEmits,"click","escapeKey"],setup(e,{slots:t,emit:r,attrs:n}){let i,o,a,s=null;const l=getCurrentInstance(),{proxy:c}=l,{$q:u}=c,h=ref$1(null),d=ref$1(!1),p=computed((()=>!0!==e.persistent&&!0!==e.noRouteDismiss)),f=useDark(e,u),{registerTick:m,removeTick:g}=useTick(),{registerTimeout:y}=useTimeout(),{transitionProps:_,transitionStyle:v}=useTransition(e),{localScrollTarget:b,changeScrollEvent:w,unconfigureScrollTarget:x}=useScrollTarget(e,$),{anchorEl:S,canShow:E}=useAnchor({showing:d}),{hide:T}=useModelToggle({showing:d,canShow:E,handleShow:function(t){if(s=!1===e.noRefocus?document.activeElement:null,addFocusout(F),A(),$(),i=void 0,void 0!==t&&(e.touchPosition||e.contextMenu)){const e=position(t);if(void 0!==e.left){const{top:t,left:r}=S.value.getBoundingClientRect();i={left:e.left-r,top:e.top-t}}}void 0===o&&(o=watch$2((()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl),N));!0!==e.noFocus&&document.activeElement.blur();m((()=>{N(),!0!==e.noFocus&&L()})),y((()=>{!0===u.platform.is.ios&&(a=e.autoClose,h.value.click()),N(),A(!0),r("show",t)}),e.transitionDuration)},handleHide:function(t){g(),C(),B(!0),null===s||void 0!==t&&!0===t.qClickOutside||(((0===t?.type.indexOf("key")?s.closest('[tabindex]:not([tabindex^="-"])'):void 0)||s).focus(),s=null);y((()=>{C(!0),r("hide",t)}),e.transitionDuration)},hideOnRouteChange:p,processOnMount:!0}),{showPortal:A,hidePortal:C,renderPortal:I}=usePortal(l,h,(function(){return h$2(Transition,_.value,(()=>!0===d.value?h$2("div",{role:"menu",...n,ref:h,tabindex:-1,class:["q-menu q-position-engine scroll"+R.value,n.class],style:[n.style,v.value],...D.value},hSlot(t.default)):null))}),"menu"),k={anchorEl:S,innerRef:h,onClickOutside(t){if(!0!==e.persistent&&!0===d.value)return T(t),("touchstart"===t.type||t.target.classList.contains("q-dialog__backdrop"))&&stopAndPrevent$1(t),!0}},P=computed((()=>parsePosition(e.anchor||(!0===e.cover?"center middle":"bottom start"),u.lang.rtl))),M=computed((()=>!0===e.cover?P.value:parsePosition(e.self||"top start",u.lang.rtl))),R=computed((()=>(!0===e.square?" q-menu--square":"")+(!0===f.value?" q-menu--dark q-dark":""))),D=computed((()=>!0===e.autoClose?{onClick:z}:{})),O=computed((()=>!0===d.value&&!0!==e.persistent));function L(){addFocusFn((()=>{let e=h.value;e&&!0!==e.contains(document.activeElement)&&(e=e.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||e.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||e.querySelector("[autofocus], [data-autofocus]")||e,e.focus({preventScroll:!0}))}))}function B(e){i=void 0,void 0!==o&&(o(),o=void 0),!0!==e&&!0!==d.value||(removeFocusout(F),x(),removeClickOutside(k),removeEscapeKey(q)),!0!==e&&(s=null)}function $(){null===S.value&&void 0===e.scrollTarget||(b.value=getScrollTarget(S.value,e.scrollTarget),w(b.value,N))}function z(e){!0!==a?(closePortalMenus(c,e),r("click",e)):a=!1}function F(t){!0===O.value&&!0!==e.noFocus&&!0!==childHasFocus(h.value,t.target)&&L()}function q(t){!0!==e.noEscDismiss&&(r("escapeKey"),T(t))}function N(){setPosition({targetEl:h.value,offset:e.offset,anchorEl:S.value,anchorOrigin:P.value,selfOrigin:M.value,absoluteOffset:i,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}return watch$2(O,(e=>{!0===e?(addEscapeKey(q),addClickOutside(k)):(removeEscapeKey(q),removeClickOutside(k))})),onBeforeUnmount(B),Object.assign(c,{focus:L,updatePosition:N}),I}});function getDepth(e){if(!1===e)return 0;if(!0===e||void 0===e)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}const ClosePopup=createDirective({name:"close-popup",beforeMount(e,{value:t}){const r={depth:getDepth(t),handler(t){0!==r.depth&&setTimeout((()=>{const n=getPortalProxy(e);void 0!==n&&closePortals(n,t,r.depth)}))},handlerKey(e){!0===isKeyCode(e,13)&&r.handler(e)}};e.__qclosepopup=r,e.addEventListener("click",r.handler),e.addEventListener("keyup",r.handlerKey)},updated(e,{value:t,oldValue:r}){t!==r&&(e.__qclosepopup.depth=getDepth(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var DEFAULT_FONT_SIZE=12,DEFAULT_FONT_FAMILY="sans-serif",DEFAULT_FONT=DEFAULT_FONT_SIZE+"px "+DEFAULT_FONT_FAMILY,OFFSET=20,SCALE=100,defaultWidthMapStr="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function getTextWidthMap(e){var t={};if("undefined"==typeof JSON)return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-OFFSET)/SCALE;t[n]=i}return t}var DEFAULT_TEXT_WIDTH_MAP=getTextWidthMap(defaultWidthMapStr),platformApi={createCanvas:function(){return"undefined"!=typeof document&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=platformApi.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||DEFAULT_FONT),e.measureText(r);r=r||"";var o=/((?:\d+)?\.?\d*)px/.exec(n=n||DEFAULT_FONT),a=o&&+o[1]||DEFAULT_FONT_SIZE,s=0;if(n.indexOf("mono")>=0)s=a*r.length;else for(var l=0;l<r.length;l++){var c=DEFAULT_TEXT_WIDTH_MAP[r[l]];s+=null==c?a:c*a}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},BUILTIN_OBJECT=reduce(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],(function(e,t){return e["[object "+t+"]"]=!0,e}),{}),TYPED_ARRAY=reduce(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],(function(e,t){return e["[object "+t+"Array]"]=!0,e}),{}),objToString=Object.prototype.toString,arrayProto=Array.prototype,nativeForEach=arrayProto.forEach,nativeFilter=arrayProto.filter,nativeSlice=arrayProto.slice,nativeMap=arrayProto.map,ctorFunction=function(){}.constructor,protoFunction=ctorFunction?ctorFunction.prototype:null,protoKey="__proto__",idStart=2311;function guid(){return idStart++}function logError(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function clone$4(e){if(null==e||"object"!=typeof e)return e;var t=e,r=objToString.call(e);if("[object Array]"===r){if(!isPrimitive(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=clone$4(e[n])}}else if(TYPED_ARRAY[r]){if(!isPrimitive(e)){var o=e.constructor;if(o.from)t=o.from(e);else{t=new o(e.length);for(n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!BUILTIN_OBJECT[r]&&!isPrimitive(e)&&!isDom(e))for(var a in t={},e)e.hasOwnProperty(a)&&a!==protoKey&&(t[a]=clone$4(e[a]));return t}function merge$1(e,t,r){if(!isObject$1(t)||!isObject$1(e))return r?clone$4(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==protoKey){var i=e[n],o=t[n];!isObject$1(o)||!isObject$1(i)||isArray(o)||isArray(i)||isDom(o)||isDom(i)||isBuiltInObject(o)||isBuiltInObject(i)||isPrimitive(o)||isPrimitive(i)?!r&&n in e||(e[n]=clone$4(t[n])):merge$1(i,o,r)}return e}function mergeAll(e,t){for(var r=e[0],n=1,i=e.length;n<i;n++)r=merge$1(r,e[n],t);return r}function extend$1(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==protoKey&&(e[r]=t[r]);return e}function defaults(e,t,r){for(var n=keys(t),i=0,o=n.length;i<o;i++){var a=n[i];null==e[a]&&(e[a]=t[a])}return e}function indexOf(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function inherits(e,t){var r=e.prototype;function n(){}for(var i in n.prototype=t.prototype,e.prototype=new n,r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function mixin(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var o=n[i];"constructor"!==o&&null==e[o]&&(e[o]=t[o])}else defaults(e,t)}function isArrayLike(e){return!!e&&("string"!=typeof e&&"number"==typeof e.length)}function each(e,t,r){if(e&&t)if(e.forEach&&e.forEach===nativeForEach)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var o in e)e.hasOwnProperty(o)&&t.call(r,e[o],o,e)}function map$1(e,t,r){if(!e)return[];if(!t)return slice(e);if(e.map&&e.map===nativeMap)return e.map(t,r);for(var n=[],i=0,o=e.length;i<o;i++)n.push(t.call(r,e[i],i,e));return n}function reduce(e,t,r,n){if(e&&t){for(var i=0,o=e.length;i<o;i++)r=t.call(n,r,e[i],i,e);return r}}function filter(e,t,r){if(!e)return[];if(!t)return slice(e);if(e.filter&&e.filter===nativeFilter)return e.filter(t,r);for(var n=[],i=0,o=e.length;i<o;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function find(e,t,r){if(e&&t)for(var n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e))return e[n]}function keys(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function bindPolyfill(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(nativeSlice.call(arguments)))}}var bind=protoFunction&&isFunction(protoFunction.bind)?protoFunction.call.bind(protoFunction.bind):bindPolyfill;function curry(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(nativeSlice.call(arguments)))}}function isArray(e){return Array.isArray?Array.isArray(e):"[object Array]"===objToString.call(e)}function isFunction(e){return"function"==typeof e}function isString(e){return"string"==typeof e}function isStringSafe(e){return"[object String]"===objToString.call(e)}function isNumber$1(e){return"number"==typeof e}function isObject$1(e){var t=typeof e;return"function"===t||!!e&&"object"===t}function isBuiltInObject(e){return!!BUILTIN_OBJECT[objToString.call(e)]}function isTypedArray(e){return!!TYPED_ARRAY[objToString.call(e)]}function isDom(e){return"object"==typeof e&&"number"==typeof e.nodeType&&"object"==typeof e.ownerDocument}function isGradientObject(e){return null!=e.colorStops}function isImagePatternObject(e){return null!=e.image}function isRegExp(e){return"[object RegExp]"===objToString.call(e)}function eqNaN(e){return e!=e}function retrieve(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(null!=e[r])return e[r]}function retrieve2(e,t){return null!=e?e:t}function retrieve3(e,t,r){return null!=e?e:null!=t?t:r}function slice(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return nativeSlice.apply(e,t)}function normalizeCssArray(e){if("number"==typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function assert$1(e,t){if(!e)throw new Error(t)}function trim(e){return null==e?null:"function"==typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var primitiveKey="__ec_primitive__";function setAsPrimitive(e){e[primitiveKey]=!0}function isPrimitive(e){return e[primitiveKey]}var MapPolyfill=function(){function e(){this.data={}}return e.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},e.prototype.has=function(e){return this.data.hasOwnProperty(e)},e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){return this.data[e]=t,this},e.prototype.keys=function(){return keys(this.data)},e.prototype.forEach=function(e){var t=this.data;for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},e}(),isNativeMapSupported="function"==typeof Map;function maybeNativeMap(){return isNativeMapSupported?new Map:new MapPolyfill}var HashMap=function(){function e(t){var r=isArray(t);this.data=maybeNativeMap();var n=this;function i(e,t){r?n.set(e,t):n.set(t,e)}t instanceof e?t.each(i):t&&each(t,i)}return e.prototype.hasKey=function(e){return this.data.has(e)},e.prototype.get=function(e){return this.data.get(e)},e.prototype.set=function(e,t){return this.data.set(e,t),t},e.prototype.each=function(e,t){this.data.forEach((function(r,n){e.call(t,r,n)}))},e.prototype.keys=function(){var e=this.data.keys();return isNativeMapSupported?Array.from(e):e},e.prototype.removeKey=function(e){this.data.delete(e)},e}();function createHashMap(e){return new HashMap(e)}function concatArray(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];var i=e.length;for(n=0;n<t.length;n++)r[n+i]=t[n];return r}function createObject(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&extend$1(r,t),r}function disableUserSelect(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function hasOwn(e,t){return e.hasOwnProperty(t)}function noop(){}var RADIAN_TO_DEGREE=180/Math.PI,Browser=function(){return function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}}(),Env=function(){return function(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!=typeof window}}(),env=new Env;function detect(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),o=e.match(/Edge?\/([\d.]+)/),a=/micromessenger/i.test(e);if(n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),o&&(r.edge=!0,r.version=o[1],r.newEdge=+o[1].split(".")[0]>18),a&&(r.weChat=!0),t.svgSupported="undefined"!=typeof SVGRect,t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported="undefined"!=typeof document){var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}}"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(env.wxa=!0,env.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?env.worker=!0:!env.hasGlobalWindow||"Deno"in window||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Node.js")>-1?(env.node=!0,env.svgSupported=!0):detect(navigator.userAgent,env);var Entry=function(){return function(e){this.value=e}}(),LinkedList=function(){function e(){this._len=0}return e.prototype.insert=function(e){var t=new Entry(e);return this.insertEntry(t),t},e.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},e.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),LRU=function(){function e(e){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=e}return e.prototype.put=function(e,t){var r=this._list,n=this._map,i=null;if(null==n[e]){var o=r.len(),a=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var s=r.head;r.remove(s),delete n[s.key],i=s.value,this._lastRemovedEntry=s}a?a.value=t:a=new Entry(t),a.key=e,r.insertEntry(a),n[e]=a}return i},e.prototype.get=function(e){var t=this._map[e],r=this._list;if(null!=t)return t!==r.tail&&(r.remove(t),r.insertEntry(t)),t.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),globalImageCache=new LRU(50);function findExistImage(e){if("string"==typeof e){var t=globalImageCache.get(e);return t&&t.image}return e}function createOrUpdateImage(e,t,r,n,i){if(e){if("string"==typeof e){if(t&&t.__zrImageSrc===e||!r)return t;var o=globalImageCache.get(e),a={hostEl:r,cb:n,cbPayload:i};return o?!isImageReady(t=o.image)&&o.pending.push(a):((t=platformApi.loadImage(e,imageOnLoad,imageOnLoad)).__zrImageSrc=e,globalImageCache.put(e,t.__cachedImgObj={image:t,pending:[a]})),t}return e}return t}function imageOnLoad(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function isImageReady(e){return e&&e.width&&e.height}function create$1(){return[1,0,0,1,0,0]}function identity(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function copy$2(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function mul(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],o=t[0]*r[2]+t[2]*r[3],a=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e}function translate(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function rotate(e,t,r,n){void 0===n&&(n=[0,0]);var i=t[0],o=t[2],a=t[4],s=t[1],l=t[3],c=t[5],u=Math.sin(r),h=Math.cos(r);return e[0]=i*h+s*u,e[1]=-i*u+s*h,e[2]=o*h+l*u,e[3]=-o*u+h*l,e[4]=h*(a-n[0])+u*(c-n[1])+n[0],e[5]=h*(c-n[1])-u*(a-n[0])+n[1],e}function scale$1(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function invert(e,t){var r=t[0],n=t[2],i=t[4],o=t[1],a=t[3],s=t[5],l=r*a-o*n;return l?(l=1/l,e[0]=a*l,e[1]=-o*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-a*i)*l,e[5]=(o*i-r*s)*l,e):null}var Point$2=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(e,t){return this.x=e,this.y=t,this},e.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},e.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},e.prototype.distanceSquare=function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(e){if(e){var t=this.x,r=this.y;return this.x=e[0]*t+e[2]*r+e[4],this.y=e[1]*t+e[3]*r+e[5],this}},e.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},e.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},e.set=function(e,t,r){e.x=t,e.y=r},e.copy=function(e,t){e.x=t.x,e.y=t.y},e.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.lenSquare=function(e){return e.x*e.x+e.y*e.y},e.dot=function(e,t){return e.x*t.x+e.y*t.y},e.add=function(e,t,r){e.x=t.x+r.x,e.y=t.y+r.y},e.sub=function(e,t,r){e.x=t.x-r.x,e.y=t.y-r.y},e.scale=function(e,t,r){e.x=t.x*r,e.y=t.y*r},e.scaleAndAdd=function(e,t,r,n){e.x=t.x+r.x*n,e.y=t.y+r.y*n},e.lerp=function(e,t,r,n){var i=1-n;e.x=i*t.x+n*r.x,e.y=i*t.y+n*r.y},e}(),mathMin$4=Math.min,mathMax$4=Math.max,mathAbs$3=Math.abs,XY=["x","y"],WH=["width","height"],lt$2=new Point$2,rb=new Point$2,lb=new Point$2,rt$1=new Point$2,_intersectCtx$1=createIntersectContext(),_minTv$1=_intersectCtx$1.minTv,_maxTv$1=_intersectCtx$1.maxTv,_lenMinMax=[0,0],BoundingRect=function(){function e(t,r,n,i){e.set(this,t,r,n,i)}return e.set=function(e,t,r,n,i){return n<0&&(t+=n,n=-n),i<0&&(r+=i,i=-i),e.x=t,e.y=r,e.width=n,e.height=i,e},e.prototype.union=function(e){var t=mathMin$4(e.x,this.x),r=mathMin$4(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax$4(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax$4(e.y+e.height,this.y+this.height)-r:this.height=e.height,this.x=t,this.y=r},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(e){var t=this,r=e.width/t.width,n=e.height/t.height,i=create$1();return translate(i,i,[-t.x,-t.y]),scale$1(i,i,[r,n]),translate(i,i,[e.x,e.y]),i},e.prototype.intersect=function(t,r,n){return e.intersect(this,t,r,n)},e.intersect=function(t,r,n,i){n&&Point$2.set(n,0,0);var o=i&&i.outIntersectRect||null,a=i&&i.clamp;if(o&&(o.x=o.y=o.width=o.height=NaN),!t||!r)return!1;t instanceof e||(t=e.set(_tmpIntersectA,t.x,t.y,t.width,t.height)),r instanceof e||(r=e.set(_tmpIntersectB,r.x,r.y,r.width,r.height));var s=!!n;_intersectCtx$1.reset(i,s);var l=_intersectCtx$1.touchThreshold,c=t.x+l,u=t.x+t.width-l,h=t.y+l,d=t.y+t.height-l,p=r.x+l,f=r.x+r.width-l,m=r.y+l,g=r.y+r.height-l;if(c>u||h>d||p>f||m>g)return!1;var y=!(u<p||f<c||d<m||g<h);return(s||o)&&(_lenMinMax[0]=1/0,_lenMinMax[1]=0,intersectOneDim(c,u,p,f,0,s,o,a),intersectOneDim(h,d,m,g,1,s,o,a),s&&Point$2.copy(n,y?_intersectCtx$1.useDir?_intersectCtx$1.dirMinTv:_minTv$1:_maxTv$1)),y},e.contain=function(e,t,r){return t>=e.x&&t<=e.x+e.width&&r>=e.y&&r<=e.y+e.height},e.prototype.contain=function(t,r){return e.contain(this,t,r)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return 0===this.width||0===this.height},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(e,t){return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e},e.applyTransform=function(t,r,n){if(n){if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],o=n[3],a=n[4],s=n[5];return t.x=r.x*i+a,t.y=r.y*o+s,t.width=r.width*i,t.height=r.height*o,t.width<0&&(t.x+=t.width,t.width=-t.width),void(t.height<0&&(t.y+=t.height,t.height=-t.height))}lt$2.x=lb.x=r.x,lt$2.y=rt$1.y=r.y,rb.x=rt$1.x=r.x+r.width,rb.y=lb.y=r.y+r.height,lt$2.transform(n),rt$1.transform(n),rb.transform(n),lb.transform(n),t.x=mathMin$4(lt$2.x,rb.x,lb.x,rt$1.x),t.y=mathMin$4(lt$2.y,rb.y,lb.y,rt$1.y);var l=mathMax$4(lt$2.x,rb.x,lb.x,rt$1.x),c=mathMax$4(lt$2.y,rb.y,lb.y,rt$1.y);t.width=l-t.x,t.height=c-t.y}else t!==r&&e.copy(t,r)},e}(),_tmpIntersectA=new BoundingRect(0,0,0,0),_tmpIntersectB=new BoundingRect(0,0,0,0),_fontMeasureInfoCache;function intersectOneDim(e,t,r,n,i,o,a,s){var l=mathAbs$3(t-r),c=mathAbs$3(n-e),u=mathMin$4(l,c),h=XY[i],d=XY[1-i],p=WH[i];t<r||n<e?l<c?(o&&(_maxTv$1[h]=-l),s&&(a[h]=t,a[p]=0)):(o&&(_maxTv$1[h]=c),s&&(a[h]=e,a[p]=0)):(a&&(a[h]=mathMax$4(e,r),a[p]=mathMin$4(t,n)-a[h]),o&&(u<_lenMinMax[0]||_intersectCtx$1.useDir)&&(_lenMinMax[0]=mathMin$4(u,_lenMinMax[0]),(l<c||!_intersectCtx$1.bidirectional)&&(_minTv$1[h]=l,_minTv$1[d]=0,_intersectCtx$1.useDir&&_intersectCtx$1.calcDirMTV()),(l>=c||!_intersectCtx$1.bidirectional)&&(_minTv$1[h]=-c,_minTv$1[d]=0,_intersectCtx$1.useDir&&_intersectCtx$1.calcDirMTV())))}function createIntersectContext(){var e=0,t=new Point$2,r=new Point$2,n={minTv:new Point$2,maxTv:new Point$2,useDir:!1,dirMinTv:new Point$2,touchThreshold:0,bidirectional:!0,negativeSize:!1,reset:function(i,o){n.touchThreshold=0,i&&null!=i.touchThreshold&&(n.touchThreshold=mathMax$4(0,i.touchThreshold)),n.negativeSize=!1,o&&(n.minTv.set(1/0,1/0),n.maxTv.set(0,0),n.useDir=!1,i&&null!=i.direction&&(n.useDir=!0,n.dirMinTv.copy(n.minTv),r.copy(n.minTv),e=i.direction,n.bidirectional=null==i.bidirectional||!!i.bidirectional,n.bidirectional||t.set(Math.cos(e),Math.sin(e))))},calcDirMTV:function(){var o=n.minTv,a=n.dirMinTv,s=o.y*o.y+o.x*o.x,l=Math.sin(e),c=Math.cos(e),u=l*o.y+c*o.x;i(u)?i(o.x)&&i(o.y)&&a.set(0,0):(r.x=s*c/u,r.y=s*l/u,i(r.x)&&i(r.y)?a.set(0,0):(n.bidirectional||t.dot(r)>0)&&r.len()<a.len()&&a.copy(r))}};function i(e){return mathAbs$3(e)<1e-10}return n}function ensureFontMeasureInfo(e){_fontMeasureInfoCache||(_fontMeasureInfoCache=new LRU(100)),e=e||DEFAULT_FONT;var t=_fontMeasureInfoCache.get(e);return t||(t={font:e,strWidthCache:new LRU(500),asciiWidthMap:null,asciiWidthMapTried:!1,stWideCharWidth:platformApi.measureText("",e).width,asciiCharWidth:platformApi.measureText("a",e).width},_fontMeasureInfoCache.put(e,t)),t}function tryCreateASCIIWidthMap(e){if(!(_getASCIIWidthMapLongCount>=GET_ASCII_WIDTH_LONG_COUNT_MAX)){e=e||DEFAULT_FONT;for(var t=[],r=+new Date,n=0;n<=127;n++)t[n]=platformApi.measureText(String.fromCharCode(n),e).width;var i=+new Date-r;return i>16?_getASCIIWidthMapLongCount=GET_ASCII_WIDTH_LONG_COUNT_MAX:i>2&&_getASCIIWidthMapLongCount++,t}}var _getASCIIWidthMapLongCount=0,GET_ASCII_WIDTH_LONG_COUNT_MAX=5;function measureCharWidth(e,t){return e.asciiWidthMapTried||(e.asciiWidthMap=tryCreateASCIIWidthMap(e.font),e.asciiWidthMapTried=!0),0<=t&&t<=127?null!=e.asciiWidthMap?e.asciiWidthMap[t]:e.asciiCharWidth:e.stWideCharWidth}function measureWidth(e,t){var r=e.strWidthCache,n=r.get(t);return null==n&&(n=platformApi.measureText(t,e.font).width,r.put(t,n)),n}function innerGetBoundingRect(e,t,r,n){var i=measureWidth(ensureFontMeasureInfo(t),e),o=getLineHeight(t),a=adjustTextX(0,i,r),s=adjustTextY(0,o,n);return new BoundingRect(a,s,i,o)}function getBoundingRect(e,t,r,n){var i=((e||"")+"").split("\n");if(1===i.length)return innerGetBoundingRect(i[0],t,r,n);for(var o=new BoundingRect(0,0,0,0),a=0;a<i.length;a++){var s=innerGetBoundingRect(i[a],t,r,n);0===a?o.copy(s):o.union(s)}return o}function adjustTextX(e,t,r,n){return"right"===r?n?e+=t:e-=t:"center"===r&&(n?e+=t/2:e-=t/2),e}function adjustTextY(e,t,r,n){return"middle"===r?n?e+=t/2:e-=t/2:"bottom"===r&&(n?e+=t:e-=t),e}function getLineHeight(e){return ensureFontMeasureInfo(e).stWideCharWidth}function parsePercent(e,t){return"string"==typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function calculateTextPosition(e,t,r){var n=t.position||"inside",i=null!=t.distance?t.distance:5,o=r.height,a=r.width,s=o/2,l=r.x,c=r.y,u="left",h="top";if(n instanceof Array)l+=parsePercent(n[0],r.width),c+=parsePercent(n[1],r.height),u=null,h=null;else switch(n){case"left":l-=i,c+=s,u="right",h="middle";break;case"right":l+=i+a,c+=s,h="middle";break;case"top":l+=a/2,c-=i,u="center",h="bottom";break;case"bottom":l+=a/2,c+=o+i,u="center";break;case"inside":l+=a/2,c+=s,u="center",h="middle";break;case"insideLeft":l+=i,c+=s,h="middle";break;case"insideRight":l+=a-i,c+=s,u="right",h="middle";break;case"insideTop":l+=a/2,c+=i,u="center";break;case"insideBottom":l+=a/2,c+=o-i,u="center",h="bottom";break;case"insideTopLeft":l+=i,c+=i;break;case"insideTopRight":l+=a-i,c+=i,u="right";break;case"insideBottomLeft":l+=i,c+=o-i,h="bottom";break;case"insideBottomRight":l+=a-i,c+=o-i,u="right",h="bottom"}return(e=e||{}).x=l,e.y=c,e.align=u,e.verticalAlign=h,e}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText2(e,t,r,n,i,o){if(!r)return e.text="",void(e.isTruncated=!1);var a=(t+"").split("\n");o=prepareTruncateOptions(r,n,i,o);for(var s=!1,l={},c=0,u=a.length;c<u;c++)truncateSingleLine(l,a[c],o),a[c]=l.textLine,s=s||l.isTruncated;e.text=a.join("\n"),e.isTruncated=s}function prepareTruncateOptions(e,t,r,n){var i=extend$1({},n=n||{});r=retrieve2(r,"..."),i.maxIterations=retrieve2(n.maxIterations,2);var o=i.minChar=retrieve2(n.minChar,0),a=i.fontMeasureInfo=ensureFontMeasureInfo(t),s=a.asciiCharWidth;i.placeholder=retrieve2(n.placeholder,"");for(var l=e=Math.max(0,e-1),c=0;c<o&&l>=s;c++)l-=s;var u=measureWidth(a,r);return u>l&&(r="",u=0),l=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=l,i.containerWidth=e,i}function truncateSingleLine(e,t,r){var n=r.containerWidth,i=r.contentWidth,o=r.fontMeasureInfo;if(!n)return e.textLine="",void(e.isTruncated=!1);var a=measureWidth(o,t);if(a<=n)return e.textLine=t,void(e.isTruncated=!1);for(var s=0;;s++){if(a<=i||s>=r.maxIterations){t+=r.ellipsis;break}var l=0===s?estimateLength(t,i,o):a>0?Math.floor(t.length*i/a):0;a=measureWidth(o,t=t.substr(0,l))}""===t&&(t=r.placeholder),e.textLine=t,e.isTruncated=!0}function estimateLength(e,t,r){for(var n=0,i=0,o=e.length;i<o&&n<t;i++)n+=measureCharWidth(r,e.charCodeAt(i));return i}function parsePlainText(e,t,r,n){var i=formatText(e),o=t.overflow,a=t.padding,s=a?a[1]+a[3]:0,l=a?a[0]+a[2]:0,c=t.font,u="truncate"===o,h=getLineHeight(c),d=retrieve2(t.lineHeight,h),p="truncate"===t.lineOverflow,f=!1,m=t.width;null==m&&null!=r&&(m=r-s);var g,y=t.height;null==y&&null!=n&&(y=n-l);var _=(g=null==m||"break"!==o&&"breakAll"!==o?i?i.split("\n"):[]:i?wrapText(i,t.font,m,"breakAll"===o,0).lines:[]).length*d;if(null==y&&(y=_),_>y&&p){var v=Math.floor(y/d);f=f||g.length>v,_=(g=g.slice(0,v)).length*d}if(i&&u&&null!=m)for(var b=prepareTruncateOptions(m,c,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),w={},x=0;x<g.length;x++)truncateSingleLine(w,g[x],b),g[x]=w.textLine,f=f||w.isTruncated;var S=y,E=0,T=ensureFontMeasureInfo(c);for(x=0;x<g.length;x++)E=Math.max(measureWidth(T,g[x]),E);null==m&&(m=E);var A=m;return{lines:g,height:y,outerWidth:A+=s,outerHeight:S+=l,lineHeight:d,calculatedLineHeight:h,contentWidth:E,contentHeight:_,width:m,isTruncated:f}}var RichTextToken=function(){return function(){}}(),RichTextLine=function(){return function(e){this.tokens=[],e&&(this.tokens=e)}}(),RichTextContentBlock=function(){return function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}}();function parseRichText(e,t,r,n,i){var o=new RichTextContentBlock,a=formatText(e);if(!a)return o;var s=t.padding,l=s?s[1]+s[3]:0,c=s?s[0]+s[2]:0,u=t.width;null==u&&null!=r&&(u=r-l);var h=t.height;null==h&&null!=n&&(h=n-c);for(var d,p=t.overflow,f="break"!==p&&"breakAll"!==p||null==u?null:{width:u,accumWidth:0,breakAll:"breakAll"===p},m=STYLE_REG.lastIndex=0;null!=(d=STYLE_REG.exec(a));){var g=d.index;g>m&&pushTokens(o,a.substring(m,g),t,f),pushTokens(o,d[2],t,f,d[1]),m=STYLE_REG.lastIndex}m<a.length&&pushTokens(o,a.substring(m,a.length),t,f);var y=[],_=0,v=0,b="truncate"===p,w="truncate"===t.lineOverflow,x={};function S(e,t,r){e.width=t,e.lineHeight=r,_+=r,v=Math.max(v,t)}e:for(var E=0;E<o.lines.length;E++){for(var T=o.lines[E],A=0,C=0,I=0;I<T.tokens.length;I++){var k=(q=T.tokens[I]).styleName&&t.rich[q.styleName]||{},P=q.textPadding=k.padding,M=P?P[1]+P[3]:0,R=q.font=k.font||t.font;q.contentHeight=getLineHeight(R);var D=retrieve2(k.height,q.contentHeight);if(q.innerHeight=D,P&&(D+=P[0]+P[2]),q.height=D,q.lineHeight=retrieve3(k.lineHeight,t.lineHeight,D),q.align=k&&k.align||i,q.verticalAlign=k&&k.verticalAlign||"middle",w&&null!=h&&_+q.lineHeight>h){var O=o.lines.length;I>0?(T.tokens=T.tokens.slice(0,I),S(T,C,A),o.lines=o.lines.slice(0,E+1)):o.lines=o.lines.slice(0,E),o.isTruncated=o.isTruncated||o.lines.length<O;break e}var L=k.width,B=null==L||"auto"===L;if("string"==typeof L&&"%"===L.charAt(L.length-1))q.percentWidth=L,y.push(q),q.contentWidth=measureWidth(ensureFontMeasureInfo(R),q.text);else{if(B){var $=k.backgroundColor,z=$&&$.image;z&&isImageReady(z=findExistImage(z))&&(q.width=Math.max(q.width,z.width*D/z.height))}var F=b&&null!=u?u-C:null;null!=F&&F<q.width?!B||F<M?(q.text="",q.width=q.contentWidth=0):(truncateText2(x,q.text,F-M,R,t.ellipsis,{minChar:t.truncateMinChar}),q.text=x.text,o.isTruncated=o.isTruncated||x.isTruncated,q.width=q.contentWidth=measureWidth(ensureFontMeasureInfo(R),q.text)):q.contentWidth=measureWidth(ensureFontMeasureInfo(R),q.text)}q.width+=M,C+=q.width,k&&(A=Math.max(A,q.lineHeight))}S(T,C,A)}o.outerWidth=o.width=retrieve2(u,v),o.outerHeight=o.height=retrieve2(h,_),o.contentHeight=_,o.contentWidth=v,o.outerWidth+=l,o.outerHeight+=c;for(E=0;E<y.length;E++){var q,N=(q=y[E]).percentWidth;q.width=parseInt(N,10)/100*o.width}return o}function pushTokens(e,t,r,n,i){var o,a,s=""===t,l=i&&r.rich[i]||{},c=e.lines,u=l.font||r.font,h=!1;if(n){var d=l.padding,p=d?d[1]+d[3]:0;if(null!=l.width&&"auto"!==l.width){var f=parsePercent(l.width,n.width)+p;c.length>0&&f+n.accumWidth>n.width&&(o=t.split("\n"),h=!0),n.accumWidth=f}else{var m=wrapText(t,u,n.width,n.breakAll,n.accumWidth);n.accumWidth=m.accumWidth+p,a=m.linesWidths,o=m.lines}}o||(o=t.split("\n"));for(var g=ensureFontMeasureInfo(u),y=0;y<o.length;y++){var _=o[y],v=new RichTextToken;if(v.styleName=i,v.text=_,v.isLineHolder=!_&&!s,"number"==typeof l.width?v.width=l.width:v.width=a?a[y]:measureWidth(g,_),y||h)c.push(new RichTextLine([v]));else{var b=(c[c.length-1]||(c[0]=new RichTextLine)).tokens,w=b.length;1===w&&b[0].isLineHolder?b[0]=v:(_||!w||s)&&b.push(v)}}}function isAlphabeticLetter(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var breakCharMap=reduce(",&?/;] ".split(""),(function(e,t){return e[t]=!0,e}),{});function isWordBreakChar(e){return!isAlphabeticLetter(e)||!!breakCharMap[e]}function wrapText(e,t,r,n,i){for(var o=[],a=[],s="",l="",c=0,u=0,h=ensureFontMeasureInfo(t),d=0;d<e.length;d++){var p=e.charAt(d);if("\n"!==p){var f=measureCharWidth(h,p.charCodeAt(0)),m=!n&&!isWordBreakChar(p);(o.length?u+f>r:i+u+f>r)?u?(s||l)&&(m?(s||(s=l,l="",u=c=0),o.push(s),a.push(u-c),l+=p,s="",u=c+=f):(l&&(s+=l,l="",c=0),o.push(s),a.push(u),s=p,u=f)):m?(o.push(l),a.push(c),l=p,c=f):(o.push(p),a.push(f)):(u+=f,m?(l+=p,c+=f):(l&&(s+=l,l="",c=0),s+=p))}else l&&(s+=l,u+=c),o.push(s),a.push(u),s="",l="",c=0,u=0}return l&&(s+=l),s&&(o.push(s),a.push(u)),1===o.length&&(u+=i),{accumWidth:u,lines:o,linesWidths:a}}function calcInnerTextOverflowArea(e,t,r,n,i,o){if(e.baseX=r,e.baseY=n,e.outerWidth=e.outerHeight=null,t){var a=2*t.width,s=2*t.height;BoundingRect.set(tmpCITCTextRect,adjustTextX(r,a,i),adjustTextY(n,s,o),a,s),BoundingRect.intersect(t,tmpCITCTextRect,null,tmpCITCIntersectRectOpt);var l=tmpCITCIntersectRectOpt.outIntersectRect;e.outerWidth=l.width,e.outerHeight=l.height,e.baseX=adjustTextX(l.x,l.width,i,!0),e.baseY=adjustTextY(l.y,l.height,o,!0)}}var tmpCITCTextRect=new BoundingRect(0,0,0,0),tmpCITCIntersectRectOpt={outIntersectRect:{},clamp:!0};function formatText(e){return null!=e?e+="":e=""}function tSpanCreateBoundingRect(e){var t=formatText(e.text),r=e.font;return tSpanCreateBoundingRect2(e,measureWidth(ensureFontMeasureInfo(r),t),getLineHeight(r),null)}function tSpanCreateBoundingRect2(e,t,r,n){var i=new BoundingRect(adjustTextX(e.x||0,t,e.textAlign),adjustTextY(e.y||0,r,e.textBaseline),t,r),o=null!=n?n:tSpanHasStroke(e)?e.lineWidth:0;return o>0&&(i.x-=o/2,i.y-=o/2,i.width+=o,i.height+=o),i}function tSpanHasStroke(e){var t=e.stroke;return null!=t&&"none"!==t&&e.lineWidth>0}function create(e,t){return null==e&&(e=0),null==t&&(t=0),[e,t]}function copy$1(e,t){return e[0]=t[0],e[1]=t[1],e}function clone$3(e){return[e[0],e[1]]}function add(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function sub$1(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function len(e){return Math.sqrt(lenSquare(e))}function lenSquare(e){return e[0]*e[0]+e[1]*e[1]}function scale(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function normalize$4(e,t){var r=len(t);return 0===r?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function distance(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var dist$2=distance;function distanceSquare(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var distSquare=distanceSquare;function lerp$1(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function applyTransform(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function min$2(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function max$3(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var mIdentity=identity,EPSILON$3=5e-5;function isNotAroundZero$1(e){return e>EPSILON$3||e<-EPSILON$3}var scaleTmp=[],tmpTransform=[],originTransform=create$1(),abs=Math.abs,Transformable=function(){function e(){}var t;return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},e.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},e.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},e.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},e.prototype.needLocalTransform=function(){return isNotAroundZero$1(this.rotation)||isNotAroundZero$1(this.x)||isNotAroundZero$1(this.y)||isNotAroundZero$1(this.scaleX-1)||isNotAroundZero$1(this.scaleY-1)||isNotAroundZero$1(this.skewX)||isNotAroundZero$1(this.skewY)},e.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),r=this.transform;t||e?(r=r||create$1(),t?this.getLocalTransform(r):mIdentity(r),e&&(t?mul(r,e,r):copy$2(r,e)),this.transform=r,this._resolveGlobalScaleRatio(r)):r&&(mIdentity(r),this.invTransform=null)},e.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(null!=t&&1!==t){this.getGlobalScale(scaleTmp);var r=scaleTmp[0]<0?-1:1,n=scaleTmp[1]<0?-1:1,i=((scaleTmp[0]-r)*t+r)/scaleTmp[0]||0,o=((scaleTmp[1]-n)*t+n)/scaleTmp[1]||0;e[0]*=i,e[1]*=i,e[2]*=o,e[3]*=o}this.invTransform=this.invTransform||create$1(),invert(this.invTransform,e)},e.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},e.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],n=Math.atan2(e[1],e[0]),i=Math.PI/2+n-Math.atan2(e[3],e[2]);r=Math.sqrt(r)*Math.cos(i),t=Math.sqrt(t),this.skewX=i,this.skewY=0,this.rotation=-n,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=r,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||create$1(),mul(tmpTransform,e.invTransform,t),t=tmpTransform);var r=this.originX,n=this.originY;(r||n)&&(originTransform[4]=r,originTransform[5]=n,mul(tmpTransform,t,originTransform),tmpTransform[4]-=r,tmpTransform[5]-=n,t=tmpTransform),this.setLocalTransform(t)}},e.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},e.prototype.transformCoordToLocal=function(e,t){var r=[e,t],n=this.invTransform;return n&&applyTransform(r,r,n),r},e.prototype.transformCoordToGlobal=function(e,t){var r=[e,t],n=this.transform;return n&&applyTransform(r,r,n),r},e.prototype.getLineScale=function(){var e=this.transform;return e&&abs(e[0]-1)>1e-10&&abs(e[3]-1)>1e-10?Math.sqrt(abs(e[0]*e[3]-e[2]*e[1])):1},e.prototype.copyTransform=function(e){copyTransform(this,e)},e.getLocalTransform=function(e,t){t=t||[];var r=e.originX||0,n=e.originY||0,i=e.scaleX,o=e.scaleY,a=e.anchorX,s=e.anchorY,l=e.rotation||0,c=e.x,u=e.y,h=e.skewX?Math.tan(e.skewX):0,d=e.skewY?Math.tan(-e.skewY):0;if(r||n||a||s){var p=r+a,f=n+s;t[4]=-p*i-h*f*o,t[5]=-f*o-d*p*i}else t[4]=t[5]=0;return t[0]=i,t[3]=o,t[1]=d*i,t[2]=h*o,l&&rotate(t,t,l),t[4]+=r+c,t[5]+=n+u,t},e.initDefaultProps=((t=e.prototype).scaleX=t.scaleY=t.globalScaleRatio=1,void(t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0)),e}(),TRANSFORMABLE_PROPS=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function copyTransform(e,t){for(var r=0;r<TRANSFORMABLE_PROPS.length;r++){var n=TRANSFORMABLE_PROPS[r];e[n]=t[n]}}var easingFuncs={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),-r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-easingFuncs.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*easingFuncs.bounceIn(2*e):.5*easingFuncs.bounceOut(2*e-1)+.5}},mathPow=Math.pow,mathSqrt$3=Math.sqrt,EPSILON$2=1e-8,EPSILON_NUMERIC=1e-4,THREE_SQRT=mathSqrt$3(3),ONE_THIRD=1/3,_v0=create(),_v1=create(),_v2=create();function isAroundZero(e){return e>-EPSILON$2&&e<EPSILON$2}function isNotAroundZero(e){return e>EPSILON$2||e<-EPSILON$2}function cubicAt(e,t,r,n,i){var o=1-i;return o*o*(o*e+3*i*t)+i*i*(i*n+3*o*r)}function cubicDerivativeAt(e,t,r,n,i){var o=1-i;return 3*(((t-e)*o+2*(r-t)*i)*o+(n-r)*i*i)}function cubicRootAt(e,t,r,n,i,o){var a=n+3*(t-r)-e,s=3*(r-2*t+e),l=3*(t-e),c=e-i,u=s*s-3*a*l,h=s*l-9*a*c,d=l*l-3*s*c,p=0;if(isAroundZero(u)&&isAroundZero(h)){if(isAroundZero(s))o[0]=0;else(E=-l/s)>=0&&E<=1&&(o[p++]=E)}else{var f=h*h-4*u*d;if(isAroundZero(f)){var m=h/u,g=-m/2;(E=-s/a+m)>=0&&E<=1&&(o[p++]=E),g>=0&&g<=1&&(o[p++]=g)}else if(f>0){var y=mathSqrt$3(f),_=u*s+1.5*a*(-h+y),v=u*s+1.5*a*(-h-y);(E=(-s-((_=_<0?-mathPow(-_,ONE_THIRD):mathPow(_,ONE_THIRD))+(v=v<0?-mathPow(-v,ONE_THIRD):mathPow(v,ONE_THIRD))))/(3*a))>=0&&E<=1&&(o[p++]=E)}else{var b=(2*u*s-3*a*h)/(2*mathSqrt$3(u*u*u)),w=Math.acos(b)/3,x=mathSqrt$3(u),S=Math.cos(w),E=(-s-2*x*S)/(3*a),T=(g=(-s+x*(S+THREE_SQRT*Math.sin(w)))/(3*a),(-s+x*(S-THREE_SQRT*Math.sin(w)))/(3*a));E>=0&&E<=1&&(o[p++]=E),g>=0&&g<=1&&(o[p++]=g),T>=0&&T<=1&&(o[p++]=T)}}return p}function cubicExtrema(e,t,r,n,i){var o=6*r-12*t+6*e,a=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(isAroundZero(a)){if(isNotAroundZero(o))(u=-s/o)>=0&&u<=1&&(i[l++]=u)}else{var c=o*o-4*a*s;if(isAroundZero(c))i[0]=-o/(2*a);else if(c>0){var u,h=mathSqrt$3(c),d=(-o-h)/(2*a);(u=(-o+h)/(2*a))>=0&&u<=1&&(i[l++]=u),d>=0&&d<=1&&(i[l++]=d)}}return l}function cubicSubdivide(e,t,r,n,i,o){var a=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,c=(s-a)*i+a,u=(l-s)*i+s,h=(u-c)*i+c;o[0]=e,o[1]=a,o[2]=c,o[3]=h,o[4]=h,o[5]=u,o[6]=l,o[7]=n}function cubicProjectPoint(e,t,r,n,i,o,a,s,l,c,u){var h,d,p,f,m,g=.005,y=1/0;_v0[0]=l,_v0[1]=c;for(var _=0;_<1;_+=.05)_v1[0]=cubicAt(e,r,i,a,_),_v1[1]=cubicAt(t,n,o,s,_),(f=distSquare(_v0,_v1))<y&&(h=_,y=f);y=1/0;for(var v=0;v<32&&!(g<EPSILON_NUMERIC);v++)d=h-g,p=h+g,_v1[0]=cubicAt(e,r,i,a,d),_v1[1]=cubicAt(t,n,o,s,d),f=distSquare(_v1,_v0),d>=0&&f<y?(h=d,y=f):(_v2[0]=cubicAt(e,r,i,a,p),_v2[1]=cubicAt(t,n,o,s,p),m=distSquare(_v2,_v0),p<=1&&m<y?(h=p,y=m):g*=.5);return u&&(u[0]=cubicAt(e,r,i,a,h),u[1]=cubicAt(t,n,o,s,h)),mathSqrt$3(y)}function cubicLength(e,t,r,n,i,o,a,s,l){for(var c=e,u=t,h=0,d=1/l,p=1;p<=l;p++){var f=p*d,m=cubicAt(e,r,i,a,f),g=cubicAt(t,n,o,s,f),y=m-c,_=g-u;h+=Math.sqrt(y*y+_*_),c=m,u=g}return h}function quadraticAt(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function quadraticDerivativeAt(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function quadraticRootAt(e,t,r,n,i){var o=e-2*t+r,a=2*(t-e),s=e-n,l=0;if(isAroundZero(o)){if(isNotAroundZero(a))(u=-s/a)>=0&&u<=1&&(i[l++]=u)}else{var c=a*a-4*o*s;if(isAroundZero(c))(u=-a/(2*o))>=0&&u<=1&&(i[l++]=u);else if(c>0){var u,h=mathSqrt$3(c),d=(-a-h)/(2*o);(u=(-a+h)/(2*o))>=0&&u<=1&&(i[l++]=u),d>=0&&d<=1&&(i[l++]=d)}}return l}function quadraticExtremum(e,t,r){var n=e+r-2*t;return 0===n?.5:(e-t)/n}function quadraticSubdivide(e,t,r,n,i){var o=(t-e)*n+e,a=(r-t)*n+t,s=(a-o)*n+o;i[0]=e,i[1]=o,i[2]=s,i[3]=s,i[4]=a,i[5]=r}function quadraticProjectPoint(e,t,r,n,i,o,a,s,l){var c,u=.005,h=1/0;_v0[0]=a,_v0[1]=s;for(var d=0;d<1;d+=.05){_v1[0]=quadraticAt(e,r,i,d),_v1[1]=quadraticAt(t,n,o,d),(g=distSquare(_v0,_v1))<h&&(c=d,h=g)}h=1/0;for(var p=0;p<32&&!(u<EPSILON_NUMERIC);p++){var f=c-u,m=c+u;_v1[0]=quadraticAt(e,r,i,f),_v1[1]=quadraticAt(t,n,o,f);var g=distSquare(_v1,_v0);if(f>=0&&g<h)c=f,h=g;else{_v2[0]=quadraticAt(e,r,i,m),_v2[1]=quadraticAt(t,n,o,m);var y=distSquare(_v2,_v0);m<=1&&y<h?(c=m,h=y):u*=.5}}return l&&(l[0]=quadraticAt(e,r,i,c),l[1]=quadraticAt(t,n,o,c)),mathSqrt$3(h)}function quadraticLength(e,t,r,n,i,o,a){for(var s=e,l=t,c=0,u=1/a,h=1;h<=a;h++){var d=h*u,p=quadraticAt(e,r,i,d),f=quadraticAt(t,n,o,d),m=p-s,g=f-l;c+=Math.sqrt(m*m+g*g),s=p,l=f}return c}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(e){var t=e&&regexp.exec(e);if(t){var r=t[1].split(","),n=+trim(r[0]),i=+trim(r[1]),o=+trim(r[2]),a=+trim(r[3]);if(isNaN(n+i+o+a))return;var s=[];return function(e){return e<=0?0:e>=1?1:cubicRootAt(0,n,o,1,e,s)&&cubicAt(0,i,a,1,s[0])}}}var Clip=function(){function e(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||noop,this.ondestroy=e.ondestroy||noop,this.onrestart=e.onrestart||noop,e.easing&&this.setEasing(e.easing)}return e.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),!this._paused){var r=this._life,n=e-this._startTime-this._pausedTime,i=n/r;i<0&&(i=0),i=Math.min(i,1);var o=this.easingFunc,a=o?o(i):i;if(this.onframe(a),1===i){if(!this.loop)return!0;var s=n%r;this._startTime=e-s,this._pausedTime=0,this.onrestart()}return!1}this._pausedTime+=t},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(e){this.easing=e,this.easingFunc=isFunction(e)?e:easingFuncs[e]||createCubicEasingFunc(e)},e}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(e){return(e=Math.round(e))<0?0:e>255?255:e}function clampCssFloat(e){return e<0?0:e>1?1:e}function parseCssInt(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?clampCssByte(parseFloat(t)/100*255):clampCssByte(parseInt(t,10))}function parseCssFloat(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?clampCssFloat(parseFloat(t)/100):clampCssFloat(parseFloat(t))}function cssHueToRgb(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function lerpNumber(e,t,r){return e+(t-e)*r}function setRgba(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function copyRgba(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var colorCache=new LRU(20),lastRemovedArr=null;function putToCache(e,t){lastRemovedArr&&copyRgba(lastRemovedArr,t),lastRemovedArr=colorCache.put(e,lastRemovedArr||t.slice())}function parse$3(e,t){if(e){t=t||[];var r=colorCache.get(e);if(r)return copyRgba(t,r);var n=(e+="").replace(/ /g,"").toLowerCase();if(n in kCSSColorTable)return copyRgba(t,kCSSColorTable[n]),putToCache(e,t),t;var i,o=n.length;if("#"===n.charAt(0))return 4===o||5===o?(i=parseInt(n.slice(1,4),16))>=0&&i<=4095?(setRgba(t,(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,5===o?parseInt(n.slice(4),16)/15:1),putToCache(e,t),t):void setRgba(t,0,0,0,1):7===o||9===o?(i=parseInt(n.slice(1,7),16))>=0&&i<=16777215?(setRgba(t,(16711680&i)>>16,(65280&i)>>8,255&i,9===o?parseInt(n.slice(7),16)/255:1),putToCache(e,t),t):void setRgba(t,0,0,0,1):void 0;var a=n.indexOf("("),s=n.indexOf(")");if(-1!==a&&s+1===o){var l=n.substr(0,a),c=n.substr(a+1,s-(a+1)).split(","),u=1;switch(l){case"rgba":if(4!==c.length)return 3===c.length?setRgba(t,+c[0],+c[1],+c[2],1):setRgba(t,0,0,0,1);u=parseCssFloat(c.pop());case"rgb":return c.length>=3?(setRgba(t,parseCssInt(c[0]),parseCssInt(c[1]),parseCssInt(c[2]),3===c.length?u:parseCssFloat(c[3])),putToCache(e,t),t):void setRgba(t,0,0,0,1);case"hsla":return 4!==c.length?void setRgba(t,0,0,0,1):(c[3]=parseCssFloat(c[3]),hsla2rgba(c,t),putToCache(e,t),t);case"hsl":return 3!==c.length?void setRgba(t,0,0,0,1):(hsla2rgba(c,t),putToCache(e,t),t);default:return}}setRgba(t,0,0,0,1)}}function hsla2rgba(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=parseCssFloat(e[1]),i=parseCssFloat(e[2]),o=i<=.5?i*(n+1):i+n-i*n,a=2*i-o;return setRgba(t=t||[],clampCssByte(255*cssHueToRgb(a,o,r+1/3)),clampCssByte(255*cssHueToRgb(a,o,r)),clampCssByte(255*cssHueToRgb(a,o,r-1/3)),1),4===e.length&&(t[3]=e[3]),t}function rgba2hsla(e){if(e){var t,r,n=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(n,i,o),s=Math.max(n,i,o),l=s-a,c=(s+a)/2;if(0===l)t=0,r=0;else{r=c<.5?l/(s+a):l/(2-s-a);var u=((s-n)/6+l/2)/l,h=((s-i)/6+l/2)/l,d=((s-o)/6+l/2)/l;n===s?t=d-h:i===s?t=1/3+u-d:o===s&&(t=2/3+h-u),t<0&&(t+=1),t>1&&(t-=1)}var p=[360*t,r,c];return null!=e[3]&&p.push(e[3]),p}}function lift(e,t){var r=parse$3(e);if(r){for(var n=0;n<3;n++)r[n]=r[n]*(1-t)|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return stringify(r,4===r.length?"rgba":"rgb")}}function lerp(e,t,r){if(t&&t.length&&e>=0&&e<=1){var n=e*(t.length-1),i=Math.floor(n),o=Math.ceil(n),a=parse$3(t[i]),s=parse$3(t[o]),l=n-i,c=stringify([clampCssByte(lerpNumber(a[0],s[0],l)),clampCssByte(lerpNumber(a[1],s[1],l)),clampCssByte(lerpNumber(a[2],s[2],l)),clampCssFloat(lerpNumber(a[3],s[3],l))],"rgba");return r?{color:c,leftIndex:i,rightIndex:o,value:n}:c}}function modifyHSL(e,t,r,n){var i=parse$3(e);if(e)return i=rgba2hsla(i),null!=r&&(i[1]=parseCssFloat(isFunction(r)?r(i[1]):r)),null!=n&&(i[2]=parseCssFloat(isFunction(n)?n(i[2]):n)),stringify(hsla2rgba(i),"rgba")}function stringify(e,t){if(e&&e.length){var r=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(r+=","+e[3]),t+"("+r+")"}}function lum(e,t){var r=parse$3(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}var liftedColorCache=new LRU(100);function liftColor(e){if(isString(e)){var t=liftedColorCache.get(e);return t||(t=lift(e,-.1),liftedColorCache.put(e,t)),t}if(isGradientObject(e)){var r=extend$1({},e);return r.colorStops=map$1(e.colorStops,(function(e){return{offset:e.offset,color:lift(e.color,-.1)}})),r}return e}function isLinearGradient(e){return"linear"===e.type}function isRadialGradient(e){return"radial"===e.type}env.hasGlobalWindow&&isFunction(window.btoa);var arraySlice=Array.prototype.slice;function interpolateNumber(e,t,r){return(t-e)*r+e}function interpolate1DArray(e,t,r,n){for(var i=t.length,o=0;o<i;o++)e[o]=interpolateNumber(t[o],r[o],n);return e}function interpolate2DArray(e,t,r,n){for(var i=t.length,o=i&&t[0].length,a=0;a<i;a++){e[a]||(e[a]=[]);for(var s=0;s<o;s++)e[a][s]=interpolateNumber(t[a][s],r[a][s],n)}return e}function add1DArray(e,t,r,n){for(var i=t.length,o=0;o<i;o++)e[o]=t[o]+r[o]*n;return e}function add2DArray(e,t,r,n){for(var i=t.length,o=i&&t[0].length,a=0;a<i;a++){e[a]||(e[a]=[]);for(var s=0;s<o;s++)e[a][s]=t[a][s]+r[a][s]*n}return e}function fillColorStops(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,o=Math.min(r,n),a=i[o-1]||{color:[0,0,0,0],offset:0},s=o;s<Math.max(r,n);s++)i.push({offset:a.offset,color:a.color.slice()})}function fillArray(e,t,r){var n=e,i=t;if(n.push&&i.push){var o=n.length,a=i.length;if(o!==a)if(o>a)n.length=a;else for(var s=o;s<a;s++)n.push(1===r?i[s]:arraySlice.call(i[s]));var l=n[0]&&n[0].length;for(s=0;s<n.length;s++)if(1===r)isNaN(n[s])&&(n[s]=i[s]);else for(var c=0;c<l;c++)isNaN(n[s][c])&&(n[s][c]=i[s][c])}}function cloneValue(e){if(isArrayLike(e)){var t=e.length;if(isArrayLike(e[0])){for(var r=[],n=0;n<t;n++)r.push(arraySlice.call(e[n]));return r}return arraySlice.call(e)}return e}function rgba2String(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=null==e[3]?1:e[3],"rgba("+e.join(",")+")"}function guessArrayDim(e){return isArrayLike(e&&e[0])?2:1}var VALUE_TYPE_NUMBER=0,VALUE_TYPE_1D_ARRAY=1,VALUE_TYPE_2D_ARRAY=2,VALUE_TYPE_COLOR=3,VALUE_TYPE_LINEAR_GRADIENT=4,VALUE_TYPE_RADIAL_GRADIENT=5,VALUE_TYPE_UNKOWN=6;function isGradientValueType(e){return e===VALUE_TYPE_LINEAR_GRADIENT||e===VALUE_TYPE_RADIAL_GRADIENT}function isArrayValueType(e){return e===VALUE_TYPE_1D_ARRAY||e===VALUE_TYPE_2D_ARRAY}var tmpRgba=[0,0,0,0],Track=function(){function e(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(e,t,r){this._needsSort=!0;var n=this.keyframes,i=n.length,o=!1,a=VALUE_TYPE_UNKOWN,s=t;if(isArrayLike(t)){var l=guessArrayDim(t);a=l,(1===l&&!isNumber$1(t[0])||2===l&&!isNumber$1(t[0][0]))&&(o=!0)}else if(isNumber$1(t)&&!eqNaN(t))a=VALUE_TYPE_NUMBER;else if(isString(t))if(isNaN(+t)){var c=parse$3(t);c&&(s=c,a=VALUE_TYPE_COLOR)}else a=VALUE_TYPE_NUMBER;else if(isGradientObject(t)){var u=extend$1({},s);u.colorStops=map$1(t.colorStops,(function(e){return{offset:e.offset,color:parse$3(e.color)}})),isLinearGradient(t)?a=VALUE_TYPE_LINEAR_GRADIENT:isRadialGradient(t)&&(a=VALUE_TYPE_RADIAL_GRADIENT),s=u}0===i?this.valType=a:a===this.valType&&a!==VALUE_TYPE_UNKOWN||(o=!0),this.discrete=this.discrete||o;var h={time:e,value:s,rawValue:t,percent:0};return r&&(h.easing=r,h.easingFunc=isFunction(r)?r:easingFuncs[r]||createCubicEasingFunc(r)),n.push(h),h},e.prototype.prepare=function(e,t){var r=this.keyframes;this._needsSort&&r.sort((function(e,t){return e.time-t.time}));for(var n=this.valType,i=r.length,o=r[i-1],a=this.discrete,s=isArrayValueType(n),l=isGradientValueType(n),c=0;c<i;c++){var u=r[c],h=u.value,d=o.value;u.percent=u.time/e,a||(s&&c!==i-1?fillArray(h,d,n):l&&fillColorStops(h.colorStops,d.colorStops))}if(!a&&n!==VALUE_TYPE_RADIAL_GRADIENT&&t&&this.needsAnimate()&&t.needsAnimate()&&n===t.valType&&!t._finished){this._additiveTrack=t;var p=r[0].value;for(c=0;c<i;c++)n===VALUE_TYPE_NUMBER?r[c].additiveValue=r[c].value-p:n===VALUE_TYPE_COLOR?r[c].additiveValue=add1DArray([],r[c].value,p,-1):isArrayValueType(n)&&(r[c].additiveValue=n===VALUE_TYPE_1D_ARRAY?add1DArray([],r[c].value,p,-1):add2DArray([],r[c].value,p,-1))}},e.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r,n,i,o=null!=this._additiveTrack,a=o?"additiveValue":"value",s=this.valType,l=this.keyframes,c=l.length,u=this.propName,h=s===VALUE_TYPE_COLOR,d=this._lastFr,p=Math.min;if(1===c)n=i=l[0];else{if(t<0)r=0;else if(t<this._lastFrP){for(r=p(d+1,c-1);r>=0&&!(l[r].percent<=t);r--);r=p(r,c-2)}else{for(r=d;r<c&&!(l[r].percent>t);r++);r=p(r-1,c-2)}i=l[r+1],n=l[r]}if(n&&i){this._lastFr=r,this._lastFrP=t;var f=i.percent-n.percent,m=0===f?1:p((t-n.percent)/f,1);i.easingFunc&&(m=i.easingFunc(m));var g=o?this._additiveValue:h?tmpRgba:e[u];if(!isArrayValueType(s)&&!h||g||(g=this._additiveValue=[]),this.discrete)e[u]=m<1?n.rawValue:i.rawValue;else if(isArrayValueType(s))s===VALUE_TYPE_1D_ARRAY?interpolate1DArray(g,n[a],i[a],m):interpolate2DArray(g,n[a],i[a],m);else if(isGradientValueType(s)){var y=n[a],_=i[a],v=s===VALUE_TYPE_LINEAR_GRADIENT;e[u]={type:v?"linear":"radial",x:interpolateNumber(y.x,_.x,m),y:interpolateNumber(y.y,_.y,m),colorStops:map$1(y.colorStops,(function(e,t){var r=_.colorStops[t];return{offset:interpolateNumber(e.offset,r.offset,m),color:rgba2String(interpolate1DArray([],e.color,r.color,m))}})),global:_.global},v?(e[u].x2=interpolateNumber(y.x2,_.x2,m),e[u].y2=interpolateNumber(y.y2,_.y2,m)):e[u].r=interpolateNumber(y.r,_.r,m)}else if(h)interpolate1DArray(g,n[a],i[a],m),o||(e[u]=rgba2String(g));else{var b=interpolateNumber(n[a],i[a],m);o?this._additiveValue=b:e[u]=b}o&&this._addToTarget(e)}}},e.prototype._addToTarget=function(e){var t=this.valType,r=this.propName,n=this._additiveValue;t===VALUE_TYPE_NUMBER?e[r]=e[r]+n:t===VALUE_TYPE_COLOR?(parse$3(e[r],tmpRgba),add1DArray(tmpRgba,tmpRgba,n,1),e[r]=rgba2String(tmpRgba)):t===VALUE_TYPE_1D_ARRAY?add1DArray(e[r],e[r],n,1):t===VALUE_TYPE_2D_ARRAY&&add2DArray(e[r],e[r],n,1)},e}(),Animator=function(){function e(e,t,r,n){this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&n?logError("Can' use additive animation on looped animation."):(this._additiveAnimators=n,this._allowDiscrete=r)}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(e){this._target=e},e.prototype.when=function(e,t,r){return this.whenWithKeys(e,t,keys(t),r)},e.prototype.whenWithKeys=function(e,t,r,n){for(var i=this._tracks,o=0;o<r.length;o++){var a=r[o],s=i[a];if(!s){s=i[a]=new Track(a);var l=void 0,c=this._getAdditiveTrack(a);if(c){var u=c.keyframes,h=u[u.length-1];l=h&&h.value,c.valType===VALUE_TYPE_COLOR&&l&&(l=rgba2String(l))}else l=this._target[a];if(null==l)continue;e>0&&s.addKeyframe(0,cloneValue(l),n),this._trackKeys.push(a)}s.addKeyframe(e,cloneValue(t[a]),n)}return this._maxTime=Math.max(this._maxTime,e),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,r=0;r<t;r++)e[r].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var r=0;r<t.length;r++)t[r].call(this)},e.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,r=0;r<t.length;r++)e[t[r]].setFinished()},e.prototype._getAdditiveTrack=function(e){var t,r=this._additiveAnimators;if(r)for(var n=0;n<r.length;n++){var i=r[n].getTrack(e);i&&(t=i)}return t},e.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,r=[],n=this._maxTime||0,i=0;i<this._trackKeys.length;i++){var o=this._trackKeys[i],a=this._tracks[o],s=this._getAdditiveTrack(o),l=a.keyframes,c=l.length;if(a.prepare(n,s),a.needsAnimate())if(!this._allowDiscrete&&a.discrete){var u=l[c-1];u&&(t._target[a.propName]=u.rawValue),a.setFinished()}else r.push(a)}if(r.length||this._force){var h=new Clip({life:n,loop:this._loop,delay:this._delay||0,onframe:function(e){t._started=2;var n=t._additiveAnimators;if(n){for(var i=!1,o=0;o<n.length;o++)if(n[o]._clip){i=!0;break}i||(t._additiveAnimators=null)}for(o=0;o<r.length;o++)r[o].step(t._target,e);var a=t._onframeCbs;if(a)for(o=0;o<a.length;o++)a[o](t._target,e)},ondestroy:function(){t._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),e&&h.setEasing(e)}else this._doneCallback();return this}},e.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},e.prototype.delay=function(e){return this._delay=e,this},e.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},e.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},e.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(e){return this._tracks[e]},e.prototype.getTracks=function(){var e=this;return map$1(this._trackKeys,(function(t){return e._tracks[t]}))},e.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var r=this._tracks,n=this._trackKeys,i=0;i<e.length;i++){var o=r[e[i]];o&&!o.isFinished()&&(t?o.step(this._target,1):1===this._started&&o.step(this._target,0),o.setFinished())}var a=!0;for(i=0;i<n.length;i++)if(!r[n[i]].isFinished()){a=!1;break}return a&&this._abortedCallback(),a},e.prototype.saveTo=function(e,t,r){if(e){t=t||this._trackKeys;for(var n=0;n<t.length;n++){var i=t[n],o=this._tracks[i];if(o&&!o.isFinished()){var a=o.keyframes,s=a[r?0:a.length-1];s&&(e[i]=cloneValue(s.rawValue))}}}},e.prototype.__changeFinalValue=function(e,t){t=t||keys(e);for(var r=0;r<t.length;r++){var n=t[r],i=this._tracks[n];if(i){var o=i.keyframes;if(o.length>1){var a=o.pop();i.addKeyframe(a.time,e[n]),i.prepare(this._maxTime,i.getAdditiveTrack())}}}},e}(),Eventful=function(){function e(e){e&&(this._$eventProcessor=e)}return e.prototype.on=function(e,t,r,n){this._$handlers||(this._$handlers={});var i=this._$handlers;if("function"==typeof t&&(n=r,r=t,t=null),!r||!e)return this;var o=this._$eventProcessor;null!=t&&o&&o.normalizeQuery&&(t=o.normalizeQuery(t)),i[e]||(i[e]=[]);for(var a=0;a<i[e].length;a++)if(i[e][a].h===r)return this;var s={h:r,query:t,ctx:n||this,callAtLast:r.zrEventfulCallAtLast},l=i[e].length-1,c=i[e][l];return c&&c.callAtLast?i[e].splice(l,0,s):i[e].push(s),this},e.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},e.prototype.off=function(e,t){var r=this._$handlers;if(!r)return this;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var n=[],i=0,o=r[e].length;i<o;i++)r[e][i].h!==t&&n.push(r[e][i]);r[e]=n}r[e]&&0===r[e].length&&delete r[e]}else delete r[e];return this},e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var n=this._$handlers[e],i=this._$eventProcessor;if(n)for(var o=t.length,a=n.length,s=0;s<a;s++){var l=n[s];if(!i||!i.filter||null==l.query||i.filter(e,l.query))switch(o){case 0:l.h.call(l.ctx);break;case 1:l.h.call(l.ctx,t[0]);break;case 2:l.h.call(l.ctx,t[0],t[1]);break;default:l.h.apply(l.ctx,t)}}return i&&i.afterTrigger&&i.afterTrigger(e),this},e.prototype.triggerWithContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var n=this._$handlers[e],i=this._$eventProcessor;if(n)for(var o=t.length,a=t[o-1],s=n.length,l=0;l<s;l++){var c=n[l];if(!i||!i.filter||null==c.query||i.filter(e,c.query))switch(o){case 0:c.h.call(a);break;case 1:c.h.call(a,t[0]);break;case 2:c.h.call(a,t[0],t[1]);break;default:c.h.apply(a,t.slice(1,o-1))}}return i&&i.afterTrigger&&i.afterTrigger(e),this},e}(),dpr=1;env.hasGlobalWindow&&(dpr=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var devicePixelRatio$1=dpr,DARK_MODE_THRESHOLD=.4,DARK_LABEL_COLOR="#333",LIGHT_LABEL_COLOR="#ccc",LIGHTER_LABEL_COLOR="#eee",REDRAW_BIT=1,STYLE_CHANGED_BIT=2,SHAPE_CHANGED_BIT=4,PRESERVED_NORMAL_STATE="__zr_normal__",PRIMARY_STATES_KEYS$1=TRANSFORMABLE_PROPS.concat(["ignore"]),DEFAULT_ANIMATABLE_MAP=reduce(TRANSFORMABLE_PROPS,(function(e,t){return e[t]=!0,e}),{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect(0,0,0,0),tmpInnerTextTrans=[],Element$2=function(){function e(e){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return e.prototype._init=function(e){this.attr(e)},e.prototype.drift=function(e,t,r){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=e,n[5]+=t,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var r=this.textConfig,n=r.local,i=t.innerTransformable,o=void 0,a=void 0,s=!1;i.parent=n?this:null;var l=!1;i.copyTransform(t);var c=null!=r.position,u=r.autoOverflowArea,h=void 0;if((u||c)&&(h=tmpBoundingRect,r.layoutRect?h.copy(r.layoutRect):h.copy(this.getBoundingRect()),n||h.applyTransform(this.transform)),c){this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,r,h):calculateTextPosition(tmpTextPosCalcRes,r,h),i.x=tmpTextPosCalcRes.x,i.y=tmpTextPosCalcRes.y,o=tmpTextPosCalcRes.align,a=tmpTextPosCalcRes.verticalAlign;var d=r.origin;if(d&&null!=r.rotation){var p=void 0,f=void 0;"center"===d?(p=.5*h.width,f=.5*h.height):(p=parsePercent(d[0],h.width),f=parsePercent(d[1],h.height)),l=!0,i.originX=-i.x+p+(n?0:h.x),i.originY=-i.y+f+(n?0:h.y)}}null!=r.rotation&&(i.rotation=r.rotation);var m=r.offset;m&&(i.x+=m[0],i.y+=m[1],l||(i.originX=-m[0],i.originY=-m[1]));var g=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={});if(u){var y=g.overflowRect=g.overflowRect||new BoundingRect(0,0,0,0);i.getLocalTransform(tmpInnerTextTrans),invert(tmpInnerTextTrans,tmpInnerTextTrans),BoundingRect.copy(y,h),y.applyTransform(tmpInnerTextTrans)}else g.overflowRect=null;var _=void 0,v=void 0,b=void 0;(null==r.inside?"string"==typeof r.position&&r.position.indexOf("inside")>=0:r.inside)&&this.canBeInsideText()?(_=r.insideFill,v=r.insideStroke,null!=_&&"auto"!==_||(_=this.getInsideTextFill()),null!=v&&"auto"!==v||(v=this.getInsideTextStroke(_),b=!0)):(_=r.outsideFill,v=r.outsideStroke,null!=_&&"auto"!==_||(_=this.getOutsideFill()),null!=v&&"auto"!==v||(v=this.getOutsideStroke(_),b=!0)),(_=_||"#000")===g.fill&&v===g.stroke&&b===g.autoStroke&&o===g.align&&a===g.verticalAlign||(s=!0,g.fill=_,g.stroke=v,g.autoStroke=b,g.align=o,g.verticalAlign=a,t.setDefaultTextStyle(g)),t.__dirty|=REDRAW_BIT,s&&t.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(e){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?LIGHT_LABEL_COLOR:DARK_LABEL_COLOR},e.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),r="string"==typeof t&&parse$3(t);r||(r=[255,255,255,1]);for(var n=r[3],i=this.__zr.isDarkMode(),o=0;o<3;o++)r[o]=r[o]*n+(i?0:255)*(1-n);return r[3]=1,stringify(r,"rgba")},e.prototype.traverse=function(e,t){},e.prototype.attrKV=function(e,t){"textConfig"===e?this.setTextConfig(t):"textContent"===e?this.setTextContent(t):"clipPath"===e?this.setClipPath(t):"extra"===e?(this.extra=this.extra||{},extend$1(this.extra,t)):this[e]=t},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(e,t){if("string"==typeof e)this.attrKV(e,t);else if(isObject$1(e))for(var r=keys(e),n=0;n<r.length;n++){var i=r[n];this.attrKV(i,e[i])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,r=0;r<this.animators.length;r++){var n=this.animators[r],i=n.__fromStateTransition;if(!(n.getLoop()||i&&i!==PRESERVED_NORMAL_STATE)){var o=n.targetName,a=o?t[o]:t;n.saveTo(a)}}},e.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,PRIMARY_STATES_KEYS$1)},e.prototype._savePrimaryToNormal=function(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];null==e[i]||i in t||(t[i]=this[i])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(e){return this.states[e]},e.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},e.prototype.clearStates=function(e){this.useState(PRESERVED_NORMAL_STATE,!1,e)},e.prototype.useState=function(e,t,r,n){var i=e===PRESERVED_NORMAL_STATE;if(this.hasState()||!i){var o=this.currentStates,a=this.stateTransition;if(!(indexOf(o,e)>=0)||!t&&1!==o.length){var s;if(this.stateProxy&&!i&&(s=this.stateProxy(e)),s||(s=this.states&&this.states[e]),s||i){i||this.saveCurrentToNormalState(s);var l=!!(s&&s.hoverLayer||n);l&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,s,this._normalState,t,!r&&!this.__inHover&&a&&a.duration>0,a);var c=this._textContent,u=this._textGuide;return c&&c.useState(e,t,r,l),u&&u.useState(e,t,r,l),i?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!l&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT),s}logError("State "+e+" not exists.")}}},e.prototype.useStates=function(e,t,r){if(e.length){var n=[],i=this.currentStates,o=e.length,a=o===i.length;if(a)for(var s=0;s<o;s++)if(e[s]!==i[s]){a=!1;break}if(a)return;for(s=0;s<o;s++){var l=e[s],c=void 0;this.stateProxy&&(c=this.stateProxy(l,e)),c||(c=this.states[l]),c&&n.push(c)}var u=n[o-1],h=!!(u&&u.hoverLayer||r);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(n),p=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(e.join(","),d,this._normalState,!1,!t&&!this.__inHover&&p&&p.duration>0,p);var f=this._textContent,m=this._textGuide;f&&f.useStates(e,t,h),m&&m.useStates(e,t,h),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~REDRAW_BIT)}else this.clearStates()},e.prototype.isSilent=function(){for(var e=this;e;){if(e.silent)return!0;var t=e.__hostTarget;e=t?e.ignoreHostSilent?null:t:e.parent}return!1},e.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},e.prototype.removeState=function(e){var t=indexOf(this.currentStates,e);if(t>=0){var r=this.currentStates.slice();r.splice(t,1),this.useStates(r)}},e.prototype.replaceState=function(e,t,r){var n=this.currentStates.slice(),i=indexOf(n,e),o=indexOf(n,t)>=0;i>=0?o?n.splice(i,1):n[i]=t:r&&!o&&n.push(t),this.useStates(n)},e.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},e.prototype._mergeStates=function(e){for(var t,r={},n=0;n<e.length;n++){var i=e[n];extend$1(r,i),i.textConfig&&extend$1(t=t||{},i.textConfig)}return t&&(r.textConfig=t),r},e.prototype._applyStateObj=function(e,t,r,n,i,o){var a=!(t&&n);t&&t.textConfig?(this.textConfig=extend$1({},n?this.textConfig:r.textConfig),extend$1(this.textConfig,t.textConfig)):a&&r.textConfig&&(this.textConfig=r.textConfig);for(var s={},l=!1,c=0;c<PRIMARY_STATES_KEYS$1.length;c++){var u=PRIMARY_STATES_KEYS$1[c],h=i&&DEFAULT_ANIMATABLE_MAP[u];t&&null!=t[u]?h?(l=!0,s[u]=t[u]):this[u]=t[u]:a&&null!=r[u]&&(h?(l=!0,s[u]=r[u]):this[u]=r[u])}if(!i)for(c=0;c<this.animators.length;c++){var d=this.animators[c],p=d.targetName;d.getLoop()||d.__changeFinalValue(p?(t||r)[p]:t||r)}l&&this._transitionState(e,s,o)},e.prototype._attachComponent=function(e){if((!e.__zr||e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},e.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},e.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new Transformable,this._attachComponent(e),this._textContent=e,this.markRedraw())},e.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),extend$1(this.textConfig,e),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=REDRAW_BIT;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,r=this._textGuide;t&&(t.__inHover=e),r&&(r.__inHover=e)},e.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.addAnimator(t[r]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},e.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.removeAnimator(t[r]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},e.prototype.animate=function(e,t,r){var n=e?this[e]:this,i=new Animator(n,t,r);return e&&(i.targetName=e),this.addAnimator(i,e),i},e.prototype.addAnimator=function(e,t){var r=this.__zr,n=this;e.during((function(){n.updateDuringAnimation(t)})).done((function(){var t=n.animators,r=indexOf(t,e);r>=0&&t.splice(r,1)})),this.animators.push(e),r&&r.animation.addAnimator(e),r&&r.wakeUp()},e.prototype.updateDuringAnimation=function(e){this.markRedraw()},e.prototype.stopAnimation=function(e,t){for(var r=this.animators,n=r.length,i=[],o=0;o<n;o++){var a=r[o];e&&e!==a.scope?i.push(a):a.stop(t)}return this.animators=i,this},e.prototype.animateTo=function(e,t,r){animateTo(this,e,t,r)},e.prototype.animateFrom=function(e,t,r){animateTo(this,e,t,r,!0)},e.prototype._transitionState=function(e,t,r,n){for(var i=animateTo(this,t,r,n),o=0;o<i.length;o++)i[o].__fromStateTransition=e},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;function r(e,r,n,i){function o(e,t){Object.defineProperty(t,0,{get:function(){return e[n]},set:function(t){e[n]=t}}),Object.defineProperty(t,1,{get:function(){return e[i]},set:function(t){e[i]=t}})}Object.defineProperty(t,e,{get:function(){this[r]||o(this,this[r]=[]);return this[r]},set:function(e){this[n]=e[0],this[i]=e[1],this[r]=e,o(this,e)}})}t.type="element",t.name="",t.ignore=t.silent=t.ignoreHostSilent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=REDRAW_BIT,Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();function animateTo(e,t,r,n,i){var o=[];animateToShallow(e,"",e,t,r=r||{},n,o,i);var a=o.length,s=!1,l=r.done,c=r.aborted,u=function(){s=!0,--a<=0&&(s?l&&l():c&&c())},h=function(){--a<=0&&(s?l&&l():c&&c())};a||l&&l(),o.length>0&&r.during&&o[0].during((function(e,t){r.during(t)}));for(var d=0;d<o.length;d++){var p=o[d];u&&p.done(u),h&&p.aborted(h),r.force&&p.duration(r.duration),p.start(r.easing)}return o}function copyArrShallow(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function is2DArray(e){return isArrayLike(e[0])}function copyValue(e,t,r){if(isArrayLike(t[r]))if(isArrayLike(e[r])||(e[r]=[]),isTypedArray(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),copyArrShallow(e[r],t[r],n))}else{var i=t[r],o=e[r],a=i.length;if(is2DArray(i))for(var s=i[0].length,l=0;l<a;l++)o[l]?copyArrShallow(o[l],i[l],s):o[l]=Array.prototype.slice.call(i[l]);else copyArrShallow(o,i,a);o.length=i.length}else e[r]=t[r]}function isValueSame(e,t){return e===t||isArrayLike(e)&&isArrayLike(t)&&is1DArraySame(e,t)}function is1DArraySame(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function animateToShallow(e,t,r,n,i,o,a,s){for(var l=keys(n),c=i.duration,u=i.delay,h=i.additive,d=i.setToFinal,p=!isObject$1(o),f=e.animators,m=[],g=0;g<l.length;g++){var y=l[g],_=n[y];if(null!=_&&null!=r[y]&&(p||o[y]))if(!isObject$1(_)||isArrayLike(_)||isGradientObject(_))m.push(y);else{if(t){s||(r[y]=_,e.updateDuringAnimation(t));continue}animateToShallow(e,y,r[y],_,i,o&&o[y],a,s)}else s||(r[y]=_,e.updateDuringAnimation(t),m.push(y))}var v=m.length;if(!h&&v)for(var b=0;b<f.length;b++){if((x=f[b]).targetName===t)if(x.stopTracks(m)){var w=indexOf(f,x);f.splice(w,1)}}if(i.force||(v=(m=filter(m,(function(e){return!isValueSame(n[e],r[e])}))).length),v>0||i.force&&!a.length){var x,S=void 0,E=void 0,T=void 0;if(s){E={},d&&(S={});for(b=0;b<v;b++){E[y=m[b]]=r[y],d?S[y]=n[y]:r[y]=n[y]}}else if(d){T={};for(b=0;b<v;b++){T[y=m[b]]=cloneValue(r[y]),copyValue(r,n,y)}}(x=new Animator(r,!1,!1,h?filter(f,(function(e){return e.targetName===t})):null)).targetName=t,i.scope&&(x.scope=i.scope),d&&S&&x.whenWithKeys(0,S,m),T&&x.whenWithKeys(0,T,m),x.whenWithKeys(null==c?500:c,s?E:n,m).delay(u||0),e.addAnimator(x,t),a.push(x)}}mixin(Element$2,Eventful),mixin(Element$2,Transformable);var STYLE_MAGIC_KEY="__zr_style_"+Math.round(10*Math.random()),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0;var PRIMARY_STATES_KEYS=["z","z2","invisible"],PRIMARY_STATES_KEYS_IN_HOVER_LAYER=["invisible"],Displayable=function(e){function t(t){return e.call(this,t)||this}var r;return __extends(t,e),t.prototype._init=function(t){for(var r=keys(t),n=0;n<r.length;n++){var i=r[n];"style"===i?this.useStyle(t[i]):e.prototype.attrKV.call(this,i,t[i])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(e,t,r,n){var i=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&isDisplayableCulled(this,e,t)||i&&!i[0]&&!i[3])return!1;if(r&&this.__clipPaths&&this.__clipPaths.length)for(var o=0;o<this.__clipPaths.length;++o)if(this.__clipPaths[o].isZeroArea())return!1;if(n&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},t.prototype.contain=function(e,t){return this.rectContain(e,t)},t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.rectContain=function(e,t){var r=this.transformCoordToLocal(e,t);return this.getBoundingRect().contain(r[0],r[1])},t.prototype.getPaintRect=function(){var e=this._paintRect;if(!this._paintRect||this.__dirty){var t=this.transform,r=this.getBoundingRect(),n=this.style,i=n.shadowBlur||0,o=n.shadowOffsetX||0,a=n.shadowOffsetY||0;e=this._paintRect||(this._paintRect=new BoundingRect(0,0,0,0)),t?BoundingRect.applyTransform(e,r,t):e.copy(r),(i||o||a)&&(e.width+=2*i+Math.abs(o),e.height+=2*i+Math.abs(a),e.x=Math.min(e.x,e.x+o-i),e.y=Math.min(e.y,e.y+a-i));var s=this.dirtyRectTolerance;e.isZero()||(e.x=Math.floor(e.x-s),e.y=Math.floor(e.y-s),e.width=Math.ceil(e.width+1+2*s),e.height=Math.ceil(e.height+1+2*s))}return e},t.prototype.setPrevPaintRect=function(e){e?(this._prevPaintRect=this._prevPaintRect||new BoundingRect(0,0,0,0),this._prevPaintRect.copy(e)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(e){return this.animate("style",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(t,r){"style"!==t?e.prototype.attrKV.call(this,t,r):this.style?this.setStyle(r):this.useStyle(r)},t.prototype.setStyle=function(e,t){return"string"==typeof e?this.style[e]=t:extend$1(this.style,e),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(e){e||this.markRedraw(),this.__dirty|=STYLE_CHANGED_BIT,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&STYLE_CHANGED_BIT)},t.prototype.styleUpdated=function(){this.__dirty&=~STYLE_CHANGED_BIT},t.prototype.createStyle=function(e){return createObject(DEFAULT_COMMON_STYLE,e)},t.prototype.useStyle=function(e){e[STYLE_MAGIC_KEY]||(e=this.createStyle(e)),this.__inHover?this.__hoverStyle=e:this.style=e,this.dirtyStyle()},t.prototype.isStyleObject=function(e){return e[STYLE_MAGIC_KEY]},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.style&&!r.style&&(r.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,r,PRIMARY_STATES_KEYS)},t.prototype._applyStateObj=function(t,r,n,i,o,a){e.prototype._applyStateObj.call(this,t,r,n,i,o,a);var s,l=!(r&&i);if(r&&r.style?o?i?s=r.style:(s=this._mergeStyle(this.createStyle(),n.style),this._mergeStyle(s,r.style)):(s=this._mergeStyle(this.createStyle(),i?this.style:n.style),this._mergeStyle(s,r.style)):l&&(s=n.style),s)if(o){var c=this.style;if(this.style=this.createStyle(l?{}:c),l)for(var u=keys(c),h=0;h<u.length;h++){(p=u[h])in s&&(s[p]=s[p],this.style[p]=c[p])}var d=keys(s);for(h=0;h<d.length;h++){var p=d[h];this.style[p]=this.style[p]}this._transitionState(t,{style:s},a,this.getAnimationStyleProps())}else this.useStyle(s);var f=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS;for(h=0;h<f.length;h++){p=f[h];r&&null!=r[p]?this[p]=r[p]:l&&null!=n[p]&&(this[p]=n[p])}},t.prototype._mergeStates=function(t){for(var r,n=e.prototype._mergeStates.call(this,t),i=0;i<t.length;i++){var o=t[i];o.style&&(r=r||{},this._mergeStyle(r,o.style))}return r&&(n.style=r),n},t.prototype._mergeStyle=function(e,t){return extend$1(e,t),e},t.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},t.initDefaultProps=((r=t.prototype).type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,void(r.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT)),t}(Element$2),tmpRect$1=new BoundingRect(0,0,0,0),viewRect=new BoundingRect(0,0,0,0);function isDisplayableCulled(e,t,r){return tmpRect$1.copy(e.getBoundingRect()),e.transform&&tmpRect$1.applyTransform(e.transform),viewRect.width=t,viewRect.height=r,!tmpRect$1.intersect(viewRect)}var mathMin$3=Math.min,mathMax$3=Math.max,mathSin$3=Math.sin,mathCos$3=Math.cos,PI2$5=2*Math.PI,start=create(),end=create(),extremity=create();function fromPoints(e,t,r){if(0!==e.length){for(var n=e[0],i=n[0],o=n[0],a=n[1],s=n[1],l=1;l<e.length;l++)n=e[l],i=mathMin$3(i,n[0]),o=mathMax$3(o,n[0]),a=mathMin$3(a,n[1]),s=mathMax$3(s,n[1]);t[0]=i,t[1]=a,r[0]=o,r[1]=s}}function fromLine(e,t,r,n,i,o){i[0]=mathMin$3(e,r),i[1]=mathMin$3(t,n),o[0]=mathMax$3(e,r),o[1]=mathMax$3(t,n)}var xDim=[],yDim=[];function fromCubic(e,t,r,n,i,o,a,s,l,c){var u=cubicExtrema,h=cubicAt,d=u(e,r,i,a,xDim);l[0]=1/0,l[1]=1/0,c[0]=-1/0,c[1]=-1/0;for(var p=0;p<d;p++){var f=h(e,r,i,a,xDim[p]);l[0]=mathMin$3(f,l[0]),c[0]=mathMax$3(f,c[0])}d=u(t,n,o,s,yDim);for(p=0;p<d;p++){var m=h(t,n,o,s,yDim[p]);l[1]=mathMin$3(m,l[1]),c[1]=mathMax$3(m,c[1])}l[0]=mathMin$3(e,l[0]),c[0]=mathMax$3(e,c[0]),l[0]=mathMin$3(a,l[0]),c[0]=mathMax$3(a,c[0]),l[1]=mathMin$3(t,l[1]),c[1]=mathMax$3(t,c[1]),l[1]=mathMin$3(s,l[1]),c[1]=mathMax$3(s,c[1])}function fromQuadratic(e,t,r,n,i,o,a,s){var l=quadraticExtremum,c=quadraticAt,u=mathMax$3(mathMin$3(l(e,r,i),1),0),h=mathMax$3(mathMin$3(l(t,n,o),1),0),d=c(e,r,i,u),p=c(t,n,o,h);a[0]=mathMin$3(e,i,d),a[1]=mathMin$3(t,o,p),s[0]=mathMax$3(e,i,d),s[1]=mathMax$3(t,o,p)}function fromArc(e,t,r,n,i,o,a,s,l){var c=min$2,u=max$3,h=Math.abs(i-o);if(h%PI2$5<1e-4&&h>1e-4)return s[0]=e-r,s[1]=t-n,l[0]=e+r,void(l[1]=t+n);if(start[0]=mathCos$3(i)*r+e,start[1]=mathSin$3(i)*n+t,end[0]=mathCos$3(o)*r+e,end[1]=mathSin$3(o)*n+t,c(s,start,end),u(l,start,end),(i%=PI2$5)<0&&(i+=PI2$5),(o%=PI2$5)<0&&(o+=PI2$5),i>o&&!a?o+=PI2$5:i<o&&a&&(i+=PI2$5),a){var d=o;o=i,i=d}for(var p=0;p<o;p+=Math.PI/2)p>i&&(extremity[0]=mathCos$3(p)*r+e,extremity[1]=mathSin$3(p)*n+t,c(s,extremity,s),u(l,extremity,l))}var CMD$3={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min$1=[],max$2=[],min2=[],max2=[],mathMin$2=Math.min,mathMax$2=Math.max,mathCos$2=Math.cos,mathSin$2=Math.sin,mathAbs$2=Math.abs,PI$2=Math.PI,PI2$4=2*PI$2,hasTypedArray="undefined"!=typeof Float32Array,tmpAngles=[];function modPI2(e){return Math.round(e/PI$2*1e8)/1e8%2*PI$2}function normalizeArcAngles(e,t){var r=modPI2(e[0]);r<0&&(r+=PI2$4);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=PI2$4?i=r+PI2$4:t&&r-i>=PI2$4?i=r-PI2$4:!t&&r>i?i=r+(PI2$4-modPI2(r-i)):t&&r<i&&(i=r-(PI2$4-modPI2(i-r))),e[0]=r,e[1]=i}var PathProxy=function(){function e(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}var t;return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(e,t,r){(r=r||0)>0&&(this._ux=mathAbs$2(r/devicePixelRatio$1/e)||0,this._uy=mathAbs$2(r/devicePixelRatio$1/t)||0)},e.prototype.setDPR=function(e){this.dpr=e},e.prototype.setContext=function(e){this._ctx=e},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(CMD$3.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},e.prototype.lineTo=function(e,t){var r=mathAbs$2(e-this._xi),n=mathAbs$2(t-this._yi),i=r>this._ux||n>this._uy;if(this.addData(CMD$3.L,e,t),this._ctx&&i&&this._ctx.lineTo(e,t),i)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var o=r*r+n*n;o>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(e,t,r,n,i,o){return this._drawPendingPt(),this.addData(CMD$3.C,e,t,r,n,i,o),this._ctx&&this._ctx.bezierCurveTo(e,t,r,n,i,o),this._xi=i,this._yi=o,this},e.prototype.quadraticCurveTo=function(e,t,r,n){return this._drawPendingPt(),this.addData(CMD$3.Q,e,t,r,n),this._ctx&&this._ctx.quadraticCurveTo(e,t,r,n),this._xi=r,this._yi=n,this},e.prototype.arc=function(e,t,r,n,i,o){this._drawPendingPt(),tmpAngles[0]=n,tmpAngles[1]=i,normalizeArcAngles(tmpAngles,o),n=tmpAngles[0];var a=(i=tmpAngles[1])-n;return this.addData(CMD$3.A,e,t,r,r,n,a,0,o?0:1),this._ctx&&this._ctx.arc(e,t,r,n,i,o),this._xi=mathCos$2(i)*r+e,this._yi=mathSin$2(i)*r+t,this},e.prototype.arcTo=function(e,t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,r,n,i),this},e.prototype.rect=function(e,t,r,n){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,r,n),this.addData(CMD$3.R,e,t,r,n),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD$3.Z);var e=this._ctx,t=this._x0,r=this._y0;return e&&e.closePath(),this._xi=t,this._yi=r,this},e.prototype.fill=function(e){e&&e.fill(),this.toStatic()},e.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(e){if(this._saveData){var t=e.length;this.data&&this.data.length===t||!hasTypedArray||(this.data=new Float32Array(t));for(var r=0;r<t;r++)this.data[r]=e[r];this._len=t}},e.prototype.appendPath=function(e){if(this._saveData){e instanceof Array||(e=[e]);for(var t=e.length,r=0,n=this._len,i=0;i<t;i++)r+=e[i].len();var o=this.data;if(hasTypedArray&&(o instanceof Float32Array||!o)&&(this.data=new Float32Array(n+r),n>0&&o))for(var a=0;a<n;a++)this.data[a]=o[a];for(i=0;i<t;i++){var s=e[i].data;for(a=0;a<s.length;a++)this.data[n++]=s[a]}this._len=n}},e.prototype.addData=function(e,t,r,n,i,o,a,s,l){if(this._saveData){var c=this.data;this._len+arguments.length>c.length&&(this._expandData(),c=this.data);for(var u=0;u<arguments.length;u++)c[this._len++]=arguments[u]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,hasTypedArray&&this._len>11&&(this.data=new Float32Array(e)))}},e.prototype.getBoundingRect=function(){min$1[0]=min$1[1]=min2[0]=min2[1]=Number.MAX_VALUE,max$2[0]=max$2[1]=max2[0]=max2[1]=-Number.MAX_VALUE;var e,t=this.data,r=0,n=0,i=0,o=0;for(e=0;e<this._len;){var a=t[e++],s=1===e;switch(s&&(i=r=t[e],o=n=t[e+1]),a){case CMD$3.M:r=i=t[e++],n=o=t[e++],min2[0]=i,min2[1]=o,max2[0]=i,max2[1]=o;break;case CMD$3.L:fromLine(r,n,t[e],t[e+1],min2,max2),r=t[e++],n=t[e++];break;case CMD$3.C:fromCubic(r,n,t[e++],t[e++],t[e++],t[e++],t[e],t[e+1],min2,max2),r=t[e++],n=t[e++];break;case CMD$3.Q:fromQuadratic(r,n,t[e++],t[e++],t[e],t[e+1],min2,max2),r=t[e++],n=t[e++];break;case CMD$3.A:var l=t[e++],c=t[e++],u=t[e++],h=t[e++],d=t[e++],p=t[e++]+d;e+=1;var f=!t[e++];s&&(i=mathCos$2(d)*u+l,o=mathSin$2(d)*h+c),fromArc(l,c,u,h,d,p,f,min2,max2),r=mathCos$2(p)*u+l,n=mathSin$2(p)*h+c;break;case CMD$3.R:fromLine(i=r=t[e++],o=n=t[e++],i+t[e++],o+t[e++],min2,max2);break;case CMD$3.Z:r=i,n=o}min$2(min$1,min$1,min2),max$3(max$2,max$2,max2)}return 0===e&&(min$1[0]=min$1[1]=max$2[0]=max$2[1]=0),new BoundingRect(min$1[0],min$1[1],max$2[0]-min$1[0],max$2[1]-min$1[1])},e.prototype._calculateLength=function(){var e=this.data,t=this._len,r=this._ux,n=this._uy,i=0,o=0,a=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var l=this._pathSegLen,c=0,u=0,h=0;h<t;){var d=e[h++],p=1===h;p&&(a=i=e[h],s=o=e[h+1]);var f=-1;switch(d){case CMD$3.M:i=a=e[h++],o=s=e[h++];break;case CMD$3.L:var m=e[h++],g=(v=e[h++])-o;(mathAbs$2(k=m-i)>r||mathAbs$2(g)>n||h===t-1)&&(f=Math.sqrt(k*k+g*g),i=m,o=v);break;case CMD$3.C:var y=e[h++],_=e[h++],v=(m=e[h++],e[h++]),b=e[h++],w=e[h++];f=cubicLength(i,o,y,_,m,v,b,w,10),i=b,o=w;break;case CMD$3.Q:f=quadraticLength(i,o,y=e[h++],_=e[h++],m=e[h++],v=e[h++],10),i=m,o=v;break;case CMD$3.A:var x=e[h++],S=e[h++],E=e[h++],T=e[h++],A=e[h++],C=e[h++],I=C+A;h+=1,p&&(a=mathCos$2(A)*E+x,s=mathSin$2(A)*T+S),f=mathMax$2(E,T)*mathMin$2(PI2$4,Math.abs(C)),i=mathCos$2(I)*E+x,o=mathSin$2(I)*T+S;break;case CMD$3.R:a=i=e[h++],s=o=e[h++],f=2*e[h++]+2*e[h++];break;case CMD$3.Z:var k=a-i;g=s-o;f=Math.sqrt(k*k+g*g),i=a,o=s}f>=0&&(l[u++]=f,c+=f)}return this._pathLen=c,c},e.prototype.rebuildPath=function(e,t){var r,n,i,o,a,s,l,c,u,h,d=this.data,p=this._ux,f=this._uy,m=this._len,g=t<1,y=0,_=0,v=0;if(!g||(this._pathSegLen||this._calculateLength(),l=this._pathSegLen,c=t*this._pathLen))e:for(var b=0;b<m;){var w=d[b++],x=1===b;switch(x&&(r=i=d[b],n=o=d[b+1]),w!==CMD$3.L&&v>0&&(e.lineTo(u,h),v=0),w){case CMD$3.M:r=i=d[b++],n=o=d[b++],e.moveTo(i,o);break;case CMD$3.L:a=d[b++],s=d[b++];var S=mathAbs$2(a-i),E=mathAbs$2(s-o);if(S>p||E>f){if(g){if(y+(Z=l[_++])>c){var T=(c-y)/Z;e.lineTo(i*(1-T)+a*T,o*(1-T)+s*T);break e}y+=Z}e.lineTo(a,s),i=a,o=s,v=0}else{var A=S*S+E*E;A>v&&(u=a,h=s,v=A)}break;case CMD$3.C:var C=d[b++],I=d[b++],k=d[b++],P=d[b++],M=d[b++],R=d[b++];if(g){if(y+(Z=l[_++])>c){cubicSubdivide(i,C,k,M,T=(c-y)/Z,tmpOutX),cubicSubdivide(o,I,P,R,T,tmpOutY),e.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break e}y+=Z}e.bezierCurveTo(C,I,k,P,M,R),i=M,o=R;break;case CMD$3.Q:C=d[b++],I=d[b++],k=d[b++],P=d[b++];if(g){if(y+(Z=l[_++])>c){quadraticSubdivide(i,C,k,T=(c-y)/Z,tmpOutX),quadraticSubdivide(o,I,P,T,tmpOutY),e.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break e}y+=Z}e.quadraticCurveTo(C,I,k,P),i=k,o=P;break;case CMD$3.A:var D=d[b++],O=d[b++],L=d[b++],B=d[b++],$=d[b++],z=d[b++],F=d[b++],q=!d[b++],N=L>B?L:B,j=mathAbs$2(L-B)>.001,U=$+z,V=!1;if(g)y+(Z=l[_++])>c&&(U=$+z*(c-y)/Z,V=!0),y+=Z;if(j&&e.ellipse?e.ellipse(D,O,L,B,F,$,U,q):e.arc(D,O,N,$,U,q),V)break e;x&&(r=mathCos$2($)*L+D,n=mathSin$2($)*B+O),i=mathCos$2(U)*L+D,o=mathSin$2(U)*B+O;break;case CMD$3.R:r=i=d[b],n=o=d[b+1],a=d[b++],s=d[b++];var G=d[b++],W=d[b++];if(g){if(y+(Z=l[_++])>c){var H=c-y;e.moveTo(a,s),e.lineTo(a+mathMin$2(H,G),s),(H-=G)>0&&e.lineTo(a+G,s+mathMin$2(H,W)),(H-=W)>0&&e.lineTo(a+mathMax$2(G-H,0),s+W),(H-=G)>0&&e.lineTo(a,s+mathMax$2(W-H,0));break e}y+=Z}e.rect(a,s,G,W);break;case CMD$3.Z:if(g){var Z;if(y+(Z=l[_++])>c){T=(c-y)/Z;e.lineTo(i*(1-T)+r*T,o*(1-T)+n*T);break e}y+=Z}e.closePath(),i=r,o=n}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.prototype.canSave=function(){return!!this._saveData},e.CMD=CMD$3,e.initDefaultProps=((t=e.prototype)._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,void(t._version=0)),e}();function containStroke$4(e,t,r,n,i,o,a){if(0===i)return!1;var s=i,l=0;if(a>t+s&&a>n+s||a<t-s&&a<n-s||o>e+s&&o>r+s||o<e-s&&o<r-s)return!1;if(e===r)return Math.abs(o-e)<=s/2;var c=(l=(t-n)/(e-r))*o-a+(e*n-r*t)/(e-r);return c*c/(l*l+1)<=s/2*s/2}function containStroke$3(e,t,r,n,i,o,a,s,l,c,u){if(0===l)return!1;var h=l;return!(u>t+h&&u>n+h&&u>o+h&&u>s+h||u<t-h&&u<n-h&&u<o-h&&u<s-h||c>e+h&&c>r+h&&c>i+h&&c>a+h||c<e-h&&c<r-h&&c<i-h&&c<a-h)&&cubicProjectPoint(e,t,r,n,i,o,a,s,c,u,null)<=h/2}function containStroke$2(e,t,r,n,i,o,a,s,l){if(0===a)return!1;var c=a;return!(l>t+c&&l>n+c&&l>o+c||l<t-c&&l<n-c&&l<o-c||s>e+c&&s>r+c&&s>i+c||s<e-c&&s<r-c&&s<i-c)&&quadraticProjectPoint(e,t,r,n,i,o,s,l,null)<=c/2}var PI2$3=2*Math.PI;function normalizeRadian(e){return(e%=PI2$3)<0&&(e+=PI2$3),e}var PI2$2=2*Math.PI;function containStroke$1(e,t,r,n,i,o,a,s,l){if(0===a)return!1;var c=a;s-=e,l-=t;var u=Math.sqrt(s*s+l*l);if(u-c>r||u+c<r)return!1;if(Math.abs(n-i)%PI2$2<1e-4)return!0;if(o){var h=n;n=normalizeRadian(i),i=normalizeRadian(h)}else n=normalizeRadian(n),i=normalizeRadian(i);n>i&&(i+=PI2$2);var d=Math.atan2(l,s);return d<0&&(d+=PI2$2),d>=n&&d<=i||d+PI2$2>=n&&d+PI2$2<=i}function windingLine(e,t,r,n,i,o){if(o>t&&o>n||o<t&&o<n)return 0;if(n===t)return 0;var a=(o-t)/(n-t),s=n<t?1:-1;1!==a&&0!==a||(s=n<t?.5:-.5);var l=a*(r-e)+e;return l===i?1/0:l>i?s:0}var CMD$2=PathProxy.CMD,PI2$1=2*Math.PI,EPSILON$1=1e-4;function isAroundEqual$1(e,t){return Math.abs(e-t)<EPSILON$1}var roots=[-1,-1,-1],extrema=[-1,-1];function swapExtrema(){var e=extrema[0];extrema[0]=extrema[1],extrema[1]=e}function windingCubic(e,t,r,n,i,o,a,s,l,c){if(c>t&&c>n&&c>o&&c>s||c<t&&c<n&&c<o&&c<s)return 0;var u=cubicRootAt(t,n,o,s,c,roots);if(0===u)return 0;for(var h=0,d=-1,p=void 0,f=void 0,m=0;m<u;m++){var g=roots[m],y=0===g||1===g?.5:1;cubicAt(e,r,i,a,g)<l||(d<0&&(d=cubicExtrema(t,n,o,s,extrema),extrema[1]<extrema[0]&&d>1&&swapExtrema(),p=cubicAt(t,n,o,s,extrema[0]),d>1&&(f=cubicAt(t,n,o,s,extrema[1]))),2===d?g<extrema[0]?h+=p<t?y:-y:g<extrema[1]?h+=f<p?y:-y:h+=s<f?y:-y:g<extrema[0]?h+=p<t?y:-y:h+=s<p?y:-y)}return h}function windingQuadratic(e,t,r,n,i,o,a,s){if(s>t&&s>n&&s>o||s<t&&s<n&&s<o)return 0;var l=quadraticRootAt(t,n,o,s,roots);if(0===l)return 0;var c=quadraticExtremum(t,n,o);if(c>=0&&c<=1){for(var u=0,h=quadraticAt(t,n,o,c),d=0;d<l;d++){var p=0===roots[d]||1===roots[d]?.5:1;quadraticAt(e,r,i,roots[d])<a||(roots[d]<c?u+=h<t?p:-p:u+=o<h?p:-p)}return u}p=0===roots[0]||1===roots[0]?.5:1;return quadraticAt(e,r,i,roots[0])<a?0:o<t?p:-p}function windingArc(e,t,r,n,i,o,a,s){if((s-=t)>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);roots[0]=-l,roots[1]=l;var c=Math.abs(n-i);if(c<1e-4)return 0;if(c>=PI2$1-1e-4){n=0,i=PI2$1;var u=o?1:-1;return a>=roots[0]+e&&a<=roots[1]+e?u:0}if(n>i){var h=n;n=i,i=h}n<0&&(n+=PI2$1,i+=PI2$1);for(var d=0,p=0;p<2;p++){var f=roots[p];if(f+e>a){var m=Math.atan2(s,f);u=o?1:-1;m<0&&(m=PI2$1+m),(m>=n&&m<=i||m+PI2$1>=n&&m+PI2$1<=i)&&(m>Math.PI/2&&m<1.5*Math.PI&&(u=-u),d+=u)}}return d}function containPath(e,t,r,n,i){for(var o,a,s=e.data,l=e.len(),c=0,u=0,h=0,d=0,p=0,f=0;f<l;){var m=s[f++],g=1===f;switch(m===CMD$2.M&&f>1&&(r||(c+=windingLine(u,h,d,p,n,i))),g&&(d=u=s[f],p=h=s[f+1]),m){case CMD$2.M:u=d=s[f++],h=p=s[f++];break;case CMD$2.L:if(r){if(containStroke$4(u,h,s[f],s[f+1],t,n,i))return!0}else c+=windingLine(u,h,s[f],s[f+1],n,i)||0;u=s[f++],h=s[f++];break;case CMD$2.C:if(r){if(containStroke$3(u,h,s[f++],s[f++],s[f++],s[f++],s[f],s[f+1],t,n,i))return!0}else c+=windingCubic(u,h,s[f++],s[f++],s[f++],s[f++],s[f],s[f+1],n,i)||0;u=s[f++],h=s[f++];break;case CMD$2.Q:if(r){if(containStroke$2(u,h,s[f++],s[f++],s[f],s[f+1],t,n,i))return!0}else c+=windingQuadratic(u,h,s[f++],s[f++],s[f],s[f+1],n,i)||0;u=s[f++],h=s[f++];break;case CMD$2.A:var y=s[f++],_=s[f++],v=s[f++],b=s[f++],w=s[f++],x=s[f++];f+=1;var S=!!(1-s[f++]);o=Math.cos(w)*v+y,a=Math.sin(w)*b+_,g?(d=o,p=a):c+=windingLine(u,h,o,a,n,i);var E=(n-y)*b/v+y;if(r){if(containStroke$1(y,_,b,w,w+x,S,t,E,i))return!0}else c+=windingArc(y,_,b,w,w+x,S,E,i);u=Math.cos(w+x)*v+y,h=Math.sin(w+x)*b+_;break;case CMD$2.R:if(d=u=s[f++],p=h=s[f++],o=d+s[f++],a=p+s[f++],r){if(containStroke$4(d,p,o,p,t,n,i)||containStroke$4(o,p,o,a,t,n,i)||containStroke$4(o,a,d,a,t,n,i)||containStroke$4(d,a,d,p,t,n,i))return!0}else c+=windingLine(o,p,o,a,n,i),c+=windingLine(d,a,d,p,n,i);break;case CMD$2.Z:if(r){if(containStroke$4(u,h,d,p,t,n,i))return!0}else c+=windingLine(u,h,d,p,n,i);u=d,h=p}}return r||isAroundEqual$1(h,p)||(c+=windingLine(u,h,d,p,n,i)||0),0!==c}function contain$1(e,t,r){return containPath(e,0,!1,t,r)}function containStroke(e,t,r,n){return containPath(e,t,!0,r,n)}var DEFAULT_PATH_STYLE=defaults({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat(["invisible","culling","z","z2","zlevel","parent"]),Path=function(e){function t(t){return e.call(this,t)||this}var r;return __extends(t,e),t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(e){r.buildPath(e,r.shape)}),i.silent=!0;var o=i.style;for(var a in n)o[a]!==n[a]&&(o[a]=n[a]);o.fill=n.fill?n.decal:null,o.decal=null,o.shadowColor=null,n.strokeFirst&&(o.stroke=null);for(var s=0;s<pathCopyParams.length;++s)i[pathCopyParams[s]]=this[pathCopyParams[s]];i.__dirty|=REDRAW_BIT}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(t){var r=keys(t);this.shape=this.getDefaultShape();var n=this.getDefaultStyle();n&&this.useStyle(n);for(var i=0;i<r.length;i++){var o=r[i],a=t[o];"style"===o?this.style?extend$1(this.style,a):this.useStyle(a):"shape"===o?extend$1(this.shape,a):e.prototype.attrKV.call(this,o,a)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var e=this.style.fill;if("none"!==e){if(isString(e)){var t=lum(e,0);return t>.5?DARK_LABEL_COLOR:t>.2?LIGHTER_LABEL_COLOR:LIGHT_LABEL_COLOR}if(e)return LIGHT_LABEL_COLOR}return DARK_LABEL_COLOR},t.prototype.getInsideTextStroke=function(e){var t=this.style.fill;if(isString(t)){var r=this.__zr;if(!(!r||!r.isDarkMode())===lum(e,0)<DARK_MODE_THRESHOLD)return t}},t.prototype.buildPath=function(e,t,r){},t.prototype.pathUpdated=function(){this.__dirty&=~SHAPE_CHANGED_BIT},t.prototype.getUpdatedPathProxy=function(e){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,e),this.path},t.prototype.createPathProxy=function(){this.path=new PathProxy(!1)},t.prototype.hasStroke=function(){var e=this.style,t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.getBoundingRect=function(){var e=this._rect,t=this.style,r=!e;if(r){var n=!1;this.path||(n=!0,this.createPathProxy());var i=this.path;(n||this.__dirty&SHAPE_CHANGED_BIT)&&(i.beginPath(),this.buildPath(i,this.shape,!1),this.pathUpdated()),e=i.getBoundingRect()}if(this._rect=e,this.hasStroke()&&this.path&&this.path.len()>0){var o=this._rectStroke||(this._rectStroke=e.clone());if(this.__dirty||r){o.copy(e);var a=t.strokeNoScale?this.getLineScale():1,s=t.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,null==l?4:l)}a>1e-10&&(o.width+=s/a,o.height+=s/a,o.x-=s/a/2,o.y-=s/a/2)}return o}return e},t.prototype.contain=function(e,t){var r=this.transformCoordToLocal(e,t),n=this.getBoundingRect(),i=this.style;if(e=r[0],t=r[1],n.contain(e,t)){var o=this.path;if(this.hasStroke()){var a=i.lineWidth,s=i.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),containStroke(o,a/s,e,t)))return!0}if(this.hasFill())return contain$1(o,e,t)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=SHAPE_CHANGED_BIT,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(e){return this.animate("shape",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():"shape"===e?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(t,r){"shape"===t?this.setShape(r):e.prototype.attrKV.call(this,t,r)},t.prototype.setShape=function(e,t){var r=this.shape;return r||(r=this.shape={}),"string"==typeof e?r[e]=t:extend$1(r,e),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&SHAPE_CHANGED_BIT)},t.prototype.createStyle=function(e){return createObject(DEFAULT_PATH_STYLE,e)},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.shape&&!r.shape&&(r.shape=extend$1({},this.shape))},t.prototype._applyStateObj=function(t,r,n,i,o,a){e.prototype._applyStateObj.call(this,t,r,n,i,o,a);var s,l=!(r&&i);if(r&&r.shape?o?i?s=r.shape:(s=extend$1({},n.shape),extend$1(s,r.shape)):(s=extend$1({},i?this.shape:n.shape),extend$1(s,r.shape)):l&&(s=n.shape),s)if(o){this.shape=extend$1({},this.shape);for(var c={},u=keys(s),h=0;h<u.length;h++){var d=u[h];"object"==typeof s[d]?this.shape[d]=s[d]:c[d]=s[d]}this._transitionState(t,{shape:c},a)}else this.shape=s,this.dirtyShape()},t.prototype._mergeStates=function(t){for(var r,n=e.prototype._mergeStates.call(this,t),i=0;i<t.length;i++){var o=t[i];o.shape&&(r=r||{},this._mergeStyle(r,o.shape))}return r&&(n.shape=r),n},t.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},t.prototype.isZeroArea=function(){return!1},t.extend=function(e){var r=function(t){function r(r){var n=t.call(this,r)||this;return e.init&&e.init.call(n,r),n}return __extends(r,t),r.prototype.getDefaultStyle=function(){return clone$4(e.style)},r.prototype.getDefaultShape=function(){return clone$4(e.shape)},r}(t);for(var n in e)"function"==typeof e[n]&&(r.prototype[n]=e[n]);return r},t.initDefaultProps=((r=t.prototype).type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,void(r.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT|SHAPE_CHANGED_BIT)),t}(Displayable),DEFAULT_TSPAN_STYLE=defaults({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.hasStroke=function(){return tSpanHasStroke(this.style)},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.createStyle=function(e){return createObject(DEFAULT_TSPAN_STYLE,e)},t.prototype.setBoundingRect=function(e){this._rect=e},t.prototype.getBoundingRect=function(){return this._rect||(this._rect=tSpanCreateBoundingRect(this.style)),this._rect},t.initDefaultProps=void(t.prototype.dirtyRectTolerance=10),t}(Displayable);TSpan.prototype.type="tspan";var DEFAULT_IMAGE_STYLE=defaults({x:0,y:0},DEFAULT_COMMON_STYLE),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};function isImageLike(e){return!!(e&&"string"!=typeof e&&e.width&&e.height)}var ZRImage=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createStyle=function(e){return createObject(DEFAULT_IMAGE_STYLE,e)},t.prototype._getSize=function(e){var t=this.style,r=t[e];if(null!=r)return r;var n=isImageLike(t.image)?t.image:this.__image;if(!n)return 0;var i="width"===e?"height":"width",o=t[i];return null==o?n[e]:n[e]/n[i]*o},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},t.prototype.getBoundingRect=function(){var e=this.style;return this._rect||(this._rect=new BoundingRect(e.x||0,e.y||0,this.getWidth(),this.getHeight())),this._rect},t}(Displayable);function buildPath$2(e,t){var r,n,i,o,a,s=t.x,l=t.y,c=t.width,u=t.height,h=t.r;c<0&&(s+=c,c=-c),u<0&&(l+=u,u=-u),"number"==typeof h?r=n=i=o=h:h instanceof Array?1===h.length?r=n=i=o=h[0]:2===h.length?(r=i=h[0],n=o=h[1]):3===h.length?(r=h[0],n=o=h[1],i=h[2]):(r=h[0],n=h[1],i=h[2],o=h[3]):r=n=i=o=0,r+n>c&&(r*=c/(a=r+n),n*=c/a),i+o>c&&(i*=c/(a=i+o),o*=c/a),n+i>u&&(n*=u/(a=n+i),i*=u/a),r+o>u&&(r*=u/(a=r+o),o*=u/a),e.moveTo(s+r,l),e.lineTo(s+c-n,l),0!==n&&e.arc(s+c-n,l+n,n,-Math.PI/2,0),e.lineTo(s+c,l+u-i),0!==i&&e.arc(s+c-i,l+u-i,i,0,Math.PI/2),e.lineTo(s+o,l+u),0!==o&&e.arc(s+o,l+u-o,o,Math.PI/2,Math.PI),e.lineTo(s,l+r),0!==r&&e.arc(s+r,l+r,r,Math.PI,1.5*Math.PI)}ZRImage.prototype.type="image";var round=Math.round;function subPixelOptimizeLine(e,t,r){if(t){var n=t.x1,i=t.x2,o=t.y1,a=t.y2;e.x1=n,e.x2=i,e.y1=o,e.y2=a;var s=r&&r.lineWidth;return s?(round(2*n)===round(2*i)&&(e.x1=e.x2=subPixelOptimize(n,s,!0)),round(2*o)===round(2*a)&&(e.y1=e.y2=subPixelOptimize(o,s,!0)),e):e}}function subPixelOptimizeRect(e,t,r){if(t){var n=t.x,i=t.y,o=t.width,a=t.height;e.x=n,e.y=i,e.width=o,e.height=a;var s=r&&r.lineWidth;return s?(e.x=subPixelOptimize(n,s,!0),e.y=subPixelOptimize(i,s,!0),e.width=Math.max(subPixelOptimize(n+o,s,!1)-e.x,0===o?0:1),e.height=Math.max(subPixelOptimize(i+a,s,!1)-e.y,0===a?0:1),e):e}}function subPixelOptimize(e,t,r){if(!t)return e;var n=round(2*e);return(n+round(t))%2==0?n/2:(n+(r?1:-1))/2}var RectShape=function(){return function(){this.x=0,this.y=0,this.width=0,this.height=0}}(),subPixelOptimizeOutputShape$1={},Rect=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new RectShape},t.prototype.buildPath=function(e,t){var r,n,i,o;if(this.subPixelOptimize){var a=subPixelOptimizeRect(subPixelOptimizeOutputShape$1,t,this.style);r=a.x,n=a.y,i=a.width,o=a.height,a.r=t.r,t=a}else r=t.x,n=t.y,i=t.width,o=t.height;t.r?buildPath$2(e,t):e.rect(r,n,i,o)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(Path);Rect.prototype.type="rect";var DEFAULT_RICH_TEXT_COLOR={fill:"#000"},DEFAULT_STROKE_LINE_WIDTH=2,tmpCITOverflowAreaOut={},DEFAULT_TEXT_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(e){function t(t){var r=e.call(this)||this;return r.type="text",r._children=[],r._defaultStyle=DEFAULT_RICH_TEXT_COLOR,r.attr(t),r}return __extends(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var r=this._children[t];r.zlevel=this.zlevel,r.z=this.z,r.z2=this.z2,r.culling=this.culling,r.cursor=this.cursor,r.invisible=this.invisible}},t.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(t){var r=this.innerTransformable;return r?r.getLocalTransform(t):e.prototype.getLocalTransform.call(this,t)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,normalizeTextStyle(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=t},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var e=new BoundingRect(0,0,0,0),t=this._children,r=[],n=null,i=0;i<t.length;i++){var o=t[i],a=o.getBoundingRect(),s=o.getLocalTransform(r);s?(e.copy(a),e.applyTransform(s),(n=n||e.clone()).union(e)):(n=n||a.clone()).union(a)}this._rect=n||e}return this._rect},t.prototype.setDefaultTextStyle=function(e){this._defaultStyle=e||DEFAULT_RICH_TEXT_COLOR},t.prototype.setTextContent=function(e){},t.prototype._mergeStyle=function(e,t){if(!t)return e;var r=t.rich,n=e.rich||r&&{};return extend$1(e,t),r&&n?(this._mergeRich(n,r),e.rich=n):n&&(e.rich=n),e},t.prototype._mergeRich=function(e,t){for(var r=keys(t),n=0;n<r.length;n++){var i=r[n];e[i]=e[i]||{},extend$1(e[i],t[i])}},t.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},t.prototype._getOrCreateChild=function(e){var t=this._children[this._childCursor];return t&&t instanceof e||(t=new e),this._children[this._childCursor++]=t,t.__zr=this.__zr,t.parent=this,t},t.prototype._updatePlainTexts=function(){var e=this.style,t=e.font||DEFAULT_FONT,r=e.padding,n=this._defaultStyle,i=e.x||0,o=e.y||0,a=e.align||n.align||"left",s=e.verticalAlign||n.verticalAlign||"top";calcInnerTextOverflowArea(tmpCITOverflowAreaOut,n.overflowRect,i,o,a,s),i=tmpCITOverflowAreaOut.baseX,o=tmpCITOverflowAreaOut.baseY;var l=parsePlainText(getStyleText(e),e,tmpCITOverflowAreaOut.outerWidth,tmpCITOverflowAreaOut.outerHeight),c=needDrawBackground(e),u=!!e.backgroundColor,h=l.outerHeight,d=l.outerWidth,p=l.lines,f=l.lineHeight;this.isTruncated=!!l.isTruncated;var m=i,g=adjustTextY(o,l.contentHeight,s);if(c||r){var y=adjustTextX(i,d,a),_=adjustTextY(o,h,s);c&&this._renderBackground(e,e,y,_,d,h)}g+=f/2,r&&(m=getTextXForPadding(i,a,r),"top"===s?g+=r[0]:"bottom"===s&&(g-=r[2]));for(var v=0,b=!1,w=!1,x=(getFill("fill"in e?e.fill:(w=!0,n.fill))),S=(getStroke("stroke"in e?e.stroke:u||n.autoStroke&&!w?null:(v=DEFAULT_STROKE_LINE_WIDTH,b=!0,n.stroke))),E=e.textShadowBlur>0,T=0;T<p.length;T++){var A=this._getOrCreateChild(TSpan),C=A.createStyle();A.useStyle(C),C.text=p[T],C.x=m,C.y=g,C.textAlign=a,C.textBaseline="middle",C.opacity=e.opacity,C.strokeFirst=!0,E&&(C.shadowBlur=e.textShadowBlur||0,C.shadowColor=e.textShadowColor||"transparent",C.shadowOffsetX=e.textShadowOffsetX||0,C.shadowOffsetY=e.textShadowOffsetY||0),C.stroke=S,C.fill=x,S&&(C.lineWidth=e.lineWidth||v,C.lineDash=e.lineDash,C.lineDashOffset=e.lineDashOffset||0),C.font=t,setSeparateFont(C,e),g+=f,A.setBoundingRect(tSpanCreateBoundingRect2(C,l.contentWidth,l.calculatedLineHeight,b?0:null))}},t.prototype._updateRichTexts=function(){var e=this.style,t=this._defaultStyle,r=e.align||t.align,n=e.verticalAlign||t.verticalAlign,i=e.x||0,o=e.y||0;calcInnerTextOverflowArea(tmpCITOverflowAreaOut,t.overflowRect,i,o,r,n),i=tmpCITOverflowAreaOut.baseX,o=tmpCITOverflowAreaOut.baseY;var a=parseRichText(getStyleText(e),e,tmpCITOverflowAreaOut.outerWidth,tmpCITOverflowAreaOut.outerHeight,r),s=a.width,l=a.outerWidth,c=a.outerHeight,u=e.padding;this.isTruncated=!!a.isTruncated;var h=adjustTextX(i,l,r),d=adjustTextY(o,c,n),p=h,f=d;u&&(p+=u[3],f+=u[0]);var m=p+s;needDrawBackground(e)&&this._renderBackground(e,e,h,d,l,c);for(var g=!!e.backgroundColor,y=0;y<a.lines.length;y++){for(var _=a.lines[y],v=_.tokens,b=v.length,w=_.lineHeight,x=_.width,S=0,E=p,T=m,A=b-1,C=void 0;S<b&&(!(C=v[S]).align||"left"===C.align);)this._placeToken(C,e,w,f,E,"left",g),x-=C.width,E+=C.width,S++;for(;A>=0&&"right"===(C=v[A]).align;)this._placeToken(C,e,w,f,T,"right",g),x-=C.width,T-=C.width,A--;for(E+=(s-(E-p)-(m-T)-x)/2;S<=A;)C=v[S],this._placeToken(C,e,w,f,E+C.width/2,"center",g),E+=C.width,S++;f+=w}},t.prototype._placeToken=function(e,t,r,n,i,o,a){var s=t.rich[e.styleName]||{};s.text=e.text;var l=e.verticalAlign,c=n+r/2;"top"===l?c=n+e.height/2:"bottom"===l&&(c=n+r-e.height/2),!e.isLineHolder&&needDrawBackground(s)&&this._renderBackground(s,t,"right"===o?i-e.width:"center"===o?i-e.width/2:i,c-e.height/2,e.width,e.height);var u=!!s.backgroundColor,h=e.textPadding;h&&(i=getTextXForPadding(i,o,h),c-=e.height/2-h[0]-e.innerHeight/2);var d=this._getOrCreateChild(TSpan),p=d.createStyle();d.useStyle(p);var f=this._defaultStyle,m=!1,g=0,y=!1,_=getFill("fill"in s?s.fill:"fill"in t?t.fill:(m=!0,f.fill)),v=getStroke("stroke"in s?s.stroke:"stroke"in t?t.stroke:u||a||f.autoStroke&&!m?null:(g=DEFAULT_STROKE_LINE_WIDTH,y=!0,f.stroke)),b=s.textShadowBlur>0||t.textShadowBlur>0;p.text=e.text,p.x=i,p.y=c,b&&(p.shadowBlur=s.textShadowBlur||t.textShadowBlur||0,p.shadowColor=s.textShadowColor||t.textShadowColor||"transparent",p.shadowOffsetX=s.textShadowOffsetX||t.textShadowOffsetX||0,p.shadowOffsetY=s.textShadowOffsetY||t.textShadowOffsetY||0),p.textAlign=o,p.textBaseline="middle",p.font=e.font||DEFAULT_FONT,p.opacity=retrieve3(s.opacity,t.opacity,1),setSeparateFont(p,s),v&&(p.lineWidth=retrieve3(s.lineWidth,t.lineWidth,g),p.lineDash=retrieve2(s.lineDash,t.lineDash),p.lineDashOffset=t.lineDashOffset||0,p.stroke=v),_&&(p.fill=_),d.setBoundingRect(tSpanCreateBoundingRect2(p,e.contentWidth,e.contentHeight,y?0:null))},t.prototype._renderBackground=function(e,t,r,n,i,o){var a,s,l,c=e.backgroundColor,u=e.borderWidth,h=e.borderColor,d=c&&c.image,p=c&&!d,f=e.borderRadius,m=this;if(p||e.lineHeight||u&&h){(a=this._getOrCreateChild(Rect)).useStyle(a.createStyle()),a.style.fill=null;var g=a.shape;g.x=r,g.y=n,g.width=i,g.height=o,g.r=f,a.dirtyShape()}if(p)(l=a.style).fill=c||null,l.fillOpacity=retrieve2(e.fillOpacity,1);else if(d){(s=this._getOrCreateChild(ZRImage)).onload=function(){m.dirtyStyle()};var y=s.style;y.image=c.image,y.x=r,y.y=n,y.width=i,y.height=o}u&&h&&((l=a.style).lineWidth=u,l.stroke=h,l.strokeOpacity=retrieve2(e.strokeOpacity,1),l.lineDash=e.borderDash,l.lineDashOffset=e.borderDashOffset||0,a.strokeContainThreshold=0,a.hasFill()&&a.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var _=(a||s).style;_.shadowBlur=e.shadowBlur||0,_.shadowColor=e.shadowColor||"transparent",_.shadowOffsetX=e.shadowOffsetX||0,_.shadowOffsetY=e.shadowOffsetY||0,_.opacity=retrieve3(e.opacity,t.opacity,1)},t.makeFont=function(e){var t="";return hasSeparateFont(e)&&(t=[e.fontStyle,e.fontWeight,parseFontSize(e.fontSize),e.fontFamily||"sans-serif"].join(" ")),t&&trim(t)||e.textFont||e.font},t}(Displayable),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=["fontStyle","fontWeight","fontSize","fontFamily"];function parseFontSize(e){return"string"!=typeof e||-1===e.indexOf("px")&&-1===e.indexOf("rem")&&-1===e.indexOf("em")?isNaN(+e)?DEFAULT_FONT_SIZE+"px":e+"px":e}function setSeparateFont(e,t){for(var r=0;r<FONT_PARTS.length;r++){var n=FONT_PARTS[r],i=t[n];null!=i&&(e[n]=i)}}function hasSeparateFont(e){return null!=e.fontSize||e.fontFamily||e.fontWeight}function normalizeTextStyle(e){return normalizeStyle(e),each(e.rich,normalizeStyle),e}function normalizeStyle(e){if(e){e.font=ZRText.makeFont(e);var t=e.align;"middle"===t&&(t="center"),e.align=null==t||VALID_TEXT_ALIGN[t]?t:"left";var r=e.verticalAlign;"center"===r&&(r="middle"),e.verticalAlign=null==r||VALID_TEXT_VERTICAL_ALIGN[r]?r:"top",e.padding&&(e.padding=normalizeCssArray(e.padding))}}function getStroke(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function getFill(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function getTextXForPadding(e,t,r){return"right"===t?e-r[1]:"center"===t?e+r[3]/2-r[1]/2:e+r[3]}function getStyleText(e){var t=e.text;return null!=t&&(t+=""),t}function needDrawBackground(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}var CMD$1=PathProxy.CMD,points=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;function transformPath(e,t){if(t){var r,n,i,o,a,s,l=e.data,c=e.len(),u=CMD$1.M,h=CMD$1.C,d=CMD$1.L,p=CMD$1.R,f=CMD$1.A,m=CMD$1.Q;for(i=0,o=0;i<c;){switch(r=l[i++],o=i,n=0,r){case u:case d:n=1;break;case h:n=3;break;case m:n=2;break;case f:var g=t[4],y=t[5],_=mathSqrt$2(t[0]*t[0]+t[1]*t[1]),v=mathSqrt$2(t[2]*t[2]+t[3]*t[3]),b=mathAtan2(-t[1]/v,t[0]/_);l[i]*=_,l[i++]+=g,l[i]*=v,l[i++]+=y,l[i++]*=_,l[i++]*=v,l[i++]+=b,l[i++]+=b,o=i+=2;break;case p:s[0]=l[i++],s[1]=l[i++],applyTransform(s,s,t),l[o++]=s[0],l[o++]=s[1],s[0]+=l[i++],s[1]+=l[i++],applyTransform(s,s,t),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<n;a++){var w=points[a];w[0]=l[i++],w[1]=l[i++],applyTransform(w,w,t),l[o++]=w[0],l[o++]=w[1]}}e.increaseVersion()}}var mathSqrt$1=Math.sqrt,mathSin$1=Math.sin,mathCos$1=Math.cos,PI$1=Math.PI;function vMag(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function vRatio(e,t){return(e[0]*t[0]+e[1]*t[1])/(vMag(e)*vMag(t))}function vAngle(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(vRatio(e,t))}function processArc(e,t,r,n,i,o,a,s,l,c,u){var h=l*(PI$1/180),d=mathCos$1(h)*(e-r)/2+mathSin$1(h)*(t-n)/2,p=-1*mathSin$1(h)*(e-r)/2+mathCos$1(h)*(t-n)/2,f=d*d/(a*a)+p*p/(s*s);f>1&&(a*=mathSqrt$1(f),s*=mathSqrt$1(f));var m=(i===o?-1:1)*mathSqrt$1((a*a*(s*s)-a*a*(p*p)-s*s*(d*d))/(a*a*(p*p)+s*s*(d*d)))||0,g=m*a*p/s,y=m*-s*d/a,_=(e+r)/2+mathCos$1(h)*g-mathSin$1(h)*y,v=(t+n)/2+mathSin$1(h)*g+mathCos$1(h)*y,b=vAngle([1,0],[(d-g)/a,(p-y)/s]),w=[(d-g)/a,(p-y)/s],x=[(-1*d-g)/a,(-1*p-y)/s],S=vAngle(w,x);if(vRatio(w,x)<=-1&&(S=PI$1),vRatio(w,x)>=1&&(S=0),S<0){var E=Math.round(S/PI$1*1e6)/1e6;S=2*PI$1+E%2*PI$1}u.addData(c,_,v,a,s,b,S,h,o)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,numberReg$1=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function createPathProxyFromString(e){var t=new PathProxy;if(!e)return t;var r,n=0,i=0,o=n,a=i,s=PathProxy.CMD,l=e.match(commandReg);if(!l)return t;for(var c=0;c<l.length;c++){for(var u=l[c],h=u.charAt(0),d=void 0,p=u.match(numberReg$1)||[],f=p.length,m=0;m<f;m++)p[m]=parseFloat(p[m]);for(var g=0;g<f;){var y=void 0,_=void 0,v=void 0,b=void 0,w=void 0,x=void 0,S=void 0,E=n,T=i,A=void 0,C=void 0;switch(h){case"l":n+=p[g++],i+=p[g++],d=s.L,t.addData(d,n,i);break;case"L":n=p[g++],i=p[g++],d=s.L,t.addData(d,n,i);break;case"m":n+=p[g++],i+=p[g++],d=s.M,t.addData(d,n,i),o=n,a=i,h="l";break;case"M":n=p[g++],i=p[g++],d=s.M,t.addData(d,n,i),o=n,a=i,h="L";break;case"h":n+=p[g++],d=s.L,t.addData(d,n,i);break;case"H":n=p[g++],d=s.L,t.addData(d,n,i);break;case"v":i+=p[g++],d=s.L,t.addData(d,n,i);break;case"V":i=p[g++],d=s.L,t.addData(d,n,i);break;case"C":d=s.C,t.addData(d,p[g++],p[g++],p[g++],p[g++],p[g++],p[g++]),n=p[g-2],i=p[g-1];break;case"c":d=s.C,t.addData(d,p[g++]+n,p[g++]+i,p[g++]+n,p[g++]+i,p[g++]+n,p[g++]+i),n+=p[g-2],i+=p[g-1];break;case"S":y=n,_=i,A=t.len(),C=t.data,r===s.C&&(y+=n-C[A-4],_+=i-C[A-3]),d=s.C,E=p[g++],T=p[g++],n=p[g++],i=p[g++],t.addData(d,y,_,E,T,n,i);break;case"s":y=n,_=i,A=t.len(),C=t.data,r===s.C&&(y+=n-C[A-4],_+=i-C[A-3]),d=s.C,E=n+p[g++],T=i+p[g++],n+=p[g++],i+=p[g++],t.addData(d,y,_,E,T,n,i);break;case"Q":E=p[g++],T=p[g++],n=p[g++],i=p[g++],d=s.Q,t.addData(d,E,T,n,i);break;case"q":E=p[g++]+n,T=p[g++]+i,n+=p[g++],i+=p[g++],d=s.Q,t.addData(d,E,T,n,i);break;case"T":y=n,_=i,A=t.len(),C=t.data,r===s.Q&&(y+=n-C[A-4],_+=i-C[A-3]),n=p[g++],i=p[g++],d=s.Q,t.addData(d,y,_,n,i);break;case"t":y=n,_=i,A=t.len(),C=t.data,r===s.Q&&(y+=n-C[A-4],_+=i-C[A-3]),n+=p[g++],i+=p[g++],d=s.Q,t.addData(d,y,_,n,i);break;case"A":v=p[g++],b=p[g++],w=p[g++],x=p[g++],S=p[g++],processArc(E=n,T=i,n=p[g++],i=p[g++],x,S,v,b,w,d=s.A,t);break;case"a":v=p[g++],b=p[g++],w=p[g++],x=p[g++],S=p[g++],processArc(E=n,T=i,n+=p[g++],i+=p[g++],x,S,v,b,w,d=s.A,t)}}"z"!==h&&"Z"!==h||(d=s.Z,t.addData(d),n=o,i=a),r=d}return t.toStatic(),t}var SVGPath=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.applyTransform=function(e){},t}(Path);function isPathProxy(e){return null!=e.setData}function createPathOptions(e,t){var r=createPathProxyFromString(e),n=extend$1({},t);return n.buildPath=function(e){var t,n=isPathProxy(e);n&&e.canSave()?(e.appendPath(r),(t=e.getContext())&&e.rebuildPath(t,1)):(t=n?e.getContext():e)&&r.rebuildPath(t,1)},n.applyTransform=function(e){transformPath(r,e),this.dirtyShape()},n}function createFromString(e,t){return new SVGPath(createPathOptions(e,t))}function extendFromString(e,t){var r=createPathOptions(e,t);return function(e){function t(t){var n=e.call(this,t)||this;return n.applyTransform=r.applyTransform,n.buildPath=r.buildPath,n}return __extends(t,e),t}(SVGPath)}function mergePath(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var o=e[i];r.push(o.getUpdatedPathProxy(!0))}var a=new Path(t);return a.createPathProxy(),a.buildPath=function(e){if(isPathProxy(e)){e.appendPath(r);var t=e.getContext();t&&e.rebuildPath(t,1)}},a}function clonePath(e,t){t=t||{};var r=new Path;return e.shape&&r.setShape(e.shape),r.setStyle(e.style),t.bakeTransform?transformPath(r.path,e.getComputedTransform()):t.toLocal?r.setLocalTransform(e.getComputedTransform()):r.copyTransform(e),r.buildPath=e.buildPath,r.applyTransform=r.applyTransform,r.z=e.z,r.z2=e.z2,r.zlevel=e.zlevel,r}var Group=function(e){function t(t){var r=e.call(this)||this;return r.isGroup=!0,r._children=[],r.attr(t),r}return __extends(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(e){return this._children[e]},t.prototype.childOfName=function(e){for(var t=this._children,r=0;r<t.length;r++)if(t[r].name===e)return t[r]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},t.prototype.addBefore=function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var r=this._children,n=r.indexOf(t);n>=0&&(r.splice(n,0,e),this._doAdd(e))}return this},t.prototype.replace=function(e,t){var r=indexOf(this._children,e);return r>=0&&this.replaceAt(t,r),this},t.prototype.replaceAt=function(e,t){var r=this._children,n=r[t];if(e&&e!==this&&e.parent!==this&&e!==n){r[t]=e,n.parent=null;var i=this.__zr;i&&n.removeSelfFromZr(i),this._doAdd(e)}return this},t.prototype._doAdd=function(e){e.parent&&e.parent.remove(e),e.parent=this;var t=this.__zr;t&&t!==e.__zr&&e.addSelfToZr(t),t&&t.refresh()},t.prototype.remove=function(e){var t=this.__zr,r=this._children,n=indexOf(r,e);return n<0||(r.splice(n,1),e.parent=null,t&&e.removeSelfFromZr(t),t&&t.refresh()),this},t.prototype.removeAll=function(){for(var e=this._children,t=this.__zr,r=0;r<e.length;r++){var n=e[r];t&&n.removeSelfFromZr(t),n.parent=null}return e.length=0,this},t.prototype.eachChild=function(e,t){for(var r=this._children,n=0;n<r.length;n++){var i=r[n];e.call(t,i,n)}return this},t.prototype.traverse=function(e,t){for(var r=0;r<this._children.length;r++){var n=this._children[r],i=e.call(t,n);n.isGroup&&!i&&n.traverse(e,t)}return this},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++){this._children[r].addSelfToZr(t)}},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++){this._children[r].removeSelfFromZr(t)}},t.prototype.getBoundingRect=function(e){for(var t=new BoundingRect(0,0,0,0),r=e||this._children,n=[],i=null,o=0;o<r.length;o++){var a=r[o];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(n);l?(BoundingRect.applyTransform(t,s,l),(i=i||t.clone()).union(t)):(i=i||s.clone()).union(s)}}return i||t},t}(Element$2);Group.prototype.type="group";var CircleShape=function(){return function(){this.cx=0,this.cy=0,this.r=0}}(),Circle=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new CircleShape},t.prototype.buildPath=function(e,t){e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI)},t}(Path);Circle.prototype.type="circle";var EllipseShape=function(){return function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}}(),Ellipse=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new EllipseShape},t.prototype.buildPath=function(e,t){var r=.5522848,n=t.cx,i=t.cy,o=t.rx,a=t.ry,s=o*r,l=a*r;e.moveTo(n-o,i),e.bezierCurveTo(n-o,i-l,n-s,i-a,n,i-a),e.bezierCurveTo(n+s,i-a,n+o,i-l,n+o,i),e.bezierCurveTo(n+o,i+l,n+s,i+a,n,i+a),e.bezierCurveTo(n-s,i+a,n-o,i+l,n-o,i),e.closePath()},t}(Path);Ellipse.prototype.type="ellipse";var PI=Math.PI,PI2=2*PI,mathSin=Math.sin,mathCos=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs$1=Math.abs,mathSqrt=Math.sqrt,mathMax$1=Math.max,mathMin$1=Math.min,e=1e-4;function intersect(t,r,n,i,o,a,s,l){var c=n-t,u=i-r,h=s-o,d=l-a,p=d*c-h*u;if(!(p*p<e))return[t+(p=(h*(r-a)-d*(t-o))/p)*c,r+p*u]}function computeCornerTangents(e,t,r,n,i,o,a){var s=e-r,l=t-n,c=(a?o:-o)/mathSqrt(s*s+l*l),u=c*l,h=-c*s,d=e+u,p=t+h,f=r+u,m=n+h,g=(d+f)/2,y=(p+m)/2,_=f-d,v=m-p,b=_*_+v*v,w=i-o,x=d*m-f*p,S=(v<0?-1:1)*mathSqrt(mathMax$1(0,w*w*b-x*x)),E=(x*v-_*S)/b,T=(-x*_-v*S)/b,A=(x*v+_*S)/b,C=(-x*_+v*S)/b,I=E-g,k=T-y,P=A-g,M=C-y;return I*I+k*k>P*P+M*M&&(E=A,T=C),{cx:E,cy:T,x0:-u,y0:-h,x1:E*(i/w-1),y1:T*(i/w-1)}}function normalizeCornerRadius(e){var t;if(isArray(e)){var r=e.length;if(!r)return e;t=1===r?[e[0],e[0],0,0]:2===r?[e[0],e[0],e[1],e[1]]:3===r?e.concat(e[2]):e}else t=[e,e,e,e];return t}function buildPath$1(t,r){var n,i=mathMax$1(r.r,0),o=mathMax$1(r.r0||0,0),a=i>0;if(a||o>0){if(a||(i=o,o=0),o>i){var s=i;i=o,o=s}var l=r.startAngle,c=r.endAngle;if(!isNaN(l)&&!isNaN(c)){var u=r.cx,h=r.cy,d=!!r.clockwise,p=mathAbs$1(c-l),f=p>PI2&&p%PI2;if(f>e&&(p=f),i>e)if(p>PI2-e)t.moveTo(u+i*mathCos(l),h+i*mathSin(l)),t.arc(u,h,i,l,c,!d),o>e&&(t.moveTo(u+o*mathCos(c),h+o*mathSin(c)),t.arc(u,h,o,c,l,d));else{var m=void 0,g=void 0,y=void 0,_=void 0,v=void 0,b=void 0,w=void 0,x=void 0,S=void 0,E=void 0,T=void 0,A=void 0,C=void 0,I=void 0,k=void 0,P=void 0,M=i*mathCos(l),R=i*mathSin(l),D=o*mathCos(c),O=o*mathSin(c),L=p>e;if(L){var B=r.cornerRadius;B&&(m=(n=normalizeCornerRadius(B))[0],g=n[1],y=n[2],_=n[3]);var $=mathAbs$1(i-o)/2;if(v=mathMin$1($,y),b=mathMin$1($,_),w=mathMin$1($,m),x=mathMin$1($,g),T=S=mathMax$1(v,b),A=E=mathMax$1(w,x),(S>e||E>e)&&(C=i*mathCos(c),I=i*mathSin(c),k=o*mathCos(l),P=o*mathSin(l),p<PI)){var z=intersect(M,R,k,P,C,I,D,O);if(z){var F=M-z[0],q=R-z[1],N=C-z[0],j=I-z[1],U=1/mathSin(mathACos((F*N+q*j)/(mathSqrt(F*F+q*q)*mathSqrt(N*N+j*j)))/2),V=mathSqrt(z[0]*z[0]+z[1]*z[1]);T=mathMin$1(S,(i-V)/(U+1)),A=mathMin$1(E,(o-V)/(U-1))}}}if(L)if(T>e){var G=mathMin$1(y,T),W=mathMin$1(_,T),H=computeCornerTangents(k,P,M,R,i,G,d),Z=computeCornerTangents(C,I,D,O,i,W,d);t.moveTo(u+H.cx+H.x0,h+H.cy+H.y0),T<S&&G===W?t.arc(u+H.cx,h+H.cy,T,mathATan2(H.y0,H.x0),mathATan2(Z.y0,Z.x0),!d):(G>0&&t.arc(u+H.cx,h+H.cy,G,mathATan2(H.y0,H.x0),mathATan2(H.y1,H.x1),!d),t.arc(u,h,i,mathATan2(H.cy+H.y1,H.cx+H.x1),mathATan2(Z.cy+Z.y1,Z.cx+Z.x1),!d),W>0&&t.arc(u+Z.cx,h+Z.cy,W,mathATan2(Z.y1,Z.x1),mathATan2(Z.y0,Z.x0),!d))}else t.moveTo(u+M,h+R),t.arc(u,h,i,l,c,!d);else t.moveTo(u+M,h+R);if(o>e&&L)if(A>e){G=mathMin$1(m,A),H=computeCornerTangents(D,O,C,I,o,-(W=mathMin$1(g,A)),d),Z=computeCornerTangents(M,R,k,P,o,-G,d);t.lineTo(u+H.cx+H.x0,h+H.cy+H.y0),A<E&&G===W?t.arc(u+H.cx,h+H.cy,A,mathATan2(H.y0,H.x0),mathATan2(Z.y0,Z.x0),!d):(W>0&&t.arc(u+H.cx,h+H.cy,W,mathATan2(H.y0,H.x0),mathATan2(H.y1,H.x1),!d),t.arc(u,h,o,mathATan2(H.cy+H.y1,H.cx+H.x1),mathATan2(Z.cy+Z.y1,Z.cx+Z.x1),d),G>0&&t.arc(u+Z.cx,h+Z.cy,G,mathATan2(Z.y1,Z.x1),mathATan2(Z.y0,Z.x0),!d))}else t.lineTo(u+D,h+O),t.arc(u,h,o,c,l,d);else t.lineTo(u+D,h+O)}else t.moveTo(u,h);t.closePath()}}}var SectorShape=function(){return function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0}}(),Sector=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new SectorShape},t.prototype.buildPath=function(e,t){buildPath$1(e,t)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(Path);Sector.prototype.type="sector";var RingShape=function(){return function(){this.cx=0,this.cy=0,this.r=0,this.r0=0}}(),Ring=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new RingShape},t.prototype.buildPath=function(e,t){var r=t.cx,n=t.cy,i=2*Math.PI;e.moveTo(r+t.r,n),e.arc(r,n,t.r,0,i,!1),e.moveTo(r+t.r0,n),e.arc(r,n,t.r0,0,i,!0)},t}(Path);function smoothBezier(e,t,r,n){var i,o,a,s,l=[],c=[],u=[],h=[];if(n){a=[1/0,1/0],s=[-1/0,-1/0];for(var d=0,p=e.length;d<p;d++)min$2(a,a,e[d]),max$3(s,s,e[d]);min$2(a,a,n[0]),max$3(s,s,n[1])}for(d=0,p=e.length;d<p;d++){var f=e[d];if(r)i=e[d?d-1:p-1],o=e[(d+1)%p];else{if(0===d||d===p-1){l.push(clone$3(e[d]));continue}i=e[d-1],o=e[d+1]}sub$1(c,o,i),scale(c,c,t);var m=distance(f,i),g=distance(f,o),y=m+g;0!==y&&(m/=y,g/=y),scale(u,c,-m),scale(h,c,g);var _=add([],f,u),v=add([],f,h);n&&(max$3(_,_,a),min$2(_,_,s),max$3(v,v,a),min$2(v,v,s)),l.push(_),l.push(v)}return r&&l.push(l.shift()),l}function buildPath(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var o=smoothBezier(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var a=i.length,s=0;s<(r?a:a-1);s++){var l=o[2*s],c=o[2*s+1],u=i[(s+1)%a];e.bezierCurveTo(l[0],l[1],c[0],c[1],u[0],u[1])}}else{e.moveTo(i[0][0],i[0][1]);s=1;for(var h=i.length;s<h;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}Ring.prototype.type="ring";var PolygonShape=function(){return function(){this.points=null,this.smooth=0,this.smoothConstraint=null}}(),Polygon$1=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultShape=function(){return new PolygonShape},t.prototype.buildPath=function(e,t){buildPath(e,t,!0)},t}(Path);Polygon$1.prototype.type="polygon";var PolylineShape=function(){return function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}}(),Polyline=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new PolylineShape},t.prototype.buildPath=function(e,t){buildPath(e,t,!1)},t}(Path);Polyline.prototype.type="polyline";var subPixelOptimizeOutputShape={},LineShape=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}}(),Line=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new LineShape},t.prototype.buildPath=function(e,t){var r,n,i,o;if(this.subPixelOptimize){var a=subPixelOptimizeLine(subPixelOptimizeOutputShape,t,this.style);r=a.x1,n=a.y1,i=a.x2,o=a.y2}else r=t.x1,n=t.y1,i=t.x2,o=t.y2;var s=t.percent;0!==s&&(e.moveTo(r,n),s<1&&(i=r*(1-s)+i*s,o=n*(1-s)+o*s),e.lineTo(i,o))},t.prototype.pointAt=function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]},t}(Path);Line.prototype.type="line";var out=[],BezierCurveShape=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}}();function someVectorAt(e,t,r){var n=e.cpx2,i=e.cpy2;return null!=n||null!=i?[(r?cubicDerivativeAt:cubicAt)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?cubicDerivativeAt:cubicAt)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?quadraticDerivativeAt:quadraticAt)(e.x1,e.cpx1,e.x2,t),(r?quadraticDerivativeAt:quadraticAt)(e.y1,e.cpy1,e.y2,t)]}var BezierCurve=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new BezierCurveShape},t.prototype.buildPath=function(e,t){var r=t.x1,n=t.y1,i=t.x2,o=t.y2,a=t.cpx1,s=t.cpy1,l=t.cpx2,c=t.cpy2,u=t.percent;0!==u&&(e.moveTo(r,n),null==l||null==c?(u<1&&(quadraticSubdivide(r,a,i,u,out),a=out[1],i=out[2],quadraticSubdivide(n,s,o,u,out),s=out[1],o=out[2]),e.quadraticCurveTo(a,s,i,o)):(u<1&&(cubicSubdivide(r,a,l,i,u,out),a=out[1],l=out[2],i=out[3],cubicSubdivide(n,s,c,o,u,out),s=out[1],c=out[2],o=out[3]),e.bezierCurveTo(a,s,l,c,i,o)))},t.prototype.pointAt=function(e){return someVectorAt(this.shape,e,!1)},t.prototype.tangentAt=function(e){var t=someVectorAt(this.shape,e,!0);return normalize$4(t,t)},t}(Path);BezierCurve.prototype.type="bezier-curve";var ArcShape=function(){return function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}}(),Arc=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new ArcShape},t.prototype.buildPath=function(e,t){var r=t.cx,n=t.cy,i=Math.max(t.r,0),o=t.startAngle,a=t.endAngle,s=t.clockwise,l=Math.cos(o),c=Math.sin(o);e.moveTo(l*i+r,c*i+n),e.arc(r,n,i,o,a,!s)},t}(Path);Arc.prototype.type="arc";var CompoundPath=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="compound",t}return __extends(t,e),t.prototype._updatePathDirty=function(){for(var e=this.shape.paths,t=this.shapeChanged(),r=0;r<e.length;r++)t=t||e[r].shapeChanged();t&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),r=0;r<e.length;r++)e[r].path||e[r].createPathProxy(),e[r].path.setScale(t[0],t[1],e[r].segmentIgnoreThreshold)},t.prototype.buildPath=function(e,t){for(var r=t.paths||[],n=0;n<r.length;n++)r[n].buildPath(e,r[n].shape,!0)},t.prototype.afterBrush=function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path.prototype.getBoundingRect.call(this)},t}(Path),Gradient=function(){function e(e){this.colorStops=e||[]}return e.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},e}(),LinearGradient=function(e){function t(t,r,n,i,o,a){var s=e.call(this,o)||this;return s.x=null==t?0:t,s.y=null==r?0:r,s.x2=null==n?1:n,s.y2=null==i?0:i,s.type="linear",s.global=a||!1,s}return __extends(t,e),t}(Gradient),RadialGradient=function(e){function t(t,r,n,i,o){var a=e.call(this,i)||this;return a.x=null==t?.5:t,a.y=null==r?.5:r,a.r=null==n?.5:n,a.type="radial",a.global=o||!1,a}return __extends(t,e),t}(Gradient),mathMin=Math.min,mathMax=Math.max,mathAbs=Math.abs,_extent=[0,0],_extent2=[0,0],_intersectCtx=createIntersectContext(),_minTv=_intersectCtx.minTv,_maxTv=_intersectCtx.maxTv,OrientedBoundingRect=function(){function e(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var r=0;r<4;r++)this._corners[r]=new Point$2;for(r=0;r<2;r++)this._axes[r]=new Point$2;e&&this.fromBoundingRect(e,t)}return e.prototype.fromBoundingRect=function(e,t){var r=this._corners,n=this._axes,i=e.x,o=e.y,a=i+e.width,s=o+e.height;if(r[0].set(i,o),r[1].set(a,o),r[2].set(a,s),r[3].set(i,s),t)for(var l=0;l<4;l++)r[l].transform(t);Point$2.sub(n[0],r[1],r[0]),Point$2.sub(n[1],r[3],r[0]),n[0].normalize(),n[1].normalize();for(l=0;l<2;l++)this._origin[l]=n[l].dot(r[0])},e.prototype.intersect=function(e,t,r){var n=!0,i=!t;return t&&Point$2.set(t,0,0),_intersectCtx.reset(r,!i),!this._intersectCheckOneSide(this,e,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(e,this,i,-1)&&(n=!1,i)||i||_intersectCtx.negativeSize||Point$2.copy(t,n?_intersectCtx.useDir?_intersectCtx.dirMinTv:_minTv:_maxTv),n},e.prototype._intersectCheckOneSide=function(e,t,r,n){for(var i=!0,o=0;o<2;o++){var a=e._axes[o];if(e._getProjMinMaxOnAxis(o,e._corners,_extent),e._getProjMinMaxOnAxis(o,t._corners,_extent2),_intersectCtx.negativeSize||_extent[1]<_extent2[0]||_extent[0]>_extent2[1]){if(i=!1,_intersectCtx.negativeSize||r)return i;var s=mathAbs(_extent2[0]-_extent[1]),l=mathAbs(_extent[0]-_extent2[1]);mathMin(s,l)>_maxTv.len()&&(s<l?Point$2.scale(_maxTv,a,-s*n):Point$2.scale(_maxTv,a,l*n))}else if(!r){s=mathAbs(_extent2[0]-_extent[1]),l=mathAbs(_extent[0]-_extent2[1]);(_intersectCtx.useDir||mathMin(s,l)<_minTv.len())&&((s<l||!_intersectCtx.bidirectional)&&(Point$2.scale(_minTv,a,s*n),_intersectCtx.useDir&&_intersectCtx.calcDirMTV()),(s>=l||!_intersectCtx.bidirectional)&&(Point$2.scale(_minTv,a,-l*n),_intersectCtx.useDir&&_intersectCtx.calcDirMTV()))}}return i},e.prototype._getProjMinMaxOnAxis=function(e,t,r){for(var n=this._axes[e],i=this._origin,o=t[0].dot(n)+i[e],a=o,s=o,l=1;l<t.length;l++){var c=t[l].dot(n)+i[e];a=mathMin(c,a),s=mathMax(c,s)}r[0]=a+_intersectCtx.touchThreshold,r[1]=s-_intersectCtx.touchThreshold,_intersectCtx.negativeSize=r[1]<r[0]},e}(),m$2=[],IncrementalDisplayable=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return __extends(t,e),t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(e,t){t?this._temporaryDisplayables.push(e):this._displayables.push(e),this.markRedraw()},t.prototype.addDisplayables=function(e,t){t=t||!1;for(var r=0;r<e.length;r++)this.addDisplayable(e[r],t)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(e){for(var t=this._cursor;t<this._displayables.length;t++)e&&e(this._displayables[t]);for(t=0;t<this._temporaryDisplayables.length;t++)e&&e(this._temporaryDisplayables[t])},t.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++){(t=this._displayables[e]).parent=this,t.update(),t.parent=null}for(e=0;e<this._temporaryDisplayables.length;e++){var t;(t=this._temporaryDisplayables[e]).parent=this,t.update(),t.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new BoundingRect(1/0,1/0,-1/0,-1/0),t=0;t<this._displayables.length;t++){var r=this._displayables[t],n=r.getBoundingRect().clone();r.needLocalTransform()&&n.applyTransform(r.getLocalTransform(m$2)),e.union(n)}this._rect=e}return this._rect},t.prototype.contain=function(e,t){var r=this.transformCoordToLocal(e,t);if(this.getBoundingRect().contain(r[0],r[1]))for(var n=0;n<this._displayables.length;n++){if(this._displayables[n].contain(e,t))return!0}return!1},t}(Displayable),LN2=Math.log(2);function determinant(e,t,r,n,i,o){var a=n+"-"+i,s=e.length;if(o.hasOwnProperty(a))return o[a];if(1===t){var l=Math.round(Math.log((1<<s)-1&~i)/LN2);return e[r][l]}for(var c=n|1<<r,u=r+1;n&1<<u;)u++;for(var h=0,d=0,p=0;d<s;d++){var f=1<<d;f&i||(h+=(p%2?-1:1)*e[r][d]*determinant(e,t-1,u,c,i|f,o),p++)}return o[a]=h,h}function buildTransformer(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=determinant(r,8,0,0,0,n);if(0!==i){for(var o=[],a=0;a<8;a++)for(var s=0;s<8;s++)null==o[s]&&(o[s]=0),o[s]+=((a+s)%2?-1:1)*determinant(r,7,0===a?1:0,1<<a,1<<s,n)/i*t[a];return function(e,t,r){var n=t*o[6]+r*o[7]+1;e[0]=(t*o[0]+r*o[1]+o[2])/n,e[1]=(t*o[3]+r*o[4]+o[5])/n}}}var EVENT_SAVED_PROP="___zrEVENTSAVED",_calcOut$1=[];function transformLocalCoord(e,t,r,n,i){return transformCoordWithViewport(_calcOut$1,t,n,i,!0)&&transformCoordWithViewport(e,r,_calcOut$1[0],_calcOut$1[1])}function transformLocalCoordClear(e,t){function r(e){var t=e[EVENT_SAVED_PROP];t&&(t.clearMarkers&&t.clearMarkers(),delete e[EVENT_SAVED_PROP])}e&&r(e),t&&r(t)}function transformCoordWithViewport(e,t,r,n,i){if(t.getBoundingClientRect&&env.domSupported&&!isCanvasEl(t)){var o=t[EVENT_SAVED_PROP]||(t[EVENT_SAVED_PROP]={}),a=preparePointerTransformer(prepareCoordMarkers(t,o),o,i);if(a)return a(e,r,n),!0}return!1}function prepareCoordMarkers(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],o=0;o<4;o++){var a=document.createElement("div"),s=o%2,l=(o>>1)%2;a.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[s]+":0",i[l]+":0",n[1-s]+":auto",i[1-l]+":auto",""].join("!important;"),e.appendChild(a),r.push(a)}return t.clearMarkers=function(){each(r,(function(e){e.parentNode&&e.parentNode.removeChild(e)}))},r}function preparePointerTransformer(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],o=t.srcCoords,a=[],s=[],l=!0,c=0;c<4;c++){var u=e[c].getBoundingClientRect(),h=2*c,d=u.left,p=u.top;a.push(d,p),l=l&&o&&d===o[h]&&p===o[h+1],s.push(e[c].offsetLeft,e[c].offsetTop)}return l&&i?i:(t.srcCoords=a,t[n]=r?buildTransformer(s,a):buildTransformer(a,s))}function isCanvasEl(e){return"CANVAS"===e.nodeName.toUpperCase()}var replaceReg=/([&<>"'])/g,replaceMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function encodeHTML(e){return null==e?"":(e+"").replace(replaceReg,(function(e,t){return replaceMap[t]}))}var Param=function(){return function(e,t){this.target=e,this.topTarget=t&&t.topTarget}}(),Draggable=function(){function e(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new Param(t,e),"dragstart",e.event))},e.prototype._drag=function(e){var t=this._draggingTarget;if(t){var r=e.offsetX,n=e.offsetY,i=r-this._x,o=n-this._y;this._x=r,this._y=n,t.drift(i,o,e),this.handler.dispatchToElement(new Param(t,e),"drag",e.event);var a=this.handler.findHover(r,n,t).target,s=this._dropTarget;this._dropTarget=a,t!==a&&(s&&a!==s&&this.handler.dispatchToElement(new Param(s,e),"dragleave",e.event),a&&a!==s&&this.handler.dispatchToElement(new Param(a,e),"dragenter",e.event))}},e.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new Param(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},e}(),MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env.browser.firefox&&+env.browser.version.split(".")[0]<39;function clientToLocal(e,t,r,n){return r=r||{},n?calculateZrXY(e,t,r):firefoxNotSupportOffsetXY&&null!=t.layerX&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):null!=t.offsetX?(r.zrX=t.offsetX,r.zrY=t.offsetY):calculateZrXY(e,t,r),r}function calculateZrXY(e,t,r){if(env.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(isCanvasEl(e)){var o=e.getBoundingClientRect();return r.zrX=n-o.left,void(r.zrY=i-o.top)}if(transformCoordWithViewport(_calcOut,e,n,i))return r.zrX=_calcOut[0],void(r.zrY=_calcOut[1])}r.zrX=r.zrY=0}function getNativeEvent(e){return e||window.event}function normalizeEvent(e,t,r){if(null!=(t=getNativeEvent(t)).zrX)return t;var n=t.type;if(n&&n.indexOf("touch")>=0){var i="touchend"!==n?t.targetTouches[0]:t.changedTouches[0];i&&clientToLocal(e,i,t,r)}else{clientToLocal(e,t,t,r);var o=getWheelDeltaMayPolyfill(t);t.zrDelta=o?o/120:-(t.detail||0)/3}var a=t.button;return null==t.which&&void 0!==a&&MOUSE_EVENT_REG.test(t.type)&&(t.which=1&a?1:2&a?3:4&a?2:0),t}function getWheelDeltaMayPolyfill(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;return null==r||null==n?t:3*(0!==n?Math.abs(n):Math.abs(r))*(n>0?-1:n<0?1:r>0?-1:1)}function addEventListener$1(e,t,r,n){e.addEventListener(t,r,n)}function removeEventListener$1(e,t,r,n){e.removeEventListener(t,r,n)}var stop=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(e){return 2===e.which||3===e.which}var GestureMgr=function(){function e(){this._track=[]}return e.prototype.recognize=function(e,t,r){return this._doTrack(e,t,r),this._recognize(e)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(e,t,r){var n=e.touches;if(n){for(var i={points:[],touches:[],target:t,event:e},o=0,a=n.length;o<a;o++){var s=n[o],l=clientToLocal(r,s,{});i.points.push([l.zrX,l.zrY]),i.touches.push(s)}this._track.push(i)}},e.prototype._recognize=function(e){for(var t in recognizers)if(recognizers.hasOwnProperty(t)){var r=recognizers[t](this._track,e);if(r)return r}},e}();function dist$1(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function center(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var recognizers={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var o=dist$1(n)/dist$1(i);!isFinite(o)&&(o=1),t.pinchScale=o;var a=center(n);return t.pinchX=a[0],t.pinchY=a[1],{type:"pinch",target:e[0].target,event:t}}}}},SILENT="silent";function makeEventPacket(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:stopEvent}}function stopEvent(){stop(this.event)}var EmptyProxy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handler=null,t}return __extends(t,e),t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(Eventful),HoveredResult=function(){return function(e,t){this.x=e,this.y=t}}(),handlerNames=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],tmpRect=new BoundingRect(0,0,0,0),Handler=function(e){function t(t,r,n,i,o){var a=e.call(this)||this;return a._hovered=new HoveredResult(0,0),a.storage=t,a.painter=r,a.painterRoot=i,a._pointerSize=o,n=n||new EmptyProxy,a.proxy=null,a.setHandlerProxy(n),a._draggingMgr=new Draggable(a),a}return __extends(t,e),t.prototype.setHandlerProxy=function(e){this.proxy&&this.proxy.dispose(),e&&(each(handlerNames,(function(t){e.on&&e.on(t,this[t],this)}),this),e.handler=this),this.proxy=e},t.prototype.mousemove=function(e){var t=e.zrX,r=e.zrY,n=isOutsideBoundary(this,t,r),i=this._hovered,o=i.target;o&&!o.__zr&&(o=(i=this.findHover(i.x,i.y)).target);var a=this._hovered=n?new HoveredResult(t,r):this.findHover(t,r),s=a.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(i,"mouseout",e),this.dispatchToElement(a,"mousemove",e),s&&s!==o&&this.dispatchToElement(a,"mouseover",e)},t.prototype.mouseout=function(e){var t=e.zrEventControl;"only_globalout"!==t&&this.dispatchToElement(this._hovered,"mouseout",e),"no_globalout"!==t&&this.trigger("globalout",{type:"globalout",event:e})},t.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},t.prototype.dispatch=function(e,t){var r=this[e];r&&r.call(this,t)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},t.prototype.dispatchToElement=function(e,t,r){var n=(e=e||{}).target;if(!n||!n.silent){for(var i="on"+t,o=makeEventPacket(t,e,r);n&&(n[i]&&(o.cancelBubble=!!n[i].call(n,o)),n.trigger(t,o),n=n.__hostTarget?n.__hostTarget:n.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(t,o),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer((function(e){"function"==typeof e[i]&&e[i].call(e,o),e.trigger&&e.trigger(t,o)})))}},t.prototype.findHover=function(e,t,r){var n=this.storage.getDisplayList(),i=new HoveredResult(e,t);if(setHoverTarget(n,i,e,t,r),this._pointerSize&&!i.target){for(var o=[],a=this._pointerSize,s=a/2,l=new BoundingRect(e-s,t-s,a,a),c=n.length-1;c>=0;c--){var u=n[c];u===r||u.ignore||u.ignoreCoarsePointer||u.parent&&u.parent.ignoreCoarsePointer||(tmpRect.copy(u.getBoundingRect()),u.transform&&tmpRect.applyTransform(u.transform),tmpRect.intersect(l)&&o.push(u))}if(o.length)for(var h=Math.PI/12,d=2*Math.PI,p=0;p<s;p+=4)for(var f=0;f<d;f+=h){if(setHoverTarget(o,i,e+p*Math.cos(f),t+p*Math.sin(f),r),i.target)return i}}return i},t.prototype.processGesture=function(e,t){this._gestureMgr||(this._gestureMgr=new GestureMgr);var r=this._gestureMgr;"start"===t&&r.clear();var n=r.recognize(e,this.findHover(e.zrX,e.zrY,null).target,this.proxy.dom);if("end"===t&&r.clear(),n){var i=n.type;e.gestureEvent=i;var o=new HoveredResult;o.target=n.target,this.dispatchToElement(o,i,n.event)}},t}(Eventful);function isHover(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,o=!1;n;){if(n.ignoreClip&&(o=!0),!o){var a=n.getClipPath();if(a&&!a.contain(t,r))return!1}n.silent&&(i=!0);var s=n.__hostTarget;n=s?n.ignoreHostSilent?null:s:n.parent}return!i||SILENT}return!1}function setHoverTarget(e,t,r,n,i){for(var o=e.length-1;o>=0;o--){var a=e[o],s=void 0;if(a!==i&&!a.ignore&&(s=isHover(a,r,n))&&(!t.topTarget&&(t.topTarget=a),s!==SILENT)){t.target=a;break}}}function isOutsideBoundary(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],(function(e){Handler.prototype[e]=function(t){var r,n,i=t.zrX,o=t.zrY,a=isOutsideBoundary(this,i,o);if("mouseup"===e&&a||(n=(r=this.findHover(i,o)).target),"mousedown"===e)this._downEl=n,this._downPoint=[t.zrX,t.zrY],this._upEl=n;else if("mouseup"===e)this._upEl=n;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||dist$2(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(r,e,t)}}));var DEFAULT_MIN_MERGE=32,DEFAULT_MIN_GALLOPING=7;function minRunLength(e){for(var t=0;e>=DEFAULT_MIN_MERGE;)t|=1&e,e>>=1;return e+t}function makeAscendingRun(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;reverseRun(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function reverseRun(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function binaryInsertionSort(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var o,a=e[n],s=t,l=n;s<l;)i(a,e[o=s+l>>>1])<0?l=o:s=o+1;var c=n-s;switch(c){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;c>0;)e[s+c]=e[s+c-1],c--}e[s]=a}}function gallopLeft(e,t,r,n,i,o){var a=0,s=0,l=1;if(o(e,t[r+i])>0){for(s=n-i;l<s&&o(e,t[r+i+l])>0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=i,l+=i}else{for(s=i+1;l<s&&o(e,t[r+i-l])<=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=i-l,l=i-c}for(a++;a<l;){var u=a+(l-a>>>1);o(e,t[r+u])>0?a=u+1:l=u}return l}function gallopRight(e,t,r,n,i,o){var a=0,s=0,l=1;if(o(e,t[r+i])<0){for(s=i+1;l<s&&o(e,t[r+i-l])<0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=a;a=i-l,l=i-c}else{for(s=n-i;l<s&&o(e,t[r+i+l])>=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=i,l+=i}for(a++;a<l;){var u=a+(l-a>>>1);o(e,t[r+u])<0?l=u:a=u+1}return l}function TimSort(e,t){var r,n,i=DEFAULT_MIN_GALLOPING,o=0,a=[];function s(s){var l=r[s],c=n[s],u=r[s+1],h=n[s+1];n[s]=c+h,s===o-3&&(r[s+1]=r[s+2],n[s+1]=n[s+2]),o--;var d=gallopRight(e[u],e,l,c,0,t);l+=d,0!==(c-=d)&&0!==(h=gallopLeft(e[l+c-1],e,u,h,h-1,t))&&(c<=h?function(r,n,o,s){var l=0;for(l=0;l<n;l++)a[l]=e[r+l];var c=0,u=o,h=r;if(e[h++]=e[u++],0==--s){for(l=0;l<n;l++)e[h+l]=a[c+l];return}if(1===n){for(l=0;l<s;l++)e[h+l]=e[u+l];return void(e[h+s]=a[c])}var d,p,f,m=i;for(;;){d=0,p=0,f=!1;do{if(t(e[u],a[c])<0){if(e[h++]=e[u++],p++,d=0,0==--s){f=!0;break}}else if(e[h++]=a[c++],d++,p=0,1==--n){f=!0;break}}while((d|p)<m);if(f)break;do{if(0!==(d=gallopRight(e[u],a,c,n,0,t))){for(l=0;l<d;l++)e[h+l]=a[c+l];if(h+=d,c+=d,(n-=d)<=1){f=!0;break}}if(e[h++]=e[u++],0==--s){f=!0;break}if(0!==(p=gallopLeft(a[c],e,u,s,0,t))){for(l=0;l<p;l++)e[h+l]=e[u+l];if(h+=p,u+=p,0===(s-=p)){f=!0;break}}if(e[h++]=a[c++],1==--n){f=!0;break}m--}while(d>=DEFAULT_MIN_GALLOPING||p>=DEFAULT_MIN_GALLOPING);if(f)break;m<0&&(m=0),m+=2}if((i=m)<1&&(i=1),1===n){for(l=0;l<s;l++)e[h+l]=e[u+l];e[h+s]=a[c]}else{if(0===n)throw new Error;for(l=0;l<n;l++)e[h+l]=a[c+l]}}(l,c,u,h):function(r,n,o,s){var l=0;for(l=0;l<s;l++)a[l]=e[o+l];var c=r+n-1,u=s-1,h=o+s-1,d=0,p=0;if(e[h--]=e[c--],0==--n){for(d=h-(s-1),l=0;l<s;l++)e[d+l]=a[l];return}if(1===s){for(p=(h-=n)+1,d=(c-=n)+1,l=n-1;l>=0;l--)e[p+l]=e[d+l];return void(e[h]=a[u])}var f=i;for(;;){var m=0,g=0,y=!1;do{if(t(a[u],e[c])<0){if(e[h--]=e[c--],m++,g=0,0==--n){y=!0;break}}else if(e[h--]=a[u--],g++,m=0,1==--s){y=!0;break}}while((m|g)<f);if(y)break;do{if(0!==(m=n-gallopRight(a[u],e,r,n,n-1,t))){for(n-=m,p=(h-=m)+1,d=(c-=m)+1,l=m-1;l>=0;l--)e[p+l]=e[d+l];if(0===n){y=!0;break}}if(e[h--]=a[u--],1==--s){y=!0;break}if(0!==(g=s-gallopLeft(e[c],a,0,s,s-1,t))){for(s-=g,p=(h-=g)+1,d=(u-=g)+1,l=0;l<g;l++)e[p+l]=a[d+l];if(s<=1){y=!0;break}}if(e[h--]=e[c--],0==--n){y=!0;break}f--}while(m>=DEFAULT_MIN_GALLOPING||g>=DEFAULT_MIN_GALLOPING);if(y)break;f<0&&(f=0),f+=2}(i=f)<1&&(i=1);if(1===s){for(p=(h-=n)+1,d=(c-=n)+1,l=n-1;l>=0;l--)e[p+l]=e[d+l];e[h]=a[u]}else{if(0===s)throw new Error;for(d=h-(s-1),l=0;l<s;l++)e[d+l]=a[l]}}(l,c,u,h))}return r=[],n=[],{mergeRuns:function(){for(;o>1;){var e=o-2;if(e>=1&&n[e-1]<=n[e]+n[e+1]||e>=2&&n[e-2]<=n[e]+n[e-1])n[e-1]<n[e+1]&&e--;else if(n[e]>n[e+1])break;s(e)}},forceMergeRuns:function(){for(;o>1;){var e=o-2;e>0&&n[e-1]<n[e+1]&&e--,s(e)}},pushRun:function(e,t){r[o]=e,n[o]=t,o+=1}}}function sort(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var o=0;if(i<DEFAULT_MIN_MERGE)binaryInsertionSort(e,r,n,r+(o=makeAscendingRun(e,r,n,t)),t);else{var a=TimSort(e,t),s=minRunLength(i);do{if((o=makeAscendingRun(e,r,n,t))<s){var l=i;l>s&&(l=s),binaryInsertionSort(e,r,r+l,r+o,t),o=l}a.pushRun(r,o),a.mergeRuns(),i-=o,r+=o}while(0!==i);a.forceMergeRuns()}}}var invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0)}function shapeCompareFunc(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var Storage=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return e.prototype.traverse=function(e,t){for(var r=0;r<this._roots.length;r++)this._roots[r].traverse(e,t)},e.prototype.getDisplayList=function(e,t){t=t||!1;var r=this._displayList;return!e&&r.length||this.updateDisplayList(t),r},e.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,r=this._displayList,n=0,i=t.length;n<i;n++)this._updateAndAddDisplayable(t[n],null,e);r.length=this._displayListLen,sort(r,shapeCompareFunc)},e.prototype._updateAndAddDisplayable=function(e,t,r){if(!e.ignore||r){e.beforeUpdate(),e.update(),e.afterUpdate();var n=e.getClipPath(),i=t&&t.length,o=0,a=e.__clipPaths;if(!e.ignoreClip&&(i||n)){if(a||(a=e.__clipPaths=[]),i)for(var s=0;s<t.length;s++)a[o++]=t[s];for(var l=n,c=e;l;)l.parent=c,l.updateTransform(),a[o++]=l,c=l,l=l.getClipPath()}if(a&&(a.length=o),e.childrenRef){for(var u=e.childrenRef(),h=0;h<u.length;h++){var d=u[h];e.__dirty&&(d.__dirty|=REDRAW_BIT),this._updateAndAddDisplayable(d,a,r)}e.__dirty=0}else{var p=e;isNaN(p.z)&&(logInvalidZError(),p.z=0),isNaN(p.z2)&&(logInvalidZError(),p.z2=0),isNaN(p.zlevel)&&(logInvalidZError(),p.zlevel=0),this._displayList[this._displayListLen++]=p}var f=e.getDecalElement&&e.getDecalElement();f&&this._updateAndAddDisplayable(f,a,r);var m=e.getTextGuideLine();m&&this._updateAndAddDisplayable(m,a,r);var g=e.getTextContent();g&&this._updateAndAddDisplayable(g,a,r)}},e.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},e.prototype.delRoot=function(e){if(e instanceof Array)for(var t=0,r=e.length;t<r;t++)this.delRoot(e[t]);else{var n=indexOf(this._roots,e);n>=0&&this._roots.splice(n,1)}},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}(),requestAnimationFrame$1;function getTime(){return(new Date).getTime()}requestAnimationFrame$1=env.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var Animation=function(e){function t(t){var r=e.call(this)||this;return r._running=!1,r._time=0,r._pausedTime=0,r._pauseStart=0,r._paused=!1,t=t||{},r.stage=t.stage||{},r}return __extends(t,e),t.prototype.addClip=function(e){e.animation&&this.removeClip(e),this._head?(this._tail.next=e,e.prev=this._tail,e.next=null,this._tail=e):this._head=this._tail=e,e.animation=this},t.prototype.addAnimator=function(e){e.animation=this;var t=e.getClip();t&&this.addClip(t)},t.prototype.removeClip=function(e){if(e.animation){var t=e.prev,r=e.next;t?t.next=r:this._head=r,r?r.prev=t:this._tail=t,e.next=e.prev=e.animation=null}},t.prototype.removeAnimator=function(e){var t=e.getClip();t&&this.removeClip(t),e.animation=null},t.prototype.update=function(e){for(var t=getTime()-this._pausedTime,r=t-this._time,n=this._head;n;){var i=n.next;n.step(t,r)?(n.ondestroy(),this.removeClip(n),n=i):n=i}this._time=t,e||(this.trigger("frame",r),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var e=this;this._running=!0,requestAnimationFrame$1((function t(){e._running&&(requestAnimationFrame$1(t),!e._paused&&e.update())}))},t.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=getTime(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=getTime()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var e=this._head;e;){var t=e.next;e.prev=e.next=e.animation=null,e=t}this._head=this._tail=null},t.prototype.isFinished=function(){return null==this._head},t.prototype.animate=function(e,t){t=t||{},this.start();var r=new Animator(e,t.loop);return this.addAnimator(r),r},t}(Eventful),TOUCH_CLICK_DELAY=300,globalEventSupported=env.domSupported,localNativeListenerNames=(mouseHandlerNames=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],pointerEventNameMap={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:mouseHandlerNames,touch:["touchstart","touchend","touchmove"],pointer:map$1(mouseHandlerNames,(function(e){var t=e.replace("mouse","pointer");return pointerEventNameMap.hasOwnProperty(t)?t:e}))}),mouseHandlerNames,pointerEventNameMap,globalNativeListenerNames={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},wheelEventSupported=!1;function isPointerFromTouch(e){var t=e.pointerType;return"pen"===t||"touch"===t}function setTouchTimer(e){e.touching=!0,null!=e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout((function(){e.touching=!1,e.touchTimer=null}),700)}function markTouch(e){e&&(e.zrByTouch=!0)}function normalizeGlobalEvent(e,t){return normalizeEvent(e.dom,new FakeGlobalEvent(e,t),!0)}function isLocalEl(e,t){for(var r=t,n=!1;r&&9!==r.nodeType&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var FakeGlobalEvent=function(){return function(e,t){this.stopPropagation=noop,this.stopImmediatePropagation=noop,this.preventDefault=noop,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}}(),localDOMHandlers={mousedown:function(e){e=normalizeEvent(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=normalizeEvent(this.dom,e);var t=this.__mayPointerCapture;!t||e.zrX===t[0]&&e.zrY===t[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=normalizeEvent(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){isLocalEl(this,(e=normalizeEvent(this.dom,e)).toElement||e.relatedTarget)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){wheelEventSupported=!0,e=normalizeEvent(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){wheelEventSupported||(e=normalizeEvent(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){markTouch(e=normalizeEvent(this.dom,e)),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),localDOMHandlers.mousemove.call(this,e),localDOMHandlers.mousedown.call(this,e)},touchmove:function(e){markTouch(e=normalizeEvent(this.dom,e)),this.handler.processGesture(e,"change"),localDOMHandlers.mousemove.call(this,e)},touchend:function(e){markTouch(e=normalizeEvent(this.dom,e)),this.handler.processGesture(e,"end"),localDOMHandlers.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<TOUCH_CLICK_DELAY&&localDOMHandlers.click.call(this,e)},pointerdown:function(e){localDOMHandlers.mousedown.call(this,e)},pointermove:function(e){isPointerFromTouch(e)||localDOMHandlers.mousemove.call(this,e)},pointerup:function(e){localDOMHandlers.mouseup.call(this,e)},pointerout:function(e){isPointerFromTouch(e)||localDOMHandlers.mouseout.call(this,e)}};each(["click","dblclick","contextmenu"],(function(e){localDOMHandlers[e]=function(t){t=normalizeEvent(this.dom,t),this.trigger(e,t)}}));var globalDOMHandlers={pointermove:function(e){isPointerFromTouch(e)||globalDOMHandlers.mousemove.call(this,e)},pointerup:function(e){globalDOMHandlers.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function mountLocalDOMEventListeners(e,t){var r=t.domHandlers;env.pointerEventsSupported?each(localNativeListenerNames.pointer,(function(n){mountSingleDOMEventListener(t,n,(function(t){r[n].call(e,t)}))})):(env.touchEventsSupported&&each(localNativeListenerNames.touch,(function(n){mountSingleDOMEventListener(t,n,(function(i){r[n].call(e,i),setTouchTimer(t)}))})),each(localNativeListenerNames.mouse,(function(n){mountSingleDOMEventListener(t,n,(function(i){i=getNativeEvent(i),t.touching||r[n].call(e,i)}))})))}function mountGlobalDOMEventListeners(e,t){function r(r){mountSingleDOMEventListener(t,r,(function(n){n=getNativeEvent(n),isLocalEl(e,n.target)||(n=normalizeGlobalEvent(e,n),t.domHandlers[r].call(e,n))}),{capture:!0})}env.pointerEventsSupported?each(globalNativeListenerNames.pointer,r):env.touchEventsSupported||each(globalNativeListenerNames.mouse,r)}function mountSingleDOMEventListener(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,addEventListener$1(e.domTarget,t,r,n)}function unmountDOMEventListeners(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&removeEventListener$1(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var DOMHandlerScope=function(){return function(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t}}(),HandlerDomProxy=function(e){function t(t,r){var n=e.call(this)||this;return n.__pointerCapturing=!1,n.dom=t,n.painterRoot=r,n._localHandlerScope=new DOMHandlerScope(t,localDOMHandlers),globalEventSupported&&(n._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(n,n._localHandlerScope),n}return __extends(t,e),t.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},t.prototype.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},t.prototype.__togglePointerCapture=function(e){if(this.__mayPointerCapture=null,globalEventSupported&&+this.__pointerCapturing^+e){this.__pointerCapturing=e;var t=this._globalHandlerScope;e?mountGlobalDOMEventListeners(this,t):unmountDOMEventListeners(t)}},t}(Eventful),painterCtors={},instances={};function delInstance(e){delete instances[e]}function isDarkMode(e){if(!e)return!1;if("string"==typeof e)return lum(e,1)<DARK_MODE_THRESHOLD;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=lum(t[i].color,1);return(r/=n)<DARK_MODE_THRESHOLD}return!1}var ZRender=function(){function e(e,t,r){var n=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,r=r||{},this.dom=t,this.id=e;var i=new Storage,o=r.renderer||"canvas";painterCtors[o]||(o=keys(painterCtors)[0]),r.useDirtyRect=null!=r.useDirtyRect&&r.useDirtyRect;var a=new painterCtors[o](t,i,r,e),s=r.ssr||a.ssrOnly;this.storage=i,this.painter=a;var l,c=env.node||env.worker||s?null:new HandlerDomProxy(a.getViewportRoot(),a.root),u=r.useCoarsePointer;(null==u||"auto"===u?env.touchEventsSupported:!!u)&&(l=retrieve2(r.pointerSize,44)),this.handler=new Handler(i,a,c,a.root,l),this.animation=new Animation({stage:{update:s?null:function(){return n._flush(!0)}}}),s||this.animation.start()}return e.prototype.add=function(e){!this._disposed&&e&&(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},e.prototype.remove=function(e){!this._disposed&&e&&(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(e,t){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh())},e.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=isDarkMode(e))},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(e){this._darkMode=e},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},e.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},e.prototype.flush=function(){this._disposed||this._flush(!1)},e.prototype._flush=function(e){var t,r=getTime();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var n=getTime();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:n-r})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},e.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},e.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},e.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},e.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},e.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},e.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},e.prototype.findHover=function(e,t){if(!this._disposed)return this.handler.findHover(e,t)},e.prototype.on=function(e,t,r){return this._disposed||this.handler.on(e,t,r),this},e.prototype.off=function(e,t){this._disposed||this.handler.off(e,t)},e.prototype.trigger=function(e,t){this._disposed||this.handler.trigger(e,t)},e.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof Group&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},e.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,delInstance(this.id))},e}();function init$1(e,t){var r=new ZRender(guid(),e,t);return instances[r.id]=r,r}function registerPainter(e,t){painterCtors[e]=t}var wmUniqueIndex=Math.round(9*Math.random()),supportDefineProperty="function"==typeof Object.defineProperty,WeakMap$1=function(){function e(){this._id="__ec_inner_"+wmUniqueIndex++}return e.prototype.get=function(e){return this._guard(e)[this._id]},e.prototype.set=function(e,t){var r=this._guard(e);return supportDefineProperty?Object.defineProperty(r,this._id,{value:t,enumerable:!1,configurable:!0}):r[this._id]=t,this},e.prototype.delete=function(e){return!!this.has(e)&&(delete this._guard(e)[this._id],!0)},e.prototype.has=function(e){return!!this._guard(e)[this._id]},e.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},e}();function isSafeNum(e){return isFinite(e)}function createLinearGradient(e,t,r){var n=null==t.x?0:t.x,i=null==t.x2?1:t.x2,o=null==t.y?0:t.y,a=null==t.y2?0:t.y2;return t.global||(n=n*r.width+r.x,i=i*r.width+r.x,o=o*r.height+r.y,a=a*r.height+r.y),n=isSafeNum(n)?n:0,i=isSafeNum(i)?i:1,o=isSafeNum(o)?o:0,a=isSafeNum(a)?a:0,e.createLinearGradient(n,o,i,a)}function createRadialGradient(e,t,r){var n=r.width,i=r.height,o=Math.min(n,i),a=null==t.x?.5:t.x,s=null==t.y?.5:t.y,l=null==t.r?.5:t.r;return t.global||(a=a*n+r.x,s=s*i+r.y,l*=o),a=isSafeNum(a)?a:.5,s=isSafeNum(s)?s:.5,l=l>=0&&isSafeNum(l)?l:.5,e.createRadialGradient(a,s,0,a,s,l)}function getCanvasGradient(e,t,r){for(var n="radial"===t.type?createRadialGradient(e,t,r):createLinearGradient(e,t,r),i=t.colorStops,o=0;o<i.length;o++)n.addColorStop(i[o].offset,i[o].color);return n}function isClipPathChanged(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function parseInt10(e){return parseInt(e,10)}function getSize(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],a=["paddingRight","paddingBottom"][t];if(null!=r[n]&&"auto"!==r[n])return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||parseInt10(s[n])||parseInt10(e.style[n]))-(parseInt10(s[o])||0)-(parseInt10(s[a])||0)|0}function normalizeLineDash(e,t){return e&&"solid"!==e&&t>0?"dashed"===e?[4*t,2*t]:"dotted"===e?[t]:isNumber$1(e)?[e]:isArray(e)?e:null:null}function getLineDash(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&normalizeLineDash(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&1!==i&&(r=map$1(r,(function(e){return e/i})),n/=i)}return[r,n]}var pathProxyForDraw=new PathProxy(!0);function styleHasStroke(e){var t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))}function isValidStrokeFillStyle(e){return"string"==typeof e&&"none"!==e}function styleHasFill(e){var t=e.fill;return null!=t&&"none"!==t}function doFillPath(e,t){if(null!=t.fillOpacity&&1!==t.fillOpacity){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function doStrokePath(e,t){if(null!=t.strokeOpacity&&1!==t.strokeOpacity){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function createCanvasPattern(e,t,r){var n=createOrUpdateImage(t.image,t.__image,r);if(isImageReady(n)){var i=e.createPattern(n,t.repeat||"repeat");if("function"==typeof DOMMatrix&&i&&i.setTransform){var o=new DOMMatrix;o.translateSelf(t.x||0,t.y||0),o.rotateSelf(0,0,(t.rotation||0)*RADIAN_TO_DEGREE),o.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(o)}return i}}function brushPath(e,t,r,n){var i,o=styleHasStroke(r),a=styleHasFill(r),s=r.strokePercent,l=s<1,c=!t.path;t.silent&&!l||!c||t.createPathProxy();var u=t.path||pathProxyForDraw,h=t.__dirty;if(!n){var d=r.fill,p=r.stroke,f=a&&!!d.colorStops,m=o&&!!p.colorStops,g=a&&!!d.image,y=o&&!!p.image,_=void 0,v=void 0,b=void 0,w=void 0,x=void 0;(f||m)&&(x=t.getBoundingRect()),f&&(_=h?getCanvasGradient(e,d,x):t.__canvasFillGradient,t.__canvasFillGradient=_),m&&(v=h?getCanvasGradient(e,p,x):t.__canvasStrokeGradient,t.__canvasStrokeGradient=v),g&&(b=h||!t.__canvasFillPattern?createCanvasPattern(e,d,t):t.__canvasFillPattern,t.__canvasFillPattern=b),y&&(w=h||!t.__canvasStrokePattern?createCanvasPattern(e,p,t):t.__canvasStrokePattern,t.__canvasStrokePattern=w),f?e.fillStyle=_:g&&(b?e.fillStyle=b:a=!1),m?e.strokeStyle=v:y&&(w?e.strokeStyle=w:o=!1)}var S,E,T=t.getGlobalScale();u.setScale(T[0],T[1],t.segmentIgnoreThreshold),e.setLineDash&&r.lineDash&&(S=(i=getLineDash(t))[0],E=i[1]);var A=!0;(c||h&SHAPE_CHANGED_BIT)&&(u.setDPR(e.dpr),l?u.setContext(null):(u.setContext(e),A=!1),u.reset(),t.buildPath(u,t.shape,n),u.toStatic(),t.pathUpdated()),A&&u.rebuildPath(e,l?s:1),S&&(e.setLineDash(S),e.lineDashOffset=E),n||(r.strokeFirst?(o&&doStrokePath(e,r),a&&doFillPath(e,r)):(a&&doFillPath(e,r),o&&doStrokePath(e,r))),S&&e.setLineDash([])}function brushImage(e,t,r){var n=t.__image=createOrUpdateImage(r.image,t.__image,t,t.onload);if(n&&isImageReady(n)){var i=r.x||0,o=r.y||0,a=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(null==a&&null!=s?a=s*l:null==s&&null!=a?s=a/l:null==a&&null==s&&(a=n.width,s=n.height),r.sWidth&&r.sHeight){var c=r.sx||0,u=r.sy||0;e.drawImage(n,c,u,r.sWidth,r.sHeight,i,o,a,s)}else if(r.sx&&r.sy){var h=a-(c=r.sx),d=s-(u=r.sy);e.drawImage(n,c,u,h,d,i,o,a,s)}else e.drawImage(n,i,o,a,s)}}function brushText(e,t,r){var n,i=r.text;if(null!=i&&(i+=""),i){e.font=r.font||DEFAULT_FONT,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var o=void 0,a=void 0;e.setLineDash&&r.lineDash&&(o=(n=getLineDash(t))[0],a=n[1]),o&&(e.setLineDash(o),e.lineDashOffset=a),r.strokeFirst?(styleHasStroke(r)&&e.strokeText(i,r.x,r.y),styleHasFill(r)&&e.fillText(i,r.x,r.y)):(styleHasFill(r)&&e.fillText(i,r.x,r.y),styleHasStroke(r)&&e.strokeText(i,r.x,r.y)),o&&e.setLineDash([])}}var SHADOW_NUMBER_PROPS=["shadowBlur","shadowOffsetX","shadowOffsetY"],STROKE_PROPS=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function bindCommonProps(e,t,r,n,i){var o=!1;if(!n&&t===(r=r||{}))return!1;if(n||t.opacity!==r.opacity){flushPathDrawn(e,i),o=!0;var a=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(a)?DEFAULT_COMMON_STYLE.opacity:a}(n||t.blend!==r.blend)&&(o||(flushPathDrawn(e,i),o=!0),e.globalCompositeOperation=t.blend||DEFAULT_COMMON_STYLE.blend);for(var s=0;s<SHADOW_NUMBER_PROPS.length;s++){var l=SHADOW_NUMBER_PROPS[s];(n||t[l]!==r[l])&&(o||(flushPathDrawn(e,i),o=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(o||(flushPathDrawn(e,i),o=!0),e.shadowColor=t.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),o}function bindPathAndTextCommonStyle(e,t,r,n,i){var o=getStyle(t,i.inHover),a=n?null:r&&getStyle(r,i.inHover)||{};if(o===a)return!1;var s=bindCommonProps(e,o,a,n,i);if((n||o.fill!==a.fill)&&(s||(flushPathDrawn(e,i),s=!0),isValidStrokeFillStyle(o.fill)&&(e.fillStyle=o.fill)),(n||o.stroke!==a.stroke)&&(s||(flushPathDrawn(e,i),s=!0),isValidStrokeFillStyle(o.stroke)&&(e.strokeStyle=o.stroke)),(n||o.opacity!==a.opacity)&&(s||(flushPathDrawn(e,i),s=!0),e.globalAlpha=null==o.opacity?1:o.opacity),t.hasStroke()){var l=o.lineWidth/(o.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==l&&(s||(flushPathDrawn(e,i),s=!0),e.lineWidth=l)}for(var c=0;c<STROKE_PROPS.length;c++){var u=STROKE_PROPS[c],h=u[0];(n||o[h]!==a[h])&&(s||(flushPathDrawn(e,i),s=!0),e[h]=o[h]||u[1])}return s}function bindImageStyle(e,t,r,n,i){return bindCommonProps(e,getStyle(t,i.inHover),r&&getStyle(r,i.inHover),n,i)}function setContextTransform(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function updateClipStatus(e,t,r){for(var n=!1,i=0;i<e.length;i++){var o=e[i];n=n||o.isZeroArea(),setContextTransform(t,o),t.beginPath(),o.buildPath(t,o.shape),t.clip()}r.allClipped=n}function isTransformChanged(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var DRAW_TYPE_PATH=1,DRAW_TYPE_IMAGE=2,DRAW_TYPE_TEXT=3,DRAW_TYPE_INCREMENTAL=4,nodeParsers;function canPathBatch(e){var t=styleHasFill(e),r=styleHasStroke(e);return!(e.lineDash||!(+t^+r)||t&&"string"!=typeof e.fill||r&&"string"!=typeof e.stroke||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function flushPathDrawn(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function getStyle(e,t){return t&&e.__hoverStyle||e.style}function brushSingle(e,t){brush(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1))return t.__dirty&=~REDRAW_BIT,void(t.__isRendered=!1);var o=t.__clipPaths,a=r.prevElClipPaths,s=!1,l=!1;if(a&&!isClipPathChanged(o,a)||(a&&a.length&&(flushPathDrawn(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),o&&o.length&&(flushPathDrawn(e,r),e.save(),updateClipStatus(o,e,r),s=!0),r.prevElClipPaths=o),r.allClipped)t.__isRendered=!1;else{t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var c=r.prevEl;c||(l=s=!0);var u=t instanceof Path&&t.autoBatch&&canPathBatch(t.style);s||isTransformChanged(i,c.transform)?(flushPathDrawn(e,r),setContextTransform(e,t)):u||flushPathDrawn(e,r);var h=getStyle(t,r.inHover);t instanceof Path?(r.lastDrawType!==DRAW_TYPE_PATH&&(l=!0,r.lastDrawType=DRAW_TYPE_PATH),bindPathAndTextCommonStyle(e,t,c,l,r),u&&(r.batchFill||r.batchStroke)||e.beginPath(),brushPath(e,t,h,u),u&&(r.batchFill=h.fill||"",r.batchStroke=h.stroke||"")):t instanceof TSpan?(r.lastDrawType!==DRAW_TYPE_TEXT&&(l=!0,r.lastDrawType=DRAW_TYPE_TEXT),bindPathAndTextCommonStyle(e,t,c,l,r),brushText(e,t,h)):t instanceof ZRImage?(r.lastDrawType!==DRAW_TYPE_IMAGE&&(l=!0,r.lastDrawType=DRAW_TYPE_IMAGE),bindImageStyle(e,t,c,l,r),brushImage(e,t,h)):t.getTemporalDisplayables&&(r.lastDrawType!==DRAW_TYPE_INCREMENTAL&&(l=!0,r.lastDrawType=DRAW_TYPE_INCREMENTAL),brushIncremental(e,t,r)),u&&n&&flushPathDrawn(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}}function brushIncremental(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var o,a,s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover};for(o=t.getCursor(),a=n.length;o<a;o++){(u=n[o]).beforeBrush&&u.beforeBrush(),u.innerBeforeBrush(),brush(e,u,s,o===a-1),u.innerAfterBrush(),u.afterBrush&&u.afterBrush(),s.prevEl=u}for(var l=0,c=i.length;l<c;l++){var u;(u=i[l]).beforeBrush&&u.beforeBrush(),u.innerBeforeBrush(),brush(e,u,s,l===c-1),u.innerAfterBrush(),u.afterBrush&&u.afterBrush(),s.prevEl=u}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}function parseXML(e){isString(e)&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=e;for(9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;)t=t.nextSibling;return t}var INHERITABLE_STYLE_ATTRIBUTES_MAP={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS=keys(INHERITABLE_STYLE_ATTRIBUTES_MAP),SELF_STYLE_ATTRIBUTES_MAP={"alignment-baseline":"textBaseline","stop-color":"stopColor"},SELF_STYLE_ATTRIBUTES_MAP_KEYS=keys(SELF_STYLE_ATTRIBUTES_MAP),SVGParser=function(){function e(){this._defs={},this._root=null}return e.prototype.parse=function(e,t){t=t||{};var r=parseXML(e);this._defsUsePending=[];var n=new Group;this._root=n;var i=[],o=r.getAttribute("viewBox")||"",a=parseFloat(r.getAttribute("width")||t.width),s=parseFloat(r.getAttribute("height")||t.height);isNaN(a)&&(a=null),isNaN(s)&&(s=null),parseAttributes(r,n,null,!0,!1);for(var l,c,u=r.firstChild;u;)this._parseNode(u,n,i,null,!1,!1),u=u.nextSibling;if(applyDefs(this._defs,this._defsUsePending),this._defsUsePending=[],o){var h=splitNumberSequence(o);h.length>=4&&(l={x:parseFloat(h[0]||0),y:parseFloat(h[1]||0),width:parseFloat(h[2]),height:parseFloat(h[3])})}if(l&&null!=a&&null!=s&&(c=makeViewBoxTransform(l,{x:0,y:0,width:a,height:s}),!t.ignoreViewBox)){var d=n;(n=new Group).add(d),d.scaleX=d.scaleY=c.scale,d.x=c.x,d.y=c.y}return t.ignoreRootClip||null==a||null==s||n.setClipPath(new Rect({shape:{x:0,y:0,width:a,height:s}})),{root:n,width:a,height:s,viewBoxRect:l,viewBoxTransform:c,named:i}},e.prototype._parseNode=function(e,t,r,n,i,o){var a,s=e.nodeName.toLowerCase(),l=n;if("defs"===s&&(i=!0),"text"===s&&(o=!0),"defs"===s||"switch"===s)a=t;else{if(!i){var c=nodeParsers[s];if(c&&hasOwn(nodeParsers,s)){a=c.call(this,e,t);var u=e.getAttribute("name");if(u){var h={name:u,namedFrom:null,svgNodeTagLower:s,el:a};r.push(h),"g"===s&&(l=h)}else n&&r.push({name:n.name,namedFrom:n,svgNodeTagLower:s,el:a});t.add(a)}}var d=paintServerParsers[s];if(d&&hasOwn(paintServerParsers,s)){var p=d.call(this,e),f=e.getAttribute("id");f&&(this._defs[f]=p)}}if(a&&a.isGroup)for(var m=e.firstChild;m;)1===m.nodeType?this._parseNode(m,a,r,l,i,o):3===m.nodeType&&o&&this._parseText(m,a),m=m.nextSibling},e.prototype._parseText=function(e,t){var r=new TSpan({style:{text:e.textContent},silent:!0,x:this._textX||0,y:this._textY||0});inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),applyTextAlignment(r,t);var n=r.style,i=n.fontSize;i&&i<9&&(n.fontSize=9,r.scaleX*=i/9,r.scaleY*=i/9);var o=(n.fontSize||n.fontFamily)&&[n.fontStyle,n.fontWeight,(n.fontSize||12)+"px",n.fontFamily||"sans-serif"].join(" ");n.font=o;var a=r.getBoundingRect();return this._textX+=a.width,t.add(r),r},e.internalField=void(nodeParsers={g:function(e,t){var r=new Group;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r},rect:function(e,t){var r=new Rect;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.setShape({x:parseFloat(e.getAttribute("x")||"0"),y:parseFloat(e.getAttribute("y")||"0"),width:parseFloat(e.getAttribute("width")||"0"),height:parseFloat(e.getAttribute("height")||"0")}),r.silent=!0,r},circle:function(e,t){var r=new Circle;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),r:parseFloat(e.getAttribute("r")||"0")}),r.silent=!0,r},line:function(e,t){var r=new Line;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.setShape({x1:parseFloat(e.getAttribute("x1")||"0"),y1:parseFloat(e.getAttribute("y1")||"0"),x2:parseFloat(e.getAttribute("x2")||"0"),y2:parseFloat(e.getAttribute("y2")||"0")}),r.silent=!0,r},ellipse:function(e,t){var r=new Ellipse;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),rx:parseFloat(e.getAttribute("rx")||"0"),ry:parseFloat(e.getAttribute("ry")||"0")}),r.silent=!0,r},polygon:function(e,t){var r,n=e.getAttribute("points");n&&(r=parsePoints(n));var i=new Polygon$1({shape:{points:r||[]},silent:!0});return inheritStyle(t,i),parseAttributes(e,i,this._defsUsePending,!1,!1),i},polyline:function(e,t){var r,n=e.getAttribute("points");n&&(r=parsePoints(n));var i=new Polyline({shape:{points:r||[]},silent:!0});return inheritStyle(t,i),parseAttributes(e,i,this._defsUsePending,!1,!1),i},image:function(e,t){var r=new ZRImage;return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.setStyle({image:e.getAttribute("xlink:href")||e.getAttribute("href"),x:+e.getAttribute("x"),y:+e.getAttribute("y"),width:+e.getAttribute("width"),height:+e.getAttribute("height")}),r.silent=!0,r},text:function(e,t){var r=e.getAttribute("x")||"0",n=e.getAttribute("y")||"0",i=e.getAttribute("dx")||"0",o=e.getAttribute("dy")||"0";this._textX=parseFloat(r)+parseFloat(i),this._textY=parseFloat(n)+parseFloat(o);var a=new Group;return inheritStyle(t,a),parseAttributes(e,a,this._defsUsePending,!1,!0),a},tspan:function(e,t){var r=e.getAttribute("x"),n=e.getAttribute("y");null!=r&&(this._textX=parseFloat(r)),null!=n&&(this._textY=parseFloat(n));var i=e.getAttribute("dx")||"0",o=e.getAttribute("dy")||"0",a=new Group;return inheritStyle(t,a),parseAttributes(e,a,this._defsUsePending,!1,!0),this._textX+=parseFloat(i),this._textY+=parseFloat(o),a},path:function(e,t){var r=createFromString(e.getAttribute("d")||"");return inheritStyle(t,r),parseAttributes(e,r,this._defsUsePending,!1,!1),r.silent=!0,r}}),e}(),paintServerParsers={lineargradient:function(e){var t=parseInt(e.getAttribute("x1")||"0",10),r=parseInt(e.getAttribute("y1")||"0",10),n=parseInt(e.getAttribute("x2")||"10",10),i=parseInt(e.getAttribute("y2")||"0",10),o=new LinearGradient(t,r,n,i);return parsePaintServerUnit(e,o),parseGradientColorStops(e,o),o},radialgradient:function(e){var t=parseInt(e.getAttribute("cx")||"0",10),r=parseInt(e.getAttribute("cy")||"0",10),n=parseInt(e.getAttribute("r")||"0",10),i=new RadialGradient(t,r,n);return parsePaintServerUnit(e,i),parseGradientColorStops(e,i),i}};function parsePaintServerUnit(e,t){"userSpaceOnUse"===e.getAttribute("gradientUnits")&&(t.global=!0)}function parseGradientColorStops(e,t){for(var r=e.firstChild;r;){if(1===r.nodeType&&"stop"===r.nodeName.toLocaleLowerCase()){var n=r.getAttribute("offset"),i=void 0;i=n&&n.indexOf("%")>0?parseInt(n,10)/100:n?parseFloat(n):0;var o={};parseInlineStyle(r,o,o);var a=o.stopColor||r.getAttribute("stop-color")||"#000000",s=o.stopOpacity||r.getAttribute("stop-opacity");if(s){var l=parse$3(a);l&&l[3]&&(l[3]*=parseCssFloat(s),a=stringify(l,"rgba"))}t.colorStops.push({offset:i,color:a})}r=r.nextSibling}}function inheritStyle(e,t){e&&e.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),defaults(t.__inheritedStyle,e.__inheritedStyle))}function parsePoints(e){for(var t=splitNumberSequence(e),r=[],n=0;n<t.length;n+=2){var i=parseFloat(t[n]),o=parseFloat(t[n+1]);r.push([i,o])}return r}function parseAttributes(e,t,r,n,i){var o=t,a=o.__inheritedStyle=o.__inheritedStyle||{},s={};1===e.nodeType&&(parseTransformAttribute(e,t),parseInlineStyle(e,a,s),n||parseAttributeStyle(e,a,s)),o.style=o.style||{},null!=a.fill&&(o.style.fill=getFillStrokeStyle(o,"fill",a.fill,r)),null!=a.stroke&&(o.style.stroke=getFillStrokeStyle(o,"stroke",a.stroke,r)),each(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],(function(e){null!=a[e]&&(o.style[e]=parseFloat(a[e]))})),each(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],(function(e){null!=a[e]&&(o.style[e]=a[e])})),i&&(o.__selfStyle=s),a.lineDash&&(o.style.lineDash=map$1(splitNumberSequence(a.lineDash),(function(e){return parseFloat(e)}))),"hidden"!==a.visibility&&"collapse"!==a.visibility||(o.invisible=!0),"none"===a.display&&(o.ignore=!0)}function applyTextAlignment(e,t){var r=t.__selfStyle;if(r){var n=r.textBaseline,i=n;n&&"auto"!==n?"baseline"===n?i="alphabetic":"before-edge"===n||"text-before-edge"===n?i="top":"after-edge"===n||"text-after-edge"===n?i="bottom":"central"!==n&&"mathematical"!==n||(i="middle"):i="alphabetic",e.style.textBaseline=i}var o=t.__inheritedStyle;if(o){var a=o.textAlign,s=a;a&&("middle"===a&&(s="center"),e.style.textAlign=s)}}var urlRegex=/^url\(\s*#(.*?)\)/;function getFillStrokeStyle(e,t,r,n){var i=r&&r.match(urlRegex);if(!i)return"none"===r&&(r=null),r;var o=trim(i[1]);n.push([e,t,o])}function applyDefs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n[0].style[n[1]]=e[n[2]]}}var numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function splitNumberSequence(e){return e.match(numberReg)||[]}var transformRegex=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,DEGREE_TO_ANGLE=Math.PI/180;function parseTransformAttribute(e,t){var r=e.getAttribute("transform");if(r){r=r.replace(/,/g," ");var n=[],i=null;r.replace(transformRegex,(function(e,t,r){return n.push(t,r),""}));for(var o=n.length-1;o>0;o-=2){var a=n[o],s=n[o-1],l=splitNumberSequence(a);switch(i=i||create$1(),s){case"translate":translate(i,i,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":scale$1(i,i,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":rotate(i,i,-parseFloat(l[0])*DEGREE_TO_ANGLE,[parseFloat(l[1]||"0"),parseFloat(l[2]||"0")]);break;case"skewX":mul(i,[1,0,Math.tan(parseFloat(l[0])*DEGREE_TO_ANGLE),1,0,0],i);break;case"skewY":mul(i,[1,Math.tan(parseFloat(l[0])*DEGREE_TO_ANGLE),0,1,0,0],i);break;case"matrix":i[0]=parseFloat(l[0]),i[1]=parseFloat(l[1]),i[2]=parseFloat(l[2]),i[3]=parseFloat(l[3]),i[4]=parseFloat(l[4]),i[5]=parseFloat(l[5])}}t.setLocalTransform(i)}}var styleRegex=/([^\s:;]+)\s*:\s*([^:;]+)/g;function parseInlineStyle(e,t,r){var n,i=e.getAttribute("style");if(i)for(styleRegex.lastIndex=0;null!=(n=styleRegex.exec(i));){var o=n[1],a=hasOwn(INHERITABLE_STYLE_ATTRIBUTES_MAP,o)?INHERITABLE_STYLE_ATTRIBUTES_MAP[o]:null;a&&(t[a]=n[2]);var s=hasOwn(SELF_STYLE_ATTRIBUTES_MAP,o)?SELF_STYLE_ATTRIBUTES_MAP[o]:null;s&&(r[s]=n[2])}}function parseAttributeStyle(e,t,r){for(var n=0;n<INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS.length;n++){var i=INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS[n];null!=(o=e.getAttribute(i))&&(t[INHERITABLE_STYLE_ATTRIBUTES_MAP[i]]=o)}for(n=0;n<SELF_STYLE_ATTRIBUTES_MAP_KEYS.length;n++){var o;i=SELF_STYLE_ATTRIBUTES_MAP_KEYS[n];null!=(o=e.getAttribute(i))&&(r[SELF_STYLE_ATTRIBUTES_MAP[i]]=o)}}function makeViewBoxTransform(e,t){var r=t.width/e.width,n=t.height/e.height,i=Math.min(r,n);return{scale:i,x:-(e.x+e.width/2)*i+(t.x+t.width/2),y:-(e.y+e.height/2)*i+(t.y+t.height/2)}}function parseSVG(e,t){return(new SVGParser).parse(e,t)}var EPSILON=1e-8;function isAroundEqual(e,t){return Math.abs(e-t)<EPSILON}function contain(e,t,r){var n=0,i=e[0];if(!i)return!1;for(var o=1;o<e.length;o++){var a=e[o];n+=windingLine(i[0],i[1],a[0],a[1],t,r),i=a}var s=e[0];return isAroundEqual(i[0],s[0])&&isAroundEqual(i[1],s[1])||(n+=windingLine(i[0],i[1],s[0],s[1],t,r)),0!==n}var CMD=PathProxy.CMD;function aroundEqual(e,t){return Math.abs(e-t)<1e-5}function pathToBezierCurves(e){var t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T=e.data,A=e.len(),C=[],I=0,k=0,P=0,M=0;function R(e,r){t&&t.length>2&&C.push(t),t=[e,r]}function D(e,r,n,i){aroundEqual(e,n)&&aroundEqual(r,i)||t.push(e,r,n,i,n,i)}for(var O=0;O<A;){var L=T[O++],B=1===O;switch(B&&(P=I=T[O],M=k=T[O+1],L!==CMD.L&&L!==CMD.C&&L!==CMD.Q||(t=[P,M])),L){case CMD.M:I=P=T[O++],k=M=T[O++],R(P,M);break;case CMD.L:D(I,k,r=T[O++],n=T[O++]),I=r,k=n;break;case CMD.C:t.push(T[O++],T[O++],T[O++],T[O++],I=T[O++],k=T[O++]);break;case CMD.Q:r=T[O++],n=T[O++],i=T[O++],o=T[O++],t.push(I+2/3*(r-I),k+2/3*(n-k),i+2/3*(r-i),o+2/3*(n-o),i,o),I=i,k=o;break;case CMD.A:var $=T[O++],z=T[O++],F=T[O++],q=T[O++],N=T[O++],j=T[O++]+N;O+=1;var U=!T[O++];r=Math.cos(N)*F+$,n=Math.sin(N)*q+z,B?R(P=r,M=n):D(I,k,r,n),I=Math.cos(j)*F+$,k=Math.sin(j)*q+z;for(var V=(U?-1:1)*Math.PI/2,G=N;U?G>j:G<j;G+=V){var W=U?Math.max(G+V,j):Math.min(G+V,j);a=G,s=W,l=$,c=z,u=F,h=q,d=void 0,p=void 0,f=void 0,m=void 0,g=void 0,y=void 0,_=void 0,v=void 0,b=void 0,w=void 0,x=void 0,S=void 0,E=void 0,d=Math.abs(s-a),p=4*Math.tan(d/4)/3,f=s<a?-1:1,m=Math.cos(a),g=Math.sin(a),y=Math.cos(s),_=Math.sin(s),v=m*u+l,b=g*h+c,w=y*u+l,x=_*h+c,S=u*p*f,E=h*p*f,t.push(v-S*g,b+E*m,w+S*_,x-E*y,w,x)}break;case CMD.R:P=I=T[O++],M=k=T[O++],r=P+T[O++],n=M+T[O++],R(r,M),D(r,M,r,n),D(r,n,P,n),D(P,n,P,M),D(P,M,r,M);break;case CMD.Z:t&&D(I,k,P,M),I=P,k=M}}return t&&t.length>2&&C.push(t),C}function adpativeBezier(e,t,r,n,i,o,a,s,l,c){if(aroundEqual(e,r)&&aroundEqual(t,n)&&aroundEqual(i,a)&&aroundEqual(o,s))l.push(a,s);else{var u=2/c,h=u*u,d=a-e,p=s-t,f=Math.sqrt(d*d+p*p);d/=f,p/=f;var m=r-e,g=n-t,y=i-a,_=o-s,v=m*m+g*g,b=y*y+_*_;if(v<h&&b<h)l.push(a,s);else{var w=d*m+p*g,x=-d*y-p*_;if(v-w*w<h&&w>=0&&b-x*x<h&&x>=0)l.push(a,s);else{var S=[],E=[];cubicSubdivide(e,r,i,a,.5,S),cubicSubdivide(t,n,o,s,.5,E),adpativeBezier(S[0],E[0],S[1],E[1],S[2],E[2],S[3],E[3],l,c),adpativeBezier(S[4],E[4],S[5],E[5],S[6],E[6],S[7],E[7],l,c)}}}}function pathToPolygons(e,t){var r=pathToBezierCurves(e),n=[];t=t||1;for(var i=0;i<r.length;i++){var o=r[i],a=[],s=o[0],l=o[1];a.push(s,l);for(var c=2;c<o.length;){var u=o[c++],h=o[c++],d=o[c++],p=o[c++],f=o[c++],m=o[c++];adpativeBezier(s,l,u,h,d,p,f,m,a,t),s=f,l=m}n.push(a)}return n}function getDividingGrids(e,t,r){var n=e[t],i=e[1-t],o=Math.abs(n/i),a=Math.ceil(Math.sqrt(o*r)),s=Math.floor(r/a);0===s&&(s=1,a=r);for(var l=[],c=0;c<a;c++)l.push(s);var u=r-a*s;if(u>0)for(c=0;c<u;c++)l[c%a]+=1;return l}function divideSector(e,t,r){for(var n=e.r0,i=e.r,o=e.startAngle,a=e.endAngle,s=Math.abs(a-o),l=s*i,c=i-n,u=l>Math.abs(c),h=getDividingGrids([l,c],u?0:1,t),d=(u?s:c)/h.length,p=0;p<h.length;p++)for(var f=(u?c:s)/h[p],m=0;m<h[p];m++){var g={};u?(g.startAngle=o+d*p,g.endAngle=o+d*(p+1),g.r0=n+f*m,g.r=n+f*(m+1)):(g.startAngle=o+f*m,g.endAngle=o+f*(m+1),g.r0=n+d*p,g.r=n+d*(p+1)),g.clockwise=e.clockwise,g.cx=e.cx,g.cy=e.cy,r.push(g)}}function divideRect(e,t,r){for(var n=e.width,i=e.height,o=n>i,a=getDividingGrids([n,i],o?0:1,t),s=o?"width":"height",l=o?"height":"width",c=o?"x":"y",u=o?"y":"x",h=e[s]/a.length,d=0;d<a.length;d++)for(var p=e[l]/a[d],f=0;f<a[d];f++){var m={};m[c]=d*h,m[u]=f*p,m[s]=h,m[l]=p,m.x+=e.x,m.y+=e.y,r.push(m)}}function crossProduct2d(e,t,r,n){return e*n-r*t}function lineLineIntersect(e,t,r,n,i,o,a,s){var l=r-e,c=n-t,u=a-i,h=s-o,d=crossProduct2d(u,h,l,c);if(Math.abs(d)<1e-6)return null;var p=crossProduct2d(e-i,t-o,u,h)/d;return p<0||p>1?null:new Point$2(p*l+e,p*c+t)}function projPtOnLine(e,t,r){var n=new Point$2;Point$2.sub(n,r,t),n.normalize();var i=new Point$2;return Point$2.sub(i,e,t),i.dot(n)}function addToPoly(e,t){var r=e[e.length-1];r&&r[0]===t[0]&&r[1]===t[1]||e.push(t)}function splitPolygonByLine(e,t,r){for(var n=e.length,i=[],o=0;o<n;o++){var a=e[o],s=e[(o+1)%n],l=lineLineIntersect(a[0],a[1],s[0],s[1],t.x,t.y,r.x,r.y);l&&i.push({projPt:projPtOnLine(l,t,r),pt:l,idx:o})}if(i.length<2)return[{points:e},{points:e}];i.sort((function(e,t){return e.projPt-t.projPt}));var c=i[0],u=i[i.length-1];if(u.idx<c.idx){var h=c;c=u,u=h}var d=[c.pt.x,c.pt.y],p=[u.pt.x,u.pt.y],f=[d],m=[p];for(o=c.idx+1;o<=u.idx;o++)addToPoly(f,e[o].slice());addToPoly(f,p),addToPoly(f,d);for(o=u.idx+1;o<=c.idx+n;o++)addToPoly(m,e[o%n].slice());return addToPoly(m,d),addToPoly(m,p),[{points:f},{points:m}]}function binaryDividePolygon(e){var t=e.points,r=[],n=[];fromPoints(t,r,n);var i=new BoundingRect(r[0],r[1],n[0]-r[0],n[1]-r[1]),o=i.width,a=i.height,s=i.x,l=i.y,c=new Point$2,u=new Point$2;return o>a?(c.x=u.x=s+o/2,c.y=l,u.y=l+a):(c.y=u.y=l+a/2,c.x=s,u.x=s+o),splitPolygonByLine(t,c,u)}function binaryDivideRecursive(e,t,r,n){if(1===r)n.push(t);else{var i=Math.floor(r/2),o=e(t);binaryDivideRecursive(e,o[0],i,n),binaryDivideRecursive(e,o[1],r-i,n)}return n}function clone$2(e,t){for(var r=[],n=0;n<t;n++)r.push(clonePath(e));return r}function copyPathProps(e,t){t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel}function polygonConvert(e){for(var t=[],r=0;r<e.length;)t.push([e[r++],e[r++]]);return t}function split(e,t){var r,n=[],i=e.shape;switch(e.type){case"rect":divideRect(i,t,n),r=Rect;break;case"sector":divideSector(i,t,n),r=Sector;break;case"circle":divideSector({r0:0,r:i.r,startAngle:0,endAngle:2*Math.PI,cx:i.cx,cy:i.cy},t,n),r=Sector;break;default:var o=e.getComputedTransform(),a=o?Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1],o[2]*o[2]+o[3]*o[3])):1,s=map$1(pathToPolygons(e.getUpdatedPathProxy(),a),(function(e){return polygonConvert(e)})),l=s.length;if(0===l)binaryDivideRecursive(binaryDividePolygon,{points:s[0]},t,n);else if(l===t)for(var c=0;c<l;c++)n.push({points:s[c]});else{var u=0,h=map$1(s,(function(e){var t=[],r=[];fromPoints(e,t,r);var n=(r[1]-t[1])*(r[0]-t[0]);return u+=n,{poly:e,area:n}}));h.sort((function(e,t){return t.area-e.area}));var d=t;for(c=0;c<l;c++){var p=h[c];if(d<=0)break;var f=c===l-1?d:Math.ceil(p.area/u*t);f<0||(binaryDivideRecursive(binaryDividePolygon,{points:p.poly},f,n),d-=f)}}r=Polygon$1}if(!r)return clone$2(e,t);var m=[];for(c=0;c<n.length;c++){var g=new r;g.setShape(n[c]),copyPathProps(e,g),m.push(g)}return m}function alignSubpath(e,t){var r=e.length,n=t.length;if(r===n)return[e,t];for(var i=[],o=[],a=r<n?e:t,s=Math.min(r,n),l=Math.abs(n-r)/6,c=(s-2)/6,u=Math.ceil(l/c)+1,h=[a[0],a[1]],d=l,p=2;p<s;){var f=a[p-2],m=a[p-1],g=a[p++],y=a[p++],_=a[p++],v=a[p++],b=a[p++],w=a[p++];if(d<=0)h.push(g,y,_,v,b,w);else{for(var x=Math.min(d,u-1)+1,S=1;S<=x;S++){var E=S/x;cubicSubdivide(f,g,_,b,E,i),cubicSubdivide(m,y,v,w,E,o),f=i[3],m=o[3],h.push(i[1],o[1],i[2],o[2],f,m),g=i[5],y=o[5],_=i[6],v=o[6]}d-=x-1}}return a===e?[h,t]:[e,h]}function createSubpath(e,t){for(var r=e.length,n=e[r-2],i=e[r-1],o=[],a=0;a<t.length;)o[a++]=n,o[a++]=i;return o}function alignBezierCurves(e,t){for(var r,n,i,o=[],a=[],s=0;s<Math.max(e.length,t.length);s++){var l=e[s],c=t[s],u=void 0,h=void 0;l?c?(n=u=(r=alignSubpath(l,c))[0],i=h=r[1]):(h=createSubpath(i||l,l),u=l):(u=createSubpath(n||c,c),h=c),o.push(u),a.push(h)}return[o,a]}function centroid(e){for(var t=0,r=0,n=0,i=e.length,o=0,a=i-2;o<i;a=o,o+=2){var s=e[a],l=e[a+1],c=e[o],u=e[o+1],h=s*u-c*l;t+=h,r+=(s+c)*h,n+=(l+u)*h}return 0===t?[e[0]||0,e[1]||0]:[r/t/3,n/t/3,t]}function findBestRingOffset(e,t,r,n){for(var i=(e.length-2)/6,o=1/0,a=0,s=e.length,l=s-2,c=0;c<i;c++){for(var u=6*c,h=0,d=0;d<s;d+=2){var p=0===d?u:(u+d-2)%l+2,f=e[p]-r[0],m=e[p+1]-r[1],g=t[d]-n[0]-f,y=t[d+1]-n[1]-m;h+=g*g+y*y}h<o&&(o=h,a=c)}return a}function reverse(e){for(var t=[],r=e.length,n=0;n<r;n+=2)t[n]=e[r-n-2],t[n+1]=e[r-n-1];return t}function findBestMorphingRotation(e,t,r,n){for(var i,o=[],a=0;a<e.length;a++){var s=e[a],l=t[a],c=centroid(s),u=centroid(l);null==i&&(i=c[2]<0!=u[2]<0);var h=[],d=[],p=0,f=1/0,m=[],g=s.length;i&&(s=reverse(s));for(var y=6*findBestRingOffset(s,l,c,u),_=g-2,v=0;v<_;v+=2){var b=(y+v)%_+2;h[v+2]=s[b]-c[0],h[v+3]=s[b+1]-c[1]}h[0]=s[y]-c[0],h[1]=s[y+1]-c[1];for(var w=n/r,x=-n/2;x<=n/2;x+=w){var S=Math.sin(x),E=Math.cos(x),T=0;for(v=0;v<s.length;v+=2){var A=h[v],C=h[v+1],I=l[v]-u[0],k=l[v+1]-u[1],P=I*E-k*S,M=I*S+k*E;m[v]=P,m[v+1]=M;var R=P-A,D=M-C;T+=R*R+D*D}if(T<f){f=T,p=x;for(var O=0;O<m.length;O++)d[O]=m[O]}}o.push({from:h,to:d,fromCp:c,toCp:u,rotation:-p})}return o}function isCombineMorphing(e){return e.__isCombineMorphing}var SAVED_METHOD_PREFIX="__mOriginal_";function saveAndModifyMethod(e,t,r){var n=SAVED_METHOD_PREFIX+t,i=e[n]||e[t];e[n]||(e[n]=e[t]);var o=r.replace,a=r.after,s=r.before;e[t]=function(){var e,t=arguments;return s&&s.apply(this,t),e=o?o.apply(this,t):i.apply(this,t),a&&a.apply(this,t),e}}function restoreMethod(e,t){var r=SAVED_METHOD_PREFIX+t;e[r]&&(e[t]=e[r],e[r]=null)}function applyTransformOnBeziers(e,t){for(var r=0;r<e.length;r++)for(var n=e[r],i=0;i<n.length;){var o=n[i],a=n[i+1];n[i++]=t[0]*o+t[2]*a+t[4],n[i++]=t[1]*o+t[3]*a+t[5]}}function prepareMorphPath(e,t){var r=e.getUpdatedPathProxy(),n=t.getUpdatedPathProxy(),i=alignBezierCurves(pathToBezierCurves(r),pathToBezierCurves(n)),o=i[0],a=i[1],s=e.getComputedTransform(),l=t.getComputedTransform();s&&applyTransformOnBeziers(o,s),l&&applyTransformOnBeziers(a,l),saveAndModifyMethod(t,"updateTransform",{replace:function(){this.transform=null}}),t.transform=null;var c=findBestMorphingRotation(o,a,10,Math.PI),u=[];saveAndModifyMethod(t,"buildPath",{replace:function(e){for(var r=t.__morphT,n=1-r,i=[],o=0;o<c.length;o++){var a=c[o],s=a.from,l=a.to,h=a.rotation*r,d=a.fromCp,p=a.toCp,f=Math.sin(h),m=Math.cos(h);lerp$1(i,d,p,r);for(var g=0;g<s.length;g+=2){var y=s[g],_=s[g+1],v=y*n+(S=l[g])*r,b=_*n+(E=l[g+1])*r;u[g]=v*m-b*f+i[0],u[g+1]=v*f+b*m+i[1]}var w=u[0],x=u[1];e.moveTo(w,x);for(g=2;g<s.length;){var S=u[g++],E=u[g++],T=u[g++],A=u[g++],C=u[g++],I=u[g++];w===S&&x===E&&T===C&&A===I?e.lineTo(C,I):e.bezierCurveTo(S,E,T,A,C,I),w=C,x=I}}}})}function morphPath(e,t,r){if(!e||!t)return t;var n=r.done,i=r.during;return prepareMorphPath(e,t),t.__morphT=0,t.animateTo({__morphT:1},defaults({during:function(e){t.dirtyShape(),i&&i(e)},done:function(){restoreMethod(t,"buildPath"),restoreMethod(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape(),n&&n()}},r)),t}function hilbert(e,t,r,n,i,o){e=i===r?0:Math.round(32767*(e-r)/(i-r)),t=o===n?0:Math.round(32767*(t-n)/(o-n));for(var a,s=0,l=32768;l>0;l/=2){var c=0,u=0;(e&l)>0&&(c=1),(t&l)>0&&(u=1),s+=l*l*(3*c^u),0===u&&(1===c&&(e=l-1-e,t=l-1-t),a=e,e=t,t=a)}return s}function sortPaths(e){var t=1/0,r=1/0,n=-1/0,i=-1/0,o=map$1(e,(function(e){var o=e.getBoundingRect(),a=e.getComputedTransform(),s=o.x+o.width/2+(a?a[4]:0),l=o.y+o.height/2+(a?a[5]:0);return t=Math.min(s,t),r=Math.min(l,r),n=Math.max(s,n),i=Math.max(l,i),[s,l]}));return map$1(o,(function(o,a){return{cp:o,z:hilbert(o[0],o[1],t,r,n,i),path:e[a]}})).sort((function(e,t){return e.z-t.z})).map((function(e){return e.path}))}function defaultDividePath(e){return split(e.path,e.count)}function createEmptyReturn(){return{fromIndividuals:[],toIndividuals:[],count:0}}function combineMorph(e,t,r){var n=[];!function e(t){for(var r=0;r<t.length;r++){var i=t[r];isCombineMorphing(i)?e(i.childrenRef()):i instanceof Path&&n.push(i)}}(e);var i=n.length;if(!i)return createEmptyReturn();var o=(r.dividePath||defaultDividePath)({path:t,count:i});if(o.length!==i)return createEmptyReturn();n=sortPaths(n),o=sortPaths(o);for(var a=r.done,s=r.during,l=r.individualDelay,c=new Transformable,u=0;u<i;u++){var h=n[u],d=o[u];d.parent=t,d.copyTransform(c),l||prepareMorphPath(h,d)}function p(e){for(var t=0;t<o.length;t++)o[t].addSelfToZr(e)}function f(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,restoreMethod(t,"addSelfToZr"),restoreMethod(t,"removeSelfFromZr")}t.__isCombineMorphing=!0,t.childrenRef=function(){return o},saveAndModifyMethod(t,"addSelfToZr",{after:function(e){p(e)}}),saveAndModifyMethod(t,"removeSelfFromZr",{after:function(e){for(var t=0;t<o.length;t++)o[t].removeSelfFromZr(e)}});var m=o.length;if(l){var g=m,y=function(){0===--g&&(f(),a&&a())};for(u=0;u<m;u++){var _=l?defaults({delay:(r.delay||0)+l(u,m,n[u],o[u]),done:y},r):r;morphPath(n[u],o[u],_)}}else t.__morphT=0,t.animateTo({__morphT:1},defaults({during:function(e){for(var r=0;r<m;r++){var n=o[r];n.__morphT=t.__morphT,n.dirtyShape()}s&&s(e)},done:function(){f();for(var t=0;t<e.length;t++)restoreMethod(e[t],"updateTransform");a&&a()}},r));return t.__zr&&p(t.__zr),{fromIndividuals:n,toIndividuals:o,count:m}}function separateMorph(e,t,r){var n=t.length,i=[],o=r.dividePath||defaultDividePath;if(isCombineMorphing(e)){!function e(t){for(var r=0;r<t.length;r++){var n=t[r];isCombineMorphing(n)?e(n.childrenRef()):n instanceof Path&&i.push(n)}}(e.childrenRef());var a=i.length;if(a<n)for(var s=0,l=a;l<n;l++)i.push(clonePath(i[s++%a]));i.length=n}else{i=o({path:e,count:n});var c=e.getComputedTransform();for(l=0;l<i.length;l++)i[l].setLocalTransform(c);if(i.length!==n)return createEmptyReturn()}i=sortPaths(i),t=sortPaths(t);var u=r.individualDelay;for(l=0;l<n;l++){var h=u?defaults({delay:(r.delay||0)+u(l,n,i[l],t[l])},r):r;morphPath(i[l],t[l],h)}return{fromIndividuals:i,toIndividuals:t,count:t.length}}function createDom(e,t,r){var n=platformApi.createCanvas(),i=t.getWidth(),o=t.getHeight(),a=n.style;return a&&(a.position="absolute",a.left="0",a.top="0",a.width=i+"px",a.height=o+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=o*r,n}var Layer=function(e){function t(t,r,n){var i,o=e.call(this)||this;o.motionBlur=!1,o.lastFrameAlpha=.7,o.dpr=1,o.virtual=!1,o.config={},o.incremental=!1,o.zlevel=0,o.maxRepaintRectCount=5,o.__dirty=!0,o.__firstTimePaint=!0,o.__used=!1,o.__drawIndex=0,o.__startIndex=0,o.__endIndex=0,o.__prevStartIndex=null,o.__prevEndIndex=null,n=n||devicePixelRatio$1,"string"==typeof t?i=createDom(t,r,n):isObject$1(t)&&(t=(i=t).id),o.id=t,o.dom=i;var a=i.style;return a&&(disableUserSelect(i),i.onselectstart=function(){return!1},a.padding="0",a.margin="0",a.borderWidth="0"),o.painter=r,o.dpr=n,o}return __extends(t,e),t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var e=this.dpr;this.domBack=createDom("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),1!==e&&this.ctxBack.scale(e,e)},t.prototype.createRepaintRects=function(e,t,r,n){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var i,o=[],a=this.maxRepaintRectCount,s=!1,l=new BoundingRect(0,0,0,0);function c(e){if(e.isFinite()&&!e.isZero())if(0===o.length){(t=new BoundingRect(0,0,0,0)).copy(e),o.push(t)}else{for(var t,r=!1,n=1/0,i=0,c=0;c<o.length;++c){var u=o[c];if(u.intersect(e)){var h=new BoundingRect(0,0,0,0);h.copy(u),h.union(e),o[c]=h,r=!0;break}if(s){l.copy(e),l.union(u);var d=e.width*e.height,p=u.width*u.height,f=l.width*l.height-d-p;f<n&&(n=f,i=c)}}if(s&&(o[i].union(e),r=!0),!r)(t=new BoundingRect(0,0,0,0)).copy(e),o.push(t);s||(s=o.length>=a)}}for(var u=this.__startIndex;u<this.__endIndex;++u){if(p=e[u]){var h=p.shouldBePainted(r,n,!0,!0);(f=p.__isRendered&&(p.__dirty&REDRAW_BIT||!h)?p.getPrevPaintRect():null)&&c(f);var d=h&&(p.__dirty&REDRAW_BIT||!p.__isRendered)?p.getPaintRect():null;d&&c(d)}}for(u=this.__prevStartIndex;u<this.__prevEndIndex;++u){var p,f;h=(p=t[u])&&p.shouldBePainted(r,n,!0,!0);if(p&&(!h||!p.__zr)&&p.__isRendered)(f=p.getPrevPaintRect())&&c(f)}do{i=!1;for(u=0;u<o.length;)if(o[u].isZero())o.splice(u,1);else{for(var m=u+1;m<o.length;)o[u].intersect(o[m])?(i=!0,o[u].union(o[m]),o.splice(m,1)):m++;u++}}while(i);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(e,t){var r=this.dpr,n=this.dom,i=n.style,o=this.domBack;i&&(i.width=e+"px",i.height=t+"px"),n.width=e*r,n.height=t*r,o&&(o.width=e*r,o.height=t*r,1!==r&&this.ctxBack.scale(r,r))},t.prototype.clear=function(e,t,r){var n=this.dom,i=this.ctx,o=n.width,a=n.height;t=t||this.clearColor;var s=this.motionBlur&&!e,l=this.lastFrameAlpha,c=this.dpr,u=this;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,o/c,a/c));var h=this.domBack;function d(e,r,n,o){if(i.clearRect(e,r,n,o),t&&"transparent"!==t){var a=void 0;if(isGradientObject(t))a=(t.global||t.__width===n&&t.__height===o)&&t.__canvasGradient||getCanvasGradient(i,t,{x:0,y:0,width:n,height:o}),t.__canvasGradient=a,t.__width=n,t.__height=o;else isImagePatternObject(t)&&(t.scaleX=t.scaleX||c,t.scaleY=t.scaleY||c,a=createCanvasPattern(i,t,{dirty:function(){u.setUnpainted(),u.painter.refresh()}}));i.save(),i.fillStyle=a||t,i.fillRect(e,r,n,o),i.restore()}s&&(i.save(),i.globalAlpha=l,i.drawImage(h,e,r,n,o),i.restore())}!r||s?d(0,0,o,a):r.length&&each(r,(function(e){d(e.x*c,e.y*c,e.width*c,e.height*c)}))},t}(Eventful),HOVER_LAYER_ZLEVEL=1e5,CANVAS_ZLEVEL=314159,EL_AFTER_INCREMENTAL_INC=.01,INCREMENTAL_INC=.001;function isLayerValid(e){return!!e&&(!!e.__builtin__||"function"==typeof e.resize&&"function"==typeof e.refresh)}function createRoot(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var CanvasPainter=function(){function e(e,t,r,n){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var i=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=r=extend$1({},r||{}),this.dpr=r.devicePixelRatio||devicePixelRatio$1,this._singleCanvas=i,this.root=e,e.style&&(disableUserSelect(e),e.innerHTML=""),this.storage=t;var o=this._zlevelList;this._prevDisplayList=[];var a=this._layers;if(i){var s=e,l=s.width,c=s.height;null!=r.width&&(l=r.width),null!=r.height&&(c=r.height),this.dpr=r.devicePixelRatio||1,s.width=l*this.dpr,s.height=c*this.dpr,this._width=l,this._height=c;var u=new Layer(s,this,this.dpr);u.__builtin__=!0,u.initContext(),a[CANVAS_ZLEVEL]=u,u.zlevel=CANVAS_ZLEVEL,o.push(CANVAS_ZLEVEL),this._domRoot=e}else{this._width=getSize(e,0,r),this._height=getSize(e,1,r);var h=this._domRoot=createRoot(this._width,this._height);e.appendChild(h)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},e.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),r=this._prevDisplayList,n=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,r,e,this._redrawId);for(var i=0;i<n.length;i++){var o=n[i],a=this._layers[o];if(!a.__builtin__&&a.refresh){var s=0===i?this._backgroundColor:null;a.refresh(s)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(e){var t=e.length,r=this._hoverlayer;if(r&&r.clear(),t){for(var n,i={inHover:!0,viewWidth:this._width,viewHeight:this._height},o=0;o<t;o++){var a=e[o];a.__inHover&&(r||(r=this._hoverlayer=this.getLayer(HOVER_LAYER_ZLEVEL)),n||(n=r.ctx).save(),brush(n,a,i,o===t-1))}n&&n.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(HOVER_LAYER_ZLEVEL)},e.prototype.paintOne=function(e,t){brushSingle(e,t)},e.prototype._paintList=function(e,t,r,n){if(this._redrawId===n){r=r||!1,this._updateLayerStatus(e);var i=this._doPaintList(e,t,r),o=i.finished,a=i.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),a&&this._paintHoverList(e),o)this.eachLayer((function(e){e.afterBrush&&e.afterBrush()}));else{var s=this;requestAnimationFrame$1((function(){s._paintList(e,t,r,n)}))}}},e.prototype._compositeManually=function(){var e=this.getLayer(CANVAS_ZLEVEL).ctx,t=this._domRoot.width,r=this._domRoot.height;e.clearRect(0,0,t,r),this.eachBuiltinLayer((function(n){n.virtual&&e.drawImage(n.dom,0,0,t,r)}))},e.prototype._doPaintList=function(e,t,r){for(var n=this,i=[],o=this._opts.useDirtyRect,a=0;a<this._zlevelList.length;a++){var s=this._zlevelList[a],l=this._layers[s];l.__builtin__&&l!==this._hoverlayer&&(l.__dirty||r)&&i.push(l)}for(var c=!0,u=!1,h=function(a){var s,l=i[a],h=l.ctx,p=o&&l.createRepaintRects(e,t,d._width,d._height),f=r?l.__startIndex:l.__drawIndex,m=!r&&l.incremental&&Date.now,g=m&&Date.now(),y=l.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(l.__startIndex===l.__endIndex)l.clear(!1,y,p);else if(f===l.__startIndex){var _=e[f];_.incremental&&_.notClear&&!r||l.clear(!1,y,p)}-1===f&&(f=l.__startIndex);var v=function(t){var r={inHover:!1,allClipped:!1,prevEl:null,viewWidth:n._width,viewHeight:n._height};for(s=f;s<l.__endIndex;s++){var i=e[s];if(i.__inHover&&(u=!0),n._doPaintEl(i,l,o,t,r,s===l.__endIndex-1),m)if(Date.now()-g>15)break}r.prevElClipPaths&&h.restore()};if(p)if(0===p.length)s=l.__endIndex;else for(var b=d.dpr,w=0;w<p.length;++w){var x=p[w];h.save(),h.beginPath(),h.rect(x.x*b,x.y*b,x.width*b,x.height*b),h.clip(),v(x),h.restore()}else h.save(),v(),h.restore();l.__drawIndex=s,l.__drawIndex<l.__endIndex&&(c=!1)},d=this,p=0;p<i.length;p++)h(p);return env.wxa&&each(this._layers,(function(e){e&&e.ctx&&e.ctx.draw&&e.ctx.draw()})),{finished:c,needsRefreshHover:u}},e.prototype._doPaintEl=function(e,t,r,n,i,o){var a=t.ctx;if(r){var s=e.getPaintRect();(!n||s&&s.intersect(n))&&(brush(a,e,i,o),e.setPrevPaintRect(s))}else brush(a,e,i,o)},e.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=CANVAS_ZLEVEL);var r=this._layers[e];return r||((r=new Layer("zr_"+e,this,this.dpr)).zlevel=e,r.__builtin__=!0,this._layerConfig[e]?merge$1(r,this._layerConfig[e],!0):this._layerConfig[e-EL_AFTER_INCREMENTAL_INC]&&merge$1(r,this._layerConfig[e-EL_AFTER_INCREMENTAL_INC],!0),t&&(r.virtual=t),this.insertLayer(e,r),r.initContext()),r},e.prototype.insertLayer=function(e,t){var r=this._layers,n=this._zlevelList,i=n.length,o=this._domRoot,a=null,s=-1;if(!r[e]&&isLayerValid(t)){if(i>0&&e>n[0]){for(s=0;s<i-1&&!(n[s]<e&&n[s+1]>e);s++);a=r[n[s]]}if(n.splice(s+1,0,e),r[e]=t,!t.virtual)if(a){var l=a.dom;l.nextSibling?o.insertBefore(t.dom,l.nextSibling):o.appendChild(t.dom)}else o.firstChild?o.insertBefore(t.dom,o.firstChild):o.appendChild(t.dom);t.painter||(t.painter=this)}},e.prototype.eachLayer=function(e,t){for(var r=this._zlevelList,n=0;n<r.length;n++){var i=r[n];e.call(t,this._layers[i],i)}},e.prototype.eachBuiltinLayer=function(e,t){for(var r=this._zlevelList,n=0;n<r.length;n++){var i=r[n],o=this._layers[i];o.__builtin__&&e.call(t,o,i)}},e.prototype.eachOtherLayer=function(e,t){for(var r=this._zlevelList,n=0;n<r.length;n++){var i=r[n],o=this._layers[i];o.__builtin__||e.call(t,o,i)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(e){function t(e){o&&(o.__endIndex!==e&&(o.__dirty=!0),o.__endIndex=e)}if(this.eachBuiltinLayer((function(e,t){e.__dirty=e.__used=!1})),this._singleCanvas)for(var r=1;r<e.length;r++){if((s=e[r]).zlevel!==e[r-1].zlevel||s.incremental){this._needsManuallyCompositing=!0;break}}var n,i,o=null,a=0;for(i=0;i<e.length;i++){var s,l=(s=e[i]).zlevel,c=void 0;n!==l&&(n=l,a=0),s.incremental?((c=this.getLayer(l+INCREMENTAL_INC,this._needsManuallyCompositing)).incremental=!0,a=1):c=this.getLayer(l+(a>0?EL_AFTER_INCREMENTAL_INC:0),this._needsManuallyCompositing),c.__builtin__||logError("ZLevel "+l+" has been used by unkown layer "+c.id),c!==o&&(c.__used=!0,c.__startIndex!==i&&(c.__dirty=!0),c.__startIndex=i,c.incremental?c.__drawIndex=-1:c.__drawIndex=i,t(i),o=c),s.__dirty&REDRAW_BIT&&!s.__inHover&&(c.__dirty=!0,c.incremental&&c.__drawIndex<0&&(c.__drawIndex=i))}t(i),this.eachBuiltinLayer((function(e,t){!e.__used&&e.getElementCount()>0&&(e.__dirty=!0,e.__startIndex=e.__endIndex=e.__drawIndex=0),e.__dirty&&e.__drawIndex<0&&(e.__drawIndex=e.__startIndex)}))},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(e){e.clear()},e.prototype.setBackgroundColor=function(e){this._backgroundColor=e,each(this._layers,(function(e){e.setUnpainted()}))},e.prototype.configLayer=function(e,t){if(t){var r=this._layerConfig;r[e]?merge$1(r[e],t,!0):r[e]=t;for(var n=0;n<this._zlevelList.length;n++){var i=this._zlevelList[n];if(i===e||i===e+EL_AFTER_INCREMENTAL_INC)merge$1(this._layers[i],r[e],!0)}}},e.prototype.delLayer=function(e){var t=this._layers,r=this._zlevelList,n=t[e];n&&(n.dom.parentNode.removeChild(n.dom),delete t[e],r.splice(indexOf(r,e),1))},e.prototype.resize=function(e,t){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var n=this._opts,i=this.root;if(null!=e&&(n.width=e),null!=t&&(n.height=t),e=getSize(i,0,n),t=getSize(i,1,n),r.style.display="",this._width!==e||t!==this._height){for(var o in r.style.width=e+"px",r.style.height=t+"px",this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(null==e||null==t)return;this._width=e,this._height=t,this.getLayer(CANVAS_ZLEVEL).resize(e,t)}return this},e.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[CANVAS_ZLEVEL].dom;var t=new Layer("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var r=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var n=t.dom.width,i=t.dom.height;this.eachLayer((function(e){e.__builtin__?r.drawImage(e.dom,0,0,n,i):e.renderToCanvas&&(r.save(),e.renderToCanvas(r),r.restore())}))}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},a=this.storage.getDisplayList(!0),s=0,l=a.length;s<l;s++){var c=a[s];brush(r,c,o,s===l-1)}return t.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();const QSpace=createComponent({name:"QSpace",setup(){const e=h$2("div",{class:"q-space"});return()=>e}}),QItemLabel=createComponent({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:t}){const r=computed((()=>parseInt(e.lines,10))),n=computed((()=>"q-item__label"+(!0===e.overline?" q-item__label--overline text-overline":"")+(!0===e.caption?" q-item__label--caption text-caption":"")+(!0===e.header?" q-item__label--header":"")+(1===r.value?" ellipsis":""))),i=computed((()=>void 0!==e.lines&&r.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":r.value}:null));return()=>h$2("div",{style:i.value,class:n.value},hSlot(t.default))}}),QBtnGroup=createComponent({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const r=computed((()=>{const t=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter((t=>!0===e[t])).map((e=>`q-btn-group--${e}`)).join(" ");return"q-btn-group row no-wrap"+(0!==t.length?" "+t:"")+(!0===e.spread?" q-btn-group--spread":" inline")}));return()=>h$2("div",{class:r.value},hSlot(t.default))}}),btnPropsList=Object.keys(nonRoundBtnProps);function passBtnProps(e){return btnPropsList.reduce(((t,r)=>{const n=e[r];return void 0!==n&&(t[r]=n),t}),{})}const QBtnDropdown=createComponent({name:"QBtnDropdown",props:{...nonRoundBtnProps,...useTransitionProps,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,noRefocus:Boolean,noFocus:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:r}){const{proxy:n}=getCurrentInstance(),i=ref$1(e.modelValue),o=ref$1(null),a=useId(),s=computed((()=>{const t={"aria-expanded":!0===i.value?"true":"false","aria-haspopup":"true","aria-controls":a.value,"aria-label":e.toggleAriaLabel||n.$q.lang.label[!0===i.value?"collapse":"expand"](e.label)};return(!0===e.disable||!1===e.split&&!0===e.disableMainBtn||!0===e.disableDropdown)&&(t["aria-disabled"]="true"),t})),l=computed((()=>"q-btn-dropdown__arrow"+(!0===i.value&&!1===e.noIconAnimation?" rotate-180":"")+(!1===e.split?" q-btn-dropdown__arrow-container":""))),c=computed((()=>getBtnDesignAttr(e))),u=computed((()=>passBtnProps(e)));function h(e){i.value=!0,r("beforeShow",e)}function d(e){r("show",e),r("update:modelValue",!0)}function p(e){i.value=!1,r("beforeHide",e)}function f(e){r("hide",e),r("update:modelValue",!1)}function m(e){r("click",e)}function g(e){stop$1(e),_(),r("click",e)}function y(e){o.value?.show(e)}function _(e){o.value?.hide(e)}return watch$2((()=>e.modelValue),(e=>{o.value?.[e?"show":"hide"]()})),watch$2((()=>e.split),_),Object.assign(n,{show:y,hide:_,toggle:function(e){o.value?.toggle(e)}}),onMounted((()=>{!0===e.modelValue&&y()})),()=>{const r=[h$2(QIcon,{class:l.value,name:e.dropdownIcon||n.$q.iconSet.arrow.dropdown})];return!0!==e.disableDropdown&&r.push(h$2(QMenu,{ref:o,id:a.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noEscDismiss:e.noEscDismiss,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,noFocus:e.noFocus,noRefocus:e.noRefocus,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:h,onShow:d,onBeforeHide:p,onHide:f},t.default)),!1===e.split?h$2(QBtn,{class:"q-btn-dropdown q-btn-dropdown--simple",...u.value,...s.value,disable:!0===e.disable||!0===e.disableMainBtn,noWrap:!0,round:!1,onClick:m},{default:()=>hSlot(t.label,[]).concat(r),loading:t.loading}):h$2(QBtnGroup,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...c.value,glossy:e.glossy,stretch:e.stretch},(()=>[h$2(QBtn,{class:"q-btn-dropdown--current",...u.value,disable:!0===e.disable||!0===e.disableMainBtn,noWrap:!0,round:!1,onClick:g},{default:t.label,loading:t.loading}),h$2(QBtn,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...s.value,...c.value,disable:!0===e.disable||!0===e.disableDropdown,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},(()=>r))]))}}}),QTd=createComponent({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const r=getCurrentInstance(),n=computed((()=>"q-td"+(!0===e.autoWidth?" q-table--col-auto-width":"")+(!0===e.noHover?" q-td--no-hover":"")+" "));return()=>{if(void 0===e.props)return h$2("td",{class:n.value},hSlot(t.default));const i=r.vnode.key,o=(void 0!==e.props.colsMap?e.props.colsMap[i]:null)||e.props.col;if(void 0===o)return;const{row:a}=e.props;return h$2("td",{class:n.value+o.__tdClass(a),style:o.__tdStyle(a)},hSlot(t.default))}}}),QTooltip=createComponent({name:"QTooltip",inheritAttrs:!1,props:{...useAnchorStaticProps,...useModelToggleProps,...useTransitionProps,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...useTransitionProps.transitionShow,default:"jump-down"},transitionHide:{...useTransitionProps.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:validatePosition},self:{type:String,default:"top middle",validator:validatePosition},offset:{type:Array,default:()=>[14,14],validator:validateOffset},scrollTarget:scrollTargetProp,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...useModelToggleEmits],setup(e,{slots:t,emit:r,attrs:n}){let i,o;const a=getCurrentInstance(),{proxy:{$q:s}}=a,l=ref$1(null),c=ref$1(!1),u=computed((()=>parsePosition(e.anchor,s.lang.rtl))),h=computed((()=>parsePosition(e.self,s.lang.rtl))),d=computed((()=>!0!==e.persistent)),{registerTick:p,removeTick:f}=useTick(),{registerTimeout:m}=useTimeout(),{transitionProps:g,transitionStyle:y}=useTransition(e),{localScrollTarget:_,changeScrollEvent:v,unconfigureScrollTarget:b}=useScrollTarget(e,M),{anchorEl:w,canShow:x,anchorEvents:S}=useAnchor({showing:c,configureAnchorEl:function(){if(!0===e.noParentEvent||null===w.value)return;const t=!0===s.platform.is.mobile?[[w.value,"touchstart","delayShow","passive"]]:[[w.value,"mouseenter","delayShow","passive"],[w.value,"mouseleave","delayHide","passive"]];addEvt(S,"anchor",t)}}),{show:E,hide:T}=useModelToggle({showing:c,canShow:x,handleShow:function(t){A(),p((()=>{o=new MutationObserver((()=>P())),o.observe(l.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),P(),M()})),void 0===i&&(i=watch$2((()=>s.screen.width+"|"+s.screen.height+"|"+e.self+"|"+e.anchor+"|"+s.lang.rtl),P));m((()=>{A(!0),r("show",t)}),e.transitionDuration)},handleHide:function(t){f(),C(),k(),m((()=>{C(!0),r("hide",t)}),e.transitionDuration)},hideOnRouteChange:d,processOnMount:!0});Object.assign(S,{delayShow:function(t){if(!0===s.platform.is.mobile){clearSelection(),document.body.classList.add("non-selectable");const e=w.value,t=["touchmove","touchcancel","touchend","click"].map((t=>[e,t,"delayHide","passiveCapture"]));addEvt(S,"tooltipTemp",t)}m((()=>{E(t)}),e.delay)},delayHide:function(t){!0===s.platform.is.mobile&&(cleanEvt(S,"tooltipTemp"),clearSelection(),setTimeout((()=>{document.body.classList.remove("non-selectable")}),10));m((()=>{T(t)}),e.hideDelay)}});const{showPortal:A,hidePortal:C,renderPortal:I}=usePortal(a,l,(function(){return h$2(Transition,g.value,R)}),"tooltip");if(!0===s.platform.is.mobile){const t={anchorEl:w,innerRef:l,onClickOutside:e=>(T(e),e.target.classList.contains("q-dialog__backdrop")&&stopAndPrevent$1(e),!0)},r=computed((()=>null===e.modelValue&&!0!==e.persistent&&!0===c.value));watch$2(r,(e=>{(!0===e?addClickOutside:removeClickOutside)(t)})),onBeforeUnmount((()=>{removeClickOutside(t)}))}function k(){void 0!==o&&(o.disconnect(),o=void 0),void 0!==i&&(i(),i=void 0),b(),cleanEvt(S,"tooltipTemp")}function P(){setPosition({targetEl:l.value,offset:e.offset,anchorEl:w.value,anchorOrigin:u.value,selfOrigin:h.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function M(){if(null!==w.value||void 0!==e.scrollTarget){_.value=getScrollTarget(w.value,e.scrollTarget);const t=!0===e.noParentEvent?P:T;v(_.value,t)}}function R(){return!0===c.value?h$2("div",{...n,ref:l,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,y.value],role:"tooltip"},hSlot(t.default)):null}return onBeforeUnmount(k),Object.assign(a.proxy,{updatePosition:P}),I}});function getBool(e,t){return[!0,!1].includes(e)?e:t}const QPagination=createComponent({name:"QPagination",props:{...useDarkProps,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>("string"==typeof e?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>""===e||btnDesignOptions.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:t}){const{proxy:r}=getCurrentInstance(),{$q:n}=r,i=useDark(e,n),o=computed((()=>parseInt(e.min,10))),a=computed((()=>parseInt(e.max,10))),s=computed((()=>parseInt(e.maxPages,10))),l=computed((()=>f.value+" / "+a.value)),c=computed((()=>getBool(e.boundaryLinks,e.input))),u=computed((()=>getBool(e.boundaryNumbers,!e.input))),h=computed((()=>getBool(e.directionLinks,e.input))),d=computed((()=>getBool(e.ellipses,!e.input))),p=ref$1(null),f=computed({get:()=>e.modelValue,set:r=>{if(r=parseInt(r,10),e.disable||isNaN(r))return;const n=between$1(r,o.value,a.value);e.modelValue!==n&&t("update:modelValue",n)}});watch$2((()=>`${o.value}|${a.value}`),(()=>{f.value=e.modelValue}));const m=computed((()=>"q-pagination row no-wrap items-center"+(!0===e.disable?" disabled":""))),g=computed((()=>e.gutter in btnPadding?`${btnPadding[e.gutter]}px`:e.gutter||null)),y=computed((()=>null!==g.value?`--q-pagination-gutter-parent:-${g.value};--q-pagination-gutter-child:${g.value}`:null)),_=computed((()=>{const t=[e.iconFirst||n.iconSet.pagination.first,e.iconPrev||n.iconSet.pagination.prev,e.iconNext||n.iconSet.pagination.next,e.iconLast||n.iconSet.pagination.last];return!0===n.lang.rtl?t.reverse():t})),v=computed((()=>({"aria-disabled":!0===e.disable?"true":"false",role:"navigation"}))),b=computed((()=>getBtnDesign(e,"flat"))),w=computed((()=>({[b.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:null===e.ripple||e.ripple}))),x=computed((()=>{const t={[b.value]:!1};return""!==e.activeDesign&&(t[e.activeDesign]=!0),t})),S=computed((()=>({...x.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor}))),E=computed((()=>{let t=Math.max(s.value,1+(d.value?2:0)+(u.value?2:0));const r={pgFrom:o.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return s.value&&t<a.value-o.value+1&&(t=1+2*Math.floor(t/2),r.pgFrom=Math.max(o.value,Math.min(a.value-t+1,e.modelValue-Math.floor(t/2))),r.pgTo=Math.min(a.value,r.pgFrom+t-1),u.value&&(r.boundaryStart=!0,r.pgFrom++),d.value&&r.pgFrom>o.value+(u.value?1:0)&&(r.ellipsesStart=!0,r.pgFrom++),u.value&&(r.boundaryEnd=!0,r.pgTo--),d.value&&r.pgTo<a.value-(u.value?1:0)&&(r.ellipsesEnd=!0,r.pgTo--)),r}));function T(e){f.value=e}function A(){f.value=p.value,p.value=null,!0===n.platform.is.mobile&&document.activeElement.blur()}function C(e){p.value=e}function I(e){!0===isKeyCode(e,13)&&A()}function k(t,r,n){const i={"aria-label":r,"aria-current":"false",...w.value,...t};return!0===n&&Object.assign(i,{"aria-current":"true",...S.value}),void 0!==r&&(void 0!==e.toFn?i.to=e.toFn(r):i.onClick=()=>{T(r)}),h$2(QBtn,i)}return Object.assign(r,{set:T,setByOffset:function(e){f.value=f.value+e}}),()=>{const t=[],r=[];let s;if(!0===c.value&&(t.push(k({key:"bls",disable:e.disable||e.modelValue<=o.value,icon:_.value[0],"aria-label":n.lang.pagination.first},o.value)),r.unshift(k({key:"ble",disable:e.disable||e.modelValue>=a.value,icon:_.value[3],"aria-label":n.lang.pagination.last},a.value))),!0===h.value&&(t.push(k({key:"bdp",disable:e.disable||e.modelValue<=o.value,icon:_.value[1],"aria-label":n.lang.pagination.prev},e.modelValue-1)),r.unshift(k({key:"bdn",disable:e.disable||e.modelValue>=a.value,icon:_.value[2],"aria-label":n.lang.pagination.next},e.modelValue+1))),!0!==e.input){s=[];const{pgFrom:n,pgTo:i,marginalStyle:l}=E.value;if(!0===E.value.boundaryStart){const r=o.value===e.modelValue;t.push(k({key:"bns",style:l,disable:e.disable,label:o.value},o.value,r))}if(!0===E.value.boundaryEnd){const t=a.value===e.modelValue;r.unshift(k({key:"bne",style:l,disable:e.disable,label:a.value},a.value,t))}!0===E.value.ellipsesStart&&t.push(k({key:"bes",style:l,disable:e.disable,label:"",ripple:!1},n-1)),!0===E.value.ellipsesEnd&&r.unshift(k({key:"bee",style:l,disable:e.disable,label:"",ripple:!1},i+1));for(let t=n;t<=i;t++)s.push(k({key:`bpg${t}`,style:l,disable:e.disable,label:t},t,t===e.modelValue))}return h$2("div",{class:m.value,...v.value},[h$2("div",{class:"q-pagination__content row no-wrap items-center",style:y.value},[...t,!0===e.input?h$2(QInput,{class:"inline",style:{width:l.value.length/1.5+"em"},type:"number",dense:!0,value:p.value,disable:e.disable,dark:i.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:l.value,min:o.value,max:a.value,"onUpdate:modelValue":C,onKeyup:I,onBlur:A}):h$2("div",{class:"q-pagination__middle row justify-center"},s),...r])])}}}),QTh=createComponent({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:t,emit:r}){const n=getCurrentInstance(),{proxy:{$q:i}}=n,o=e=>{r("click",e)};return()=>{if(void 0===e.props)return h$2("th",{class:!0===e.autoWidth?"q-table--col-auto-width":"",onClick:o},hSlot(t.default));let r,a;const s=n.vnode.key;if(s){if(r=e.props.colsMap[s],void 0===r)return}else r=e.props.col;if(!0===r.sortable){const e="right"===r.align?"unshift":"push";a=hUniqueSlot(t.default,[]),a[e](h$2(QIcon,{class:r.__iconClass,name:i.iconSet.table.arrowUp}))}else a=hSlot(t.default);const l={class:r.__thClass+(!0===e.autoWidth?" q-table--col-auto-width":""),style:r.headerStyle,onClick:t=>{!0===r.sortable&&e.props.sort(r),o(t)}};return h$2("th",l,a)}}}),separatorValues=["horizontal","vertical","cell","none"],QMarkupTable=createComponent({name:"QMarkupTable",props:{...useDarkProps,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>separatorValues.includes(e)}},setup(e,{slots:t}){const r=getCurrentInstance(),n=useDark(e,r.proxy.$q),i=computed((()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(!0===n.value?" q-table--dark q-table__card--dark q-dark":"")+(!0===e.dense?" q-table--dense":"")+(!0===e.flat?" q-table--flat":"")+(!0===e.bordered?" q-table--bordered":"")+(!0===e.square?" q-table--square":"")+(!1===e.wrapCells?" q-table--no-wrap":"")));return()=>h$2("div",{class:i.value},[h$2("table",{class:"q-table"},hSlot(t.default))])}});function getTableMiddle(e,t){return h$2("div",e,[h$2("table",{class:"q-table"},t)])}let rtlHasScrollBug=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,rtlHasScrollBug=e.scrollLeft>=0,e.remove()}const aggBucketSize=1e3,scrollToEdges=["start","center","end","start-force","center-force","end-force"],filterProto=Array.prototype.filter,setOverflowAnchor=void 0===window.getComputedStyle(document.body).overflowAnchor?noop$2:function(e,t){null!==e&&(void 0!==e._qOverflowAnimationFrame&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame((()=>{if(null===e)return;e._qOverflowAnimationFrame=void 0;const r=e.children||[];filterProto.call(r,(e=>e.dataset&&void 0!==e.dataset.qVsAnchor)).forEach((e=>{delete e.dataset.qVsAnchor}));const n=r[t];n?.dataset&&(n.dataset.qVsAnchor="")})))};function sumFn(e,t){return e+t}function getScrollDetails(e,t,r,n,i,o,a,s){const l=e===window?document.scrollingElement||document.documentElement:e,c=!0===i?"offsetWidth":"offsetHeight",u={scrollStart:0,scrollViewSize:-a-s,scrollMaxSize:0,offsetStart:-a,offsetEnd:-s};if(!0===i?(e===window?(u.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,u.scrollViewSize+=document.documentElement.clientWidth):(u.scrollStart=l.scrollLeft,u.scrollViewSize+=l.clientWidth),u.scrollMaxSize=l.scrollWidth,!0===o&&(u.scrollStart=(!0===rtlHasScrollBug?u.scrollMaxSize-u.scrollViewSize:0)-u.scrollStart)):(e===window?(u.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,u.scrollViewSize+=document.documentElement.clientHeight):(u.scrollStart=l.scrollTop,u.scrollViewSize+=l.clientHeight),u.scrollMaxSize=l.scrollHeight),null!==r)for(let h=r.previousElementSibling;null!==h;h=h.previousElementSibling)!1===h.classList.contains("q-virtual-scroll--skip")&&(u.offsetStart+=h[c]);if(null!==n)for(let h=n.nextElementSibling;null!==h;h=h.nextElementSibling)!1===h.classList.contains("q-virtual-scroll--skip")&&(u.offsetEnd+=h[c]);if(t!==e){const r=l.getBoundingClientRect(),n=t.getBoundingClientRect();!0===i?(u.offsetStart+=n.left-r.left,u.offsetEnd-=n.width):(u.offsetStart+=n.top-r.top,u.offsetEnd-=n.height),e!==window&&(u.offsetStart+=u.scrollStart),u.offsetEnd+=u.scrollMaxSize-u.offsetStart}return u}function setScroll(e,t,r,n){"end"===t&&(t=(e===window?document.body:e)[!0===r?"scrollWidth":"scrollHeight"]),e===window?!0===r?(!0===n&&(t=(!0===rtlHasScrollBug?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):!0===r?(!0===n&&(t=(!0===rtlHasScrollBug?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function sumSize(e,t,r,n){if(r>=n)return 0;const i=t.length,o=Math.floor(r/aggBucketSize),a=Math.floor((n-1)/aggBucketSize)+1;let s=e.slice(o,a).reduce(sumFn,0);return r%aggBucketSize!=0&&(s-=t.slice(o*aggBucketSize,r).reduce(sumFn,0)),n%aggBucketSize!=0&&n!==i&&(s-=t.slice(n,a*aggBucketSize).reduce(sumFn,0)),s}const commonVirtScrollProps={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},commonVirtScrollPropsList=Object.keys(commonVirtScrollProps),useVirtualScrollProps={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...commonVirtScrollProps};function useVirtualScroll({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:r,virtualScrollItemSizeComputed:n}){const i=getCurrentInstance(),{props:o,emit:a,proxy:s}=i,{$q:l}=s;let c,u,h,d,p=[];const f=ref$1(0),m=ref$1(0),g=ref$1({}),y=ref$1(null),_=ref$1(null),v=ref$1(null),b=ref$1({from:0,to:0}),w=computed((()=>void 0!==o.tableColspan?o.tableColspan:100));void 0===n&&(n=computed((()=>o.virtualScrollItemSize)));const x=computed((()=>n.value+";"+o.virtualScrollHorizontal)),S=computed((()=>x.value+";"+o.virtualScrollSliceRatioBefore+";"+o.virtualScrollSliceRatioAfter));function E(){P(u,!0)}function T(e){P(void 0===e?u:e)}function A(n,i){const a=t();if(null==a||8===a.nodeType)return;const s=getScrollDetails(a,r(),y.value,_.value,o.virtualScrollHorizontal,l.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd);h!==s.scrollViewSize&&M(s.scrollViewSize),C(a,s,Math.min(e.value-1,Math.max(0,parseInt(n,10)||0)),0,-1!==scrollToEdges.indexOf(i)?i:-1!==u&&n>u?"end":"start")}function C(t,r,n,i,a){const s="string"==typeof a&&-1!==a.indexOf("-force"),u=!0===s?a.replace("-force",""):a,h=void 0!==u?u:"start";let y=Math.max(0,n-g.value[h]),_=y+g.value.total;_>e.value&&(_=e.value,y=Math.max(0,_-g.value.total)),c=r.scrollStart;const w=y!==b.value.from||_!==b.value.to;if(!1===w&&void 0===u)return void R(n);const{activeElement:x}=document,S=v.value;!0===w&&null!==S&&S!==x&&!0===S.contains(x)&&(S.addEventListener("focusout",k),setTimeout((()=>{S?.removeEventListener("focusout",k)}))),setOverflowAnchor(S,n-y);const E=void 0!==u?d.slice(y,n).reduce(sumFn,0):0;if(!0===w){const t=_>=b.value.from&&y<=b.value.to?b.value.to:_;b.value={from:y,to:t},f.value=sumSize(p,d,0,y),m.value=sumSize(p,d,_,e.value),requestAnimationFrame((()=>{b.value.to!==_&&c===r.scrollStart&&(b.value={from:b.value.from,to:_},m.value=sumSize(p,d,_,e.value))}))}requestAnimationFrame((()=>{if(c!==r.scrollStart)return;!0===w&&I(y);const e=d.slice(y,n).reduce(sumFn,0),a=e+r.offsetStart+f.value,h=a+d[n];let p=a+i;if(void 0!==u){const t=e-E,i=r.scrollStart+t;p=!0!==s&&i<a&&h<i+r.scrollViewSize?i:"end"===u?h-r.scrollViewSize:a-("start"===u?0:Math.round((r.scrollViewSize-d[n])/2))}c=p,setScroll(t,p,o.virtualScrollHorizontal,l.lang.rtl),R(n)}))}function I(e){const t=v.value;if(t){const r=filterProto.call(t.children,(e=>e.classList&&!1===e.classList.contains("q-virtual-scroll--skip"))),n=r.length,i=!0===o.virtualScrollHorizontal?e=>e.getBoundingClientRect().width:e=>e.offsetHeight;let a,s,l=e;for(let e=0;e<n;){for(a=i(r[e]),e++;e<n&&!0===r[e].classList.contains("q-virtual-scroll--with-prev");)a+=i(r[e]),e++;s=a-d[l],0!==s&&(d[l]+=s,p[Math.floor(l/aggBucketSize)]+=s),l++}}}function k(){v.value?.focus()}function P(t,r){const i=1*n.value;!0!==r&&!1!==Array.isArray(d)||(d=[]);const o=d.length;d.length=e.value;for(let n=e.value-1;n>=o;n--)d[n]=i;const a=Math.floor((e.value-1)/aggBucketSize);p=[];for(let n=0;n<=a;n++){let t=0;const r=Math.min((n+1)*aggBucketSize,e.value);for(let e=n*aggBucketSize;e<r;e++)t+=d[e];p.push(t)}u=-1,c=void 0,f.value=sumSize(p,d,0,b.value.from),m.value=sumSize(p,d,b.value.to,e.value),t>=0?(I(b.value.from),nextTick((()=>{A(t)}))):D()}function M(e){if(void 0===e&&"undefined"!=typeof window){const n=t();null!=n&&8!==n.nodeType&&(e=getScrollDetails(n,r(),y.value,_.value,o.virtualScrollHorizontal,l.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd).scrollViewSize)}h=e;const i=parseFloat(o.virtualScrollSliceRatioBefore)||0,a=1+i+(parseFloat(o.virtualScrollSliceRatioAfter)||0),s=void 0===e||e<=0?1:Math.ceil(e/n.value),c=Math.max(1,s,Math.ceil((o.virtualScrollSliceSize>0?o.virtualScrollSliceSize:10)/a));g.value={total:Math.ceil(c*a),start:Math.ceil(c*i),center:Math.ceil(c*(.5+i)),end:Math.ceil(c*(1+i)),view:s}}function R(e){u!==e&&(void 0!==o.onVirtualScroll&&a("virtualScroll",{index:e,from:b.value.from,to:b.value.to-1,direction:e<u?"decrease":"increase",ref:s}),u=e)}watch$2(S,(()=>{M()})),watch$2(x,E),M();const D=debounce$1((function(){const n=t();if(null==n||8===n.nodeType)return;const i=getScrollDetails(n,r(),y.value,_.value,o.virtualScrollHorizontal,l.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd),a=e.value-1,s=i.scrollMaxSize-i.offsetStart-i.offsetEnd-m.value;if(c===i.scrollStart)return;if(i.scrollMaxSize<=0)return void C(n,i,0,0);h!==i.scrollViewSize&&M(i.scrollViewSize),I(b.value.from);const u=Math.floor(i.scrollMaxSize-Math.max(i.scrollViewSize,i.offsetEnd)-Math.min(d[a],i.scrollViewSize/2));if(u>0&&Math.ceil(i.scrollStart)>=u)return void C(n,i,a,i.scrollMaxSize-i.offsetEnd-p.reduce(sumFn,0));let g=0,v=i.scrollStart-i.offsetStart,w=v;if(v<=s&&v+i.scrollViewSize>=f.value)v-=f.value,g=b.value.from,w=v;else for(let e=0;v>=p[e]&&g<a;e++)v-=p[e],g+=aggBucketSize;for(;v>0&&g<a;)v-=d[g],v>-i.scrollViewSize?(g++,w=v):w=d[g]+v;C(n,i,g,w)}),!0===l.platform.is.ios?120:35);onBeforeMount((()=>{M()}));let O=!1;return onDeactivated((()=>{O=!0})),onActivated((()=>{if(!0!==O)return;const e=t();void 0!==c&&null!=e&&8!==e.nodeType?setScroll(e,c,o.virtualScrollHorizontal,l.lang.rtl):A(u)})),onBeforeUnmount((()=>{D.cancel()})),Object.assign(s,{scrollTo:A,reset:E,refresh:T}),{virtualScrollSliceRange:b,virtualScrollSliceSizeComputed:g,setVirtualScrollSize:M,onVirtualScrollEvt:D,localResetVirtualScroll:P,padVirtualScroll:function(e,t){const r=!0===o.virtualScrollHorizontal?"width":"height",i={["--q-virtual-scroll-item-"+r]:n.value+"px"};return["tbody"===e?h$2(e,{class:"q-virtual-scroll__padding",key:"before",ref:y},[h$2("tr",[h$2("td",{style:{[r]:`${f.value}px`,...i},colspan:w.value})])]):h$2(e,{class:"q-virtual-scroll__padding",key:"before",ref:y,style:{[r]:`${f.value}px`,...i}}),h$2(e,{class:"q-virtual-scroll__content",key:"content",ref:v,tabindex:-1},t.flat()),"tbody"===e?h$2(e,{class:"q-virtual-scroll__padding",key:"after",ref:_},[h$2("tr",[h$2("td",{style:{[r]:`${m.value}px`,...i},colspan:w.value})])]):h$2(e,{class:"q-virtual-scroll__padding",key:"after",ref:_,style:{[r]:`${m.value}px`,...i}})]},scrollTo:A,reset:E,refresh:T}}const comps={list:QList,table:QMarkupTable},typeOptions=["list","table","__qtable"],QVirtualScroll=createComponent({name:"QVirtualScroll",props:{...useVirtualScrollProps,type:{type:String,default:"list",validator:e=>typeOptions.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:scrollTargetProp},setup(e,{slots:t,attrs:r}){let n;const i=ref$1(null),o=computed((()=>e.itemsSize>=0&&void 0!==e.itemsFn?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0)),{virtualScrollSliceRange:a,localResetVirtualScroll:s,padVirtualScroll:l,onVirtualScrollEvt:c}=useVirtualScroll({virtualScrollLength:o,getVirtualScrollTarget:function(){return n},getVirtualScrollEl:p}),u=computed((()=>{if(0===o.value)return[];const t=(e,t)=>({index:a.value.from+t,item:e});return void 0===e.itemsFn?e.items.slice(a.value.from,a.value.to).map(t):e.itemsFn(a.value.from,a.value.to-a.value.from).map(t)})),h=computed((()=>"q-virtual-scroll q-virtual-scroll"+(!0===e.virtualScrollHorizontal?"--horizontal":"--vertical")+(void 0!==e.scrollTarget?"":" scroll"))),d=computed((()=>void 0!==e.scrollTarget?{}:{tabindex:0}));function p(){return i.value.$el||i.value}function f(){n=getScrollTarget(p(),e.scrollTarget),n.addEventListener("scroll",c,listenOpts$1.passive)}function m(){void 0!==n&&(n.removeEventListener("scroll",c,listenOpts$1.passive),n=void 0)}function g(){let r=l("list"===e.type?"div":"tbody",u.value.map(t.default));return void 0!==t.before&&(r=t.before().concat(r)),hMergeSlot(t.after,r)}return watch$2(o,(()=>{s()})),watch$2((()=>e.scrollTarget),(()=>{m(),f()})),onBeforeMount((()=>{s()})),onMounted((()=>{f()})),onActivated((()=>{f()})),onDeactivated((()=>{m()})),onBeforeUnmount((()=>{m()})),()=>{if(void 0!==t.default)return"__qtable"===e.type?getTableMiddle({ref:i,class:"q-table__middle "+h.value},g()):h$2(comps[e.type],{...r,ref:i,class:[r.class,h.value],...d.value},g)}}}),QField=createComponent({name:"QField",inheritAttrs:!1,props:{...useFieldProps,tag:{type:String,default:"label"}},emits:useFieldEmits,setup:()=>useField(useFieldState({tagProp:!0}))}),defaultSizes$1={xs:8,sm:10,md:14,lg:20,xl:24},QChip=createComponent({name:"QChip",props:{...useDarkProps,...useSizeProps,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=useDark(e,n),o=useSize(e,defaultSizes$1),a=computed((()=>!0===e.selected||void 0!==e.icon)),s=computed((()=>!0===e.selected?e.iconSelected||n.iconSet.chip.selected:e.icon)),l=computed((()=>e.iconRemove||n.iconSet.chip.remove)),c=computed((()=>!1===e.disable&&(!0===e.clickable||null!==e.selected))),u=computed((()=>{const t=!0===e.outline&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(!1===e.outline&&void 0!==e.color?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(!0===e.disable?" disabled":"")+(!0===e.dense?" q-chip--dense":"")+(!0===e.outline?" q-chip--outline":"")+(!0===e.selected?" q-chip--selected":"")+(!0===c.value?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(!0===e.square?" q-chip--square":"")+(!0===i.value?" q-chip--dark q-dark":"")})),h=computed((()=>{const t=!0===e.disable?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0};return{chip:t,remove:{...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||n.lang.label.remove}}}));function d(e){13===e.keyCode&&p(e)}function p(t){e.disable||(r("update:selected",!e.selected),r("click",t))}function f(t){void 0!==t.keyCode&&13!==t.keyCode||(stopAndPrevent$1(t),!1===e.disable&&(r("update:modelValue",!1),r("remove")))}return()=>{if(!1===e.modelValue)return;const r={class:u.value,style:o.value};return!0===c.value&&Object.assign(r,h.value.chip,{onClick:p,onKeyup:d}),hDir("div",r,function(){const r=[];!0===c.value&&r.push(h$2("div",{class:"q-focus-helper"})),!0===a.value&&r.push(h$2(QIcon,{class:"q-chip__icon q-chip__icon--left",name:s.value}));const n=void 0!==e.label?[h$2("div",{class:"ellipsis"},[e.label])]:void 0;return r.push(h$2("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},hMergeSlotSafely(t.default,n))),e.iconRight&&r.push(h$2(QIcon,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),!0===e.removable&&r.push(h$2(QIcon,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...h.value.remove,onClick:f,onKeyup:f})),r}(),"ripple",!1!==e.ripple&&!0!==e.disable,(()=>[[Ripple,e.ripple]]))}}}),validateNewValueMode=e=>["add","add-unique","toggle"].includes(e),reEscapeList=".*+?^${}()|[]\\",fieldPropsList=Object.keys(useFieldProps);function getPropValueFn(e,t){if("function"==typeof e)return e;const r=void 0!==e?e:t;return e=>null!==e&&"object"==typeof e&&r in e?e[r]:e}const QSelect=createComponent({name:"QSelect",inheritAttrs:!1,props:{...useVirtualScrollProps,...useFormProps,...useFieldProps,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:validateNewValueMode},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:useVirtualScrollProps.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...useFieldEmits,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:t,emit:r}){const{proxy:n}=getCurrentInstance(),{$q:i}=n,o=ref$1(!1),a=ref$1(!1),s=ref$1(-1),l=ref$1(""),c=ref$1(!1),u=ref$1(!1);let h,d,p,f,m,g,y,_=null,v=null,b=null;const w=ref$1(null),x=ref$1(null),S=ref$1(null),E=ref$1(null),T=ref$1(null),A=useFormInputNameAttr(e),C=useKeyComposition(Se),I=computed((()=>Array.isArray(e.options)?e.options.length:0)),k=computed((()=>void 0===e.virtualScrollItemSize?!0===e.optionsDense?24:48:e.virtualScrollItemSize)),{virtualScrollSliceRange:P,virtualScrollSliceSizeComputed:M,localResetVirtualScroll:R,padVirtualScroll:D,onVirtualScrollEvt:O,scrollTo:L,setVirtualScrollSize:B}=useVirtualScroll({virtualScrollLength:I,getVirtualScrollTarget:function(){return we()},getVirtualScrollEl:we,virtualScrollItemSizeComputed:k}),$=useFieldState(),z=computed((()=>{const t=!0===e.mapOptions&&!0!==e.multiple,r=void 0===e.modelValue||null===e.modelValue&&!0!==t?[]:!0===e.multiple&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue];if(!0===e.mapOptions&&!0===Array.isArray(e.options)){const n=!0===e.mapOptions&&void 0!==h?h:[],i=r.map((t=>function(t,r){const n=e=>isDeepEqual(ne.value(e),t);return e.options.find(n)||r.find(n)||t}(t,n)));return null===e.modelValue&&!0===t?i.filter((e=>null!==e)):i}return r})),F=computed((()=>{const t={};return fieldPropsList.forEach((r=>{const n=e[r];void 0!==n&&(t[r]=n)})),t})),q=computed((()=>null===e.optionsDark?$.isDark.value:e.optionsDark)),N=computed((()=>fieldValueIsFilled(z.value))),j=computed((()=>{let t="q-field__input q-placeholder col";return!0===e.hideSelected||0===z.value.length?[t,e.inputClass]:(t+=" q-field__input--padding",void 0===e.inputClass?t:[t,e.inputClass])})),U=computed((()=>(!0===e.virtualScrollHorizontal?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:""))),V=computed((()=>0===I.value)),G=computed((()=>z.value.map((e=>ie.value(e))).join(", "))),W=computed((()=>void 0!==e.displayValue?e.displayValue:G.value)),H=computed((()=>!0===e.optionsHtml?()=>!0:e=>!0===e?.html)),Z=computed((()=>!0===e.displayValueHtml||void 0===e.displayValue&&(!0===e.optionsHtml||z.value.some(H.value)))),Y=computed((()=>!0===$.focused.value?e.tabindex:-1)),X=computed((()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":!0===e.readonly?"true":"false","aria-autocomplete":!0===e.useInput?"list":"none","aria-expanded":!0===o.value?"true":"false","aria-controls":`${$.targetUid.value}_lb`};return s.value>=0&&(t["aria-activedescendant"]=`${$.targetUid.value}_${s.value}`),t})),K=computed((()=>({id:`${$.targetUid.value}_lb`,role:"listbox","aria-multiselectable":!0===e.multiple?"true":"false"}))),Q=computed((()=>z.value.map(((e,t)=>({index:t,opt:e,html:H.value(e),selected:!0,removeAtIndex:ue,toggleOption:de,tabindex:Y.value}))))),J=computed((()=>{if(0===I.value)return[];const{from:t,to:r}=P.value;return e.options.slice(t,r).map(((r,n)=>{const a=!0===oe.value(r),l=!0===me(r),c=t+n,u={clickable:!0,active:l,activeClass:re.value,manualFocus:!0,focused:!1,disable:a,tabindex:-1,dense:e.optionsDense,dark:q.value,role:"option","aria-selected":!0===l?"true":"false",id:`${$.targetUid.value}_${c}`,onClick:()=>{de(r)}};return!0!==a&&(s.value===c&&(u.focused=!0),!0===i.platform.is.desktop&&(u.onMousemove=()=>{!0===o.value&&pe(c)})),{index:c,opt:r,html:H.value(r),label:ie.value(r),selected:u.active,focused:u.focused,toggleOption:de,setOptionIndex:pe,itemProps:u}}))})),ee=computed((()=>void 0!==e.dropdownIcon?e.dropdownIcon:i.iconSet.arrow.dropdown)),te=computed((()=>!1===e.optionsCover&&!0!==e.outlined&&!0!==e.standout&&!0!==e.borderless&&!0!==e.rounded)),re=computed((()=>void 0!==e.optionsSelectedClass?e.optionsSelectedClass:void 0!==e.color?`text-${e.color}`:"")),ne=computed((()=>getPropValueFn(e.optionValue,"value"))),ie=computed((()=>getPropValueFn(e.optionLabel,"label"))),oe=computed((()=>getPropValueFn(e.optionDisable,"disable"))),ae=computed((()=>z.value.map(ne.value))),se=computed((()=>{const e={onInput:Se,onChange:C,onKeydown:be,onKeyup:_e,onKeypress:ve,onFocus:ge,onClick(e){!0===d&&stop$1(e)}};return e.onCompositionstart=e.onCompositionupdate=e.onCompositionend=C,e}));function le(t){return!0===e.emitValue?ne.value(t):t}function ce(t){if(-1!==t&&t<z.value.length)if(!0===e.multiple){const n=e.modelValue.slice();r("remove",{index:t,value:n.splice(t,1)[0]}),r("update:modelValue",n)}else r("update:modelValue",null)}function ue(e){ce(e),$.focus()}function he(t,n){const i=le(t);if(!0!==e.multiple)return!0===e.fillInput&&Te(ie.value(t),!0,!0),void r("update:modelValue",i);if(0===z.value.length)return r("add",{index:0,value:i}),void r("update:modelValue",!0===e.multiple?[i]:i);if(!0===n&&!0===me(t))return;if(void 0!==e.maxValues&&e.modelValue.length>=e.maxValues)return;const o=e.modelValue.slice();r("add",{index:o.length,value:i}),o.push(i),r("update:modelValue",o)}function de(t,n){if(!0!==$.editable.value||void 0===t||!0===oe.value(t))return;const i=ne.value(t);if(!0!==e.multiple)return!0!==n&&(Te(!0===e.fillInput?ie.value(t):"",!0,!0),Be()),x.value?.focus(),void(0!==z.value.length&&!0===isDeepEqual(ne.value(z.value[0]),i)||r("update:modelValue",!0===e.emitValue?i:t));if(!0===d&&!0!==c.value||$.focus(),ge(),0===z.value.length){const n=!0===e.emitValue?i:t;return r("add",{index:0,value:n}),void r("update:modelValue",!0===e.multiple?[n]:n)}const o=e.modelValue.slice(),a=ae.value.findIndex((e=>isDeepEqual(e,i)));if(-1!==a)r("remove",{index:a,value:o.splice(a,1)[0]});else{if(void 0!==e.maxValues&&o.length>=e.maxValues)return;const n=!0===e.emitValue?i:t;r("add",{index:o.length,value:n}),o.push(n)}r("update:modelValue",o)}function pe(e){if(!0!==i.platform.is.desktop)return;const t=-1!==e&&e<I.value?e:-1;s.value!==t&&(s.value=t)}function fe(t=1,r){if(!0===o.value){let n=s.value;do{n=normalizeToInterval(n+t,-1,I.value-1)}while(-1!==n&&n!==s.value&&!0===oe.value(e.options[n]));s.value!==n&&(pe(n),L(n),!0!==r&&!0===e.useInput&&!0===e.fillInput&&Ee(n>=0?ie.value(e.options[n]):f,!0))}}function me(e){const t=ne.value(e);return void 0!==ae.value.find((e=>isDeepEqual(e,t)))}function ge(t){!0===e.useInput&&null!==x.value&&(void 0===t||x.value===t.target&&t.target.value===G.value)&&x.value.select()}function ye(e){!0===isKeyCode(e,27)&&!0===o.value&&(stop$1(e),Be(),$e()),r("keyup",e)}function _e(t){const{value:r}=t.target;if(void 0===t.keyCode)if(t.target.value="",null!==_&&(clearTimeout(_),_=null),null!==v&&(clearTimeout(v),v=null),$e(),"string"==typeof r&&0!==r.length){const t=r.toLocaleLowerCase(),n=r=>{const n=e.options.find((e=>String(r.value(e)).toLocaleLowerCase()===t));return void 0!==n&&(-1===z.value.indexOf(n)?de(n):Be(),!0)},i=e=>{!0!==n(ne)&&!0!==e&&!0!==n(ie)&&Ae(r,!0,(()=>i(!0)))};i()}else $.clearValue(t);else ye(t)}function ve(e){r("keypress",e)}function be(t){if(r("keydown",t),!0===shouldIgnoreKey(t))return;const n=0!==l.value.length&&(void 0!==e.newValueMode||void 0!==e.onNewValue),i=!0!==t.shiftKey&&!0!==e.disableTabSelection&&!0!==e.multiple&&(-1!==s.value||!0===n);if(27===t.keyCode)return void prevent(t);if(9===t.keyCode&&!1===i)return void Oe();if(void 0===t.target||t.target.id!==$.targetUid.value||!0!==$.editable.value)return;if(40===t.keyCode&&!0!==$.innerLoading.value&&!1===o.value)return stopAndPrevent$1(t),void Le();if(8===t.keyCode&&(!0===e.useChips||!0===e.clearable)&&!0!==e.hideSelected&&0===l.value.length)return void(!0===e.multiple&&!0===Array.isArray(e.modelValue)?ce(e.modelValue.length-1):!0!==e.multiple&&null!==e.modelValue&&r("update:modelValue",null));35!==t.keyCode&&36!==t.keyCode||"string"==typeof l.value&&0!==l.value.length||(stopAndPrevent$1(t),s.value=-1,fe(36===t.keyCode?1:-1,e.multiple)),33!==t.keyCode&&34!==t.keyCode||void 0===M.value||(stopAndPrevent$1(t),s.value=Math.max(-1,Math.min(I.value,s.value+(33===t.keyCode?-1:1)*M.value.view)),fe(33===t.keyCode?1:-1,e.multiple)),38!==t.keyCode&&40!==t.keyCode||(stopAndPrevent$1(t),fe(38===t.keyCode?-1:1,e.multiple));const a=I.value;if((void 0===g||y<Date.now())&&(g=""),a>0&&!0!==e.useInput&&void 0!==t.key&&1===t.key.length&&!1===t.altKey&&!1===t.ctrlKey&&!1===t.metaKey&&(32!==t.keyCode||0!==g.length)){!0!==o.value&&Le(t);const r=t.key.toLocaleLowerCase(),n=1===g.length&&g[0]===r;y=Date.now()+1500,!1===n&&(stopAndPrevent$1(t),g+=r);const i=new RegExp("^"+g.split("").map((e=>-1!==reEscapeList.indexOf(e)?"\\"+e:e)).join(".*"),"i");let l=s.value;if(!0===n||l<0||!0!==i.test(ie.value(e.options[l])))do{l=normalizeToInterval(l+1,-1,a-1)}while(l!==s.value&&(!0===oe.value(e.options[l])||!0!==i.test(ie.value(e.options[l]))));s.value!==l&&nextTick((()=>{pe(l),L(l),l>=0&&!0===e.useInput&&!0===e.fillInput&&Ee(ie.value(e.options[l]),!0)}))}else if(13===t.keyCode||32===t.keyCode&&!0!==e.useInput&&""===g||9===t.keyCode&&!1!==i)if(9!==t.keyCode&&stopAndPrevent$1(t),-1!==s.value&&s.value<a)de(e.options[s.value]);else{if(!0===n){const t=(t,r)=>{if(r){if(!0!==validateNewValueMode(r))return}else r=e.newValueMode;if(Te("",!0!==e.multiple,!0),null==t)return;("toggle"===r?de:he)(t,"add-unique"===r),!0!==e.multiple&&(x.value?.focus(),Be())};if(void 0!==e.onNewValue?r("newValue",l.value,t):t(l.value),!0!==e.multiple)return}!0===o.value?Oe():!0!==$.innerLoading.value&&Le()}}function we(){return!0===d?T.value:null!==S.value&&null!==S.value.contentEl?S.value.contentEl:void 0}function xe(){if(!0===V.value)return void 0!==t["no-option"]?t["no-option"]({inputValue:l.value}):void 0;const e=void 0!==t.option?t.option:e=>h$2(QItem,{key:e.index,...e.itemProps},(()=>h$2(QItemSection,(()=>h$2(QItemLabel,(()=>h$2("span",{[!0===e.html?"innerHTML":"textContent"]:e.label})))))));let r=D("div",J.value.map(e));return void 0!==t["before-options"]&&(r=t["before-options"]().concat(r)),hMergeSlot(t["after-options"],r)}function Se(t){null!==_&&(clearTimeout(_),_=null),null!==v&&(clearTimeout(v),v=null),t&&t.target&&!0===t.target.qComposing||(Ee(t.target.value||""),p=!0,f=l.value,!0===$.focused.value||!0===d&&!0!==c.value||$.focus(),void 0!==e.onFilter&&(_=setTimeout((()=>{_=null,Ae(l.value)}),e.inputDebounce)))}function Ee(t,n){l.value!==t&&(l.value=t,!0===n||0===e.inputDebounce||"0"===e.inputDebounce?r("inputValue",t):v=setTimeout((()=>{v=null,r("inputValue",t)}),e.inputDebounce))}function Te(t,r,n){p=!0!==n,!0===e.useInput&&(Ee(t,!0),!0!==r&&!0===n||(f=t),!0!==r&&Ae(t))}function Ae(t,i,a){if(void 0===e.onFilter||!0!==i&&!0!==$.focused.value)return;!0===$.innerLoading.value?r("filterAbort"):($.innerLoading.value=!0,u.value=!0),""!==t&&!0!==e.multiple&&0!==z.value.length&&!0!==p&&t===ie.value(z.value[0])&&(t="");const s=setTimeout((()=>{!0===o.value&&(o.value=!1)}),10);null!==b&&clearTimeout(b),b=s,r("filter",t,((e,t)=>{!0!==i&&!0!==$.focused.value||b!==s||(clearTimeout(b),"function"==typeof e&&e(),u.value=!1,nextTick((()=>{$.innerLoading.value=!1,!0===$.editable.value&&(!0===i?!0===o.value&&Be():!0===o.value?ze(!0):o.value=!0),"function"==typeof t&&nextTick((()=>{t(n)})),"function"==typeof a&&nextTick((()=>{a(n)}))})))}),(()=>{!0===$.focused.value&&b===s&&(clearTimeout(b),$.innerLoading.value=!1,u.value=!1),!0===o.value&&(o.value=!1)}))}function Ce(e){Ne(e),Oe()}function Ie(){B()}function ke(e){stop$1(e),x.value?.focus(),c.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Pe(e){stop$1(e),nextTick((()=>{c.value=!1}))}function Me(e){Ne(e),null!==E.value&&E.value.__updateRefocusTarget($.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),$.focused.value=!1}function Re(e){Be(),!1===$.focused.value&&r("blur",e),$e()}function De(){const e=document.activeElement;null!==e&&e.id===$.targetUid.value||null===x.value||x.value===e||x.value.focus(),B()}function Oe(){!0!==a.value&&(s.value=-1,!0===o.value&&(o.value=!1),!1===$.focused.value&&(null!==b&&(clearTimeout(b),b=null),!0===$.innerLoading.value&&(r("filterAbort"),$.innerLoading.value=!1,u.value=!1)))}function Le(r){!0===$.editable.value&&(!0===d?($.onControlFocusin(r),a.value=!0,nextTick((()=>{$.focus()}))):$.focus(),void 0!==e.onFilter?Ae(l.value):!0===V.value&&void 0===t["no-option"]||(o.value=!0))}function Be(){a.value=!1,Oe()}function $e(){!0===e.useInput&&Te(!0!==e.multiple&&!0===e.fillInput&&0!==z.value.length&&ie.value(z.value[0])||"",!0,!0)}function ze(t){let r=-1;if(!0===t){if(0!==z.value.length){const t=ne.value(z.value[0]);r=e.options.findIndex((e=>isDeepEqual(ne.value(e),t)))}R(r)}pe(r)}function Fe(){!1===a.value&&null!==S.value&&S.value.updatePosition()}function qe(e){void 0!==e&&stop$1(e),r("popupShow",e),$.hasPopupOpen=!0,$.onControlFocusin(e)}function Ne(e){void 0!==e&&stop$1(e),r("popupHide",e),$.hasPopupOpen=!1,$.onControlFocusout(e)}function je(){d=(!0===i.platform.is.mobile||"dialog"===e.behavior)&&("menu"!==e.behavior&&(!0!==e.useInput||(void 0!==t["no-option"]||void 0!==e.onFilter||!1===V.value))),m=!0===i.platform.is.ios&&!0===d&&!0===e.useInput?"fade":e.transitionShow}return watch$2(z,(t=>{h=t,!0===e.useInput&&!0===e.fillInput&&!0!==e.multiple&&!0!==$.innerLoading.value&&(!0!==a.value&&!0!==o.value||!0!==N.value)&&(!0!==p&&$e(),!0!==a.value&&!0!==o.value||Ae(""))}),{immediate:!0}),watch$2((()=>e.fillInput),$e),watch$2(o,ze),watch$2(I,(function(e,t){!0===o.value&&!1===$.innerLoading.value&&(R(-1,!0),nextTick((()=>{!0===o.value&&!1===$.innerLoading.value&&(e>t?R():ze(!0))})))})),onBeforeUpdate(je),onUpdated(Fe),je(),onBeforeUnmount((()=>{null!==_&&clearTimeout(_),null!==v&&clearTimeout(v)})),Object.assign(n,{showPopup:Le,hidePopup:Be,removeAtIndex:ce,add:he,toggleOption:de,getOptionIndex:()=>s.value,setOptionIndex:pe,moveOptionSelection:fe,filter:Ae,updateMenuPosition:Fe,updateInputValue:Te,isOptionSelected:me,getEmittingOptionValue:le,isOptionDisabled:(...e)=>!0===oe.value.apply(null,e),getOptionValue:(...e)=>ne.value.apply(null,e),getOptionLabel:(...e)=>ie.value.apply(null,e)}),Object.assign($,{innerValue:z,fieldClass:computed((()=>`q-select q-field--auto-height q-select--with${!0!==e.useInput?"out":""}-input q-select--with${!0!==e.useChips?"out":""}-chips q-select--${!0===e.multiple?"multiple":"single"}`)),inputRef:w,targetRef:x,hasValue:N,showPopup:Le,floatingLabel:computed((()=>!0!==e.hideSelected&&!0===N.value||"number"==typeof l.value||0!==l.value.length||fieldValueIsFilled(e.displayValue))),getControlChild:()=>{if(!1!==$.editable.value&&(!0===a.value||!0!==V.value||void 0!==t["no-option"]))return!0===d?function(){const r=[h$2(QField,{class:`col-auto ${$.fieldClass.value}`,...F.value,for:$.targetUid.value,dark:q.value,square:!0,loading:u.value,itemAligned:!1,filled:!0,stackLabel:0!==l.value.length,...$.splitAttrs.listeners.value,onFocus:ke,onBlur:Pe},{...t,rawControl:()=>$.getControl(!0),before:void 0,after:void 0})];return!0===o.value&&r.push(h$2("div",{ref:T,class:U.value+" scroll",style:e.popupContentStyle,...K.value,onClick:prevent,onScrollPassive:O},xe())),h$2(QDialog,{ref:E,modelValue:a.value,position:!0===e.useInput?"top":void 0,transitionShow:m,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:qe,onBeforeHide:Me,onHide:Re,onShow:De},(()=>h$2("div",{class:"q-select__dialog"+(!0===q.value?" q-select__dialog--dark q-dark":"")+(!0===c.value?" q-select__dialog--focused":"")},r)))}():h$2(QMenu,{ref:S,class:U.value,style:e.popupContentStyle,modelValue:o.value,fit:!0!==e.menuShrink,cover:!0===e.optionsCover&&!0!==V.value&&!0!==e.useInput,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:q.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:te.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...K.value,onScrollPassive:O,onBeforeShow:qe,onBeforeHide:Ce,onShow:Ie},xe);!0===$.hasPopupOpen&&($.hasPopupOpen=!1)},controlEvents:{onFocusin(e){$.onControlFocusin(e)},onFocusout(e){$.onControlFocusout(e,(()=>{$e(),Oe()}))},onClick(e){if(prevent(e),!0!==d&&!0===o.value)return Oe(),void x.value?.focus();Le(e)}},getControl:r=>{const n=!0===e.hideSelected?[]:void 0!==t["selected-item"]?Q.value.map((e=>t["selected-item"](e))).slice():void 0!==t.selected?[].concat(t.selected()):!0===e.useChips?Q.value.map(((t,r)=>h$2(QChip,{key:"option-"+r,removable:!0===$.editable.value&&!0!==oe.value(t.opt),dense:!0,textColor:e.color,tabindex:Y.value,onRemove(){t.removeAtIndex(r)}},(()=>h$2("span",{class:"ellipsis",[!0===t.html?"innerHTML":"textContent"]:ie.value(t.opt)}))))):[h$2("span",{class:"ellipsis",[!0===Z.value?"innerHTML":"textContent"]:W.value})],i=!0===r||!0!==a.value||!0!==d;if(!0===e.useInput)n.push(function(t,r){const n=!0===r?{...X.value,...$.splitAttrs.attributes.value}:void 0,i={ref:!0===r?x:void 0,key:"i_t",class:j.value,style:e.inputStyle,value:void 0!==l.value?l.value:"",type:"search",...n,id:!0===r?$.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":!0===t||!0===e.autofocus||void 0,disabled:!0===e.disable,readonly:!0===e.readonly,...se.value};return!0!==t&&!0===d&&(!0===Array.isArray(i.class)?i.class=[...i.class,"no-pointer-events"]:i.class+=" no-pointer-events"),h$2("input",i)}(r,i));else if(!0===$.editable.value){const t=!0===i?X.value:void 0;n.push(h$2("input",{ref:!0===i?x:void 0,key:"d_t",class:"q-select__focus-target",id:!0===i?$.targetUid.value:void 0,value:W.value,readonly:!0,"data-autofocus":!0===r||!0===e.autofocus||void 0,...t,onKeydown:be,onKeyup:ye,onKeypress:ve})),!0===i&&"string"==typeof e.autocomplete&&0!==e.autocomplete.length&&n.push(h$2("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:_e}))}if(void 0!==A.value&&!0!==e.disable&&0!==ae.value.length){const t=ae.value.map((e=>h$2("option",{value:e,selected:!0})));n.push(h$2("select",{class:"hidden",name:A.value,multiple:e.multiple},t))}const o=!0===e.useInput||!0!==i?void 0:$.splitAttrs.attributes.value;return h$2("div",{class:"q-field__native row items-center",...o,...$.splitAttrs.listeners.value},n)},getInnerAppend:()=>!0!==e.loading&&!0!==u.value&&!0!==e.hideDropdownIcon?[h$2(QIcon,{class:"q-select__dropdown-icon"+(!0===o.value?" rotate-180":""),name:ee.value})]:null}),useField($)}}),defaultSizes={xs:2,sm:4,md:6,lg:10,xl:14};function width(e,t,r){return{transform:!0===t?`translateX(${!0===r.lang.rtl?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}const QLinearProgress=createComponent({name:"QLinearProgress",props:{...useDarkProps,...useSizeProps,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:t}){const{proxy:r}=getCurrentInstance(),n=useDark(e,r.$q),i=useSize(e,defaultSizes),o=computed((()=>!0===e.indeterminate||!0===e.query)),a=computed((()=>e.reverse!==e.query)),s=computed((()=>({...null!==i.value?i.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`}))),l=computed((()=>"q-linear-progress"+(void 0!==e.color?` text-${e.color}`:"")+(!0===e.reverse||!0===e.query?" q-linear-progress--reverse":"")+(!0===e.rounded?" rounded-borders":""))),c=computed((()=>width(void 0!==e.buffer?e.buffer:1,a.value,r.$q))),u=computed((()=>`with${!0===e.instantFeedback?"out":""}-transition`)),h=computed((()=>`q-linear-progress__track absolute-full q-linear-progress__track--${u.value} q-linear-progress__track--${!0===n.value?"dark":"light"}`+(void 0!==e.trackColor?` bg-${e.trackColor}`:""))),d=computed((()=>width(!0===o.value?1:e.value,a.value,r.$q))),p=computed((()=>`q-linear-progress__model absolute-full q-linear-progress__model--${u.value} q-linear-progress__model--${!0===o.value?"in":""}determinate`)),f=computed((()=>({width:100*e.value+"%"}))),m=computed((()=>`q-linear-progress__stripe absolute-${!0===e.reverse?"right":"left"} q-linear-progress__stripe--${u.value}`));return()=>{const r=[h$2("div",{class:h.value,style:c.value}),h$2("div",{class:p.value,style:d.value})];return!0===e.stripe&&!1===o.value&&r.push(h$2("div",{class:m.value,style:f.value})),h$2("div",{class:l.value,style:s.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":!0===e.indeterminate?void 0:e.value},hMergeSlot(t.default,r))}}});let counter=0;const useFullscreenProps={fullscreen:Boolean,noRouteFullscreenExit:Boolean},useFullscreenEmits=["update:fullscreen","fullscreen"];function useFullscreen(){const e=getCurrentInstance(),{props:t,emit:r,proxy:n}=e;let i,o,a;const s=ref$1(!1);function l(){!0===s.value?u():c()}function c(){!0!==s.value&&(s.value=!0,a=n.$el.parentNode,a.replaceChild(o,n.$el),document.body.appendChild(n.$el),counter++,1===counter&&document.body.classList.add("q-body--fullscreen-mixin"),i={handler:u},History.add(i))}function u(){!0===s.value&&(void 0!==i&&(History.remove(i),i=void 0),a.replaceChild(n.$el,o),s.value=!1,counter=Math.max(0,counter-1),0===counter&&(document.body.classList.remove("q-body--fullscreen-mixin"),void 0!==n.$el.scrollIntoView&&setTimeout((()=>{n.$el.scrollIntoView()}))))}return!0===vmHasRouter(e)&&watch$2((()=>n.$route.fullPath),(()=>{!0!==t.noRouteFullscreenExit&&u()})),watch$2((()=>t.fullscreen),(e=>{s.value!==e&&l()})),watch$2(s,(e=>{r("update:fullscreen",e),r("fullscreen",e)})),onBeforeMount((()=>{o=document.createElement("span")})),onMounted((()=>{!0===t.fullscreen&&c()})),onBeforeUnmount(u),Object.assign(n,{toggleFullscreen:l,setFullscreen:c,exitFullscreen:u}),{inFullscreen:s,toggleFullscreen:l}}function sortDate(e,t){return new Date(e)-new Date(t)}const useTableSortProps={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>"ad"===e||"da"===e,default:"ad"}};function useTableSort(e,t,r,n){return{columnToSort:computed((()=>{const{sortBy:e}=t.value;return e&&r.value.find((t=>t.name===e))||null})),computedSortMethod:computed((()=>void 0!==e.sortMethod?e.sortMethod:(e,t,n)=>{const i=r.value.find((e=>e.name===t));if(void 0===i||void 0===i.field)return e;const o=!0===n?-1:1,a="function"==typeof i.field?e=>i.field(e):e=>e[i.field];return e.sort(((e,t)=>{let r=a(e),n=a(t);return void 0!==i.rawSort?i.rawSort(r,n,e,t)*o:null==r?-1*o:null==n?1*o:void 0!==i.sort?i.sort(r,n,e,t)*o:!0===isNumber$2(r)&&!0===isNumber$2(n)?(r-n)*o:!0===isDate(r)&&!0===isDate(n)?sortDate(r,n)*o:"boolean"==typeof r&&"boolean"==typeof n?(r-n)*o:([r,n]=[r,n].map((e=>(e+"").toLocaleString().toLowerCase())),r<n?-1*o:r===n?0:o)}))})),sort:function(i){let o=e.columnSortOrder;if(!0===isObject$2(i))i.sortOrder&&(o=i.sortOrder),i=i.name;else{const e=r.value.find((e=>e.name===i));e?.sortOrder&&(o=e.sortOrder)}let{sortBy:a,descending:s}=t.value;a!==i?(a=i,s="da"===o):!0===e.binaryStateSort?s=!s:!0===s?"ad"===o?a=null:s=!1:"ad"===o?s=!0:a=null,n({sortBy:a,descending:s,page:1})}}}const useTableFilterProps={filter:[String,Object],filterMethod:Function};function useTableFilter(e,t){const r=computed((()=>void 0!==e.filterMethod?e.filterMethod:(e,t,r,n)=>{const i=t?t.toLowerCase():"";return e.filter((e=>r.some((t=>{const r=n(t,e)+"";return-1!==("undefined"===r||"null"===r?"":r.toLowerCase()).indexOf(i)}))))}));return watch$2((()=>e.filter),(()=>{nextTick((()=>{t({page:1},!0)}))}),{deep:!0}),{computedFilterMethod:r}}function samePagination(e,t){for(const r in t)if(t[r]!==e[r])return!1;return!0}function fixPagination(e){return e.page<1&&(e.page=1),void 0!==e.rowsPerPage&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const useTablePaginationProps={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function useTablePaginationState(e,t){const{props:r,emit:n}=e,i=ref$1(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:0!==r.rowsPerPageOptions.length?r.rowsPerPageOptions[0]:5},r.pagination)),o=computed((()=>fixPagination(void 0!==r["onUpdate:pagination"]?{...i.value,...r.pagination}:i.value))),a=computed((()=>void 0!==o.value.rowsNumber));function s(e){l({pagination:e,filter:r.filter})}function l(e={}){nextTick((()=>{n("request",{pagination:e.pagination||o.value,filter:e.filter||r.filter,getCellValue:t})}))}return{innerPagination:i,computedPagination:o,isServerSide:a,requestServerInteraction:l,setPagination:function(e,t){const l=fixPagination({...o.value,...e});!0!==samePagination(o.value,l)?!0!==a.value?void 0!==r.pagination&&void 0!==r["onUpdate:pagination"]?n("update:pagination",l):i.value=l:s(l):!0===a.value&&!0===t&&s(l)}}}function useTablePagination(e,t,r,n,i,o){const{props:a,emit:s,proxy:{$q:l}}=e,c=computed((()=>!0===n.value?r.value.rowsNumber||0:o.value)),u=computed((()=>{const{page:e,rowsPerPage:t}=r.value;return(e-1)*t})),h=computed((()=>{const{page:e,rowsPerPage:t}=r.value;return e*t})),d=computed((()=>1===r.value.page)),p=computed((()=>0===r.value.rowsPerPage?1:Math.max(1,Math.ceil(c.value/r.value.rowsPerPage)))),f=computed((()=>0===h.value||r.value.page>=p.value)),m=computed((()=>(a.rowsPerPageOptions.includes(t.value.rowsPerPage)?a.rowsPerPageOptions:[t.value.rowsPerPage].concat(a.rowsPerPageOptions)).map((e=>({label:0===e?l.lang.table.allRows:""+e,value:e})))));return watch$2(p,((e,t)=>{if(e===t)return;const n=r.value.page;e&&!n?i({page:1}):e<n&&i({page:e})})),void 0!==a["onUpdate:pagination"]&&s("update:pagination",{...r.value}),{firstRowIndex:u,lastRowIndex:h,isFirstPage:d,isLastPage:f,pagesNumber:p,computedRowsPerPageOptions:m,computedRowsNumber:c,firstPage:function(){i({page:1})},prevPage:function(){const{page:e}=r.value;e>1&&i({page:e-1})},nextPage:function(){const{page:e,rowsPerPage:t}=r.value;h.value>0&&e*t<c.value&&i({page:e+1})},lastPage:function(){i({page:p.value})}}}const useTableRowSelectionProps={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},useTableRowSelectionEmits=["update:selected","selection"];function useTableRowSelection(e,t,r,n){const i=computed((()=>{const t={};return e.selected.map(n.value).forEach((e=>{t[e]=!0})),t})),o=computed((()=>"none"!==e.selection)),a=computed((()=>"single"===e.selection)),s=computed((()=>"multiple"===e.selection)),l=computed((()=>0!==r.value.length&&r.value.every((e=>!0===i.value[n.value(e)])))),c=computed((()=>!0!==l.value&&r.value.some((e=>!0===i.value[n.value(e)])))),u=computed((()=>e.selected.length));return{hasSelectionMode:o,singleSelection:a,multipleSelection:s,allRowsSelected:l,someRowsSelected:c,rowsSelectedNumber:u,isRowSelected:function(e){return!0===i.value[e]},clearSelection:function(){t("update:selected",[])},updateSelection:function(r,i,o,s){t("selection",{rows:i,added:o,keys:r,evt:s});const l=!0===a.value?!0===o?i:[]:!0===o?e.selected.concat(i):e.selected.filter((e=>!1===r.includes(n.value(e))));t("update:selected",l)}}}function getVal(e){return Array.isArray(e)?e.slice():[]}const useTableRowExpandProps={expanded:Array},useTableRowExpandEmits=["update:expanded"];function useTableRowExpand(e,t){const r=ref$1(getVal(e.expanded));function n(n){void 0!==e.expanded?t("update:expanded",n):r.value=n}return watch$2((()=>e.expanded),(e=>{r.value=getVal(e)})),{isRowExpanded:function(e){return r.value.includes(e)},setExpanded:n,updateExpanded:function(e,t){const i=r.value.slice(),o=i.indexOf(e);!0===t?-1===o&&(i.push(e),n(i)):-1!==o&&(i.splice(o,1),n(i))}}}const useTableColumnSelectionProps={visibleColumns:Array};function useTableColumnSelection(e,t,r){const n=computed((()=>{if(void 0!==e.columns)return e.columns;const t=e.rows[0];return void 0!==t?Object.keys(t).map((e=>({name:e,label:e.toUpperCase(),field:e,align:isNumber$2(t[e])?"right":"left",sortable:!0}))):[]})),i=computed((()=>{const{sortBy:r,descending:i}=t.value;return(void 0!==e.visibleColumns?n.value.filter((t=>!0===t.required||!0===e.visibleColumns.includes(t.name))):n.value).map((e=>{const t=e.align||"right",n=`text-${t}`;return{...e,align:t,__iconClass:`q-table__sort-icon q-table__sort-icon--${t}`,__thClass:n+(void 0!==e.headerClasses?" "+e.headerClasses:"")+(!0===e.sortable?" sortable":"")+(e.name===r?" sorted "+(!0===i?"sort-desc":""):""),__tdStyle:void 0!==e.style?"function"!=typeof e.style?()=>e.style:e.style:()=>null,__tdClass:void 0!==e.classes?"function"!=typeof e.classes?()=>n+" "+e.classes:t=>n+" "+e.classes(t):()=>n}}))})),o=computed((()=>{const e={};return i.value.forEach((t=>{e[t.name]=t})),e})),a=computed((()=>void 0!==e.tableColspan?e.tableColspan:i.value.length+(!0===r.value?1:0)));return{colList:n,computedCols:i,computedColsMap:o,computedColspan:a}}const bottomClass="q-table__bottom row items-center",virtScrollPassthroughProps={};commonVirtScrollPropsList.forEach((e=>{virtScrollPassthroughProps[e]={}}));const QTable=createComponent({name:"QTable",props:{rows:{type:Array,required:!0},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{},...virtScrollPassthroughProps,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],tableRowStyleFn:Function,tableRowClassFn:Function,cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],cardStyleFn:Function,cardClassFn:Function,hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...useDarkProps,...useFullscreenProps,...useTableColumnSelectionProps,...useTableFilterProps,...useTablePaginationProps,...useTableRowExpandProps,...useTableRowSelectionProps,...useTableSortProps},emits:["request","virtualScroll",...useFullscreenEmits,...useTableRowExpandEmits,...useTableRowSelectionEmits],setup(e,{slots:t,emit:r}){const n=getCurrentInstance(),{proxy:{$q:i}}=n,o=useDark(e,i),{inFullscreen:a,toggleFullscreen:s}=useFullscreen(),l=computed((()=>"function"==typeof e.rowKey?e.rowKey:t=>t[e.rowKey])),c=ref$1(null),u=ref$1(null),h=computed((()=>!0!==e.grid&&!0===e.virtualScroll)),d=computed((()=>" q-table__card"+(!0===o.value?" q-table__card--dark q-dark":"")+(!0===e.square?" q-table--square":"")+(!0===e.flat?" q-table--flat":"")+(!0===e.bordered?" q-table--bordered":""))),p=computed((()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(!0===e.grid?" q-table--grid":d.value)+(!0===o.value?" q-table--dark":"")+(!0===e.dense?" q-table--dense":"")+(!1===e.wrapCells?" q-table--no-wrap":"")+(!0===a.value?" fullscreen scroll":""))),f=computed((()=>p.value+(!0===e.loading?" q-table--loading":"")));watch$2((()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+p.value),(()=>{!0===h.value&&u.value?.reset()}));const{innerPagination:m,computedPagination:g,isServerSide:y,requestServerInteraction:_,setPagination:v}=useTablePaginationState(n,ce),{computedFilterMethod:b}=useTableFilter(e,v),{isRowExpanded:w,setExpanded:x,updateExpanded:S}=useTableRowExpand(e,r),E=computed((()=>{let t=e.rows;if(!0===y.value||0===t.length)return t;const{sortBy:r,descending:n}=g.value;return e.filter&&(t=b.value(t,e.filter,$.value,ce)),null!==q.value&&(t=N.value(e.rows===t?t.slice():t,r,n)),t})),T=computed((()=>E.value.length)),A=computed((()=>{let t=E.value;if(!0===y.value)return t;const{rowsPerPage:r}=g.value;return 0!==r&&(0===U.value&&e.rows!==t?t.length>V.value&&(t=t.slice(0,V.value)):t=t.slice(U.value,V.value)),t})),{hasSelectionMode:C,singleSelection:I,multipleSelection:k,allRowsSelected:P,someRowsSelected:M,rowsSelectedNumber:R,isRowSelected:D,clearSelection:O,updateSelection:L}=useTableRowSelection(e,r,A,l),{colList:B,computedCols:$,computedColsMap:z,computedColspan:F}=useTableColumnSelection(e,g,C),{columnToSort:q,computedSortMethod:N,sort:j}=useTableSort(e,g,B,v),{firstRowIndex:U,lastRowIndex:V,isFirstPage:G,isLastPage:W,pagesNumber:H,computedRowsPerPageOptions:Z,computedRowsNumber:Y,firstPage:X,prevPage:K,nextPage:Q,lastPage:J}=useTablePagination(n,m,g,y,v,T),ee=computed((()=>0===A.value.length)),te=computed((()=>{const t={};return commonVirtScrollPropsList.forEach((r=>{t[r]=e[r]})),void 0===t.virtualScrollItemSize&&(t.virtualScrollItemSize=!0===e.dense?28:48),t}));function re(){if(!0===e.grid)return function(){const n=void 0!==t.item?t.item:n=>{const i=n.cols.map((e=>h$2("div",{class:"q-table__grid-item-row"},[h$2("div",{class:"q-table__grid-item-title"},[e.label]),h$2("div",{class:"q-table__grid-item-value"},[e.value])])));if(!0===C.value){const r=t["body-selection"],a=void 0!==r?r(n):[h$2(QCheckbox,{modelValue:n.selected,color:e.color,dark:o.value,dense:e.dense,"onUpdate:modelValue":(e,t)=>{L([n.key],[n.row],e,t)}})];i.unshift(h$2("div",{class:"q-table__grid-item-row"},a),h$2(QSeparator,{dark:o.value}))}const a={class:["q-table__grid-item-card"+d.value,e.cardClass],style:e.cardStyle};if(void 0!==e.cardStyleFn&&(a.style=[a.style,e.cardStyleFn(n.row)]),void 0!==e.cardClassFn){const t=e.cardClassFn(n.row);t&&(a.class[0]+=` ${t}`)}return void 0===e.onRowClick&&void 0===e.onRowDblclick&&void 0===e.onRowContextmenu||(a.class[0]+=" cursor-pointer",void 0!==e.onRowClick&&(a.onClick=e=>{r("RowClick",e,n.row,n.pageIndex)}),void 0!==e.onRowDblclick&&(a.onDblclick=e=>{r("RowDblclick",e,n.row,n.pageIndex)}),void 0!==e.onRowContextmenu&&(a.onContextmenu=e=>{r("rowContextmenu",e,n.row,n.pageIndex)})),h$2("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(!0===n.selected?" q-table__grid-item--selected":"")},[h$2("div",a,i)])};return h$2("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},A.value.map(((e,t)=>n(se({key:l.value(e),row:e,pageIndex:t})))))}();const n=!0!==e.hideHeader?pe:null;if(!0===h.value){const r=t["top-row"],i=t["bottom-row"],o={default:e=>oe(e.item,t.body,e.index)};if(void 0!==r){const e=h$2("tbody",r({cols:$.value}));o.before=null===n?()=>e:()=>[n()].concat(e)}else null!==n&&(o.before=n);return void 0!==i&&(o.after=()=>h$2("tbody",i({cols:$.value}))),h$2(QVirtualScroll,{ref:u,class:e.tableClass,style:e.tableStyle,...te.value,scrollTarget:e.virtualScrollTarget,items:A.value,type:"__qtable",tableColspan:F.value,onVirtualScroll:ne},o)}const i=[ae()];return null!==n&&i.unshift(n()),getTableMiddle({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},i)}function ne(e){r("virtualScroll",e)}function ie(){return[h$2(QLinearProgress,{class:"q-table__linear-progress",color:e.color,dark:o.value,indeterminate:!0,trackColor:"transparent"})]}function oe(n,i,a){const s=l.value(n),c=D(s);if(void 0!==i){const t={key:s,row:n,pageIndex:a,__trClass:c?"selected":""};if(void 0!==e.tableRowStyleFn&&(t.__trStyle=e.tableRowStyleFn(n)),void 0!==e.tableRowClassFn){const r=e.tableRowClassFn(n);r&&(t.__trClass=`${r} ${t.__trClass}`)}return i(se(t))}const u=t["body-cell"],h=$.value.map((e=>{const r=t[`body-cell-${e.name}`],i=void 0!==r?r:u;return void 0!==i?i(function(e){return le(e),injectProp(e,"value",(()=>ce(e.col,e.row))),e}({key:s,row:n,pageIndex:a,col:e})):h$2("td",{class:e.__tdClass(n),style:e.__tdStyle(n)},ce(e,n))}));if(!0===C.value){const r=t["body-selection"],i=void 0!==r?r(function(e){return le(e),e}({key:s,row:n,pageIndex:a})):[h$2(QCheckbox,{modelValue:c,color:e.color,dark:o.value,dense:e.dense,"onUpdate:modelValue":(e,t)=>{L([s],[n],e,t)}})];h.unshift(h$2("td",{class:"q-table--col-auto-width"},i))}const d={key:s,class:{selected:c}};if(void 0!==e.onRowClick&&(d.class["cursor-pointer"]=!0,d.onClick=e=>{r("rowClick",e,n,a)}),void 0!==e.onRowDblclick&&(d.class["cursor-pointer"]=!0,d.onDblclick=e=>{r("rowDblclick",e,n,a)}),void 0!==e.onRowContextmenu&&(d.class["cursor-pointer"]=!0,d.onContextmenu=e=>{r("rowContextmenu",e,n,a)}),void 0!==e.tableRowStyleFn&&(d.style=e.tableRowStyleFn(n)),void 0!==e.tableRowClassFn){const t=e.tableRowClassFn(n);t&&(d.class[t]=!0)}return h$2("tr",d,h)}function ae(){const e=t.body,r=t["top-row"],n=t["bottom-row"];let i=A.value.map(((t,r)=>oe(t,e,r)));return void 0!==r&&(i=r({cols:$.value}).concat(i)),void 0!==n&&(i=i.concat(n({cols:$.value}))),h$2("tbody",i)}function se(e){return le(e),e.cols=e.cols.map((t=>injectProp({...t},"value",(()=>ce(t,e.row))))),e}function le(t){Object.assign(t,{cols:$.value,colsMap:z.value,sort:j,rowIndex:U.value+t.pageIndex,color:e.color,dark:o.value,dense:e.dense}),!0===C.value&&injectProp(t,"selected",(()=>D(t.key)),((e,r)=>{L([t.key],[t.row],e,r)})),injectProp(t,"expand",(()=>w(t.key)),(e=>{S(t.key,e)}))}function ce(e,t){const r="function"==typeof e.field?e.field(t):t[e.field];return void 0!==e.format?e.format(r,t):r}const ue=computed((()=>({pagination:g.value,pagesNumber:H.value,isFirstPage:G.value,isLastPage:W.value,firstPage:X,prevPage:K,nextPage:Q,lastPage:J,inFullscreen:a.value,toggleFullscreen:s})));function he(){const r=t.top,n=t["top-left"],i=t["top-right"],o=t["top-selection"],a=!0===C.value&&void 0!==o&&R.value>0,s="q-table__top relative-position row items-center";if(void 0!==r)return h$2("div",{class:s},[r(ue.value)]);let l;return!0===a?l=o(ue.value).slice():(l=[],void 0!==n?l.push(h$2("div",{class:"q-table__control"},[n(ue.value)])):e.title&&l.push(h$2("div",{class:"q-table__control"},[h$2("div",{class:["q-table__title",e.titleClass]},e.title)]))),void 0!==i&&(l.push(h$2("div",{class:"q-table__separator col"})),l.push(h$2("div",{class:"q-table__control"},[i(ue.value)]))),0!==l.length?h$2("div",{class:s},l):void 0}const de=computed((()=>!0===M.value?null:P.value));function pe(){const r=function(){const r=t.header,n=t["header-cell"];if(void 0!==r)return r(fe({header:!0})).slice();const i=$.value.map((e=>{const r=t[`header-cell-${e.name}`],i=void 0!==r?r:n,o=fe({col:e});return void 0!==i?i(o):h$2(QTh,{key:e.name,props:o},(()=>e.label))}));if(!0===I.value&&!0!==e.grid)i.unshift(h$2("th",{class:"q-table--col-auto-width"}," "));else if(!0===k.value){const r=t["header-selection"],n=void 0!==r?r(fe({})):[h$2(QCheckbox,{color:e.color,modelValue:de.value,dark:o.value,dense:e.dense,"onUpdate:modelValue":me})];i.unshift(h$2("th",{class:"q-table--col-auto-width"},n))}return[h$2("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},i)]}();return!0===e.loading&&void 0===t.loading&&r.push(h$2("tr",{class:"q-table__progress"},[h$2("th",{class:"relative-position",colspan:F.value},ie())])),h$2("thead",r)}function fe(t){return Object.assign(t,{cols:$.value,sort:j,colsMap:z.value,color:e.color,dark:o.value,dense:e.dense}),!0===k.value&&injectProp(t,"selected",(()=>de.value),me),t}function me(e){!0===M.value&&(e=!1),L(A.value.map(l.value),A.value,e)}const ge=computed((()=>{const t=[e.iconFirstPage||i.iconSet.table.firstPage,e.iconPrevPage||i.iconSet.table.prevPage,e.iconNextPage||i.iconSet.table.nextPage,e.iconLastPage||i.iconSet.table.lastPage];return!0===i.lang.rtl?t.reverse():t}));function ye(){if(!0===e.hideBottom)return;if(!0===ee.value){if(!0===e.hideNoData)return;const r=!0===e.loading?e.loadingLabel||i.lang.table.loading:e.filter?e.noResultsLabel||i.lang.table.noResults:e.noDataLabel||i.lang.table.noData,n=t["no-data"],o=void 0!==n?[n({message:r,icon:i.iconSet.table.warning,filter:e.filter})]:[h$2(QIcon,{class:"q-table__bottom-nodata-icon",name:i.iconSet.table.warning}),r];return h$2("div",{class:bottomClass+" q-table__bottom--nodata"},o)}const r=t.bottom;if(void 0!==r)return h$2("div",{class:bottomClass},[r(ue.value)]);const n=!0!==e.hideSelectedBanner&&!0===C.value&&R.value>0?[h$2("div",{class:"q-table__control"},[h$2("div",[(e.selectedRowsLabel||i.lang.table.selectedRecords)(R.value)])])]:[];return!0!==e.hidePagination?h$2("div",{class:bottomClass+" justify-end"},function(r){let n;const{rowsPerPage:a}=g.value,s=e.paginationLabel||i.lang.table.pagination,l=t.pagination,c=e.rowsPerPageOptions.length>1;if(r.push(h$2("div",{class:"q-table__separator col"})),!0===c&&r.push(h$2("div",{class:"q-table__control"},[h$2("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||i.lang.table.recordsPerPage]),h$2(QSelect,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:a,options:Z.value,displayValue:0===a?i.lang.table.allRows:a,dark:o.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":_e})])),void 0!==l)n=l(ue.value);else if(n=[h$2("span",0!==a?{class:"q-table__bottom-item"}:{},[a?s(U.value+1,Math.min(V.value,Y.value),Y.value):s(1,T.value,Y.value)])],0!==a&&H.value>1){const t={color:e.color,round:!0,dense:!0,flat:!0};!0===e.dense&&(t.size="sm"),H.value>2&&n.push(h$2(QBtn,{key:"pgFirst",...t,icon:ge.value[0],disable:G.value,"aria-label":i.lang.pagination.first,onClick:X})),n.push(h$2(QBtn,{key:"pgPrev",...t,icon:ge.value[1],disable:G.value,"aria-label":i.lang.pagination.prev,onClick:K}),h$2(QBtn,{key:"pgNext",...t,icon:ge.value[2],disable:W.value,"aria-label":i.lang.pagination.next,onClick:Q})),H.value>2&&n.push(h$2(QBtn,{key:"pgLast",...t,icon:ge.value[3],disable:W.value,"aria-label":i.lang.pagination.last,onClick:J}))}return r.push(h$2("div",{class:"q-table__control"},n)),r}(n)):0!==n.length?h$2("div",{class:bottomClass},n):void 0}function _e(e){v({page:1,rowsPerPage:e.value})}return Object.assign(n.proxy,{requestServerInteraction:_,setPagination:v,firstPage:X,prevPage:K,nextPage:Q,lastPage:J,isRowSelected:D,clearSelection:O,isRowExpanded:w,setExpanded:x,sort:j,resetVirtualScroll:function(){!0===h.value&&u.value.reset()},scrollTo:function(t,n){if(null!==u.value)return void u.value.scrollTo(t,n);t=parseInt(t,10);const i=c.value.querySelector(`tbody tr:nth-of-type(${t+1})`);if(null!==i){const n=c.value.querySelector(".q-table__middle.scroll"),o=i.offsetTop-e.virtualScrollStickySizeStart,a=o<n.scrollTop?"decrease":"increase";n.scrollTop=o,r("virtualScroll",{index:t,from:0,to:m.value.rowsPerPage-1,direction:a})}},getCellValue:ce}),injectMultipleProps(n.proxy,{filteredSortedRows:()=>E.value,computedRows:()=>A.value,computedRowsNumber:()=>Y.value}),()=>{const r=[he()],n={ref:c,class:f.value};return!0===e.grid?r.push(function(){const r=!0===e.gridHeader?[h$2("table",{class:"q-table"},[pe()])]:!0===e.loading&&void 0===t.loading?ie():void 0;return h$2("div",{class:"q-table__middle"},r)}()):Object.assign(n,{class:[n.class,e.cardClass],style:e.cardStyle}),r.push(re(),ye()),!0===e.loading&&void 0!==t.loading&&r.push(t.loading()),h$2("div",n,r)}}}),QForm=createComponent({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:r}){const n=getCurrentInstance(),i=ref$1(null);let o=0;const a=[];function s(t){const n="boolean"==typeof t?t:!0!==e.noErrorFocus,i=++o,s=(e,t)=>{r("validation"+(!0===e?"Success":"Error"),t)},l=e=>{const t=e.validate();return"function"==typeof t.then?t.then((t=>({valid:t,comp:e})),(t=>({valid:!1,comp:e,err:t}))):Promise.resolve({valid:t,comp:e})};return(!0===e.greedy?Promise.all(a.map(l)).then((e=>e.filter((e=>!0!==e.valid)))):a.reduce(((e,t)=>e.then((()=>l(t).then((e=>{if(!1===e.valid)return Promise.reject(e)}))))),Promise.resolve()).catch((e=>[e]))).then((e=>{if(void 0===e||0===e.length)return i===o&&s(!0),!0;if(i===o){const{comp:t,err:r}=e[0];if(s(!1,t),!0===n){const t=e.find((({comp:e})=>"function"==typeof e.focus&&!1===vmIsDestroyed(e.$)));void 0!==t&&t.comp.focus()}}return!1}))}function l(){o++,a.forEach((e=>{"function"==typeof e.resetValidation&&e.resetValidation()}))}function c(t){void 0!==t&&stopAndPrevent$1(t);const n=o+1;s().then((i=>{n===o&&!0===i&&(void 0!==e.onSubmit?r("submit",t):void 0!==t?.target&&"function"==typeof t.target.submit&&t.target.submit())}))}function u(t){void 0!==t&&stopAndPrevent$1(t),r("reset"),nextTick((()=>{l(),!0===e.autofocus&&!0!==e.noResetFocus&&h()}))}function h(){addFocusFn((()=>{if(null===i.value)return;const e=i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),(e=>-1!==e.tabIndex));e?.focus({preventScroll:!0})}))}provide(formKey,{bindComponent(e){a.push(e)},unbindComponent(e){const t=a.indexOf(e);-1!==t&&a.splice(t,1)}});let d=!1;return onDeactivated((()=>{d=!0})),onActivated((()=>{!0===d&&!0===e.autofocus&&h()})),onMounted((()=>{!0===e.autofocus&&h()})),Object.assign(n.proxy,{validate:s,resetValidation:l,submit:c,reset:u,focus:h,getValidationComponents:()=>a}),()=>h$2("form",{class:"q-form",ref:i,onSubmit:c,onReset:u},hSlot(t.default))}});function useQuasar(){return inject(quasarKey)}const markerPrefixClass="q-slider__marker-labels",defaultMarkerConvertFn=e=>({value:e}),defaultMarkerLabelRenderFn=({marker:e})=>h$2("div",{key:e.value,style:e.style,class:e.classes},e.label),keyCodes=[34,37,40,33,39,38],useSliderProps={...useDarkProps,...useFormProps,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:e=>e>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},useSliderEmits=["pan","update:modelValue","change"];function useSlider({updateValue:e,updatePosition:t,getDragging:r,formAttrs:n}){const{props:i,emit:o,slots:a,proxy:{$q:s}}=getCurrentInstance(),l=useDark(i,s),c=useFormInject(n),u=ref$1(!1),h=ref$1(!1),d=ref$1(!1),p=ref$1(!1),f=computed((()=>!0===i.vertical?"--v":"--h")),m=computed((()=>"-"+(!0===i.switchLabelSide?"switched":"standard"))),g=computed((()=>!0===i.vertical?!0===i.reverse:i.reverse!==(!0===s.lang.rtl))),y=computed((()=>!0===isNaN(i.innerMin)||i.innerMin<i.min?i.min:i.innerMin)),_=computed((()=>!0===isNaN(i.innerMax)||i.innerMax>i.max?i.max:i.innerMax)),v=computed((()=>!0!==i.disable&&!0!==i.readonly&&y.value<_.value)),b=computed((()=>{if(0===i.step)return e=>e;const e=(String(i.step).trim().split(".")[1]||"").length;return t=>parseFloat(t.toFixed(e))})),w=computed((()=>0===i.step?1:i.step)),x=computed((()=>!0===v.value?i.tabindex||0:-1)),S=computed((()=>i.max-i.min)),E=computed((()=>_.value-y.value)),T=computed((()=>W(y.value))),A=computed((()=>W(_.value))),C=computed((()=>!0===i.vertical?!0===g.value?"bottom":"top":!0===g.value?"right":"left")),I=computed((()=>!0===i.vertical?"height":"width")),k=computed((()=>!0===i.vertical?"width":"height")),P=computed((()=>!0===i.vertical?"vertical":"horizontal")),M=computed((()=>{const e={role:"slider","aria-valuemin":y.value,"aria-valuemax":_.value,"aria-orientation":P.value,"data-step":i.step};return!0===i.disable?e["aria-disabled"]="true":!0===i.readonly&&(e["aria-readonly"]="true"),e})),R=computed((()=>`q-slider q-slider${f.value} q-slider--${!0===u.value?"":"in"}active inline no-wrap `+(!0===i.vertical?"row":"column")+(!0===i.disable?" disabled":" q-slider--enabled"+(!0===v.value?" q-slider--editable":""))+("both"===d.value?" q-slider--focus":"")+(i.label||!0===i.labelAlways?" q-slider--label":"")+(!0===i.labelAlways?" q-slider--label-always":"")+(!0===l.value?" q-slider--dark":"")+(!0===i.dense?" q-slider--dense q-slider--dense"+f.value:"")));function D(e){const t="q-slider__"+e;return`${t} ${t}${f.value} ${t}${f.value}${m.value}`}function O(e){const t="q-slider__"+e;return`${t} ${t}${f.value}`}const L=computed((()=>{const e=i.selectionColor||i.color;return"q-slider__selection absolute"+(void 0!==e?` text-${e}`:"")})),B=computed((()=>O("markers")+" absolute overflow-hidden")),$=computed((()=>O("track-container"))),z=computed((()=>D("pin"))),F=computed((()=>D("label"))),q=computed((()=>D("text-container"))),N=computed((()=>D("marker-labels-container")+(void 0!==i.markerLabelsClass?` ${i.markerLabelsClass}`:""))),j=computed((()=>"q-slider__track relative-position no-outline"+(void 0!==i.trackColor?` bg-${i.trackColor}`:""))),U=computed((()=>{const e={[k.value]:i.trackSize};return void 0!==i.trackImg&&(e.backgroundImage=`url(${i.trackImg}) !important`),e})),V=computed((()=>"q-slider__inner absolute"+(void 0!==i.innerTrackColor?` bg-${i.innerTrackColor}`:""))),G=computed((()=>{const e=A.value-T.value,t={[C.value]:100*T.value+"%",[I.value]:0===e?"2px":100*e+"%"};return void 0!==i.innerTrackImg&&(t.backgroundImage=`url(${i.innerTrackImg}) !important`),t}));function W(e){return 0===S.value?0:(e-i.min)/S.value}const H=computed((()=>!0===isNumber$2(i.markers)?i.markers:w.value)),Z=computed((()=>{const e=[],t=H.value,r=i.max;let n=i.min;do{e.push(n),n+=t}while(n<r);return e.push(r),e})),Y=computed((()=>{const e=` ${markerPrefixClass}${f.value}-`;return markerPrefixClass+`${e}${!0===i.switchMarkerLabelsSide?"switched":"standard"}${e}${!0===g.value?"rtl":"ltr"}`})),X=computed((()=>!1===i.markerLabels?null:function(e){if(!1===e)return null;if(!0===e)return Z.value.map(defaultMarkerConvertFn);if("function"==typeof e)return Z.value.map((t=>{const r=e(t);return!0===isObject$2(r)?{...r,value:t}:{value:t,label:r}}));const t=({value:e})=>e>=i.min&&e<=i.max;if(!0===Array.isArray(e))return e.map((e=>!0===isObject$2(e)?e:{value:e})).filter(t);return Object.keys(e).map((t=>{const r=e[t],n=Number(t);return!0===isObject$2(r)?{...r,value:n}:{value:n,label:r}})).filter(t)}(i.markerLabels).map(((e,t)=>({index:t,value:e.value,label:e.label||e.value,classes:Y.value+(void 0!==e.classes?" "+e.classes:""),style:{...J(e.value),...e.style||{}}}))))),K=computed((()=>({markerList:X.value,markerMap:ee.value,classes:Y.value,getStyle:J}))),Q=computed((()=>{const e=0===E.value?"2px":100*H.value/E.value;return{...G.value,backgroundSize:!0===i.vertical?`2px ${e}%`:`${e}% 2px`}}));function J(e){return{[C.value]:100*(e-i.min)/S.value+"%"}}const ee=computed((()=>{if(!1===i.markerLabels)return null;const e={};return X.value.forEach((t=>{e[t.value]=t})),e}));const te=computed((()=>[[TouchPan,re,void 0,{[P.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]));function re(n){!0===n.isFinal?(void 0!==p.value&&(t(n.evt),!0===n.touch&&e(!0),p.value=void 0,o("pan","end")),u.value=!1,d.value=!1):!0===n.isFirst?(p.value=r(n.evt),t(n.evt),e(),u.value=!0,o("pan","start")):(t(n.evt),e())}function ne(){d.value=!1}function ie(){h.value=!1,u.value=!1,e(!0),ne(),document.removeEventListener("mouseup",ie,!0)}return onBeforeUnmount((()=>{document.removeEventListener("mouseup",ie,!0)})),{state:{active:u,focus:d,preventFocus:h,dragging:p,editable:v,classes:R,tabindex:x,attributes:M,roundValueFn:b,keyStep:w,trackLen:S,innerMin:y,innerMinRatio:T,innerMax:_,innerMaxRatio:A,positionProp:C,sizeProp:I,isReversed:g},methods:{onActivate:function(n){t(n,r(n)),e(),h.value=!0,u.value=!0,document.addEventListener("mouseup",ie,!0)},onMobileClick:function(n){t(n,r(n)),e(!0)},onBlur:ne,onKeyup:function(t){keyCodes.includes(t.keyCode)&&e(!0)},getContent:function(e,t,r,n){const o=[];"transparent"!==i.innerTrackColor&&o.push(h$2("div",{key:"inner",class:V.value,style:G.value})),"transparent"!==i.selectionColor&&o.push(h$2("div",{key:"selection",class:L.value,style:e.value})),!1!==i.markers&&o.push(h$2("div",{key:"marker",class:B.value,style:Q.value})),n(o);const s=[hDir("div",{key:"trackC",class:$.value,tabindex:t.value,...r.value},[h$2("div",{class:j.value,style:U.value},o)],"slide",v.value,(()=>te.value))];if(!1!==i.markerLabels){s[!0===i.switchMarkerLabelsSide?"unshift":"push"](h$2("div",{key:"markerL",class:N.value},function(){if(void 0!==a["marker-label-group"])return a["marker-label-group"](K.value);const e=a["marker-label"]||defaultMarkerLabelRenderFn;return X.value.map((t=>e({marker:t,...K.value})))}()))}return s},getThumbRenderFn:function(e){const t=computed((()=>!1!==h.value||d.value!==e.focusValue&&"both"!==d.value?"":" q-slider--focus")),r=computed((()=>`q-slider__thumb q-slider__thumb${f.value} q-slider__thumb${f.value}-${!0===g.value?"rtl":"ltr"} absolute non-selectable`+t.value+(void 0!==e.thumbColor.value?` text-${e.thumbColor.value}`:""))),n=computed((()=>({width:i.thumbSize,height:i.thumbSize,[C.value]:100*e.ratio.value+"%",zIndex:d.value===e.focusValue?2:void 0}))),o=computed((()=>void 0!==e.labelColor.value?` text-${e.labelColor.value}`:"")),a=computed((()=>function(e){if(!0===i.vertical)return null;const t=s.lang.rtl!==i.reverse?1-e:e;return{transform:`translateX(calc(${2*t-1} * ${i.thumbSize} / 2 + ${50-100*t}%))`}}(e.ratio.value))),l=computed((()=>"q-slider__text"+(void 0!==e.labelTextColor.value?` text-${e.labelTextColor.value}`:"")));return()=>{const t=[h$2("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[h$2("path",{d:i.thumbPath})]),h$2("div",{class:"q-slider__focus-ring fit"})];return!0!==i.label&&!0!==i.labelAlways||(t.push(h$2("div",{class:z.value+" absolute fit no-pointer-events"+o.value},[h$2("div",{class:F.value,style:{minWidth:i.thumbSize}},[h$2("div",{class:q.value,style:a.value},[h$2("span",{class:l.value},e.label.value)])])])),void 0!==i.name&&!0!==i.disable&&c(t,"push")),h$2("div",{class:r.value,style:n.value,...e.getNodeData()},t)}},convertRatioToModel:function(e){const{min:t,max:r,step:n}=i;let o=t+e*(r-t);if(n>0){const e=(o-y.value)%n;o+=(Math.abs(e)>=n/2?(e<0?-1:1)*n:0)-e}return o=b.value(o),between$1(o,y.value,_.value)},convertModelToRatio:W,getDraggingRatio:function(e,t){const r=position(e),n=!0===i.vertical?between$1((r.top-t.top)/t.height,0,1):between$1((r.left-t.left)/t.width,0,1);return between$1(!0===g.value?1-n:n,T.value,A.value)}}}}const getNodeData=()=>({}),QSlider=createComponent({name:"QSlider",props:{...useSliderProps,modelValue:{required:!0,default:null,validator:e=>"number"==typeof e||null===e},labelValue:[String,Number]},emits:useSliderEmits,setup(e,{emit:t}){const{proxy:{$q:r}}=getCurrentInstance(),{state:n,methods:i}=useSlider({updateValue:f,updatePosition:function(t,r=n.dragging.value){const o=i.getDraggingRatio(t,r);s.value=i.convertRatioToModel(o),a.value=!0!==e.snap||0===e.step?o:i.convertModelToRatio(s.value)},getDragging:function(){return o.value.getBoundingClientRect()},formAttrs:useFormAttrs(e)}),o=ref$1(null),a=ref$1(0),s=ref$1(0);function l(){s.value=null===e.modelValue?n.innerMin.value:between$1(e.modelValue,n.innerMin.value,n.innerMax.value)}watch$2((()=>`${e.modelValue}|${n.innerMin.value}|${n.innerMax.value}`),l),l();const c=computed((()=>i.convertModelToRatio(s.value))),u=computed((()=>!0===n.active.value?a.value:c.value)),h=computed((()=>{const t={[n.positionProp.value]:100*n.innerMinRatio.value+"%",[n.sizeProp.value]:100*(u.value-n.innerMinRatio.value)+"%"};return void 0!==e.selectionImg&&(t.backgroundImage=`url(${e.selectionImg}) !important`),t})),d=i.getThumbRenderFn({focusValue:!0,getNodeData:getNodeData,ratio:u,label:computed((()=>void 0!==e.labelValue?e.labelValue:s.value)),thumbColor:computed((()=>e.thumbColor||e.color)),labelColor:computed((()=>e.labelColor)),labelTextColor:computed((()=>e.labelTextColor))}),p=computed((()=>!0!==n.editable.value?{}:!0===r.platform.is.mobile?{onClick:i.onMobileClick}:{onMousedown:i.onActivate,onFocus:m,onBlur:i.onBlur,onKeydown:g,onKeyup:i.onKeyup}));function f(r){s.value!==e.modelValue&&t("update:modelValue",s.value),!0===r&&t("change",s.value)}function m(){n.focus.value=!0}function g(t){if(!1===keyCodes.includes(t.keyCode))return;stopAndPrevent$1(t);const r=([34,33].includes(t.keyCode)?10:1)*n.keyStep.value,i=([34,37,40].includes(t.keyCode)?-1:1)*(!0===n.isReversed.value?-1:1)*(!0===e.vertical?-1:1)*r;s.value=between$1(n.roundValueFn.value(s.value+i),n.innerMin.value,n.innerMax.value),f()}return()=>{const t=i.getContent(h,n.tabindex,p,(e=>{e.push(d())}));return h$2("div",{ref:o,class:n.classes.value+(null===e.modelValue?" q-slider--no-value":""),...n.attributes.value,"aria-valuenow":e.modelValue},t)}}});function getIndicatorClass(e,t,r){const n=!0===r?["left","right"]:["top","bottom"];return`absolute-${!0===t?n[0]:n[1]}${e?` text-${e}`:""}`}const alignValues$1=["left","center","right","justify"],QTabs=createComponent({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>alignValues$1.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:r}){const{proxy:n}=getCurrentInstance(),{$q:i}=n,{registerTick:o}=useTick(),{registerTick:a}=useTick(),{registerTick:s}=useTick(),{registerTimeout:l,removeTimeout:c}=useTimeout(),{registerTimeout:u,removeTimeout:h}=useTimeout(),d=ref$1(null),p=ref$1(null),f=ref$1(e.modelValue),m=ref$1(!1),g=ref$1(!0),y=ref$1(!1),_=ref$1(!1),v=[],b=ref$1(0),w=ref$1(!1);let x,S=null,E=null;const T=computed((()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:getIndicatorClass(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps}))),A=computed((()=>{const e=b.value,t=f.value;for(let r=0;r<e;r++)if(v[r].name.value===t)return!0;return!1})),C=computed((()=>`q-tabs__content--align-${!0===m.value?"left":!0===_.value?"justify":e.align}`)),I=computed((()=>`q-tabs row no-wrap items-center q-tabs--${!0===m.value?"":"not-"}scrollable q-tabs--${!0===e.vertical?"vertical":"horizontal"} q-tabs__arrows--${!0===e.outsideArrows?"outside":"inside"} q-tabs--mobile-with${!0===e.mobileArrows?"":"out"}-arrows`+(!0===e.dense?" q-tabs--dense":"")+(!0===e.shrink?" col-shrink":"")+(!0===e.stretch?" self-stretch":""))),k=computed((()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+C.value+(void 0!==e.contentClass?` ${e.contentClass}`:""))),P=computed((()=>!0===e.vertical?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"})),M=computed((()=>!0!==e.vertical&&!0===i.lang.rtl)),R=computed((()=>!1===rtlHasScrollBug&&!0===M.value));function D({name:t,setCurrent:n,skipEmit:i}){f.value!==t&&(!0!==i&&void 0!==e["onUpdate:modelValue"]&&r("update:modelValue",t),!0!==n&&void 0!==e["onUpdate:modelValue"]||(!function(t,r){const n=null!=t&&""!==t?v.find((e=>e.name.value===t)):null,i=null!=r&&""!==r?v.find((e=>e.name.value===r)):null;if(!0===Q)Q=!1;else if(n&&i){const t=n.tabIndicatorRef.value,r=i.tabIndicatorRef.value;null!==S&&(clearTimeout(S),S=null),t.style.transition="none",t.style.transform="none",r.style.transition="none",r.style.transform="none";const o=t.getBoundingClientRect(),a=r.getBoundingClientRect();r.style.transform=!0===e.vertical?`translate3d(0,${o.top-a.top}px,0) scale3d(1,${a.height?o.height/a.height:1},1)`:`translate3d(${o.left-a.left}px,0,0) scale3d(${a.width?o.width/a.width:1},1,1)`,s((()=>{S=setTimeout((()=>{S=null,r.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",r.style.transform="none"}),70)}))}i&&!0===m.value&&B(i.rootRef.value)}(f.value,t),f.value=t))}function O(){o((()=>{d.value&&L({width:d.value.offsetWidth,height:d.value.offsetHeight})}))}function L(t){if(void 0===P.value||null===p.value)return;const r=t[P.value.container],n=Math.min(p.value[P.value.scroll],Array.prototype.reduce.call(p.value.children,((e,t)=>e+(t[P.value.content]||0)),0)),i=r>0&&n>r;m.value=i,!0===i&&a($),_.value=r<parseInt(e.breakpoint,10)}function B(t){const{left:r,width:n,top:i,height:o}=p.value.getBoundingClientRect(),a=t.getBoundingClientRect();let s=!0===e.vertical?a.top-i:a.left-r;if(s<0)return p.value[!0===e.vertical?"scrollTop":"scrollLeft"]+=Math.floor(s),void $();s+=!0===e.vertical?a.height-o:a.width-n,s>0&&(p.value[!0===e.vertical?"scrollTop":"scrollLeft"]+=Math.ceil(s),$())}function $(){const t=p.value;if(null===t)return;const r=t.getBoundingClientRect(),n=!0===e.vertical?t.scrollTop:Math.abs(t.scrollLeft);!0===M.value?(g.value=Math.ceil(n+r.width)<t.scrollWidth-1,y.value=n>0):(g.value=n>0,y.value=!0===e.vertical?Math.ceil(n+r.height)<t.scrollHeight:Math.ceil(n+r.width)<t.scrollWidth)}function z(e){null!==E&&clearInterval(E),E=setInterval((()=>{!0===function(e){const t=p.value,{get:r,set:n}=j.value;let i=!1,o=r(t);const a=e<o?-1:1;o+=5*a,o<0?(i=!0,o=0):(-1===a&&o<=e||1===a&&o>=e)&&(i=!0,o=e);return n(t,o),$(),i}(e)&&N()}),5)}function F(){z(!0===R.value?Number.MAX_SAFE_INTEGER:0)}function q(){z(!0===R.value?0:Number.MAX_SAFE_INTEGER)}function N(){null!==E&&(clearInterval(E),E=null)}watch$2(M,$),watch$2((()=>e.modelValue),(e=>{D({name:e,setCurrent:!0,skipEmit:!0})})),watch$2((()=>e.outsideArrows),O);const j=computed((()=>!0===R.value?{get:e=>Math.abs(e.scrollLeft),set:(e,t)=>{e.scrollLeft=-t}}:!0===e.vertical?{get:e=>e.scrollTop,set:(e,t)=>{e.scrollTop=t}}:{get:e=>e.scrollLeft,set:(e,t)=>{e.scrollLeft=t}}));function U(e,t){for(const r in e)if(e[r]!==t[r])return!1;return!0}function V(){let e=null,t={matchedLen:0,queryDiff:9999,hrefLen:0};const r=v.filter((e=>!0===e.routeData?.hasRouterLink.value)),{hash:i,query:o}=n.$route,a=Object.keys(o).length;for(const n of r){const r=!0===n.routeData.exact.value;if(!0!==n.routeData[!0===r?"linkIsExactActive":"linkIsActive"].value)continue;const{hash:s,query:l,matched:c,href:u}=n.routeData.resolvedLink.value,h=Object.keys(l).length;if(!0===r){if(s!==i)continue;if(h!==a||!1===U(o,l))continue;e=n.name.value;break}if(""!==s&&s!==i)continue;if(0!==h&&!1===U(l,o))continue;const d={matchedLen:c.length,queryDiff:a-h,hrefLen:u.length-s.length};if(d.matchedLen>t.matchedLen)e=n.name.value,t=d;else if(d.matchedLen===t.matchedLen){if(d.queryDiff<t.queryDiff)e=n.name.value,t=d;else if(d.queryDiff!==t.queryDiff)continue;d.hrefLen>t.hrefLen&&(e=n.name.value,t=d)}}null!==e||!0!==v.some((e=>void 0===e.routeData&&e.name.value===f.value))?D({name:e,setCurrent:!0}):Q=!1}function G(e){if(c(),!0!==w.value&&null!==d.value&&e.target&&"function"==typeof e.target.closest){const t=e.target.closest(".q-tab");t&&!0===d.value.contains(t)&&(w.value=!0,!0===m.value&&B(t))}}function W(){l((()=>{w.value=!1}),30)}function H(){!1===Y.avoidRouteWatcher?u(V):h()}function Z(){if(void 0===x){const e=watch$2((()=>n.$route.fullPath),H);x=()=>{e(),x=void 0}}}const Y={currentModel:f,tabProps:T,hasFocus:w,hasActiveTab:A,registerTab:function(e){v.push(e),b.value++,O(),void 0===e.routeData||void 0===n.$route?u((()=>{if(!0===m.value){const e=f.value,t=null!=e&&""!==e?v.find((t=>t.name.value===e)):null;t&&B(t.rootRef.value)}})):(Z(),!0===e.routeData.hasRouterLink.value&&H())},unregisterTab:function(e){v.splice(v.indexOf(e),1),b.value--,O(),void 0!==x&&void 0!==e.routeData&&(!0===v.every((e=>void 0===e.routeData))&&x(),H())},verifyRouteModel:H,updateModel:D,onKbdNavigate:function(t,r){const n=Array.prototype.filter.call(p.value.children,(e=>e===r||e.matches&&!0===e.matches(".q-tab.q-focusable"))),i=n.length;if(0===i)return;if(36===t)return B(n[0]),n[0].focus(),!0;if(35===t)return B(n[i-1]),n[i-1].focus(),!0;const o=t===(!0===e.vertical?38:37),a=t===(!0===e.vertical?40:39),s=!0===o?-1:!0===a?1:void 0;if(void 0!==s){const e=!0===M.value?-1:1,t=n.indexOf(r)+s*e;return t>=0&&t<i&&(B(n[t]),n[t].focus({preventScroll:!0})),!0}},avoidRouteWatcher:!1};function X(){null!==S&&clearTimeout(S),N(),x?.()}let K,Q;return provide(tabsKey,Y),onBeforeUnmount(X),onDeactivated((()=>{K=void 0!==x,X()})),onActivated((()=>{!0===K&&(Z(),Q=!0,H()),O()})),()=>h$2("div",{ref:d,class:I.value,role:"tablist",onFocusin:G,onFocusout:W},[h$2(QResizeObserver,{onResize:L}),h$2("div",{ref:p,class:k.value,onScroll:$},hSlot(t.default)),h$2(QIcon,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(!0===g.value?"":" q-tabs__arrow--faded"),name:e.leftIcon||i.iconSet.tabs[!0===e.vertical?"up":"left"],onMousedownPassive:F,onTouchstartPassive:F,onMouseupPassive:N,onMouseleavePassive:N,onTouchendPassive:N}),h$2(QIcon,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(!0===y.value?"":" q-tabs__arrow--faded"),name:e.rightIcon||i.iconSet.tabs[!0===e.vertical?"down":"right"],onMousedownPassive:q,onTouchstartPassive:q,onMouseupPassive:N,onMouseleavePassive:N,onTouchendPassive:N})])}});let id$e=0;const useTabEmits=["click","keydown"],useTabProps={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>"t_"+id$e++},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function useTab(e,t,r,n){const i=inject(tabsKey,emptyRenderFn);if(i===emptyRenderFn)return emptyRenderFn;const{proxy:o}=getCurrentInstance(),a=ref$1(null),s=ref$1(null),l=ref$1(null),c=computed((()=>!0!==e.disable&&!1!==e.ripple&&Object.assign({keyCodes:[13,32],early:!0},!0===e.ripple?{}:e.ripple))),u=computed((()=>i.currentModel.value===e.name)),h=computed((()=>"q-tab relative-position self-stretch flex flex-center text-center"+(!0===u.value?" q-tab--active"+(i.tabProps.value.activeClass?" "+i.tabProps.value.activeClass:"")+(i.tabProps.value.activeColor?` text-${i.tabProps.value.activeColor}`:"")+(i.tabProps.value.activeBgColor?` bg-${i.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&!1===i.tabProps.value.inlineLabel?" q-tab--full":"")+(!0===e.noCaps||!0===i.tabProps.value.noCaps?" q-tab--no-caps":"")+(!0===e.disable?" disabled":" q-focusable q-hoverable cursor-pointer")+(void 0!==n?n.linkClass.value:""))),d=computed((()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(!0===i.tabProps.value.inlineLabel?"row no-wrap q-tab__content--inline":"column")+(void 0!==e.contentClass?` ${e.contentClass}`:""))),p=computed((()=>!0===e.disable||!0===i.hasFocus.value||!1===u.value&&!0===i.hasActiveTab.value?-1:e.tabindex||0));function f(t,o){if(!0!==o&&!0!==t?.qAvoidFocus&&a.value?.focus(),!0!==e.disable){if(void 0===n)return i.updateModel({name:e.name}),void r("click",t);if(!0===n.hasRouterLink.value){const o=(r={})=>{let o;const a=void 0===r.to||!0===isDeepEqual(r.to,e.to)?i.avoidRouteWatcher=uid$3():null;return n.navigateToRouterLink(t,{...r,returnRouterError:!0}).catch((e=>{o=e})).then((t=>{if(a===i.avoidRouteWatcher&&(i.avoidRouteWatcher=!1,void 0!==o||void 0!==t&&!0!==t.message?.startsWith("Avoided redundant navigation")||i.updateModel({name:e.name})),!0===r.returnRouterError)return void 0!==o?Promise.reject(o):t}))};return r("click",t,o),void(!0!==t.defaultPrevented&&o())}r("click",t)}else!0===n?.hasRouterLink.value&&stopAndPrevent$1(t)}function m(e){isKeyCode(e,[13,32])?f(e,!0):!0!==shouldIgnoreKey(e)&&e.keyCode>=35&&e.keyCode<=40&&!0!==e.altKey&&!0!==e.metaKey&&!0===i.onKbdNavigate(e.keyCode,o.$el)&&stopAndPrevent$1(e),r("keydown",e)}const g={name:computed((()=>e.name)),rootRef:s,tabIndicatorRef:l,routeData:n};return onBeforeUnmount((()=>{i.unregisterTab(g)})),onMounted((()=>{i.registerTab(g)})),{renderTab:function(r,n){const o={ref:s,class:h.value,tabindex:p.value,role:"tab","aria-selected":!0===u.value?"true":"false","aria-disabled":!0===e.disable?"true":void 0,onClick:f,onKeydown:m,...n};return withDirectives(h$2(r,o,function(){const r=i.tabProps.value.narrowIndicator,n=[],o=h$2("div",{ref:l,class:["q-tab__indicator",i.tabProps.value.indicatorClass]});void 0!==e.icon&&n.push(h$2(QIcon,{class:"q-tab__icon",name:e.icon})),void 0!==e.label&&n.push(h$2("div",{class:"q-tab__label"},e.label)),!1!==e.alert&&n.push(void 0!==e.alertIcon?h$2(QIcon,{class:"q-tab__alert-icon",color:!0!==e.alert?e.alert:void 0,name:e.alertIcon}):h$2("div",{class:"q-tab__alert"+(!0!==e.alert?` text-${e.alert}`:"")})),!0===r&&n.push(o);const s=[h$2("div",{class:"q-focus-helper",tabindex:-1,ref:a}),h$2("div",{class:d.value},hMergeSlot(t.default,n))];return!1===r&&s.push(o),s}()),[[Ripple,c.value]])},$tabs:i}}const QTab=createComponent({name:"QTab",props:useTabProps,emits:useTabEmits,setup(e,{slots:t,emit:r}){const{renderTab:n}=useTab(e,t,r);return()=>n("div")}});function parseArg(e){const t=[.06,6,50];return"string"==typeof e&&e.length&&e.split(":").forEach(((e,r)=>{const n=parseFloat(e);n&&(t[r]=n)})),t}const TouchSwipe=createDirective({name:"touch-swipe",beforeMount(e,{value:t,arg:r,modifiers:n}){if(!0!==n.mouse&&!0!==client.has.touch)return;const i=!0===n.mouseCapture?"Capture":"",o={handler:t,sensitivity:parseArg(r),direction:getModifierDirections(n),noop:noop$2,mouseStart(e){shouldStart(e,o)&&leftClick(e)&&(addEvt(o,"temp",[[document,"mousemove","move",`notPassive${i}`],[document,"mouseup","end","notPassiveCapture"]]),o.start(e,!0))},touchStart(e){if(shouldStart(e,o)){const t=e.target;addEvt(o,"temp",[[t,"touchmove","move","notPassiveCapture"],[t,"touchcancel","end","notPassiveCapture"],[t,"touchend","end","notPassiveCapture"]]),o.start(e)}},start(t,r){!0===client.is.firefox&&preventDraggable(e,!0);const n=position(t);o.event={x:n.left,y:n.top,time:Date.now(),mouse:!0===r,dir:!1}},move(e){if(void 0===o.event)return;if(!1!==o.event.dir)return void stopAndPrevent$1(e);const t=Date.now()-o.event.time;if(0===t)return;const r=position(e),n=r.left-o.event.x,i=Math.abs(n),a=r.top-o.event.y,s=Math.abs(a);if(!0!==o.event.mouse){if(i<o.sensitivity[1]&&s<o.sensitivity[1])return void o.end(e)}else{if(""!==window.getSelection().toString())return void o.end(e);if(i<o.sensitivity[2]&&s<o.sensitivity[2])return}const l=i/t,c=s/t;!0===o.direction.vertical&&i<s&&i<100&&c>o.sensitivity[0]&&(o.event.dir=a<0?"up":"down"),!0===o.direction.horizontal&&i>s&&s<100&&l>o.sensitivity[0]&&(o.event.dir=n<0?"left":"right"),!0===o.direction.up&&i<s&&a<0&&i<100&&c>o.sensitivity[0]&&(o.event.dir="up"),!0===o.direction.down&&i<s&&a>0&&i<100&&c>o.sensitivity[0]&&(o.event.dir="down"),!0===o.direction.left&&i>s&&n<0&&s<100&&l>o.sensitivity[0]&&(o.event.dir="left"),!0===o.direction.right&&i>s&&n>0&&s<100&&l>o.sensitivity[0]&&(o.event.dir="right"),!1!==o.event.dir?(stopAndPrevent$1(e),!0===o.event.mouse&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),clearSelection(),o.styleCleanup=e=>{o.styleCleanup=void 0,document.body.classList.remove("non-selectable");const t=()=>{document.body.classList.remove("no-pointer-events--children")};!0===e?setTimeout(t,50):t()}),o.handler({evt:e,touch:!0!==o.event.mouse,mouse:o.event.mouse,direction:o.event.dir,duration:t,distance:{x:i,y:s}})):o.end(e)},end(t){void 0!==o.event&&(cleanEvt(o,"temp"),!0===client.is.firefox&&preventDraggable(e,!1),o.styleCleanup?.(!0),void 0!==t&&!1!==o.event.dir&&stopAndPrevent$1(t),o.event=void 0)}};if(e.__qtouchswipe=o,!0===n.mouse){const t=!0===n.mouseCapture||!0===n.mousecapture?"Capture":"";addEvt(o,"main",[[e,"mousedown","mouseStart",`passive${t}`]])}!0===client.has.touch&&addEvt(o,"main",[[e,"touchstart","touchStart","passive"+(!0===n.capture?"Capture":"")],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const r=e.__qtouchswipe;void 0!==r&&(t.oldValue!==t.value&&("function"!=typeof t.value&&r.end(),r.handler=t.value),r.direction=getModifierDirections(t.modifiers))},beforeUnmount(e){const t=e.__qtouchswipe;void 0!==t&&(cleanEvt(t,"main"),cleanEvt(t,"temp"),!0===client.is.firefox&&preventDraggable(e,!1),t.styleCleanup?.(),delete e.__qtouchswipe)}});function useRenderCache(){let e=Object.create(null);return{getCache:(t,r)=>void 0===e[t]?e[t]="function"==typeof r?r():r:e[t],setCache(t,r){e[t]=r},hasCache:t=>Object.hasOwnProperty.call(e,t),clearCache(t){void 0!==t?delete e[t]:e=Object.create(null)}}}const usePanelChildProps={name:{required:!0},disable:Boolean},PanelWrapper={setup:(e,{slots:t})=>()=>h$2("div",{class:"q-panel scroll",role:"tabpanel"},hSlot(t.default))},usePanelProps={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},usePanelEmits=["update:modelValue","beforeTransition","transition"];function usePanel(){const{props:e,emit:t,proxy:r}=getCurrentInstance(),{getCache:n}=useRenderCache(),{registerTimeout:i}=useTimeout();let o,a;const s=ref$1(null),l={value:null};function c(t){const n=!0===e.vertical?"up":"left";S((!0===r.$q.lang.rtl?-1:1)*(t.direction===n?1:-1))}const u=computed((()=>[[TouchSwipe,c,void 0,{horizontal:!0!==e.vertical,vertical:e.vertical,mouse:!0}]])),h=computed((()=>e.transitionPrev||"slide-"+(!0===e.vertical?"down":"right"))),d=computed((()=>e.transitionNext||"slide-"+(!0===e.vertical?"up":"left"))),p=computed((()=>`--q-transition-duration: ${e.transitionDuration}ms`)),f=computed((()=>"string"==typeof e.modelValue||"number"==typeof e.modelValue?e.modelValue:String(e.modelValue))),m=computed((()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax}))),g=computed((()=>void 0!==e.keepAliveInclude||void 0!==e.keepAliveExclude));function y(){S(1)}function _(){S(-1)}function v(e){t("update:modelValue",e)}function b(e){return null!=e&&""!==e}function w(e){return o.findIndex((t=>t.props.name===e&&""!==t.props.disable&&!0!==t.props.disable))}function x(t){const r=0!==t&&!0===e.animated&&-1!==l.value?"q-transition--"+(-1===t?h.value:d.value):null;s.value!==r&&(s.value=r)}function S(r,n=l.value){let i=n+r;for(;-1!==i&&i<o.length;){const e=o[i];if(void 0!==e&&""!==e.props.disable&&!0!==e.props.disable)return x(r),a=!0,t("update:modelValue",e.props.name),void setTimeout((()=>{a=!1}));i+=r}!0===e.infinite&&0!==o.length&&-1!==n&&n!==o.length&&S(r,-1===r?o.length:-1)}function E(){const t=w(e.modelValue);return l.value!==t&&(l.value=t),!0}function T(){const t=!0===b(e.modelValue)&&E()&&o[l.value];return!0===e.keepAlive?[h$2(KeepAlive,m.value,[h$2(!0===g.value?n(f.value,(()=>({...PanelWrapper,name:f.value}))):PanelWrapper,{key:f.value,style:p.value},(()=>t))])]:[h$2("div",{class:"q-panel scroll",style:p.value,key:f.value,role:"tabpanel"},[t])]}return watch$2((()=>e.modelValue),((r,n)=>{const o=!0===b(r)?w(r):-1;!0!==a&&x(-1===o?0:o<w(n)?-1:1),l.value!==o&&(l.value=o,t("beforeTransition",r,n),i((()=>{t("transition",r,n)}),e.transitionDuration))})),Object.assign(r,{next:y,previous:_,goTo:v}),{panelIndex:l,panelDirectives:u,updatePanelsList:function(e){return o=getNormalizedVNodes(hSlot(e.default,[])).filter((e=>null!==e.props&&void 0===e.props.slot&&!0===b(e.props.name))),o.length},updatePanelIndex:E,getPanelContent:function(){if(0!==o.length)return!0===e.animated?[h$2(Transition,{name:s.value},T)]:T()},getEnabledPanels:function(){return o.filter((e=>""!==e.props.disable&&!0!==e.props.disable))},getPanels:function(){return o},isValidPanelName:b,keepAliveProps:m,needsUniqueKeepAliveWrapper:g,goToPanelByOffset:S,goToPanel:v,nextPanel:y,previousPanel:_}}const QTabPanels=createComponent({name:"QTabPanels",props:{...usePanelProps,...useDarkProps},emits:usePanelEmits,setup(e,{slots:t}){const r=getCurrentInstance(),n=useDark(e,r.proxy.$q),{updatePanelsList:i,getPanelContent:o,panelDirectives:a}=usePanel(),s=computed((()=>"q-tab-panels q-panel-parent"+(!0===n.value?" q-tab-panels--dark q-dark":"")));return()=>(i(t),hDir("div",{class:s.value},o(),"pan",e.swipeable,(()=>a.value)))}}),QTabPanel=createComponent({name:"QTabPanel",props:usePanelChildProps,setup:(e,{slots:t})=>()=>h$2("div",{class:"q-tab-panel",role:"tabpanel"},hSlot(t.default))}),reRGBA=/^rgb(a)?\((\d{1,3}),(\d{1,3}),(\d{1,3}),?([01]?\.?\d*?)?\)$/;function rgbToHex({r:e,g:t,b:r,a:n}){const i=void 0!==n;if(e=Math.round(e),t=Math.round(t),r=Math.round(r),e>255||t>255||r>255||i&&n>100)throw new TypeError("Expected 3 numbers below 256 (and optionally one below 100)");return n=i?(256|Math.round(255*n/100)).toString(16).slice(1):"","#"+(r|t<<8|e<<16|1<<24).toString(16).slice(1)+n}function rgbToString({r:e,g:t,b:r,a:n}){return`rgb${void 0!==n?"a":""}(${e},${t},${r}${void 0!==n?","+n/100:""})`}function hexToRgb(e){if("string"!=typeof e)throw new TypeError("Expected a string");3===(e=e.replace(/^#/,"")).length?e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:4===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const t=parseInt(e,16);return e.length>6?{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:Math.round((255&t)/2.55)}:{r:t>>16,g:t>>8&255,b:255&t}}function hsvToRgb({h:e,s:t,v:r,a:n}){let i,o,a;t/=100,r/=100,e/=360;const s=Math.floor(6*e),l=6*e-s,c=r*(1-t),u=r*(1-l*t),h=r*(1-(1-l)*t);switch(s%6){case 0:i=r,o=h,a=c;break;case 1:i=u,o=r,a=c;break;case 2:i=c,o=r,a=h;break;case 3:i=c,o=u,a=r;break;case 4:i=h,o=c,a=r;break;case 5:i=r,o=c,a=u}return{r:Math.round(255*i),g:Math.round(255*o),b:Math.round(255*a),a:n}}function rgbToHsv({r:e,g:t,b:r,a:n}){const i=Math.max(e,t,r),o=Math.min(e,t,r),a=i-o,s=0===i?0:a/i,l=i/255;let c;switch(i){case o:c=0;break;case e:c=t-r+a*(t<r?6:0),c/=6*a;break;case t:c=r-e+2*a,c/=6*a;break;case r:c=e-t+4*a,c/=6*a}return{h:Math.round(360*c),s:Math.round(100*s),v:Math.round(100*l),a:n}}function textToRgb$1(e){if("string"!=typeof e)throw new TypeError("Expected a string");const t=e.replace(/ /g,""),r=reRGBA.exec(t);if(null===r)return hexToRgb(t);const n={r:Math.min(255,parseInt(r[2],10)),g:Math.min(255,parseInt(r[3],10)),b:Math.min(255,parseInt(r[4],10))};if(r[1]){const e=parseFloat(r[5]);n.a=100*Math.min(1,!0===isNaN(e)?1:e)}return n}function luminosity(e){if("string"!=typeof e&&(!e||void 0===e.r))throw new TypeError("Expected a string or a {r, g, b} object as color");const t="string"==typeof e?textToRgb$1(e):e,r=t.r/255,n=t.g/255,i=t.b/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))}const colors={textToRgb:textToRgb$1},palette=["rgb(255,204,204)","rgb(255,230,204)","rgb(255,255,204)","rgb(204,255,204)","rgb(204,255,230)","rgb(204,255,255)","rgb(204,230,255)","rgb(204,204,255)","rgb(230,204,255)","rgb(255,204,255)","rgb(255,153,153)","rgb(255,204,153)","rgb(255,255,153)","rgb(153,255,153)","rgb(153,255,204)","rgb(153,255,255)","rgb(153,204,255)","rgb(153,153,255)","rgb(204,153,255)","rgb(255,153,255)","rgb(255,102,102)","rgb(255,179,102)","rgb(255,255,102)","rgb(102,255,102)","rgb(102,255,179)","rgb(102,255,255)","rgb(102,179,255)","rgb(102,102,255)","rgb(179,102,255)","rgb(255,102,255)","rgb(255,51,51)","rgb(255,153,51)","rgb(255,255,51)","rgb(51,255,51)","rgb(51,255,153)","rgb(51,255,255)","rgb(51,153,255)","rgb(51,51,255)","rgb(153,51,255)","rgb(255,51,255)","rgb(255,0,0)","rgb(255,128,0)","rgb(255,255,0)","rgb(0,255,0)","rgb(0,255,128)","rgb(0,255,255)","rgb(0,128,255)","rgb(0,0,255)","rgb(128,0,255)","rgb(255,0,255)","rgb(245,0,0)","rgb(245,123,0)","rgb(245,245,0)","rgb(0,245,0)","rgb(0,245,123)","rgb(0,245,245)","rgb(0,123,245)","rgb(0,0,245)","rgb(123,0,245)","rgb(245,0,245)","rgb(214,0,0)","rgb(214,108,0)","rgb(214,214,0)","rgb(0,214,0)","rgb(0,214,108)","rgb(0,214,214)","rgb(0,108,214)","rgb(0,0,214)","rgb(108,0,214)","rgb(214,0,214)","rgb(163,0,0)","rgb(163,82,0)","rgb(163,163,0)","rgb(0,163,0)","rgb(0,163,82)","rgb(0,163,163)","rgb(0,82,163)","rgb(0,0,163)","rgb(82,0,163)","rgb(163,0,163)","rgb(92,0,0)","rgb(92,46,0)","rgb(92,92,0)","rgb(0,92,0)","rgb(0,92,46)","rgb(0,92,92)","rgb(0,46,92)","rgb(0,0,92)","rgb(46,0,92)","rgb(92,0,92)","rgb(255,255,255)","rgb(205,205,205)","rgb(178,178,178)","rgb(153,153,153)","rgb(127,127,127)","rgb(102,102,102)","rgb(76,76,76)","rgb(51,51,51)","rgb(25,25,25)","rgb(0,0,0)"],thumbPath="M5 5 h10 v10 h-10 v-10 z",alphaTrackImg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAH0lEQVQoU2NkYGAwZkAFZ5G5jPRRgOYEVDeB3EBjBQBOZwTVugIGyAAAAABJRU5ErkJggg==",QColor=createComponent({name:"QColor",props:{...useDarkProps,...useFormProps,modelValue:String,defaultValue:String,defaultView:{type:String,default:"spectrum",validator:e=>["spectrum","tune","palette"].includes(e)},formatModel:{type:String,default:"auto",validator:e=>["auto","hex","rgb","hexa","rgba"].includes(e)},palette:Array,noHeader:Boolean,noHeaderTabs:Boolean,noFooter:Boolean,square:Boolean,flat:Boolean,bordered:Boolean,disable:Boolean,readonly:Boolean},emits:["update:modelValue","change"],setup(e,{emit:t}){const{proxy:r}=getCurrentInstance(),{$q:n}=r,i=useDark(e,n),{getCache:o}=useRenderCache(),a=ref$1(null),s=ref$1(null),l=computed((()=>"auto"===e.formatModel?null:-1!==e.formatModel.indexOf("hex"))),c=computed((()=>"auto"===e.formatModel?null:-1!==e.formatModel.indexOf("a"))),u=ref$1("auto"===e.formatModel?void 0===e.modelValue||null===e.modelValue||""===e.modelValue||e.modelValue.startsWith("#")?"hex":"rgb":e.formatModel.startsWith("hex")?"hex":"rgb"),h=ref$1(e.defaultView),d=ref$1(C(e.modelValue||e.defaultValue)),p=computed((()=>!0!==e.disable&&!0!==e.readonly)),f=computed((()=>void 0===e.modelValue||null===e.modelValue||""===e.modelValue||e.modelValue.startsWith("#"))),m=computed((()=>null!==l.value?l.value:f.value)),g=useFormInject(computed((()=>({type:"hidden",name:e.name,value:d.value[!0===m.value?"hex":"rgb"]})))),y=computed((()=>null!==c.value?c.value:void 0!==d.value.a)),_=computed((()=>({backgroundColor:d.value.rgb||"#000"}))),v=computed((()=>"q-color-picker__header-content q-color-picker__header-content--"+(void 0!==d.value.a&&d.value.a<65||luminosity(d.value)>.4?"light":"dark"))),b=computed((()=>({background:`hsl(${d.value.h},100%,50%)`}))),w=computed((()=>({top:100-d.value.v+"%",[!0===n.lang.rtl?"right":"left"]:`${d.value.s}%`}))),x=computed((()=>void 0!==e.palette&&0!==e.palette.length?e.palette:palette)),S=computed((()=>"q-color-picker"+(!0===e.bordered?" q-color-picker--bordered":"")+(!0===e.square?" q-color-picker--square no-border-radius":"")+(!0===e.flat?" q-color-picker--flat no-shadow":"")+(!0===e.disable?" disabled":"")+(!0===i.value?" q-color-picker--dark q-dark":""))),E=computed((()=>!0===e.disable?{"aria-disabled":"true"}:{})),T=computed((()=>[[TouchPan,D,void 0,{prevent:!0,stop:!0,mouse:!0}]]));function A(e,r){d.value.hex=rgbToHex(e),d.value.rgb=rgbToString(e),d.value.r=e.r,d.value.g=e.g,d.value.b=e.b,d.value.a=e.a;const n=d.value[!0===m.value?"hex":"rgb"];t("update:modelValue",n),!0===r&&t("change",n)}function C(t){const r=void 0!==c.value?c.value:"auto"===e.formatModel?null:-1!==e.formatModel.indexOf("a");if("string"!=typeof t||0===t.length||!0!==testPattern.anyColor(t.replace(/ /g,"")))return{h:0,s:0,v:0,r:0,g:0,b:0,a:!0===r?100:void 0,hex:void 0,rgb:void 0};const n=textToRgb$1(t);return!0===r&&void 0===n.a&&(n.a=100),n.hex=rgbToHex(n),n.rgb=rgbToString(n),Object.assign(n,rgbToHsv(n))}function I(e,t,r){const i=a.value;if(null===i)return;const o=i.clientWidth,s=i.clientHeight,l=i.getBoundingClientRect();let c=Math.min(o,Math.max(0,e-l.left));!0===n.lang.rtl&&(c=o-c);const u=Math.min(s,Math.max(0,t-l.top)),h=Math.round(100*c/o),p=Math.round(100*Math.max(0,Math.min(1,-u/s+1))),f=hsvToRgb({h:d.value.h,s:h,v:p,a:!0===y.value?d.value.a:void 0});d.value.s=h,d.value.v=p,A(f,r)}function k(e,t){const r=Math.round(e),n=hsvToRgb({h:r,s:d.value.s,v:d.value.v,a:!0===y.value?d.value.a:void 0});d.value.h=r,A(n,t)}function P(e){k(e,!0)}function M(e,t,n,i,o){if(void 0!==i&&stop$1(i),!/^[0-9]+$/.test(e))return void(!0===o&&r.$forceUpdate());const a=Math.floor(Number(e));if(a<0||a>n)return void(!0===o&&r.$forceUpdate());const s={r:"r"===t?a:d.value.r,g:"g"===t?a:d.value.g,b:"b"===t?a:d.value.b,a:!0===y.value?"a"===t?a:d.value.a:void 0};if("a"!==t){const e=rgbToHsv(s);d.value.h=e.h,d.value.s=e.s,d.value.v=e.v}if(A(s,o),!0!==o&&void 0!==i?.target.selectionEnd){const e=i.target.selectionEnd;nextTick((()=>{i.target.setSelectionRange(e,e)}))}}function R(e,t){let r;const n=e.target.value;if(stop$1(e),"hex"===u.value){if(n.length!==(!0===y.value?9:7)||!/^#[0-9A-Fa-f]+$/.test(n))return!0;r=hexToRgb(n)}else{let e;if(!n.endsWith(")"))return!0;if(!0!==y.value&&n.startsWith("rgb(")){if(e=n.substring(4,n.length-1).split(",").map((e=>parseInt(e,10))),3!==e.length||!/^rgb\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3}\)$/.test(n))return!0}else{if(!0!==y.value||!n.startsWith("rgba("))return!0;{if(e=n.substring(5,n.length-1).split(","),4!==e.length||!/^rgba\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/.test(n))return!0;for(let r=0;r<3;r++){const t=parseInt(e[r],10);if(t<0||t>255)return!0;e[r]=t}const t=parseFloat(e[3]);if(t<0||t>1)return!0;e[3]=t}}if(e[0]<0||e[0]>255||e[1]<0||e[1]>255||e[2]<0||e[2]>255||!0===y.value&&(e[3]<0||e[3]>1))return!0;r={r:e[0],g:e[1],b:e[2],a:!0===y.value?100*e[3]:void 0}}const i=rgbToHsv(r);if(d.value.h=i.h,d.value.s=i.s,d.value.v=i.v,A(r,t),!0!==t){const t=e.target.selectionEnd;nextTick((()=>{e.target.setSelectionRange(t,t)}))}}function D(e){e.isFinal?I(e.position.left,e.position.top,!0):O(e)}watch$2((()=>e.modelValue),(t=>{const r=C(t||e.defaultValue);r.hex!==d.value.hex&&(d.value=r)})),watch$2((()=>e.defaultValue),(t=>{if(!e.modelValue&&t){const e=C(t);e.hex!==d.value.hex&&(d.value=e)}}));const O=throttle$1((e=>{I(e.position.left,e.position.top)}),20);function L(e){I(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset,!0)}function B(e){I(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset)}function $(e){null!==s.value&&(s.value.$el.style.opacity=e?1:0)}function z(e){u.value=e}function F(e){h.value=e}function q(){const e={ref:a,class:"q-color-picker__spectrum non-selectable relative-position cursor-pointer"+(!0!==p.value?" readonly":""),style:b.value,...!0===p.value?{onClick:L,onMousedown:B}:{}},t=[h$2("div",{style:{paddingBottom:"100%"}}),h$2("div",{class:"q-color-picker__spectrum-white absolute-full"}),h$2("div",{class:"q-color-picker__spectrum-black absolute-full"}),h$2("div",{class:"absolute",style:w.value},[void 0!==d.value.hex?h$2("div",{class:"q-color-picker__spectrum-circle"}):null])],r=[h$2(QSlider,{class:"q-color-picker__hue non-selectable",modelValue:d.value.h,min:0,max:360,trackSize:"8px",innerTrackColor:"transparent",selectionColor:"transparent",readonly:!0!==p.value,thumbPath:thumbPath,"onUpdate:modelValue":k,onChange:P})];return!0===y.value&&r.push(h$2(QSlider,{class:"q-color-picker__alpha non-selectable",modelValue:d.value.a,min:0,max:100,trackSize:"8px",trackColor:"white",innerTrackColor:"transparent",selectionColor:"transparent",trackImg:alphaTrackImg,readonly:!0!==p.value,hideSelection:!0,thumbPath:thumbPath,...o("alphaSlide",{"onUpdate:modelValue":e=>M(e,"a",100),onChange:e=>M(e,"a",100,void 0,!0)})})),[hDir("div",e,t,"spec",p.value,(()=>T.value)),h$2("div",{class:"q-color-picker__sliders"},r)]}function N(){return[h$2("div",{class:"row items-center no-wrap"},[h$2("div","R"),h$2(QSlider,{modelValue:d.value.r,min:0,max:255,color:"red",dark:i.value,readonly:!0!==p.value,...o("rSlide",{"onUpdate:modelValue":e=>M(e,"r",255),onChange:e=>M(e,"r",255,void 0,!0)})}),h$2("input",{value:d.value.r,maxlength:3,readonly:!0!==p.value,onChange:stop$1,...o("rIn",{onInput:e=>M(e.target.value,"r",255,e),onBlur:e=>M(e.target.value,"r",255,e,!0)})})]),h$2("div",{class:"row items-center no-wrap"},[h$2("div","G"),h$2(QSlider,{modelValue:d.value.g,min:0,max:255,color:"green",dark:i.value,readonly:!0!==p.value,...o("gSlide",{"onUpdate:modelValue":e=>M(e,"g",255),onChange:e=>M(e,"g",255,void 0,!0)})}),h$2("input",{value:d.value.g,maxlength:3,readonly:!0!==p.value,onChange:stop$1,...o("gIn",{onInput:e=>M(e.target.value,"g",255,e),onBlur:e=>M(e.target.value,"g",255,e,!0)})})]),h$2("div",{class:"row items-center no-wrap"},[h$2("div","B"),h$2(QSlider,{modelValue:d.value.b,min:0,max:255,color:"blue",readonly:!0!==p.value,dark:i.value,...o("bSlide",{"onUpdate:modelValue":e=>M(e,"b",255),onChange:e=>M(e,"b",255,void 0,!0)})}),h$2("input",{value:d.value.b,maxlength:3,readonly:!0!==p.value,onChange:stop$1,...o("bIn",{onInput:e=>M(e.target.value,"b",255,e),onBlur:e=>M(e.target.value,"b",255,e,!0)})})]),!0===y.value?h$2("div",{class:"row items-center no-wrap"},[h$2("div","A"),h$2(QSlider,{modelValue:d.value.a,color:"grey",readonly:!0!==p.value,dark:i.value,...o("aSlide",{"onUpdate:modelValue":e=>M(e,"a",100),onChange:e=>M(e,"a",100,void 0,!0)})}),h$2("input",{value:d.value.a,maxlength:3,readonly:!0!==p.value,onChange:stop$1,...o("aIn",{onInput:e=>M(e.target.value,"a",100,e),onBlur:e=>M(e.target.value,"a",100,e,!0)})})]):null]}function j(){return[h$2("div",{class:"row items-center q-color-picker__palette-rows"+(!0===p.value?" q-color-picker__palette-rows--editable":"")},x.value.map((e=>h$2("div",{class:"q-color-picker__cube col-auto",style:{backgroundColor:e},...!0===p.value?o("palette#"+e,{onClick:()=>{!function(e){const t=C(e),r={r:t.r,g:t.g,b:t.b,a:t.a};void 0===r.a&&(r.a=d.value.a),d.value.h=t.h,d.value.s=t.s,d.value.v=t.v,A(r,!0)}(e)}}):{}}))))]}return()=>{const t=[h$2(QTabPanels,{modelValue:h.value,animated:!0},(()=>[h$2(QTabPanel,{class:"q-color-picker__spectrum-tab overflow-hidden",name:"spectrum"},q),h$2(QTabPanel,{class:"q-pa-md q-color-picker__tune-tab",name:"tune"},N),h$2(QTabPanel,{class:"q-color-picker__palette-tab",name:"palette"},j)]))];return void 0!==e.name&&!0!==e.disable&&g(t,"push"),!0!==e.noHeader&&t.unshift(function(){const t=[];return!0!==e.noHeaderTabs&&t.push(h$2(QTabs,{class:"q-color-picker__header-tabs",modelValue:u.value,dense:!0,align:"justify","onUpdate:modelValue":z},(()=>[h$2(QTab,{label:"HEX"+(!0===y.value?"A":""),name:"hex",ripple:!1}),h$2(QTab,{label:"RGB"+(!0===y.value?"A":""),name:"rgb",ripple:!1})]))),t.push(h$2("div",{class:"q-color-picker__header-banner row flex-center no-wrap"},[h$2("input",{class:"fit",value:d.value[u.value],...!0!==p.value?{readonly:!0}:{},...o("topIn",{onInput:e=>{$(!0===R(e))},onChange:stop$1,onBlur:e=>{!0===R(e,!0)&&r.$forceUpdate(),$(!1)}})}),h$2(QIcon,{ref:s,class:"q-color-picker__error-icon absolute no-pointer-events",name:n.iconSet.type.negative})])),h$2("div",{class:"q-color-picker__header relative-position overflow-hidden"},[h$2("div",{class:"q-color-picker__header-bg absolute-full"}),h$2("div",{class:v.value,style:_.value},t)])}()),!0!==e.noFooter&&t.push(h$2("div",{class:"q-color-picker__footer relative-position overflow-hidden"},[h$2(QTabs,{class:"absolute-full",modelValue:h.value,dense:!0,align:"justify","onUpdate:modelValue":F},(()=>[h$2(QTab,{icon:n.iconSet.colorPicker.spectrum,name:"spectrum",ripple:!1}),h$2(QTab,{icon:n.iconSet.colorPicker.tune,name:"tune",ripple:!1}),h$2(QTab,{icon:n.iconSet.colorPicker.palette,name:"palette",ripple:!1})]))])),h$2("div",{class:S.value,...E.value},t)}}}),QPopupProxy=createComponent({name:"QPopupProxy",props:{...useAnchorProps,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(e,{slots:t,emit:r,attrs:n}){const{proxy:i}=getCurrentInstance(),{$q:o}=i,a=ref$1(!1),s=ref$1(null),l=computed((()=>parseInt(e.breakpoint,10))),{canShow:c}=useAnchor({showing:a});function u(){return o.screen.width<l.value||o.screen.height<l.value?"dialog":"menu"}const h=ref$1(u()),d=computed((()=>"menu"===h.value?{maxHeight:"99vh"}:{}));function p(e){a.value=!0,r("show",e)}function f(e){a.value=!1,h.value=u(),r("hide",e)}return watch$2((()=>u()),(e=>{!0!==a.value&&(h.value=e)})),Object.assign(i,{show(e){!0===c(e)&&s.value.show(e)},hide(e){s.value.hide(e)},toggle(e){s.value.toggle(e)}}),injectProp(i,"currentComponent",(()=>({type:h.value,ref:s.value}))),()=>{const r={ref:s,...d.value,...n,onShow:p,onHide:f};let i;return"dialog"===h.value?i=QDialog:(i=QMenu,Object.assign(r,{target:e.target,contextMenu:e.contextMenu,noParentEvent:!0,separateClosePopup:!0})),h$2(i,r,t.default)}}}),skeletonTypes=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],skeletonAnimations=["wave","pulse","pulse-x","pulse-y","fade","blink","none"],QSkeleton=createComponent({name:"QSkeleton",props:{...useDarkProps,tag:{type:String,default:"div"},type:{type:String,validator:e=>skeletonTypes.includes(e),default:"rect"},animation:{type:String,validator:e=>skeletonAnimations.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:t}){const r=getCurrentInstance(),n=useDark(e,r.proxy.$q),i=computed((()=>{const t=void 0!==e.size?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:t[0],height:t[1]}})),o=computed((()=>`q-skeleton q-skeleton--${!0===n.value?"dark":"light"} q-skeleton--type-${e.type}`+("none"!==e.animation?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(!0===e.square?" q-skeleton--square":"")+(!0===e.bordered?" q-skeleton--bordered":"")));return()=>h$2(e.tag,{class:o.value,style:i.value},hSlot(t.default))}}),alignValues=["top","middle","bottom"],QBadge=createComponent({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>alignValues.includes(e)}},setup(e,{slots:t}){const r=computed((()=>void 0!==e.align?{verticalAlign:e.align}:null)),n=computed((()=>{const t=!0===e.outline&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${!0===e.multiLine?"multi":"single"}-line`+(!0===e.outline?" q-badge--outline":void 0!==e.color?` bg-${e.color}`:"")+(void 0!==t?` text-${t}`:"")+(!0===e.floating?" q-badge--floating":"")+(!0===e.rounded?" q-badge--rounded":"")+(!0===e.transparent?" q-badge--transparent":"")}));return()=>h$2("div",{class:n.value,style:r.value,role:"status","aria-label":e.label},hMergeSlot(t.default,void 0!==e.label?[e.label]:[]))}}),useCircularCommonProps={...useSizeProps,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},radius=50,diameter=2*radius,circumference=diameter*Math.PI,strokeDashArray=Math.round(1e3*circumference)/1e3,QCircularProgress=createComponent({name:"QCircularProgress",props:{...useCircularCommonProps,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=useSize(e),i=computed((()=>{const t=(!0===r.lang.rtl?-1:1)*e.angle;return{transform:e.reverse!==(!0===r.lang.rtl)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-t}deg)`:`rotate3d(0, 0, 1, ${t-90}deg)`}})),o=computed((()=>!0!==e.instantFeedback&&!0!==e.indeterminate?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:"")),a=computed((()=>diameter/(1-e.thickness/2))),s=computed((()=>`${a.value/2} ${a.value/2} ${a.value} ${a.value}`)),l=computed((()=>between$1(e.value,e.min,e.max))),c=computed((()=>e.max-e.min)),u=computed((()=>e.thickness/2*a.value)),h=computed((()=>{const t=(e.max-l.value)/c.value,r=!0===e.rounded&&l.value<e.max&&t<.25?u.value/2*(1-t/.25):0;return circumference*t+r}));function d({thickness:e,offset:t,color:r,cls:n,rounded:i}){return h$2("circle",{class:"q-circular-progress__"+n+(void 0!==r?` text-${r}`:""),style:o.value,fill:"transparent",stroke:"currentColor","stroke-width":e,"stroke-dasharray":strokeDashArray,"stroke-dashoffset":t,"stroke-linecap":i,cx:a.value,cy:a.value,r:radius})}return()=>{const r=[];void 0!==e.centerColor&&"transparent"!==e.centerColor&&r.push(h$2("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:radius-u.value/2,cx:a.value,cy:a.value})),void 0!==e.trackColor&&"transparent"!==e.trackColor&&r.push(d({cls:"track",thickness:u.value,offset:0,color:e.trackColor})),r.push(d({cls:"circle",thickness:u.value,offset:h.value,color:e.color,rounded:!0===e.rounded?"round":void 0}));const o=[h$2("svg",{class:"q-circular-progress__svg",style:i.value,viewBox:s.value,"aria-hidden":"true"},r)];return!0===e.showValue&&o.push(h$2("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},void 0!==t.default?t.default():[h$2("div",l.value)])),h$2("div",{class:`q-circular-progress q-circular-progress--${!0===e.indeterminate?"in":""}determinate`,style:n.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":!0===e.indeterminate?void 0:l.value},hMergeSlotSafely(t.internal,o))}}});function filterFiles(e,t,r,n){const i=[];return e.forEach((e=>{!0===n(e)?i.push(e):t.push({failedPropValidation:r,file:e})})),i}function stopAndPreventDrag(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),stopAndPrevent$1(e)}const useFileProps={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},useFileEmits=["rejected"];function useFile({editable:e,dnd:t,getFileInput:r,addFilesToQueue:n}){const{props:i,emit:o,proxy:a}=getCurrentInstance(),s=ref$1(null),l=computed((()=>void 0!==i.accept?i.accept.split(",").map((e=>"*"===(e=e.trim())?"*/":(e.endsWith("/*")&&(e=e.slice(0,e.length-1)),e.toUpperCase()))):null)),c=computed((()=>parseInt(i.maxFiles,10))),u=computed((()=>parseInt(i.maxTotalSize,10)));function h(t){if(e.value)if(t!==Object(t)&&(t={target:null}),!0===t.target?.matches('input[type="file"]'))0===t.clientX&&0===t.clientY&&stop$1(t);else{const e=r();e!==t.target&&e?.click(t)}}function d(t){e.value&&t&&n(null,t)}function p(e){stopAndPrevent$1(e);!0===(null!==e.relatedTarget||!0!==client.is.safari?e.relatedTarget!==s.value:!1===document.elementsFromPoint(e.clientX,e.clientY).includes(s.value))&&(t.value=!1)}function f(e){stopAndPreventDrag(e);const r=e.dataTransfer.files;0!==r.length&&n(null,r),t.value=!1}return Object.assign(a,{pickFiles:h,addFiles:d}),{pickFiles:h,addFiles:d,onDragover:function(e){stopAndPreventDrag(e),!0!==t.value&&(t.value=!0)},onDragleave:p,processFiles:function(e,t,r,n){let a=Array.from(t||e.target.files);const s=[],h=()=>{0!==s.length&&o("rejected",s)};if(void 0!==i.accept&&-1===l.value.indexOf("*/")&&(a=filterFiles(a,s,"accept",(e=>l.value.some((t=>e.type.toUpperCase().startsWith(t)||e.name.toUpperCase().endsWith(t))))),0===a.length))return h();if(void 0!==i.maxFileSize){const e=parseInt(i.maxFileSize,10);if(a=filterFiles(a,s,"max-file-size",(t=>t.size<=e)),0===a.length)return h()}if(!0!==i.multiple&&0!==a.length&&(a=[a[0]]),a.forEach((e=>{e.__key=e.webkitRelativePath+e.lastModified+e.name+e.size})),!0===n){const e=r.map((e=>e.__key));a=filterFiles(a,s,"duplicate",(t=>!1===e.includes(t.__key)))}if(0===a.length)return h();if(void 0!==i.maxTotalSize){let e=!0===n?r.reduce(((e,t)=>e+t.size),0):0;if(a=filterFiles(a,s,"max-total-size",(t=>(e+=t.size,e<=u.value))),0===a.length)return h()}if("function"==typeof i.filter){const e=i.filter(a);a=filterFiles(a,s,"filter",(t=>e.includes(t)))}if(void 0!==i.maxFiles){let e=!0===n?r.length:0;if(a=filterFiles(a,s,"max-files",(()=>(e++,e<=c.value))),0===a.length)return h()}return h(),0!==a.length?a:void 0},getDndNode:function(e){if(!0===t.value)return h$2("div",{ref:s,class:`q-${e}__dnd absolute-full`,onDragenter:stopAndPreventDrag,onDragover:stopAndPreventDrag,onDragleave:p,onDrop:f})},maxFilesNumber:c,maxTotalSizeNumber:u}}function getProgressLabel(e){return(100*e).toFixed(2)+"%"}const coreProps={...useDarkProps,...useFileProps,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},coreEmits=[...useFileEmits,"start","finish","added","removed"];function getRenderer(e,t){const r=getCurrentInstance(),{props:n,slots:i,emit:o,proxy:a}=r,{$q:s}=a,l=useDark(n,s);const c=computed((()=>!0!==n.disable&&!0!==n.readonly)),u=ref$1(!1),h=ref$1(null),d=ref$1(null),p={files:ref$1([]),queuedFiles:ref$1([]),uploadedFiles:ref$1([]),uploadedSize:ref$1(0),updateFileStatus:function(e,t,r){if(e.__status=t,"idle"===t)return e.__uploaded=0,e.__progress=0,e.__sizeLabel=humanStorageSize(e.size),void(e.__progressLabel="0.00%");"failed"!==t?(e.__uploaded="uploaded"===t?e.size:r,e.__progress="uploaded"===t?1:Math.min(.9999,e.__uploaded/e.size),e.__progressLabel=getProgressLabel(e.__progress),a.$forceUpdate()):a.$forceUpdate()},isAlive:()=>!1===vmIsDestroyed(r)},{pickFiles:f,addFiles:m,onDragover:g,onDragleave:y,processFiles:_,getDndNode:v,maxFilesNumber:b,maxTotalSizeNumber:w}=useFile({editable:c,dnd:u,getFileInput:B,addFilesToQueue:$});Object.assign(p,e({props:n,slots:i,emit:o,helpers:p,exposeApi:e=>{Object.assign(p,e)}})),void 0===p.isBusy&&(p.isBusy=ref$1(!1));const x=ref$1(0),S=computed((()=>0===x.value?0:p.uploadedSize.value/x.value)),E=computed((()=>getProgressLabel(S.value))),T=computed((()=>humanStorageSize(x.value))),A=computed((()=>!0===c.value&&!0!==p.isUploading.value&&(!0===n.multiple||0===p.queuedFiles.value.length)&&(void 0===n.maxFiles||p.files.value.length<b.value)&&(void 0===n.maxTotalSize||x.value<w.value))),C=computed((()=>!0===c.value&&!0!==p.isBusy.value&&!0!==p.isUploading.value&&0!==p.queuedFiles.value.length));provide(uploaderKey,q);const I=computed((()=>"q-uploader column no-wrap"+(!0===l.value?" q-uploader--dark q-dark":"")+(!0===n.bordered?" q-uploader--bordered":"")+(!0===n.square?" q-uploader--square no-border-radius":"")+(!0===n.flat?" q-uploader--flat no-shadow":"")+(!0===n.disable?" disabled q-uploader--disable":"")+(!0===u.value?" q-uploader--dnd":""))),k=computed((()=>"q-uploader__header"+(void 0!==n.color?` bg-${n.color}`:"")+(void 0!==n.textColor?` text-${n.textColor}`:"")));function P(){!1===n.disable&&(p.abort(),p.uploadedSize.value=0,x.value=0,L(),p.files.value=[],p.queuedFiles.value=[],p.uploadedFiles.value=[])}function M(){!1===n.disable&&D(["uploaded"],(()=>{p.uploadedFiles.value=[]}))}function R(){D(["idle","failed"],(({size:e})=>{x.value-=e,p.queuedFiles.value=[]}))}function D(e,t){if(!0===n.disable)return;const r={files:[],size:0},i=p.files.value.filter((t=>-1===e.indexOf(t.__status)||(r.size+=t.size,r.files.push(t),void 0!==t.__img&&window.URL.revokeObjectURL(t.__img.src),!1)));0!==r.files.length&&(p.files.value=i,t(r),o("removed",r.files))}function O(e){n.disable||("uploaded"===e.__status?p.uploadedFiles.value=p.uploadedFiles.value.filter((t=>t.__key!==e.__key)):"uploading"===e.__status?e.__abort():x.value-=e.size,p.files.value=p.files.value.filter((t=>t.__key!==e.__key||(void 0!==t.__img&&window.URL.revokeObjectURL(t.__img.src),!1))),p.queuedFiles.value=p.queuedFiles.value.filter((t=>t.__key!==e.__key)),o("removed",[e]))}function L(){p.files.value.forEach((e=>{void 0!==e.__img&&window.URL.revokeObjectURL(e.__img.src)}))}function B(){return d.value||h.value.getElementsByClassName("q-uploader__input")[0]}function $(e,t){const r=_(e,t,p.files.value,!0),i=B();null!=i&&(i.value=""),void 0!==r&&(r.forEach((e=>{if(p.updateFileStatus(e,"idle"),x.value+=e.size,!0!==n.noThumbnails&&e.type.toUpperCase().startsWith("IMAGE")){const t=new Image;t.src=window.URL.createObjectURL(e),e.__img=t}})),p.files.value=p.files.value.concat(r),p.queuedFiles.value=p.queuedFiles.value.concat(r),o("added",r),!0===n.autoUpload&&p.upload())}function z(){!0===C.value&&p.upload()}function F(e,t,r){if(!0===e){const e={type:"a",key:t,icon:s.iconSet.uploader[t],flat:!0,dense:!0};let n;return"add"===t?(e.onClick=f,n=q):e.onClick=r,h$2(QBtn,e,n)}}function q(){return h$2("input",{ref:d,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:n.accept,multiple:!0===n.multiple?"multiple":void 0,capture:n.capture,onMousedown:stop$1,onClick:f,onChange:$})}watch$2(p.isUploading,((e,t)=>{!1===t&&!0===e?o("start"):!0===t&&!1===e&&o("finish")})),onBeforeUnmount((()=>{!0===p.isUploading.value&&p.abort(),0!==p.files.value.length&&L()}));const N={};for(const j in p)!0===isRef(p[j])?injectProp(N,j,(()=>p[j].value)):N[j]=p[j];return Object.assign(N,{upload:z,reset:P,removeUploadedFiles:M,removeQueuedFiles:R,removeFile:O,pickFiles:f,addFiles:m}),injectMultipleProps(N,{canAddFiles:()=>A.value,canUpload:()=>C.value,uploadSizeLabel:()=>T.value,uploadProgressLabel:()=>E.value}),t({...p,upload:z,reset:P,removeUploadedFiles:M,removeQueuedFiles:R,removeFile:O,pickFiles:f,addFiles:m,canAddFiles:A,canUpload:C,uploadSizeLabel:T,uploadProgressLabel:E}),()=>{const e=[h$2("div",{class:k.value},void 0!==i.header?i.header(N):[h$2("div",{class:"q-uploader__header-content column"},[h$2("div",{class:"flex flex-center no-wrap q-gutter-xs"},[F(0!==p.queuedFiles.value.length,"removeQueue",R),F(0!==p.uploadedFiles.value.length,"removeUploaded",M),!0===p.isUploading.value?h$2(QSpinner,{class:"q-uploader__spinner"}):null,h$2("div",{class:"col column justify-center"},[void 0!==n.label?h$2("div",{class:"q-uploader__title"},[n.label]):null,h$2("div",{class:"q-uploader__subtitle"},[T.value+" / "+E.value])]),F(A.value,"add"),F(!1===n.hideUploadBtn&&!0===C.value,"upload",p.upload),F(p.isUploading.value,"clear",p.abort)])])]),h$2("div",{class:"q-uploader__list scroll"},void 0!==i.list?i.list(N):p.files.value.map((e=>h$2("div",{key:e.__key,class:"q-uploader__file relative-position"+(!0!==n.noThumbnails&&void 0!==e.__img?" q-uploader__file--img":"")+("failed"===e.__status?" q-uploader__file--failed":"uploaded"===e.__status?" q-uploader__file--uploaded":""),style:!0!==n.noThumbnails&&void 0!==e.__img?{backgroundImage:'url("'+e.__img.src+'")',backgroundSize:n.thumbnailFit}:null},[h$2("div",{class:"q-uploader__file-header row flex-center no-wrap"},["failed"===e.__status?h$2(QIcon,{class:"q-uploader__file-status",name:s.iconSet.type.negative,color:"negative"}):null,h$2("div",{class:"q-uploader__file-header-content col"},[h$2("div",{class:"q-uploader__title"},[e.name]),h$2("div",{class:"q-uploader__subtitle row items-center no-wrap"},[e.__sizeLabel+" / "+e.__progressLabel])]),"uploading"===e.__status?h$2(QCircularProgress,{value:e.__progress,min:0,max:1,indeterminate:0===e.__progress}):h$2(QBtn,{round:!0,dense:!0,flat:!0,icon:s.iconSet.uploader["uploaded"===e.__status?"done":"clear"],onClick:()=>{O(e)}})])])))),v("uploader")];!0===p.isBusy.value&&e.push(h$2("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[h$2(QSpinner)]));const t={ref:h,class:I.value};return!0===A.value&&Object.assign(t,{onDragover:g,onDragleave:y}),h$2("div",t,e)}}const trueFn=()=>!0;function getEmitsObject(e){const t={};return e.forEach((e=>{t[e]=trueFn})),t}const coreEmitsObject=getEmitsObject(coreEmits),createUploaderComponent=({name:e,props:t,emits:r,injectPlugin:n})=>createComponent({name:e,props:{...coreProps,...t},emits:!0===isObject$2(r)?{...coreEmitsObject,...r}:[...coreEmits,...r],setup:(e,{expose:t})=>getRenderer(n,t)});function getFn(e){return"function"==typeof e?e:()=>e}const name="QUploader",props={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},emits=["factoryFailed","uploaded","failed","uploading"];function injectPlugin({props:e,emit:t,helpers:r}){const n=ref$1([]),i=ref$1([]),o=ref$1(0),a=computed((()=>({url:getFn(e.url),method:getFn(e.method),headers:getFn(e.headers),formFields:getFn(e.formFields),fieldName:getFn(e.fieldName),withCredentials:getFn(e.withCredentials),sendRaw:getFn(e.sendRaw),batch:getFn(e.batch)})));let s;function l(n){if(o.value++,"function"!=typeof e.factory)return void c(n,{});const a=e.factory(n);if(a)if("function"==typeof a.catch&&"function"==typeof a.then){i.value.push(a);const e=e=>{!0===r.isAlive()&&(i.value=i.value.filter((e=>e!==a)),0===i.value.length&&(s=!1),r.queuedFiles.value=r.queuedFiles.value.concat(n),n.forEach((e=>{r.updateFileStatus(e,"failed")})),t("factoryFailed",e,n),o.value--)};a.then((t=>{!0===s?e(new Error("Aborted")):!0===r.isAlive()&&(i.value=i.value.filter((e=>e!==a)),c(n,t))})).catch(e)}else c(n,a||{});else t("factoryFailed",new Error("QUploader: factory() does not return properly"),n),o.value--}function c(e,i){const s=new FormData,l=new XMLHttpRequest,c=(e,t)=>void 0!==i[e]?getFn(i[e])(t):a.value[e](t),u=c("url",e);if(!u)return void o.value--;const h=c("formFields",e);void 0!==h&&h.forEach((e=>{s.append(e.name,e.value)}));let d,p=0,f=0,m=0,g=0;l.upload.addEventListener("progress",(t=>{if(!0===d)return;const n=Math.min(g,t.loaded);r.uploadedSize.value+=n-m,m=n;let i=m-f;for(let o=p;i>0&&o<e.length;o++){const t=e[o];if(!(i>t.size))return void r.updateFileStatus(t,"uploading",i);i-=t.size,p++,f+=t.size,r.updateFileStatus(t,"uploading",t.size)}}),!1),l.onreadystatechange=()=>{l.readyState<4||(l.status&&l.status<400?(r.uploadedFiles.value=r.uploadedFiles.value.concat(e),e.forEach((e=>{r.updateFileStatus(e,"uploaded")})),t("uploaded",{files:e,xhr:l})):(d=!0,r.uploadedSize.value-=m,r.queuedFiles.value=r.queuedFiles.value.concat(e),e.forEach((e=>{r.updateFileStatus(e,"failed")})),t("failed",{files:e,xhr:l})),o.value--,n.value=n.value.filter((e=>e!==l)))},l.open(c("method",e),u),!0===c("withCredentials",e)&&(l.withCredentials=!0);const y=c("headers",e);void 0!==y&&y.forEach((e=>{l.setRequestHeader(e.name,e.value)}));const _=c("sendRaw",e);e.forEach((e=>{r.updateFileStatus(e,"uploading",0),!0!==_&&s.append(c("fieldName",e),e,e.name),e.xhr=l,e.__abort=()=>{l.abort()},g+=e.size})),t("uploading",{files:e,xhr:l}),n.value.push(l),!0===_?l.send(new Blob(e)):l.send(s)}return{isUploading:computed((()=>o.value>0)),isBusy:computed((()=>0!==i.value.length)),abort:function(){n.value.forEach((e=>{e.abort()})),0!==i.value.length&&(s=!0)},upload:function(){const e=r.queuedFiles.value.slice(0);r.queuedFiles.value=[],a.value.batch(e)?l(e):e.forEach((e=>{l([e])}))}}}const xhrUploaderPlugin={name:name,props:props,emits:emits,injectPlugin:injectPlugin},QUploader=createUploaderComponent(xhrUploaderPlugin);var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$1=Object.prototype,hasOwnProperty=objectProto$1.hasOwnProperty,nativeObjectToString$1=objectProto$1.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag$1),r=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var n=!0}catch(o){}var i=nativeObjectToString$1.call(e);return n&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),i}var objectProto=Object.prototype,nativeObjectToString=objectProto.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag}var reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var reTrimStart=/^\s+/;function baseTrim(e){return e?e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,""):e}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var now=function(){return root.Date.now()},FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(e,t,r){var n,i,o,a,s,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);function p(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function f(e){var r=e-l;return void 0===l||r>=t||r<0||h&&e-c>=o}function m(){var e=now();if(f(e))return g(e);s=setTimeout(m,function(e){var r=t-(e-l);return h?nativeMin(r,o-(e-c)):r}(e))}function g(e){return s=void 0,d&&n?p(e):(n=i=void 0,a)}function y(){var e=now(),r=f(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),u?p(e):a}(l);if(h)return clearTimeout(s),s=setTimeout(m,t),p(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=toNumber$1(t)||0,isObject(r)&&(u=!!r.leading,o=(h="maxWait"in r)?nativeMax(toNumber$1(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},y.flush=function(){return void 0===s?a:g(now())},y}var FUNC_ERROR_TEXT="Expected a function";function throttle(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);return isObject(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),debounce(e,t,{leading:n,maxWait:t,trailing:i})}const QSplitter=createComponent({name:"QSplitter",props:{...useDarkProps,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>2===e.length&&("number"==typeof e[0]&&"number"==typeof e[1]&&(e[0]>=0&&e[0]<=e[1]))},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=useDark(e,n),o=ref$1(null),a={before:ref$1(null),after:ref$1(null)},s=computed((()=>`q-splitter no-wrap ${!0===e.horizontal?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${!0===e.disable?"disabled":"workable"}`+(!0===i.value?" q-splitter--dark":""))),l=computed((()=>!0===e.horizontal?"height":"width")),c=computed((()=>!0!==e.reverse?"before":"after")),u=computed((()=>void 0!==e.limits?e.limits:"%"===e.unit?[10,90]:[50,1/0]));function h(t){return("%"===e.unit?t:Math.round(t))+e.unit}const d=computed((()=>({[c.value]:{[l.value]:h(e.modelValue)}})));let p,f,m,g,y;function _(t){if(!0===t.isFirst){const t=o.value.getBoundingClientRect()[l.value];return p=!0===e.horizontal?"up":"left",f="%"===e.unit?100:t,m=Math.min(f,u.value[1],Math.max(u.value[0],e.modelValue)),g=(!0!==e.reverse?1:-1)*(!0===e.horizontal?1:!0===n.lang.rtl?-1:1)*("%"===e.unit?0===t?0:100/t:1),void o.value.classList.add("q-splitter--active")}if(!0===t.isFinal)return y!==e.modelValue&&r("update:modelValue",y),void o.value.classList.remove("q-splitter--active");const i=m+g*(t.direction===p?-1:1)*t.distance[!0===e.horizontal?"y":"x"];y=Math.min(f,u.value[1],Math.max(u.value[0],i)),a[c.value].value.style[l.value]=h(y),!0===e.emitImmediately&&e.modelValue!==y&&r("update:modelValue",y)}const v=computed((()=>[[TouchPan,_,void 0,{[!0===e.horizontal?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]));function b(e,t){e<t[0]?r("update:modelValue",t[0]):e>t[1]&&r("update:modelValue",t[1])}return watch$2((()=>e.modelValue),(e=>{b(e,u.value)})),watch$2((()=>e.limits),(()=>{nextTick((()=>{b(e.modelValue,u.value)}))})),()=>{const r=[h$2("div",{ref:a.before,class:["q-splitter__panel q-splitter__before"+(!0===e.reverse?" col":""),e.beforeClass],style:d.value.before},hSlot(t.before)),h$2("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":!0===e.disable?"true":void 0},[hDir("div",{class:"q-splitter__separator-area absolute-full"},hSlot(t.separator),"sep",!0!==e.disable,(()=>v.value))]),h$2("div",{ref:a.after,class:["q-splitter__panel q-splitter__after"+(!0===e.reverse?"":" col"),e.afterClass],style:d.value.after},hSlot(t.after))];return h$2("div",{class:s.value,ref:o},hMergeSlot(t.default,r))}}}),QBanner=createComponent({name:"QBanner",props:{...useDarkProps,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=useDark(e,r),i=computed((()=>"q-banner row items-center"+(!0===e.dense?" q-banner--dense":"")+(!0===n.value?" q-banner--dark q-dark":"")+(!0===e.rounded?" rounded-borders":""))),o=computed((()=>"q-banner__actions row items-center justify-end col-"+(!0===e.inlineActions?"auto":"all")));return()=>{const r=[h$2("div",{class:"q-banner__avatar col-auto row items-center self-start"},hSlot(t.avatar)),h$2("div",{class:"q-banner__content col text-body2"},hSlot(t.default))],n=hSlot(t.action);return void 0!==n&&r.push(h$2("div",{class:o.value},n)),h$2("div",{class:i.value+(!1===e.inlineActions&&void 0!==n?" q-banner--top-padding":""),role:"alert"},r)}}});var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3();const EventEmitter=getDefaultExportFromCjs$1(eventemitter3Exports);class List extends EventEmitter{[Symbol.toStringTag]="List";constructor(e){super(),e&&this.push(...e)}data=new Set;toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return Array.from(this.data)}toString(){return this.join(",")}_set(e,t,r=!1){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const n=Array.from(this.data);n.splice(e,+r,t),this.data=new Set(n),this.emit("update")}set(e,t){this._set(e,t,!0)}deleteAt(e){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(e))}insert(e,t=this.data.size){this._set(t,e,!1)}at(e){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(e)}pop(){const e=Array.from(this.data).pop();return void 0!==e&&this.delete(e),e}push(...e){for(const t of e)this.add(t);return this.data.size}join(e){return Array.from(this.data).join(e)}splice(e,t,...r){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const n=Array.from(this.data),i=n.splice(e,t,...r);return this.data=new Set(n),this.emit("update"),i}add(e){return this.data.add(e),this.emit("update"),this.emit("add",e),this}clear(){this.data.clear(),this.emit("update")}delete(e){const t=this.data.delete(e);return this.emit("update"),t}has(e){return this.data.has(e)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[Symbol.iterator](){return this.data[Symbol.iterator]()}}function filterObject(e,t){const r=Object.entries(e);return Object.fromEntries(r.filter((([e,r])=>t(e,r))))}function pick(e,...t){const r={};for(const n of t.flat())r[n]=e[n];return r}function omit(e,...t){return filterObject(e,(e=>!t.flat().includes(e)))}function isJSON(e){try{return JSON.parse(e),!0}catch{return!1}}function resolveConstructors(e){const t=[];for(let r=e;r&&!["Function","Object"].includes(r.constructor.name);r=Object.getPrototypeOf(r))t.push(r.constructor.name);return t}function canary(e=new Error){const t=setTimeout((()=>{throw e}),5e3);return()=>clearTimeout(t)}function _throw(e){throw e&&"object"==typeof e&&resolveConstructors(e).includes("Error")&&Error?.captureStackTrace(e,_throw),e}const __formatter=Intl.NumberFormat("en",{notation:"compact"});function randomInt(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function capitalize(e){return e.at(0).toUpperCase()+e.slice(1)}__formatter.format.bind(__formatter);const encoder=new TextEncoder;function encodeUTF8(e){return encoder.encode(e)}const decoder=new TextDecoder;function decodeUTF8(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return decoder.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),decoder.decode(t)}function encodeUUID(e){const t=e.replace(/-/g,""),r=new Uint8Array(16);for(let n=0;n<16;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}var Errno,Errno2;Errno2=Errno||(Errno={}),Errno2[Errno2.EPERM=1]="EPERM",Errno2[Errno2.ENOENT=2]="ENOENT",Errno2[Errno2.ESRCH=3]="ESRCH",Errno2[Errno2.EINTR=4]="EINTR",Errno2[Errno2.EIO=5]="EIO",Errno2[Errno2.ENXIO=6]="ENXIO",Errno2[Errno2.E2BIG=7]="E2BIG",Errno2[Errno2.ENOEXEC=8]="ENOEXEC",Errno2[Errno2.EBADF=9]="EBADF",Errno2[Errno2.ECHILD=10]="ECHILD",Errno2[Errno2.EAGAIN=11]="EAGAIN",Errno2[Errno2.ENOMEM=12]="ENOMEM",Errno2[Errno2.EACCES=13]="EACCES",Errno2[Errno2.EFAULT=14]="EFAULT",Errno2[Errno2.ENOTBLK=15]="ENOTBLK",Errno2[Errno2.EBUSY=16]="EBUSY",Errno2[Errno2.EEXIST=17]="EEXIST",Errno2[Errno2.EXDEV=18]="EXDEV",Errno2[Errno2.ENODEV=19]="ENODEV",Errno2[Errno2.ENOTDIR=20]="ENOTDIR",Errno2[Errno2.EISDIR=21]="EISDIR",Errno2[Errno2.EINVAL=22]="EINVAL",Errno2[Errno2.ENFILE=23]="ENFILE",Errno2[Errno2.EMFILE=24]="EMFILE",Errno2[Errno2.ETXTBSY=26]="ETXTBSY",Errno2[Errno2.EFBIG=27]="EFBIG",Errno2[Errno2.ENOSPC=28]="ENOSPC",Errno2[Errno2.ESPIPE=29]="ESPIPE",Errno2[Errno2.EROFS=30]="EROFS",Errno2[Errno2.EMLINK=31]="EMLINK",Errno2[Errno2.EPIPE=32]="EPIPE",Errno2[Errno2.EDOM=33]="EDOM",Errno2[Errno2.ERANGE=34]="ERANGE",Errno2[Errno2.EDEADLK=35]="EDEADLK",Errno2[Errno2.ENAMETOOLONG=36]="ENAMETOOLONG",Errno2[Errno2.ENOLCK=37]="ENOLCK",Errno2[Errno2.ENOSYS=38]="ENOSYS",Errno2[Errno2.ENOTEMPTY=39]="ENOTEMPTY",Errno2[Errno2.ELOOP=40]="ELOOP",Errno2[Errno2.ENOMSG=42]="ENOMSG",Errno2[Errno2.EIDRM=43]="EIDRM",Errno2[Errno2.ECHRNG=44]="ECHRNG",Errno2[Errno2.EL2NSYNC=45]="EL2NSYNC",Errno2[Errno2.EL3HLT=46]="EL3HLT",Errno2[Errno2.EL3RST=47]="EL3RST",Errno2[Errno2.ENRNG=48]="ENRNG",Errno2[Errno2.EUNATCH=49]="EUNATCH",Errno2[Errno2.ECSI=50]="ECSI",Errno2[Errno2.EL2HLT=51]="EL2HLT",Errno2[Errno2.EBADE=52]="EBADE",Errno2[Errno2.EBADR=53]="EBADR",Errno2[Errno2.EXFULL=54]="EXFULL",Errno2[Errno2.ENOANO=55]="ENOANO",Errno2[Errno2.EBADRQC=56]="EBADRQC",Errno2[Errno2.EBADSLT=57]="EBADSLT",Errno2[Errno2.EBFONT=59]="EBFONT",Errno2[Errno2.ENOSTR=60]="ENOSTR",Errno2[Errno2.ENODATA=61]="ENODATA",Errno2[Errno2.ETIME=62]="ETIME",Errno2[Errno2.ENOSR=63]="ENOSR",Errno2[Errno2.ENONET=64]="ENONET",Errno2[Errno2.ENOPKG=65]="ENOPKG",Errno2[Errno2.EREMOTE=66]="EREMOTE",Errno2[Errno2.ENOLINK=67]="ENOLINK",Errno2[Errno2.EADV=68]="EADV",Errno2[Errno2.ESRMNT=69]="ESRMNT",Errno2[Errno2.ECOMM=70]="ECOMM",Errno2[Errno2.EPROTO=71]="EPROTO",Errno2[Errno2.EMULTIHOP=72]="EMULTIHOP",Errno2[Errno2.EDOTDOT=73]="EDOTDOT",Errno2[Errno2.EBADMSG=74]="EBADMSG",Errno2[Errno2.EOVERFLOW=75]="EOVERFLOW",Errno2[Errno2.ENOTUNIQ=76]="ENOTUNIQ",Errno2[Errno2.EBADFD=77]="EBADFD",Errno2[Errno2.EREMCHG=78]="EREMCHG",Errno2[Errno2.ELIBACC=79]="ELIBACC",Errno2[Errno2.ELIBBAD=80]="ELIBBAD",Errno2[Errno2.ELIBSCN=81]="ELIBSCN",Errno2[Errno2.ELIBMAX=82]="ELIBMAX",Errno2[Errno2.ELIBEXEC=83]="ELIBEXEC",Errno2[Errno2.EILSEQ=84]="EILSEQ",Errno2[Errno2.ERESTART=85]="ERESTART",Errno2[Errno2.ESTRPIPE=86]="ESTRPIPE",Errno2[Errno2.EUSERS=87]="EUSERS",Errno2[Errno2.ENOTSOCK=88]="ENOTSOCK",Errno2[Errno2.EDESTADDRREQ=89]="EDESTADDRREQ",Errno2[Errno2.EMSGSIZE=90]="EMSGSIZE",Errno2[Errno2.EPROTOTYPE=91]="EPROTOTYPE",Errno2[Errno2.ENOPROTOOPT=92]="ENOPROTOOPT",Errno2[Errno2.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",Errno2[Errno2.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",Errno2[Errno2.ENOTSUP=95]="ENOTSUP",Errno2[Errno2.EPFNOSUPPORT=96]="EPFNOSUPPORT",Errno2[Errno2.EAFNOSUPPORT=97]="EAFNOSUPPORT",Errno2[Errno2.EADDRINUSE=98]="EADDRINUSE",Errno2[Errno2.EADDRNOTAVAIL=99]="EADDRNOTAVAIL",Errno2[Errno2.ENETDOWN=100]="ENETDOWN",Errno2[Errno2.ENETUNREACH=101]="ENETUNREACH",Errno2[Errno2.ENETRESET=102]="ENETRESET",Errno2[Errno2.ECONNABORTED=103]="ECONNABORTED",Errno2[Errno2.ECONNRESET=104]="ECONNRESET",Errno2[Errno2.ENOBUFS=105]="ENOBUFS",Errno2[Errno2.EISCONN=106]="EISCONN",Errno2[Errno2.ENOTCONN=107]="ENOTCONN",Errno2[Errno2.ESHUTDOWN=108]="ESHUTDOWN",Errno2[Errno2.ETOOMANYREFS=109]="ETOOMANYREFS",Errno2[Errno2.ETIMEDOUT=110]="ETIMEDOUT",Errno2[Errno2.ECONNREFUSED=111]="ECONNREFUSED",Errno2[Errno2.EHOSTDOWN=112]="EHOSTDOWN",Errno2[Errno2.EHOSTUNREACH=113]="EHOSTUNREACH",Errno2[Errno2.EALREADY=114]="EALREADY",Errno2[Errno2.EINPROGRESS=115]="EINPROGRESS",Errno2[Errno2.ESTALE=116]="ESTALE",Errno2[Errno2.EEUCLEAN=117]="EEUCLEAN",Errno2[Errno2.ENOTNAM=118]="ENOTNAM",Errno2[Errno2.ENAVAIL=119]="ENAVAIL",Errno2[Errno2.EISNAM=120]="EISNAM",Errno2[Errno2.EREMOTEIO=121]="EREMOTEIO",Errno2[Errno2.EDQUOT=122]="EDQUOT",Errno2[Errno2.ENOMEDIUM=123]="ENOMEDIUM",Errno2[Errno2.EMEDIUMTYPE=124]="EMEDIUMTYPE",Errno2[Errno2.ECANCELED=125]="ECANCELED",Errno2[Errno2.ENOKEY=126]="ENOKEY",Errno2[Errno2.EKEYEXPIRED=127]="EKEYEXPIRED",Errno2[Errno2.EKEYREVOKED=128]="EKEYREVOKED",Errno2[Errno2.EKEYREJECTED=129]="EKEYREJECTED",Errno2[Errno2.EOWNERDEAD=130]="EOWNERDEAD",Errno2[Errno2.ENOTRECOVERABLE=131]="ENOTRECOVERABLE",Errno2[Errno2.ERFKILL=132]="ERFKILL",Errno2[Errno2.EHWPOISON=133]="EHWPOISON";const errnoMessages={[Errno.EPERM]:"Operation not permitted",[Errno.ENOENT]:"No such file or directory",[Errno.ESRCH]:"No such process",[Errno.EINTR]:"Interrupted system call",[Errno.EIO]:"Input/output error",[Errno.ENXIO]:"No such device or address",[Errno.E2BIG]:"Argument list too long",[Errno.ENOEXEC]:"Exec format error",[Errno.EBADF]:"Bad file descriptor",[Errno.ECHILD]:"No child processes",[Errno.EAGAIN]:"Resource temporarily unavailable",[Errno.ENOMEM]:"Out of memory",[Errno.EACCES]:"Permission denied",[Errno.EFAULT]:"Bad address",[Errno.ENOTBLK]:"Block device required",[Errno.EBUSY]:"Resource busy or locked",[Errno.EEXIST]:"File exists",[Errno.EXDEV]:"Invalid cross-device link",[Errno.ENODEV]:"No such device",[Errno.ENOTDIR]:"File is not a directory",[Errno.EISDIR]:"File is a directory",[Errno.EINVAL]:"Invalid argument",[Errno.ENFILE]:"Too many open files in system",[Errno.EMFILE]:"Too many open files",[Errno.ETXTBSY]:"Text file busy",[Errno.EFBIG]:"File is too big",[Errno.ENOSPC]:"No space left on disk",[Errno.ESPIPE]:"Illegal seek",[Errno.EROFS]:"Cannot modify a read-only file system",[Errno.EMLINK]:"Too many links",[Errno.EPIPE]:"Broken pipe",[Errno.EDOM]:"Numerical argument out of domain",[Errno.ERANGE]:"Numerical result out of range",[Errno.EDEADLK]:"Resource deadlock would occur",[Errno.ENAMETOOLONG]:"File name too long",[Errno.ENOLCK]:"No locks available",[Errno.ENOSYS]:"Function not implemented",[Errno.ENOTEMPTY]:"Directory is not empty",[Errno.ELOOP]:"Too many levels of symbolic links",[Errno.ENOMSG]:"No message of desired type",[Errno.EIDRM]:"Identifier removed",[Errno.ECHRNG]:"Channel number out of range",[Errno.EL2NSYNC]:"Level 2 not synchronized",[Errno.EL3HLT]:"Level 3 halted",[Errno.EL3RST]:"Level 3 reset",[Errno.ENRNG]:"Link number out of range",[Errno.EUNATCH]:"Protocol driver not attached",[Errno.ECSI]:"No CSI structure available",[Errno.EL2HLT]:"Level 2 halted",[Errno.EBADE]:"Invalid exchange",[Errno.EBADR]:"Invalid request descriptor",[Errno.EXFULL]:"Exchange full",[Errno.ENOANO]:"No anode",[Errno.EBADRQC]:"Invalid request code",[Errno.EBADSLT]:"Invalid slot",[Errno.EBFONT]:"Bad font file format",[Errno.ENOSTR]:"Device not a stream",[Errno.ENODATA]:"No data available",[Errno.ETIME]:"Timer expired",[Errno.ENOSR]:"Out of streams resources",[Errno.ENONET]:"Machine is not on the network",[Errno.ENOPKG]:"Package not installed",[Errno.EREMOTE]:"Object is remote",[Errno.ENOLINK]:"Link has been severed",[Errno.EADV]:"Advertise error",[Errno.ESRMNT]:"Srmount error",[Errno.ECOMM]:"Communication error on send",[Errno.EPROTO]:"Protocol error",[Errno.EMULTIHOP]:"Multihop attempted",[Errno.EDOTDOT]:"RFS specific error",[Errno.EBADMSG]:"Bad message",[Errno.EOVERFLOW]:"Value too large for defined data type",[Errno.ENOTUNIQ]:"Name not unique on network",[Errno.EBADFD]:"File descriptor in bad state",[Errno.EREMCHG]:"Remote address changed",[Errno.ELIBACC]:"Can not access a needed shared library",[Errno.ELIBBAD]:"Accessing a corrupted shared library",[Errno.ELIBSCN]:".lib section in a.out corrupted",[Errno.ELIBMAX]:"Attempting to link in too many shared libraries",[Errno.ELIBEXEC]:"Cannot exec a shared library directly",[Errno.EILSEQ]:"Invalid or incomplete multibyte or wide character",[Errno.ERESTART]:"Interrupted system call should be restarted",[Errno.ESTRPIPE]:"Streams pipe error",[Errno.EUSERS]:"Too many users",[Errno.ENOTSOCK]:"Socket operation on non-socket",[Errno.EDESTADDRREQ]:"Destination address required",[Errno.EMSGSIZE]:"Message too long",[Errno.EPROTOTYPE]:"Protocol wrong type for socket",[Errno.ENOPROTOOPT]:"Protocol not available",[Errno.EPROTONOSUPPORT]:"Protocol not supported",[Errno.ESOCKTNOSUPPORT]:"Socket type not supported",[Errno.ENOTSUP]:"Operation is not supported",[Errno.EPFNOSUPPORT]:"Protocol family not supported",[Errno.EAFNOSUPPORT]:"Address family not supported by protocol",[Errno.EADDRINUSE]:"Address already in use",[Errno.EADDRNOTAVAIL]:"Cannot assign requested address",[Errno.ENETDOWN]:"Network is down",[Errno.ENETUNREACH]:"Network is unreachable",[Errno.ENETRESET]:"Network dropped connection on reset",[Errno.ECONNABORTED]:"Software caused connection abort",[Errno.ECONNRESET]:"Connection reset by peer",[Errno.ENOBUFS]:"No buffer space available",[Errno.EISCONN]:"Transport endpoint is already connected",[Errno.ENOTCONN]:"Transport endpoint is not connected",[Errno.ESHUTDOWN]:"Cannot send after transport endpoint shutdown",[Errno.ETOOMANYREFS]:"Too many references: cannot splice",[Errno.ETIMEDOUT]:"Connection timed out",[Errno.ECONNREFUSED]:"Connection refused",[Errno.EHOSTDOWN]:"Host is down",[Errno.EHOSTUNREACH]:"No route to host",[Errno.EALREADY]:"Operation already in progress",[Errno.EINPROGRESS]:"Operation now in progress",[Errno.ESTALE]:"Stale file handle",[Errno.EEUCLEAN]:"Structure needs cleaning",[Errno.ENOTNAM]:"Not a XENIX named type file",[Errno.ENAVAIL]:"No XENIX semaphores available",[Errno.EISNAM]:"Is a named type file",[Errno.EREMOTEIO]:"Remote I/O error",[Errno.EDQUOT]:"Disk quota exceeded",[Errno.ENOMEDIUM]:"No medium found",[Errno.EMEDIUMTYPE]:"Wrong medium type",[Errno.ECANCELED]:"Operation canceled",[Errno.ENOKEY]:"Required key not available",[Errno.EKEYEXPIRED]:"Key has expired",[Errno.EKEYREVOKED]:"Key has been revoked",[Errno.EKEYREJECTED]:"Key was rejected by service",[Errno.EOWNERDEAD]:"Owner died",[Errno.ENOTRECOVERABLE]:"State not recoverable",[Errno.ERFKILL]:"Operation not possible due to RF-kill",[Errno.EHWPOISON]:"Memory page has hardware error"};function setUVMessage(e){let t=`${e.code}: ${errnoMessages[e.errno]}, ${e.syscall}`;return e.path&&(t+=` '${e.path}'`),e.dest&&(t+=` -> '${e.dest}'`),e.message&&!e.message.startsWith(errnoMessages[e.errno])&&(t+=` (${e.message})`),e.message=t,e}class Exception extends Error{errno;code;path;dest;syscall;constructor(e,t,r={}){const n=Errno[e];super(t||""),this.errno=e,this.code=n,Object.assign(this,omit(r,"message")),t||setUVMessage(this),Error.captureStackTrace?.(this,this.constructor)}toString(){return this.message}toJSON(){const e={errno:this.errno,code:this.code,stack:this.stack,message:this.message};return this.path&&(e.path=this.path),this.dest&&(e.dest=this.dest),this.syscall&&(e.syscall=this.syscall),e}static fromJSON(e){const t=e.syscall?new Exception(e.errno,!1,e):new Exception(e.errno,e.message);return t.stack=e.stack,t}}function UV(e,t,r,n){"string"==typeof t&&(t={syscall:t,path:r,dest:n});const i=new Exception(Errno[e],!1,t??{});return Error.captureStackTrace?.(i,UV),i}function withErrno(e,t){const r=new Exception(Errno[e],t??errnoMessages[Errno[e]]);return Error.captureStackTrace?.(r,withErrno),r}function rethrow(e,t,r){const n="string"==typeof e?{syscall:e}:e;return t&&(n.path=t),function(e){throw Object.assign(e,n),setUVMessage(e),e}}var Level,Level2;Level2=Level||(Level={}),Level2[Level2.EMERG=0]="EMERG",Level2[Level2.ALERT=1]="ALERT",Level2[Level2.CRIT=2]="CRIT",Level2[Level2.ERR=3]="ERR",Level2[Level2.WARN=4]="WARN",Level2[Level2.NOTICE=5]="NOTICE",Level2[Level2.INFO=6]="INFO",Level2[Level2.DEBUG=7]="DEBUG";const entries=new List;function log(e,t){const r={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};entries.add(r),output(r)}function _shortcut$1(e){return function(t){return log(e,t.toString()),t}}_shortcut$1(Level.EMERG);const alert=_shortcut$1(Level.ALERT),crit=_shortcut$1(Level.CRIT),err$1=_shortcut$1(Level.ERR),warn=_shortcut$1(Level.WARN),notice=_shortcut$1(Level.NOTICE),info=_shortcut$1(Level.INFO),debug=_shortcut$1(Level.DEBUG);function timestamp(e){return"["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] "}Level.EMERG,Level.ALERT,Level.CRIT,Level.ERR,Level.WARN,Level.NOTICE,Level.INFO,Level.DEBUG,Level.EMERG,Level.ALERT,Level.CRIT,Level.ERR,Level.WARN,Level.NOTICE,Level.INFO,Level.DEBUG,Level.EMERG,Level.ALERT,Level.CRIT,Level.ERR,Level.WARN,Level.NOTICE,Level.INFO,Level.DEBUG,Level.EMERG,Level.ALERT,Level.CRIT,Level.ERR,Level.WARN,Level.NOTICE,Level.INFO,Level.DEBUG;let _format=e=>[timestamp(e),e.message];function format$2(e){const t=_format(e);return"string"==typeof t?[t]:Array.from(t)}let _output=console.error;function output(e){e.level>minLevel||_output(...format$2(e))}let minLevel=Level.ALERT;function createCredentials(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}function credentialsAllowRoot(e){return!!e&&(!e.uid||!e.gid||!e.euid||!e.egid||e.groups.some((e=>!e)))}const kIsContext=Symbol("ZenFSContext"),defaultContext={[kIsContext]:!0,id:0,root:"/",pwd:"/",credentials:createCredentials({uid:0,gid:0}),descriptors:new Map,parent:null,children:[]};function contextOf(e){return"object"==typeof e&&null!==e&&kIsContext in e?e:defaultContext}const F_OK=0,R_OK=4,W_OK=2,X_OK=1,COPYFILE_EXCL=1,COPYFILE_FICLONE=2,COPYFILE_FICLONE_FORCE=4,O_RDONLY=0,O_WRONLY=1,O_RDWR=2,O_CREAT=64,O_EXCL=128,O_NOCTTY=256,O_TRUNC=512,O_APPEND=1024,O_DIRECTORY=65536,O_NOATIME=262144,O_NOFOLLOW=131072,O_SYNC=1052672,O_DSYNC=4096,O_SYMLINK=32768,O_DIRECT=16384,O_NONBLOCK=2048,S_IFMT=61440,S_IFSOCK=49152,S_IFLNK=40960,S_IFREG=32768,S_IFBLK=24576,S_IFDIR=16384,S_IFCHR=8192,S_IFIFO=4096,S_ISUID=2048,S_ISGID=1024,S_ISVTX=512,S_IRWXU=448,S_IRUSR=256,S_IWUSR=128,S_IXUSR=64,S_IRWXG=56,S_IRGRP=32,S_IWGRP=16,S_IXGRP=8,S_IRWXO=7,S_IROTH=4,S_IWOTH=2,S_IXOTH=1,UV_FS_O_FILEMAP=0,size_max=4294967295,constants$1=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:COPYFILE_EXCL,COPYFILE_FICLONE:COPYFILE_FICLONE,COPYFILE_FICLONE_FORCE:COPYFILE_FICLONE_FORCE,F_OK:F_OK,O_APPEND:O_APPEND,O_CREAT:O_CREAT,O_DIRECT:O_DIRECT,O_DIRECTORY:O_DIRECTORY,O_DSYNC:O_DSYNC,O_EXCL:O_EXCL,O_NOATIME:O_NOATIME,O_NOCTTY:O_NOCTTY,O_NOFOLLOW:O_NOFOLLOW,O_NONBLOCK:O_NONBLOCK,O_RDONLY:O_RDONLY,O_RDWR:O_RDWR,O_SYMLINK:O_SYMLINK,O_SYNC:O_SYNC,O_TRUNC:O_TRUNC,O_WRONLY:O_WRONLY,R_OK:R_OK,S_IFBLK:S_IFBLK,S_IFCHR:S_IFCHR,S_IFDIR:S_IFDIR,S_IFIFO:S_IFIFO,S_IFLNK:S_IFLNK,S_IFMT:S_IFMT,S_IFREG:S_IFREG,S_IFSOCK:S_IFSOCK,S_IRGRP:S_IRGRP,S_IROTH:S_IROTH,S_IRUSR:S_IRUSR,S_IRWXG:S_IRWXG,S_IRWXO:S_IRWXO,S_IRWXU:S_IRWXU,S_ISGID:S_ISGID,S_ISUID:S_ISUID,S_ISVTX:S_ISVTX,S_IWGRP:S_IWGRP,S_IWOTH:S_IWOTH,S_IWUSR:S_IWUSR,S_IXGRP:S_IXGRP,S_IXOTH:S_IXOTH,S_IXUSR:S_IXUSR,UV_FS_O_FILEMAP:UV_FS_O_FILEMAP,W_OK:W_OK,X_OK:X_OK,size_max:size_max},Symbol.toStringTag,{value:"Module"}));function StructArray(e){class t extends DataView{length;type=e;*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this[e]}constructor(t,r,n){return super("object"==typeof t?t:new ArrayBuffer((t??0)*e.size),r,n),this.length="number"==typeof t?t:Math.floor(this.byteLength/e.size),new Proxy(this,{get(t,r){if(r in t)return t[r];const n=parseInt(r.toString());if(!Number.isSafeInteger(n))throw withErrno("EINVAL","Invalid index: "+r.toString());return e.get(t.buffer,t.byteOffset+n*e.size)},set(t,r,n){const i=parseInt(r.toString());if(!Number.isSafeInteger(i))throw withErrno("EINVAL","Invalid index: "+r.toString());return e.set(t.buffer,t.byteOffset+i*e.size,n),!0}})}}for(const r of Object.getOwnPropertyNames(DataView.prototype))(r.startsWith("get")||r.startsWith("set"))&&Object.defineProperty(t.prototype,r,{enumerable:!1,configurable:!1,writable:!1,value:void 0});return t}class ArrayType{type;length;name;size;__arrayType;constructor(e,t){this.type=e,this.length=t,this.name=`${e.name}[${t}]`,this.size=e.size*t,this.array=StructArray(this),this.__arrayType=e.array?e.array:StructArray(e)}get=(e,t)=>new this.__arrayType(e,t,this.size);set=(e,t,r)=>{for(let n=0;n<this.length;n++)this.type.set(e,t+n*this.type.size,r[n])};array}function isType(e){return("object"==typeof e||"function"==typeof e)&&null!=e&&(e instanceof ArrayType?isType(e.type):"name"in e&&"size"in e&&"get"in e&&"set"in e&&"string"==typeof e.name&&"number"==typeof e.size&&"function"==typeof e.get&&"function"==typeof e.set&&typeRegistry.has(e.name)&&typeRegistry.get(e.name)?.name===e.name)}const typeRegistry=new Map;function registerType(e){if(typeRegistry.has(e.name))throw new ReferenceError(`Type is already registered: ${e.name}`);typeRegistry.set(e.name,e)}function parseFieldConfig(e){return isType(e)?{type:e}:e instanceof FieldBuilder?e.toInit():e}class FieldBuilder{type;init;constructor(e,t){this.type=e,this.init=t;const r=r=>new FieldBuilder(new ArrayType(e,r),t);return Object.setPrototypeOf(r,new.target.prototype),Object.assign(r,{type:e,init:t}),r}align(e){return new FieldBuilder(this.type,{...this.init,align:e})}countedBy(e){return new FieldBuilder(this.type,{...this.init,countedBy:e})}bigEndian(){return new FieldBuilder(this.type,{...this.init,bigEndian:!0})}toInit(){return{type:this.type,...this.init}}$type(){return new FieldBuilder(this.type,this.init)}}function array(e,t=0){return new FieldBuilder(new ArrayType(e,t),{})}function __fieldInit(e,t,r={}){if(!e)throw withErrno("EINVAL","Invalid name for struct field");const n=e.toString(),i=Object.assign(parseFieldConfig(t),r);if(!isType(i.type))throw withErrno("EINVAL",`Invalid type for struct field "${n}"`);return{name:n,offset:0,type:i.type,countedBy:i.countedBy,alignment:i.align??i.type.size,decl:i.type instanceof ArrayType?`${i.typeName??i.type.type.name} ${n}[${i.type.length}]${i.countedBy?` counted_by(${i.countedBy})`:""}`:`${i.typeName??i.type.name} ${n}`,littleEndian:!i.bigEndian}}function __fault(e){throw"offset is outside the bounds of the DataView"!==e.message?e:withErrno("EFAULT","Segmentation fault")}function __fieldSet(e,t,r,n){try{"string"==typeof r&&(r=r.charCodeAt(0));const i=e.byteOffset+t.offset+(n??0)*t.type.size;return void t.type.set(e.buffer,i,r)}catch(i){__fault(i)}}function __fieldGet(e,t){try{return t.type.get(e.buffer,e.byteOffset+t.offset)}catch(r){__fault(r)}}const __view__=Symbol("DataView");function view(e){return e[__view__]??=new DataView(e),e[__view__]}const int8={name:"int8",size:1,array:Int8Array,get:(e,t)=>view(e).getInt8(t),set:(e,t,r)=>view(e).setInt8(t,r)},uint8={name:"uint8",size:1,array:Uint8Array,get:(e,t)=>view(e).getUint8(t),set:(e,t,r)=>view(e).setUint8(t,r)},int16={name:"int16",size:2,array:Int16Array,get:(e,t)=>view(e).getInt16(t,!0),set:(e,t,r)=>view(e).setInt16(t,r,!0)},uint16={name:"uint16",size:2,array:Uint16Array,get:(e,t)=>view(e).getUint16(t,!0),set:(e,t,r)=>view(e).setUint16(t,r,!0)},int32={name:"int32",size:4,array:Int32Array,get:(e,t)=>view(e).getInt32(t,!0),set:(e,t,r)=>view(e).setInt32(t,r,!0)},uint32={name:"uint32",size:4,array:Uint32Array,get:(e,t)=>view(e).getUint32(t,!0),set:(e,t,r)=>view(e).setUint32(t,r,!0)},int64={name:"int64",size:8,array:BigInt64Array,get:(e,t)=>view(e).getBigInt64(t,!0),set:(e,t,r)=>view(e).setBigInt64(t,r,!0)},uint64={name:"uint64",size:8,array:BigUint64Array,get:(e,t)=>view(e).getBigUint64(t,!0),set:(e,t,r)=>view(e).setBigUint64(t,r,!0)},float32={name:"float32",size:4,array:Float32Array,get:(e,t)=>view(e).getFloat32(t,!0),set:(e,t,r)=>view(e).setFloat32(t,r,!0)},float64={name:"float64",size:8,array:Float64Array,get:(e,t)=>view(e).getFloat64(t,!0),set:(e,t,r)=>view(e).setFloat64(t,r,!0)},types$2={int8:int8,uint8:uint8,int16:int16,uint16:uint16,int32:int32,uint32:uint32,int64:int64,uint64:uint64,float32:float32,float64:float64},typeNames=Object.keys(types$2);for(const I of Object.values(types$2))registerType(I);const rawTypes={...types$2,...Object.fromEntries(typeNames.map((e=>[capitalize(e),types$2[e]]))),char:uint8},validNames=Object.keys(rawTypes);function isValid(e){return validNames.includes(e.toString())}function checkValid(e){if(!isValid(e))throw withErrno("EINVAL","Not a valid primitive type: "+e)}function normalize$3(e){return"char"==e?"uint8":e.toLowerCase()}function initMetadata(e){e.metadata??={};const t=e.metadata.structInit??{};return e.metadata.structInit={fields:[...t.fields??[]]},e.metadata.structInit}function struct$1(e,...t){const r=t.reduce(((e,t)=>({...e,...t})),{});return"object"==typeof this&&Object.assign(r,this),function(t,n){const i=initMetadata(n);let o=1;const a={};let s=0;const l=e=>{s=Math.ceil(s/e)*e};for(const e of i.fields)r.isPacked||l(e.alignment),r.isUnion?s=Math.max(s,e.type.size):(e.offset=s,s+=e.type.size),a[e.name]=e,o=Math.max(o,e.alignment);r.alignment??=o,r.isPacked||l(r.alignment),n.metadata.struct={fields:a,size:s,alignment:r.isPacked?1:r.alignment,isUnion:r.isUnion??!1};class c extends t{constructor(...e){e.length||(e=[new ArrayBuffer(s),0,s]),super(...e);for(const t of Object.values(a))Object.defineProperty(this,t.name,{enumerable:!0,configurable:!0,get(){return __fieldGet(this,t)},set(e){__fieldSet(this,t,e)}})}}const u=e=>({writable:!1,enumerable:!1,configurable:!1,value:e});return Object.defineProperties(c,{name:u(e),size:u(s),alignment:u(r.alignment),isUnion:u(!!r.isUnion),fields:u(a),get:u(((e,t)=>new c(e,t))),set:u(((e,t,r)=>{const n=new Uint8Array(r.buffer,r.byteOffset,s),i=new Uint8Array(e,t,s);if(r.buffer!==e||r.byteOffset!==t)for(let o=0;o<s;o++)i[o]=n[o]})),[Symbol.toStringTag]:u(`[struct ${e}]`)}),registerType(c),c}}function field(e,t={}){return function(r,n){if("accessor"!=n.kind)throw withErrno("EINVAL","Field must be an accessor");const i=initMetadata(n),o=__fieldInit(n.name,e,t);return i.fields.push(o),{get(){return __fieldGet(this,o)},set(e){__fieldSet(this,o,e)}}}}function _shortcut(e){const t=types$2[normalize$3(e)];return function(r,n){return"number"==typeof r?field(new ArrayType(t,r),{typeName:e,...n}):field(t,{typeName:e})(r,n&&"name"in n?n:_throw(withErrno("EINVAL","Invalid decorator context object")))}}Symbol.metadata??=Symbol.for("Symbol.metadata"),struct$1.packed=struct$1.bind({isPacked:!0}),struct$1.align=function(e){return struct$1.bind({alignment:e})};const types$1=Object.fromEntries(validNames.map((e=>[e,_shortcut(e)])));function $from(e){return e}function isStructConstructor(e){return"function"==typeof e&&"prototype"in e&&"fields"in e&&"object"==typeof e.fields&&isType(e)}function struct(e,t,...r){const n=r.reduce(((e,t)=>({...e,...t})),{});"object"==typeof this&&Object.assign(n,this);let i=1,o=0;const a=e=>{o=Math.ceil(o/e)*e},s=Object.create(null);for(const[h,d]of Object.entries(t)){if("number"==typeof h)throw new TypeError("Field names can not be numbers");const e=__fieldInit(h,d);n.isPacked||a(e.alignment),n.isUnion?o=Math.max(o,e.type.size):(e.offset=o,o+=e.type.size),s[e.name]=e,i=Math.max(i,e.alignment)}n.alignment??=i,n.isPacked||a(n.alignment);class l extends DataView{constructor(e=new ArrayBuffer(o),t,r){super(e,t,r??o);for(const n of Object.values(s))Object.defineProperty(this,n.name,{enumerable:!0,configurable:!0,get(){return __fieldGet(this,n)},set(e){__fieldSet(this,n,e)}})}}__publicField(l,"name",e);for(const h of Object.getOwnPropertyNames(DataView.prototype))(h.startsWith("get")||h.startsWith("set"))&&Object.defineProperty(l.prototype,h,{enumerable:!1,configurable:!1,writable:!1,value:void 0});const c=l,u=e=>({writable:!1,enumerable:!1,configurable:!1,value:e});return Object.defineProperties(c,{size:u(o),alignment:u(n.alignment),isUnion:u(!!n.isUnion),fields:u(s),get:u(((e,t)=>new c(e,t))),set:u(((e,t,r)=>{const n=new Uint8Array(r.buffer,r.byteOffset,o),i=new Uint8Array(e,t,o);if(r.buffer!==e||r.byteOffset!==t)for(let a=0;a<o;a++)i[a]=n[a]})),[Symbol.toStringTag]:u(`[struct ${e}]`)}),registerType(c),c}function sizeof(e){if(isType(e))return e.size;if(null==e)return 0;if("object"==typeof e&&isType(e.constructor))return e.constructor.size;if(Array.isArray(e)){let t=0;for(let r=0;r<e.length;r++)t+=sizeof(e[r]);return t}if("string"==typeof e)return checkValid(e),types$2[normalize$3(e)].size;throw new TypeError(`Unable to resolve size of \`${e.toString()}\``)}function offsetof(e,t){let r;if(isStructConstructor(e))r=e;else{if(!isStructConstructor(e.constructor))throw withErrno("EINVAL","Type is not a struct or struct constructor");r=e.constructor}const{fields:n}=r;if(!(t in n))throw withErrno("EINVAL","Struct does not have field: "+t);return n[t].offset}function extendBuffer(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=extendBuffer(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const r="undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return r?e.grow(t):e.resize(t),e;if(r){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}$from.typed=function(e){return e},struct.extend=function(e,t,r,...n){return struct(t,{...e.fields,...r},...n)},struct.packed=struct.bind({isPacked:!0}),struct.align=function(e){return struct.bind({alignment:e})},Object.fromEntries(Object.entries(rawTypes).map((([e,t])=>[e,new FieldBuilder(t,{typeName:e})])));class BufferView extends DataView{constructor(e,t,r){const{buffer:n,byteOffset:i,byteLength:o}=new Uint8Array(e,t,r);super(n,i,o)}}for(const I of Object.getOwnPropertyNames(DataView.prototype))(I.startsWith("get")||I.startsWith("set"))&&Object.defineProperty(BufferView.prototype,I,{value:()=>{throw new ReferenceError("Do not use DataView methods on a BufferView.")},writable:!1,enumerable:!1,configurable:!1});function decodeDirListing(e){return JSON.parse(decodeUTF8(e),((e,t)=>""==e?t:"string"==typeof t?BigInt(t).toString(16).slice(0,Math.min(t.length,8)):t))}function encodeDirListing(e){return encodeUTF8(JSON.stringify(e))}function normalizeMode(e,t){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e,8);if(!isNaN(t))return t}if("number"==typeof t)return t;throw withErrno("EINVAL","Invalid mode: "+e?.toString())}function normalizeTime(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw withErrno("EINVAL","Invalid time.")}}function normalizePath(e,t=!1){if(e instanceof URL){if("file:"!=e.protocol)throw withErrno("EINVAL","URLs must use the file: protocol");e=e.pathname}if((e=e.toString()).startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw withErrno("EINVAL","Path can not contain null character");if(0==e.length)throw withErrno("EINVAL","Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:resolve$2.call(this,e)}function normalizeOptions(e,t="utf8",r,n=0){return"object"!=typeof e||null===e?{encoding:"string"==typeof e?e:t??null,flag:r,mode:n}:{encoding:"string"==typeof e?.encoding?e.encoding:t??null,flag:"string"==typeof e?.flag?e.flag:r,mode:normalizeMode("mode"in e?e?.mode:null,n)}}function globToRegex(e){return e=e.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${e}$`)}function _tempDirName(e){return`/tmp/${normalizePath(e,!0)}${Date.now()}-${Math.random().toString(36).slice(2)}`}function normalizeString(e,t){let r="",n=0,i=-1,o=0,a="\0";for(let s=0;s<=e.length;++s){if(s<e.length)a=e[s];else{if("/"==a)break;a="/"}if("/"==a){if(i===s-1||1===o);else if(2===o){if(r.length<2||2!==n||"."!==r.at(-1)||"."!==r.at(-2)){if(r.length>2){const e=r.lastIndexOf("/");-1===e?(r="",n=0):(r=r.slice(0,e),n=r.length-1-r.lastIndexOf("/")),i=s,o=0;continue}if(0!==r.length){r="",n=0,i=s,o=0;continue}}t&&(r+=r.length>0?"/..":"..",n=2)}else r.length>0?r+="/"+e.slice(i+1,s):r=e.slice(i+1,s),n=s-i-1;i=s,o=0}else"."===a&&-1!==o?++o:o=-1}return r}function resolve$2(...e){let t="";for(const n of[...e.reverse(),contextOf(this).pwd])if(n?.length&&(t=`${n}/${t}`,n.startsWith("/")))break;const r=t.startsWith("/");return t=normalizeString(t,!r),r?`/${t}`:t.length?t:"/"}function normalize$2(e){if(!e.length)return".";const t="/"===e[0],r="/"===e.at(-1);return(e=normalizeString(e,!t)).length?(r&&(e+="/"),t?`/${e}`:e):t?"/":r?"./":"."}function join(...e){if(!e.length)return".";const t=e.filter((e=>e)).join("/");return t?.length?normalize$2(t):"."}function relative(e,t){if(e===t)return"";if((e=resolve$2.call(this,e))===(t=resolve$2.call(this,t)))return"";const r=e.length,n=r-1,i=t.length-1,o=n<i?n:i;let a=-1,s=0;for(;s<o;s++){const r=e[1+s];if(r!==t[1+s])break;"/"===r&&(a=s)}if(s===o)if(i>o){if("/"===t[1+s])return t.slice(1+s+1);if(0===s)return t.slice(1+s)}else n>o&&("/"===e[1+s]?a=s:0===s&&(a=0));let l="";for(s=1+a+1;s<=r;++s)s!==r&&"/"!==e[s]||(l+=0===l.length?"..":"/..");return`${l}${t.slice(1+a)}`}function dirname(e){if(0===e.length)return".";const t="/"===e[0];let r=-1,n=!0;for(let i=e.length-1;i>=1;--i)if("/"===e[i]){if(!n){r=i;break}}else n=!1;return-1===r?t?"/":".":t&&1===r?"//":e.slice(0,r)}function basename(e,t){let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if("/"===e[o]){if(!i){r=o+1;break}}else-1===n&&(i=!1,n=o+1);return-1===n?"":e.slice(r,n)}function parse$2(e){const t="/"===e[0],r={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;const n=t?1:0;let i=-1,o=0,a=-1,s=!0,l=e.length-1,c=0;for(;l>=n;--l)if("/"!==e[l])-1===a&&(s=!1,a=l+1),"."===e[l]?-1===i?i=l:1!==c&&(c=1):-1!==i&&(c=-1);else if(!s){o=l+1;break}if(-1!==a){const n=0===o&&t?1:o;-1===i||0===c||1===c&&i===a-1&&i===o+1?r.base=r.name=e.slice(n,a):(r.name=e.slice(n,i),r.base=e.slice(n,a),r.ext=e.slice(i,a))}return o>0?r.dir=e.slice(0,o-1):t&&(r.dir="/"),r}function matchesGlob(e,t){return globToRegex(e).test(t)}const n1000=BigInt(1e3);class StatsCommon{_convert(e){return this._isBigint?BigInt(e):Number(e)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(e){}mode;dev=this._convert(0);ino=this._convert(0);rdev=this._convert(0);nlink=this._convert(1);blksize=this._convert(4096);uid=this._convert(0);gid=this._convert(0);atimeMs;get atime(){return new Date(Number(this.atimeMs))}set atime(e){this.atimeMs=this._convert(e.getTime())}mtimeMs;get mtime(){return new Date(Number(this.mtimeMs))}set mtime(e){this.mtimeMs=this._convert(e.getTime())}ctimeMs;get ctime(){return new Date(Number(this.ctimeMs))}set ctime(e){this.ctimeMs=this._convert(e.getTime())}birthtimeMs;get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(e){this.birthtimeMs=this._convert(e.getTime())}size;data;flags;version;constructor({atimeMs:e,mtimeMs:t,ctimeMs:r,birthtimeMs:n,uid:i,gid:o,size:a,mode:s,ino:l,...c}={}){const u=Date.now();this.atimeMs=this._convert(e??u),this.mtimeMs=this._convert(t??u),this.ctimeMs=this._convert(r??u),this.birthtimeMs=this._convert(n??u),this.uid=this._convert(i??0),this.gid=this._convert(o??0),this.size=this._convert(a??0),this.ino=this._convert(l??0),this.mode=this._convert(s??420&S_IFREG),this.mode&S_IFMT||(this.mode=this.mode|this._convert(S_IFREG)),Object.assign(this,c)}isFile(){return(this.mode&S_IFMT)===S_IFREG}isDirectory(){return(this.mode&S_IFMT)===S_IFDIR}isSymbolicLink(){return(this.mode&S_IFMT)===S_IFLNK}isSocket(){return(this.mode&S_IFMT)===S_IFSOCK}isBlockDevice(){return(this.mode&S_IFMT)===S_IFBLK}isCharacterDevice(){return(this.mode&S_IFMT)===S_IFCHR}isFIFO(){return(this.mode&S_IFMT)===S_IFIFO}toJSON(){return pick(this,_inode_fields)}hasAccess(e,t){return hasAccess(t,this._isBigint?new Stats(this):this,e)}get atimeNs(){return BigInt(this.atimeMs)*n1000}get mtimeNs(){return BigInt(this.mtimeMs)*n1000}get ctimeNs(){return BigInt(this.ctimeMs)*n1000}get birthtimeNs(){return BigInt(this.birthtimeMs)*n1000}}class Stats extends StatsCommon{_isBigint=!1}class BigIntStats extends StatsCommon{_isBigint=!0}function isStatsEqual(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class StatsFs{type=525687744115;bsize=4096;blocks=0;bfree=0;bavail=0;files=size_max;ffree=size_max}class BigIntStatsFs{type=BigInt("0x7a656e6673");bsize=BigInt(4096);blocks=BigInt(0);bfree=BigInt(0);bavail=BigInt(0);files=BigInt(size_max);ffree=BigInt(size_max)}var __esDecorate$2=function(e,t,r,n,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var g=(0,r[p])("accessor"===l?{get:h.get,set:h.set}:h[c],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(h.get=s),(s=a(g.set))&&(h.set=s),(s=a(g.init))&&i.unshift(s)}else(s=a(g))&&("field"===l?i.unshift(s):h[c]=s)}u&&Object.defineProperty(u,n.name,h),d=!0},__runInitializers$2=function(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0};const rootIno=0,maxDynamicData=3968;let Attribute=(()=>{var e,t,r,n,i;let o,a,s,l,c=[struct$1.packed("Attribute")],u=[],h=$from.typed(Uint8Array),d=[],p=[],f=[],m=[];return r=class extends h{constructor(){super(...arguments),__privateAdd(this,e,__runInitializers$2(this,d,void 0)),__privateAdd(this,t,(__runInitializers$2(this,p),__runInitializers$2(this,f,void 0))),__runInitializers$2(this,m)}get keySize(){return __privateGet(this,e)}set keySize(t){__privateSet(this,e,t)}get valueSize(){return __privateGet(this,t)}set valueSize(e){__privateSet(this,t,e)}get name(){return decodeUTF8(this.subarray(8,8+this.keySize))}set name(e){const t=encodeUTF8(e);if(8+t.length+this.valueSize>maxDynamicData)throw withErrno("EOVERFLOW");this.set(t,8),this.keySize=t.length}get value(){return this.subarray(8+this.keySize,this.size)}set value(e){if(8+this.keySize+e.length>maxDynamicData)throw withErrno("EOVERFLOW");this.valueSize=e.length,this.set(e,8+this.keySize)}get size(){return 8+this.keySize+this.valueSize}},e=new WeakMap,t=new WeakMap,a=r,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(h[Symbol.metadata]??null):void 0;s=[(n=types$1).uint32.bind(n)],l=[(i=types$1).uint32.bind(i)],__esDecorate$2(r,null,s,{kind:"accessor",name:"keySize",static:!1,private:!1,access:{has:e=>"keySize"in e,get:e=>e.keySize,set:(e,t)=>{e.keySize=t}},metadata:e},d,p),__esDecorate$2(r,null,l,{kind:"accessor",name:"valueSize",static:!1,private:!1,access:{has:e=>"valueSize"in e,get:e=>e.valueSize,set:(e,t)=>{e.valueSize=t}},metadata:e},f,m),__esDecorate$2(null,o={value:a},c,{kind:"class",name:a.name,metadata:e},null,u),a=o.value,e&&Object.defineProperty(a,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers$2(a,u)})(),a})(),Attributes=(()=>{var e,t,r;let n,i,o,a=[struct$1.packed("Attributes")],s=[],l=$from(BufferView),c=[],u=[];return t=class extends l{constructor(){super(...arguments),__privateAdd(this,e,__runInitializers$2(this,c,void 0)),__runInitializers$2(this,u)}get size(){return __privateGet(this,e)}set size(t){__privateSet(this,e,t)}get byteSize(){let e=this.byteOffset+sizeof(this);for(let t=0;t<this.size;t++){e+=new Attribute(this.buffer,e).size}return e}has(e){let t=this.byteOffset+sizeof(this);for(let r=0;r<this.size;r++){const r=new Attribute(this.buffer,t);if(r.name==e)return!0;t+=r.size}return!1}get(e){let t=this.byteOffset+sizeof(this);for(let r=0;r<this.size;r++){const r=new Attribute(this.buffer,t);if(r.name==e)return r.value;t+=r.size}}set(e,t){let r,n=this.byteOffset+sizeof(this);for(let a=0;a<this.size;a++){const t=new Attribute(this.buffer,n);t.name==e&&(r=[n,t.size]),n+=t.size}const i=new Uint8Array(this.buffer);if(r){const[e,t]=r;n-=t,i.copyWithin(e,e+t,n+t),i.fill(0,n,n+t),this.size--}const o=new Attribute(this.buffer,n);o.name=e,o.value=t,this.size++}remove(e){let t,r=this.byteOffset+sizeof(this);for(let a=0;a<this.size;a++){const n=new Attribute(this.buffer,r);n.name==e&&(t=[r,n.size]),r+=n.size}if(!t)return!1;const[n,i]=t,o=new Uint8Array(this.buffer);return o.copyWithin(n,n+i,r),o.fill(0,r-i,r),this.size--,!0}copyFrom(e){const{byteSize:t}=e;new Uint8Array(this.buffer,this.byteOffset,t).set(new Uint8Array(e.buffer,e.byteOffset,t))}*keys(){let e=this.byteOffset+sizeof(this);for(let t=0;t<this.size;t++){const t=new Attribute(this.buffer,e);yield t.name,e+=t.size}}*values(){let e=this.byteOffset+sizeof(this);for(let t=0;t<this.size;t++){const t=new Attribute(this.buffer,e);yield t.value,e+=t.size}}*entries(){let e=this.byteOffset+sizeof(this);for(let t=0;t<this.size;t++){const t=new Attribute(this.buffer,e);yield[t.name,t.value],e+=t.size}}},e=new WeakMap,i=t,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(l[Symbol.metadata]??null):void 0;o=[(r=types$1).uint32.bind(r)],__esDecorate$2(t,null,o,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:e},c,u),__esDecorate$2(null,n={value:i},a,{kind:"class",name:i.name,metadata:e},null,s),i=n.value,e&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers$2(i,s)})(),i})();const _inode_fields=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],_inode_version=5;var InodeFlags,InodeFlags2;InodeFlags2=InodeFlags||(InodeFlags={}),InodeFlags2[InodeFlags2.Sync=1]="Sync",InodeFlags2[InodeFlags2.NoAtime=2]="NoAtime",InodeFlags2[InodeFlags2.Append=4]="Append",InodeFlags2[InodeFlags2.Immutable=8]="Immutable",InodeFlags2[InodeFlags2.Dead=16]="Dead",InodeFlags2[InodeFlags2.NoQuota=32]="NoQuota",InodeFlags2[InodeFlags2.Dirsync=64]="Dirsync",InodeFlags2[InodeFlags2.NoCMtime=128]="NoCMtime",InodeFlags2[InodeFlags2.SwapFile=256]="SwapFile",InodeFlags2[InodeFlags2.Private=512]="Private",InodeFlags2[InodeFlags2.IMA=1024]="IMA",InodeFlags2[InodeFlags2.AutoMount=2048]="AutoMount",InodeFlags2[InodeFlags2.NoSec=4096]="NoSec",InodeFlags2[InodeFlags2.DAX=8192]="DAX",InodeFlags2[InodeFlags2.Encrypted=16384]="Encrypted",InodeFlags2[InodeFlags2.CaseFold=32768]="CaseFold",InodeFlags2[InodeFlags2.Verity=65536]="Verity",InodeFlags2[InodeFlags2.KernelFile=131072]="KernelFile";let Inode=(()=>{var e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C,I,k,P,M,R,D,O,L;let B,$,z,F,q,N,j,U,V,G,W,H,Z,Y,X,K,Q,J,ee,te,re,ne=[struct$1.packed("Inode")],ie=[],oe=$from(BufferView),ae=[],se=[],le=[],ce=[],ue=[],he=[],de=[],pe=[],fe=[],me=[],ge=[],ye=[],_e=[],ve=[],be=[],we=[],xe=[],Se=[],Ee=[],Te=[],Ae=[],Ce=[],Ie=[],ke=[],Pe=[],Me=[],Re=[],De=[],Oe=[],Le=[],Be=[],$e=[],ze=[],Fe=[],qe=[],Ne=[],je=[],Ue=[];var Ve=(v=class extends oe{constructor(...v){let b={};if("object"!=typeof v[0]||null===v[0]||ArrayBuffer.isView(v[0])||(b=v[0],v=[sizeof(Ve)]),super(...v),__privateAdd(this,e,__runInitializers$2(this,ae,void 0)),__privateAdd(this,t,(__runInitializers$2(this,se),__runInitializers$2(this,le,void 0))),__privateAdd(this,r,(__runInitializers$2(this,ce),__runInitializers$2(this,ue,void 0))),__privateAdd(this,n,(__runInitializers$2(this,he),__runInitializers$2(this,de,void 0))),__privateAdd(this,i,(__runInitializers$2(this,pe),__runInitializers$2(this,fe,void 0))),__privateAdd(this,o,(__runInitializers$2(this,me),__runInitializers$2(this,ge,void 0))),__privateAdd(this,a,(__runInitializers$2(this,ye),__runInitializers$2(this,_e,void 0))),__privateAdd(this,s,(__runInitializers$2(this,ve),__runInitializers$2(this,be,void 0))),__privateAdd(this,l,(__runInitializers$2(this,we),__runInitializers$2(this,xe,void 0))),__privateAdd(this,c,(__runInitializers$2(this,Se),__runInitializers$2(this,Ee,void 0))),__privateAdd(this,u,(__runInitializers$2(this,Te),__runInitializers$2(this,Ae,void 0))),__privateAdd(this,h,(__runInitializers$2(this,Ce),__runInitializers$2(this,Ie,void 0))),__privateAdd(this,d,(__runInitializers$2(this,ke),__runInitializers$2(this,Pe,void 0))),__privateAdd(this,p,(__runInitializers$2(this,Me),__runInitializers$2(this,Re,void 0))),__privateAdd(this,f,(__runInitializers$2(this,De),__runInitializers$2(this,Oe,void 0))),__privateAdd(this,m,(__runInitializers$2(this,Le),__runInitializers$2(this,Be,void 0))),__privateAdd(this,g,(__runInitializers$2(this,$e),__runInitializers$2(this,ze,void 0))),__privateAdd(this,y,(__runInitializers$2(this,Fe),__runInitializers$2(this,qe,void 0))),__privateAdd(this,_,(__runInitializers$2(this,Ne),__runInitializers$2(this,je,void 0))),__runInitializers$2(this,Ue),this.byteLength<sizeof(Ve))throw crit(withErrno("EIO",`Buffer is too small to create an inode (${this.byteLength} bytes)`));Object.assign(this,b),this.atimeMs||=Date.now(),this.mtimeMs||=Date.now(),this.ctimeMs||=Date.now(),this.birthtimeMs||=Date.now(),this.ino&&!this.nlink&&warn(`Inode ${this.ino} has an nlink of 0`)}get data(){return __privateGet(this,e)}set data(t){__privateSet(this,e,t)}get __data_old(){return __privateGet(this,t)}set __data_old(e){__privateSet(this,t,e)}get size(){return __privateGet(this,r)}set size(e){__privateSet(this,r,e)}get mode(){return __privateGet(this,n)}set mode(e){__privateSet(this,n,e)}get nlink(){return __privateGet(this,i)}set nlink(e){__privateSet(this,i,e)}get uid(){return __privateGet(this,o)}set uid(e){__privateSet(this,o,e)}get gid(){return __privateGet(this,a)}set gid(e){__privateSet(this,a,e)}get atimeMs(){return __privateGet(this,s)}set atimeMs(e){__privateSet(this,s,e)}get birthtimeMs(){return __privateGet(this,l)}set birthtimeMs(e){__privateSet(this,l,e)}get mtimeMs(){return __privateGet(this,c)}set mtimeMs(e){__privateSet(this,c,e)}get ctimeMs(){return __privateGet(this,u)}set ctimeMs(e){__privateSet(this,u,e)}get ino(){return __privateGet(this,h)}set ino(e){__privateSet(this,h,e)}get __ino_old(){return __privateGet(this,d)}set __ino_old(e){__privateSet(this,d,e)}get flags(){return __privateGet(this,p)}set flags(e){__privateSet(this,p,e)}get __after_flags(){return __privateGet(this,f)}set __after_flags(e){__privateSet(this,f,e)}get version(){return __privateGet(this,m)}set version(e){__privateSet(this,m,e)}get __padding(){return __privateGet(this,g)}set __padding(e){__privateSet(this,g,e)}get attributes(){return __privateGet(this,y)}set attributes(e){__privateSet(this,y,e)}get __data(){return __privateGet(this,_)}set __data(e){__privateSet(this,_,e)}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...pick(this,_inode_fields),attributes:this.attributes}}toStats(){return new Stats(this)}update(e){if(!e)return!1;let t=!1;for(const r of _inode_fields)void 0!==e[r]&&"ino"!=r&&"data"!=r&&this[r]!==e[r]&&("atimeMs"==r&&this.flags&InodeFlags.NoAtime||(this[r]=e[r],t=!0));return e.attributes&&(this.attributes.copyFrom(e.attributes),t=!0),t&&(this.ctimeMs=Date.now()),t}},e=new WeakMap,t=new WeakMap,r=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,s=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,_=new WeakMap,$=v,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(oe[Symbol.metadata]??null):void 0;z=[(b=types$1).uint32.bind(b)],F=[(w=types$1).uint32.bind(w)],q=[(x=types$1).uint32.bind(x)],N=[(S=types$1).uint16.bind(S)],j=[(E=types$1).uint32.bind(E)],U=[(T=types$1).uint32.bind(T)],V=[(A=types$1).uint32.bind(A)],G=[(C=types$1).float64.bind(C)],W=[(I=types$1).float64.bind(I)],H=[(k=types$1).float64.bind(k)],Z=[(P=types$1).float64.bind(P)],Y=[(M=types$1).uint32.bind(M)],X=[(R=types$1).uint32.bind(R)],K=[(D=types$1).uint32.bind(D)],Q=[(O=types$1).uint16.bind(O)],J=[(L=types$1).uint32.bind(L)],ee=[types$1.uint8(48)],te=[field(Attributes)],re=[types$1.uint8(maxDynamicData)],__esDecorate$2(v,null,z,{kind:"accessor",name:"data",static:!1,private:!1,access:{has:e=>"data"in e,get:e=>e.data,set:(e,t)=>{e.data=t}},metadata:e},ae,se),__esDecorate$2(v,null,F,{kind:"accessor",name:"__data_old",static:!1,private:!1,access:{has:e=>"__data_old"in e,get:e=>e.__data_old,set:(e,t)=>{e.__data_old=t}},metadata:e},le,ce),__esDecorate$2(v,null,q,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:e},ue,he),__esDecorate$2(v,null,N,{kind:"accessor",name:"mode",static:!1,private:!1,access:{has:e=>"mode"in e,get:e=>e.mode,set:(e,t)=>{e.mode=t}},metadata:e},de,pe),__esDecorate$2(v,null,j,{kind:"accessor",name:"nlink",static:!1,private:!1,access:{has:e=>"nlink"in e,get:e=>e.nlink,set:(e,t)=>{e.nlink=t}},metadata:e},fe,me),__esDecorate$2(v,null,U,{kind:"accessor",name:"uid",static:!1,private:!1,access:{has:e=>"uid"in e,get:e=>e.uid,set:(e,t)=>{e.uid=t}},metadata:e},ge,ye),__esDecorate$2(v,null,V,{kind:"accessor",name:"gid",static:!1,private:!1,access:{has:e=>"gid"in e,get:e=>e.gid,set:(e,t)=>{e.gid=t}},metadata:e},_e,ve),__esDecorate$2(v,null,G,{kind:"accessor",name:"atimeMs",static:!1,private:!1,access:{has:e=>"atimeMs"in e,get:e=>e.atimeMs,set:(e,t)=>{e.atimeMs=t}},metadata:e},be,we),__esDecorate$2(v,null,W,{kind:"accessor",name:"birthtimeMs",static:!1,private:!1,access:{has:e=>"birthtimeMs"in e,get:e=>e.birthtimeMs,set:(e,t)=>{e.birthtimeMs=t}},metadata:e},xe,Se),__esDecorate$2(v,null,H,{kind:"accessor",name:"mtimeMs",static:!1,private:!1,access:{has:e=>"mtimeMs"in e,get:e=>e.mtimeMs,set:(e,t)=>{e.mtimeMs=t}},metadata:e},Ee,Te),__esDecorate$2(v,null,Z,{kind:"accessor",name:"ctimeMs",static:!1,private:!1,access:{has:e=>"ctimeMs"in e,get:e=>e.ctimeMs,set:(e,t)=>{e.ctimeMs=t}},metadata:e},Ae,Ce),__esDecorate$2(v,null,Y,{kind:"accessor",name:"ino",static:!1,private:!1,access:{has:e=>"ino"in e,get:e=>e.ino,set:(e,t)=>{e.ino=t}},metadata:e},Ie,ke),__esDecorate$2(v,null,X,{kind:"accessor",name:"__ino_old",static:!1,private:!1,access:{has:e=>"__ino_old"in e,get:e=>e.__ino_old,set:(e,t)=>{e.__ino_old=t}},metadata:e},Pe,Me),__esDecorate$2(v,null,K,{kind:"accessor",name:"flags",static:!1,private:!1,access:{has:e=>"flags"in e,get:e=>e.flags,set:(e,t)=>{e.flags=t}},metadata:e},Re,De),__esDecorate$2(v,null,Q,{kind:"accessor",name:"__after_flags",static:!1,private:!1,access:{has:e=>"__after_flags"in e,get:e=>e.__after_flags,set:(e,t)=>{e.__after_flags=t}},metadata:e},Oe,Le),__esDecorate$2(v,null,J,{kind:"accessor",name:"version",static:!1,private:!1,access:{has:e=>"version"in e,get:e=>e.version,set:(e,t)=>{e.version=t}},metadata:e},Be,$e),__esDecorate$2(v,null,ee,{kind:"accessor",name:"__padding",static:!1,private:!1,access:{has:e=>"__padding"in e,get:e=>e.__padding,set:(e,t)=>{e.__padding=t}},metadata:e},ze,Fe),__esDecorate$2(v,null,te,{kind:"accessor",name:"attributes",static:!1,private:!1,access:{has:e=>"attributes"in e,get:e=>e.attributes,set:(e,t)=>{e.attributes=t}},metadata:e},qe,Ne),__esDecorate$2(v,null,re,{kind:"accessor",name:"__data",static:!1,private:!1,access:{has:e=>"__data"in e,get:e=>e.__data,set:(e,t)=>{e.__data=t}},metadata:e},je,Ue),__esDecorate$2(null,B={value:$},ne,{kind:"class",name:$.name,metadata:e},null,ie),Ve=$=B.value,e&&Object.defineProperty($,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers$2($,ie)})(),v);return Ve=$})();function isFile(e){return(e.mode&S_IFMT)===S_IFREG}function isDirectory(e){return(e.mode&S_IFMT)===S_IFDIR}function isSymbolicLink(e){return(e.mode&S_IFMT)===S_IFLNK}function isBlockDevice(e){return(e.mode&S_IFMT)===S_IFBLK}function isCharacterDevice(e){return(e.mode&S_IFMT)===S_IFCHR}function hasAccess(e,t,r){const{credentials:n}=contextOf(e);if(isSymbolicLink(t)||0===n.euid||0===n.egid)return!0;let i=0;return n.uid===t.uid&&(t.mode&S_IRUSR&&(i|=R_OK),t.mode&S_IWUSR&&(i|=W_OK),t.mode&S_IXUSR&&(i|=X_OK)),(n.gid===t.gid||n.groups.includes(Number(t.gid)))&&(t.mode&S_IRGRP&&(i|=R_OK),t.mode&S_IWGRP&&(i|=W_OK),t.mode&S_IXGRP&&(i|=X_OK)),t.mode&S_IROTH&&(i|=R_OK),t.mode&S_IWOTH&&(i|=W_OK),t.mode&S_IXOTH&&(i|=X_OK),(i&r)===r}function _chown(e,t,r){let n=!0;return!isNaN(t)&&t>=0&&t<size_max?e.uid=t:n=!1,!isNaN(r)&&r>=0&&r<size_max?e.gid=r:n=!1,n}const version$4=1;class Index extends Map{maxSize=size_max;toJSON(){return{version:version$4,maxSize:this.maxSize,entries:Object.fromEntries([...this].map((([e,t])=>[e,t.toJSON()])))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let e=this.size*sizeof(Inode);for(const t of this.values())e+=t.size;return e}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(e){for(const[t,r]of this)if(r.ino==e||r.data==e)return t}getByID(e){return this.entryByID(e)?.inode}entryByID(e){for(const[t,r]of this)if(r.ino==e||r.data==e)return{path:t,inode:r}}directoryEntries(e){const t=this.get(e);if(!t)throw withErrno("ENOENT");if((t.mode&S_IFMT)!=S_IFDIR)throw withErrno("ENOTDIR");const r={};for(const n of this.keys())dirname(n)==e&&n!=e&&(r[basename(n)]=this.get(n).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap((e=>[e.ino,e.data])))+1}directories(){const e=new Map;for(const[t,r]of this){if((r.mode&S_IFMT)!=S_IFDIR)continue;const n={};for(const e of this.keys())dirname(e)==t&&e!=t&&(n[basename(e)]=this.get(e).ino);e.set(t,n)}return e}fromJSON(e){if(e.version!=version$4)throw withErrno("EINVAL","Index version mismatch");this.clear();for(const[t,r]of Object.entries(e.entries))r.data??=randomInt(1,size_max),"/"==t&&(r.ino=0),this.set(t,new Inode(r));return this}static parse(e){if(!isJSON(e))throw withErrno("EINVAL","Invalid JSON");const t=JSON.parse(e),r=new Index;return r.fromJSON(t),r}}const _chunkSize=4096;class FileSystem{type;name;label;_mountPoint;_uuid=crypto.randomUUID();get uuid(){return this._uuid}attributes=new Map;constructor(e,t){this.type=e,this.name=t,this.streamRead===FileSystem.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===FileSystem.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){return`${this.name} ${this.label?JSON.stringify(this.label):""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(e){try{return await this.stat(e),!0}catch(t){return"ENOENT"!=t.code}}existsSync(e){try{return this.statSync(e),!0}catch(t){return"ENOENT"!=t.code}}streamRead(e,t){return new ReadableStream({start:async r=>{const{size:n}=await this.stat(e),{start:i=0,end:o=n}=t;for(let t=i;t<o;t+=_chunkSize){const n=t+_chunkSize>o?o-t:_chunkSize,i=new Uint8Array(n);await this.read(e,i,t,t+n).catch(r.error.bind(r)),r.enqueue(i)}r.close()},type:"bytes"})}streamWrite(e,t){let r=t.start??0;return new WritableStream({write:async(t,n)=>{let i=!1;const o=e=>{i=!0,n.error(e)},{size:a}=await this.stat(e);await this.write(e,t,r).catch(o),i||(r+=t.byteLength,await this.touch(e,{mtimeMs:Date.now(),size:Math.max(a,r)}).catch(o))}})}}class Resource{id;_size;options;regions=[];get size(){return this._size}set size(e){if(e>=this._size)this._size=e;else{this._size=e;for(let t=this.regions.length-1;t>=0;t--){const r=this.regions[t];if(r.offset>=e){this.regions.splice(t,1);continue}const n=e-r.offset;r.data.byteLength>n&&(r.data=r.data.subarray(0,n)),r.ranges=r.ranges.filter((t=>t.start<e)).map((t=>t.end>e?{start:t.start,end:e}:t))}}}constructor(e,t,r,n){this.id=e,this._size=t,this.options=r,r.sparse??=!0,r.sparse||this.regions.push({offset:0,data:new Uint8Array(t),ranges:[]}),n?.set(e,this)}collect(){if(!this.options.sparse)return;const{regionGapThreshold:e=4095}=this.options;for(let t=0;t<this.regions.length-1;){const r=this.regions[t],n=this.regions[t+1];n.offset-(r.offset+r.data.byteLength)>e?t++:(r.ranges.push(...n.ranges),r.ranges.sort(((e,t)=>e.start-t.start)),r.ranges=r.ranges.reduce(((e,t)=>(!e.length||e.at(-1).end<t.start?e.push(t):e.at(-1).end=Math.max(e.at(-1).end,t.end),e)),[]),r.data=extendBuffer(r.data,n.offset+n.data.byteLength),r.data.set(n.data,n.offset-r.offset),this.regions.splice(t+1,1))}}missing(e,t){const r=[];for(const n of this.regions){if(n.offset>=t)break;for(const i of n.ranges)if(!(i.end<=e)){if(i.start>=t)break;if(i.start>e&&r.push({start:e,end:Math.min(i.start,t)}),i.end>e&&(e=Math.max(e,i.end)),e>=t)break}if(e>=t)break}return e<t&&r.push({start:e,end:t}),r}cached(e,t){const r=[];for(const i of this.regions){if(i.offset>=t)break;for(const n of i.ranges)if(!(n.end<=e)){if(n.start>=t)break;r.push({start:Math.max(e,n.start),end:Math.min(t,n.end)})}}r.sort(((e,t)=>e.start-t.start));const n=[];for(const i of r){const e=n.at(-1);e&&i.start<=e.end?e.end=Math.max(e.end,i.end):n.push(i)}return n}regionAt(e){if(this.regions.length)for(const t of this.regions){if(t.offset>e)break;if(e>=t.offset&&e<t.offset+t.data.byteLength)return t}}add(e,t){const r=t+e.byteLength,n=this.regionAt(t);if(n)return n.data=extendBuffer(n.data,r),n.data.set(e,t),n.ranges.push({start:t,end:r}),n.ranges.sort(((e,t)=>e.start-t.start)),this.collect(),this;const i={data:e,offset:t,ranges:[{start:t,end:r}]},o=this.regions.findIndex((e=>e.offset>t));return-1==o?this.regions.push(i):this.regions.splice(o,0,i),this.collect(),this}}Promise.withResolvers??=(warn("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}}),Symbol.dispose??=(warn("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")),Symbol.asyncDispose??=(warn("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")),globalThis.crypto.randomUUID??=(warn("Using a polyfill of crypto.randomUUID"),function(){const e=crypto.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=[...e].map((e=>e.toString(16).padStart(2,"0"))).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}),Uint8Array.prototype.toBase64??=(warn("Using a polyfill of Uint8Array.prototype.toBase64"),function(){return btoa(String.fromCharCode(...this))}),Uint8Array.fromBase64??=(warn("Using a polyfill of Uint8Array.fromBase64"),function(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}),Uint8Array.prototype.toHex??=(warn("Using a polyfill of Uint8Array.prototype.toHex"),function(){return[...this].map((e=>e.toString(16).padStart(2,"0"))).join("")}),Uint8Array.fromHex??=(warn("Using a polyfill of Uint8Array.fromHex"),function(e){const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return t});class Transaction{store;constructor(e){this.store=e}}class SyncTransaction extends Transaction{async get(e,t,r){return this.getSync(e,t,r)}async set(e,t,r){return this.setSync(e,t,r)}async remove(e){return this.removeSync(e)}}class AsyncTransaction extends Transaction{asyncDone=Promise.resolve();async(e){this.asyncDone=this.asyncDone.then((()=>e))}_cached(e,t){this.store.cache??=new Map;const r=this.store.cache.get(e);return r?(t&&(r.size=t.size),r):t?new Resource(e,t.size,{},this.store.cache):void 0}getSync(e,t,r){const n=this._cached(e);if(!n)return;r??=n.size;const i=n.missing(t,r);for(const{start:a,end:s}of i)this.async(this.get(e,a,s));if(i.length)throw withErrno("EAGAIN");const o=n.regionAt(t);if(o)return o.data.subarray(t-o.offset,r-o.offset);warn("Missing cache region for "+e)}setSync(e,t,r){this.async(this.set(e,t,r))}removeSync(e){this.async(this.remove(e)),this.store.cache?.delete(e)}}class WrappedTransaction{raw;fs;done=!1;flag(e){return this.raw.store.flags?.includes(e)??!1}constructor(e,t){this.raw=e,this.fs=t}originalData=new Map;modifiedKeys=new Set;keys(){return this.raw.keys()}async get(e,t=0,r){const n=await this.raw.get(e,t,r);return this.stash(e),n}getSync(e,t=0,r){const n=this.raw.getSync(e,t,r);return this.stash(e),n}async set(e,t,r=0){await this.markModified(e,r,t.byteLength);const n=t instanceof Uint8Array?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await this.raw.set(e,n,r)}setSync(e,t,r=0){this.markModifiedSync(e,r,t.byteLength);const n=t instanceof Uint8Array?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);this.raw.setSync(e,n,r)}async remove(e){await this.markModified(e,0,void 0),await this.raw.remove(e)}removeSync(e){this.markModifiedSync(e,0,void 0),this.raw.removeSync(e)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[e,t]of this.originalData)if(this.modifiedKeys.has(e))if(t.some((e=>!e.data)))await this.raw.remove(e),this.fs._remove(e);else for(const r of t.reverse())await this.raw.set(e,r.data,r.offset);this.done=!0}}abortSync(){if(!this.done){for(const[e,t]of this.originalData)if(this.modifiedKeys.has(e))if(t.some((e=>!e.data)))this.raw.removeSync(e),this.fs._remove(e);else for(const r of t.reverse())this.raw.setSync(e,r.data,r.offset);this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(e,t,r=0){this.originalData.has(e)||this.originalData.set(e,[]),this.originalData.get(e).push({data:t,offset:r})}async markModified(e,t,r){this.modifiedKeys.add(e);const n=r?t+r:void 0;try{this.stash(e,await this.raw.get(e,t,n),t)}catch(i){if(!(this.raw instanceof AsyncTransaction))throw i;const r=this.raw._cached(e);if(!r)throw i;for(const o of r.cached(t,n??t))this.stash(e,await this.raw.get(e,o.start,o.end),o.start)}}markModifiedSync(e,t,r){this.modifiedKeys.add(e);const n=r?t+r:void 0;try{this.stash(e,this.raw.getSync(e,t,n),t)}catch(i){if(!(this.raw instanceof AsyncTransaction))throw i;const r=this.raw._cached(e);if(!r)throw i;for(const o of r.cached(t,n??t))this.stash(e,this.raw.getSync(e,o.start,o.end),o.start)}}}var __addDisposableResource$2=function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t},__disposeResources$2=function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}var n,i=0;return function e(){for(;n=t.stack.pop();)try{if(!n.async&&1===i)return i=0,t.stack.push(n),Promise.resolve().then(e);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(o).then(e,(function(t){return r(t),e()}))}else i|=1}catch(a){r(a)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n});class StoreFS extends FileSystem{store;_ids=new Map([["/",0]]);_paths=new Map([[0,new Set("/")]]);_path(e){const[t]=this._paths.get(e)??[];return t}_add(e,t){this._paths.has(e)||this._paths.set(e,new Set),this._paths.get(e).add(t),this._ids.set(t,e)}_remove(e){for(const t of this._paths.get(e)??[])this._ids.delete(t);this._paths.delete(e)}_move(e,t){const r=[];for(const[n,i]of this._ids){const o=relative(e,n);if(o.startsWith(".."))continue;let a=join(t,o);a.endsWith("/")&&(a=a.slice(0,-1)),r.push({oldKey:n,newKey:a,ino:i})}for(const{oldKey:n,newKey:i,ino:o}of r){this._ids.delete(n),this._ids.set(i,o);const e=this._paths.get(o);e?(e.delete(n),e.add(i)):warn("Missing paths in table for ino "+o)}}_initialized=!1;async ready(){this._initialized||(this.attributes.has("no_async_preload")||this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(e){super(e.type??1802921587,e.name),this.store=e,e.fs=this,this._uuid=e.uuid??this.uuid,this.label=e.label,debug(this.name+": supports features: "+this.store.flags?.join(", "))}usage(){return this.store.usage?.()||{totalSpace:0,freeSpace:0}}async loadIndex(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!0),n=e.directories();for(const[t,i]of e)this._add(i.ino,t),await r.set(i.ino,i),n.has(t)&&await r.set(i.data,encodeDirListing(n.get(t)));await r.commit()}catch(r){t.error=r,t.hasError=!0}finally{const e=__disposeResources$2(t);e&&await e}}loadIndexSync(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!1),n=e.directories();for(const[t,i]of e)this._add(i.ino,t),r.setSync(i.ino,i),n.has(t)&&r.setSync(i.data,encodeDirListing(n.get(t)));r.commitSync()}catch(r){t.error=r,t.hasError=!0}finally{__disposeResources$2(t)}}async createIndex(){const e={stack:[],error:void 0,hasError:!1};try{const t=new Index,r=__addDisposableResource$2(e,this.transaction(),!0),n=[["/",0]],i=canary(withErrno("EDEADLK"));for(;n.length;){const[e,i]=n.shift(),o=new Inode(await r.get(i));if(t.set(e,o),o.mode&S_IFDIR){const t=decodeDirListing(await r.get(o.data)??_throw(withErrno("ENODATA")));for(const[r,i]of Object.entries(t))n.push([join(e,r),i])}}return i(),t}catch(t){e.error=t,e.hasError=!0}finally{const t=__disposeResources$2(e);t&&await t}}createIndexSync(){const e={stack:[],error:void 0,hasError:!1};try{const t=new Index,r=__addDisposableResource$2(e,this.transaction(),!1),n=[["/",0]],i=canary(withErrno("EDEADLK"));for(;n.length;){const[e,i]=n.shift(),o=new Inode(r.getSync(i));if(t.set(e,o),o.mode&S_IFDIR){const t=decodeDirListing(r.getSync(o.data)??_throw(withErrno("ENODATA")));for(const[r,i]of Object.entries(t))n.push([join(e,r),i])}}return i(),t}catch(t){e.error=t,e.hasError=!0}finally{__disposeResources$2(e)}}async rename(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!0),i=parse$2(e),o=parse$2(t),a=await this.findInode(n,i.dir),s=decodeDirListing(await n.get(a.data)??_throw(withErrno("ENODATA")));if(!s[i.base])throw withErrno("ENOENT");const l=s[i.base];if(l!=this._ids.get(e)&&err$1(`Ino mismatch while renaming ${e} to ${t}`),delete s[i.base],(o.dir+"/").startsWith(e+"/"))throw withErrno("EBUSY");const c=o.dir==i.dir,u=c?a:await this.findInode(n,o.dir),h=c?s:decodeDirListing(await n.get(u.data)??_throw(withErrno("ENODATA")));if(h[o.base]){const e=new Inode(await n.get(h[o.base])??_throw(withErrno("ENOENT")));if(!isFile(e))throw withErrno("EISDIR");await n.remove(e.data),await n.remove(h[o.base])}h[o.base]=l,await n.set(a.data,encodeDirListing(s)),await n.set(u.data,encodeDirListing(h)),await n.commit(),this._move(e,t)}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources$2(r);e&&await e}}renameSync(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!1),i=parse$2(e),o=parse$2(t),a=this.findInodeSync(n,i.dir),s=decodeDirListing(n.getSync(a.data)??_throw(withErrno("ENODATA")));if(!s[i.base])throw withErrno("ENOENT");const l=s[i.base];if(l!=this._ids.get(e)&&err$1(`Ino mismatch while renaming ${e} to ${t}`),delete s[i.base],(o.dir+"/").startsWith(e+"/"))throw withErrno("EBUSY");const c=o.dir===i.dir,u=c?a:this.findInodeSync(n,o.dir),h=c?s:decodeDirListing(n.getSync(u.data)??_throw(withErrno("ENODATA")));if(h[o.base]){const e=new Inode(n.getSync(h[o.base])??_throw(withErrno("ENOENT")));if(!isFile(e))throw withErrno("EISDIR");n.removeSync(e.data),n.removeSync(h[o.base])}h[o.base]=l,n.setSync(a.data,encodeDirListing(s)),n.setSync(u.data,encodeDirListing(h)),n.commitSync(),this._move(e,t)}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$2(r)}}async stat(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!0);return await this.findInode(r,e)}catch(r){t.error=r,t.hasError=!0}finally{const e=__disposeResources$2(t);e&&await e}}statSync(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!1);return this.findInodeSync(r,e)}catch(r){t.error=r,t.hasError=!0}finally{__disposeResources$2(t)}}async touch(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!0),i=await this.findInode(n,e);i.update(t)&&(this._add(i.ino,e),n.setSync(i.ino,i)),await n.commit()}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources$2(r);e&&await e}}touchSync(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!1),i=this.findInodeSync(n,e);i.update(t)&&(this._add(i.ino,e),n.setSync(i.ino,i)),n.commitSync()}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$2(r)}}async createFile(e,t){return t.mode|=S_IFREG,await this.commitNew(e,t,new Uint8Array)}createFileSync(e,t){return t.mode|=S_IFREG,this.commitNewSync(e,t,new Uint8Array)}async unlink(e){return this.remove(e,!1)}unlinkSync(e){this.removeSync(e,!1)}async rmdir(e){if((await this.readdir(e)).length)throw withErrno("ENOTEMPTY");await this.remove(e,!0)}rmdirSync(e){if(this.readdirSync(e).length)throw withErrno("ENOTEMPTY");this.removeSync(e,!0)}async mkdir(e,t){return t.mode|=S_IFDIR,await this.commitNew(e,t,encodeUTF8("{}"))}mkdirSync(e,t){return t.mode|=S_IFDIR,this.commitNewSync(e,t,encodeUTF8("{}"))}async readdir(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!0),n=await this.findInode(r,e);return Object.keys(decodeDirListing(await r.get(n.data)??_throw(withErrno("ENOENT"))))}catch(r){t.error=r,t.hasError=!0}finally{const e=__disposeResources$2(t);e&&await e}}readdirSync(e){const t={stack:[],error:void 0,hasError:!1};try{const r=__addDisposableResource$2(t,this.transaction(),!1),n=this.findInodeSync(r,e);return Object.keys(decodeDirListing(r.getSync(n.data)??_throw(withErrno("ENOENT"))))}catch(r){t.error=r,t.hasError=!0}finally{__disposeResources$2(t)}}async sync(){}syncSync(){}async link(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!0),i=dirname(t),o=await this.findInode(n,i),a=decodeDirListing(await n.get(o.data)??_throw(withErrno("ENOENT"))),s=await this.findInode(n,e);s.nlink++,a[basename(t)]=s.ino,this._add(s.ino,t),await n.set(s.ino,s),await n.set(o.data,encodeDirListing(a)),await n.commit()}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources$2(r);e&&await e}}linkSync(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!1),i=dirname(t),o=this.findInodeSync(n,i),a=decodeDirListing(n.getSync(o.data)??_throw(withErrno("ENOENT"))),s=this.findInodeSync(n,e);s.nlink++,a[basename(t)]=s.ino,this._add(s.ino,t),n.setSync(s.ino,s),n.setSync(o.data,encodeDirListing(a)),n.commitSync()}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$2(r)}}async read(e,t,r,n){const i={stack:[],error:void 0,hasError:!1};try{const o=__addDisposableResource$2(i,this.transaction(),!0),a=await this.findInode(o,e);if(0==a.size)return;const s=await o.get(a.data,r,n)??_throw(withErrno("ENODATA")),l=o.flag("partial")?s:s.subarray(r,n);l.byteLength>t.byteLength&&err$1(`Trying to place ${l.byteLength} bytes into a ${t.byteLength} byte buffer on read`),t.set(l)}catch(o){i.error=o,i.hasError=!0}finally{const e=__disposeResources$2(i);e&&await e}}readSync(e,t,r,n){const i={stack:[],error:void 0,hasError:!1};try{const o=__addDisposableResource$2(i,this.transaction(),!1),a=this.findInodeSync(o,e);if(0==a.size)return;const s=o.getSync(a.data,r,n)??_throw(withErrno("ENODATA")),l=o.flag("partial")?s:s.subarray(r,n);l.byteLength>t.byteLength&&err$1(`Trying to place ${l.byteLength} bytes into a ${t.byteLength} byte buffer on read`),t.set(l)}catch(o){i.error=o,i.hasError=!0}finally{__disposeResources$2(i)}}async write(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource$2(n,this.transaction(),!0),o=await this.findInode(i,e);let a=t;i.flag("partial")||(a=extendBuffer(await i.get(o.data)??new Uint8Array,r+t.byteLength),a.set(t,r),r=0),await i.set(o.data,a,r),this._add(o.ino,e),await i.commit()}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources$2(n);e&&await e}}writeSync(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource$2(n,this.transaction(),!1),o=this.findInodeSync(i,e);let a=t;i.flag("partial")||(a=extendBuffer(i.getSync(o.data)??new Uint8Array,r+t.byteLength),a.set(t,r),r=0),i.setSync(o.data,a,r),this._add(o.ino,e),i.commitSync()}catch(i){n.error=i,n.hasError=!0}finally{__disposeResources$2(n)}}transaction(){return new WrappedTransaction(this.store.transaction(),this)}async checkRoot(){const e={stack:[],error:void 0,hasError:!1};try{const t=__addDisposableResource$2(e,this.transaction(),!0);if(await t.get(rootIno))return;const r=new Inode({ino:rootIno,data:1,mode:511|S_IFDIR});await t.set(r.data,encodeUTF8("{}")),this._add(rootIno,"/"),await t.set(rootIno,r),await t.commit()}catch(t){e.error=t,e.hasError=!0}finally{const t=__disposeResources$2(e);t&&await t}}checkRootSync(){const e={stack:[],error:void 0,hasError:!1};try{const t=__addDisposableResource$2(e,this.transaction(),!1);if(t.getSync(rootIno))return;const r=new Inode({ino:rootIno,data:1,mode:511|S_IFDIR});t.setSync(r.data,encodeUTF8("{}")),this._add(rootIno,"/"),t.setSync(rootIno,r),t.commitSync()}catch(t){e.error=t,e.hasError=!0}finally{__disposeResources$2(e)}}async _populate(){const e={stack:[],error:void 0,hasError:!1};try{if(this._initialized)return void warn("Attempted to populate tables after initialization");debug("Populating tables with existing store metadata");const t=__addDisposableResource$2(e,this.transaction(),!0),r=await t.get(rootIno);if(!r){notice("Store does not have a root inode");const e=new Inode({ino:rootIno,data:1,mode:511|S_IFDIR});return await t.set(e.data,encodeUTF8("{}")),this._add(rootIno,"/"),await t.set(rootIno,e),void(await t.commit())}if(r.length<sizeof(Inode))return void crit("Store contains an invalid root inode. Refusing to populate tables");const n=new Set;let i=0;const o=[["/",rootIno]];for(;o.length>0;){i++;const[e,r]=o.shift();this._add(r,e);const a=await t.get(r);if(!a){warn("Store is missing data for inode: "+r);continue}if(a.length<sizeof(Inode)){warn(`Invalid inode size for ino ${r}: ${a.length}`);continue}const s=new Inode(a);if((s.mode&S_IFDIR)!=S_IFDIR||n.has(r))continue;n.add(r);const l=await t.get(s.data);if(!l){warn("Store is missing directory data: "+s.data);continue}const c=decodeDirListing(l);for(const[t,n]of Object.entries(c))o.push([join(e,t),n])}debug(`Added ${i} existing inode(s) from store`)}catch(t){e.error=t,e.hasError=!0}finally{const t=__disposeResources$2(e);t&&await t}}async _findInode(e,t,r=new Set){if(r.has(t))throw crit(withErrno("EIO","Infinite loop detected while finding inode"));if(r.add(t),"/"==t)return new Inode(await e.get(rootIno)??_throw(withErrno("ENODATA")));const{dir:n,base:i}=parse$2(t),o=await this._findInode(e,n,r),a=decodeDirListing(await e.get(o.data)??_throw(withErrno("ENODATA")));if(!(i in a))throw withErrno("ENOENT");return new Inode(await e.get(a[i])??_throw(withErrno("ENODATA")))}_findInodeSync(e,t,r=new Set){if(r.has(t))throw crit(withErrno("EIO","Infinite loop detected while finding inode"));if(r.add(t),"/"==t)return new Inode(e.getSync(rootIno)??_throw(withErrno("ENOENT")));const{dir:n,base:i}=parse$2(t),o=this._findInodeSync(e,n,r),a=decodeDirListing(e.getSync(o.data)??_throw(withErrno("ENODATA")));if(!(i in a))throw withErrno("ENOENT");return new Inode(e.getSync(a[i])??_throw(withErrno("ENODATA")))}async findInode(e,t){if(this.attributes.has("no_id_tables"))return await this._findInode(e,t);const r=this._ids.get(t);if(void 0===r)throw withErrno("ENOENT");return new Inode(await e.get(r)??_throw(withErrno("ENOENT")))}findInodeSync(e,t){if(this.attributes.has("no_id_tables"))return this._findInodeSync(e,t);const r=this._ids.get(t);if(void 0===r)throw withErrno("ENOENT");return new Inode(e.getSync(r)??_throw(withErrno("ENOENT")))}_lastID;allocNew(e){this._lastID??=Math.max(...this._paths.keys()),this._lastID+=2;const t=this._lastID;if(t>size_max)throw err$1(withErrno("ENOSPC","No IDs available"));return this._add(t,e),t}async commitNew(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{if("/"==e)throw withErrno("EEXIST");const i=__addDisposableResource$2(n,this.transaction(),!0),{dir:o,base:a}=parse$2(e),s=await this.findInode(i,o),l=decodeDirListing(await i.get(s.data)??_throw(withErrno("ENOENT")));if(l[a])throw withErrno("EEXIST");const c=this.allocNew(e),u=new Inode({...t,ino:c,data:c+1,size:r.byteLength,nlink:1});return await i.set(u.ino,u),await i.set(u.data,r),l[a]=u.ino,await i.set(s.data,encodeDirListing(l)),await i.commit(),u}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources$2(n);e&&await e}}commitNewSync(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{if("/"==e)throw withErrno("EEXIST");const i=__addDisposableResource$2(n,this.transaction(),!1),{dir:o,base:a}=parse$2(e),s=this.findInodeSync(i,o),l=decodeDirListing(i.getSync(s.data)??_throw(withErrno("ENOENT")));if(l[a])throw withErrno("EEXIST");const c=this.allocNew(e),u=new Inode({...t,ino:c,data:c+1,size:r.byteLength,nlink:1});return i.setSync(u.ino,u),i.setSync(u.data,r),l[a]=u.ino,i.setSync(s.data,encodeDirListing(l)),i.commitSync(),u}catch(i){n.error=i,n.hasError=!0}finally{__disposeResources$2(n)}}async remove(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!0),{dir:i,base:o}=parse$2(e),a=await this.findInode(n,i),s=decodeDirListing(await n.get(a.data)??_throw(withErrno("ENOENT")));if(!s[o])throw withErrno("ENOENT");const l=s[o],c=new Inode(await n.get(l)??_throw(withErrno("ENOENT")));if(delete s[o],!t&&isDirectory(c))throw withErrno("EISDIR");await n.set(a.data,encodeDirListing(s)),c.nlink>1?(c.update({nlink:c.nlink-1}),await n.set(c.ino,c)):(await n.remove(c.data),await n.remove(l),this._remove(l)),await n.commit()}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources$2(r);e&&await e}}removeSync(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$2(r,this.transaction(),!1),{dir:i,base:o}=parse$2(e),a=this.findInodeSync(n,i),s=decodeDirListing(n.getSync(a.data)??_throw(withErrno("ENOENT"))),l=s[o];if(!l)throw withErrno("ENOENT");const c=new Inode(n.getSync(l)??_throw(withErrno("ENOENT")));if(delete s[o],!t&&isDirectory(c))throw withErrno("EISDIR");n.setSync(a.data,encodeDirListing(s)),c.nlink>1?(c.update({nlink:c.nlink-1}),n.setSync(c.ino,c)):(n.removeSync(c.data),n.removeSync(l),this._remove(l)),n.commitSync()}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$2(r)}}}class SyncMapTransaction extends SyncTransaction{async keys(){return this.store.keys()}async get(e){return await(this.store.getAsync?.(e)??this.store.get(e))}getSync(e){return this.store.get(e)}setSync(e,t){this.store.set(e,t)}removeSync(e){this.store.delete(e)}}class InMemoryStore extends Map{maxSize;label;flags=[];name="tmpfs";constructor(e=size_max,t){super(),this.maxSize=e,this.label=t}async sync(){}transaction(){return new SyncMapTransaction(this)}get bytes(){let e=4*this.size;for(const t of this.values())e+=t.byteLength;return e}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const _InMemory={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const r=new StoreFS(new InMemoryStore(e,t));return r.checkRootSync(),r}},InMemory=_InMemory;let checkAccess=!0;var DirType,DirType2;function ifToDt(e){return(61440&e)>>12}DirType2=DirType||(DirType={}),DirType2[DirType2.UNKNOWN=0]="UNKNOWN",DirType2[DirType2.FIFO=1]="FIFO",DirType2[DirType2.CHR=2]="CHR",DirType2[DirType2.DIR=4]="DIR",DirType2[DirType2.BLK=6]="BLK",DirType2[DirType2.REG=8]="REG",DirType2[DirType2.LNK=10]="LNK",DirType2[DirType2.SOCK=12]="SOCK",DirType2[DirType2.WHT=14]="WHT";let Dirent$1=class{ino;type;path;name};class Handle{context;path;fs;internalPath;flag;inode;_buffer;_position=0;get position(){return this.flag&O_APPEND?this.inode.size:this._position}set position(e){this._position=e}dirty=!1;closed=!1;get isClosed(){return this.closed}constructor(e,t,r,n,i,o){this.context=e,this.path=t,this.fs=r,this.internalPath=n,this.flag=i,this.inode=o}get _isSync(){return!!(this.flag&O_SYNC||this.inode.flags&InodeFlags.Sync||this.fs.attributes.has("sync"))}[Symbol.dispose](){this.closeSync()}syncSync(){if(this.closed)throw UV("EBADF","sync",this.path);this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasyncSync(){return this.syncSync()}closeSync(){if(this.closed)throw UV("EBADF","close",this.path);this.syncSync(),this.disposeSync()}disposeSync(e){if(this.closed)throw UV("EBADF","close",this.path);if(this.dirty&&!e)throw UV("EBUSY","close",this.path);this.closed=!0}truncateSync(e){if(e<0)throw UV("EINVAL","truncate",this.path);if(this.closed)throw UV("EBADF","truncate",this.path);if(!(this.flag&O_WRONLY||this.flag&O_RDWR))throw UV("EBADF","truncate",this.path);if(this.fs.attributes.has("readonly"))throw UV("EROFS","truncate",this.path);if(this.inode.flags&InodeFlags.Immutable)throw UV("EPERM","truncate",this.path);this.dirty=!0,this.inode.mtimeMs=Date.now(),this.inode.size=e,this.inode.ctimeMs=Date.now(),this._isSync&&this.syncSync()}writeSync(e,t=0,r=e.byteLength-t,n=this.position){if(this.closed)throw UV("EBADF","write",this.path);if(!(this.flag&O_WRONLY||this.flag&O_RDWR))throw UV("EBADF","write",this.path);if(this.fs.attributes.has("readonly"))throw UV("EROFS","write",this.path);if(this.inode.flags&InodeFlags.Immutable)throw UV("EPERM","write",this.path);this.dirty=!0;const i=n+r,o=e.subarray(t,t+r);return!isCharacterDevice(this.inode)&&!isBlockDevice(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=n+o.byteLength,this.fs.writeSync(this.internalPath,o,n),this._isSync&&this.syncSync(),o.byteLength}readSync(e,t=0,r=e.byteLength-t,n=this.position){if(this.closed)throw UV("EBADF","read",this.path);if(this.flag&O_WRONLY)throw UV("EBADF","read",this.path);this.inode.flags&InodeFlags.NoAtime||this.fs.attributes.has("no_atime")||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=n+r;!isCharacterDevice(this.inode)&&!isBlockDevice(this.inode)&&i>this.inode.size&&(i=n+Math.max(this.inode.size-n,0)),this._position=i;const o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return this.fs.readSync(this.internalPath,o.subarray(t,t+r),n,i),this._isSync&&this.syncSync(),i-n}chmodSync(e){if(this.closed)throw UV("EBADF","chmod",this.path);this.dirty=!0,this.inode.mode=this.inode.mode&(e>S_IFMT?-61441:S_IFMT)|e,(this._isSync||e>S_IFMT)&&this.syncSync()}chownSync(e,t){if(this.closed)throw UV("EBADF","chmod",this.path);this.dirty=!0,_chown(this.inode,e,t),this._isSync&&this.syncSync()}utimesSync(e,t){if(this.closed)throw UV("EBADF","utimes",this.path);this.dirty=!0,this.inode.atimeMs=e,this.inode.mtimeMs=t,this._isSync&&this.syncSync()}async[Symbol.asyncDispose](){await this.close()}async sync(){if(this.closed)throw UV("EBADF","sync",this.path);this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}async close(){if(this.closed)throw UV("EBADF","close",this.path);await this.sync(),this.dispose()}dispose(e){if(this.closed)throw UV("EBADF","close",this.path);if(this.dirty&&!e)throw UV("EBUSY","close",this.path);this.closed=!0}stat(){if(this.closed)throw UV("EBADF","stat",this.path);return this.inode}async truncate(e){if(e<0)throw UV("EINVAL","truncate",this.path);if(this.closed)throw UV("EBADF","truncate",this.path);if(!(this.flag&O_WRONLY||this.flag&O_RDWR))throw UV("EBADF","truncate",this.path);if(this.fs.attributes.has("readonly"))throw UV("EROFS","truncate",this.path);if(this.inode.flags&InodeFlags.Immutable)throw UV("EPERM","truncate",this.path);this.dirty=!0,this.inode.mtimeMs=Date.now(),this.inode.size=e,this.inode.ctimeMs=Date.now(),this._isSync&&await this.sync()}async write(e,t=0,r=e.byteLength-t,n=this.position){if(this.closed)throw UV("EBADF","write",this.path);if(!(this.flag&O_WRONLY||this.flag&O_RDWR))throw UV("EBADF","write",this.path);if(this.fs.attributes.has("readonly"))throw UV("EROFS","write",this.path);if(this.inode.flags&InodeFlags.Immutable)throw UV("EPERM","write",this.path);this.dirty=!0;const i=n+r,o=e.subarray(t,t+r);return!isCharacterDevice(this.inode)&&!isBlockDevice(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=n+o.byteLength,await this.fs.write(this.internalPath,o,n),this._isSync&&await this.sync(),o.byteLength}async read(e,t=0,r=e.byteLength-t,n=this.position){if(this.closed)throw UV("EBADF","read",this.path);if(this.flag&O_WRONLY)throw UV("EBADF","read",this.path);this.inode.flags&InodeFlags.NoAtime||this.fs.attributes.has("no_atime")||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=n+r;!isCharacterDevice(this.inode)&&!isBlockDevice(this.inode)&&i>this.inode.size&&(i=n+Math.max(this.inode.size-n,0)),this._position=i;const o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return await this.fs.read(this.internalPath,o.subarray(t,t+r),n,i),this._isSync&&await this.sync(),i-n}async chmod(e){if(this.closed)throw UV("EBADF","chmod",this.path);this.dirty=!0,this.inode.mode=this.inode.mode&(e>S_IFMT?-61441:S_IFMT)|e,(this._isSync||e>S_IFMT)&&await this.sync()}async chown(e,t){if(this.closed)throw UV("EBADF","chown",this.path);this.dirty=!0,_chown(this.inode,e,t),this._isSync&&await this.sync()}async utimes(e,t){if(this.closed)throw UV("EBADF","utimes",this.path);this.dirty=!0,this.inode.atimeMs=e,this.inode.mtimeMs=t,this._isSync&&await this.sync()}streamRead(e){if(this.closed)throw UV("EBADF","streamRead",this.path);return this.fs.streamRead(this.internalPath,e)}streamWrite(e){if(this.closed)throw UV("EBADF","write",this.path);if(this.inode.flags&InodeFlags.Immutable)throw UV("EPERM","write",this.path);if(this.fs.attributes.has("readonly"))throw UV("EROFS","write",this.path);return this.fs.streamWrite(this.internalPath,e)}}function toFD(e){const t=contextOf(e.context).descriptors,r=Math.max(t.size?Math.max(...t.keys())+1:0,4);return t.set(r,e),r}function fromFD(e,t){const r=contextOf(e).descriptors.get(t);if(!r)throw withErrno("EBADF");return r}function deleteFD(e,t){return contextOf(e).descriptors.delete(t)}const pattern=/[rwasx]{1,2}\+?/;function parse$1(e){if("number"==typeof e)return e;if(!pattern.test(e))throw withErrno("EINVAL","Invalid flag string: "+e);return toNumber(e)}function toNumber(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw withErrno("EINVAL","Invalid flag string: "+e);let t=e.includes("r")?O_RDONLY:O_CREAT;return e.includes("w")&&(t|=O_TRUNC),e.includes("a")&&(t|=O_APPEND),e.includes("+")?t|=O_RDWR:e.includes("r")||(t|=O_WRONLY),e.includes("s")&&(t|=O_SYNC),e.includes("x")&&(t|=O_EXCL),t}function toMode(e){let t=0;return e&O_WRONLY||(t|=R_OK),(e&O_WRONLY||e&O_RDWR)&&(t|=W_OK),t}function wrap(e,t,r,n){const i="string"==typeof r?{path:r,dest:n,syscall:t.endsWith("Sync")?t.slice(0,-4):t}:r,o=e[t];if("function"!=typeof o)throw new TypeError(`${t} is not a function`);return function(...t){try{return o.call(e,...t)}catch(r){throw setUVMessage(Object.assign(r,i))}}}function withExceptionContext(e,t){return new Proxy(e,{get(e,r){const n=Reflect.get(e,r);return"function"!=typeof n?n:function r(...i){try{const o=n.apply(e,i);return o instanceof Promise?o.catch((e=>{if("code"in e)throw setUVMessage(Object.assign(e,t));if(e in Errno){const n=UV(e,t);Error.captureStackTrace(n,r)}throw e})):o}catch(o){throw setUVMessage(Object.assign(o,t))}}}})}const mounts=new Map;function mount(e,t){if("/"!=e[0]&&(e="/"+e),e=resolve$2.call(this,e),mounts.has(e))throw err$1(withErrno("EINVAL","Mount point is already in use: "+e));t._mountPoint=e,mounts.set(e,t),info(`Mounted ${t.name} on ${e}`),debug(`${t.name} attributes: ${[...t.attributes].map((([e,t])=>null!=t?e+"="+t:e)).join(", ")}`)}function umount(e){"/"!=e[0]&&(e="/"+e),e=resolve$2.call(this,e),mounts.has(e)?(mounts.delete(e),notice("Unmounted "+e)):warn(e+" is already unmounted")}function resolveMount(e,t,r){const{root:n}=contextOf(t),i={path:e,...r};e=normalizePath(join(n,e),!0),e=resolve$2.call(t,e);const o=[...mounts].sort(((e,t)=>e[0].length>t[0].length?-1:1));for(const[a,s]of o){if(!_isParentOf(a,e))continue;""===(e=e.slice(a.length>1?a.length:0))&&(e="/");const t=s.attributes.get("case_fold");return"lower"===t&&(e=e.toLowerCase()),"upper"===t&&(e=e.toUpperCase()),{fs:withExceptionContext(s,i),path:e,mountPoint:a,root:n}}throw alert(new Exception(Errno.EIO,"No file system for "+e))}function _statfs(e,t){const r=e.usage(),n=r.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(n),ffree:(t?BigInt:Number)(r.freeNodes||size_max),files:(t?BigInt:Number)(r.totalNodes||size_max),bavail:(t?BigInt:Number)(r.freeSpace/n),bfree:(t?BigInt:Number)(r.freeSpace/n),blocks:(t?BigInt:Number)(r.totalSpace/n)}}function chroot(e){const t=contextOf(this);if(!credentialsAllowRoot(t.credentials))throw withErrno("EPERM","Can not chroot() as non-root user");t.root??="/";const r=join(t.root,e);for(const n of t.descriptors?.values()??[]){if(!n.path.startsWith(t.root))throw UV("EBUSY","chroot",n.path);n.path=n.path.slice(t.root.length)}if(r.length>t.root.length)throw withErrno("EPERM","Can not chroot() outside of current root");t.root=r}function _isParentOf(e,t){return"/"===e||e===t||(e.endsWith("/")||(e+="/"),t.startsWith(e))}function resolve$1(e,t,r,n){t=resolve$2.call(e,t);try{const i=resolveMount(t,e),o=i.fs.statSync(i.path);if(!isSymbolicLink(o)||r)return{...i,fullPath:t,stats:o};return resolve$1(e,resolve$2.call(e,dirname(t),readlink$3.call(e,t)),r,n)}catch(u){if(setUVMessage(Object.assign(u,{syscall:"stat",path:t})),r)throw u}const{base:i,dir:o}=parse$2(t),a="/"==o?"/":resolve$1(e,o,!1,n).fullPath,s=join(a,i),l=resolveMount(s,e);let c;try{c=l.fs.statSync(l.path)}catch(u){if("ENOENT"===u.code)return{...l,fullPath:t};throw setUVMessage(Object.assign(u,{syscall:"stat",path:s}))}if(!isSymbolicLink(c))return{...l,fullPath:s,stats:c};return resolve$1(e,resolve$2.call(e,a,readlink$3.call(e,s)),!1,n)}function open$3(e,t){e=normalizePath(e);const r=normalizeMode(t.mode,420),n=parse$1(t.flag);e=t.preserveSymlinks?e:resolve$1(this,e).fullPath;const{fs:i,path:o}=resolveMount(e,this);let a;try{a=i.statSync(o)}catch{}if(!a){if(!(n&O_CREAT))throw UV("ENOENT","open",e);const a=i.statSync(dirname(o));if(!hasAccess(this,a,W_OK))throw UV("EACCES","open",e);if(!isDirectory(a))throw UV("ENOTDIR","open",e);if(!t.allowDirectory&&r&S_IFDIR)throw UV("EISDIR","open",e);if(!hasAccess(this,a,W_OK))throw UV("EACCES","open",e);const{euid:s,egid:l}=contextOf(this).credentials,c=i.createFileSync(o,{mode:r,uid:a.mode&S_ISUID?a.uid:s,gid:a.mode&S_ISGID?a.gid:l});return new Handle(this,e,i,o,n,c)}if(!hasAccess(this,a,r)||!hasAccess(this,a,toMode(n)))throw UV("EACCES","open",e);if(n&O_EXCL)throw UV("EEXIST","open",e);const s=new Handle(this,e,i,o,n,a);if(!t.allowDirectory&&a.mode&S_IFDIR)throw UV("EISDIR","open",e);return n&O_TRUNC&&s.truncateSync(0),s}function readlink$3(e){e=normalizePath(e);const{fs:t,stats:r,path:n}=resolve$1(this,e,!0);if(!r)throw UV("ENOENT","readlink",e);if(!hasAccess(this,r,R_OK))throw UV("EACCES","readlink",e);if(!isSymbolicLink(r))throw UV("EINVAL","readlink",e);const i=r.size,o=new Uint8Array(i);return t.readSync(n,o,0,i),decodeUTF8(o)}function mkdir$3(e,t={}){e=normalizePath(e);const{fs:r,path:n}=resolve$1(this,e),{euid:i,egid:o}=contextOf(this).credentials,{mode:a=511,recursive:s}=t,l=(e,t,n)=>{if(!hasAccess(this,n,W_OK))throw UV("EACCES","mkdir",dirname(e));const s=r.mkdirSync(t,{mode:a,uid:n.mode&S_ISUID?n.uid:i,gid:n.mode&S_ISGID?n.gid:o});return emitChange(this,"rename",e),s};if(!s)return void l(e,n,r.statSync(dirname(n)));const c=[];for(let h=n,d=e;!r.existsSync(h);h=dirname(h),d=dirname(d))c.unshift({resolved:h,original:d});if(!c.length)return;const u=[r.statSync(dirname(c[0].resolved))];for(const[h,d]of c.entries())u.push(l(d.original,d.resolved,u[h]));return c[0].original}function readdir$3(e,t={}){e=normalizePath(e);const{fs:r,path:n}=resolve$1(this,e),i=r.statSync(n);if(!hasAccess(this,i,R_OK))throw UV("EACCES","readdir",e);if(!isDirectory(i))throw UV("ENOTDIR","readdir",e);const o=r.readdirSync(n),a=[],s=e=>{let i;try{i=r.statSync(join(n,e))}catch(c){if("ENOENT"==c.code)return;throw c}const o=new Dirent$1;if(o.ino=i.ino,o.type=ifToDt(i.mode),o.path=e,o.name=basename(e),a.push(o),!isDirectory(i)||!t?.recursive)return;const l=r.readdirSync(join(n,e));for(const t of l)s(join(e,t))};for(const l of o)s(l);return a}function rename$3(e,t){const r={syscall:"rename",path:e=normalizePath(e),dest:t=normalizePath(t)},n=resolve$1(this,e,!0,r),i=resolveMount(t,this,r);if(n.fs.uuid!==i.fs.uuid)throw UV("EXDEV",r);if(i.path.startsWith(n.path+"/"))throw UV("EBUSY",r);if(!n.stats)throw UV("ENOENT",r);const o=n.fs,a=o.statSync(dirname(n.path)),s=o.statSync(dirname(i.path));let l;try{l=o.statSync(i.path)}catch(c){if("ENOENT"!=c.code)throw c}if(!hasAccess(this,a,R_OK)||!hasAccess(this,s,W_OK))throw UV("EACCES",r);if(l&&!isDirectory(n.stats)&&isDirectory(l))throw UV("EISDIR",r);if(l&&isDirectory(n.stats)&&!isDirectory(l))throw UV("ENOTDIR",r);n.fs.renameSync(n.path,i.path),emitChange(this,"rename",e),emitChange(this,"change",t)}function link$4(e,t){e=normalizePath(e);const r={syscall:"link",path:t=normalizePath(t),dest:e},{fs:n,path:i}=resolveMount(e,this,r),o=resolveMount(t,this,r);if(n.uuid!==o.fs.uuid)throw UV("EXDEV",r);if(!hasAccess(this,n.statSync(i),R_OK))throw UV("EACCES",r);if(!hasAccess(this,n.statSync(dirname(i)),R_OK))throw UV("EACCES",r);if(!hasAccess(this,n.statSync(dirname(o.path)),W_OK))throw UV("EACCES",r);return n.linkSync(i,o.path)}mount("/",InMemory.create({label:"root"}));class Dirent{ino;type;_name;get name(){const e=Buffer$1.from(this._name);return"buffer"==this._encoding?e:e.toString(this._encoding)}_encoding;_parentPath;get parentPath(){return this._parentPath}get path(){return warn("Dirent.path was removed in Node v24, use parentPath instead"),this._parentPath}static from(e,t){const r=new Dirent,{base:n,dir:i}=parse$2(e.path);return r._parentPath=i||".",r._name=n,r.ino=e.ino,r.type=e.type,r._encoding=t,r}isFile(){return this.type===DirType.REG}isDirectory(){return this.type===DirType.DIR}isBlockDevice(){return this.type===DirType.BLK}isCharacterDevice(){return this.type===DirType.CHR}isSymbolicLink(){return this.type===DirType.LNK}isFIFO(){return this.type===DirType.FIFO}isSocket(){return this.type===DirType.SOCK}}class Dir{path;context;closed=!1;checkClosed(){if(this.closed)throw withErrno("EBADF","Can not use closed Dir")}_entries;constructor(e,t){this.path=e,this.context=t}close(e){if(this.closed=!0,!e)return Promise.resolve();e(null)}closeSync(){this.closed=!0}async _read(){return this.checkClosed(),this._entries??=await readdir$1.call(this.context,this.path,{withFileTypes:!0}),this._entries.length?this._entries.shift()??null:null}read(e){if(!e)return this._read();this._read().then((t=>e(null,t)))}readSync(){return this.checkClosed(),this._entries??=readdirSync.call(this.context,this.path,{withFileTypes:!0}),this._entries.length?this._entries.shift()??null:null}async next(){const e=await this._read();return e?{done:!1,value:e}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.dispose](){this.closed||this.closeSync()}async[Symbol.asyncDispose](){this.closed||await this.close()}}var __addDisposableResource$1=function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t},__disposeResources$1=function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}var n,i=0;return function e(){for(;n=t.stack.pop();)try{if(!n.async&&1===i)return i=0,t.stack.push(n),Promise.resolve().then(e);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(o).then(e,(function(t){return r(t),e()}))}else i|=1}catch(a){r(a)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n});function renameSync(e,t){return rename$3.call(this,e,t)}function existsSync(e){e=normalizePath(e);try{const{fs:t,path:r}=resolve$1(this,e);return t.existsSync(r)}catch(t){if(t.errno==Errno.ENOENT)return!1;throw t}}function statSync(e,t){e=normalizePath(e);const{fs:r,path:n}=resolve$1(this,e);let i;try{i=r.statSync(n)}catch(o){throw setUVMessage(Object.assign(o,{path:e}))}if(!hasAccess(this,i,R_OK))throw UV("EACCES",{syscall:"stat",path:e});return t?.bigint?new BigIntStats(i):new Stats(i)}function lstatSync(e,t){e=normalizePath(e);const{base:r,dir:n}=parse$2(e),{fs:i,path:o}=resolve$1(this,n),a=wrap(i,"statSync",e)(r?join(o,r):o);if(!hasAccess(this,a,R_OK))throw UV("EACCES",{syscall:"lstat",path:e});return t?.bigint?new BigIntStats(a):new Stats(a)}function truncateSync(e,t=0){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource$1(r,open$3.call(this,e,{flag:"r+"}),!1);if(t||=0,t<0)throw UV("EINVAL","truncate",e.toString());n.truncateSync(t)}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$1(r)}}function unlinkSync(e){e=normalizePath(e);const{fs:t,path:r}=resolveMount(e,this);try{if(checkAccess&&!hasAccess(this,t.statSync(r),W_OK))throw UV("EACCES","unlink");t.unlinkSync(r)}catch(n){throw setUVMessage(Object.assign(n,{path:e}))}emitChange(this,"rename",e.toString())}function openSync(e,t,r=F_OK){return toFD(open$3.call(this,e,{flag:t,mode:r}))}function lopenSync(e,t,r){return toFD(open$3.call(this,e,{flag:t,mode:r,preserveSymlinks:!0}))}function readFileSync(e,t={}){const r={stack:[],error:void 0,hasError:!1};try{const n=normalizeOptions(t,null,"r",420);if(parse$1(n.flag)&O_WRONLY)throw UV("EBADF","read",e.toString());const i=__addDisposableResource$1(r,"number"==typeof e?fromFD(this,e):open$3.call(this,e.toString(),{flag:n.flag,mode:420,preserveSymlinks:!1}),!1),{size:o}=i.stat(),a=Buffer$1.alloc(o);return i.readSync(a,0,o,0),n.encoding?a.toString(n.encoding):a}catch(n){r.error=n,r.hasError=!0}finally{__disposeResources$1(r)}}function writeFileSync(e,t,r={}){const n={stack:[],error:void 0,hasError:!1};try{const i=normalizeOptions(r,"utf8","w+",420),o=parse$1(i.flag);if(!(o&O_WRONLY||o&O_RDWR))throw new Exception(Errno.EINVAL,"Flag passed to writeFile must allow for writing");if("string"!=typeof t&&!i.encoding)throw new Exception(Errno.EINVAL,"Encoding not specified");const a="string"==typeof t?Buffer$1.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Exception(Errno.EINVAL,"Data not specified");__addDisposableResource$1(n,"number"==typeof e?fromFD(this,e):open$3.call(this,e.toString(),{flag:o,mode:i.mode,preserveSymlinks:!0}),!1).writeSync(a,0,a.byteLength,0),emitChange(this,"change",e.toString())}catch(i){n.error=i,n.hasError=!0}finally{__disposeResources$1(n)}}function appendFileSync(e,t,r={}){const n=normalizeOptions(r,"utf8","a+",420),i=parse$1(n.flag);if(!(i&O_APPEND))throw new Exception(Errno.EINVAL,"Flag passed to appendFile must allow for appending");if("string"!=typeof t&&!n.encoding)throw new Exception(Errno.EINVAL,"Encoding not specified");const o="string"==typeof t?Buffer$1.from(t,n.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a="number"==typeof e?fromFD(this,e):open$3.call(this,normalizePath(e),{flag:i,mode:n.mode,preserveSymlinks:!0});a.writeSync(o,0,o.byteLength),"number"!=typeof a&&a.closeSync()}function fstatSync(e,t){const r=fromFD(this,e).stat();return t?.bigint?new BigIntStats(r):new Stats(r)}function closeSync(e){fromFD(this,e).closeSync(),deleteFD(this,e)}function ftruncateSync(e,t=0){if(t||=0,t<0)throw new Exception(Errno.EINVAL);fromFD(this,e).truncateSync(t)}function fsyncSync(e){fromFD(this,e).syncSync()}function fdatasyncSync(e){fromFD(this,e).datasyncSync()}function writeSync(e,t,r,n,i){let o,a,s,l;if("string"==typeof t){l="number"==typeof r?r:null;const e="string"==typeof n?n:"utf8";a=0,o=Buffer$1.from(t,e),s=o.byteLength}else o=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=r,s=n,l="number"==typeof i?i:null;const c=fromFD(this,e);l??=c.position;const u=c.writeSync(o,a,s,l);return emitChange(this,"change",c.path),u}function readSync(e,t,r,n,i){const o=fromFD(this,e),a="object"==typeof r?r.offset:r;if("object"==typeof r&&(n=r.length,i=r.position),i&&i>Number.MAX_SAFE_INTEGER)throw UV("EINVAL");return"bigint"==typeof i&&(i=Number(i)),i=Number.isSafeInteger(i)?i:o.position,o.readSync(t,a,n,i)}function fchownSync(e,t,r){fromFD(this,e).chownSync(t,r)}function fchmodSync(e,t){const r=normalizeMode(t,-1);if(r<0)throw new Exception(Errno.EINVAL,"Invalid mode.");fromFD(this,e).chmodSync(r)}function futimesSync(e,t,r){fromFD(this,e).utimesSync(normalizeTime(t),normalizeTime(r))}function rmdirSync(e){e=normalizePath(e);const{fs:t,path:r}=resolve$1(this,e),n=wrap(t,"statSync",e)(r);if(!isDirectory(n))throw UV("ENOTDIR","rmdir",e);if(!hasAccess(this,n,W_OK))throw UV("EACCES","rmdir",e);wrap(t,"rmdirSync",e)(r),emitChange(this,"rename",e.toString())}function mkdirSync(e,t){t="object"==typeof t?t:{mode:t};const r=normalizeMode(t?.mode,511);return mkdir$3.call(this,e,{...t,mode:r})}function readdirSync(e,t){t="object"==typeof t?t:{encoding:t},e=normalizePath(e);const r=[],n=readdir$3.call(this,e,t??void 0);for(const i of n)t?.withFileTypes?r.push(Dirent.from(i,t.encoding)):"buffer"==t?.encoding?r.push(Buffer$1.from(i.path)):r.push(i.path);return r}function linkSync(e,t){return link$4.call(this,e,t)}function symlinkSync(e,t,r="file"){const n={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(r))throw new TypeError("Invalid symlink type: "+r);t=normalizePath(t);const i=__addDisposableResource$1(n,open$3.call(this,t,{flag:"wx",mode:420}),!1);i.writeSync(encodeUTF8(normalizePath(e,!0))),i.chmodSync(S_IFLNK)}catch(i){n.error=i,n.hasError=!0}finally{__disposeResources$1(n)}}function readlinkSync(e,t){const r=Buffer$1.from(readlink$3.call(this,e)),n="object"==typeof t?t?.encoding:t;return"buffer"==n?r:r.toString(n??"utf-8")}function chownSync(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{__addDisposableResource$1(n,open$3.call(this,e,{flag:"r+",mode:F_OK}),!1).chownSync(t,r)}catch(i){n.error=i,n.hasError=!0}finally{__disposeResources$1(n)}}function lchownSync(e,t,r){const n=lopenSync.call(this,e,"r+");fchownSync.call(this,n,t,r),closeSync.call(this,n)}function chmodSync(e,t){const r=openSync.call(this,e,"r+");fchmodSync.call(this,r,t),closeSync.call(this,r)}function lchmodSync(e,t){const r=lopenSync.call(this,e,"r+");fchmodSync.call(this,r,t),closeSync.call(this,r)}function utimesSync(e,t,r){const n=openSync.call(this,e,"r+");futimesSync.call(this,n,t,r),closeSync.call(this,n)}function lutimesSync(e,t,r){const n=lopenSync.call(this,e,"r+");futimesSync.call(this,n,t,r),closeSync.call(this,n)}function realpathSync(e,t){const r="string"==typeof t?t:t?.encoding??"utf8";e=normalizePath(e,!0);const{fullPath:n}=resolve$1(this,e);if("utf8"==r||"utf-8"==r)return n;const i=Buffer$1.from(n,"utf-8");return"buffer"==r?i:i.toString(r)}function accessSync(e,t=384){if(!hasAccess(this,statSync.call(this,e),t))throw new Exception(Errno.EACCES)}function rmSync(e,t){let r;e=normalizePath(e);try{r=lstatSync.bind(this)(e)}catch(n){if("ENOENT"!=n.code||!t?.force)throw n}if(r)switch(r.mode&S_IFMT){case S_IFDIR:if(t?.recursive)for(const r of readdirSync.call(this,e))rmSync.call(this,join(e,r),t);rmdirSync.call(this,e);break;case S_IFREG:case S_IFLNK:case S_IFBLK:case S_IFCHR:unlinkSync.call(this,e);break;default:throw UV("ENOSYS","rm",e)}}function mkdtempSync(e,t){const r="object"==typeof t?t?.encoding:t||"utf8",n=_tempDirName(e);return mkdirSync.call(this,n),"buffer"==r?Buffer$1.from(n):n}function mkdtempDisposableSync(e,t){const r=_tempDirName(e);mkdirSync.call(this,r);const n=()=>rmSync(r,{recursive:!0,force:!0});return{path:r,remove:n,[Symbol.dispose]:n}}function copyFileSync(e,t,r){if(e=normalizePath(e),t=normalizePath(t),r&&r&COPYFILE_EXCL&&existsSync(t))throw UV("EEXIST","copyFile",t);writeFileSync.call(this,t,readFileSync(e)),emitChange(this,"rename",t.toString())}function readvSync(e,t,r){const n=fromFD(this,e);let i=0;for(const o of t)i+=n.readSync(o,0,o.byteLength,r+i);return i}function writevSync(e,t,r){const n=fromFD(this,e);let i=0;for(const o of t)i+=n.writeSync(new Uint8Array(o.buffer),0,o.byteLength,r+i);return i}function opendirSync(e,t){return e=normalizePath(e),new Dir(e,this)}function cpSync(e,t,r){e=normalizePath(e),t=normalizePath(t);const n=lstatSync.call(this,e);if(r?.errorOnExist&&existsSync.call(this,t))throw UV("EEXIST","cp",t);switch(n.mode&S_IFMT){case S_IFDIR:if(!r?.recursive)throw UV("EISDIR","cp",e);mkdirSync.call(this,t,{recursive:!0});for(const n of readdirSync.call(this,e,{withFileTypes:!0}))r.filter&&!r.filter(join(e,n.name),join(t,n.name))||cpSync.call(this,join(e,n.name),join(t,n.name),r);break;case S_IFREG:case S_IFLNK:copyFileSync.call(this,e,t);break;default:throw UV("ENOSYS","cp",e)}r?.preserveTimestamps&&utimesSync.call(this,t,n.atime,n.mtime)}function statfsSync(e,t){e=normalizePath(e);const{fs:r}=resolveMount(e,this);return _statfs(r,t?.bigint)}function globSync(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:r="/",withFileTypes:n=!1,exclude:i=()=>!1}=t,o=e.map(globToRegex),a=[];return function e(t){const r=readdirSync(t,{withFileTypes:n,encoding:"utf8"});for(const s of r){const r=n?join(s.parentPath,s.name):t+"/"+s;("function"!=typeof i?i.some((e=>matchesGlob(e,r))):i(n?s:r))||(statSync(r).isDirectory()&&o.some((e=>e.source.includes(".*")))&&e(r),o.some((e=>e.test(r.replace(/^\/+/g,""))))&&a.push(n?s:r.replace(/^\/+/g,"")))}}(r),a}class Watcher extends EventEmitter{_context;path;off(e,t,r,n){return super.off(e,t,r,n)}removeListener(e,t,r,n){return super.removeListener(e,t,r,n)}constructor(e,t){super(),this._context=e,this.path=t}setMaxListeners(){throw UV("ENOSYS","Watcher.setMaxListeners")}getMaxListeners(){throw UV("ENOSYS","Watcher.getMaxListeners")}prependListener(){throw UV("ENOSYS","Watcher.prependListener")}prependOnceListener(){throw UV("ENOSYS","Watcher.prependOnceListener")}rawListeners(){throw UV("ENOSYS","Watcher.rawListeners")}ref(){return this}unref(){return this}}class FSWatcher extends Watcher{options;realpath;constructor(e,t,r){const n=contextOf(e);super(n,t),this.options=r,this.realpath=join(n.root,t),addWatcher(this.realpath,this)}close(){super.emit("close"),removeWatcher(this.realpath,this)}[Symbol.dispose](){this.close()}}class StatWatcher extends Watcher{options;intervalId;previous;constructor(e,t,r){super(e,t),this.options=r,this.start()}onInterval(){try{const e=statSync(this.path);isStatsEqual(this.previous,e)||(this.emit("change",e,this.previous),this.previous=e)}catch(e){this.emit("error",e)}}start(){const e=this.options.interval||5e3;try{this.previous=statSync(this.path)}catch(t){return void this.emit("error",t)}this.intervalId=setInterval(this.onInterval.bind(this),e),this.options.persistent||"object"!=typeof this.intervalId||this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const watchers=new Map;function addWatcher(e,t){const r=normalizePath(e);watchers.has(r)||watchers.set(r,new Set),watchers.get(r).add(t)}function removeWatcher(e,t){const r=normalizePath(e);watchers.has(r)&&(watchers.get(r).delete(t),0===watchers.get(r).size&&watchers.delete(r))}function emitChange(e,t,r){const n=contextOf(e);n&&(r=join(n.root??"/",r));for(let i=r=normalizePath(r);"/"!=i;i=dirname(i)){const e=watchers.get(i);if(e)for(const n of e)n.emit("change",t,relative.call(n._context,i,r)||basename(r))}}async function resolve(e,t,r,n){if(t=resolve$2.call(e,t),r){const r=resolveMount(t,e,n),i=await r.fs.stat(r.path).catch((()=>{}));return{...r,fullPath:t,stats:i}}try{const i=resolveMount(t,e),o=await i.fs.stat(i.path);if(!isSymbolicLink(o))return{...i,fullPath:t,stats:o};const a=resolve$2.call(e,dirname(t),await readlink$2.call(e,t));return await resolve(e,a,r,n)}catch{}const{base:i,dir:o}=parse$2(t),a="/"==o?"/":(await resolve(e,o,!1,n)).fullPath,s=join(a,i),l=resolveMount(s,e),c=await l.fs.stat(l.path).catch((e=>{if("ENOENT"!=e.code)throw setUVMessage(Object.assign(e,{syscall:"stat",path:s}))}));if(!c)return{...l,fullPath:t};if(!isSymbolicLink(c))return{...l,fullPath:s,stats:c};const u=resolve$2.call(e,a,await readlink$2.call(e,s));return await resolve(e,u,!1,n)}async function open$2(e,t,r){t=normalizePath(t);const n=normalizeMode(r.mode,420),i=parse$1(r.flag),o={syscall:"open",path:t},{fs:a,path:s,stats:l}=await resolve(e,t,r.preserveSymlinks,o);if(!l){if(!(i&O_CREAT))throw UV("ENOENT",o);const l=await a.stat(dirname(s));if(!hasAccess(e,l,W_OK))throw UV("EACCES","open",dirname(t));if(!isDirectory(l))throw UV("ENOTDIR","open",dirname(t));if(!r.allowDirectory&&n&S_IFDIR)throw UV("EISDIR","open",t);const{euid:c,egid:u}=contextOf(e).credentials,h=await a.createFile(s,{mode:n,uid:l.mode&S_ISUID?l.uid:c,gid:l.mode&S_ISGID?l.gid:u});return new Handle(e,t,a,s,i,h)}if(!hasAccess(e,l,toMode(i)))throw UV("EACCES",o);if(i&O_EXCL)throw UV("EEXIST",o);const c=new Handle(e,t,a,s,i,l);if(!r.allowDirectory&&n&S_IFDIR)throw UV("EISDIR","open",t);return i&O_TRUNC&&await c.truncate(0),c}async function readlink$2(e){const t={syscall:"readlink",path:e=normalizePath(e)},{fs:r,stats:n,path:i}=await resolve(this,e,!0,t);if(!n)throw UV("ENOENT",t);if(!hasAccess(this,n,R_OK))throw UV("EACCES",t);if(!isSymbolicLink(n))throw UV("EINVAL",t);const o=n.size,a=new Uint8Array(o);return await r.read(i,a,0,o),decodeUTF8(a)}async function mkdir$2(e,t={}){e=normalizePath(e);const{euid:r,egid:n}=contextOf(this).credentials,{mode:i=511,recursive:o}=t,{fs:a,path:s}=resolveMount(e,this,{syscall:"mkdir"}),l=async(e,t,o)=>{if(!hasAccess(this,o,W_OK))throw UV("EACCES","mkdir",e);const s=await a.mkdir(t,{mode:i,uid:o.mode&S_ISUID?o.uid:r,gid:o.mode&S_ISGID?o.gid:n});return emitChange(this,"rename",e),s};if(!o)return void(await l(e,s,await a.stat(dirname(s))));const c=[];let u=e;for(let d=s;!(await a.exists(d));d=dirname(d),u=dirname(u))c.unshift([u,d]);if(!c.length)return;const h=[await a.stat(dirname(c[0][1]))];for(const[d,[p,f]]of c.entries())h.push(await l(p,f,h[d]));return c[0][0]}async function readdir$2(e,t={}){const r={syscall:"readdir",path:e=normalizePath(e)},{fs:n,path:i,stats:o}=await resolve(this,e,!1,r);if(!o)throw UV("ENOENT",r);if(!hasAccess(this,o,R_OK))throw UV("EACCES",r);if(!isDirectory(o))throw UV("ENOTDIR",r);const a=await n.readdir(i),s=[],l=async e=>{const r=await n.stat(join(i,e)).catch((e=>{if("ENOENT"!=e.code)throw e}));if(!r)return;const o=new Dirent$1;if(o.ino=r.ino,o.type=ifToDt(r.mode),o.path=e,o.name=basename(e),s.push(o),!t.recursive||!isDirectory(r))return;const a=await n.readdir(join(i,e));for(const t of a)await l(join(e,t))};return await Promise.all(a.map(l)),s}async function rename$2(e,t){const r={syscall:"rename",path:e=normalizePath(e),dest:t=normalizePath(t)},n=await resolve(this,e,!0,r),i=resolveMount(t,this,r);if(n.fs.uuid!==i.fs.uuid)throw UV("EXDEV",r);if(i.path.startsWith(n.path+"/"))throw UV("EBUSY",r);if(!n.stats)throw UV("ENOENT",r);const o=n.fs,a=await o.stat(dirname(n.path)),s=await o.stat(dirname(i.path)),l=await o.stat(i.path).catch((e=>{if("ENOENT"==e.code)return null;throw e}));if(!hasAccess(this,a,R_OK)||!hasAccess(this,s,W_OK))throw UV("EACCES",r);if(l&&!isDirectory(n.stats)&&isDirectory(l))throw UV("EISDIR",r);if(l&&isDirectory(n.stats)&&!isDirectory(l))throw UV("ENOTDIR",r);await n.fs.rename(n.path,i.path),emitChange(this,"rename",e),emitChange(this,"change",t)}async function link$3(e,t){e=normalizePath(e);const r={syscall:"link",path:t=normalizePath(t),dest:e},{fs:n,path:i}=resolveMount(e,this,r),o=resolveMount(t,this,r);if(n.uuid!=o.fs.uuid)throw UV("EXDEV",r);if(!hasAccess(this,await n.stat(i),R_OK))throw UV("EACCES",r);if(!hasAccess(this,await n.stat(dirname(i)),R_OK))throw UV("EACCES",r);if(!hasAccess(this,await n.stat(dirname(o.path)),W_OK))throw UV("EACCES",r);return await n.link(i,o.path)}class Interface extends EventEmitter{input;output;terminal;line="";_cursor=0;get cursor(){return this._cursor}_buffer="";_closed=!1;_paused=!1;_prompt="";_history=[];_historyIndex=-1;_currentLine="";constructor(e,t,r,n=!1){super(),this.input=e,this.output=t,this.terminal=n,this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}_onData=e=>{if(!this._paused&&!this._closed){this._buffer+="string"==typeof e?e:e.toString("utf8");for(let e=this._buffer.indexOf("\n");e>=0;e=this._buffer.indexOf("\n")){let t=this._buffer.substring(0,e);t.endsWith("\r")&&(t=t.substring(0,t.length-1)),this._buffer=this._buffer.substring(e+1),this.line=t,t.trim()&&!t.trim().match(/^\s*$/)&&this._history.at(-1)!=t&&(this._history.push(t),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",t)}}};close(){if(!this._closed){if(this._closed=!0,this.input?.removeAllListeners?.(),this._buffer.length){const e=this._buffer;this._buffer="",this.line=e,this.emit("line",e)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused||(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause")),this}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(e){this._prompt=e}getPrompt(){return this._prompt}prompt(e){if(!this.output)return;if(!e)return void this.output.write(this._prompt);const{cols:t}=this.getCursorPos();this.output.write(this._prompt),this._cursor=t}write(e,t){if(!this._closed){if(e){const t="string"==typeof e?e:e.toString("utf8");this._onData(t)}if(t&&this.terminal)switch((t.ctrl?"^":"")+t.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;moveCursor(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const e=this.line.length-this._cursor;if(!e)return;moveCursor(this.output,e,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output)return;if(this._cursor>=this.line.length)return;const e=this.line.slice(0,this._cursor);clearLine(this.output,1),this.line=e;break}case"^u":{if(!this.output||!this._cursor)return;const e=this.line.slice(this._cursor);clearLine(this.output,0),moveCursor(this.output,0,0),this.output.write(this._prompt+e),this.line=e,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let e=this._cursor-1;for(;e>=0&&" "===this.line[e];)e--;for(;e>=0&&" "!==this.line[e];)e--;const t=this.line.slice(0,e+1)+this.line.slice(this._cursor),r=e+1;this._renderLine(t),this._cursor=r,this._cursor=r,moveCursor(this.output,-t.length,0),moveCursor(this.output,r,0);break}case"^return":case"^enter":this._onData("\n");break;case"return":case"enter":this._onData((e?"string"==typeof e?e:e.toString("utf8"):"")+"\n");break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),"up"==t.name&&this._historyIndex>0)this._historyIndex--;else{if(!("down"==t.name&&this._historyIndex<this._history.length-1))return"down"==t.name&&this._historyIndex==this._history.length-1?(this._historyIndex=this._history.length,void this._renderLine(this._currentLine)):void 0;this._historyIndex++}const e=this._history[this._historyIndex];this._renderLine(e);break}case"left":case"right":{const e="left"==t.name?-1:1;if(!this.output)return;const r=Math.max(0,Math.min(this.line.length,this._cursor+e));if(r==this._cursor)return;moveCursor(this.output,e,0),this._cursor=r,this._cursor=r;break}case"backspace":{if(!this.output||!this._cursor)return;const e=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(e),this._cursor=--this._cursor,this._cursor>0&&(moveCursor(this.output,-this._cursor,0),moveCursor(this.output,this._cursor,0));break}case"delete":{if(!this.output)return;if(this._cursor>=this.line.length)return;const e=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);clearLine(this.output,0),moveCursor(this.output,0,0),this.output.write(this._prompt+e),this.line=e,moveCursor(this.output,-e.length,0),moveCursor(this.output,this._cursor,0);break}}}}_renderLine(e){this.output&&(clearLine(this.output,0),moveCursor(this.output,0,0),this.output.write(this._prompt+e),this.line=e,this._cursor=e.length,this._cursor=e.length)}question(e,t,r){const n="function"==typeof t?t:r;!this._closed&&this.output?(this.output.write(e),this.once("line",n)):n("")}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(e,t){const r=this.listeners(e);return this.removeAllListeners(e),this.on(e,t),r.forEach(this.on.bind(this,e)),this}prependOnceListener(e,t){const r=this.listeners(e);return this.removeAllListeners(e),this.once(e,t),r.forEach(this.on.bind(this,e)),this}setMaxListeners(){return warn("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return warn("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let e=!1;return{next:async()=>{if(e)return{done:e,value:void 0};const{resolve:t,promise:r}=Promise.withResolvers();return this.once("line",(e=>t({value:e,done:!1}))),this.once("close",(()=>{e=!0,t({value:void 0,done:e})})),r},return:async t=>(e||(e=!0,this.close()),{done:e,value:t}),throw:async t=>{throw e||(e=!0,this.close()),t},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{e||(e=!0,this.close())}}}[Symbol.dispose](){this.close()}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:e,promise:t}=Promise.withResolvers();this.once("close",(()=>e())),this.close(),await t}rawListeners(e){return this.listeners(e)}}function createInterface(e,t,r,n){return"input"in e?new Interface(e.input,e.output,e.completer,e.terminal):new Interface(e,t,r,n)}function clearLine(e,t){return e.write(t>=0?"\r[K":"[K"),!0}function moveCursor(e,t,r){if(!e.write)return!1;let n="";return t<0?n+=`[${-t}D`:t>0&&(n+=`[${t}C`),r<0?n+=`[${-r}A`:r>0&&(n+=`[${r}B`),n&&e.write(n),!0}var browser$2={exports:{}},stream={exports:{}},primordials,hasRequiredPrimordials;function requirePrimordials(){return hasRequiredPrimordials?primordials:(hasRequiredPrimordials=1,primordials={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error:Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Boolean:Boolean,Uint8Array:Uint8Array})}var util={exports:{}},browser$1={exports:{}},hasRequiredBrowser$2,hasRequiredUtil;function requireBrowser$2(){if(hasRequiredBrowser$2)return browser$1.exports;hasRequiredBrowser$2=1;const{AbortController:e,AbortSignal:t}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;return browser$1.exports=e,browser$1.exports.AbortSignal=t,browser$1.exports.default=e,browser$1.exports}function requireUtil(){return hasRequiredUtil||(hasRequiredUtil=1,function(e){const t=requireDist$1(),{kResistStopPropagation:r,SymbolDispose:n}=requirePrimordials(),i=globalThis.AbortSignal||requireBrowser$2().AbortSignal,o=globalThis.AbortController||requireBrowser$2().AbortController,a=Object.getPrototypeOf((async function(){})).constructor,s=globalThis.Blob||t.Blob,l=void 0!==s?function(e){return e instanceof s}:function(e){return!1},c=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new ERR_INVALID_ARG_TYPE(t,"AbortSignal",e)};class u extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:u,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}},promisify:e=>new Promise(((t,r)=>{e(((e,...n)=>e?r(e):t(...n)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,r]){const n=t.shift();if("f"===r)return n.toFixed(6);if("j"===r)return JSON.stringify(n);if("s"===r&&"object"==typeof n){return`${n.constructor!==Object?n.constructor.name:""} {}`.trim()}return n.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof a,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:l,deprecate:(e,t)=>e,addAbortListener:requireEvents().addAbortListener||function(e,t){if(void 0===e)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);let i;return c(e,"signal"),((e,t)=>{if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"Function",e)})(t,"listener"),e.aborted?queueMicrotask((()=>t())):(e.addEventListener("abort",t,{__proto__:null,once:!0,[r]:!0}),i=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[n](){var e;null===(e=i)||void 0===e||e()}}},AbortSignalAny:i.any||function(e){if(1===e.length)return e[0];const t=new o,r=()=>t.abort();return e.forEach((e=>{c(e,"signals"),e.addEventListener("abort",r,{once:!0})})),t.signal.addEventListener("abort",(()=>{e.forEach((e=>e.removeEventListener("abort",r)))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(util)),util.exports}var operators={},errors$1,hasRequiredErrors$1,validators,hasRequiredValidators;function requireErrors$1(){if(hasRequiredErrors$1)return errors$1;hasRequiredErrors$1=1;const{format:e,inspect:t,AggregateError:r}=requireUtil(),n=globalThis.AggregateError||r,i=Symbol("kIsNodeError"),o=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,s={};function l(e,t){if(!e)throw new s.ERR_INTERNAL_ASSERTION(t)}function c(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function u(t,r,n){n||(n=Error);class o extends n{constructor(...n){super(function(t,r,n){if("function"==typeof r)return l(r.length<=n.length,`Code: ${t}; The provided arguments length (${n.length}) does not match the required ones (${r.length}).`),r(...n);const i=(r.match(/%[dfijoOs]/g)||[]).length;return l(i===n.length,`Code: ${t}; The provided arguments length (${n.length}) does not match the required ones (${i}).`),0===n.length?r:e(r,...n)}(t,r,n))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(o.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),o.prototype.code=t,o.prototype[i]=!0,s[t]=o}function h(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class d extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new s.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}return u("ERR_ASSERTION","%s",Error),u("ERR_INVALID_ARG_TYPE",((e,r,n)=>{l("string"==typeof e,"'name' must be a string"),Array.isArray(r)||(r=[r]);let i="The ";e.endsWith(" argument")?i+=`${e} `:i+=`"${e}" ${e.includes(".")?"property":"argument"} `,i+="must be ";const s=[],c=[],u=[];for(const t of r)l("string"==typeof t,"All expected entries have to be of type string"),o.includes(t)?s.push(t.toLowerCase()):a.test(t)?c.push(t):(l("object"!==t,'The value "object" should be written as "Object"'),u.push(t));if(c.length>0){const e=s.indexOf("object");-1!==e&&(s.splice(s,e,1),c.push("Object"))}if(s.length>0){switch(s.length){case 1:i+=`of type ${s[0]}`;break;case 2:i+=`one of type ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();i+=`one of type ${s.join(", ")}, or ${e}`}}(c.length>0||u.length>0)&&(i+=" or ")}if(c.length>0){switch(c.length){case 1:i+=`an instance of ${c[0]}`;break;case 2:i+=`an instance of ${c[0]} or ${c[1]}`;break;default:{const e=c.pop();i+=`an instance of ${c.join(", ")}, or ${e}`}}u.length>0&&(i+=" or ")}switch(u.length){case 0:break;case 1:u[0].toLowerCase()!==u[0]&&(i+="an "),i+=`${u[0]}`;break;case 2:i+=`one of ${u[0]} or ${u[1]}`;break;default:{const e=u.pop();i+=`one of ${u.join(", ")}, or ${e}`}}if(null==n)i+=`. Received ${n}`;else if("function"==typeof n&&n.name)i+=`. Received function ${n.name}`;else if("object"==typeof n){var h;if(null!==(h=n.constructor)&&void 0!==h&&h.name)i+=`. Received an instance of ${n.constructor.name}`;else{i+=`. Received ${t(n,{depth:-1})}`}}else{let e=t(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),i+=`. Received type ${typeof n} (${e})`}return i}),TypeError),u("ERR_INVALID_ARG_VALUE",((e,r,n="is invalid")=>{let i=t(r);i.length>128&&(i=i.slice(0,128)+"...");return`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${i}`}),TypeError),u("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{var n;return`Expected ${e} to be returned from the "${t}" function but got ${null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:"type "+typeof r}.`}),TypeError),u("ERR_MISSING_ARGS",((...e)=>{let t;l(e.length>0,"At least one arg needs to be specified");const r=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`}),TypeError),u("ERR_OUT_OF_RANGE",((e,r,n)=>{let i;return l(r,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32?i=c(String(n)):"bigint"==typeof n?(i=String(n),(n>2n**32n||n<-(2n**32n))&&(i=c(i)),i+="n"):i=t(n),`The value of "${e}" is out of range. It must be ${r}. Received ${i}`}),RangeError),u("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),u("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),u("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),u("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),u("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),u("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),u("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),u("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),u("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),u("ERR_STREAM_WRITE_AFTER_END","write after end",Error),u("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),errors$1={AbortError:d,aggregateTwoErrors:h((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new n([t,e],t.message);return r.code=t.code,r}return e||t})),hideStackFrames:h,codes:s}}function requireValidators(){if(hasRequiredValidators)return validators;hasRequiredValidators=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:r,ArrayPrototypeMap:n,NumberIsInteger:i,NumberIsNaN:o,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:s,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:h,StringPrototypeToUpperCase:d,StringPrototypeTrim:p}=requirePrimordials(),{hideStackFrames:f,codes:{ERR_SOCKET_BAD_PORT:m,ERR_INVALID_ARG_TYPE:g,ERR_INVALID_ARG_VALUE:y,ERR_OUT_OF_RANGE:_,ERR_UNKNOWN_SIGNAL:v}}=requireErrors$1(),{normalizeEncoding:b}=requireUtil(),{isAsyncFunction:w,isArrayBufferView:x}=requireUtil().types,S={};const E=/^[0-7]+$/;const T=f(((e,t,r=s,n=a)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!i(e))throw new _(t,"an integer",e);if(e<r||e>n)throw new _(t,`>= ${r} && <= ${n}`,e)})),A=f(((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!i(e))throw new _(t,"an integer",e);if(e<r||e>n)throw new _(t,`>= ${r} && <= ${n}`,e)})),C=f(((e,t,r=!1)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!i(e))throw new _(t,"an integer",e);const n=r?1:0,o=4294967295;if(e<n||e>o)throw new _(t,`>= ${n} && <= ${o}`,e)}));function I(e,t){if("string"!=typeof e)throw new g(t,"string",e)}const k=f(((e,i,o)=>{if(!t(o,e)){const t=r(n(o,(e=>"string"==typeof e?`'${e}'`:h(e))),", ");throw new y(i,e,"must be one of: "+t)}}));function P(e,t){if("boolean"!=typeof e)throw new g(t,"boolean",e)}function M(e,t,r){return null!=e&&c(e,t)?e[t]:r}const R=f(((t,r,n=null)=>{const i=M(n,"allowArray",!1),o=M(n,"allowFunction",!1);if(!M(n,"nullable",!1)&&null===t||!i&&e(t)||"object"!=typeof t&&(!o||"function"!=typeof t))throw new g(r,"Object",t)})),D=f(((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new g(t,"a dictionary",e)})),O=f(((t,r,n=0)=>{if(!e(t))throw new g(r,"Array",t);if(t.length<n){throw new y(r,t,`must be longer than ${n}`)}}));const L=f(((e,t="buffer")=>{if(!x(e))throw new g(t,["Buffer","TypedArray","DataView"],e)}));const B=f(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new g(t,"AbortSignal",e)})),$=f(((e,t)=>{if("function"!=typeof e)throw new g(t,"Function",e)})),z=f(((e,t)=>{if("function"!=typeof e||w(e))throw new g(t,"Function",e)})),F=f(((e,t)=>{if(void 0!==e)throw new g(t,"undefined",e)}));const q=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function N(e,t){if(void 0===e||!u(q,e))throw new y(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return validators={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===u(E,e))throw new y(t,e,"must be a 32-bit unsigned integer or an octal string");e=l(e,8)}return C(e,t),e},validateArray:O,validateStringArray:function(e,t){O(e,t);for(let r=0;r<e.length;r++)I(e[r],`${t}[${r}]`)},validateBooleanArray:function(e,t){O(e,t);for(let r=0;r<e.length;r++)P(e[r],`${t}[${r}]`)},validateAbortSignalArray:function(e,t){O(e,t);for(let r=0;r<e.length;r++){const n=e[r],i=`${t}[${r}]`;if(null==n)throw new g(i,"AbortSignal",n);B(n,i)}},validateBoolean:P,validateBuffer:L,validateDictionary:D,validateEncoding:function(e,t){const r=b(t),n=e.length;if("hex"===r&&n%2!=0)throw new y("encoding",t,`is invalid for data of length ${n}`)},validateFunction:$,validateInt32:A,validateInteger:T,validateNumber:function(e,t,r=void 0,n){if("number"!=typeof e)throw new g(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&o(e))throw new _(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,e)},validateObject:R,validateOneOf:k,validatePlainFunction:z,validatePort:function(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===p(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new m(t,e,r);return 0|e},validateSignalName:function(e,t="signal"){if(I(e,t),void 0===S[e]){if(void 0!==S[d(e)])throw new v(e+" (signals must use all capital letters)");throw new v(e)}},validateString:I,validateUint32:C,validateUndefined:F,validateUnion:function(e,n,i){if(!t(i,e))throw new g(n,`('${r(i,"|")}')`,e)},validateAbortSignal:B,validateLinkHeaderValue:function(t){if("string"==typeof t)return N(t,"hints"),t;if(e(t)){const e=t.length;let r="";if(0===e)return r;for(let n=0;n<e;n++){const i=t[n];N(i,"hints"),r+=i,n!==e-1&&(r+=", ")}return r}throw new y("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}}var endOfStream={exports:{}},dist={},hasRequiredDist,utils$1,hasRequiredUtils$1,hasRequiredEndOfStream,destroy_1,hasRequiredDestroy,legacy,hasRequiredLegacy;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(e){function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var r,n,i={exports:{}},o=i.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,u=[],h=!1,d=-1;function p(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!h){var e=l(p);h=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||h||l(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0};const y=t(i.exports);e.default=y,e.process=y}(dist)),dist}function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:r}=requirePrimordials(),n=r("nodejs.stream.destroyed"),i=r("nodejs.stream.errored"),o=r("nodejs.stream.readable"),a=r("nodejs.stream.writable"),s=r("nodejs.stream.disturbed"),l=r("nodejs.webstream.isClosedPromise"),c=r("nodejs.webstream.controllerErrorFunction");function u(e,t=!1){var r;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(r=e._readableState)||void 0===r?void 0:r.readable)||e._writableState&&!e._readableState)}function h(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function d(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function p(e){return!(!e||d(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function f(e){return!(!e||d(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function m(e){return!(!e||d(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function g(e){if(!d(e))return null;const t=e._writableState,r=e._readableState,i=t||r;return!!(e.destroyed||e[n]||null!=i&&i.destroyed)}function y(e){if(!h(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function _(e,t){if(!u(e))return null;const r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function v(e){return e&&null!=e[o]?e[o]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!g(e)&&(u(e)&&e.readable&&!_(e))}function b(e){return e&&null!=e[a]?e[a]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!g(e)&&(h(e)&&e.writable&&!y(e))}function w(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function x(e){return"boolean"==typeof e._sent100&&w(e)}return utils$1={isDestroyed:g,kIsDestroyed:n,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[s])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:s,isErrored:function(e){var t,r,n,o,a,s,l,c,u,h;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(o=null!==(a=null!==(s=e[i])&&void 0!==s?s:e.readableErrored)&&void 0!==a?a:e.writableErrored)&&void 0!==o?o:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(h=e._writableState)||void 0===h?void 0:h.errored))},kIsErrored:i,isReadable:v,kIsReadable:o,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:function(e){if(!d(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&w(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return d(e)?!!g(e)||(!1===(null==t?void 0:t.readable)||!v(e))&&(!1===(null==t?void 0:t.writable)||!b(e)):null},isIterable:function(r,n){return null!=r&&(!0===n?"function"==typeof r[e]:!1===n?"function"==typeof r[t]:"function"==typeof r[e]||"function"==typeof r[t])},isReadableNodeStream:u,isReadableStream:p,isReadableEnded:function(e){if(!u(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:_,isReadableErrored:function(e){var t,r;return d(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isNodeStream:d,isWebStream:function(e){return p(e)||f(e)||m(e)},isWritable:b,isWritableNodeStream:h,isWritableStream:f,isWritableEnded:y,isWritableFinished:function(e,t){if(!h(e))return null;if(!0===e.writableFinished)return!0;const r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))},isWritableErrored:function(e){var t,r;return d(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:x,willEmitClose:function(e){if(!d(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&x(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)},isTransformStream:m}}function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream.exports;hasRequiredEndOfStream=1;const e=requireDist(),{AbortError:t,codes:r}=requireErrors$1(),{ERR_INVALID_ARG_TYPE:n,ERR_STREAM_PREMATURE_CLOSE:i}=r,{kEmptyObject:o,once:a}=requireUtil(),{validateAbortSignal:s,validateFunction:l,validateObject:c,validateBoolean:u}=requireValidators(),{Promise:h,PromisePrototypeThen:d,SymbolDispose:p}=requirePrimordials(),{isClosed:f,isReadable:m,isReadableNodeStream:g,isReadableStream:y,isReadableFinished:_,isReadableErrored:v,isWritable:b,isWritableNodeStream:w,isWritableStream:x,isWritableFinished:S,isWritableErrored:E,isNodeStream:T,willEmitClose:A,kIsClosedPromise:C}=requireUtils$1();let I;const k=()=>{};function P(r,u,h){var P,M;if(2===arguments.length?(h=u,u=o):null==u?u=o:c(u,"options"),l(h,"callback"),s(u.signal,"options.signal"),h=a(h),y(r)||x(r))return function(r,n,i){let o=!1,s=k;if(n.signal)if(s=()=>{o=!0,i.call(r,new t(void 0,{cause:n.signal.reason}))},n.signal.aborted)e.nextTick(s);else{I=I||requireUtil().addAbortListener;const e=I(n.signal,s),t=i;i=a(((...n)=>{e[p](),t.apply(r,n)}))}const l=(...t)=>{o||e.nextTick((()=>i.apply(r,t)))};return d(r[C].promise,l,l),k}(r,u,h);if(!T(r))throw new n("stream",["ReadableStream","WritableStream","Stream"],r);const R=null!==(P=u.readable)&&void 0!==P?P:g(r),D=null!==(M=u.writable)&&void 0!==M?M:w(r),O=r._writableState,L=r._readableState,B=()=>{r.writable||F()};let $=A(r)&&g(r)===R&&w(r)===D,z=S(r,!1);const F=()=>{z=!0,r.destroyed&&($=!1),(!$||r.readable&&!R)&&(R&&!q||h.call(r))};let q=_(r,!1);const N=()=>{q=!0,r.destroyed&&($=!1),(!$||r.writable&&!D)&&(D&&!z||h.call(r))},j=e=>{h.call(r,e)};let U=f(r);const V=()=>{U=!0;const e=E(r)||v(r);return e&&"boolean"!=typeof e?h.call(r,e):R&&!q&&g(r,!0)&&!_(r,!1)?h.call(r,new i):!D||z||S(r,!1)?void h.call(r):h.call(r,new i)},G=()=>{U=!0;const e=E(r)||v(r);if(e&&"boolean"!=typeof e)return h.call(r,e);h.call(r)},W=()=>{r.req.on("finish",F)};!function(e){return e.setHeader&&"function"==typeof e.abort}(r)?D&&!O&&(r.on("end",B),r.on("close",B)):(r.on("complete",F),$||r.on("abort",V),r.req?W():r.on("request",W)),$||"boolean"!=typeof r.aborted||r.on("aborted",V),r.on("end",N),r.on("finish",F),!1!==u.error&&r.on("error",j),r.on("close",V),U?e.nextTick(V):null!=O&&O.errorEmitted||null!=L&&L.errorEmitted?$||e.nextTick(G):(R||$&&!m(r)||!z&&!1!==b(r))&&(D||$&&!b(r)||!q&&!1!==m(r))?L&&r.req&&r.aborted&&e.nextTick(G):e.nextTick(G);const H=()=>{h=k,r.removeListener("aborted",V),r.removeListener("complete",F),r.removeListener("abort",V),r.removeListener("request",W),r.req&&r.req.removeListener("finish",F),r.removeListener("end",B),r.removeListener("close",B),r.removeListener("finish",F),r.removeListener("end",N),r.removeListener("error",j),r.removeListener("close",V)};if(u.signal&&!U){const n=()=>{const e=h;H(),e.call(r,new t(void 0,{cause:u.signal.reason}))};if(u.signal.aborted)e.nextTick(n);else{I=I||requireUtil().addAbortListener;const e=I(u.signal,n),t=h;h=a(((...n)=>{e[p](),t.apply(r,n)}))}}return H}return endOfStream.exports=P,endOfStream.exports.finished=function(e,t){var r;let n=!1;return null===t&&(t=o),null!==(r=t)&&void 0!==r&&r.cleanup&&(u(t.cleanup,"cleanup"),n=t.cleanup),new h(((r,i)=>{const o=P(e,t,(e=>{n&&o(),e?i(e):r()}))}))},endOfStream.exports}function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;const e=requireDist(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:r},AbortError:n}=requireErrors$1(),{Symbol:i}=requirePrimordials(),{kIsDestroyed:o,isDestroyed:a,isFinished:s,isServerRequest:l}=requireUtils$1(),c=i("kDestroy"),u=i("kConstruct");function h(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function d(t,r,n){let i=!1;function o(r){if(i)return;i=!0;const o=t._readableState,a=t._writableState;h(r,a,o),a&&(a.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(r),r?e.nextTick(p,t,r):e.nextTick(f,t)}try{t._destroy(r||null,o)}catch(a){o(a)}}function p(e,t){m(e,t),f(e)}function f(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function m(e,t){const r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function g(t,r,n){const i=t._readableState,o=t._writableState;if(null!=o&&o.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=o&&o.autoDestroy?t.destroy(r):r&&(r.stack,o&&!o.errored&&(o.errored=r),i&&!i.errored&&(i.errored=r),n?e.nextTick(m,t,r):m(t,r))}function y(t){let n=!1;function i(i){if(n)return void g(t,null!=i?i:new r);n=!0;const o=t._readableState,a=t._writableState,s=a||o;o&&(o.constructed=!0),a&&(a.constructed=!0),s.destroyed?t.emit(c,i):i?g(t,i,!0):e.nextTick(_,t)}try{t._construct((t=>{e.nextTick(i,t)}))}catch(o){e.nextTick(i,o)}}function _(e){e.emit(u)}function v(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function b(e){e.emit("close")}function w(t,r){t.emit("error",r),e.nextTick(b,t)}return destroy_1={construct:function(t,r){if("function"!=typeof t._construct)return;const n=t._readableState,i=t._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),t.once(u,r),t.listenerCount(u)>1||e.nextTick(y,t)},destroyer:function(t,r){t&&!a(t)&&(r||s(t)||(r=new n),l(t)?(t.socket=null,t.destroy(r)):v(t)?t.abort():v(t.req)?t.req.abort():"function"==typeof t.destroy?t.destroy(r):"function"==typeof t.close?t.close():r?e.nextTick(w,t,r):e.nextTick(b,t),t.destroyed||(t[o]=!0))},destroy:function(e,r){const n=this._readableState,i=this._writableState,o=i||n;return null!=i&&i.destroyed||null!=n&&n.destroyed?("function"==typeof r&&r(),this):(h(e,i,n),i&&(i.destroyed=!0),n&&(n.destroyed=!0),o.constructed?d(this,e,r):this.once(c,(function(n){d(this,t(n,e),r)})),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:g}}function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=requirePrimordials(),{EventEmitter:r}=requireEvents();function n(e){r.call(this,e)}function i(t,r,n){if("function"==typeof t.prependListener)return t.prependListener(r,n);t._events&&t._events[r]?e(t._events[r])?t._events[r].unshift(n):t._events[r]=[n,t._events[r]]:t.on(r,n)}return t(n.prototype,r.prototype),t(n,r),n.prototype.pipe=function(e,t){const n=this;function o(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",l),n.on("close",c));let s=!1;function l(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){h(),0===r.listenerCount(this,"error")&&this.emit("error",e)}function h(){n.removeListener("data",o),e.removeListener("drain",a),n.removeListener("end",l),n.removeListener("close",c),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return i(n,"error",u),i(e,"error",u),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e},legacy={Stream:n,prependListener:i}}var addAbortSignal={exports:{}},hasRequiredAddAbortSignal,buffer_list,hasRequiredBuffer_list,state,hasRequiredState,from_1,hasRequiredFrom,readable,hasRequiredReadable,writable,hasRequiredWritable,duplexify,hasRequiredDuplexify,duplex,hasRequiredDuplex,transform,hasRequiredTransform,passthrough,hasRequiredPassthrough,pipeline_1,hasRequiredPipeline,compose,hasRequiredCompose,hasRequiredOperators,promises$1,hasRequiredPromises,hasRequiredStream,hasRequiredBrowser$1;function requireAddAbortSignal(){return hasRequiredAddAbortSignal||(hasRequiredAddAbortSignal=1,function(e){const{SymbolDispose:t}=requirePrimordials(),{AbortError:r,codes:n}=requireErrors$1(),{isNodeStream:i,isWebStream:o,kControllerErrorFunction:a}=requireUtils$1(),s=requireEndOfStream(),{ERR_INVALID_ARG_TYPE:l}=n;let c;e.exports.addAbortSignal=function(t,r){if(((e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new l(t,"AbortSignal",e)})(t,"signal"),!i(r)&&!o(r))throw new l("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,n){if("object"!=typeof e||!("aborted"in e))return n;const o=i(n)?()=>{n.destroy(new r(void 0,{cause:e.reason}))}:()=>{n[a](new r(void 0,{cause:e.reason}))};if(e.aborted)o();else{c=c||requireUtil().addAbortListener;const r=c(e,o);s(n,r[t])}return n}}(addAbortSignal)),addAbortSignal.exports}function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:r,Uint8Array:n}=requirePrimordials(),{Buffer:i}=requireDist$1(),{inspect:o}=requireUtil();return buffer_list=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return i.alloc(0);const t=i.allocUnsafe(e>>>0);let n=this.head,o=0;for(;n;)r(t,n.data,o),o+=n.data.length,n=n.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[t](){for(let e=this.head;e;e=e.next)yield e.data}_getString(t){let r="",n=this.head,i=0;do{const o=n.data;if(!(t>o.length)){t===o.length?(r+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=e(o,0,t),this.head=n,n.data=e(o,t));break}r+=o,t-=o.length,++i}while(null!==(n=n.next));return this.length-=i,r}_getBuffer(e){const t=i.allocUnsafe(e),o=e;let a=this.head,s=0;do{const i=a.data;if(!(e>i.length)){e===i.length?(r(t,i,o-e),++s,a.next?this.head=a.next:this.head=this.tail=null):(r(t,new n(i.buffer,i.byteOffset,e),o-e),this.head=a,a.data=i.slice(e));break}r(t,i,o-e),e-=i.length,++s}while(null!==(a=a.next));return this.length-=s,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return o(this,{...t,depth:0,customInspect:!1})}}}function requireState(){if(hasRequiredState)return state;hasRequiredState=1;const{MathFloor:e,NumberIsInteger:t}=requirePrimordials(),{validateInteger:r}=requireValidators(),{ERR_INVALID_ARG_VALUE:n}=requireErrors$1().codes;let i=16384,o=16;function a(e){return e?o:i}return state={getHighWaterMark:function(r,i,o,s){const l=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(i,s,o);if(null!=l){if(!t(l)||l<0){throw new n(s?`options.${o}`:"options.highWaterMark",l)}return e(l)}return a(r.objectMode)},getDefaultHighWaterMark:a,setDefaultHighWaterMark:function(e,t){r(t,"value",0),e?o=t:i=t}}}function requireFrom(){if(hasRequiredFrom)return from_1;hasRequiredFrom=1;const e=requireDist(),{PromisePrototypeThen:t,SymbolAsyncIterator:r,SymbolIterator:n}=requirePrimordials(),{Buffer:i}=requireDist$1(),{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_NULL_VALUES:a}=requireErrors$1().codes;return from_1=function(s,l,c){let u,h;if("string"==typeof l||l instanceof i)return new s({objectMode:!0,...c,read(){this.push(l),this.push(null)}});if(l&&l[r])h=!0,u=l[r]();else{if(!l||!l[n])throw new o("iterable",["Iterable"],l);h=!1,u=l[n]()}const d=new s({objectMode:!0,highWaterMark:1,...c});let p=!1;return d._read=function(){p||(p=!0,async function(){for(;;){try{const{value:e,done:t}=h?await u.next():u.next();if(t)d.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw p=!1,new a;if(d.push(t))continue;p=!1}}catch(e){d.destroy(e)}break}}())},d._destroy=function(r,n){t(async function(e){const t=null!=e,r="function"==typeof u.throw;if(t&&r){const{value:t,done:r}=await u.throw(e);if(await t,r)return}if("function"==typeof u.return){const{value:e}=await u.return();await e}}(r),(()=>e.nextTick(n,r)),(t=>e.nextTick(n,t||r)))},d}}function requireReadable(){if(hasRequiredReadable)return readable;hasRequiredReadable=1;const e=requireDist(),{ArrayPrototypeIndexOf:t,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:i,ObjectDefineProperties:o,ObjectKeys:a,ObjectSetPrototypeOf:s,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:h,Symbol:d}=requirePrimordials();readable=V,V.ReadableState=U;const{EventEmitter:p}=requireEvents(),{Stream:f,prependListener:m}=requireLegacy(),{Buffer:g}=requireDist$1(),{addAbortSignal:y}=requireAddAbortSignal(),_=requireEndOfStream();let v=requireUtil().debuglog("stream",(e=>{v=e}));const b=requireBuffer_list(),w=requireDestroy(),{getHighWaterMark:x,getDefaultHighWaterMark:S}=requireState(),{aggregateTwoErrors:E,codes:{ERR_INVALID_ARG_TYPE:T,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_OUT_OF_RANGE:C,ERR_STREAM_PUSH_AFTER_EOF:I,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:k},AbortError:P}=requireErrors$1(),{validateObject:M}=requireValidators(),R=d("kPaused"),{StringDecoder:D}=requireString_decoder(),O=requireFrom();s(V.prototype,f.prototype),s(V,f);const L=()=>{},{errorOrDestroy:B}=w,$=1,z=16,F=32,q=2048,N=4096;function j(e){return{enumerable:!1,get(){return!!(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function U(e,t,r){"boolean"!=typeof r&&(r=t instanceof requireDuplex()),this.state=q|N|z|F,e&&e.objectMode&&(this.state|=$),r&&e&&e.readableObjectMode&&(this.state|=$),this.highWaterMark=e?x(this,e,"readableHighWaterMark",r):S(!1),this.buffer=new b,this.length=0,this.pipes=[],this.flowing=null,this[R]=null,e&&!1===e.emitClose&&(this.state&=~q),e&&!1===e.autoDestroy&&(this.state&=~N),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new D(e.encoding),this.encoding=e.encoding)}function V(e){if(!(this instanceof V))return new V(e);const t=this instanceof requireDuplex();this._readableState=new U(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&y(e.signal,this)),f.call(this,e),w.construct(this,(()=>{this._readableState.needReadable&&X(this,this._readableState)}))}function G(e,t,r,n){v("readableAddChunk",t);const i=e._readableState;let o;if(i.state&$||("string"==typeof t?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?t=g.from(t,r).toString(i.encoding):(t=g.from(t,r),r=""))):t instanceof g?r="":f._isUint8Array(t)?(t=f._uint8ArrayToBuffer(t),r=""):null!=t&&(o=new T("chunk",["string","Buffer","Uint8Array"],t))),o)B(e,o);else if(null===t)i.state&=-9,function(e,t){if(v("onEofChunk"),t.ended)return;if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?Z(e):(t.needReadable=!1,t.emittedReadable=!0,Y(e))}(e,i);else if(i.state&$||t&&t.length>0)if(n)if(4&i.state)B(e,new k);else{if(i.destroyed||i.errored)return!1;W(e,i,t,!0)}else if(i.ended)B(e,new I);else{if(i.destroyed||i.errored)return!1;i.state&=-9,i.decoder&&!r?(t=i.decoder.write(t),i.objectMode||0!==t.length?W(e,i,t,!1):X(e,i)):W(e,i,t,!1)}else n||(i.state&=-9,X(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function W(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(65536&t.state?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),64&t.state&&Z(e)),X(e,t)}o(U.prototype,{objectMode:j($),ended:j(2),endEmitted:j(4),reading:j(8),constructed:j(z),sync:j(F),needReadable:j(64),emittedReadable:j(128),readableListening:j(256),resumeScheduled:j(512),errorEmitted:j(1024),emitClose:j(q),autoDestroy:j(N),destroyed:j(8192),closed:j(16384),closeEmitted:j(32768),multiAwaitDrain:j(65536),readingMore:j(1<<17),dataEmitted:j(1<<18)}),V.prototype.destroy=w.destroy,V.prototype._undestroy=w.undestroy,V.prototype._destroy=function(e,t){t(e)},V.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},V.prototype[u]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new P,this.destroy(e)),new l(((t,r)=>_(this,(n=>n&&n!==e?r(n):t(null)))))},V.prototype.push=function(e,t){return G(this,e,t,!1)},V.prototype.unshift=function(e,t){return G(this,e,t,!0)},V.prototype.isPaused=function(){const e=this._readableState;return!0===e[R]||!1===e.flowing},V.prototype.setEncoding=function(e){const t=new D(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let n="";for(const i of r)n+=t.write(i);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this};function H(e,t){return e<=0||0===t.length&&t.ended?0:t.state&$?1:n(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function Z(t){const r=t._readableState;v("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(v("emitReadable",r.flowing),r.emittedReadable=!0,e.nextTick(Y,t))}function Y(e){const t=e._readableState;v("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,te(e)}function X(t,r){!r.readingMore&&r.constructed&&(r.readingMore=!0,e.nextTick(K,t,r))}function K(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const r=t.length;if(v("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function Q(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[R]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function J(e){v("readable nexttick read 0"),e.read(0)}function ee(e,t){v("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),te(e),t.flowing&&!t.reading&&e.read(0)}function te(e){const t=e._readableState;for(v("flow",t.flowing);t.flowing&&null!==e.read(););}function re(e,t){"function"!=typeof e.read&&(e=V.wrap(e,{objectMode:!0}));const r=async function*(e,t){let r,n=L;function i(t){this===e?(n(),n=L):n=t}e.on("readable",i);const o=_(e,{writable:!1},(e=>{r=e?E(r,e):null,n(),n=L}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(r)throw r;if(null===r)return;await new l(i)}}}catch(a){throw r=E(r,a),r}finally{!r&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==r&&!e._readableState.autoDestroy?(e.off("readable",i),o()):w.destroyer(e,null)}}(e,t);return r.stream=e,r}function ne(e,t){if(0===t.length)return null;let r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function ie(t){const r=t._readableState;v("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,e.nextTick(oe,r,t))}function oe(t,r){if(v("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length)if(t.endEmitted=!0,r.emit("end"),r.writable&&!1===r.allowHalfOpen)e.nextTick(ae,r);else if(t.autoDestroy){const e=r._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&r.destroy()}}function ae(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let se;function le(){return void 0===se&&(se={}),se}return V.prototype.read=function(e){v("read",e),void 0===e?e=NaN:r(e)||(e=i(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new C("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return v("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ie(this):Z(this),null;if(0===(e=H(e,t))&&t.ended)return 0===t.length&&ie(this),null;let o,a=!!(64&t.state);if(v("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&(a=!0,v("length less than watermark",a)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)a=!1,v("reading, ended or constructing",a);else if(a){v("do read"),t.state|=8|F,0===t.length&&(t.state|=64);try{this._read(t.highWaterMark)}catch(s){B(this,s)}t.state&=~F,t.reading||(e=H(n,t))}return o=e>0?ne(e,t):null,null===o?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&ie(this)),null===o||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",o)),o},V.prototype._read=function(e){throw new A("_read()")},V.prototype.pipe=function(t,r){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new c(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(t),v("pipe count=%d opts=%j",i.pipes.length,r);const o=(!r||!1!==r.end)&&t!==e.stdout&&t!==e.stderr?s:y;function a(e,r){v("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,function(){v("cleanup"),t.removeListener("close",f),t.removeListener("finish",g),l&&t.removeListener("drain",l);t.removeListener("error",p),t.removeListener("unpipe",a),n.removeListener("end",s),n.removeListener("end",y),n.removeListener("data",d),u=!0,l&&i.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&l()}())}function s(){v("onend"),t.end()}let l;i.endEmitted?e.nextTick(o):n.once("end",o),t.on("unpipe",a);let u=!1;function h(){u||(1===i.pipes.length&&i.pipes[0]===t?(v("false write response, pause",0),i.awaitDrainWriters=t,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(t)&&(v("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(t)),n.pause()),l||(l=function(e,t){return function(){const r=e._readableState;r.awaitDrainWriters===t?(v("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(v("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),r.awaitDrainWriters&&0!==r.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,t),t.on("drain",l))}function d(e){v("ondata");const r=t.write(e);v("dest.write",r),!1===r&&h()}function p(e){if(v("onerror",e),y(),t.removeListener("error",p),0===t.listenerCount("error")){const r=t._writableState||t._readableState;r&&!r.errorEmitted?B(t,e):t.emit("error",e)}}function f(){t.removeListener("finish",g),y()}function g(){v("onfinish"),t.removeListener("close",f),y()}function y(){v("unpipe"),n.unpipe(t)}return n.on("data",d),m(t,"error",p),t.once("close",f),t.once("finish",g),t.emit("pipe",n),!0===t.writableNeedDrain?h():i.flowing||(v("pipe resume"),n.resume()),t},V.prototype.unpipe=function(e){const r=this._readableState;if(0===r.pipes.length)return this;if(!e){const e=r.pipes;r.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=t(r.pipes,e);return-1===n||(r.pipes.splice(n,1),0===r.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},V.prototype.on=function(t,r){const n=f.prototype.on.call(this,t,r),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,v("on readable",i.length,i.reading),i.length?Z(this):i.reading||e.nextTick(J,this))),n},V.prototype.addListener=V.prototype.on,V.prototype.removeListener=function(t,r){const n=f.prototype.removeListener.call(this,t,r);return"readable"===t&&e.nextTick(Q,this),n},V.prototype.off=V.prototype.removeListener,V.prototype.removeAllListeners=function(t){const r=f.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||e.nextTick(Q,this),r},V.prototype.resume=function(){const t=this._readableState;return t.flowing||(v("resume"),t.flowing=!t.readableListening,function(t,r){r.resumeScheduled||(r.resumeScheduled=!0,e.nextTick(ee,t,r))}(this,t)),t[R]=!1,this},V.prototype.pause=function(){return v("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(v("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[R]=!0,this},V.prototype.wrap=function(e){let t=!1;e.on("data",(r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{B(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const r=a(e);for(let n=1;n<r.length;n++){const t=r[n];void 0===this[t]&&"function"==typeof e[t]&&(this[t]=e[t].bind(e))}return this},V.prototype[h]=function(){return re(this)},V.prototype.iterator=function(e){return void 0!==e&&M(e,"options"),re(this,e)},o(V.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),o(U.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[R]},set(e){this[R]=!!e}}}),V._fromList=ne,V.from=function(e,t){return O(V,e,t)},V.fromWeb=function(e,t){return le().newStreamReadableFromReadableStream(e,t)},V.toWeb=function(e,t){return le().newReadableStreamFromStreamReadable(e,t)},V.wrap=function(e,t){var r,n;return new V({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){w.destroyer(e,t),r(t)}}).wrap(e)},readable}function requireWritable(){if(hasRequiredWritable)return writable;hasRequiredWritable=1;const e=requireDist(),{ArrayPrototypeSlice:t,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:i,ObjectDefineProperties:o,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:s,Symbol:l,SymbolHasInstance:c}=requirePrimordials();writable=M,M.WritableState=k;const{EventEmitter:u}=requireEvents(),h=requireLegacy().Stream,{Buffer:d}=requireDist$1(),p=requireDestroy(),{addAbortSignal:f}=requireAddAbortSignal(),{getHighWaterMark:m,getDefaultHighWaterMark:g}=requireState(),{ERR_INVALID_ARG_TYPE:y,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:v,ERR_STREAM_CANNOT_PIPE:b,ERR_STREAM_DESTROYED:w,ERR_STREAM_ALREADY_FINISHED:x,ERR_STREAM_NULL_VALUES:S,ERR_STREAM_WRITE_AFTER_END:E,ERR_UNKNOWN_ENCODING:T}=requireErrors$1().codes,{errorOrDestroy:A}=p;function C(){}a(M.prototype,h.prototype),a(M,h);const I=l("kOnFinished");function k(e,t,r){"boolean"!=typeof r&&(r=t instanceof requireDuplex()),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?m(this,e,"writableHighWaterMark",r):g(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const n=!(!e||!1!==e.decodeStrings);this.decodeStrings=!n,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=L.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,P(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[I]=[]}function P(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function M(e){const t=this instanceof requireDuplex();if(!t&&!n(M,this))return new M(e);this._writableState=new k(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&f(e.signal,this)),h.call(this,e),p.construct(this,(()=>{const e=this._writableState;e.writing||F(this,e),j(this,e)}))}function R(t,r,n,i){const o=t._writableState;if("function"==typeof n)i=n,n=o.defaultEncoding;else{if(n){if("buffer"!==n&&!d.isEncoding(n))throw new T(n)}else n=o.defaultEncoding;"function"!=typeof i&&(i=C)}if(null===r)throw new S;if(!o.objectMode)if("string"==typeof r)!1!==o.decodeStrings&&(r=d.from(r,n),n="buffer");else if(r instanceof d)n="buffer";else{if(!h._isUint8Array(r))throw new y("chunk",["string","Buffer","Uint8Array"],r);r=h._uint8ArrayToBuffer(r),n="buffer"}let a;return o.ending?a=new E:o.destroyed&&(a=new w("write")),a?(e.nextTick(i,a),A(t,a,!0),a):(o.pendingcb++,function(e,t,r,n,i){const o=t.objectMode?1:r.length;t.length+=o;const a=t.length<t.highWaterMark;a||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==C&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1);return a&&!t.errored&&!t.destroyed}(t,o,r,n,i))}function D(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new w("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function O(e,t,r,n){--t.pendingcb,n(r),z(t),A(e,r)}function L(t,r){const n=t._writableState,i=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,r?(r.stack,n.errored||(n.errored=r),t._readableState&&!t._readableState.errored&&(t._readableState.errored=r),i?e.nextTick(O,t,n,r,o):O(t,n,r,o)):(n.buffered.length>n.bufferedIndex&&F(t,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:t,state:n},e.nextTick(B,n.afterWriteTickInfo)):$(t,n,1,o))):A(t,new v)}function B({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,$(e,t,r,n)}function $(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&z(t),j(e,t)}function z(e){if(e.writing)return;for(let i=e.bufferedIndex;i<e.buffered.length;++i){var t;const{chunk:r,callback:n}=e.buffered[i],o=e.objectMode?1:r.length;e.length-=o,n(null!==(t=e.errored)&&void 0!==t?t:new w("write"))}const r=e[I].splice(0);for(let i=0;i<r.length;i++){var n;r[i](null!==(n=e.errored)&&void 0!==n?n:new w("end"))}P(e)}function F(e,r){if(r.corked||r.bufferProcessing||r.destroyed||!r.constructed)return;const{buffered:n,bufferedIndex:i,objectMode:o}=r,a=n.length-i;if(!a)return;let s=i;if(r.bufferProcessing=!0,a>1&&e._writev){r.pendingcb-=a-1;const i=r.allNoop?C:e=>{for(let t=s;t<n.length;++t)n[t].callback(e)},o=r.allNoop&&0===s?n:t(n,s);o.allBuffers=r.allBuffers,D(e,r,!0,r.length,o,"",i),P(r)}else{do{const{chunk:t,encoding:i,callback:a}=n[s];n[s++]=null;D(e,r,!1,o?1:t.length,t,i,a)}while(s<n.length&&!r.writing);s===n.length?P(r):s>256?(n.splice(0,s),r.bufferedIndex=0):r.bufferedIndex=s}r.bufferProcessing=!1}function q(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function N(t,r){r.prefinished||r.finalCalled||("function"!=typeof t._final||r.destroyed?(r.prefinished=!0,t.emit("prefinish")):(r.finalCalled=!0,function(t,r){let n=!1;function i(i){if(n)A(t,null!=i?i:v());else if(n=!0,r.pendingcb--,i){const e=r[I].splice(0);for(let t=0;t<e.length;t++)e[t](i);A(t,i,r.sync)}else q(r)&&(r.prefinished=!0,t.emit("prefinish"),r.pendingcb++,e.nextTick(U,t,r))}r.sync=!0,r.pendingcb++;try{t._final(i)}catch(o){i(o)}r.sync=!1}(t,r)))}function j(t,r,n){q(r)&&(N(t,r),0===r.pendingcb&&(n?(r.pendingcb++,e.nextTick(((e,t)=>{q(t)?U(e,t):t.pendingcb--}),t,r)):q(r)&&(r.pendingcb++,U(t,r))))}function U(e,t){t.pendingcb--,t.finished=!0;const r=t[I].splice(0);for(let n=0;n<r.length;n++)r[n]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},i(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),i(M,c,{__proto__:null,value:function(e){return!!n(this,e)||this===M&&(e&&e._writableState instanceof k)}}),M.prototype.pipe=function(){A(this,new b)},M.prototype.write=function(e,t,r){return!0===R(this,e,t,r)},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||F(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=s(e)),!d.isEncoding(e))throw new T(e);return this._writableState.defaultEncoding=e,this},M.prototype._write=function(e,t,r){if(!this._writev)throw new _("_write()");this._writev([{chunk:e,encoding:t}],r)},M.prototype._writev=null,M.prototype.end=function(t,n,i){const o=this._writableState;let a;if("function"==typeof t?(i=t,t=null,n=null):"function"==typeof n&&(i=n,n=null),null!=t){const e=R(this,t,n);e instanceof r&&(a=e)}return o.corked&&(o.corked=1,this.uncork()),a||(o.errored||o.ending?o.finished?a=new x("end"):o.destroyed&&(a=new w("end")):(o.ending=!0,j(this,o,!0),o.ended=!0)),"function"==typeof i&&(a||o.finished?e.nextTick(i,a):o[I].push(i)),this},o(M.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const V=p.destroy;let G;function W(){return void 0===G&&(G={}),G}return M.prototype.destroy=function(t,r){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[I].length)&&e.nextTick(z,n),V.call(this,t,r),this},M.prototype._undestroy=p.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype[u.captureRejectionSymbol]=function(e){this.destroy(e)},M.fromWeb=function(e,t){return W().newStreamWritableFromWritableStream(e,t)},M.toWeb=function(e){return W().newWritableStreamFromStreamWritable(e)},writable}function requireDuplexify(){if(hasRequiredDuplexify)return duplexify;hasRequiredDuplexify=1;const e=requireDist(),t=requireDist$1(),{isReadable:r,isWritable:n,isIterable:i,isNodeStream:o,isReadableNodeStream:a,isWritableNodeStream:s,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=requireUtils$1(),h=requireEndOfStream(),{AbortError:d,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:f}}=requireErrors$1(),{destroyer:m}=requireDestroy(),g=requireDuplex(),y=requireReadable(),_=requireWritable(),{createDeferredPromise:v}=requireUtil(),b=requireFrom(),w=globalThis.Blob||t.Blob,x=void 0!==w?function(e){return e instanceof w}:function(e){return!1},S=globalThis.AbortController||requireBrowser$2().AbortController,{FunctionPrototypeCall:E}=requirePrimordials();class T extends g{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function A(e){const t=e.readable&&"function"!=typeof e.readable.read?y.wrap(e.readable):e.readable,i=e.writable;let o,a,s,l,c,u=!!r(t),p=!!n(i);function f(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new T({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==i||!i.writableObjectMode),readable:u,writable:p}),p&&(h(i,(e=>{p=!1,e&&m(t,e),f(e)})),c._write=function(e,t,r){i.write(e,t)?r():o=r},c._final=function(e){i.end(),a=e},i.on("drain",(function(){if(o){const e=o;o=null,e()}})),i.on("finish",(function(){if(a){const e=a;a=null,e()}}))),u&&(h(t,(e=>{u=!1,e&&m(t,e),f(e)})),t.on("readable",(function(){if(s){const e=s;s=null,e()}})),t.on("end",(function(){c.push(null)})),c._read=function(){for(;;){const e=t.read();if(null===e)return void(s=c._read);if(!c.push(e))return}}),c._destroy=function(e,r){e||null===l||(e=new d),s=null,o=null,a=null,null===l?r(e):(l=r,m(i,e),m(t,e))},c}return duplexify=function t(r,n){if(l(r))return r;if(a(r))return A({readable:r});if(s(r))return A({writable:r});if(o(r))return A({writable:!1,readable:!1});if(c(r))return A({readable:y.fromWeb(r)});if(u(r))return A({writable:_.fromWeb(r)});if("function"==typeof r){const{value:t,write:o,final:a,destroy:s}=function(t){let{promise:r,resolve:n}=v();const i=new S,o=i.signal,a=t(async function*(){for(;;){const t=r;r=null;const{chunk:i,done:a,cb:s}=await t;if(e.nextTick(s),a)return;if(o.aborted)throw new d(void 0,{cause:o.reason});({promise:r,resolve:n}=v()),yield i}}(),{signal:o});return{value:a,write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(r);if(i(t))return b(T,t,{objectMode:!0,write:o,final:a,destroy:s});const l=null==t?void 0:t.then;if("function"==typeof l){let r;const n=E(l,t,(e=>{if(null!=e)throw new f("nully","body",e)}),(e=>{m(r,e)}));return r=new T({objectMode:!0,readable:!1,write:o,final(t){a((async()=>{try{await n,e.nextTick(t,null)}catch(r){e.nextTick(t,r)}}))},destroy:s})}throw new f("Iterable, AsyncIterable or AsyncFunction",n,t)}if(x(r))return t(r.arrayBuffer());if(i(r))return b(T,r,{objectMode:!0,writable:!1});if(c(null==r?void 0:r.readable)&&u(null==r?void 0:r.writable))return T.fromWeb(r);if("object"==typeof(null==r?void 0:r.writable)||"object"==typeof(null==r?void 0:r.readable)){return A({readable:null!=r&&r.readable?a(null==r?void 0:r.readable)?null==r?void 0:r.readable:t(r.readable):void 0,writable:null!=r&&r.writable?s(null==r?void 0:r.writable)?null==r?void 0:r.writable:t(r.writable):void 0})}const h=null==r?void 0:r.then;if("function"==typeof h){let e;return E(h,r,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{m(e,t)})),e=new T({objectMode:!0,writable:!1,read(){}})}throw new p(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],r)}}function requireDuplex(){if(hasRequiredDuplex)return duplex;hasRequiredDuplex=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:r,ObjectSetPrototypeOf:n}=requirePrimordials();duplex=a;const i=requireReadable(),o=requireWritable();n(a.prototype,i.prototype),n(a,i);{const e=r(o.prototype);for(let t=0;t<e.length;t++){const r=e[t];a.prototype[r]||(a.prototype[r]=o.prototype[r])}}function a(e){if(!(this instanceof a))return new a(e);i.call(this,e),o.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let s,l;function c(){return void 0===s&&(s={}),s}return e(a.prototype,{writable:{__proto__:null,...t(o.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(o.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(o.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(o.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(o.prototype,"writableLength")},writableFinished:{__proto__:null,...t(o.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(o.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(o.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(o.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),a.fromWeb=function(e,t){return c().newStreamDuplexFromReadableWritablePair(e,t)},a.toWeb=function(e){return c().newReadableWritablePairFromDuplex(e)},a.from=function(e){return l||(l=requireDuplexify()),l(e,"body")},duplex}function requireTransform(){if(hasRequiredTransform)return transform;hasRequiredTransform=1;const{ObjectSetPrototypeOf:e,Symbol:t}=requirePrimordials();transform=a;const{ERR_METHOD_NOT_IMPLEMENTED:r}=requireErrors$1().codes,n=requireDuplex(),{getHighWaterMark:i}=requireState();e(a.prototype,n.prototype),e(a,n);const o=t("kCallback");function a(e){if(!(this instanceof a))return new a(e);const t=e?i(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),n.call(this,e),this._readableState.sync=!1,this[o]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function s(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,r)=>{t?e?e(t):this.destroy(t):(null!=r&&this.push(r),this.push(null),e&&e())}))}function l(){this._final!==s&&s.call(this)}return a.prototype._final=s,a.prototype._transform=function(e,t,n){throw new r("_transform()")},a.prototype._write=function(e,t,r){const n=this._readableState,i=this._writableState,a=n.length;this._transform(e,t,((e,t)=>{e?r(e):(null!=t&&this.push(t),i.ended||a===n.length||n.length<n.highWaterMark?r():this[o]=r)}))},a.prototype._read=function(){if(this[o]){const e=this[o];this[o]=null,e()}},transform}function requirePassthrough(){if(hasRequiredPassthrough)return passthrough;hasRequiredPassthrough=1;const{ObjectSetPrototypeOf:e}=requirePrimordials();passthrough=r;const t=requireTransform();function r(e){if(!(this instanceof r))return new r(e);t.call(this,e)}return e(r.prototype,t.prototype),e(r,t),r.prototype._transform=function(e,t,r){r(null,e)},passthrough}function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;const e=requireDist(),{ArrayIsArray:t,Promise:r,SymbolAsyncIterator:n,SymbolDispose:i}=requirePrimordials(),o=requireEndOfStream(),{once:a}=requireUtil(),s=requireDestroy(),l=requireDuplex(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:h,ERR_MISSING_ARGS:d,ERR_STREAM_DESTROYED:p,ERR_STREAM_PREMATURE_CLOSE:f},AbortError:m}=requireErrors$1(),{validateFunction:g,validateAbortSignal:y}=requireValidators(),{isIterable:_,isReadable:v,isReadableNodeStream:b,isNodeStream:w,isTransformStream:x,isWebStream:S,isReadableStream:E,isReadableFinished:T}=requireUtils$1(),A=globalThis.AbortController||requireBrowser$2().AbortController;let C,I,k;function P(e,t,r){let n=!1;e.on("close",(()=>{n=!0}));return{destroy:t=>{n||(n=!0,s.destroyer(e,t||new p("pipe")))},cleanup:o(e,{readable:t,writable:r},(e=>{n=!e}))}}function M(e){if(_(e))return e;if(b(e))return async function*(e){I||(I=requireReadable());yield*I.prototype[n].call(e)}(e);throw new u("val",["Readable","Iterable","AsyncIterable"],e)}async function R(e,t,n,{end:i}){let a,s=null;const l=e=>{if(e&&(a=e),s){const e=s;s=null,e()}},u=()=>new r(((e,t)=>{a?t(a):s=()=>{a?t(a):e()}}));t.on("drain",l);const h=o(t,{readable:!1},l);try{t.writableNeedDrain&&await u();for await(const r of e)t.write(r)||await u();i&&(t.end(),await u()),n()}catch(d){n(a!==d?c(a,d):d)}finally{h(),t.off("drain",l)}}async function D(e,t,r,{end:n}){x(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch((()=>{}));await i.ready,n&&await i.close(),r()}catch(o){try{await i.abort(o),r(o)}catch(a){r(a)}}}function O(r,n,o){if(1===r.length&&t(r[0])&&(r=r[0]),r.length<2)throw new d("streams");const a=new A,s=a.signal,c=null==o?void 0:o.signal,p=[];function f(){F(new m)}let g,T,I;y(c,"options.signal"),k=k||requireUtil().addAbortListener,c&&(g=k(c,f));const O=[];let B,$=0;function z(e){F(e,0==--$)}function F(t,r){var o;if(!t||T&&"ERR_STREAM_PREMATURE_CLOSE"!==T.code||(T=t),T||r){for(;O.length;)O.shift()(T);null===(o=g)||void 0===o||o[i](),a.abort(),r&&(T||p.forEach((e=>e())),e.nextTick(n,T,I))}}for(let t=0;t<r.length;t++){const n=r[t],i=t<r.length-1,a=t>0,c=i||!1!==(null==o?void 0:o.end),d=t===r.length-1;if(w(n)){let e=function(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&z(e)};if(c){const{destroy:e,cleanup:t}=P(n,i,a);O.push(e),v(n)&&d&&p.push(t)}n.on("error",e),v(n)&&d&&p.push((()=>{n.removeListener("error",e)}))}if(0===t)if("function"==typeof n){if(B=n({signal:s}),!_(B))throw new h("Iterable, AsyncIterable or Stream","source",B)}else B=_(n)||b(n)||x(n)?n:l.from(n);else if("function"==typeof n){var q;if(x(B))B=M(null===(q=B)||void 0===q?void 0:q.readable);else B=M(B);if(B=n(B,{signal:s}),i){if(!_(B,!0))throw new h("AsyncIterable",`transform[${t-1}]`,B)}else{var N;C||(C=requirePassthrough());const t=new C({objectMode:!0}),r=null===(N=B)||void 0===N?void 0:N.then;if("function"==typeof r)$++,r.call(B,(r=>{I=r,null!=r&&t.write(r),c&&t.end(),e.nextTick(z)}),(r=>{t.destroy(r),e.nextTick(z,r)}));else if(_(B,!0))$++,R(B,t,z,{end:c});else{if(!E(B)&&!x(B))throw new h("AsyncIterable or Promise","destination",B);{const e=B.readable||B;$++,R(e,t,z,{end:c})}}B=t;const{destroy:n,cleanup:i}=P(B,!1,!0);O.push(n),d&&p.push(i)}}else if(w(n)){if(b(B)){$+=2;const e=L(B,n,z,{end:c});v(n)&&d&&p.push(e)}else if(x(B)||E(B)){const e=B.readable||B;$++,R(e,n,z,{end:c})}else{if(!_(B))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],B);$++,R(B,n,z,{end:c})}B=n}else if(S(n)){if(b(B))$++,D(M(B),n,z,{end:c});else if(E(B)||_(B))$++,D(B,n,z,{end:c});else{if(!x(B))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],B);$++,D(B.readable,n,z,{end:c})}B=n}else B=l.from(n)}return(null!=s&&s.aborted||null!=c&&c.aborted)&&e.nextTick(f),B}function L(t,r,n,{end:i}){let a=!1;if(r.on("close",(()=>{a||n(new f)})),t.pipe(r,{end:!1}),i){let n=function(){a=!0,r.end()};T(t)?e.nextTick(n):t.once("end",n)}else n();return o(t,{readable:!0,writable:!1},(e=>{const r=t._readableState;e&&"ERR_STREAM_PREMATURE_CLOSE"===e.code&&r&&r.ended&&!r.errored&&!r.errorEmitted?t.once("end",n).once("error",n):n(e)})),o(r,{readable:!1,writable:!0},n)}return pipeline_1={pipelineImpl:O,pipeline:function(...e){return O(e,a(function(e){return g(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}}function requireCompose(){if(hasRequiredCompose)return compose;hasRequiredCompose=1;const{pipeline:e}=requirePipeline(),t=requireDuplex(),{destroyer:r}=requireDestroy(),{isNodeStream:n,isReadable:i,isWritable:o,isWebStream:a,isTransformStream:s,isWritableStream:l,isReadableStream:c}=requireUtils$1(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:h,ERR_MISSING_ARGS:d}}=requireErrors$1(),p=requireEndOfStream();return compose=function(...f){if(0===f.length)throw new d("streams");if(1===f.length)return t.from(f[0]);const m=[...f];if("function"==typeof f[0]&&(f[0]=t.from(f[0])),"function"==typeof f[f.length-1]){const e=f.length-1;f[e]=t.from(f[e])}for(let e=0;e<f.length;++e)if(n(f[e])||a(f[e])){if(e<f.length-1&&!(i(f[e])||c(f[e])||s(f[e])))throw new h(`streams[${e}]`,m[e],"must be readable");if(e>0&&!(o(f[e])||l(f[e])||s(f[e])))throw new h(`streams[${e}]`,m[e],"must be writable")}let g,y,_,v,b;const w=f[0],x=e(f,(function(e){const t=v;v=null,t?t(e):e?b.destroy(e):E||S||b.destroy()})),S=!!(o(w)||l(w)||s(w)),E=!!(i(x)||c(x)||s(x));if(b=new t({writableObjectMode:!(null==w||!w.writableObjectMode),readableObjectMode:!(null==x||!x.readableObjectMode),writable:S,readable:E}),S){if(n(w))b._write=function(e,t,r){w.write(e,t)?r():g=r},b._final=function(e){w.end(),y=e},w.on("drain",(function(){if(g){const e=g;g=null,e()}}));else if(a(w)){const e=(s(w)?w.writable:w).getWriter();b._write=async function(t,r,n){try{await e.ready,e.write(t).catch((()=>{})),n()}catch(i){n(i)}},b._final=async function(t){try{await e.ready,e.close().catch((()=>{})),y=t}catch(r){t(r)}}}const e=s(x)?x.readable:x;p(e,(()=>{if(y){const e=y;y=null,e()}}))}if(E)if(n(x))x.on("readable",(function(){if(_){const e=_;_=null,e()}})),x.on("end",(function(){b.push(null)})),b._read=function(){for(;;){const e=x.read();if(null===e)return void(_=b._read);if(!b.push(e))return}};else if(a(x)){const e=(s(x)?x.readable:x).getReader();b._read=async function(){for(;;)try{const{value:t,done:r}=await e.read();if(!b.push(t))return;if(r)return void b.push(null)}catch{return}}}return b._destroy=function(e,t){e||null===v||(e=new u),_=null,g=null,y=null,null===v?t(e):(v=t,n(x)&&r(x,e))},b}}function requireOperators(){if(hasRequiredOperators)return operators;hasRequiredOperators=1;const e=globalThis.AbortController||requireBrowser$2().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:r,ERR_MISSING_ARGS:n,ERR_OUT_OF_RANGE:i},AbortError:o}=requireErrors$1(),{validateAbortSignal:a,validateInteger:s,validateObject:l}=requireValidators(),c=requirePrimordials().Symbol("kWeak"),u=requirePrimordials().Symbol("kResistStopPropagation"),{finished:h}=requireEndOfStream(),d=requireCompose(),{addAbortSignalNoValidate:p}=requireAddAbortSignal(),{isWritable:f,isNodeStream:m}=requireUtils$1(),{deprecate:g}=requireUtil(),{ArrayPrototypePush:y,Boolean:_,MathFloor:v,Number:b,NumberIsNaN:w,Promise:x,PromiseReject:S,PromiseResolve:E,PromisePrototypeThen:T,Symbol:A}=requirePrimordials(),C=A("kEmpty"),I=A("kEof");function k(e,t){if("function"!=typeof e)throw new r("fn",["Function","AsyncFunction"],e);null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&a(t.signal,"options.signal");let n=1;null!=(null==t?void 0:t.concurrency)&&(n=v(t.concurrency));let i=n-1;return null!=(null==t?void 0:t.highWaterMark)&&(i=v(t.highWaterMark)),s(n,"options.concurrency",1),s(i,"options.highWaterMark",0),i+=n,async function*(){const r=requireUtil().AbortSignalAny([null==t?void 0:t.signal].filter(_)),a=this,s=[],l={signal:r};let c,u,h=!1,d=0;function p(){h=!0,f()}function f(){d-=1,m()}function m(){u&&!h&&d<n&&s.length<i&&(u(),u=null)}!async function(){try{for await(let m of a){if(h)return;if(r.aborted)throw new o;try{if(m=e(m,l),m===C)continue;m=E(m)}catch(t){m=S(t)}d+=1,T(m,f,p),s.push(m),c&&(c(),c=null),!h&&(s.length>=i||d>=n)&&await new x((e=>{u=e}))}s.push(I)}catch(t){const e=S(t);T(e,f,p),s.push(e)}finally{h=!0,c&&(c(),c=null)}}();try{for(;;){for(;s.length>0;){const e=await s[0];if(e===I)return;if(r.aborted)throw new o;e!==C&&(yield e),s.shift(),m()}await new x((e=>{c=e}))}}finally{h=!0,u&&(u(),u=null)}}.call(this)}async function P(e,t=void 0){for await(const r of M.call(this,e,t))return!0;return!1}function M(e,t){if("function"!=typeof e)throw new r("fn",["Function","AsyncFunction"],e);return k.call(this,(async function(t,r){return await e(t,r)?t:C}),t)}class R extends n{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function D(e){if(e=b(e),w(e))return 0;if(e<0)throw new i("number",">= 0",e);return e}return operators.streamReturningOperators={asIndexedPairs:g((function(e=void 0){return null!=e&&l(e,"options"),null!=(null==e?void 0:e.signal)&&a(e.signal,"options.signal"),async function*(){let t=0;for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new o({cause:e.signal.reason});yield[t++,n]}}.call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&a(t.signal,"options.signal"),e=D(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new o;for await(const i of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new o;e--<=0&&(yield i)}}.call(this)},filter:M,flatMap:function(e,t){const r=k.call(this,e,t);return async function*(){for await(const e of r)yield*e}.call(this)},map:k,take:function(e,t=void 0){return null!=t&&l(t,"options"),null!=(null==t?void 0:t.signal)&&a(t.signal,"options.signal"),e=D(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new o;for await(const i of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new o;if(e-- >0&&(yield i),e<=0)return}}.call(this)},compose:function(e,r){if(null!=r&&l(r,"options"),null!=(null==r?void 0:r.signal)&&a(r.signal,"options.signal"),m(e)&&!f(e))throw new t("stream",e,"must be writable");const n=d(this,e);return null!=r&&r.signal&&p(r.signal,n),n}},operators.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new r("fn",["Function","AsyncFunction"],e);return!(await P.call(this,(async(...t)=>!(await e(...t))),t))},forEach:async function(e,t){if("function"!=typeof e)throw new r("fn",["Function","AsyncFunction"],e);for await(const r of k.call(this,(async function(t,r){return await e(t,r),C}),t));},reduce:async function(t,n,i){var s;if("function"!=typeof t)throw new r("reducer",["Function","AsyncFunction"],t);null!=i&&l(i,"options"),null!=(null==i?void 0:i.signal)&&a(i.signal,"options.signal");let d=arguments.length>1;if(null!=i&&null!==(s=i.signal)&&void 0!==s&&s.aborted){const e=new o(void 0,{cause:i.signal.reason});throw this.once("error",(()=>{})),await h(this.destroy(e)),e}const p=new e,f=p.signal;if(null!=i&&i.signal){const e={once:!0,[c]:this,[u]:!0};i.signal.addEventListener("abort",(()=>p.abort()),e)}let m=!1;try{for await(const e of this){var g;if(m=!0,null!=i&&null!==(g=i.signal)&&void 0!==g&&g.aborted)throw new o;d?n=await t(n,e,{signal:f}):(n=e,d=!0)}if(!m&&!d)throw new R}finally{p.abort()}return n},toArray:async function(e){null!=e&&l(e,"options"),null!=(null==e?void 0:e.signal)&&a(e.signal,"options.signal");const t=[];for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new o(void 0,{cause:e.signal.reason});y(t,n)}return t},some:P,find:async function(e,t){for await(const r of M.call(this,e,t))return r}},operators}function requirePromises(){if(hasRequiredPromises)return promises$1;hasRequiredPromises=1;const{ArrayPrototypePop:e,Promise:t}=requirePrimordials(),{isIterable:r,isNodeStream:n,isWebStream:i}=requireUtils$1(),{pipelineImpl:o}=requirePipeline(),{finished:a}=requireEndOfStream();return requireStream(),promises$1={finished:a,pipeline:function(...a){return new t(((t,s)=>{let l,c;const u=a[a.length-1];if(u&&"object"==typeof u&&!n(u)&&!r(u)&&!i(u)){const t=e(a);l=t.signal,c=t.end}o(a,((e,r)=>{e?s(e):t(r)}),{signal:l,end:c})}))}}}function requireStream(){if(hasRequiredStream)return stream.exports;hasRequiredStream=1;const{Buffer:e}=requireDist$1(),{ObjectDefineProperty:t,ObjectKeys:r,ReflectApply:n}=requirePrimordials(),{promisify:{custom:i}}=requireUtil(),{streamReturningOperators:o,promiseReturningOperators:a}=requireOperators(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:s}}=requireErrors$1(),l=requireCompose(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=requireState(),{pipeline:h}=requirePipeline(),{destroyer:d}=requireDestroy(),p=requireEndOfStream(),f=requirePromises(),m=requireUtils$1(),g=stream.exports=requireLegacy().Stream;g.isDestroyed=m.isDestroyed,g.isDisturbed=m.isDisturbed,g.isErrored=m.isErrored,g.isReadable=m.isReadable,g.isWritable=m.isWritable,g.Readable=requireReadable();for(const _ of r(o)){let e=function(...e){if(new.target)throw s();return g.Readable.from(n(r,this,e))};const r=o[_];t(e,"name",{__proto__:null,value:r.name}),t(e,"length",{__proto__:null,value:r.length}),t(g.Readable.prototype,_,{__proto__:null,value:e,enumerable:!1,configurable:!0,writable:!0})}for(const _ of r(a)){let e=function(...e){if(new.target)throw s();return n(r,this,e)};const r=a[_];t(e,"name",{__proto__:null,value:r.name}),t(e,"length",{__proto__:null,value:r.length}),t(g.Readable.prototype,_,{__proto__:null,value:e,enumerable:!1,configurable:!0,writable:!0})}g.Writable=requireWritable(),g.Duplex=requireDuplex(),g.Transform=requireTransform(),g.PassThrough=requirePassthrough(),g.pipeline=h;const{addAbortSignal:y}=requireAddAbortSignal();return g.addAbortSignal=y,g.finished=p,g.destroy=d,g.compose=l,g.setDefaultHighWaterMark=c,g.getDefaultHighWaterMark=u,t(g,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>f}),t(h,i,{__proto__:null,enumerable:!0,get:()=>f.pipeline}),t(p,i,{__proto__:null,enumerable:!0,get:()=>f.finished}),g.Stream=g,g._isUint8Array=function(e){return e instanceof Uint8Array},g._uint8ArrayToBuffer=function(t){return e.from(t.buffer,t.byteOffset,t.byteLength)},stream.exports}function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(e){const t=requireStream(),r=requirePromises(),n=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=n,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get:()=>r}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(browser$2)),browser$2.exports}var browserExports=requireBrowser$1();class ReadStream extends browserExports.Readable{pending=!0;_path="<unknown>";_bytesRead=0;reader;ready;constructor(e={},t){super({...e,encoding:e.encoding??void 0}),this.ready=Promise.resolve(t).then((t=>{this._path=t.vfs.path;const r=t.readableWebStream({start:e.start,end:e.end});this.reader=r.getReader(),this.pending=!1})).catch((e=>{this.destroy(e)}))}async _read(){try{if(await this.ready,!this.reader)return;const{done:e,value:t}=await this.reader.read();if(e)return void this.push(null);this._bytesRead+=t.byteLength,this.push(t)}catch(e){this.destroy(new Exception(Errno.EIO,e.toString()))}}close(e=()=>null){try{this.destroy(),this.emit("close"),e(null)}catch(t){e(new Exception(Errno.EIO,t.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(e){return super.wrap(e),this}}class WriteStream extends browserExports.Writable{pending=!0;_path="<unknown>";_bytesWritten=0;writer;ready;constructor(e={},t){super(e),this.ready=Promise.resolve(t).then((t=>{this._path=t.vfs.path;const r=t.writableWebStream({start:e.start});this.writer=r.getWriter(),this.pending=!1})).catch((e=>this.destroy(e)))}async _write(e,t,r){if(await this.ready,!this.writer)return r(warn(UV("EAGAIN","write",this._path)));if("buffer"!=t)return r(warn(UV("ENOTSUP","write",this._path)));const n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);try{await this.writer.write(n),this._bytesWritten+=e.byteLength,r()}catch(i){r(new Exception(Errno.EIO,i.toString()))}}async _final(e){if(await this.ready,!this.writer)return e();try{await this.writer.close(),e()}catch(t){e(new Exception(Errno.EIO,t.toString()))}}close(e=()=>null){try{this.destroy(),this.emit("close"),e(null)}catch(t){e(new Exception(Errno.EIO,t.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var __addDisposableResource=function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t},__disposeResources=function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}var n,i=0;return function e(){for(;n=t.stack.pop();)try{if(!n.async&&1===i)return i=0,t.stack.push(n),Promise.resolve().then(e);if(n.dispose){var o=n.dispose.call(n.value);if(n.async)return i|=2,Promise.resolve(o).then(e,(function(t){return r(t),e()}))}else i|=1}catch(a){r(a)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n});class FileHandle{context;fd;vfs;constructor(e,t){this.context=e,this.fd=t,this.vfs=fromFD(e,t)}_emitChange(){emitChange(this.context,"change",this.vfs.path)}async chown(e,t){await this.vfs.chown(e,t),this._emitChange()}async chmod(e){const t=normalizeMode(e,-1);if(t<0)throw UV("EINVAL","chmod",this.vfs.path);await this.vfs.chmod(t),this._emitChange()}datasync(){return this.sync()}async sync(){await this.vfs.sync()}async truncate(e=0){await this.vfs.truncate(e),this._emitChange()}async utimes(e,t){e=normalizeTime(e),t=normalizeTime(t),await this.vfs.utimes(e,t),this._emitChange()}async appendFile(e,t={}){const r=normalizeOptions(t,"utf8","a",420);if(!(parse$1(r.flag)&O_APPEND))throw UV("EBADF","write",this.vfs.path);const n="string"==typeof e?Buffer$1.from(e,r.encoding):e;await this.vfs.write(n,0,n.length),this._emitChange()}async read(e,t,r,n){if("object"==typeof t&&null!=t&&(n=t.position,r=t.length,t=t.offset),ArrayBuffer.isView(e)||"object"!=typeof e||(n=e.position,r=e.length,t=e.offset,e=e.buffer),n&&n>Number.MAX_SAFE_INTEGER)throw UV("EINVAL");"bigint"==typeof n&&(n=Number(n)),n=Number.isSafeInteger(n)?n:this.vfs.position,e||=new Uint8Array(this.vfs.inode.size),t??=0;return{bytesRead:await this.vfs.read(e,t,r??e.byteLength-t,n),buffer:e}}async readFile(e){const t=normalizeOptions(e,null,"r",292);if(parse$1(t.flag)&O_WRONLY)throw UV("EBADF","read",this.vfs.path);const{size:r}=await this.stat(),n=new Uint8Array(r);await this.vfs.read(n,0,r,0);const i=Buffer$1.from(n);return t.encoding?i.toString(t.encoding):i}readableWebStream(e={}){if(this.vfs.isClosed)throw UV("EBADF","readableWebStream",this.vfs.path);return this.vfs.fs.streamRead(this.vfs.internalPath,e)}writableWebStream(e={}){if(this.vfs.isClosed)throw UV("EBADF","writableWebStream",this.vfs.path);if(this.vfs.inode.flags&InodeFlags.Immutable)throw UV("EPERM","writableWebStream",this.vfs.path);return this.vfs.fs.streamWrite(this.vfs.internalPath,e)}readLines(e){if(this.vfs.isClosed||this.vfs.flag&O_WRONLY)throw UV("EBADF","read",this.vfs.path);return createInterface({input:this.createReadStream(e),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(e){if(this.vfs.isClosed)throw UV("EBADF","stat",this.vfs.path);if(!hasAccess(this.context,this.vfs.inode,R_OK))throw UV("EACCES","stat",this.vfs.path);return e?.bigint?new BigIntStats(this.vfs.inode):new Stats(this.vfs.inode)}async write(e,t,r,n){let i,o,a;"object"==typeof t&&null!=t&&(r=t.length,n=t.position,t=t.offset),"string"==typeof e?(n="number"==typeof t?t:null,o=0,i=Buffer$1.from(e,"string"==typeof r?r:"utf8"),a=i.length):(i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o=t??0,a="number"==typeof r?r:i.byteLength,n="number"==typeof n?n:null),n??=this.vfs.position;const s=await this.vfs.write(i,o,a,n);return this._emitChange(),{buffer:e,bytesWritten:s}}async writeFile(e,t={}){const r=normalizeOptions(t,"utf8","w",420),n=parse$1(r.flag);if(!(n&O_WRONLY||n&O_RDWR))throw UV("EBADF","writeFile",this.vfs.path);const i="string"==typeof e?Buffer$1.from(e,r.encoding):e;await this.vfs.write(i,0,i.length,0),this._emitChange()}async close(){await this.vfs.close(),deleteFD(this.context,this.fd)}async writev(e,t){"number"==typeof t&&(this.vfs.position=t);let r=0;for(const n of e)r+=(await this.write(n)).bytesWritten;return{bytesWritten:r,buffers:e}}async readv(e,t){"number"==typeof t&&(this.vfs.position=t);let r=0;for(const n of e)r+=(await this.read(n)).bytesRead;return{bytesRead:r,buffers:e}}createReadStream(e={}){if(this.vfs.isClosed||this.vfs.flag&O_WRONLY)throw UV("EBADF","createReadStream",this.vfs.path);return new ReadStream(e,this)}createWriteStream(e={}){if(this.vfs.isClosed)throw UV("EBADF","createWriteStream",this.vfs.path);if(this.vfs.inode.flags&InodeFlags.Immutable)throw UV("EPERM","createWriteStream",this.vfs.path);if(this.vfs.fs.attributes.has("readonly"))throw UV("EROFS","createWriteStream",this.vfs.path);return new WriteStream(e,this)}}async function rename$1(e,t){await rename$2.call(this,e,t)}async function exists$1(e){e=normalizePath(e);try{const{fs:t,path:r}=await resolve(this,e);return await t.exists(r)}catch(t){if(t instanceof Exception&&"ENOENT"==t.code)return!1;throw t}}async function stat$1(e,t){e=normalizePath(e);const{fs:r,path:n}=await resolve(this,e),i={syscall:"stat",path:e},o=await r.stat(n).catch(rethrow(i));if(!hasAccess(this,o,R_OK))throw UV("EACCES",i);return t?.bigint?new BigIntStats(o):new Stats(o)}async function lstat$1(e,t){const r={syscall:"lstat",path:e=normalizePath(e)},{base:n,dir:i}=parse$2(e),{fs:o,path:a}=await resolve(this,i),s=await o.stat(n?join(a,n):a).catch(rethrow(r));if(!hasAccess(this,s,R_OK))throw UV("EACCES",r);return t?.bigint?new BigIntStats(s):new Stats(s)}async function truncate$1(e,t=0){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource(r,await open$1.call(this,e,"r+"),!0);await n.truncate(t)}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources(r);e&&await e}}async function unlink$1(e){e=normalizePath(e);const{fs:t,path:r}=resolveMount(e,this),n={syscall:"unlink",path:e};if(!hasAccess(this,await t.stat(r).catch(rethrow(n)),W_OK))throw UV("EACCES",n);await t.unlink(r).catch(rethrow(n)),emitChange(this,"rename",e.toString())}async function open$1(e,t="r",r=420){const n=await open$2(this,e,{flag:t,mode:r});return new FileHandle(this,toFD(n))}async function readFile$1(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=normalizeOptions(t,null,"r",292),i=__addDisposableResource(r,"object"==typeof e&&"fd"in e?e:await open$1.call(this,e,n.flag,n.mode),!0);return await i.readFile(n)}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources(r);e&&await e}}async function writeFile$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=normalizeOptions(r,"utf8","w+",420),o=__addDisposableResource(n,e instanceof FileHandle?e:await open$1.call(this,e.toString(),i.flag,i.mode),!0),a="string"==typeof t?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if("string"!=typeof a&&!(a instanceof Uint8Array))throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t);await o.writeFile(a,i)}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function appendFile$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=normalizeOptions(r,"utf8","a",420),o=parse$1(i.flag),a={syscall:"write",path:e instanceof FileHandle?e.vfs.path:e.toString()};if(!(o&O_APPEND))throw UV("EBADF",a);const s="string"==typeof t?Buffer$1.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength),l=__addDisposableResource(n,"object"==typeof e&&"fd"in e?e:await open$1.call(this,e,i.flag,i.mode),!0);await l.appendFile(s,i)}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function rmdir$1(e){e=normalizePath(e);const{fs:t,path:r}=await resolve(this,e),n={syscall:"rmdir",path:e},i=await t.stat(r).catch(rethrow(n));if(!i)throw UV("ENOENT",n);if(!isDirectory(i))throw UV("ENOTDIR",n);if(!hasAccess(this,i,W_OK))throw UV("EACCES",n);await t.rmdir(r).catch(rethrow(n)),emitChange(this,"rename",e.toString())}async function mkdir$1(e,t){t="object"==typeof t?t:{mode:t};const r=normalizeMode(t?.mode,511);return await mkdir$2.call(this,e,{...t,mode:r})}async function readdir$1(e,t){e=normalizePath(e);const r="object"==typeof t&&null!=t?t:{encoding:t,withFileTypes:!1,recursive:!1},n=await readdir$2.call(this,e,r),i=[];for(const o of n)r.withFileTypes?i.push(Dirent.from(o,r.encoding)):"buffer"==r.encoding?i.push(Buffer$1.from(o.path)):i.push(o.path);return i}async function link$2(e,t){return await link$3.call(this,e,t)}async function symlink$1(e,t,r="file"){const n={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(r))throw new TypeError("Invalid symlink type: "+r);if(t=normalizePath(t),await exists$1.call(this,t))throw UV("EEXIST","symlink",t);const i=__addDisposableResource(n,await open$2(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0),o=encodeUTF8(normalizePath(e,!0));await i.write(o,0,o.length,0),await i.chmod(S_IFLNK)}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function readlink$1(e,t){e=normalizePath(e);const r=Buffer$1.from(await readlink$2.call(this,e),"utf-8"),n="object"==typeof t?t?.encoding:t;return"buffer"==n?r:r.toString(n??"utf-8")}async function chown$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource(n,await open$1.call(this,e,"r+"),!0);await i.chown(t,r)}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function lchown$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource(n,await open$2(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await i.chown(t,r)}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function chmod$1(e,t){const r={stack:[],error:void 0,hasError:!1};try{const n=__addDisposableResource(r,await open$1.call(this,e,"r+"),!0);await n.chmod(t)}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources(r);e&&await e}}async function lchmod$1(e,t){const r={stack:[],error:void 0,hasError:!1};try{t=normalizeMode(t);const n=__addDisposableResource(r,await open$2(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await n.chmod(t)}catch(n){r.error=n,r.hasError=!0}finally{const e=__disposeResources(r);e&&await e}}async function utimes$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource(n,await open$2(this,e,{flag:"r+",allowDirectory:!0}),!0);await i.utimes(normalizeTime(t),normalizeTime(r))}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function lutimes$1(e,t,r){const n={stack:[],error:void 0,hasError:!1};try{const i=__addDisposableResource(n,await open$2(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await i.utimes(normalizeTime(t),normalizeTime(r))}catch(i){n.error=i,n.hasError=!0}finally{const e=__disposeResources(n);e&&await e}}async function realpath$1(e,t){const r="string"==typeof t?t:t?.encoding??"utf8";e=normalizePath(e);const{fullPath:n}=await resolve(this,e);if("utf8"==r||"utf-8"==r)return n;const i=Buffer$1.from(n,"utf-8");return"buffer"==r?i:i.toString(r)}function watch$1(e,t={}){const r=new FSWatcher(this,e.toString(),"string"!=typeof t?t:{encoding:t}),n=[];let i=!1;function o(){i=!0,r.close();for(const e of n)e({value:null,done:i});return n.length=0,Promise.resolve({value:void 0,done:!0})}return r.on("change",((e,t)=>{n.shift()?.({value:{eventType:e,filename:t},done:!1})})),{async next(){if(i)return Promise.resolve({value:void 0,done:i});const{promise:e,resolve:t}=Promise.withResolvers();return n.push(t),e},return:o,throw:o,async[Symbol.asyncDispose](){await o()},[Symbol.asyncIterator](){return this}}}async function access$1(e,t=F_OK){if(!(await stat$1.call(this,e)).hasAccess(t,this))throw UV("EACCES","access",e.toString())}async function rm$1(e,t){e=normalizePath(e);const r=await lstat$1.call(this,e).catch((e=>{if("ENOENT"!=e.code||!t?.force)throw e}));if(r)switch(r.mode&S_IFMT){case S_IFDIR:if(t?.recursive)for(const r of await readdir$1.call(this,e))await rm$1.call(this,join(e,r),t);await rmdir$1.call(this,e);break;case S_IFREG:case S_IFLNK:case S_IFBLK:case S_IFCHR:await unlink$1.call(this,e);break;default:throw UV("ENOSYS","rm",e)}}async function mkdtemp$1(e,t){const r="object"==typeof t?t?.encoding:t||"utf8",n=_tempDirName(e);return await mkdir$1.call(this,n),"buffer"==r?Buffer$1.from(n):n}async function mkdtempDisposable(e,t){const r=_tempDirName(e);await mkdir$1.call(this,r);const n=()=>rm$1(r,{recursive:!0,force:!0});return{path:r,remove:n,[Symbol.asyncDispose]:n}}async function copyFile$1(e,t,r){if(e=normalizePath(e),t=normalizePath(t),r&&r&COPYFILE_EXCL&&await exists$1.call(this,t))throw UV("EEXIST","copyFile",t);await writeFile$1.call(this,t,await readFile$1.call(this,e)),emitChange(this,"rename",t.toString())}function opendir$1(e,t){return e=normalizePath(e),Promise.resolve(new Dir(e,this))}async function cp$1(e,t,r){e=normalizePath(e),t=normalizePath(t);const n=await lstat$1.call(this,e);if(r?.errorOnExist&&await exists$1.call(this,t))throw UV("EEXIST","cp",t);switch(n.mode&S_IFMT){case S_IFDIR:{if(!r?.recursive)throw UV("EISDIR","cp",e);const[n]=await Promise.all([readdir$1.call(this,e,{withFileTypes:!0}),mkdir$1.call(this,t,{recursive:!0})]),i=async n=>{r.filter&&!r.filter(join(e,n.name),join(t,n.name))||await cp$1.call(this,join(e,n.name),join(t,n.name),r)};await Promise.all(n.map(i));break}case S_IFREG:case S_IFLNK:await copyFile$1.call(this,e,t);break;default:throw UV("ENOSYS","cp",e)}r?.preserveTimestamps&&await utimes$1.call(this,t,n.atime,n.mtime)}async function statfs$1(e,t){e=normalizePath(e);const{fs:r}=resolveMount(e,this);return Promise.resolve(_statfs(r,t?.bigint))}function glob$1(e,t){e=Array.isArray(e)?e:[e];const{cwd:r="/",withFileTypes:n=!1,exclude:i=()=>!1}=t||{},o=e.map(globToRegex);return async function*e(t){const r=await readdir$1(t,{withFileTypes:n,encoding:"utf8"});for(const a of r){const r=n?join(a.parentPath,a.name):t+"/"+a;("function"!=typeof i?i.some((e=>matchesGlob(e,r))):i(n?a:r))||((await stat$1(r)).isDirectory()&&o.some((e=>e.source.includes(".*")))&&(yield*e(r)),o.some((e=>e.test(r.replace(/^\/+/g,""))))&&(yield n?a:r.replace(/^\/+/g,"")))}}(r)}const promises=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:FileHandle,access:access$1,appendFile:appendFile$1,chmod:chmod$1,chown:chown$1,constants:constants$1,copyFile:copyFile$1,cp:cp$1,exists:exists$1,glob:glob$1,lchmod:lchmod$1,lchown:lchown$1,link:link$2,lstat:lstat$1,lutimes:lutimes$1,mkdir:mkdir$1,mkdtemp:mkdtemp$1,mkdtempDisposable:mkdtempDisposable,open:open$1,opendir:opendir$1,readFile:readFile$1,readdir:readdir$1,readlink:readlink$1,realpath:realpath$1,rename:rename$1,rm:rm$1,rmdir:rmdir$1,stat:stat$1,statfs:statfs$1,symlink:symlink$1,truncate:truncate$1,unlink:unlink$1,utimes:utimes$1,watch:watch$1,writeFile:writeFile$1},Symbol.toStringTag,{value:"Module"})),journalOperations=["delete"];Math.max(...journalOperations.map((e=>e.length))),"function"==typeof SuppressedError&&SuppressedError;const crc32cTable=new Uint32Array(256);for(let I=0;I<256;I++){let e=I;for(let t=0;t<8;t++)e=1&e?2197175160^e>>>1:e>>>1;crc32cTable[I]=e}function crc32c(e){let t=4294967295;for(let r=0;r<e.length;r++)t=t>>>8^crc32cTable[255&(t^e[r])];return(4294967295^t)>>>0}var __esDecorate$1=function(e,t,r,n,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var g=(0,r[p])("accessor"===l?{get:h.get,set:h.set}:h[c],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(h.get=s),(s=a(g.set))&&(h.set=s),(s=a(g.init))&&i.unshift(s)}else(s=a(g))&&("field"===l?i.unshift(s):h[c]=s)}u&&Object.defineProperty(u,n.name,h),d=!0},__runInitializers$1=function(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0};"function"==typeof SuppressedError&&SuppressedError;const hex=e=>"0x"+e.toString(16).padStart(8,"0"),{format:format$1}=new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:2,unit:"byte",unitDisplay:"narrow"});let MetadataEntry=(()=>{var e,t,r,n,i,o,a,s,l;let c,u,h,d,p,f,m=[struct$1.packed("MetadataEntry")],g=[],y=$from(BufferView),_=[],v=[],b=[],w=[],x=[],S=[],E=[],T=[];return i=class extends y{constructor(){super(...arguments),__privateAdd(this,e,__runInitializers$1(this,_,void 0)),__privateAdd(this,t,(__runInitializers$1(this,v),__runInitializers$1(this,b,void 0))),__privateAdd(this,r,(__runInitializers$1(this,w),__runInitializers$1(this,x,void 0))),__privateAdd(this,n,(__runInitializers$1(this,S),__runInitializers$1(this,E,void 0))),__runInitializers$1(this,T)}get id(){return __privateGet(this,e)}set id(t){__privateSet(this,e,t)}get offset_(){return __privateGet(this,t)}set offset_(e){__privateSet(this,t,e)}get offset(){return __privateGet(this,r)}set offset(e){__privateSet(this,r,e)}get size(){return __privateGet(this,n)}set size(e){__privateSet(this,n,e)}toString(){return`<MetadataEntry @ ${hex(this.byteOffset)}>`}},e=new WeakMap,t=new WeakMap,r=new WeakMap,n=new WeakMap,u=i,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(y[Symbol.metadata]??null):void 0;h=[(o=types$1).uint32.bind(o)],d=[(a=types$1).uint32.bind(a)],p=[(s=types$1).uint32.bind(s)],f=[(l=types$1).uint32.bind(l)],__esDecorate$1(i,null,h,{kind:"accessor",name:"id",static:!1,private:!1,access:{has:e=>"id"in e,get:e=>e.id,set:(e,t)=>{e.id=t}},metadata:e},_,v),__esDecorate$1(i,null,d,{kind:"accessor",name:"offset_",static:!1,private:!1,access:{has:e=>"offset_"in e,get:e=>e.offset_,set:(e,t)=>{e.offset_=t}},metadata:e},b,w),__esDecorate$1(i,null,p,{kind:"accessor",name:"offset",static:!1,private:!1,access:{has:e=>"offset"in e,get:e=>e.offset,set:(e,t)=>{e.offset=t}},metadata:e},x,S),__esDecorate$1(i,null,f,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:e},E,T),__esDecorate$1(null,c={value:u},m,{kind:"class",name:u.name,metadata:e},null,g),u=c.value,e&&Object.defineProperty(u,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers$1(u,g)})(),u})();const entries_per_block=255,max_lock_attempts=5;let MetadataBlock=(()=>{var e,t,r,n,i,o,a,s,l,c;let u,h,d,p,f,m,g,y=[struct$1.packed("MetadataBlock")],_=[],v=$from.typed(Int32Array),b=[],w=[],x=[],S=[],E=[],T=[],A=[],C=[],I=[],k=[];var P=(e=class extends v{constructor(){super(...arguments),__privateAdd(this,t,__runInitializers$1(this,b,void 0)),__privateAdd(this,r,(__runInitializers$1(this,w),__runInitializers$1(this,x,BigInt(Date.now())))),__privateAdd(this,n,(__runInitializers$1(this,S),__runInitializers$1(this,E,void 0))),__publicField(this,"_previous",__runInitializers$1(this,T)),__privateAdd(this,i,__runInitializers$1(this,A,void 0)),__privateAdd(this,o,(__runInitializers$1(this,C),__runInitializers$1(this,I,void 0))),__runInitializers$1(this,k)}get checksum(){return __privateGet(this,t)}set checksum(e){__privateSet(this,t,e)}get timestamp(){return __privateGet(this,r)}set timestamp(e){__privateSet(this,r,e)}get previous_offset(){return __privateGet(this,n)}set previous_offset(e){__privateSet(this,n,e)}get previous(){if(this.previous_offset)return this._previous??=new P(this.buffer,this.previous_offset),this._previous}get items(){return __privateGet(this,i)}set items(e){__privateSet(this,i,e)}toString(e=!1){if(!e)return`<MetadataBlock @ ${hex(this.byteOffset)}>`;let t=[`---- Metadata block at ${hex(this.byteOffset)} ----`,`Checksum: ${hex(this.checksum)}`,`Last updated: ${new Date(Number(this.timestamp)).toLocaleString()}`,`Previous block: ${hex(this.previous_offset)}`,"Entries:"].join("\n");for(const r of this.items)r.offset&&(t+=`\n\t${hex(r.id)}: ${format$1(r.size).padStart(5)} at ${hex(r.offset)}`);return t}get locked(){return __privateGet(this,o)}set locked(e){__privateSet(this,o,e)}waitUnlocked(e=0){if(e>max_lock_attempts)throw crit(withErrno("EBUSY",`sbfs: exceeded max attempts waiting for metadata block at ${hex(this.byteOffset)} to be unlocked`));if(Atomics.load(this,P.lockIndex))switch(Atomics.wait(this,P.lockIndex,1)){case"ok":break;case"not-equal":return e++,err$1(`sbfs: waiting for metadata block at ${hex(this.byteOffset)} to be unlocked (${e}/${max_lock_attempts})`),this.waitUnlocked(e);case"timed-out":throw crit(withErrno("EBUSY",`sbfs: timed out waiting for metadata block at ${hex(this.byteOffset)} to be unlocked`))}}lock(){this.waitUnlocked(),Atomics.store(this,P.lockIndex,1);const e=()=>{Atomics.store(this,P.lockIndex,0),Atomics.notify(this,P.lockIndex,1)};return e[Symbol.dispose]=e,e}},t=new WeakMap,r=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,h=e,(()=>{const t="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;d=[(a=types$1).uint32.bind(a)],p=[(s=types$1).uint64.bind(s)],f=[(l=types$1).uint32.bind(l)],m=[field(array(MetadataEntry,entries_per_block))],g=[(c=types$1).int32.bind(c)],__esDecorate$1(e,null,d,{kind:"accessor",name:"checksum",static:!1,private:!1,access:{has:e=>"checksum"in e,get:e=>e.checksum,set:(e,t)=>{e.checksum=t}},metadata:t},b,w),__esDecorate$1(e,null,p,{kind:"accessor",name:"timestamp",static:!1,private:!1,access:{has:e=>"timestamp"in e,get:e=>e.timestamp,set:(e,t)=>{e.timestamp=t}},metadata:t},x,S),__esDecorate$1(e,null,f,{kind:"accessor",name:"previous_offset",static:!1,private:!1,access:{has:e=>"previous_offset"in e,get:e=>e.previous_offset,set:(e,t)=>{e.previous_offset=t}},metadata:t},E,T),__esDecorate$1(e,null,m,{kind:"accessor",name:"items",static:!1,private:!1,access:{has:e=>"items"in e,get:e=>e.items,set:(e,t)=>{e.items=t}},metadata:t},A,C),__esDecorate$1(e,null,g,{kind:"accessor",name:"locked",static:!1,private:!1,access:{has:e=>"locked"in e,get:e=>e.locked,set:(e,t)=>{e.locked=t}},metadata:t},I,k),__esDecorate$1(null,u={value:h},y,{kind:"class",name:h.name,metadata:t},null,_),P=h=u.value,t&&Object.defineProperty(h,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:t})})(),__publicField(e,"lockIndex",offsetof(P,"locked")/Int32Array.BYTES_PER_ELEMENT),__runInitializers$1(h,_),e);return P=h})();const sb_magic=1651715706,usedBytes=2;function checksum(e){let t=sizeof(e)-4;return e instanceof MetadataBlock&&(t-=Int32Array.BYTES_PER_ELEMENT),crc32c(new Uint8Array(e.buffer,e.byteOffset+4,t))}function _update(e){e instanceof MetadataBlock&&(e.timestamp=BigInt(Date.now())),e.checksum=checksum(e)}(()=>{var e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S;let E,T,A,C,I,k,P,M,R,D,O,L,B,$,z,F=[struct$1.packed("Superblock")],q=[],N=$from.typed(BigUint64Array),j=[],U=[],V=[],G=[],W=[],H=[],Z=[],Y=[],X=[],K=[],Q=[],J=[],ee=[],te=[],re=[],ne=[],ie=[],oe=[],ae=[],se=[],le=[],ce=[],ue=[],he=[],de=[],pe=[];var fe=(p=class extends N{constructor(...p){if(super(...p),__privateAdd(this,e,__runInitializers$1(this,j,void 0)),__privateAdd(this,t,(__runInitializers$1(this,U),__runInitializers$1(this,V,void 0))),__privateAdd(this,r,(__runInitializers$1(this,G),__runInitializers$1(this,W,void 0))),__privateAdd(this,n,(__runInitializers$1(this,H),__runInitializers$1(this,Z,void 0))),__privateAdd(this,i,(__runInitializers$1(this,Y),__runInitializers$1(this,X,void 0))),__privateAdd(this,o,(__runInitializers$1(this,K),__runInitializers$1(this,Q,void 0))),__privateAdd(this,a,(__runInitializers$1(this,J),__runInitializers$1(this,ee,void 0))),__privateAdd(this,s,(__runInitializers$1(this,te),__runInitializers$1(this,re,void 0))),__privateAdd(this,l,(__runInitializers$1(this,ne),__runInitializers$1(this,ie,void 0))),__privateAdd(this,c,(__runInitializers$1(this,oe),__runInitializers$1(this,ae,void 0))),__privateAdd(this,u,(__runInitializers$1(this,se),__runInitializers$1(this,le,void 0))),__publicField(this,"metadata",__runInitializers$1(this,ce)),__privateAdd(this,h,__runInitializers$1(this,ue,void 0)),__privateAdd(this,d,(__runInitializers$1(this,he),__runInitializers$1(this,de,void 0))),__runInitializers$1(this,pe),this.magic!=sb_magic){warn("sbfs: Invalid magic value, assuming this is a fresh super block");const e=new MetadataBlock(this.buffer,sizeof(fe));return Object.assign(this,{metadata:e,metadata_offset:e.byteOffset,used_bytes:BigInt(sizeof(fe)+sizeof(MetadataBlock)),total_bytes:BigInt(this.buffer.byteLength),magic:sb_magic,version:1,inode_format:_inode_version,metadata_block_size:sizeof(MetadataBlock),uuid:encodeUUID(crypto.randomUUID())}),_update(this),void _update(e)}if(this.checksum!==checksum(this))throw crit(withErrno("EIO","sbfs: checksum mismatch for super block"));if(this.metadata=new MetadataBlock(this.buffer,this.metadata_offset),this.metadata.checksum!==checksum(this.metadata))throw crit(withErrno("EIO",`sbfs: checksum mismatch for metadata block (saved ${hex(this.metadata.checksum)}, computed ${hex(checksum(this.metadata))})`));if(this.inode_format!=_inode_version)throw crit(withErrno("EIO","sbfs: inode format mismatch"));if(this.metadata_block_size!=sizeof(MetadataBlock))throw crit(withErrno("EIO","sbfs: metadata block size mismatch"))}get checksum(){return __privateGet(this,e)}set checksum(t){__privateSet(this,e,t)}get magic(){return __privateGet(this,t)}set magic(e){__privateSet(this,t,e)}get version(){return __privateGet(this,r)}set version(e){__privateSet(this,r,e)}get inode_format(){return __privateGet(this,n)}set inode_format(e){__privateSet(this,n,e)}get flags(){return __privateGet(this,i)}set flags(e){__privateSet(this,i,e)}get used_bytes(){return __privateGet(this,o)}set used_bytes(e){__privateSet(this,o,e)}get total_bytes(){return __privateGet(this,a)}set total_bytes(e){__privateSet(this,a,e)}get uuid(){return __privateGet(this,s)}set uuid(e){__privateSet(this,s,e)}get metadata_block_size(){return __privateGet(this,l)}set metadata_block_size(e){__privateSet(this,l,e)}get metadata_offset_(){return __privateGet(this,c)}set metadata_offset_(e){__privateSet(this,c,e)}get metadata_offset(){return __privateGet(this,u)}set metadata_offset(e){__privateSet(this,u,e)}get label(){return __privateGet(this,h)}set label(e){__privateSet(this,h,e)}get _padding(){return __privateGet(this,d)}set _padding(e){__privateSet(this,d,e)}rotateMetadata(){const e=this.used_bytes%BigInt(4);Atomics.add(this,usedBytes,e);const t=Number(Atomics.add(this,usedBytes,BigInt(sizeof(MetadataBlock)))),r=new MetadataBlock(this.buffer,t);return r.previous_offset=this.metadata_offset,this.metadata=r,this.metadata_offset=r.byteOffset,_update(r),_update(this),debug(`sbfs: rotated metadata block at ${hex(r.previous_offset)} with new block at ${hex(t)}`),r}isUnused(e,t){if(!t)return!0;if(e+t>this.total_bytes||e<sizeof(fe))return!1;for(let r=this.metadata;r;r=r.previous){if(e<r.byteOffset+sizeof(MetadataBlock)&&e+t>r.byteOffset)return!1;for(const n of r.items)if(n.offset&&(e>=n.offset&&e<n.offset+n.size||e+t>n.offset&&e+t<=n.offset+n.size||e<=n.offset&&e+t>=n.offset+n.size))return!1}return!0}},e=new WeakMap,t=new WeakMap,r=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,s=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,T=p,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(N[Symbol.metadata]??null):void 0;A=[(f=types$1).uint32.bind(f)],C=[(m=types$1).uint32.bind(m)],I=[(g=types$1).uint16.bind(g)],k=[(y=types$1).uint16.bind(y)],P=[(_=types$1).uint32.bind(_)],M=[(v=types$1).uint64.bind(v)],R=[(b=types$1).uint64.bind(b)],D=[types$1.uint8(16)],O=[(w=types$1).uint32.bind(w)],L=[(x=types$1).uint32.bind(x)],B=[(S=types$1).uint32.bind(S)],$=[types$1.char(64)],z=[types$1.char(132)],__esDecorate$1(p,null,A,{kind:"accessor",name:"checksum",static:!1,private:!1,access:{has:e=>"checksum"in e,get:e=>e.checksum,set:(e,t)=>{e.checksum=t}},metadata:e},j,U),__esDecorate$1(p,null,C,{kind:"accessor",name:"magic",static:!1,private:!1,access:{has:e=>"magic"in e,get:e=>e.magic,set:(e,t)=>{e.magic=t}},metadata:e},V,G),__esDecorate$1(p,null,I,{kind:"accessor",name:"version",static:!1,private:!1,access:{has:e=>"version"in e,get:e=>e.version,set:(e,t)=>{e.version=t}},metadata:e},W,H),__esDecorate$1(p,null,k,{kind:"accessor",name:"inode_format",static:!1,private:!1,access:{has:e=>"inode_format"in e,get:e=>e.inode_format,set:(e,t)=>{e.inode_format=t}},metadata:e},Z,Y),__esDecorate$1(p,null,P,{kind:"accessor",name:"flags",static:!1,private:!1,access:{has:e=>"flags"in e,get:e=>e.flags,set:(e,t)=>{e.flags=t}},metadata:e},X,K),__esDecorate$1(p,null,M,{kind:"accessor",name:"used_bytes",static:!1,private:!1,access:{has:e=>"used_bytes"in e,get:e=>e.used_bytes,set:(e,t)=>{e.used_bytes=t}},metadata:e},Q,J),__esDecorate$1(p,null,R,{kind:"accessor",name:"total_bytes",static:!1,private:!1,access:{has:e=>"total_bytes"in e,get:e=>e.total_bytes,set:(e,t)=>{e.total_bytes=t}},metadata:e},ee,te),__esDecorate$1(p,null,D,{kind:"accessor",name:"uuid",static:!1,private:!1,access:{has:e=>"uuid"in e,get:e=>e.uuid,set:(e,t)=>{e.uuid=t}},metadata:e},re,ne),__esDecorate$1(p,null,O,{kind:"accessor",name:"metadata_block_size",static:!1,private:!1,access:{has:e=>"metadata_block_size"in e,get:e=>e.metadata_block_size,set:(e,t)=>{e.metadata_block_size=t}},metadata:e},ie,oe),__esDecorate$1(p,null,L,{kind:"accessor",name:"metadata_offset_",static:!1,private:!1,access:{has:e=>"metadata_offset_"in e,get:e=>e.metadata_offset_,set:(e,t)=>{e.metadata_offset_=t}},metadata:e},ae,se),__esDecorate$1(p,null,B,{kind:"accessor",name:"metadata_offset",static:!1,private:!1,access:{has:e=>"metadata_offset"in e,get:e=>e.metadata_offset,set:(e,t)=>{e.metadata_offset=t}},metadata:e},le,ce),__esDecorate$1(p,null,$,{kind:"accessor",name:"label",static:!1,private:!1,access:{has:e=>"label"in e,get:e=>e.label,set:(e,t)=>{e.label=t}},metadata:e},ue,he),__esDecorate$1(p,null,z,{kind:"accessor",name:"_padding",static:!1,private:!1,access:{has:e=>"_padding"in e,get:e=>e._padding,set:(e,t)=>{e._padding=t}},metadata:e},de,pe),__esDecorate$1(null,E={value:T},F,{kind:"class",name:T.name,metadata:e},null,q),fe=T=E.value,e&&Object.defineProperty(T,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers$1(T,q)})(),p);fe=T})();const nop=()=>{};async function collectAsyncIterator(e){const t=[];for await(const r of e)t.push(r);return t}function rename(e,t,r=nop){rename$1.call(this,e,t).then((()=>r(null))).catch(r)}function exists(e,t=nop){exists$1.call(this,e).then(t).catch((()=>t(!1)))}function stat(e,t,r=nop){r="function"==typeof t?t:r,stat$1.call(this,e,"function"!=typeof t?t:{}).then((e=>r(null,e))).catch(r)}function lstat(e,t,r=nop){r="function"==typeof t?t:r,lstat$1.call(this,e,"function"!=typeof t?t:{}).then((e=>r(null,e))).catch(r)}function truncate(e,t=0,r=nop){r="function"==typeof t?t:r;const n="number"==typeof t?t:0;truncate$1.call(this,e,n).then((()=>r(null))).catch(r)}function unlink(e,t=nop){unlink$1.call(this,e).then((()=>t(null))).catch(t)}function open(e,t,r,n=nop){const i=normalizeMode(r,420);n="function"==typeof r?r:n,open$1.call(this,e,t,i).then((e=>n(null,e.fd))).catch(n)}function readFile(e,t,r=nop){r="function"==typeof t?t:r,readFile$1.call(this,e,"function"==typeof t?null:t).then((e=>r(null,e))).catch(r)}function writeFile(e,t,r,n=nop){n="function"==typeof r?r:n,writeFile$1.call(this,e,t,"function"!=typeof r?r:null).then((()=>n(null))).catch(n)}function appendFile(e,t,r,n=nop){const i="function"!=typeof r?r:void 0;n="function"==typeof r?r:n,appendFile$1.call(this,e,t,i).then((()=>n(null))).catch(n)}function fstat(e,t,r=nop){r="function"==typeof t?t:r,new FileHandle(this,e).stat().then((e=>r(null,"object"==typeof t&&t?.bigint?new BigIntStats(e):e))).catch(r)}function close(e,t=nop){new FileHandle(this,e).close().then((()=>t(null))).catch(t)}function ftruncate(e,t,r=nop){const n="number"==typeof t?t:0;r="function"==typeof t?t:r;const i=new FileHandle(this,e);if(n<0)throw withErrno("EINVAL");i.truncate(n).then((()=>r(null))).catch(r)}function fsync(e,t=nop){new FileHandle(this,e).sync().then((()=>t(null))).catch(t)}function fdatasync(e,t=nop){new FileHandle(this,e).datasync().then((()=>t(null))).catch(t)}function write(e,t,r,n,i,o=nop){let a,s,l,c,u;const h=new FileHandle(this,e);if("string"==typeof t){switch(u="utf8",typeof r){case"function":o=r;break;case"number":c=r,u="string"==typeof n?n:"utf8",o="function"==typeof i?i:o;break;default:return void(o="function"==typeof n?n:"function"==typeof i?i:o)(withErrno("EINVAL"))}a=Buffer$1.from(t),s=0,l=a.length;const e=o;h.write(a,s,l,c).then((({bytesWritten:t})=>e(null,t,a.toString(u)))).catch(e)}else{a=Buffer$1.from(t.buffer),s=r,l=n,c="number"==typeof i?i:null;const e="function"==typeof i?i:o;h.write(a,s,l,c).then((({bytesWritten:t})=>e(null,t,a))).catch(e)}}function read(e,t,r,n,i,o=nop){new FileHandle(this,e).read(t,r,n,i).then((({bytesRead:e,buffer:t})=>o(null,e,t))).catch(o)}function fchown(e,t,r,n=nop){new FileHandle(this,e).chown(t,r).then((()=>n(null))).catch(n)}function fchmod(e,t,r){new FileHandle(this,e).chmod(t).then((()=>r(null))).catch(r)}function futimes(e,t,r,n=nop){new FileHandle(this,e).utimes(t,r).then((()=>n(null))).catch(n)}function rmdir(e,t=nop){rmdir$1.call(this,e).then((()=>t(null))).catch(t)}function mkdir(e,t,r=nop){mkdir$1.call(this,e,t).then((()=>r(null))).catch(r)}function readdir(e,t,r=nop){r="function"==typeof t?t:r;const n="function"!=typeof t?t:{};readdir$1.call(this,e,n).then((e=>r(null,e))).catch(r)}function link$1(e,t,r=nop){link$2.call(this,e,t).then((()=>r(null))).catch(r)}function symlink(e,t,r,n=nop){const i="string"==typeof r?r:"file";n="function"==typeof r?r:n,symlink$1.call(this,e,t,i).then((()=>n(null))).catch(n)}function readlink(e,t,r=nop){r="function"==typeof t?t:r,readlink$1.call(this,e).then((e=>r(null,e))).catch(r)}function chown(e,t,r,n=nop){chown$1.call(this,e,t,r).then((()=>n(null))).catch(n)}function lchown(e,t,r,n=nop){lchown$1.call(this,e,t,r).then((()=>n(null))).catch(n)}function chmod(e,t,r=nop){chmod$1.call(this,e,t).then((()=>r(null))).catch(r)}function lchmod(e,t,r=nop){lchmod$1.call(this,e,t).then((()=>r(null))).catch(r)}function utimes(e,t,r,n=nop){utimes$1.call(this,e,t,r).then((()=>n(null))).catch(n)}function lutimes(e,t,r,n=nop){lutimes$1.call(this,e,t,r).then((()=>n(null))).catch(n)}function realpath(e,t,r=nop){r="function"==typeof t?t:r,realpath$1.call(this,e,"function"==typeof t?null:t).then((e=>r(null,e))).catch(r)}function access(e,t,r=nop){const n="number"==typeof t?t:R_OK;r="function"==typeof t?t:r,access$1.call(this,e,n).then((()=>r(null))).catch(r)}const statWatchers=new Map;function watchFile(e,t,r){const n=normalizePath(e),i="function"!=typeof t?t:{};if("function"==typeof t&&(r=t),!r)throw UV("EINVAL","watch",e.toString());if(statWatchers.has(n)){const e=statWatchers.get(n);return void(e&&e.listeners.add(r))}const o=new StatWatcher(this,n,i);o.on("change",((e,t)=>{const r=statWatchers.get(n);if(r)for(const n of r.listeners)n(e,t)})),statWatchers.set(n,{watcher:o,listeners:new Set})}function unwatchFile(e,t=nop){const r=normalizePath(e),n=statWatchers.get(r);n&&(t&&t!==nop?n.listeners.delete(t):n.listeners.clear(),0===n.listeners.size&&(n.watcher.stop(),statWatchers.delete(r)))}function watch(e,t,r){const n=new FSWatcher(this,normalizePath(e),"object"==typeof t?t:{});return r="function"==typeof t?t:r,n.on("change",r||nop),n}function createReadStream(e,t){t="object"==typeof t?t:{encoding:t};const r=open$1.call(this,e,"r",t?.mode);return new ReadStream({...t,autoClose:!0},r)}function createWriteStream(e,t){t="object"==typeof t?t:{encoding:t};const r=open$1.call(this,e,"w",t?.mode);return new WriteStream(t,r)}function rm(e,t,r=nop){r="function"==typeof t?t:r,rm$1.call(this,e,"function"==typeof t?void 0:t).then((()=>r(null))).catch(r)}function mkdtemp(e,t,r=nop){r="function"==typeof t?t:r,mkdtemp$1.call(this,e,"function"!=typeof t?t:null).then((e=>r(null,e))).catch(r)}function copyFile(e,t,r,n=nop){n="function"==typeof r?r:n,copyFile$1.call(this,e,t,"function"==typeof r?void 0:r).then((()=>n(null))).catch(n)}function readv(e,t,r,n=nop){n="function"==typeof r?r:n,new FileHandle(this,e).readv(t,"function"==typeof r?void 0:r).then((({buffers:e,bytesRead:t})=>n(null,t,e))).catch(n)}function writev(e,t,r,n=nop){n="function"==typeof r?r:n,new FileHandle(this,e).writev(t,"function"==typeof r?void 0:r).then((({buffers:e,bytesWritten:t})=>n(null,t,e))).catch(n)}function opendir(e,t,r=nop){r="function"==typeof t?t:r,opendir$1.call(this,e,"function"==typeof t?void 0:t).then((e=>r(null,e))).catch(r)}function cp(e,t,r,n=nop){n="function"==typeof r?r:n,cp$1.call(this,e,t,"function"==typeof r?void 0:r).then((()=>n(null))).catch(n)}function statfs(e,t,r=nop){r="function"==typeof t?t:r,statfs$1.call(this,e,"function"==typeof t?void 0:t).then((e=>r(null,e))).catch(r)}async function openAsBlob(e,t){const r=await open$1.call(this,e.toString(),"r"),n=await r.readFile();return await r.close(),new Blob([n],t)}function glob(e,t,r=nop){r="function"==typeof t?t:r;collectAsyncIterator(glob$1.call(this,e,"function"==typeof t?void 0:t)).then((e=>r(null,e??[]))).catch((e=>r(e)))}const _allowedRestrictedNames=[];function checkName(e,t,r,n){if(!t.startsWith("user.")&&!_allowedRestrictedNames.includes(t))throw UV("ENOTSUP",n,r)}async function get(e,t,r={}){e=normalizePath(e);const{fs:n,path:i}=resolveMount(e,this);checkName(this,t,e,"xattr.get");const o=await n.stat(i).catch(rethrow("xattr.get",e));if(!hasAccess(this,o,R_OK))throw UV("EACCES","xattr.get",e);o.attributes??=new Attributes;const a=o.attributes.get(t);if(!a)throw UV("ENODATA","xattr.get",e);const s=Buffer$1.from(a);return"buffer"!=r.encoding&&r.encoding?s.toString(r.encoding):s}function getSync(e,t,r={}){checkName(this,t,e=normalizePath(e),"xattr.get");const{fs:n,path:i}=resolveMount(e,this);let o;try{o=n.statSync(i)}catch(l){throw setUVMessage(Object.assign(l,{path:e}))}if(!hasAccess(this,o,R_OK))throw UV("EACCES","xattr.get",e);o.attributes??=new Attributes;const a=o.attributes.get(t);if(!a)throw UV("ENODATA","xattr.get",e);const s=Buffer$1.from(a);return"buffer"!=r.encoding&&r.encoding?s.toString(r.encoding):s}async function set(e,t,r,n={}){e=normalizePath(e);const{fs:i,path:o}=resolveMount(e,this);checkName(this,t,e,"xattr.set");const a=await i.stat(o).catch(rethrow("xattr.set",e));if(!hasAccess(this,a,W_OK))throw UV("EACCES","xattr.set",e);a.attributes??=new Attributes;const s=a.attributes.get(t);if(n.create&&s)throw UV("EEXIST","xattr.set",e);if(n.replace&&!s)throw UV("ENODATA","xattr.set",e);a.attributes.set(t,Buffer$1.from(r)),await i.touch(o,a).catch(rethrow("xattr.set",e))}function setSync(e,t,r,n={}){e=normalizePath(e);const{fs:i,path:o}=resolveMount(e,this);let a;checkName(this,t,e,"xattr.set");try{a=i.statSync(o)}catch(l){throw setUVMessage(Object.assign(l,{path:e}))}if(!hasAccess(this,a,W_OK))throw UV("EACCES","xattr.set",e);a.attributes??=new Attributes;const s=a.attributes.get(t);if(n.create&&s)throw UV("EEXIST","xattr.set",e);if(n.replace&&!s)throw UV("ENODATA","xattr.set",e);a.attributes.set(t,Buffer$1.from(r));try{i.touchSync(o,a)}catch(l){throw setUVMessage(Object.assign(l,{path:e}))}}async function remove(e,t){e=normalizePath(e);const{fs:r,path:n}=resolveMount(e,this);checkName(this,t,e,"xattr.remove");const i=await r.stat(n).catch(rethrow("xattr.remove",e));if(!hasAccess(this,i,W_OK))throw UV("EACCES","xattr.remove",e);i.attributes??=new Attributes;if(!i.attributes.get(t))throw UV("ENODATA","xattr.remove",e);i.attributes.remove(t),await r.touch(n,i)}function removeSync(e,t){e=normalizePath(e);const{fs:r,path:n}=resolveMount(e,this);let i;checkName(this,t,e,"xattr.remove");try{i=r.statSync(n)}catch(o){throw setUVMessage(Object.assign(o,{path:e}))}if(!hasAccess(this,i,W_OK))throw UV("EACCES","xattr.remove",e);i.attributes??=new Attributes;if(!i.attributes.get(t))throw UV("ENODATA","xattr.remove",e);i.attributes.remove(t);try{r.touchSync(n,i)}catch(o){throw setUVMessage(Object.assign(o,{path:e}))}}async function list$1(e){e=normalizePath(e);const{fs:t,path:r}=resolveMount(e,this),n=await t.stat(r).catch(rethrow("xattr.list",e));return n.attributes?n.attributes.keys().toArray():[]}function listSync(e){e=normalizePath(e);const{fs:t,path:r}=resolveMount(e,this);let n;try{n=t.statSync(r)}catch(i){throw setUVMessage(Object.assign(i,{path:e}))}return n.attributes?n.attributes.keys().toArray():[]}const xattr=Object.freeze(Object.defineProperty({__proto__:null,get:get,getSync:getSync,list:list$1,listSync:listSync,remove:remove,removeSync:removeSync,set:set,setSync:setSync},Symbol.toStringTag,{value:"Module"}));"function"==typeof SuppressedError&&SuppressedError;var __esDecorate=function(e,t,r,n,i,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var m in n)f[m]="access"===m?{}:n[m];for(var m in n.access)f.access[m]=n.access[m];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var g=(0,r[p])("accessor"===l?{get:h.get,set:h.set}:h[c],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(h.get=s),(s=a(g.set))&&(h.set=s),(s=a(g.init))&&i.unshift(s)}else(s=a(g))&&("field"===l?i.unshift(s):h[c]=s)}u&&Object.defineProperty(u,n.name,h),d=!0},__runInitializers=function(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0},XFlag,XFlag2;XFlag2=XFlag||(XFlag={}),XFlag2[XFlag2.RealTime=1]="RealTime",XFlag2[XFlag2.PreAlloc=2]="PreAlloc",XFlag2[XFlag2.Immutable=8]="Immutable",XFlag2[XFlag2.Append=16]="Append",XFlag2[XFlag2.Sync=32]="Sync",XFlag2[XFlag2.NoAtime=64]="NoAtime",XFlag2[XFlag2.NoDump=128]="NoDump",XFlag2[XFlag2.RtInherit=256]="RtInherit",XFlag2[XFlag2.ProjInherit=512]="ProjInherit",XFlag2[XFlag2.NoSymlinks=1024]="NoSymlinks",XFlag2[XFlag2.ExtSize=2048]="ExtSize",XFlag2[XFlag2.ExtSzInherit=4096]="ExtSzInherit",XFlag2[XFlag2.NoDefrag=8192]="NoDefrag",XFlag2[XFlag2.FileStream=16384]="FileStream",XFlag2[XFlag2.Dax=32768]="Dax",XFlag2[XFlag2.CowExtSize=65536]="CowExtSize",XFlag2[XFlag2.HasAttr=2147483648]="HasAttr";let fsxattr=(()=>{var e,t,r,n,i,o,a,s,l,c,u,h;let d,p,f,m,g,y,_,v,b=[struct$1("fsxattr")],w=[],x=$from(BufferView),S=[],E=[],T=[],A=[],C=[],I=[],k=[],P=[],M=[],R=[],D=[],O=[];var L=(a=class extends x{constructor(a=_throw(new Exception(Errno.EINVAL,"fsxattr must be initialized with an inode"))){super(new ArrayBuffer(sizeof(L))),__privateAdd(this,e,__runInitializers(this,S,void 0)),__privateAdd(this,t,(__runInitializers(this,E),__runInitializers(this,T,void 0))),__privateAdd(this,r,(__runInitializers(this,A),__runInitializers(this,C,void 0))),__privateAdd(this,n,(__runInitializers(this,I),__runInitializers(this,k,void 0))),__privateAdd(this,i,(__runInitializers(this,P),__runInitializers(this,M,void 0))),__privateAdd(this,o,(__runInitializers(this,R),__runInitializers(this,D,[]))),__runInitializers(this,O),this.extsize=a.size,this.nextents=1,this.projid=a.uid,this.cowextsize=a.size;for(const e of Object.keys(InodeFlags))a.flags&InodeFlags[e]&&e in XFlag&&(this.xflags|=XFlag[e])}get xflags(){return __privateGet(this,e)}set xflags(t){__privateSet(this,e,t)}get extsize(){return __privateGet(this,t)}set extsize(e){__privateSet(this,t,e)}get nextents(){return __privateGet(this,r)}set nextents(e){__privateSet(this,r,e)}get projid(){return __privateGet(this,n)}set projid(e){__privateSet(this,n,e)}get cowextsize(){return __privateGet(this,i)}set cowextsize(e){__privateSet(this,i,e)}get pad(){return __privateGet(this,o)}set pad(e){__privateSet(this,o,e)}},e=new WeakMap,t=new WeakMap,r=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,p=a,(()=>{const e="function"==typeof Symbol&&Symbol.metadata?Object.create(x[Symbol.metadata]??null):void 0;f=[(s=types$1).uint32.bind(s)],m=[(l=types$1).uint32.bind(l)],g=[(c=types$1).uint32.bind(c)],y=[(u=types$1).uint32.bind(u)],_=[(h=types$1).uint32.bind(h)],v=[types$1.char(8)],__esDecorate(a,null,f,{kind:"accessor",name:"xflags",static:!1,private:!1,access:{has:e=>"xflags"in e,get:e=>e.xflags,set:(e,t)=>{e.xflags=t}},metadata:e},S,E),__esDecorate(a,null,m,{kind:"accessor",name:"extsize",static:!1,private:!1,access:{has:e=>"extsize"in e,get:e=>e.extsize,set:(e,t)=>{e.extsize=t}},metadata:e},T,A),__esDecorate(a,null,g,{kind:"accessor",name:"nextents",static:!1,private:!1,access:{has:e=>"nextents"in e,get:e=>e.nextents,set:(e,t)=>{e.nextents=t}},metadata:e},C,I),__esDecorate(a,null,y,{kind:"accessor",name:"projid",static:!1,private:!1,access:{has:e=>"projid"in e,get:e=>e.projid,set:(e,t)=>{e.projid=t}},metadata:e},k,P),__esDecorate(a,null,_,{kind:"accessor",name:"cowextsize",static:!1,private:!1,access:{has:e=>"cowextsize"in e,get:e=>e.cowextsize,set:(e,t)=>{e.cowextsize=t}},metadata:e},M,R),__esDecorate(a,null,v,{kind:"accessor",name:"pad",static:!1,private:!1,access:{has:e=>"pad"in e,get:e=>e.pad,set:(e,t)=>{e.pad=t}},metadata:e},D,O),__esDecorate(null,d={value:p},b,{kind:"class",name:p.name,metadata:e},null,w),L=p=d.value,e&&Object.defineProperty(p,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:e}),__runInitializers(p,w)})(),a);return L=p})();var FileFlag,FileFlag2,IOC,IOC2,IOC32,IOC322;async function ioctl(e,t,...r){e=normalizePath(e);const{fs:n,path:i}=resolveMount(e,this);try{const e=new Inode(await n.stat(i));switch(t){case IOC.GetFlags:case IOC32.GetFlags:return e.flags;case IOC.SetFlags:case IOC32.SetFlags:return e.flags=r[0],void(await n.touch(i,e));case IOC.GetVersion:case IOC32.GetVersion:return e.version;case IOC.SetVersion:case IOC32.SetVersion:return e.version=r[0],void(await n.touch(i,e));case IOC.Fiemap:break;case IOC.GetXattr:return new fsxattr(e);case IOC.SetXattr:break;case IOC.GetLabel:return n.label;case IOC.SetLabel:return void(n.label=r[0]);case IOC.GetUUID:return n.uuid;case IOC.GetSysfsPath:return`/sys/fs/${n.name}/${n.uuid}`}}catch(o){throw setUVMessage(Object.assign(o,{syscall:"ioctl",path:e}))}throw UV("ENOTSUP","ioctl",e)}function ioctlSync(e,t,...r){e=normalizePath(e);const{fs:n,path:i}=resolveMount(e,this);try{const e=new Inode(n.statSync(i));switch(t){case IOC.GetFlags:case IOC32.GetFlags:return e.flags;case IOC.SetFlags:case IOC32.SetFlags:return e.flags=r[0],void n.touchSync(i,e);case IOC.GetVersion:case IOC32.GetVersion:return e.version;case IOC.SetVersion:case IOC32.SetVersion:return e.version=r[0],void n.touchSync(i,e);case IOC.Fiemap:break;case IOC.GetXattr:return new fsxattr(e);case IOC.SetXattr:break;case IOC.GetLabel:return n.label;case IOC.SetLabel:return void(n.label=r[0]);case IOC.GetUUID:return n.uuid;case IOC.GetSysfsPath:return`/sys/fs/${n.name}/${n.uuid}`}}catch(o){throw setUVMessage(Object.assign(o,{syscall:"ioctl",path:e}))}throw UV("ENOTSUP","ioctl",e)}FileFlag2=FileFlag||(FileFlag={}),FileFlag2[FileFlag2.SecureRm=1]="SecureRm",FileFlag2[FileFlag2.Undelete=2]="Undelete",FileFlag2[FileFlag2.Compress=4]="Compress",FileFlag2[FileFlag2.Sync=8]="Sync",FileFlag2[FileFlag2.Immutable=16]="Immutable",FileFlag2[FileFlag2.Append=32]="Append",FileFlag2[FileFlag2.NoDump=64]="NoDump",FileFlag2[FileFlag2.NoAtime=128]="NoAtime",FileFlag2[FileFlag2.Dirty=256]="Dirty",FileFlag2[FileFlag2.CompressBlk=512]="CompressBlk",FileFlag2[FileFlag2.NoCompress=1024]="NoCompress",FileFlag2[FileFlag2.Encrypt=2048]="Encrypt",FileFlag2[FileFlag2.Btree=4096]="Btree",FileFlag2[FileFlag2.Index=4096]="Index",FileFlag2[FileFlag2.IMagic=8192]="IMagic",FileFlag2[FileFlag2.JournalData=16384]="JournalData",FileFlag2[FileFlag2.NoTail=32768]="NoTail",FileFlag2[FileFlag2.DirSync=65536]="DirSync",FileFlag2[FileFlag2.TopDir=131072]="TopDir",FileFlag2[FileFlag2.HugeFile=262144]="HugeFile",FileFlag2[FileFlag2.Extent=524288]="Extent",FileFlag2[FileFlag2.Verity=1048576]="Verity",FileFlag2[FileFlag2.EaInode=2097152]="EaInode",FileFlag2[FileFlag2.EofBlocks=4194304]="EofBlocks",FileFlag2[FileFlag2.NoCow=8388608]="NoCow",FileFlag2[FileFlag2.Dax=33554432]="Dax",FileFlag2[FileFlag2.InlineData=268435456]="InlineData",FileFlag2[FileFlag2.ProjInherit=536870912]="ProjInherit",FileFlag2[FileFlag2.CaseFold=1073741824]="CaseFold",FileFlag2[FileFlag2.Reserved=2147483648]="Reserved",IOC2=IOC||(IOC={}),IOC2[IOC2.GetFlags=2148034049]="GetFlags",IOC2[IOC2.SetFlags=1074292226]="SetFlags",IOC2[IOC2.GetVersion=2148038145]="GetVersion",IOC2[IOC2.SetVersion=1074296322]="SetVersion",IOC2[IOC2.Fiemap=3223348747]="Fiemap",IOC2[IOC2.GetXattr=2149341215]="GetXattr",IOC2[IOC2.SetXattr=1075599392]="SetXattr",IOC2[IOC2.GetLabel=2164298801]="GetLabel",IOC2[IOC2.SetLabel=1090556978]="SetLabel",IOC2[IOC2.GetUUID=2148603136]="GetUUID",IOC2[IOC2.GetSysfsPath=2155943169]="GetSysfsPath",IOC322=IOC32||(IOC32={}),IOC322[IOC322.GetFlags=2147771905]="GetFlags",IOC322[IOC322.SetFlags=1074030082]="SetFlags",IOC322[IOC322.GetVersion=2147776001]="GetVersion",IOC322[IOC322.SetVersion=1074034178]="SetVersion";const fs=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:BigIntStatsFs,Dir:Dir,Dirent:Dirent,get IOC(){return IOC},get IOC32(){return IOC32},ReadStream:ReadStream,Stats:Stats,StatsFs:StatsFs,WriteStream:WriteStream,access:access,accessSync:accessSync,appendFile:appendFile,appendFileSync:appendFileSync,chmod:chmod,chmodSync:chmodSync,chown:chown,chownSync:chownSync,chroot:chroot,close:close,closeSync:closeSync,constants:constants$1,copyFile:copyFile,copyFileSync:copyFileSync,cp:cp,cpSync:cpSync,createReadStream:createReadStream,createWriteStream:createWriteStream,exists:exists,existsSync:existsSync,fchmod:fchmod,fchmodSync:fchmodSync,fchown:fchown,fchownSync:fchownSync,fdatasync:fdatasync,fdatasyncSync:fdatasyncSync,fstat:fstat,fstatSync:fstatSync,fsync:fsync,fsyncSync:fsyncSync,ftruncate:ftruncate,ftruncateSync:ftruncateSync,futimes:futimes,futimesSync:futimesSync,glob:glob,globSync:globSync,ioctl:ioctl,ioctlSync:ioctlSync,lchmod:lchmod,lchmodSync:lchmodSync,lchown:lchown,lchownSync:lchownSync,link:link$1,linkSync:linkSync,lopenSync:lopenSync,lstat:lstat,lstatSync:lstatSync,lutimes:lutimes,lutimesSync:lutimesSync,mkdir:mkdir,mkdirSync:mkdirSync,mkdtemp:mkdtemp,mkdtempDisposableSync:mkdtempDisposableSync,mkdtempSync:mkdtempSync,mount:mount,open:open,openAsBlob:openAsBlob,openSync:openSync,opendir:opendir,opendirSync:opendirSync,promises:promises,read:read,readFile:readFile,readFileSync:readFileSync,readSync:readSync,readdir:readdir,readdirSync:readdirSync,readlink:readlink,readlinkSync:readlinkSync,readv:readv,readvSync:readvSync,realpath:realpath,realpathSync:realpathSync,rename:rename,renameSync:renameSync,rm:rm,rmSync:rmSync,rmdir:rmdir,rmdirSync:rmdirSync,stat:stat,statSync:statSync,statfs:statfs,statfsSync:statfsSync,symlink:symlink,symlinkSync:symlinkSync,truncate:truncate,truncateSync:truncateSync,umount:umount,unlink:unlink,unlinkSync:unlinkSync,unwatchFile:unwatchFile,utimes:utimes,utimesSync:utimesSync,watch:watch,watchFile:watchFile,write:write,writeFile:writeFile,writeFileSync:writeFileSync,writeSync:writeSync,writev:writev,writevSync:writevSync,xattr:xattr},Symbol.toStringTag,{value:"Module"})),version$3="2.4.4",$pkg={version:version$3};
/*!
 * @zenfs/core  https://npmjs.com/package/@zenfs/core
 * Copyright  James Prevett and other ZenFS contributors.
 * SPDX-License-Identifier: LGPL-3.0-or-later
 */
globalThis.__zenfs__=Object.assign(Object.create(fs),{_version:$pkg.version});const QToolbar=createComponent({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:t}){const r=computed((()=>"q-toolbar row no-wrap items-center"+(!0===e.inset?" q-toolbar--inset":"")));return()=>h$2("div",{class:r.value,role:"toolbar"},hSlot(t.default))}}),QPageContainer=createComponent({name:"QPageContainer",setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=inject(layoutKey,emptyRenderFn);if(n===emptyRenderFn)return emptyRenderFn;provide(pageContainerKey,!0);const i=computed((()=>{const e={};return!0===n.header.space&&(e.paddingTop=`${n.header.size}px`),!0===n.right.space&&(e["padding"+(!0===r.lang.rtl?"Left":"Right")]=`${n.right.size}px`),!0===n.footer.space&&(e.paddingBottom=`${n.footer.size}px`),!0===n.left.space&&(e["padding"+(!0===r.lang.rtl?"Right":"Left")]=`${n.left.size}px`),e}));return()=>h$2("div",{class:"q-page-container",style:i.value},hSlot(t.default))}}),QLayout=createComponent({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=ref$1(null),o=ref$1(n.screen.height),a=ref$1(!0===e.container?0:n.screen.width),s=ref$1({position:0,direction:"down",inflectionPoint:0}),l=ref$1(0),c=ref$1(!0===isRuntimeSsrPreHydration.value?0:getScrollbarWidth()),u=computed((()=>"q-layout q-layout--"+(!0===e.container?"containerized":"standard"))),h=computed((()=>!1===e.container?{minHeight:n.screen.height+"px"}:null)),d=computed((()=>0!==c.value?{[!0===n.lang.rtl?"left":"right"]:`${c.value}px`}:null)),p=computed((()=>0!==c.value?{[!0===n.lang.rtl?"right":"left"]:0,[!0===n.lang.rtl?"left":"right"]:`-${c.value}px`,width:`calc(100% + ${c.value}px)`}:null));function f(t){if(!0===e.container||!0!==document.qScrollPrevented){const n={position:t.position.top,direction:t.direction,directionChanged:t.directionChanged,inflectionPoint:t.inflectionPoint.top,delta:t.delta.top};s.value=n,void 0!==e.onScroll&&r("scroll",n)}}function m(t){const{height:n,width:i}=t;let s=!1;o.value!==n&&(s=!0,o.value=n,void 0!==e.onScrollHeight&&r("scrollHeight",n),y()),a.value!==i&&(s=!0,a.value=i),!0===s&&void 0!==e.onResize&&r("resize",t)}function g({height:e}){l.value!==e&&(l.value=e,y())}function y(){if(!0===e.container){const e=o.value>l.value?getScrollbarWidth():0;c.value!==e&&(c.value=e)}}let _=null;const v={instances:{},view:computed((()=>e.view)),isContainer:computed((()=>e.container)),rootRef:i,height:o,containerHeight:l,scrollbarWidth:c,totalWidth:computed((()=>a.value+c.value)),rows:computed((()=>{const t=e.view.toLowerCase().split(" ");return{top:t[0].split(""),middle:t[1].split(""),bottom:t[2].split("")}})),header:reactive({size:0,offset:0,space:!1}),right:reactive({size:300,offset:0,space:!1}),footer:reactive({size:0,offset:0,space:!1}),left:reactive({size:300,offset:0,space:!1}),scroll:s,animate(){null!==_?clearTimeout(_):document.body.classList.add("q-body--layout-animate"),_=setTimeout((()=>{_=null,document.body.classList.remove("q-body--layout-animate")}),155)},update(e,t,r){v[e][t]=r}};if(provide(layoutKey,v),getScrollbarWidth()>0){let t=function(){o=null,a.classList.remove("hide-scrollbar")},r=function(){if(null===o){if(a.scrollHeight>n.screen.height)return;a.classList.add("hide-scrollbar")}else clearTimeout(o);o=setTimeout(t,300)},i=function(e){null!==o&&"remove"===e&&(clearTimeout(o),t()),window[`${e}EventListener`]("resize",r)},o=null;const a=document.body;watch$2((()=>!0!==e.container?"add":"remove"),i),!0!==e.container&&i("add"),onUnmounted((()=>{i("remove")}))}return()=>{const r=hMergeSlot(t.default,[h$2(QScrollObserver,{onScroll:f}),h$2(QResizeObserver,{onResize:m})]),n=h$2("div",{class:u.value,style:h.value,ref:!0===e.container?void 0:i,tabindex:-1},r);return!0===e.container?h$2("div",{class:"q-layout-container overflow-hidden",ref:i},[h$2(QResizeObserver,{onResize:g}),h$2("div",{class:"absolute-full",style:d.value},[h$2("div",{class:"scroll",style:p.value},[n])])]):n}}});var Direction=(t=Direction||{},t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t.LEFT_TOP="left-top",t.RIGHT_TOP="right-top",t.LEFT_BOTTOM="left-bottom",t.RIGHT_BOTTOM="right-bottom",t),WindowAnimate=(t2=WindowAnimate||{},t2.NONE="none",t2.ZOOM="zoom",t2),WindowOffset=(e=>(e.LEFT_TOP="leftTop",e.LEFT_CENTER="leftCenter",e.LEFT_BOTTOM="leftBottom",e.TOP_CENTER="topCenter",e.CENTER="center",e.BOTTOM_CENTER="bottomCenter",e.RIGHT_TOP="rightTop",e.RIGHT_CENTER="rightCenter",e.RIGHT_BOTTOM="rightBottom",e))(WindowOffset||{}),WindowStatus=(e=>(e.NONE="none",e.NORMAL="normal",e.MAX="max",e.MIN="min",e))(WindowStatus||{}),ComponentType=(e=>(e.ICON="icon",e.WINDOW_ICON="window-icon",e.ACTION_BUTTON="action-button",e.PARCLOSE="parclose",e.RESIZE_BAR="resize-bar",e.ACTION_BAR="action-bar",e.ACTION_BUTTONS="action-buttons",e.CONTEXT_MENU_BUTTON="context-menu-button",e.CONTEXT_MENU_BAR="context-menu-bar",e.CONTEXT_MENU_BUTTONS="context-menu-buttons",e.TITLE_BAR="title-bar",e.TAB_BAR="tab-bar",e.TOOL_BAR="tool-bar",e.WINDOW="window",e.MORE_ACTION_CONTEXT_MENU_BAR="more-action-context-menu-bar",e.TOP_MENU_BAR="top-menu-bar",e.TOP_MENU_BUTTON="top-menu-button",e.TOP_MENU_BUTTONS="top-menu-buttons",e.WINDOW_ICON_CONTEXT_MENU_BAR="window-icon-context-menu-bar",e.SALVER="salver",e.SALVER_BAR="salver-bar",e.SALVER_BUTTON="salver-button",e.CONTENT="content",e.CONTENT_PENETRATE="content-penetrate",e.CONTENT_CONTAINER="content-container",e.HTML_CONTENT="html-content",e.URL_CONTENT="url-content",e.NOTICE="notice",e.DRAG_LAYER="drag-layer",e.STATU_BAR="statu-bar",e))(ComponentType||{}),WindowContentType=(e=>(e.HTML="html",e.LOCAL_URL="local-url",e.NON_LOCAL_URL="non-local-url",e))(WindowContentType||{}),t,t2;function assertId(){throw new Error("`id` is required.")}function assertString(e){throw new Error("Unexpected string: "+e)}function assertNumber(e){throw new Error("Unexpected number: "+e)}function assertNever(e){throw new Error("Unexpected object: "+e)}function assertBoolean(e){throw new Error("Unexpected boolean: "+e)}function isWindowCoord(e){return void 0!==e.length&&e.length>=2&&e.constructor===Array&&"number"==typeof e[0]&&"number"==typeof e[1]}function isWindowMode(e){switch(e){case"layer":case"embed":return!0;default:return assertNever(e)}}function isWindowAnimate(e){switch(e){case"none":case"zoom":return!0;default:return assertNever(e)}}function isJsonObject(e){return"object"==typeof e&&void 0!==e.constructor&&e.constructor===Object}function isContextMenuButton(e){return isJsonObject(e)&&void 0!==e.id&&void 0!==e.label}function isContextMenuButtons(e){let t=!0;for(const r of e)if(!isContextMenuButton(r)){t=!1;break}return t}function isActionButton(e){return isJsonObject(e)&&void 0!==e.label&&void 0!==e.id}function isActionButtons(e){let t=!0;for(const r of e)if(!isActionButton(r)){t=!1;break}return t}function isStringWithNotEmpty(e){return"string"==typeof e&&e.trim().length>0}function isElement(e){return"object"==typeof e&&e instanceof Element}function isContentType(e){switch(e){case"html":case"local-url":case"non-local-url":return!0;default:return assertNever(e)}}function isStringOrElement(e){return"string"==typeof e||isElement(e)}function isNoticeType(e){switch(e){case"info":case"success":case"warning":case"error":return!0;default:return assertNever(e)}}function isMoveEvent(e){return void 0!==e.button&&void 0===e.touches}function clone$1(e){const t={};for(const r of Object.keys(e))t[r]=isJsonObject(e[r])?clone$1(e[r]):e[r];return t}function merge(e,t){const r=clone$1(e);for(const n of Object.keys(t))void 0!==r[n]&&isJsonObject(t[n])?r[n]=merge(r[n],t[n]):r[n]=t[n];return r}function numberCast(e,t){return void 0===e?t:"number"==typeof e?e:/^(([1-9][0-9]*(\.\d{1,2})?)|(0\.\d{1,2}))$/.test(e)?Number(e):assertNumber(e)}function stringCast(e){return isStringWithNotEmpty(e)?e:assertString(e)}function booleanCast(e,t){return void 0===e?t:("boolean"!=typeof e&&assertBoolean(e),e)}function stringOrBooleanStyleCast(e,t,r){return void 0===e||!0===e?t:!1===e?null:e}function typeOrBooleanCast(e,t,r,n){return void 0===e?t:!0===e?void 0===r?t:r:!1!==e&&e}function stringOrUndefinedCast(e){if(void 0!==e)return isStringWithNotEmpty(e)?e:assertString(e)}function windowModeCast(e,t){return void 0===e?t:(isWindowMode(e),e)}function borderCast(e,t){if("string"==typeof e)return[e,null];if(!1===e)return[null,null];let r=[null,null],n={};return n=void 0===e||!0===e?merge({},t):merge(t,e),"number"==typeof n.width&&"string"==typeof n.color&&"string"==typeof n.style&&["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset","inherit"].indexOf(n.style)>-1&&(r[0]=`${n.width}px ${n.style} ${n.color}`),"number"==typeof n.radius&&(r[1]=`${n.radius}px`),r}function offsetCast(e,t,r){if(void 0===e)return[(innerWidth-t)/2,(innerHeight-r)/2];if(isWindowCoord(e)){const[t,r]=e;return[t,r]}const n=[0,0];switch(e){case WindowOffset.LEFT_TOP:break;case WindowOffset.LEFT_CENTER:n[0]=0,n[1]=(innerHeight-r)/2;break;case WindowOffset.LEFT_BOTTOM:n[0]=0,n[1]=innerHeight-r;break;case WindowOffset.TOP_CENTER:n[0]=(innerWidth-t)/2,n[1]=0;case WindowOffset.CENTER:n[0]=(innerWidth-t)/2,n[1]=(innerHeight-r)/2;break;case WindowOffset.BOTTOM_CENTER:n[0]=(innerWidth-t)/2,n[1]=innerHeight-r;break;case WindowOffset.RIGHT_TOP:n[0]=innerWidth-t,n[1]=0;break;case WindowOffset.RIGHT_CENTER:n[0]=innerWidth-t,n[1]=(innerHeight-r)/2;break;case WindowOffset.RIGHT_BOTTOM:n[0]=innerWidth-t,n[1]=innerHeight-r;break;default:return assertNever(e)}return n}function windowAnimateCast(e,t,r,n){return void 0===e?t:!0===e?WindowAnimate.ZOOM:!1===e?WindowAnimate.NONE:(isWindowAnimate(e),e)}function jsonOrBooleanCast(e,t,r,n){return void 0===e||!0===e?t:!1!==e&&(!1===t?e:merge(t,e))}function contextMenuButtonsCast(e){return void 0!==e&&!1!==e&&(isContextMenuButtons(e),e)}function actionButtonsCast(e,t){return void 0===e||!0===e?t:!1!==e&&(isActionButtons(e),e)}function contentTypeCast(e,t){return void 0===e?t:(isContentType(e),e)}function stringOrElementCast(e){return isStringOrElement(e)?e:assertNever(e)}function noticeTypeCast(e,t){return void 0===e?t:(isNoticeType(e),e)}function getCamelCase(e){return e.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))}function exchangeValue(e,t){let r=e;return[e=t,t=r]}function removeValidSymbol(e){let t=e.trim();return 0===t.length||(t=e.replace(/[\r\n\t\s]/g,"")),t}function mendZero(e,t){if(e.length===t)return e;if(e.length<t){let r="";for(let n=0;n<t-e.length;n++)r+="0";return r+e}return e.substr(0,t)}class UIComponent{constructor(e){this.app=e}state;components={};setComponent(e,t){e=stringCast(e),this.components[e]||(this.components[e]=t)}getComponent(e,t=this){if((e=removeValidSymbol(e=stringCast(e))).indexOf("/")>-1){const r=e.split("/");let n=t.getComponent(r[0]);if(null===n)return null;for(let e=0;e<r.length;e++){if(!(e+1<r.length))return n;n=n.getComponent(r[e+1],n)}return n}return t.components[e]?t.components[e]:null}removeComponent(e){e=stringCast(e),this.components[e]&&delete this.components[e]}}class UIWindowComponent extends UIComponent{constructor(e,t){super(e),this.window=t}}function createFragment(){return document.createDocumentFragment()}function createElement(e){return document.createElement(e)}function createElementNS(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function addStyles(e,t){if(null===e)return e;for(const r of Object.keys(t))e.style[r]=t[r];return e}function updateClasses(e,t,r="layx-",...n){const i=e.className.split(/\s+/g);return n.forEach((e=>{if(e){const n=r+e,o=i.indexOf(n);t(i,o,n)}})),e.className=i.join(" ").trim(),e}function addClasses(e,t="layx-",...r){return null===e?e:updateClasses(e,(function(e,t,r){~t||e.push(r)}),t,...r)}function removeClasses(e,t="layx-",...r){return null===e?e:updateClasses(e,(function(e,t){~t&&e.splice(t,1)}),t,...r)}function containClass(e,t="layx-",r){return null!==e&&!!~e.className.split(/\s+/g).indexOf(t+r)}function removeElement(e){e&&e.parentElement&&e.parentElement.removeChild(e)}class UIParclose extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.PARCLOSE}`;opacity=0;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.opacity=numberCast(r.opacity,this.opacity)}present(){const e=createFragment(),t=createElement("div");return t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.PARCLOSE),addStyles(t,{backgroundColor:`rgba(0,0,0,${this.opacity})`,zIndex:""+(this.window.zIndex-2)}),this.bindEvent(t),e.appendChild(t),e}updateZIndex(e){addStyles(this.element,{zIndex:`${e}`})}bindEvent(e){e.addEventListener("mousedown",(e=>{this.window.flicker()}),!0),e.addEventListener("contextmenu",(e=>(e.preventDefault(),e.returnValue=!1,!1)))}}function addTouchStartEvent(e,t,r=!1){e.addEventListener("mousedown",t,r),e.addEventListener("touchstart",t,r)}function addTouchMoveEvent(e,t,r=!1){e.addEventListener("mousemove",t,r),e.addEventListener("touchmove",t,r)}function addTouchEndEvent(e,t,r=!1){e.addEventListener("mouseup",t,r),e.addEventListener("touchend",t,r)}function removeTouchMoveEvent(e,t){e.removeEventListener("mousemove",t),e.removeEventListener("touchmove",t)}function removeTouchEndEvent(e,t){e.removeEventListener("mouseup",t),e.removeEventListener("touchend",t)}class DragEvent{isDragging=!1;isFirstDragging=!0;startX=0;startY=0;touchStartTime=null;constructor(e){addTouchStartEvent(e,this.mousedown)}mousedown=e=>{this.mouseStar(e),this.touchStartTime=new Date,(isMoveEvent(e)&&0===e.button||!isMoveEvent(e)&&e.touches.length>0)&&(this.startX=isMoveEvent(e)?e.pageX:e.touches[0].pageX,this.startY=isMoveEvent(e)?e.pageY:e.touches[0].pageY,!1!==this.dragStart(e,this.startX,this.startY)&&(addTouchMoveEvent(document,this.mousemove),addTouchEndEvent(document,this.mouseup)))};mousemove=e=>{this.mouseMove(e);const t=isMoveEvent(e)?e.pageX:e.touches[0].pageX,r=isMoveEvent(e)?e.pageY:e.touches[0].pageY,n=t-this.startX,i=r-this.startY;(isMoveEvent(e)&&(0!==n||0!==i)||!isMoveEvent(e)&&(new Date).getTime()-this.touchStartTime.getTime()>30)&&(this.isDragging=!0,!0===this.isFirstDragging&&(this.isFirstDragging=!1,this.draggingFirst(e,t,r,n,i)),this.dragging(e,t,r,n,i))};mouseup=e=>{this.mouseEnd(e),removeTouchMoveEvent(document,this.mousemove),removeTouchEndEvent(document,this.mouseup),this.dragEnd(e),this.isFirstDragging=!0,this.isDragging=!1};draggingFirst(e,t,r,n,i){}}class WindowResizeDragEvent extends DragEvent{constructor(e,t,r,n){super(r),this.app=e,this.window=t,this.direction=n}isShowMoreActionButton=!1;_top=0;_left=0;_width=0;_height=0;content=null;dragStart(e,t,r){if(this.window.status!==WindowStatus.NORMAL)return!1;this._top=this.window.top,this._left=this.window.left,this._width=this.window.width,this._height=this.window.height,this.window.event.onresize?.before&&this.window.event.onresize.before(this.window,this.app)}dragging(e,t,r,n,i){switch(this.direction){case Direction.LEFT:this.resizeHandler(n,i,!1,!0,!1,!0);break;case Direction.RIGHT:this.resizeHandler(n,i,!1,!1,!1,!0);break;case Direction.TOP:this.resizeHandler(n,i,!0,!1,!0,!1);break;case Direction.BOTTOM:this.resizeHandler(n,i,!1,!1,!0,!1);break;case Direction.LEFT_TOP:this.resizeHandler(n,i,!0,!0,!1,!1);break;case Direction.RIGHT_TOP:this.resizeHandler(n,i,!0,!1,!1,!1);break;case Direction.LEFT_BOTTOM:this.resizeHandler(n,i,!1,!0,!1,!1);break;case Direction.RIGHT_BOTTOM:this.resizeHandler(n,i,!1,!1,!1,!1)}}dragEnd(e){this.window.top=this._top,this.window.left=this._left,this.window.width=this._width,this.window.height=this._height,this.window.storeStatus&&(this.window.lastStoreStatus={top:this.window.top,left:this.window.left,width:this.window.width,height:this.window.height}),this.app.drayLayer.hide(),this.content&&this.content.showPenetrate(!1),this.window.event.onresize?.after&&this.window.event.onresize.after(this.window,this.app)}resizeHandler(e,t,r,n,i,o){let a=this.window.top+t,s=this.window.left+e,l=n?this.window.width-e:this.window.width+e,c=r?this.window.height-t:this.window.height+t;l=Math.max(l,this.window.minWidth),n?(s=Math.min(s,this.window.left+this.window.width-this.window.minWidth),s=Math.max(0,s),l=Math.min(l,this.window.left+this.window.width)):(s=Math.min(s,this.window.left),s=Math.max(this.window.left,s),l=Math.min(l,innerWidth-this.window.left)),l=Math.min(l,this.window.maxWidth),c=Math.max(c,this.window.minHeight),r?(a=Math.min(a,this.window.top+this.window.height-this.window.minHeight),a=Math.max(0,a),c=Math.min(c,this.window.top+this.window.height)):(a=Math.min(a,this.window.top),a=Math.max(this.window.top,a),c=Math.min(c,innerHeight-this.window.top)),c=Math.min(c,this.window.maxHeight),i&&(this._top=a,this._height=c,addStyles(this.window.element,{top:`${a}px`,height:`${c}px`})),o&&(this._width=l,this._left=s,addStyles(this.window.element,{width:`${l}px`,left:`${s}px`}),this.updateActionButton(l)),!1===o&&!1===i&&(this._top=a,this._left=s,this._width=l,this._height=c,addStyles(this.window.element,{top:`${a}px`,left:`${s}px`,height:`${c}px`,width:`${l}px`})),this.updateActionButton(i?this.window.width:l),this.window.event.onresize?.progress&&this.window.event.onresize.progress(this.window,this.app)}updateActionButton(e){if(e<=300){if(!1!==this.isShowMoreActionButton)return;this.isShowMoreActionButton=!0,this.window.zoomActionButtons(e)}else{if(!0!==this.isShowMoreActionButton)return;this.isShowMoreActionButton=!1,this.window.zoomActionButtons(e)}}mouseStar(e){this.app.drayLayer.updateZIndex(this.window.zIndex-1),this.content=this.window.getComponent(ComponentType.CONTENT_CONTAINER),this.content&&this.content.showPenetrate()}mouseMove(e){e.preventDefault()}mouseEnd(e){}}class UIResizeBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.RESIZE_BAR}`;left=!0;right=!0;top=!0;bottom=!0;leftTop=!0;rightTop=!0;leftBottom=!0;rightBottom=!0;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.left=booleanCast(r.left,this.left),this.right=booleanCast(r.right,this.right),this.top=booleanCast(r.top,this.top),this.bottom=booleanCast(r.bottom,this.bottom),this.leftTop=booleanCast(r.leftTop,this.leftTop),this.rightTop=booleanCast(r.rightTop,this.rightTop),this.leftBottom=booleanCast(r.leftBottom,this.leftBottom),this.rightBottom=booleanCast(r.rightBottom,this.rightBottom)}present(){const e=createFragment();if(this.leastOneTrue()){const t=createElement("div");t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.RESIZE_BAR),this.bindEvent(t);for(const e of this.directions)!0===this[getCamelCase(e)]&&t.appendChild(this.presentItem(e));e.appendChild(t)}return e}presentItem(e){const t=document.createElement("div");return t.setAttribute("data-window-id",this.window.id),addClasses(t,this.app.prefix,`resize-item-${e}`),new WindowResizeDragEvent(this.app,this.window,t,e),t}bindEvent(e){e.addEventListener("contextmenu",(e=>(e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1)))}directions=[Direction.LEFT,Direction.RIGHT,Direction.TOP,Direction.BOTTOM,Direction.LEFT_TOP,Direction.RIGHT_TOP,Direction.LEFT_BOTTOM,Direction.RIGHT_BOTTOM];leastOneTrue(){let e=!1;for(const t of this.directions)if(!0===this[getCamelCase(t)]){e=!0;break}return e}}class WindowMoveDragEvent extends DragEvent{constructor(e,t,r,n){super(r),this.app=e,this.window=t,this.dragMoveOptions=n}emerge=10;_top=0;_left=0;_originTop=0;_originLeft=0;_lastTime=null;content=null;dragStart(e,t,r){this._top=this.window.top,this._left=this.window.left,this.window.event.onmove?.before&&this.window.event.onmove.before(this.window,this.app)}dragging(e,t,r,n,i){this.moveHandler(n,i),this.window.event.onmove?.progress&&this.window.event.onmove.progress(this.window,this.app)}dragEnd(e){if(1==this.isDragging&&0===this._top)return this.window.max(),this.window.top=this._originTop,void(this.window.left=this._originLeft);this.window.top=this._top,this.window.left=this._left,this.window.storeStatus&&(this.window.lastStoreStatus={top:this.window.top,left:this.window.left,width:this.window.width,height:this.window.height}),this.app.drayLayer.hide(),this.content&&this.content.showPenetrate(!1),this.window.event.onmove?.after&&this.window.event.onmove.after(this.window,this.app)}moveHandler(e,t){let r=this.window.top,n=this.window.left;this.dragMoveOptions.vertical&&(r+=t,r=Math.max(0,r),r=this.dragMoveOptions.breakBottom?Math.min(innerHeight-this.emerge,r):Math.min(innerHeight-this.window.height,r),this._top=r),this.dragMoveOptions.horizontal&&(n+=e,n=this.dragMoveOptions.breakLeft?Math.max(this.emerge-this.window.width,n):Math.max(0,n),n=this.dragMoveOptions.breakRight?Math.min(innerWidth-this.emerge,n):Math.min(innerWidth-this.window.width,n),this._left=n),addStyles(this.window.element,{top:`${r}px`,left:`${n}px`})}draggingFirst(e,t,r,n,i){this._originTop=this.window.top,this._originLeft=this.window.left,this.window.status===WindowStatus.MAX&&(t<this.window.width/2?this._left=0:t>this.window.width/2&&t<innerWidth-this.window.width?this._left=t-this.window.width/2:innerWidth-t<this.window.width/2?this._left=innerWidth-this.window.width:innerWidth-t>this.window.width/2&&t>=innerWidth-this.window.width&&(this._left=t-this.window.width/2),this.window.top=i,this.window.left=this._left,this.window.normal(!0))}mouseStar(e){this.app.drayLayer.updateZIndex(this.window.zIndex-1),this.content=this.window.getComponent(ComponentType.CONTENT_CONTAINER),this.content&&this.content.showPenetrate()}mouseMove(e){e.preventDefault()}mouseEnd(e){}}class UIIcon extends UIComponent{name;className=`${this.app.prefix+ComponentType.ICON}`;constructor(e,t){super(e),this.name=stringCast(t)}present(){const e=createFragment(),t=createElementNS("svg");t.setAttribute("class",this.className);const r=createElementNS("use");return r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",`#${this.name}`),t.appendChild(r),e.appendChild(t),e}}const _UIContextMenuButton=class e extends UIWindowComponent{constructor(e,t,r,n=0){super(e,t),this.index=n,this.id=stringCast(r.id),this.label=stringCast(r.label),this.handler=r.handler,this.items=contextMenuButtonsCast(r.items)}id;label;handler;items;present(){const t=createFragment(),r=createElement("div");r.setAttribute("data-window-id",this.window.id),r.setAttribute("data-index",`${this.index}`),addClasses(r,this.app.prefix,ComponentType.CONTEXT_MENU_BUTTON,"flexbox","flex-row"),addStyles(r,{height:`${e.height}px`,lineHeight:`${e.height}px`}),r.addEventListener("mousedown",(e=>{e.stopPropagation(),0===e.button&&"function"==typeof this.handler&&this.handler(e,this.window)}));const n=createElement("label");if(n.setAttribute("data-window-id",this.window.id),n.innerText=this.label,addClasses(n,this.app.prefix,`${ComponentType.CONTEXT_MENU_BUTTON}-label`,"flex-item"),r.appendChild(n),!1!==this.items){const e=new UIContextMenuBar(this.app,this.window,`${this.id}`,this.items,!1),t=e.present();r.appendChild(t);const i=n.nextElementSibling;let o;r.addEventListener("mouseenter",(t=>{o=setTimeout((()=>{e.updateChildrenOffset(t,i,this.index)}),200)})),r.addEventListener("mouseleave",(t=>{clearTimeout(o),e.hideChildren(i)})),this.setComponent(ComponentType.CONTEXT_MENU_BAR,e);const a=createElement("div");a.setAttribute("data-window-id",this.window.id),addClasses(a,this.app.prefix,"context-menu-more","flexbox","flex-center");const s=new UIIcon(this.app,"right").present();a.appendChild(s),r.appendChild(a)}return t.appendChild(r),t}};__publicField(_UIContextMenuButton,"height",30);let UIContextMenuButton=_UIContextMenuButton;const _UIContextMenuBar=class e extends UIWindowComponent{constructor(e,t,r,n,i=!0){super(e,t),this.isTopMenu=i,this.contextMenuButtons=contextMenuButtonsCast(n),this.uniqueId=stringCast(r),this.elementId=`${this.window.elementId}-${this.uniqueId}-${ComponentType.CONTEXT_MENU_BAR}`}elementId;uniqueId;contextMenuButtons=!1;_element=null;get element(){return document.getElementById(`${this.elementId}`)}present(){const e=createFragment();if(!1!==this.contextMenuButtons&&this.contextMenuButtons.length>0){const t=createElement("div");t.setAttribute("data-window-id",this.window.id),this.isTopMenu&&(t.id=this.elementId),addClasses(t,this.app.prefix,ComponentType.CONTEXT_MENU_BAR),t.addEventListener("contextmenu",(e=>(e.preventDefault(),e.returnValue=!1,!1)),!0),this.createContextMenuButtons(t),e.appendChild(t)}return e}hide(){this.isTopMenu&&removeClasses(this.element,this.app.prefix,"context-menu-bar-active")}updateOffset(e,t,r,n){if(!this.isTopMenu||!this.element||!1===this.contextMenuButtons||0===this.contextMenuButtons.length)return;const i=getComputedStyle(this.element),o=Number(i.width.replace("px","")),a=this.contextMenuButtons.length*UIContextMenuButton.height,s=e.pageX,l=e.pageY;let c=s,u=l;void 0!==r?c=r:o+s>innerWidth&&(c=s-o),void 0!==n?u=n:a+l>innerHeight&&(u=l-a),addClasses(this.element,this.app.prefix,"context-menu-bar-active"),addStyles(this.element,{zIndex:`${t}`,top:`${u}px`,left:`${c}px`})}updateChildrenOffset(t,r,n){if(this.isTopMenu||!r||!r.parentElement||!r.parentElement.parentElement)return;const i=r.parentElement.parentElement,o=getComputedStyle(i),a=Number(o.width.replace("px","")),s=Number(o.left.replace("px","")),l=Number(o.top.replace("px","")),c=getComputedStyle(r),u=Number(c.width.replace("px","")),h=r.childElementCount*UIContextMenuButton.height,d=UIContextMenuButton.height*n;let p=a+s-e.offset,f=l+d-e.offset;a+s+u>innerWidth&&(p=s-u+e.offset),l+d+h>innerHeight&&(f=innerHeight-h-e.offset),addClasses(r,this.app.prefix,"context-menu-bar-active"),addStyles(r,{top:`${f}px`,left:`${p}px`})}hideChildren(e){this.isTopMenu||removeClasses(e,this.app.prefix,"context-menu-bar-active")}createContextMenuButtons(e){if(!1===this.contextMenuButtons)return;const t=Array();let r=0;for(const n of this.contextMenuButtons){const i=new UIContextMenuButton(this.app,this.window,n,r),o=i.present();e.appendChild(o),t.push(i),r++}this.setComponent(ComponentType.CONTEXT_MENU_BUTTONS,t)}};__publicField(_UIContextMenuBar,"offset",4);let UIContextMenuBar=_UIContextMenuBar;const _UIActionButton=class e extends UIWindowComponent{elementId;id;label;handler;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.id=stringCast(r.id),this.label=stringCast(r.label),this.handler=r.handler,this.elementId=`${this.window.elementId}-${ComponentType.ACTION_BUTTON}-${this.id}`}present(){const t=createFragment(),r=createElement("div");r.setAttribute("data-window-id",this.window.id),r.id=this.elementId,r.setAttribute("title",this.label),addClasses(r,this.app.prefix,ComponentType.ACTION_BUTTON,"destroy"===this.id?`${ComponentType.ACTION_BUTTON}-destroy`:"","flexbox","flex-center"),addStyles(r,{width:`${e.width}px`}),r.addEventListener("mousedown",(e=>{0===e.button&&"function"==typeof this.handler&&this.handler(e,this.window)}),!0),r.addEventListener("dblclick",(e=>{e.stopPropagation()}));const n=new UIIcon(this.app,this.id),i=n.present();return r.appendChild(i),this.setComponent(ComponentType.ACTION_BUTTON,n),t.appendChild(r),t}};__publicField(_UIActionButton,"width",45),__publicField(_UIActionButton,"destroy",{id:"destroy",label:"",handler:function(e,t){t.destroy()}}),__publicField(_UIActionButton,"max",{id:"max",label:"",handler:function(e,t){t.max()}}),__publicField(_UIActionButton,"restore",{id:"restore",label:"",handler:function(e,t){t.normal()}}),__publicField(_UIActionButton,"min",{id:"min",label:"",handler:function(e,t){t.min()}}),__publicField(_UIActionButton,"about",{id:"about",label:"",handler:function(e,t){}}),__publicField(_UIActionButton,"refresh",{id:"refresh",label:"",handler:function(e,t){const r=t.getComponent(`${ComponentType.CONTENT_CONTAINER}`);r&&r.refreshContent()}}),__publicField(_UIActionButton,"more",{id:"more",label:"",handler:function(e,t){}});let UIActionButton=_UIActionButton;const _UIActionBar=class e extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.ACTION_BAR}`;enable=!0;items=[UIActionButton.refresh,UIActionButton.min,UIActionButton.max,UIActionButton.destroy];_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.enable=booleanCast(r.enable,this.enable),this.items=actionButtonsCast(r.actionButtons,this.items)}present(){const e=createFragment();if(!0===this.enable){const t=createElement("div");t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.ACTION_BAR,"flexbox","flex-row"),t.addEventListener("mousedown",(e=>{e.preventDefault(),e.stopPropagation()})),t.addEventListener("contextmenu",(e=>(e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1)),!0),this.createActionButtons(t),e.appendChild(t)}return e}zoomActionButtons(t){if(!1===this.items)return;let r=t<=e.actionButtonZoomWidth;const n=this.getComponent(ComponentType.ACTION_BUTTONS);if(!n)return;let[i,...o]=[...n].reverse(),a=Array();o=o.reverse();for(const e of o)r?addClasses(e.element,this.app.prefix,"action-button-hidden"):removeClasses(e.element,this.app.prefix,"action-button-hidden"),a.push(e);const s=new UIActionButton(this.app,this.window,UIActionButton.more);if(r){if(!s.element){const e=new UIContextMenuBar(this.app,this.window,"more-action",a),t=e.present();document.body.appendChild(t),s.handler=function(t,r){e.updateOffset(t,this.window.zIndex+1)};const r=s.present();r.firstElementChild&&i.element.insertAdjacentElement("beforebegin",r.firstElementChild),this.window.setComponent(ComponentType.MORE_ACTION_CONTEXT_MENU_BAR,e)}}else s.element&&(this.window.removeMoreActionContextMenu(),s.element&&s.element.parentElement.removeChild(s.element),this.window.removeComponent(ComponentType.MORE_ACTION_CONTEXT_MENU_BAR))}createActionButtons(e){if(!1===this.items)return;const t=Array();for(const r of this.items){const n=new UIActionButton(this.app,this.window,r),i=n.present();e.appendChild(i),t.push(n)}this.setComponent(ComponentType.ACTION_BUTTONS,t)}};__publicField(_UIActionBar,"actionButtonZoomWidth",300);let UIActionBar=_UIActionBar;class UITitleBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.TITLE_BAR}`;icon="icon";title=void 0;useSubTitle=!1;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.icon=typeOrBooleanCast(r.icon,this.icon),this.title=r.title,this.useSubTitle=booleanCast(r.useSubTitle,this.useSubTitle)}present(){const e=createFragment(),t=createElement("div");if(t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.TITLE_BAR,"flexbox","flex-row","flex-vertical-center"),this.icon){const e=createElement("div");e.setAttribute("data-window-id",this.window.id),addClasses(e,this.app.prefix,"window-icon","flexbox","flex-center"),e.addEventListener("dblclick",(e=>{e.stopPropagation(),this.window.destroy()})),t.appendChild(e);const r=new UIIcon(this.app,this.icon),n=r.present();e.appendChild(n),this.setComponent(ComponentType.WINDOW_ICON,r)}if(this.title||this.useSubTitle){const e=createElement("div");e.setAttribute("data-window-id",this.window.id),addClasses(e,this.app.prefix,"window-title");const r=document.createElement("label");r.setAttribute("data-window-id",this.window.id),addClasses(r,this.app.prefix,"window-title-label"),this.title&&(r.innerText=this.title,r.setAttribute("title",this.title)),e.appendChild(r),t.appendChild(e)}return e.appendChild(t),e}updateTitle(e){const t=this.element;if(!t)return;const r=t.querySelector(`.${this.app.prefix}window-title-label`);if(r){if(r.innerText=e,r.setAttribute("title",e),this.app.salver&&this.app.salver.element){const t=this.app.salver.element.querySelector(`.${this.app.prefix}salver-button[data-window-id='${this.window.id}']`);t&&t.setAttribute("title",e)}this.title=e}}}class UITabBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.TAB_BAR}`;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t)}present(){const e=createFragment(),t=createElement("div");return t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.TAB_BAR,"flexbox","flex-item","flex-row"),e.appendChild(t),e}}class UIToolBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.TOOL_BAR}`;height=30;drag={vertical:!0,horizontal:!0,breakLeft:!0,breakRight:!0,breakTop:!0,breakBottom:!0};titleBar={};tabBar={};actionBar={};background="#ffffff";_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.height=numberCast(r.height,this.height),this.drag=jsonOrBooleanCast(r.drag,this.drag),this.titleBar=jsonOrBooleanCast(r.titleBar,this.titleBar),this.tabBar=jsonOrBooleanCast(r.tabBar,this.tabBar),this.actionBar=jsonOrBooleanCast(r.actionBar,this.actionBar),this.background=stringOrBooleanStyleCast(r.background,this.background)}present(){const e=createFragment(),t=createElement("div");if(t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.TOOL_BAR,"flexbox","flex-row"),addStyles(t,{height:`${this.height}px`,background:this.background}),t.addEventListener("dblclick",(e=>{this.window.status!==WindowStatus.MAX?this.window.status!==WindowStatus.NORMAL||this.window.max():this.window.normal()})),!1!==this.titleBar){const e=new UITitleBar(this.app,this.window,this.titleBar),r=e.present();t.appendChild(r),this.setComponent(ComponentType.TITLE_BAR,e)}if(!1!==this.tabBar){const e=new UITabBar(this.app,this.window,this.tabBar),r=e.present();t.appendChild(r),this.setComponent(ComponentType.TAB_BAR,e)}if(!1!==this.actionBar){const e=new UIActionBar(this.app,this.window,this.actionBar),r=e.present();r&&t.appendChild(r),this.setComponent(ComponentType.ACTION_BAR,e)}return!this.drag||!0!==this.drag.vertical&&!0!==this.drag.horizontal||new WindowMoveDragEvent(this.app,this.window,t,this.drag),e.appendChild(t),e}}class UITopMenuButton extends UIWindowComponent{constructor(e,t,r,n){super(e,t),this.topMenuBar=r,this.id=stringCast(n.id),this.label=stringCast(n.label),this.handler=n.handler,this.items=contextMenuButtonsCast(n.items)}id;label;handler;items;present(){const e=createFragment(),t=createElement("div");t.setAttribute("data-window-id",this.window.id),addClasses(t,this.app.prefix,ComponentType.TOP_MENU_BUTTON);const r=createElement("label");if(r.setAttribute("data-window-id",this.window.id),r.innerText=this.label,addClasses(r,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-label"),t.appendChild(r),!1!==this.items){const e=new UIContextMenuBar(this.app,this.window,`top-menu-${this.id}`,this.items),t=e.present();document.body.appendChild(t),this.setComponent(ComponentType.CONTEXT_MENU_BAR,e)}return this.bindEvent(t),e.appendChild(t),e}bindEvent(e){e.addEventListener("mousedown",(t=>{this.topMenuBar.currentTopMenuButtonElement&&removeClasses(this.topMenuBar.currentTopMenuButtonElement,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active"),this.topMenuBar.currentTopMenuContextBar&&this.topMenuBar.currentTopMenuContextBar.hide();const r=this.getComponent(ComponentType.CONTEXT_MENU_BAR);if(this.topMenuBar.isActive){if(addClasses(e,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active"),r&&r.element){const n=e.getBoundingClientRect();r.updateOffset(t,this.window.zIndex+1,n.left,n.top+25)}}else removeClasses(e,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active"),r&&r.hide();this.topMenuBar.currentTopMenuContextBar=r,this.topMenuBar.currentTopMenuButtonElement=e})),e.addEventListener("mouseenter",(t=>{if(this.topMenuBar.isActive){this.topMenuBar.currentTopMenuButtonElement&&removeClasses(this.topMenuBar.currentTopMenuButtonElement,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active"),this.topMenuBar.currentTopMenuContextBar&&this.topMenuBar.currentTopMenuContextBar.hide(),addClasses(e,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active");const r=this.getComponent(ComponentType.CONTEXT_MENU_BAR);if(r&&r.element){const n=e.getBoundingClientRect();r.updateOffset(t,this.window.zIndex+1,n.left,n.top+25)}this.topMenuBar.currentTopMenuContextBar=r,this.topMenuBar.currentTopMenuButtonElement=e}}))}}class UITopMenuBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.TOP_MENU_BAR}`;isActive=!1;currentTopMenuContextBar=null;currentTopMenuButtonElement=null;contextMenuButtons=!1;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.contextMenuButtons=contextMenuButtonsCast(r)}present(){const e=createFragment();if(!1!==this.contextMenuButtons&&this.contextMenuButtons.length>0){const t=createElement("div");t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.TOP_MENU_BAR),t.addEventListener("contextmenu",(e=>(e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1)),!0),this.createTopMenuButtons(t),e.appendChild(t)}return e}hide(e){this.currentTopMenuButtonElement&&removeClasses(this.currentTopMenuButtonElement,this.app.prefix,ComponentType.TOP_MENU_BUTTON+"-active"),this.currentTopMenuContextBar&&this.currentTopMenuContextBar.hide();const t=e.target;this.isActive=t.className.indexOf(`${this.app.prefix+ComponentType.TOP_MENU_BUTTON}`)>-1&&t.getAttribute("data-window-id")===this.window.id&&!this.isActive,this.currentTopMenuContextBar=null,this.currentTopMenuButtonElement=null}createTopMenuButtons(e){if(!1===this.contextMenuButtons)return;const t=Array();for(const r of this.contextMenuButtons){const n=new UITopMenuButton(this.app,this.window,this,r),i=n.present();e.appendChild(i),t.push(n)}this.setComponent(ComponentType.TOP_MENU_BUTTONS,t)}}const _UISalverButton=class e extends UIComponent{elementId;windowId;_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t){super(e),this.windowId=stringCast(t),this.elementId=`${this.app.prefix+t}-${ComponentType.SALVER_BUTTON}`}present(){const t=createFragment(),r=createElement("div");r.id=this.elementId,r.setAttribute("data-window-id",this.windowId),addClasses(r,this.app.prefix,ComponentType.SALVER_BUTTON,"flexbox","flex-center",`${ComponentType.SALVER_BUTTON}-active`),addStyles(r,{width:`${e.size}px`,height:`${e.size}px`});const n=this.app.getWindow(this.windowId);r.addEventListener("mousedown",(e=>{if(n&&this.app.salver&&this.app.salver.element)if(this.app.salver.parsecloseCount>0){const e=this.app.salver.element.querySelector(`.${this.app.prefix+ComponentType.SALVER_BUTTON}.${this.app.prefix+ComponentType.SALVER_BUTTON}-active`);if(e){const t=this.app.getWindow(e.getAttribute("data-window-id"));t&&t.flicker()}}else n===this.app.window&&n.status!==WindowStatus.MIN?n.min():n.updateZIndex()}));const i=n.getComponent(`\n            ${ComponentType.TOOL_BAR}\n            /${ComponentType.TITLE_BAR}`);let o="",a=new UIIcon(this.app,"icon");if(i){o=i.title||o;let e=i.getComponent(`${ComponentType.WINDOW_ICON}`);e&&(a=e)}return r.setAttribute("title",o),r.appendChild(a.present()),t.appendChild(r),t}};__publicField(_UISalverButton,"size",50),__publicField(_UISalverButton,"talentHeight",5);let UISalverButton=_UISalverButton;class UISalverBar extends UIComponent{elementId=`${this.app.prefix+ComponentType.SALVER_BAR}`;parsecloseCount=0;_element=null;get element(){return document.getElementById(`${this.elementId}`)}_items=[];get items(){return this._items}set items(e){this._items=e}constructor(e){super(e)}present(){const e=createFragment(),t=createElement("div");return t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.SALVER_BAR,"animate-d3s","flexbox","flex-row"),addStyles(t,{zIndex:`${this.app.salverZIndex}`,height:`${UISalverButton.size}px`,bottom:`-${UISalverButton.size-UISalverButton.talentHeight}px`}),e.appendChild(t),e}addOrUpdateItem(){const e=this.element;if(!this.app.window||!e)return;const t=this.app.lastWindow;t&&removeClasses(new UISalverButton(this.app,t.id).element,this.app.prefix,"salver-button-active");const r=this.app.window.id,n=new UISalverButton(this.app,r);if(-1===this.items.indexOf(r)){const t=n.present();e.appendChild(t),this.items.push(r),this.updateOffset()}else addClasses(n.element,this.app.prefix,"salver-button-active")}removeItem(){const e=this.element;if(!this.app.window||!e)return;const t=this.app.window.id;removeElement(new UISalverButton(this.app,t).element);const r=this.items.indexOf(t);this.items.splice(r,1),this.updateOffset()}updateOffset(){const e=this.element;if(!e)return;const t=this.items.length*UISalverButton.size;addStyles(e,{left:(innerWidth-t)/2+"px"})}show(e=!0){e?(removeClasses(this.element,this.app.prefix,"animate-salver-slide-down"),addClasses(this.element,this.app.prefix,"animate-salver-slide-up","salver-bar-keep")):(removeClasses(this.element,this.app.prefix,"animate-salver-slide-up","salver-bar-keep"),addClasses(this.element,this.app.prefix,"animate-salver-slide-down"))}}class UIHtmlContent extends UIWindowComponent{constructor(e,t,r){super(e,t),this.content=r}present(){const e=createFragment(),t=createElement("div");if(addClasses(t,this.app.prefix,ComponentType.HTML_CONTENT),isElement(this.content)){const e=this.content.cloneNode(!0);addStyles(e,{display:"inherit"}),t.appendChild(e)}else t.innerHTML=this.content;return e.appendChild(t),e}}class UIFrameContent extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.URL_CONTENT}`;url;_element=null;get element(){return document.getElementById(`${this.elementId}`)}_contentWindow=null;get contentWindow(){const e=document.getElementById(`${this.elementId}`);return e?e.contentWindow:null}constructor(e,t,r){super(e,t),this.url=stringCast(r)}present(){const e=createFragment(),t=createElement("iframe");return t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,t.setAttribute("frameborder","0"),t.setAttribute("scrolling","no"),t.setAttribute("allowtransparency","true"),t.src=this.url,addClasses(t,this.app.prefix,ComponentType.URL_CONTENT),this.bindEvent(t),e.appendChild(t),e}bindEvent(e){e.addEventListener("load",(t=>{const r=e.contentWindow;if(!r)return;const n=this.window.getComponent(`\n            ${ComponentType.TOOL_BAR}\n            /${ComponentType.TITLE_BAR}`);if(n&&n.useSubTitle){const e=r.document.querySelector("title");e&&n.updateTitle(e.innerText||"")}!1!==this.window.contextMenu&&r.document.addEventListener("contextmenu",(e=>{e.preventDefault(),e.returnValue=!1;const t=document.createEvent("Event");t.initEvent("contextmenu",!0),this.window.element.dispatchEvent(t);const r=this.element.getBoundingClientRect(),n=this.window.getComponent(`${ComponentType.CONTEXT_MENU_BAR}`);return n&&n.updateOffset(e,this.window.zIndex+1,e.pageX+r.left,e.pageY+r.top),!1})),r.document.addEventListener("mousedown",this.mousedown),addTouchMoveEvent(r.document,this.mousemove)}))}mousedown=e=>{const t=document.createEvent("Event");t.initEvent("mousedown",!0),this.window.element.dispatchEvent(t)};mousemove=e=>{const t=this.element.getBoundingClientRect(),r=(isMoveEvent(e)?e.pageY:e.touches[0].pageY)+t.top;if(this.app.salver&&this.app.salver.element)if(r>=parent.innerHeight-50){if(containClass(this.app.salver.element,this.app.prefix,"salver-bar-keep"))return;this.app.salver.show()}else{if(!containClass(this.app.salver.element,this.app.prefix,"salver-bar-keep"))return;this.app.salver.show(!1)}}}class UIContent extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.CONTENT_CONTAINER}`;type=WindowContentType.HTML;value="";_element=null;get element(){return document.getElementById(`${this.elementId}`)}_penetrateElement=null;get penetrateElement(){const e=this.element;return e?e.querySelector(`.${this.app.prefix+ComponentType.CONTENT_PENETRATE}`):null}constructor(e,t,r){super(e,t),this.type=contentTypeCast(r.type,this.type),this.value=stringOrElementCast(r.value)}present(){const e=createFragment(),t=createElement("div");t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.CONTENT_CONTAINER,`${ComponentType.CONTENT_CONTAINER}-fade-out`,"flex-item"),addClasses(t,this.app.prefix,ComponentType.CONTENT_CONTAINER);const r=createElement("div");switch(addClasses(r,this.app.prefix,ComponentType.CONTENT_PENETRATE),t.appendChild(r),this.type){case WindowContentType.HTML:const e=new UIHtmlContent(this.app,this.window,this.value),r=e.present();t.appendChild(r),this.setComponent(ComponentType.CONTENT,e);break;case WindowContentType.LOCAL_URL:const n=new UIFrameContent(this.app,this.window,this.value),i=n.present();t.appendChild(i),this.setComponent(ComponentType.CONTENT,n)}return e.appendChild(t),e}showPenetrate(e=!0){e?addClasses(this.penetrateElement,this.app.prefix,`${ComponentType.CONTENT_PENETRATE}-active`):removeClasses(this.penetrateElement,this.app.prefix,`${ComponentType.CONTENT_PENETRATE}-active`)}refreshContent(){if(this.type===WindowContentType.LOCAL_URL){const e=this.window.getComponent(`\n            ${ComponentType.CONTENT_CONTAINER}\n            /${ComponentType.CONTENT}`);e&&e.contentWindow&&e.contentWindow.location.reload()}}}class UIStatuBar extends UIWindowComponent{elementId=`${this.window.elementId}-${ComponentType.STATU_BAR}`;height=30;background="#e5e5e5";content="";_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e,t,r){super(e,t),this.height=numberCast(r.height,this.height),this.background=stringOrBooleanStyleCast(r.background,this.background),this.content=stringOrElementCast(r.content)}present(){const e=createFragment(),t=createElement("div");if(t.setAttribute("data-window-id",this.window.id),t.id=this.elementId,addClasses(t,this.app.prefix,ComponentType.STATU_BAR),addStyles(t,{height:`${this.height}px`,background:`${this.background}`}),isElement(this.content)){const e=this.content.cloneNode(!0);addStyles(e,{display:"inherit"}),t.appendChild(e)}else t.innerHTML=this.content;return e.appendChild(t),e}}class UIWindow extends UIComponent{elementId;zIndex=this.app.zIndex;enableAnimated=!1;status="normal";lastStatus="none";flickering=!1;defaultEvent={onload:{before:function(e){},after:function(e){}},onmin:{before:function(e){},after:function(e){}},onmax:{before:function(e){},after:function(e){}},onrestore:{before:function(e){},after:function(e){}},ondestroy:{before:function(e){},after:function(){}},onvisual:{before:function(e){},after:function(e){}},onmove:{before:function(e){},progress:function(e){},after:function(e){}},onresize:{before:function(e){},progress:function(e){},after:function(e){}},onfocus:function(e){},onexist:function(e){},onswitch:{before:function(e){},after:function(e){}},onstick:{before:function(e){},after:function(e){}}};id;width=800;height=600;maxWidth=innerWidth;maxHeight=innerHeight;minWidth=200;minHeight=200;left;top;background="#ffffff";shadow="rgba(0, 0, 0, 0.3) 1px 1px 24px";parclose=!1;mode="layer";border=null;borderRadius=null;animate="zoom";resizeBar={};toolBar={};contextMenu=!1;topMenu=!1;content={};statuBar=!1;storeStatus=!0;event=this.defaultEvent;_element=null;get element(){return document.getElementById(this.elementId)}_flickerShadow=null;get flickerShadow(){return this.getFlickerShadow()}_lastStoreStatus=null;get lastStoreStatus(){const storeStatus=localStorage.getItem(this.app.prefix+this.id);return storeStatus?eval("("+storeStatus+")"):null}set lastStoreStatus(e){localStorage.setItem(this.app.prefix+this.id,JSON.stringify(e))}constructor(e,t){super(e),isStringWithNotEmpty(t.id)||assertId(),this.id=t.id,this.elementId=this.app.prefix+this.id,this.event=t.event?{...this.defaultEvent,...t.event}:this.defaultEvent,this.mode=windowModeCast(t.mode,this.mode),this.width=numberCast(t.width,this.width),this.height=numberCast(t.height,this.height),this.maxWidth=Math.min(numberCast(t.maxWidth,this.maxWidth),this.maxWidth),this.maxHeight=Math.min(numberCast(t.maxHeight,this.maxHeight),this.maxHeight),this.minWidth=Math.max(numberCast(t.minWidth,this.minWidth),this.minWidth),this.minHeight=Math.max(numberCast(t.minHeight,this.minHeight),this.minHeight),this.width=Math.max(this.minWidth,this.width),this.width=Math.min(this.maxWidth,this.width),this.height=Math.max(this.minHeight,this.height),this.height=Math.min(this.maxHeight,this.height),[this.left,this.top]=offsetCast(t.offset,this.width,this.height),this.background=stringOrBooleanStyleCast(t.background,this.background),this.shadow=stringOrBooleanStyleCast(t.shadow,this.shadow),this.parclose=typeOrBooleanCast(t.parclose,this.parclose,0),[this.border,this.borderRadius]=borderCast(t.border,{width:1,style:"solid",color:"#3baced",radius:4}),this.animate=windowAnimateCast(t.animate,this.animate),this.enableAnimated="none"!==this.animate,this.resizeBar=jsonOrBooleanCast(t.resizeBar,this.resizeBar),this.toolBar=jsonOrBooleanCast(t.toolBar,this.toolBar),this.contextMenu=contextMenuButtonsCast(t.contextMenu),this.topMenu=contextMenuButtonsCast(t.topMenu),this.content=jsonOrBooleanCast(t.content,this.content),this.statuBar=jsonOrBooleanCast(t.statuBar,this.statuBar),this.storeStatus=booleanCast(t.storeStatus,this.storeStatus),t.title&&this.toolBar&&(this.toolBar.titleBar?this.toolBar.titleBar.title=t.title:this.toolBar.titleBar={title:t.title})}present(){const e=createFragment(),t=createElement("div");if(t.id=this.elementId,t.setAttribute("data-window-id",this.id),addClasses(t,this.app.prefix,"window",`window-${this.mode}`,"flexbox","flex-column",this.enableAnimated?"animate":"",this.enableAnimated?`animate-${this.animate}-show`:""),this.readStoreStatus(),this.event.onload?.before&&this.event.onload.before(this),addStyles(t,{zIndex:"layer"===this.mode?`${this.zIndex}`:null,maxWidth:`${this.maxWidth}px`,maxHeight:`${this.maxHeight}px`,minWidth:`${this.minWidth}px`,minHeight:`${this.minHeight}px`,width:`${this.width}px`,height:`${this.height}px`,top:"layer"===this.mode?`${this.top}px`:null,left:"layer"===this.mode?`${this.left}px`:null,background:this.background,border:this.border,borderRadius:this.borderRadius,webkitBorderRadius:this.borderRadius,boxShadow:this.shadow,webkitBoxShadow:this.shadow}),t.addEventListener("mousedown",(e=>{this.updateZIndex()}),!0),!1!==this.toolBar){const e=new UIToolBar(this.app,this,this.toolBar),r=e.present();t.appendChild(r),this.setComponent("tool-bar",e)}if(!1!==this.topMenu){const e=new UITopMenuBar(this.app,this,this.topMenu),r=e.present();t.appendChild(r),this.setComponent("top-menu-bar",e)}if(!1!==this.content){const e=new UIContent(this.app,this,this.content),r=e.present();t.appendChild(r),this.setComponent("content-container",e)}if(!1!==this.resizeBar){const e=new UIResizeBar(this.app,this,this.resizeBar),r=e.present();t.appendChild(r),this.setComponent("resize-bar",e)}if(!1!==this.statuBar){const e=new UIStatuBar(this.app,this,this.statuBar),r=e.present();t.appendChild(r),this.setComponent("statu-bar",e)}if(!1!==this.parclose){const t=new UIParclose(this.app,this,{opacity:this.parclose}),r=t.present();e.appendChild(r),this.setComponent("parclose",t),this.app.salver&&this.app.salver.parsecloseCount++}if(!1!==this.contextMenu){const t=new UIContextMenuBar(this.app,this,"window",this.contextMenu),r=t.present();e.appendChild(r),this.setComponent("context-menu-bar",t)}if(this.bindEvent(t),!this.app.salver){const t=new UISalverBar(this.app),r=t.present();e.appendChild(r),this.app.salver=t}return e.appendChild(t),e}readStoreStatus(){const e=this.lastStoreStatus;this.storeStatus&&(e?(this.width=e.width,this.height=e.height,this.top=e.top,this.left=e.left):this.lastStoreStatus={top:this.top,left:this.left,width:this.width,height:this.height})}handlerContentByAnimate(e=!0){const t=this.getComponent("content-container");t&&(e?addClasses(t.element,this.app.prefix,"content-container-fade-out"):removeClasses(t.element,this.app.prefix,"content-container-fade-out"))}bindEvent(e){!1!==this.contextMenu&&e.addEventListener("contextmenu",(e=>{e.preventDefault(),e.returnValue=!1;const t=this.getComponent("context-menu-bar");return t&&t.updateOffset(e,this.zIndex+1),!1})),e.addEventListener("animationstart",(e=>{this.handlerContentByAnimate()})),e.addEventListener("animationend",(e=>{const t=this.element;removeClasses(t,this.app.prefix,`animate-${this.animate}-show`,`animate-${this.animate}-drag-to-normal`),containClass(t,this.app.prefix,`animate-${this.animate}-destroy`)&&this.remove(),containClass(t,this.app.prefix,`animate-${this.animate}-to-min`)&&this.minimize(),this.handlerContentByAnimate(!1)})),e.addEventListener("transitionend",(e=>{removeClasses(this.element,this.app.prefix,`animate-${this.animate}-to-max`,`animate-${this.animate}-to-normal`),this.handlerContentByAnimate(!1)}))}destroy(){this.enableAnimated?addClasses(this.element,this.app.prefix,`animate-${this.animate}-destroy`):this.remove()}remove(){"max"===this.status&&removeClasses(document.body,`z${this.app.prefix}`,"body-noscroll"),this.event.ondestroy?.before&&this.event.ondestroy.before(this);const e=this.getComponent("parclose");e&&(removeElement(e.element),this.app.salver&&this.app.salver.parsecloseCount--),this.app.salver&&this.app.salver.removeItem();const t=this.app.windows.indexOf(this);this.app.windows.splice(t,1),this.app.window=null,removeElement(this.element),this.event.ondestroy?.after&&this.event.ondestroy.after(this)}normal(e=!1){const t=this.element;if(!t||!t.parentElement||"normal"===this.status)return;this.event.onrestore?.before&&this.event.onrestore.before(this),this.lastStatus=this.status,this.status="normal",this.handlerContentByAnimate(),removeClasses(document.body,`z${this.app.prefix}`,"body-noscroll"),addClasses(t,this.app.prefix,this.enableAnimated?!1===e?`animate-${this.animate}-to-normal`:`animate-${this.animate}-drag-to-normal`:""),addStyles(t,{top:`${this.top}px`,left:`${this.left}px`,width:`${this.width}px`,height:`${this.height}px`,borderRadius:this.borderRadius});const r=this.getComponent("resize-bar");r&&removeClasses(r.element,this.app.prefix,"resize-bar-disabled");const n=this.getComponent("\n        tool-bar\n        /action-bar\n        /action-buttons");if(n&&0!==n.length){for(const e of n){if("max"!==e.id)continue;const t=new UIActionButton(this.app,this,UIActionButton.restore).element;if(!t||!t.parentElement)return;const r=new UIActionButton(this.app,this,e).present();t.parentElement.replaceChild(r,t);break}this.zoomActionButtons(this.width),this.event.onrestore?.after&&this.event.onrestore.after(this)}}max(){const e=this.element;if(!e||!e.parentElement||"max"===this.status)return;this.event.onmax?.before&&this.event.onmax.before(this),this.handlerContentByAnimate(),this.lastStatus=this.status,this.status="max",addClasses(document.body,`z${this.app.prefix}`,"body-noscroll"),addClasses(e,this.app.prefix,this.enableAnimated?`animate-${this.animate}-to-max`:""),addStyles(e,{top:"0",left:"0",width:`${innerWidth}px`,height:`${innerHeight}px`,borderRadius:"0"});const t=this.getComponent("resize-bar");t&&addClasses(t.element,this.app.prefix,"resize-bar-disabled");const r=this.getComponent("\n        tool-bar\n        /action-bar\n        /action-buttons");if(r&&0!==r.length){for(const e of r){if("max"!==e.id)continue;const t=e.element;if(!t||!t.parentElement)return;const r=new UIActionButton(this.app,this,UIActionButton.restore).present();t.parentElement.replaceChild(r,t);break}this.zoomActionButtons(innerWidth),this.event.onmax?.after&&this.event.onmax.after(this)}}min(){this.element&&"min"!==this.status&&(this.event.onmin?.before&&this.event.onmin.before(this),!1!==this.parclose?this.flicker():this.enableAnimated?addClasses(this.element,this.app.prefix,`animate-${this.animate}-to-min`):this.minimize())}minimize(){const e=this.element;addClasses(e,this.app.prefix,"window-min"),this.enableAnimated&&removeClasses(e,this.app.prefix,`animate-${this.animate}-to-min`),this.app.salver&&this.app.salver.addOrUpdateItem(),this.lastStatus=this.status,this.status="min",this.event.onmin?.after&&this.event.onmin.after(this)}flicker(){if(this.element&&"layer"===this.mode&&!1===this.flickering){let e=0;const t=60,r=12;this.flickering=!0;for(let i=0;i<r;i++)i%2==0?setTimeout((()=>{addStyles(this.element,{boxShadow:this.flickerShadow,webkitBoxShadow:this.flickerShadow}),e++}),i*t):setTimeout((()=>{addStyles(this.element,{boxShadow:this.shadow,webkitBoxShadow:this.shadow}),e++}),i*t);const n=setInterval((()=>{e>=r&&(clearInterval(n),this.flickering=!1)}),t)}}showThis(e){"min"===this.status&&(this.handlerContentByAnimate(!0),removeClasses(e=e||this.element,this.app.prefix,"window-min"),addClasses(e,this.app.prefix,this.enableAnimated?`animate-${this.animate}-show`:""),this.enableAnimated&&addClasses(e,this.app.prefix,`animate-${this.animate}-show`),[this.status,this.lastStatus]=exchangeValue(this.status,this.lastStatus))}updateZIndex(){if(this===this.app.window)return void this.showThis();const e=this.element;if("layer"===this.mode){this.showThis(e),this.zIndex=this.app.zIndex,addStyles(e,{zIndex:`${this.zIndex}`});const t=this.getComponent("parclose");t&&t.updateZIndex(this.zIndex-1),this.app.lastWindow=this.app.window,this.app.window=this,this.app.salver&&this.app.salver.addOrUpdateItem(),this.event.onfocus&&this.event.onfocus(this)}}hideMoreActionContextMenu(){const e=this.getComponent("more-action-context-menu-bar");e&&removeClasses(e.element,this.app.prefix,"context-menu-bar-active")}removeMoreActionContextMenu(){removeElement(new UIActionButton(this.app,this,UIActionButton.more).element)}zoomActionButtons(e){const t=this.getComponent("\n        tool-bar\n        /action-bar");t&&t.zoomActionButtons(e)}getFlickerShadow(){if(!this.shadow)return this.shadow;const e=this.shadow.split(" ");return e[e.length-1]=Number(e[e.length-1].replace("px",""))/2+"px",e.join(" ")}bindWinEvent(e){e&&(this.event?this.event={...this.event,...e}:this.event={...this.defaultEvent,...e})}}function getDatetime(){const e=new Date;return`${e.getFullYear()}-${mendZero(`${e.getMonth()+1}`,2)}-${mendZero(`${e.getDate()}`,2)} ${mendZero(`${e.getHours()}`,2)}:${mendZero(`${e.getMinutes()}`,2)}:${mendZero(`${e.getSeconds()}`,2)}`}const _UINotice=class e extends UIComponent{timer=0;fps=10;id=this.app.noticeZIndex;elementId=`${this.app.prefix+"notice"}-${this.id}`;type="info";title;message;timeout=3e3;_element=null;get element(){return document.getElementById(this.elementId)}_processElement=null;get processElement(){return this.element?this.element.querySelector(`.${this.app.prefix+"notice"}-process`):null}constructor(e,t){super(e),this.type=noticeTypeCast(t.type,this.type),this.title=stringOrUndefinedCast(t.title),this.message=stringCast(t.message),this.timeout=numberCast(t.timeout,this.timeout)}present(){const e=createFragment(),t=createElement("div");t.id=this.elementId,addClasses(t,this.app.prefix,"notice","animate-d3s","animate-fade-in-right"),addStyles(t,{zIndex:`${this.id}`}),this.bindEvent(t),this.createClose(t);const r=createElement("div");addClasses(r,this.app.prefix,"notice-container","flexbox","flex-row");const n=createElement("div");addClasses(n,this.app.prefix,"notice-icon",`notice-${this.type}`);const i=new UIIcon(this.app,`${this.type}`).present();n.appendChild(i),r.appendChild(n);const o=createElement("div");return addClasses(o,this.app.prefix,"notice-message","flex-item"),this.createTitle(o),this.createContent(o),r.appendChild(o),t.appendChild(r),this.createNoticeTime(t),this.createProcess(t),e.appendChild(t),e}createClose(e){const t=createElement("div");addClasses(t,this.app.prefix,"notice-close-button","flexbox","flex-center");const r=new UIIcon(this.app,"destroy").present();t.appendChild(r),t.addEventListener("mousedown",(e=>{this.destroy()})),e.appendChild(t)}createTitle(e){if(void 0!==this.title){const t=createElement("div");addClasses(t,this.app.prefix,"notice-title",`notice-${this.type}`),t.innerText=this.title,e.appendChild(t)}}createContent(e){const t=createElement("div");addClasses(t,this.app.prefix,"notice-content"),t.innerText=this.message,e.appendChild(t)}createNoticeTime(e){const t=createElement("div");addClasses(t,this.app.prefix,"notice-time"),t.innerText=`${getDatetime()}`,e.appendChild(t)}createProcess(e){const t=createElement("div");addClasses(t,this.app.prefix,"notice-process"),e.appendChild(t)}calcTopOffset(t=void 0){let r=e.topOffset;if(this.app.notices.length>0){const n=(void 0===t?this.app.notices.length:t)-1,i=this.app.notices[n].element.getBoundingClientRect();r=i.top+i.height+e.space}return r}bindEvent(e){e.addEventListener("animationend",(e=>{const t=this.element;containClass(t,this.app.prefix,"animate-fade-in-right-reverse")&&this.remove(),0!==this.timeout&&containClass(t,this.app.prefix,"animate-fade-in-right")&&this.processAnimate(),removeClasses(t,this.app.prefix,"animate-fade-in-right-reverse","animate-fade-in-right","animate-slide-to-top")})),0!==this.timeout&&(e.addEventListener("mouseenter",(e=>{clearInterval(this.timer)})),e.addEventListener("mouseleave",(e=>{this.processAnimate()})))}destroy(){addClasses(this.element,this.app.prefix,"animate-fade-in-right-reverse")}remove(){const e=this.app.notices.indexOf(this);this.app.notices.splice(e,1),removeElement(this.element),this.updateOffset(e)}processAnimate(){this.timer=setInterval((()=>{this.fps<=this.timeout?addStyles(this.processElement,{width:this.fps/this.timeout*100+"%"}):(clearInterval(this.timer),this.destroy()),this.fps+=10}),10)}updateOffset(t,r=!1){const n=this.app.notices;for(let i=t;i<n.length;i++)addStyles(n[i].element,{top:`${0===i?e.topOffset:this.calcTopOffset(i)}px`}),r||addClasses(this.element,this.app.prefix,"animate-slide-to-top")}};__publicField(_UINotice,"topOffset",24),__publicField(_UINotice,"space",10);let UINotice=_UINotice;class UIDragLayer extends UIComponent{elementId=this.app.prefix+"drag-layer";_element=null;get element(){return document.getElementById(`${this.elementId}`)}constructor(e){super(e)}present(){const e=createFragment(),t=createElement("div");return t.id=this.elementId,addClasses(t,this.app.prefix,"drag-layer"),e.appendChild(t),e}updateZIndex(e){const t=this.element;addClasses(t,this.app.prefix,"drag-layer-active"),addStyles(t,{zIndex:`${e}`})}hide(){removeClasses(this.element,this.app.prefix,"drag-layer-active")}}class App{layx;version="0.0.3";prefix="layx-";_window=null;get window(){return this._window}set window(e){this.layx.window=this._window=e}_lastWindow=null;get lastWindow(){return this._lastWindow}set lastWindow(e){this.layx.lastWindow=this._lastWindow=e}_salver=null;get salver(){return this._salver}set salver(e){this.layx.salver=this._salver=e}_zIndex=1e7;get zIndex(){return this._zIndex=this._zIndex+3}_aboveZIndex=2e7;get aboveZIndex(){return this._aboveZIndex=this._aboveZIndex+3}_salverZIndex=3e7;get salverZIndex(){return this._salverZIndex}_noticeZIndex=4e7;get noticeZIndex(){return this._noticeZIndex=this._noticeZIndex+1}_windows=[];get windows(){return this._windows}_notices=[];get notices(){return this._notices}_drayLayer=null;get drayLayer(){return this._drayLayer}set drayLayer(e){this._drayLayer=e}constructor(e){this.layx=e,this.init()}open(e){let t=this.getWindow(e.id);if(t)t.event.onexist&&t.event.onexist(t,this),t.updateZIndex(),t.flicker();else{t=new UIWindow(this,e);const r=t.present();document.body.appendChild(r),t.event.onload?.after&&t.event.onload.after(t,this),this.lastWindow=this.window,this.window=t,this.windows.push(t),this.salver&&(0===this.salver.items.length&&(this.salver.show(),setTimeout((()=>{this.salver.show(!1)}),300)),this.salver.addOrUpdateItem())}t.zoomActionButtons(t.width)}destroy(e){isStringWithNotEmpty(e)||assertId();const t=this.getWindow(e);t&&t.destroy()}getWindow(e){isStringWithNotEmpty(e)||assertId();for(const t of this.windows)if(t.id===e){if(t.element)return t;{const e=this.windows.indexOf(t);return this.windows.splice(e,1),null}}return null}notice(e){const t=new UINotice(this,e),r=t.present();document.body.append(r),this.notices.push(t);const n=this.notices.indexOf(t);t.updateOffset(n,!0)}init(){this.bindEvent()}createDragLayer(){if(!this.drayLayer){const e=new UIDragLayer(this),t=e.present();document.body.appendChild(t),this.drayLayer=e}}bindEvent(){document.body.id||(document.body.id=`${this.prefix}body`),this.createDragLayer(),document.addEventListener("mousedown",this.mousedown,!0),document.addEventListener("mousemove",this.mousemove,!0)}mousedown=e=>{if(this.window){const t=this.window.getComponent("context-menu-bar");t&&t.hide(),this.window.hideMoreActionContextMenu();const r=this.window.getComponent("top-menu-bar");r&&r.hide(e);const n=this.window.getComponent("\n            tool-bar\n            /title-bar\n            /window-icon-context-menu-bar");n&&n.hide()}if(this.lastWindow){const t=this.lastWindow.getComponent("top-menu-bar");t&&t.hide(e)}};mousemove=e=>{if(this.salver&&this.salver.element)if(e.pageY>=innerHeight-50){if(containClass(this.salver.element,this.prefix,"salver-bar-keep"))return;this.salver.show()}else{if(!containClass(this.salver.element,this.prefix,"salver-bar-keep"))return;this.salver.show(!1)}}}function init(){const e=initLiteWindow();return globalThis.liteWindow=e,e}function initLiteWindow(){const e={},t=new App(e);return e.v=t.version,e.open=function(e){t.open(e)},e.windows=t.windows,e.window=t.window,e.lastWindow=t.lastWindow,e.getWindow=function(e){return t.getWindow(e)},e.destroy=function(e){t.destroy(e)},e.notice=function(e){t.notice(e)},e.notices=t.notices,e}const liteWindow=init();function uuid(){let e=[];const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var r=0;r<36;r++){const n=Math.floor(16*Math.random());e[r]=t.substring(n,n+1)}e[14]="4";const n=3&Number(e[19])|8;return e[19]=t.substring(n,n+1),e[8]=e[13]=e[18]=e[23]="-",e.join("").toLowerCase()}const _hoisted_1={class:"liteWindowContainer"},_sfc_main=defineComponent({__name:"LiteWindowContainer",props:{options:{type:Object,default:{id:uuid(),content:{type:"html",value:""}}}},setup(e,{expose:t}){const r=e,n=computed((()=>{const e={...r.options};if(e.id||(e.id=uuid()),e.content&&"html"==e.content.type||(e.content={type:"html",value:""}),e.event){const t=e.event.ondestroy;e.event.ondestroy={before:e=>{t&&t.before&&t.before(e),i.value&&(i.value=!1)},after:()=>{t&&t.after&&t.after()}}}else e.event={ondestroy:{before:e=>{i.value=!1},after:()=>{}}};return e})),i=ref$1(!1);function o(){return n.value.id}const a=computed((()=>i.value?`#layx-${n.value.id}-content-container .layx-html-content`:"body"));function s(){i.value=!1;const e=o();liteWindow.destroy(e)}return onUnmounted((()=>{s()})),t({open:function(){i.value=!1,liteWindow.open(n.value),i.value=!0},close:s,getWindowID:o,isLoad:i}),(e,t)=>(openBlock(),createBlock(Teleport,{defer:"",to:a.value},[withDirectives(createBaseVNode("div",_hoisted_1,[renderSlot(e.$slots,"default",{},void 0,!0)],512),[[vShow,i.value]])],8,["to"]))}}),_export_sfc=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},LiteWindowContainer=_export_sfc(_sfc_main,[["__scopeId","data-v-f19a3236"]]);function createAddSymbol(){if("undefined"==typeof window||"undefined"==typeof document)return()=>()=>{};const e=window._SVG_SPRITE_IDS_=window._SVG_SPRITE_IDS_||new Set,t=document.createElementNS("http://www.w3.org/2000/svg","svg");function r(){document.body.insertBefore(t,document.body.firstChild)}return t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.overflow="hidden",t.ariaHidden="true","loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r(),function(r,n){e.has(n)||document.getElementById(n),e.add(n),t.insertAdjacentHTML("beforeend",r);const i=t.lastChild;return function(){e.delete(n),null==i||i.remove()}}}const addSymbol=createAddSymbol(),id$d="destroy",symbolXml$d='<symbol id="destroy" class="297626f6__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M933.89254819 139.71606348L884.23129279 90.08990363 511.96490363 462.39138834 140.40044113 90.82692583 90.84447403 140.34779656 462.40893653 511.91225907 90.10745181 884.2137446 139.73361166 933.875 512.03509637 561.53841892 883.59955887 933.10288141 933.15552597 883.58201068 561.59106347 512.01754819Z" p-id="4833"/></symbol>',{dispose:dispose$d}=addSymbol(symbolXml$d,id$d),id$c="min",symbolXml$c='<symbol id="min" class="157b711d__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M65.23884 456.152041 958.760137 456.152041l0 111.695918L65.23884 567.847959 65.23884 456.152041z" p-id="4222"/></symbol>',{dispose:dispose$c}=addSymbol(symbolXml$c,id$c),id$b="max",symbolXml$b='<symbol id="max" class="1af2f94d__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M75.74912227 948.24738475L75.74912227 75.75145131l872.50059037 0 0 872.49593344L75.74912227 948.24738475zM839.18786674 184.81446115L184.81213326 184.81446115l0 654.37573462 654.37573461 0L839.18786674 184.81446115z" p-id="4102"/></symbol>',{dispose:dispose$b}=addSymbol(symbolXml$b,id$b),id$a="info",symbolXml$a='<symbol id="info" class="436fd067__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M512 1012.62222187C235.52 1012.62222187 11.37777813 788.48 11.37777813 512S235.52 11.37777813 512 11.37777813s500.62222187 224.14222187 500.62222187 500.62222187-224.14222187 500.62222187-500.62222187 500.62222187z m0-91.02222187c226.21297813 0 409.6-183.38702187 409.6-409.6S738.21297813 102.4 512 102.4 102.4 285.78702187 102.4 512s183.38702187 409.6 409.6 409.6z m0-91.02222187a45.51111147 45.51111147 0 1 1 0-91.02222293 45.51111147 45.51111147 0 0 1 0 91.02222293z m45.4656-202.9340448a45.51111147 45.51111147 0 1 1-90.9312-3.73191146 180.224 180.224 0 0 1 17.11217813-67.8115552c13.5395552-28.8768 34.3836448-51.97368853 63.80657707-65.24017814C594.69368853 469.53813333 625.77777813 427.87271147 625.77777813 398.22222187a113.77777813 113.77777813 0 0 0-227.55555626 0 45.51111147 45.51111147 0 1 1-91.02222187 0 204.8 204.8 0 0 1 409.6 0c0 68.08462187-53.97617813 140.44728853-131.93671147 175.60462293-7.62311147 3.43608853-13.83537813 10.33102187-18.81884373 20.9351104a97.62133333 97.62133333 0 0 0-7.28177813 23.5064896 81.96551147 81.96551147 0 0 0-1.29706667 9.37528853z" p-id="4713"/></symbol>',{dispose:dispose$a}=addSymbol(symbolXml$a,id$a),id$9="restore",symbolXml$9='<symbol id="restore" class="e432b1cc__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M256 256V149.333333c0-58.88 47.829333-106.666667 106.666667-106.666666h512c58.88 0 106.666667 47.829333 106.666666 106.666666v512c0 58.88-47.829333 106.666667-106.666666 106.666667h-106.666667v106.666667c0 58.88-47.829333 106.666667-106.666667 106.666666H149.333333c-58.88 0-106.666667-47.829333-106.666666-106.666666V362.666667c0-58.88 47.829333-106.666667 106.666666-106.666667h106.666667z m0 85.333333H149.333333c-11.733333 0-21.333333 9.6-21.333333 21.333334v512c0 11.733333 9.6 21.333333 21.333333 21.333333h512c11.733333 0 21.333333-9.6 21.333334-21.333333v-106.666667H362.666667c-58.88 0-106.666667-47.829333-106.666667-106.666667V341.333333z m85.333333-192v512c0 11.733333 9.6 21.333333 21.333334 21.333334h512c11.733333 0 21.333333-9.6 21.333333-21.333334V149.333333c0-11.733333-9.6-21.333333-21.333333-21.333333H362.666667c-11.733333 0-21.333333 9.6-21.333334 21.333333z" p-id="4342"/></symbol>',{dispose:dispose$9}=addSymbol(symbolXml$9,id$9),id$8="above",symbolXml$8='<symbol id="above" class="bf796cd9__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M863.92416068 184.3484319H160.07583932a50.27488011 50.27488011 0 0 1 0-100.5497602h703.84832136a50.27488011 50.27488011 0 0 1 0 100.5497602z m-50.27488007 804.39808157a50.22460522 50.22460522 0 0 1-35.69516489-14.57971521L512 708.21268254l-265.95411572 265.95411572A50.27488011 50.27488011 0 0 1 160.07583932 938.47163339V335.1730722a50.27488011 50.27488011 0 0 1 50.27488007-50.27488013h603.29856122a50.27488011 50.27488011 0 0 1 50.27488007 50.27488013v603.29856119a50.27488011 50.27488011 0 0 1-50.27488007 50.27488008z m-301.64928061-402.19904078a50.22460522 50.22460522 0 0 1 35.69516487 14.57971522L763.37440051 816.80642355V385.44795228H260.62559949v431.86122007l215.67923564-215.67923564A50.27488011 50.27488011 0 0 1 512 586.54747269z" p-id="4947"/></symbol>',{dispose:dispose$8}=addSymbol(symbolXml$8,id$8),id$7="more",symbolXml$7='<symbol id="more" class="a08b775e__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M512 269.254656a97.10978845 97.10978845 0 1 0 0-194.16132267 97.10978845 97.10978845 0 0 0 0 194.16132267z" p-id="4591"/><path d="M512 512m-97.10978845 0a97.10978845 97.10978845 0 1 0 194.2195769 0 97.10978845 97.10978845 0 1 0-194.2195769 0Z" p-id="4592"/><path d="M512 948.90666667a97.10978845 97.10978845 0 1 0 0-194.21957689 97.10978845 97.10978845 0 0 0 0 194.21957689z" p-id="4593"/></symbol>',{dispose:dispose$7}=addSymbol(symbolXml$7,id$7),id$6="icon",symbolXml$6='<symbol id="icon" class="8de5eba3__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M853.333333 1024L170.666667 1024c-93.866667 0-170.666667-76.8-170.666667-170.666667L0 170.666667c0-93.866667 76.8-170.666667 170.666667-170.666667l682.66666699 0c93.866667 0 170.666667 76.8 170.66666701 170.666667l0 682.66666699C1024 947.2 947.2 1024 853.333333 1024zM170.666667 85.333333C123.733333 85.333333 85.333333 123.733333 85.333333 170.666667l0 682.66666699c0 46.933333 38.4 85.333333 85.33333301 85.33333301l682.66666699 0c46.933333 0 85.333333-38.4 85.33333301-85.33333301L938.666667 170.666667c0-46.933333-38.4-85.333333-85.33333301-85.33333301L170.666667 85.333333z" p-id="1156"/><path d="M981.333333 341.333333L42.666667 341.333333C17.066667 341.333333 0 324.266667 0 298.666667s17.066667-42.666667 42.666667-42.666667l938.66666699 0c25.6 0 42.666667 17.066667 42.66666701 42.666667S1006.933333 341.333333 981.333333 341.333333z" p-id="1157"/><path d="M170.666667 170.666667m-42.666667 0a1 1 0 1 0 85.333333 0 1 1 0 1 0-85.333333 0Z" p-id="1158"/><path d="M170.666667 234.666667C136.533333 234.666667 106.666667 204.8 106.666667 170.666667S136.533333 106.666667 170.666667 106.666667 234.666667 136.533333 234.666667 170.666667 204.8 234.666667 170.666667 234.666667zM170.666667 149.333333C157.866667 149.333333 149.333333 157.866667 149.333333 170.666667S157.866667 192 170.666667 192 192 183.466667 192 170.666667 183.466667 149.333333 170.666667 149.333333z" p-id="1159"/><path d="M298.666667 170.666667m-42.666667 0a1 1 0 1 0 85.333333 0 1 1 0 1 0-85.333333 0Z" p-id="1160"/><path d="M298.666667 234.666667C264.533333 234.666667 234.666667 204.8 234.666667 170.666667S264.533333 106.666667 298.666667 106.666667 362.666667 136.533333 362.666667 170.666667 332.8 234.666667 298.666667 234.666667zM298.666667 149.333333C285.866667 149.333333 277.333333 157.866667 277.333333 170.666667S285.866667 192 298.666667 192 320 183.466667 320 170.666667 311.466667 149.333333 298.666667 149.333333z" p-id="1161"/><path d="M426.666667 170.666667m-42.666667 0a1 1 0 1 0 85.333333 0 1 1 0 1 0-85.333333 0Z" p-id="1162"/><path d="M426.666667 234.666667C392.533333 234.666667 362.666667 204.8 362.666667 170.666667S392.533333 106.666667 426.666667 106.666667s64 29.866667 64 64S460.8 234.666667 426.666667 234.666667zM426.666667 149.333333C413.866667 149.333333 405.333333 157.866667 405.333333 170.666667S413.866667 192 426.666667 192s21.333333-8.533333 21.333333-21.333333S439.466667 149.333333 426.666667 149.333333z" p-id="1163"/></symbol>',{dispose:dispose$6}=addSymbol(symbolXml$6,id$6),id$5="right",symbolXml$5='<symbol id="right" class="770397ad__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M737.95577083 554.36670718a42.64915156 42.64915156 0 0 1-29.93913978-12.4275674l-451.91154165-451.91154165a42.36670718 42.36670718 0 0 1 59.87827955-59.87827955l451.91154165 451.91154164a42.08426279 42.08426279 0 0 1 0 59.87827956 42.64915156 42.64915156 0 0 1-29.93913977 12.4275674z" p-id="1702"/><path d="M286.04422917 1006.27824882a42.64915156 42.64915156 0 0 1-29.93913977-12.4275674 42.08426279 42.08426279 0 0 1 0-59.87827955l451.91154165-451.91154165a42.36670718 42.36670718 0 0 1 59.87827955 59.87827956l-451.91154165 451.91154164a42.64915156 42.64915156 0 0 1-29.93913978 12.4275674z" p-id="1703"/></symbol>',{dispose:dispose$5}=addSymbol(symbolXml$5,id$5),id$4="about",symbolXml$4='<symbol id="about" class="aa8be6a9__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M512 1012.62222187C235.52 1012.62222187 11.37777813 788.48 11.37777813 512S235.52 11.37777813 512 11.37777813s500.62222187 224.14222187 500.62222187 500.62222187-224.14222187 500.62222187-500.62222187 500.62222187z m0-91.02222187c226.21297813 0 409.6-183.38702187 409.6-409.6S738.21297813 102.4 512 102.4 102.4 285.78702187 102.4 512s183.38702187 409.6 409.6 409.6z m0-91.02222187a45.51111147 45.51111147 0 1 1 0-91.02222293 45.51111147 45.51111147 0 0 1 0 91.02222293z m45.4656-202.9340448a45.51111147 45.51111147 0 1 1-90.9312-3.73191146 180.224 180.224 0 0 1 17.11217813-67.8115552c13.5395552-28.8768 34.3836448-51.97368853 63.80657707-65.24017814C594.69368853 469.53813333 625.77777813 427.87271147 625.77777813 398.22222187a113.77777813 113.77777813 0 0 0-227.55555626 0 45.51111147 45.51111147 0 1 1-91.02222187 0 204.8 204.8 0 0 1 409.6 0c0 68.08462187-53.97617813 140.44728853-131.93671147 175.60462293-7.62311147 3.43608853-13.83537813 10.33102187-18.81884373 20.9351104a97.62133333 97.62133333 0 0 0-7.28177813 23.5064896 81.96551147 81.96551147 0 0 0-1.29706667 9.37528853z" p-id="1690"/></symbol>',{dispose:dispose$4}=addSymbol(symbolXml$4,id$4),id$3="success",symbolXml$3='<symbol id="success" class="fe36d84b__icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M763.61272889 290.06165333L450.04344889 598.21169778c-1.96721778 1.92853333-5.00849778 2.22435555-7.32615111 0.71566222L267.07854222 484.59320889c-0.36636445-0.24917333-0.73955555-0.49152-1.09795555-0.72362667l-0.72362667-0.45056c-0.45056-0.27989333-1.00352-0.48355555-1.48593778-0.75548444-4.99256889-2.72952889-10.64618667-4.41799111-16.74467555-4.41799111-19.41276445 0-35.12433778 15.72636445-35.12433778 35.12433778 0 7.62197333 2.49628445 14.62272 6.61162666 20.3776 1.54624 2.39502222 3.31320889 4.66716445 5.46816 6.71971555l199.25674667 188.65948445c17.25326222 13.81376 42.26616889 11.69749333 56.93326223-4.82190223l329.62446222-391.46609777c10.62456889-12.61568 9.72231111-31.2832-2.06848-42.8088889C795.47050667 278.02965333 775.85408 278.03761778 763.61272889 290.06165333z" p-id="1805"/><path d="M513.99224889-2.72839111c-281.51011555 0-509.72444445 228.21774222-509.72444444 509.72103111 0 281.52718222 228.21432889 509.72899555 509.72444444 509.72899555 281.52263111 0 509.72444445-228.20181333 509.72444444-509.72899555C1023.71669333 225.48935111 795.51488-2.72839111 513.99224889-2.72839111zM513.99224889 953.00608c-246.3232 0-446.00888889-199.67317333-446.00888889-446.01344 0-246.31637333 199.68568889-446.00547555 446.00888889-446.00547555 246.32206222 0 446.00888889 199.68910222 446.00888889 446.00547555C960.00113778 753.33176889 760.31431111 953.00608 513.99224889 953.00608z" p-id="1806"/></symbol>',{dispose:dispose$3}=addSymbol(symbolXml$3,id$3),id$2="warning",symbolXml$2='<symbol id="warning" class="2511f986__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M897.53493333 990.29333333L128.6304 990.29333333c-51.56266667 0-92.9856-20.37013333-113.67253333-55.89866666-20.69226667-35.52853333-18.17493333-81.93706667 6.93226666-127.2864L409.84533333 106.42346667C435.09866667 60.74346667 472.65066667 34.56 512.82666667 34.56c40.18133333 0 77.696 26.15146667 103.01973333 71.79093333l388.36266667 700.8288c25.1008 45.3504 27.69706667 91.7248 6.9664 127.24906667C990.5216 969.95626667 949.06453333 990.29333333 897.53493333 990.29333333L897.53493333 990.29333333zM512.86613333 108.11306667c-12.7744 0-27.40586667 12.7616-39.2672 34.1312L85.64373333 843.00053333c-12.15573333 21.99253333-15.00053333 41.7472-7.73973333 54.20906667 7.2672 12.43093333 25.76533333 19.57013333 50.72746667 19.57013333l768.90453333 0c25.0016 0 43.46666667-7.09973333 50.72853333-19.57013333 7.2224-12.42986667 4.416-32.17706667-7.7728-54.17066667L552.1344 142.24426667C540.3072 120.87466667 525.60106667 108.11306667 512.86613333 108.11306667L512.86613333 108.11306667zM513.0848 658.4896c-20.14186667 0-36.49066667-16.4416-36.49066667-36.7776L476.59413333 290.71466667c0-20.30186667 16.3488-36.77866667 36.49066667-36.77866667 20.14506667 0 36.49386667 16.4768 36.49386667 36.77866667l0 330.99626666C549.5776 642.048 533.2288 658.4896 513.0848 658.4896zM512.8224 838.2624c31.40373333 0 56.86293333-25.7024 56.86293333-57.40693333s-25.45813333-57.40693333-56.86293333-57.40693334-56.86186667 25.7024-56.86186667 57.40693334S481.41866667 838.2624 512.8224 838.2624z" p-id="2160"/></symbol>',{dispose:dispose$2}=addSymbol(symbolXml$2,id$2),id$1="error",symbolXml$1='<symbol id="error" class="f830f22d__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M422.4 750.933333 422.4 750.933333 422.4 750.933333zM512 0C230.4 0 0 230.4 0 512s230.4 512 512 512 512-230.4 512-512S793.6 0 512 0zM512 960C264.533333 960 64 759.466667 64 512S264.533333 64 512 64 960 264.533333 960 512 759.466667 960 512 960zM693.0176 282.702507l51.28832 51.28832-410.30656 410.30656-51.28832-51.28832 410.30656-410.30656ZM282.702507 330.9824l51.28832-51.28832 410.30656 410.30656-51.28832 51.28832-410.30656-410.30656Z" p-id="1921"/></symbol>',{dispose:dispose$1}=addSymbol(symbolXml$1,id$1),id="refresh",symbolXml='<symbol id="refresh" class="c2f1e613__icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"/></defs><path d="M1021.72444445 402.77333333V147.91111111l-83.12149334 83.12149334a509.39676445 509.39676445 0 0 0-425.07377778-228.79345778C232.01564445 2.23914667 3.76832 230.45006222 3.76832 512S232.01564445 1021.76085333 513.52917333 1021.76085333a509.79726222 509.79726222 0 0 0 472.44174222-317.99523555 43.65425778 43.65425778 0 1 0-80.93696-32.87722667 422.52515555 422.52515555 0 0 1-391.50478222 263.49112889C280.25742222 934.37952 91.14965333 745.27175111 91.14965333 512S280.25742222 89.62048 513.52917333 89.62048c150.69639111 0 286.64718222 79.73546667 361.83153778 204.61795555L766.86222222 402.77333333h254.86222223z" p-id="1747"/></symbol>',{dispose:dispose}=addSymbol(symbolXml,id),QTimelineEntry=createComponent({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(e,{slots:t}){const r=inject(timelineKey,emptyRenderFn);if(r===emptyRenderFn)return emptyRenderFn;const n=computed((()=>`q-timeline__entry q-timeline__entry--${e.side}`+(void 0!==e.icon||void 0!==e.avatar?" q-timeline__entry--icon":""))),i=computed((()=>`q-timeline__dot text-${e.color||r.color}`)),o=computed((()=>"comfortable"===r.layout&&"left"===r.side));return()=>{const r=hUniqueSlot(t.default,[]);if(void 0!==e.body&&r.unshift(e.body),!0===e.heading){const t=[h$2("div"),h$2("div"),h$2(e.tag,{class:"q-timeline__heading-title"},r)];return h$2("div",{class:"q-timeline__heading"},!0===o.value?t.reverse():t)}let a;void 0!==e.icon?a=[h$2(QIcon,{class:"row items-center justify-center",name:e.icon})]:void 0!==e.avatar&&(a=[h$2("img",{class:"q-timeline__dot-img",src:e.avatar})]);const s=[h$2("div",{class:"q-timeline__subtitle"},[h$2("span",{},hSlot(t.subtitle,[e.subtitle]))]),h$2("div",{class:i.value},a),h$2("div",{class:"q-timeline__content"},[h$2("h6",{class:"q-timeline__title"},hSlot(t.title,[e.title]))].concat(r))];return h$2("li",{class:n.value},!0===o.value?s.reverse():s)}}}),QTimeline=createComponent({name:"QTimeline",props:{...useDarkProps,color:{type:String,default:"primary"},side:{type:String,default:"right",validator:e=>["left","right"].includes(e)},layout:{type:String,default:"dense",validator:e=>["dense","comfortable","loose"].includes(e)}},setup(e,{slots:t}){const r=getCurrentInstance(),n=useDark(e,r.proxy.$q);provide(timelineKey,e);const i=computed((()=>`q-timeline q-timeline--${e.layout} q-timeline--${e.layout}--${e.side}`+(!0===n.value?" q-timeline--dark":"")));return()=>h$2("ul",{class:i.value},hSlot(t.default))}}),duration=150,QDrawer=createComponent({name:"QDrawer",inheritAttrs:!1,props:{...useModelToggleProps,...useDarkProps,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...useModelToggleEmits,"onLayout","miniState"],setup(e,{slots:t,emit:r,attrs:n}){const i=getCurrentInstance(),{proxy:{$q:o}}=i,a=useDark(e,o),{preventBodyScroll:s}=usePreventScroll(),{registerTimeout:l,removeTimeout:c}=useTimeout(),u=inject(layoutKey,emptyRenderFn);if(u===emptyRenderFn)return emptyRenderFn;let h,d,p=null;const f=ref$1("mobile"===e.behavior||"desktop"!==e.behavior&&u.totalWidth.value<=e.breakpoint),m=computed((()=>!0===e.mini&&!0!==f.value)),g=computed((()=>!0===m.value?e.miniWidth:e.width)),y=ref$1(!0===e.showIfAbove&&!1===f.value||!0===e.modelValue),_=computed((()=>!0!==e.persistent&&(!0===f.value||!0===B.value)));function v(e,t){if(S(),!1!==e&&u.animate(),Y(0),!0===f.value){const e=u.instances[R.value];!0===e?.belowBreakpoint&&e.hide(!1),X(1),!0!==u.isContainer.value&&s(!0)}else X(0),!1!==e&&K(!1);l((()=>{!1!==e&&K(!0),!0!==t&&r("show",e)}),duration)}function b(e,t){E(),!1!==e&&u.animate(),X(0),Y(C.value*g.value),ee(),!0!==t?l((()=>{r("hide",e)}),duration):c()}const{show:w,hide:x}=useModelToggle({showing:y,hideOnRouteChange:_,handleShow:v,handleHide:b}),{addToHistory:S,removeFromHistory:E}=useHistory(y,x,_),T={belowBreakpoint:f,hide:x},A=computed((()=>"right"===e.side)),C=computed((()=>(!0===o.lang.rtl?-1:1)*(!0===A.value?1:-1))),I=ref$1(0),k=ref$1(!1),P=ref$1(!1),M=ref$1(g.value*C.value),R=computed((()=>!0===A.value?"left":"right")),D=computed((()=>!0===y.value&&!1===f.value&&!1===e.overlay?!0===e.miniToOverlay?e.miniWidth:g.value:0)),O=computed((()=>!0===e.overlay||!0===e.miniToOverlay||-1!==u.view.value.indexOf(A.value?"R":"L")||!0===o.platform.is.ios&&!0===u.isContainer.value)),L=computed((()=>!1===e.overlay&&!0===y.value&&!1===f.value)),B=computed((()=>!0===e.overlay&&!0===y.value&&!1===f.value)),$=computed((()=>"fullscreen q-drawer__backdrop"+(!1===y.value&&!1===k.value?" hidden":""))),z=computed((()=>({backgroundColor:`rgba(0,0,0,${.4*I.value})`}))),F=computed((()=>!0===A.value?"r"===u.rows.value.top[2]:"l"===u.rows.value.top[0])),q=computed((()=>!0===A.value?"r"===u.rows.value.bottom[2]:"l"===u.rows.value.bottom[0])),N=computed((()=>{const e={};return!0===u.header.space&&!1===F.value&&(!0===O.value?e.top=`${u.header.offset}px`:!0===u.header.space&&(e.top=`${u.header.size}px`)),!0===u.footer.space&&!1===q.value&&(!0===O.value?e.bottom=`${u.footer.offset}px`:!0===u.footer.space&&(e.bottom=`${u.footer.size}px`)),e})),j=computed((()=>{const e={width:`${g.value}px`,transform:`translateX(${M.value}px)`};return!0===f.value?e:Object.assign(e,N.value)})),U=computed((()=>"q-drawer__content fit "+(!0!==u.isContainer.value?"scroll":"overflow-auto"))),V=computed((()=>`q-drawer q-drawer--${e.side}`+(!0===P.value?" q-drawer--mini-animate":"")+(!0===e.bordered?" q-drawer--bordered":"")+(!0===a.value?" q-drawer--dark q-dark":"")+(!0===k.value?" no-transition":!0===y.value?"":" q-layout--prevent-focus")+(!0===f.value?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":" q-drawer--"+(!0===m.value?"mini":"standard")+(!0===O.value||!0!==L.value?" fixed":"")+(!0===e.overlay||!0===e.miniToOverlay?" q-drawer--on-top":"")+(!0===F.value?" q-drawer--top-padding":"")))),G=computed((()=>{const t=!0===o.lang.rtl?e.side:R.value;return[[TouchPan,Q,void 0,{[t]:!0,mouse:!0}]]})),W=computed((()=>{const t=!0===o.lang.rtl?R.value:e.side;return[[TouchPan,J,void 0,{[t]:!0,mouse:!0}]]})),H=computed((()=>{const t=!0===o.lang.rtl?R.value:e.side;return[[TouchPan,J,void 0,{[t]:!0,mouse:!0,mouseAllDir:!0}]]}));function Z(){var t,r;t=f,r="mobile"===e.behavior||"desktop"!==e.behavior&&u.totalWidth.value<=e.breakpoint,t.value!==r&&(t.value=r)}function Y(e){void 0===e?nextTick((()=>{e=!0===y.value?0:g.value,Y(C.value*e)})):(!0!==u.isContainer.value||!0!==A.value||!0!==f.value&&Math.abs(e)!==g.value||(e+=C.value*u.scrollbarWidth.value),M.value=e)}function X(e){I.value=e}function K(e){const t=!0===e?"remove":!0!==u.isContainer.value?"add":"";""!==t&&document.body.classList[t]("q-body--drawer-toggle")}function Q(e){if(!1!==y.value)return;const t=g.value,r=between$1(e.distance.x,0,t);if(!0===e.isFinal){return!0===r>=Math.min(75,t)?w():(u.animate(),X(0),Y(C.value*t)),void(k.value=!1)}Y((!0===o.lang.rtl?!0!==A.value:A.value)?Math.max(t-r,0):Math.min(0,r-t)),X(between$1(r/t,0,1)),!0===e.isFirst&&(k.value=!0)}function J(t){if(!0!==y.value)return;const r=g.value,n=t.direction===e.side,i=(!0===o.lang.rtl?!0!==n:n)?between$1(t.distance.x,0,r):0;if(!0===t.isFinal){return!0===Math.abs(i)<Math.min(75,r)?(u.animate(),X(1),Y(0)):x(),void(k.value=!1)}Y(C.value*i),X(between$1(1-i/r,0,1)),!0===t.isFirst&&(k.value=!0)}function ee(){s(!1),K(!0)}function te(t,r){u.update(e.side,t,r)}function re(t,r){te("size",!0===t?e.miniWidth:r)}return watch$2(f,(t=>{!0===t?(h=y.value,!0===y.value&&x(!1)):!1===e.overlay&&"mobile"!==e.behavior&&!1!==h&&(!0===y.value?(Y(0),X(0),ee()):w(!1))})),watch$2((()=>e.side),((e,t)=>{u.instances[t]===T&&(u.instances[t]=void 0,u[t].space=!1,u[t].offset=0),u.instances[e]=T,u[e].size=g.value,u[e].space=L.value,u[e].offset=D.value})),watch$2(u.totalWidth,(()=>{!0!==u.isContainer.value&&!0===document.qScrollPrevented||Z()})),watch$2((()=>e.behavior+e.breakpoint),Z),watch$2(u.isContainer,(e=>{!0===y.value&&s(!0!==e),!0===e&&Z()})),watch$2(u.scrollbarWidth,(()=>{Y(!0===y.value?0:void 0)})),watch$2(D,(e=>{te("offset",e)})),watch$2(L,(e=>{r("onLayout",e),te("space",e)})),watch$2(A,(()=>{Y()})),watch$2(g,(t=>{Y(),re(e.miniToOverlay,t)})),watch$2((()=>e.miniToOverlay),(e=>{re(e,g.value)})),watch$2((()=>o.lang.rtl),(()=>{Y()})),watch$2((()=>e.mini),(()=>{e.noMiniAnimation||!0===e.modelValue&&(!function(){null!==p&&clearTimeout(p),i.proxy&&i.proxy.$el&&i.proxy.$el.classList.add("q-drawer--mini-animate");P.value=!0,p=setTimeout((()=>{p=null,P.value=!1,i?.proxy?.$el?.classList.remove("q-drawer--mini-animate")}),150)}(),u.animate())})),watch$2(m,(e=>{r("miniState",e)})),u.instances[e.side]=T,re(e.miniToOverlay,g.value),te("space",L.value),te("offset",D.value),!0===e.showIfAbove&&!0!==e.modelValue&&!0===y.value&&void 0!==e["onUpdate:modelValue"]&&r("update:modelValue",!0),onMounted((()=>{r("onLayout",L.value),r("miniState",m.value),h=!0===e.showIfAbove;const t=()=>{(!0===y.value?v:b)(!1,!0)};0===u.totalWidth.value?d=watch$2(u.totalWidth,(()=>{d(),d=void 0,!1===y.value&&!0===e.showIfAbove&&!1===f.value?w(!1):t()})):nextTick(t)})),onBeforeUnmount((()=>{d?.(),null!==p&&(clearTimeout(p),p=null),!0===y.value&&ee(),u.instances[e.side]===T&&(u.instances[e.side]=void 0,te("size",0),te("offset",0),te("space",!1))})),()=>{const r=[];!0===f.value&&(!1===e.noSwipeOpen&&r.push(withDirectives(h$2("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),G.value)),r.push(hDir("div",{ref:"backdrop",class:$.value,style:z.value,"aria-hidden":"true",onClick:x},void 0,"backdrop",!0!==e.noSwipeBackdrop&&!0===y.value,(()=>H.value))));const i=!0===m.value&&void 0!==t.mini,o=[h$2("div",{...n,key:""+i,class:[U.value,n.class]},!0===i?t.mini():hSlot(t.default))];return!0===e.elevated&&!0===y.value&&o.push(h$2("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),r.push(hDir("aside",{ref:"content",class:V.value,style:j.value},o,"contentclose",!0!==e.noSwipeClose&&!0===f.value,(()=>W.value))),h$2("div",{class:"q-drawer-container"},r)}}});var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var r=new u16(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new i32(r[30]);for(n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},_a=freb(fleb,2),fl=_a.b,revfl=_a.r;fl[28]=258,revfl[258]=28;for(var _b=freb(fdeb,0),fd=_b.b,rev=new u16(32768),i$1=0;i$1<32768;++i$1){var x$2=(43690&i$1)>>1|(21845&i$1)<<1;x$2=(52428&x$2)>>2|(13107&x$2)<<2,x$2=(61680&x$2)>>4|(3855&x$2)<<4,rev[i$1]=((65280&x$2)>>8|(255&x$2)<<8)>>1}for(var hMap=function(e,t,r){for(var n=e.length,i=0,o=new u16(t);i<n;++i)e[i]&&++o[e[i]-1];var a,s=new u16(t);for(i=1;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;if(r){a=new u16(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=s[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[rev[h]>>l]=c}else for(a=new u16(n),i=0;i<n;++i)e[i]&&(a[i]=rev[s[e[i]-1]++]>>15-e[i]);return a},flt=new u8(288),i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;for(var fdt=new u8(32),i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max$1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},bits=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},bits16=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},shft=function(e){return(e+7)/8|0},slc=function(e,t,r){return(null==r||r>e.length)&&(r=e.length),new u8(e.subarray(t,r))},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,t,r){var n=new Error(t||ec[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,err),!r)throw n;return n},inflt=function(e,t,r,n){var i=e.length;if(!i||t.f&&!t.l)return r||new u8(0);var o=!r,a=o||2!=t.i,s=t.i;o&&(r=new u8(3*i));var l=function(e){var t=r.length;if(e>t){var n=new u8(Math.max(2*t,e));n.set(r),r=n}},c=t.f||0,u=t.p||0,h=t.b||0,d=t.l,p=t.d,f=t.m,m=t.n,g=8*i;do{if(!d){c=bits(e,u,1);var y=bits(e,u+1,3);if(u+=3,!y){var _=e[(k=shft(u)+4)-4]|e[k-3]<<8,v=k+_;if(v>i){s&&err(0);break}a&&l(h+_),r.set(e.subarray(k,v),h),t.b=h+=_,t.p=u=8*v,t.f=c;continue}if(1==y)d=flrm,p=fdrm,f=9,m=5;else if(2==y){var b=bits(e,u,31)+257,w=bits(e,u+10,15)+4,x=b+bits(e,u+5,31)+1;u+=14;for(var S=new u8(x),E=new u8(19),T=0;T<w;++T)E[clim[T]]=bits(e,u+3*T,7);u+=3*w;var A=max$1(E),C=(1<<A)-1,I=hMap(E,A,1);for(T=0;T<x;){var k,P=I[bits(e,u,C)];if(u+=15&P,(k=P>>4)<16)S[T++]=k;else{var M=0,R=0;for(16==k?(R=3+bits(e,u,3),u+=2,M=S[T-1]):17==k?(R=3+bits(e,u,7),u+=3):18==k&&(R=11+bits(e,u,127),u+=7);R--;)S[T++]=M}}var D=S.subarray(0,b),O=S.subarray(b);f=max$1(D),m=max$1(O),d=hMap(D,f,1),p=hMap(O,m,1)}else err(1);if(u>g){s&&err(0);break}}a&&l(h+131072);for(var L=(1<<f)-1,B=(1<<m)-1,$=u;;$=u){var z=(M=d[bits16(e,u)&L])>>4;if((u+=15&M)>g){s&&err(0);break}if(M||err(2),z<256)r[h++]=z;else{if(256==z){$=u,d=null;break}var F=z-254;if(z>264){var q=fleb[T=z-257];F=bits(e,u,(1<<q)-1)+fl[T],u+=q}var N=p[bits16(e,u)&B],j=N>>4;N||err(3),u+=15&N;O=fd[j];if(j>3){q=fdeb[j];O+=bits16(e,u)&(1<<q)-1,u+=q}if(u>g){s&&err(0);break}a&&l(h+131072);var U=h+F;if(h<O){var V=0-O,G=Math.min(O,U);for(V+h<0&&err(3);h<G;++h)r[h]=n[V+h]}for(;h<U;++h)r[h]=r[h-O]}}t.l=d,t.p=$,t.b=h,t.f=c,d&&(c=1,t.m=f,t.d=p,t.n=m)}while(!c);return h!=r.length&&o?slc(r,0,h):r.subarray(0,h)},et$1=new u8(0),gzs=function(e){31==e[0]&&139==e[1]&&8==e[2]||err(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=2+(e[10]|e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},gzl=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0};function gunzipSync(e,t){var r=gzs(e);return r+8>e.length&&err(6,"invalid gzip data"),inflt(e.subarray(r,-8),{i:2},new u8(gzl(e)),t)}var td="undefined"!=typeof TextDecoder&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch(e2){}const __vite__wasmUrl=""+new URL("xbase_wasm_bg-Dm1mlE_g.wasm",import.meta.url).href,__vite__initWasm=async(e={},t)=>{let r;if(t.startsWith("data:")){const n=t.replace(/^data:.*?base64,/,"");let i;if("function"==typeof Buffer&&"function"==typeof Buffer.from)i=Buffer.from(n,"base64");else{if("function"!=typeof atob)throw new Error("Cannot decode base64-encoded data URL");{const e=atob(n);i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t)}}r=await WebAssembly.instantiate(i,e)}else{const n=await fetch(t),i=n.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))r=await WebAssembly.instantiateStreaming(n,e);else{const t=await n.arrayBuffer();r=await WebAssembly.instantiate(t,e)}}return r.instance.exports};let wasm$1;function __wbg_set_wasm(e){wasm$1=e}function addToExternrefTable0(e){const t=wasm$1.__externref_table_alloc();return wasm$1.__wbindgen_externrefs.set(t,e),t}const CLOSURE_DTORS="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>e.dtor(e.a,e.b)));function debugString(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let r="[";t>0&&(r+=debugString(e[0]));for(let n=1;n<t;n++)r+=", "+debugString(e[n]);return r+="]",r}const r=/\[object ([^\]]+)\]/.exec(toString.call(e));let n;if(!(r&&r.length>1))return toString.call(e);if(n=r[1],"Object"==n)try{return"Object("+JSON.stringify(e)+")"}catch(_2){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:n}function getArrayU8FromWasm0(e,t){return e>>>=0,getUint8ArrayMemory0().subarray(e/1,e/1+t)}let cachedDataViewMemory0=null;function getDataViewMemory0(){return(null===cachedDataViewMemory0||!0===cachedDataViewMemory0.buffer.detached||void 0===cachedDataViewMemory0.buffer.detached&&cachedDataViewMemory0.buffer!==wasm$1.memory.buffer)&&(cachedDataViewMemory0=new DataView(wasm$1.memory.buffer)),cachedDataViewMemory0}function getStringFromWasm0(e,t){return decodeText(e>>>=0,t)}let cachedUint8ArrayMemory0=null;function getUint8ArrayMemory0(){return null!==cachedUint8ArrayMemory0&&0!==cachedUint8ArrayMemory0.byteLength||(cachedUint8ArrayMemory0=new Uint8Array(wasm$1.memory.buffer)),cachedUint8ArrayMemory0}function handleError(e,t){try{return e.apply(this,t)}catch(e2){const t=addToExternrefTable0(e2);wasm$1.__wbindgen_exn_store(t)}}function isLikeNone(e){return null==e}function makeMutClosure(e,t,r,n){const i={a:e,b:t,cnt:1,dtor:r},o=(...e)=>{i.cnt++;const t=i.a;i.a=0;try{return n(t,i.b,...e)}finally{i.a=t,o._wbg_cb_unref()}};return o._wbg_cb_unref=()=>{0==--i.cnt&&(i.dtor(i.a,i.b),i.a=0,CLOSURE_DTORS.unregister(i))},CLOSURE_DTORS.register(o,i,i),o}function passArray8ToWasm0(e,t){const r=t(1*e.length,1)>>>0;return getUint8ArrayMemory0().set(e,r/1),WASM_VECTOR_LEN=e.length,r}function passStringToWasm0(e,t,r){if(void 0===r){const r=cachedTextEncoder.encode(e),n=t(r.length,1)>>>0;return getUint8ArrayMemory0().subarray(n,n+r.length).set(r),WASM_VECTOR_LEN=r.length,n}let n=e.length,i=t(n,1)>>>0;const o=getUint8ArrayMemory0();let a=0;for(;a<n;a++){const t=e.charCodeAt(a);if(t>127)break;o[i+a]=t}if(a!==n){0!==a&&(e=e.slice(a)),i=r(i,n,n=a+3*e.length,1)>>>0;const t=getUint8ArrayMemory0().subarray(i+a,i+n);a+=cachedTextEncoder.encodeInto(e,t).written,i=r(i,n,a,1)>>>0}return WASM_VECTOR_LEN=a,i}let cachedTextDecoder=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});cachedTextDecoder.decode();const MAX_SAFARI_DECODE_BYTES=2146435072;let numBytesDecoded=0;function decodeText(e,t){return numBytesDecoded+=t,numBytesDecoded>=MAX_SAFARI_DECODE_BYTES&&(cachedTextDecoder=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),cachedTextDecoder.decode(),numBytesDecoded=t),cachedTextDecoder.decode(getUint8ArrayMemory0().subarray(e,e+t))}const cachedTextEncoder=new TextEncoder;"encodeInto"in cachedTextEncoder||(cachedTextEncoder.encodeInto=function(e,t){const r=cachedTextEncoder.encode(e);return t.set(r),{read:e.length,written:r.length}});let WASM_VECTOR_LEN=0;function wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294$1(e,t){wasm$1.wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294(e,t)}function wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76$1(e,t,r){wasm$1.wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76(e,t,r)}function wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811$1(e,t,r,n){wasm$1.wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811(e,t,r,n)}const __wbindgen_enum_RequestCache=["default","no-store","reload","no-cache","force-cache","only-if-cached"],__wbindgen_enum_RequestCredentials=["omit","same-origin","include"],__wbindgen_enum_RequestMode=["same-origin","no-cors","cors","navigate"];function md5$1(e){let t,r;try{const n=passStringToWasm0(e,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),i=WASM_VECTOR_LEN,o=wasm$1.md5(n,i);return t=o[0],r=o[1],getStringFromWasm0(o[0],o[1])}finally{wasm$1.__wbindgen_free(t,r,1)}}function xxtea_decrypt_string$1(e,t){let r,n;try{const i=passArray8ToWasm0(e,wasm$1.__wbindgen_malloc),o=WASM_VECTOR_LEN,a=passStringToWasm0(t,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),s=WASM_VECTOR_LEN,l=wasm$1.xxtea_decrypt_string(i,o,a,s);return r=l[0],n=l[1],getStringFromWasm0(l[0],l[1])}finally{wasm$1.__wbindgen_free(r,n,1)}}function xxtea_encrypt_string$1(e,t){const r=passStringToWasm0(e,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),n=WASM_VECTOR_LEN,i=passStringToWasm0(t,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),o=WASM_VECTOR_LEN,a=wasm$1.xxtea_encrypt_string(r,n,i,o);var s=getArrayU8FromWasm0(a[0],a[1]).slice();return wasm$1.__wbindgen_free(a[0],1*a[1],1),s}function __wbg_Error_52673b7de5a0ca89(e,t){return Error(getStringFromWasm0(e,t))}function __wbg___wbindgen_debug_string_adfb662ae34724b6(e,t){const r=passStringToWasm0(debugString(t),wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),n=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4,n,!0),getDataViewMemory0().setInt32(e+0,r,!0)}function __wbg___wbindgen_is_function_8d400b8b1af978cd(e){return"function"==typeof e}function __wbg___wbindgen_is_object_ce774f3490692386(e){return"object"==typeof e&&null!==e}function __wbg___wbindgen_is_string_704ef9c8fc131030(e){return"string"==typeof e}function __wbg___wbindgen_is_undefined_f6b95eab589e0269(e){return void 0===e}function __wbg___wbindgen_string_get_a2a31e16edf96e42(e,t){const r="string"==typeof t?t:void 0;var n=isLikeNone(r)?0:passStringToWasm0(r,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),i=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4,i,!0),getDataViewMemory0().setInt32(e+0,n,!0)}function __wbg___wbindgen_throw_dd24417ed36fc46e(e,t){throw new Error(getStringFromWasm0(e,t))}function __wbg__wbg_cb_unref_87dfb5aaa0cbcea7(e){e._wbg_cb_unref()}function __wbg_abort_07646c894ebbf2bd(e){e.abort()}function __wbg_abort_399ecbcfd6ef3c8e(e,t){e.abort(t)}function __wbg_append_c5cbdf46455cc776(){return handleError((function(e,t,r,n,i){e.append(getStringFromWasm0(t,r),getStringFromWasm0(n,i))}),arguments)}function __wbg_arrayBuffer_c04af4fce566092d(){return handleError((function(e){return e.arrayBuffer()}),arguments)}function __wbg_call_3020136f7a2d6e44(){return handleError((function(e,t,r){return e.call(t,r)}),arguments)}function __wbg_call_abb4ff46ce38be40(){return handleError((function(e,t){return e.call(t)}),arguments)}function __wbg_clearTimeout_7a42b49784aea641(e){return clearTimeout(e)}function __wbg_done_62ea16af4ce34b24(e){return e.done}function __wbg_fetch_74a3e84ebd2c9a0e(e){return fetch(e)}function __wbg_fetch_90447c28cc0b095e(e,t){return e.fetch(t)}function __wbg_get_af9dab7e9603ea93(){return handleError((function(e,t){return Reflect.get(e,t)}),arguments)}function __wbg_has_0e670569d65d3a45(){return handleError((function(e,t){return Reflect.has(e,t)}),arguments)}function __wbg_headers_654c30e1bcccc552(e){return e.headers}function __wbg_instanceof_Response_cd74d1c2ac92cb0b(e){let t;try{t=e instanceof Response}catch(_2){t=!1}return t}function __wbg_iterator_27b7c8b35ab3e86b(){return Symbol.iterator}function __wbg_length_22ac23eaec9d8053(e){return e.length}function __wbg_new_1ba21ce319a06297(){return new Object}function __wbg_new_25f239778d6112b9(){return new Array}function __wbg_new_3c79b3bb1b32b7d3(){return handleError((function(){return new Headers}),arguments)}function __wbg_new_6421f6084cc5bc5a(e){return new Uint8Array(e)}function __wbg_new_881a222c65f168fc(){return handleError((function(){return new AbortController}),arguments)}function __wbg_new_b546ae120718850e(){return new Map}function __wbg_new_ff12d2b041fb48f1(e,t){try{var r={a:e,b:t};return new Promise(((e,t)=>{const n=r.a;r.a=0;try{return wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811$1(n,r.b,e,t)}finally{r.a=n}}))}finally{r.a=r.b=0}}function __wbg_new_from_slice_f9c22b9153b26992(e,t){return new Uint8Array(getArrayU8FromWasm0(e,t))}function __wbg_new_no_args_cb138f77cf6151ee(e,t){return new Function(getStringFromWasm0(e,t))}function __wbg_new_with_str_and_init_c5748f76f5108934(){return handleError((function(e,t,r){return new Request(getStringFromWasm0(e,t),r)}),arguments)}function __wbg_next_138a17bbf04e926c(e){return e.next}function __wbg_next_3cfe5c0fe2a4cc53(){return handleError((function(e){return e.next()}),arguments)}function __wbg_prototypesetcall_dfe9b766cdc1f1fd(e,t,r){Uint8Array.prototype.set.call(getArrayU8FromWasm0(e,t),r)}function __wbg_queueMicrotask_9b549dfce8865860(e){return e.queueMicrotask}function __wbg_queueMicrotask_fca69f5bfad613a5(e){queueMicrotask(e)}function __wbg_resolve_fd5bfbaa4ce36e1e(e){return Promise.resolve(e)}function __wbg_setTimeout_7bb3429662ab1e70(e,t){return setTimeout(e,t)}function __wbg_set_3f1d0b984ed272ed(e,t,r){e[t]=r}function __wbg_set_7df433eea03a5c14(e,t,r){e[t>>>0]=r}function __wbg_set_body_8e743242d6076a4f(e,t){e.body=t}function __wbg_set_cache_0e437c7c8e838b9b(e,t){e.cache=__wbindgen_enum_RequestCache[t]}function __wbg_set_credentials_55ae7c3c106fd5be(e,t){e.credentials=__wbindgen_enum_RequestCredentials[t]}function __wbg_set_efaaf145b9377369(e,t,r){return e.set(t,r)}function __wbg_set_headers_5671cf088e114d2b(e,t){e.headers=t}function __wbg_set_method_76c69e41b3570627(e,t,r){e.method=getStringFromWasm0(t,r)}function __wbg_set_mode_611016a6818fc690(e,t){e.mode=__wbindgen_enum_RequestMode[t]}function __wbg_set_signal_e89be862d0091009(e,t){e.signal=t}function __wbg_signal_3c14fbdc89694b39(e){return e.signal}function __wbg_static_accessor_GLOBAL_769e6b65d6557335(){const e=void 0===global?null:global;return isLikeNone(e)?0:addToExternrefTable0(e)}function __wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1(){const e="undefined"==typeof globalThis?null:globalThis;return isLikeNone(e)?0:addToExternrefTable0(e)}function __wbg_static_accessor_SELF_08f5a74c69739274(){const e="undefined"==typeof self?null:self;return isLikeNone(e)?0:addToExternrefTable0(e)}function __wbg_static_accessor_WINDOW_a8924b26aa92d024(){const e="undefined"==typeof window?null:window;return isLikeNone(e)?0:addToExternrefTable0(e)}function __wbg_status_9bfc680efca4bdfd(e){return e.status}function __wbg_stringify_655a6390e1f5eb6b(){return handleError((function(e){return JSON.stringify(e)}),arguments)}function __wbg_text_51046bb33d257f63(){return handleError((function(e){return e.text()}),arguments)}function __wbg_then_429f7caf1026411d(e,t,r){return e.then(t,r)}function __wbg_then_4f95312d68691235(e,t){return e.then(t)}function __wbg_url_b6d11838a4f95198(e,t){const r=passStringToWasm0(t.url,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),n=WASM_VECTOR_LEN;getDataViewMemory0().setInt32(e+4,n,!0),getDataViewMemory0().setInt32(e+0,r,!0)}function __wbg_value_57b7b035e117f7ee(e){return e.value}function __wbindgen_cast_2241b6af4c4b2941(e,t){return getStringFromWasm0(e,t)}function __wbindgen_cast_30b58faad0d6f3eb(e,t){return makeMutClosure(e,t,wasm$1.wasm_bindgen__closure__destroy__h8b7033e397b10754,wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294$1)}function __wbindgen_cast_4625c577ab2ec9ee(e){return BigInt.asUintN(64,e)}function __wbindgen_cast_5ebc69db61224060(e,t){return makeMutClosure(e,t,wasm$1.wasm_bindgen__closure__destroy__h7e2e361eb2fe2d90,wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76$1)}function __wbindgen_cast_9ae0607507abb057(e){return e}function __wbindgen_cast_d6cd19b81560fd6e(e){return e}function __wbindgen_init_externref_table(){const e=wasm$1.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)}URL=globalThis.URL;const __vite__wasmModule=await __vite__initWasm({"./xbase_wasm_bg.js":{__wbg_fetch_74a3e84ebd2c9a0e:__wbg_fetch_74a3e84ebd2c9a0e,__wbg_clearTimeout_7a42b49784aea641:__wbg_clearTimeout_7a42b49784aea641,__wbg_setTimeout_7bb3429662ab1e70:__wbg_setTimeout_7bb3429662ab1e70,__wbg_instanceof_Response_cd74d1c2ac92cb0b:__wbg_instanceof_Response_cd74d1c2ac92cb0b,__wbg_arrayBuffer_c04af4fce566092d:__wbg_arrayBuffer_c04af4fce566092d,__wbg_url_b6d11838a4f95198:__wbg_url_b6d11838a4f95198,__wbg_text_51046bb33d257f63:__wbg_text_51046bb33d257f63,__wbg_status_9bfc680efca4bdfd:__wbg_status_9bfc680efca4bdfd,__wbg_headers_654c30e1bcccc552:__wbg_headers_654c30e1bcccc552,__wbg_abort_399ecbcfd6ef3c8e:__wbg_abort_399ecbcfd6ef3c8e,__wbg_new_881a222c65f168fc:__wbg_new_881a222c65f168fc,__wbg_abort_07646c894ebbf2bd:__wbg_abort_07646c894ebbf2bd,__wbg_signal_3c14fbdc89694b39:__wbg_signal_3c14fbdc89694b39,__wbg_fetch_90447c28cc0b095e:__wbg_fetch_90447c28cc0b095e,__wbg_new_with_str_and_init_c5748f76f5108934:__wbg_new_with_str_and_init_c5748f76f5108934,__wbg_new_3c79b3bb1b32b7d3:__wbg_new_3c79b3bb1b32b7d3,__wbg_append_c5cbdf46455cc776:__wbg_append_c5cbdf46455cc776,__wbg_set_method_76c69e41b3570627:__wbg_set_method_76c69e41b3570627,__wbg_set_signal_e89be862d0091009:__wbg_set_signal_e89be862d0091009,__wbg_set_credentials_55ae7c3c106fd5be:__wbg_set_credentials_55ae7c3c106fd5be,__wbg_set_headers_5671cf088e114d2b:__wbg_set_headers_5671cf088e114d2b,__wbg_set_body_8e743242d6076a4f:__wbg_set_body_8e743242d6076a4f,__wbg_set_mode_611016a6818fc690:__wbg_set_mode_611016a6818fc690,__wbg_set_cache_0e437c7c8e838b9b:__wbg_set_cache_0e437c7c8e838b9b,__wbg_set_3f1d0b984ed272ed:__wbg_set_3f1d0b984ed272ed,__wbg_queueMicrotask_fca69f5bfad613a5:__wbg_queueMicrotask_fca69f5bfad613a5,__wbg_queueMicrotask_9b549dfce8865860:__wbg_queueMicrotask_9b549dfce8865860,__wbg_new_b546ae120718850e:__wbg_new_b546ae120718850e,__wbg_new_25f239778d6112b9:__wbg_new_25f239778d6112b9,__wbg_new_1ba21ce319a06297:__wbg_new_1ba21ce319a06297,__wbg_new_no_args_cb138f77cf6151ee:__wbg_new_no_args_cb138f77cf6151ee,__wbg_new_6421f6084cc5bc5a:__wbg_new_6421f6084cc5bc5a,__wbg_length_22ac23eaec9d8053:__wbg_length_22ac23eaec9d8053,__wbg_new_from_slice_f9c22b9153b26992:__wbg_new_from_slice_f9c22b9153b26992,__wbg_prototypesetcall_dfe9b766cdc1f1fd:__wbg_prototypesetcall_dfe9b766cdc1f1fd,__wbg_done_62ea16af4ce34b24:__wbg_done_62ea16af4ce34b24,__wbg_value_57b7b035e117f7ee:__wbg_value_57b7b035e117f7ee,__wbg_set_efaaf145b9377369:__wbg_set_efaaf145b9377369,__wbg_set_7df433eea03a5c14:__wbg_set_7df433eea03a5c14,__wbg_iterator_27b7c8b35ab3e86b:__wbg_iterator_27b7c8b35ab3e86b,__wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1:__wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1,__wbg_static_accessor_SELF_08f5a74c69739274:__wbg_static_accessor_SELF_08f5a74c69739274,__wbg_static_accessor_GLOBAL_769e6b65d6557335:__wbg_static_accessor_GLOBAL_769e6b65d6557335,__wbg_static_accessor_WINDOW_a8924b26aa92d024:__wbg_static_accessor_WINDOW_a8924b26aa92d024,__wbg_new_ff12d2b041fb48f1:__wbg_new_ff12d2b041fb48f1,__wbg_then_4f95312d68691235:__wbg_then_4f95312d68691235,__wbg_then_429f7caf1026411d:__wbg_then_429f7caf1026411d,__wbg_resolve_fd5bfbaa4ce36e1e:__wbg_resolve_fd5bfbaa4ce36e1e,__wbg_call_abb4ff46ce38be40:__wbg_call_abb4ff46ce38be40,__wbg_call_3020136f7a2d6e44:__wbg_call_3020136f7a2d6e44,__wbg_next_138a17bbf04e926c:__wbg_next_138a17bbf04e926c,__wbg_next_3cfe5c0fe2a4cc53:__wbg_next_3cfe5c0fe2a4cc53,__wbg_get_af9dab7e9603ea93:__wbg_get_af9dab7e9603ea93,__wbg_has_0e670569d65d3a45:__wbg_has_0e670569d65d3a45,__wbg_stringify_655a6390e1f5eb6b:__wbg_stringify_655a6390e1f5eb6b,__wbg___wbindgen_throw_dd24417ed36fc46e:__wbg___wbindgen_throw_dd24417ed36fc46e,__wbg_Error_52673b7de5a0ca89:__wbg_Error_52673b7de5a0ca89,__wbg___wbindgen_is_object_ce774f3490692386:__wbg___wbindgen_is_object_ce774f3490692386,__wbg___wbindgen_is_string_704ef9c8fc131030:__wbg___wbindgen_is_string_704ef9c8fc131030,__wbg___wbindgen_string_get_a2a31e16edf96e42:__wbg___wbindgen_string_get_a2a31e16edf96e42,__wbg___wbindgen_is_function_8d400b8b1af978cd:__wbg___wbindgen_is_function_8d400b8b1af978cd,__wbg___wbindgen_is_undefined_f6b95eab589e0269:__wbg___wbindgen_is_undefined_f6b95eab589e0269,__wbg___wbindgen_debug_string_adfb662ae34724b6:__wbg___wbindgen_debug_string_adfb662ae34724b6,__wbg__wbg_cb_unref_87dfb5aaa0cbcea7:__wbg__wbg_cb_unref_87dfb5aaa0cbcea7,__wbindgen_init_externref_table:__wbindgen_init_externref_table,__wbindgen_cast_9ae0607507abb057:__wbindgen_cast_9ae0607507abb057,__wbindgen_cast_4625c577ab2ec9ee:__wbindgen_cast_4625c577ab2ec9ee,__wbindgen_cast_2241b6af4c4b2941:__wbindgen_cast_2241b6af4c4b2941,__wbindgen_cast_30b58faad0d6f3eb:__wbindgen_cast_30b58faad0d6f3eb,__wbindgen_cast_d6cd19b81560fd6e:__wbindgen_cast_d6cd19b81560fd6e,__wbindgen_cast_5ebc69db61224060:__wbindgen_cast_5ebc69db61224060}},__vite__wasmUrl),memory=__vite__wasmModule.memory,fetch_data_json=__vite__wasmModule.fetch_data_json,fetch_data_text=__vite__wasmModule.fetch_data_text,md5=__vite__wasmModule.md5,xxtea_decrypt=__vite__wasmModule.xxtea_decrypt,xxtea_decrypt_string=__vite__wasmModule.xxtea_decrypt_string,xxtea_encrypt=__vite__wasmModule.xxtea_encrypt,xxtea_encrypt_string=__vite__wasmModule.xxtea_encrypt_string,wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294=__vite__wasmModule.wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294,wasm_bindgen__closure__destroy__h8b7033e397b10754=__vite__wasmModule.wasm_bindgen__closure__destroy__h8b7033e397b10754,wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76=__vite__wasmModule.wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76,wasm_bindgen__closure__destroy__h7e2e361eb2fe2d90=__vite__wasmModule.wasm_bindgen__closure__destroy__h7e2e361eb2fe2d90,wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811=__vite__wasmModule.wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811,__wbindgen_malloc=__vite__wasmModule.__wbindgen_malloc,__wbindgen_realloc=__vite__wasmModule.__wbindgen_realloc,__wbindgen_exn_store=__vite__wasmModule.__wbindgen_exn_store,__externref_table_alloc=__vite__wasmModule.__externref_table_alloc,__wbindgen_externrefs=__vite__wasmModule.__wbindgen_externrefs,__wbindgen_free=__vite__wasmModule.__wbindgen_free,__wbindgen_start=__vite__wasmModule.__wbindgen_start,wasm=Object.freeze(Object.defineProperty({__proto__:null,__externref_table_alloc:__externref_table_alloc,__wbindgen_exn_store:__wbindgen_exn_store,__wbindgen_externrefs:__wbindgen_externrefs,__wbindgen_free:__wbindgen_free,__wbindgen_malloc:__wbindgen_malloc,__wbindgen_realloc:__wbindgen_realloc,__wbindgen_start:__wbindgen_start,fetch_data_json:fetch_data_json,fetch_data_text:fetch_data_text,md5:md5,memory:memory,wasm_bindgen__closure__destroy__h7e2e361eb2fe2d90:wasm_bindgen__closure__destroy__h7e2e361eb2fe2d90,wasm_bindgen__closure__destroy__h8b7033e397b10754:wasm_bindgen__closure__destroy__h8b7033e397b10754,wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811:wasm_bindgen__convert__closures_____invoke__h55ed001df9e74811,wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76:wasm_bindgen__convert__closures_____invoke__h8a93979ee33aae76,wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294:wasm_bindgen__convert__closures_____invoke__hb9fe2611f414a294,xxtea_decrypt:xxtea_decrypt,xxtea_decrypt_string:xxtea_decrypt_string,xxtea_encrypt:xxtea_encrypt,xxtea_encrypt_string:xxtea_encrypt_string},Symbol.toStringTag,{value:"Module"}));__wbg_set_wasm(wasm),__wbindgen_start();const QHeader=createComponent({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=inject(layoutKey,emptyRenderFn);if(i===emptyRenderFn)return emptyRenderFn;const o=ref$1(parseInt(e.heightHint,10)),a=ref$1(!0),s=computed((()=>!0===e.reveal||-1!==i.view.value.indexOf("H")||n.platform.is.ios&&!0===i.isContainer.value)),l=computed((()=>{if(!0!==e.modelValue)return 0;if(!0===s.value)return!0===a.value?o.value:0;const t=o.value-i.scroll.value.position;return t>0?t:0})),c=computed((()=>!0!==e.modelValue||!0===s.value&&!0!==a.value)),u=computed((()=>!0===e.modelValue&&!0===c.value&&!0===e.reveal)),h=computed((()=>"q-header q-layout__section--marginal "+(!0===s.value?"fixed":"absolute")+"-top"+(!0===e.bordered?" q-header--bordered":"")+(!0===c.value?" q-header--hidden":"")+(!0!==e.modelValue?" q-layout--prevent-focus":""))),d=computed((()=>{const e=i.rows.value.top,t={};return"l"===e[0]&&!0===i.left.space&&(t[!0===n.lang.rtl?"right":"left"]=`${i.left.size}px`),"r"===e[2]&&!0===i.right.space&&(t[!0===n.lang.rtl?"left":"right"]=`${i.right.size}px`),t}));function p(e,t){i.update("header",e,t)}function f(e,t){e.value!==t&&(e.value=t)}function m({height:e}){f(o,e),p("size",e)}function g(e){!0===u.value&&f(a,!0),r("focusin",e)}watch$2((()=>e.modelValue),(e=>{p("space",e),f(a,!0),i.animate()})),watch$2(l,(e=>{p("offset",e)})),watch$2((()=>e.reveal),(t=>{!1===t&&f(a,e.modelValue)})),watch$2(a,(e=>{i.animate(),r("reveal",e)})),watch$2(i.scroll,(t=>{!0===e.reveal&&f(a,"up"===t.direction||t.position<=e.revealOffset||t.position-t.inflectionPoint<100)}));const y={};return i.instances.header=y,!0===e.modelValue&&p("size",o.value),p("space",e.modelValue),p("offset",l.value),onBeforeUnmount((()=>{i.instances.header===y&&(i.instances.header=void 0,p("size",0),p("offset",0),p("space",!1))})),()=>{const r=hUniqueSlot(t.default,[]);return!0===e.elevated&&r.push(h$2("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),r.push(h$2(QResizeObserver,{debounce:0,onResize:m})),h$2("header",{class:h.value,style:d.value,onFocusin:g},r)}}}),QFooter=createComponent({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=inject(layoutKey,emptyRenderFn);if(i===emptyRenderFn)return emptyRenderFn;const o=ref$1(parseInt(e.heightHint,10)),a=ref$1(!0),s=ref$1(!0===isRuntimeSsrPreHydration.value||!0===i.isContainer.value?0:window.innerHeight),l=computed((()=>!0===e.reveal||-1!==i.view.value.indexOf("F")||n.platform.is.ios&&!0===i.isContainer.value)),c=computed((()=>!0===i.isContainer.value?i.containerHeight.value:s.value)),u=computed((()=>{if(!0!==e.modelValue)return 0;if(!0===l.value)return!0===a.value?o.value:0;const t=i.scroll.value.position+c.value+o.value-i.height.value;return t>0?t:0})),h=computed((()=>!0!==e.modelValue||!0===l.value&&!0!==a.value)),d=computed((()=>!0===e.modelValue&&!0===h.value&&!0===e.reveal)),p=computed((()=>"q-footer q-layout__section--marginal "+(!0===l.value?"fixed":"absolute")+"-bottom"+(!0===e.bordered?" q-footer--bordered":"")+(!0===h.value?" q-footer--hidden":"")+(!0!==e.modelValue?" q-layout--prevent-focus"+(!0!==l.value?" hidden":""):""))),f=computed((()=>{const e=i.rows.value.bottom,t={};return"l"===e[0]&&!0===i.left.space&&(t[!0===n.lang.rtl?"right":"left"]=`${i.left.size}px`),"r"===e[2]&&!0===i.right.space&&(t[!0===n.lang.rtl?"left":"right"]=`${i.right.size}px`),t}));function m(e,t){i.update("footer",e,t)}function g(e,t){e.value!==t&&(e.value=t)}function y({height:e}){g(o,e),m("size",e)}function _(e){!0===d.value&&g(a,!0),r("focusin",e)}watch$2((()=>e.modelValue),(e=>{m("space",e),g(a,!0),i.animate()})),watch$2(u,(e=>{m("offset",e)})),watch$2((()=>e.reveal),(t=>{!1===t&&g(a,e.modelValue)})),watch$2(a,(e=>{i.animate(),r("reveal",e)})),watch$2([o,i.scroll,i.height],(function(){if(!0!==e.reveal)return;const{direction:t,position:r,inflectionPoint:n}=i.scroll.value;g(a,"up"===t||r-n<100||i.height.value-c.value-r-o.value<300)})),watch$2((()=>n.screen.height),(e=>{!0!==i.isContainer.value&&g(s,e)}));const v={};return i.instances.footer=v,!0===e.modelValue&&m("size",o.value),m("space",e.modelValue),m("offset",u.value),onBeforeUnmount((()=>{i.instances.footer===v&&(i.instances.footer=void 0,m("size",0),m("offset",0),m("space",!1))})),()=>{const r=hMergeSlot(t.default,[h$2(QResizeObserver,{debounce:0,onResize:y})]);return!0===e.elevated&&r.push(h$2("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),h$2("footer",{class:p.value,style:f.value,onFocusin:_},r)}}}),QRouteTab=createComponent({name:"QRouteTab",props:{...useRouterLinkProps,...useTabProps},emits:useTabEmits,setup(e,{slots:t,emit:r}){const n=useRouterLink({useDisableForRouterLinkProps:!1}),{renderTab:i,$tabs:o}=useTab(e,t,r,{exact:computed((()=>e.exact)),...n});return watch$2((()=>`${e.name} | ${e.exact} | ${(n.resolvedLink.value||{}).href}`),o.verifyRouteModel),()=>i(n.linkTag.value,n.linkAttrs.value)}}),QBreadcrumbsEl=createComponent({name:"QBreadcrumbsEl",props:{...useRouterLinkProps,label:String,icon:String,tag:{type:String,default:"span"}},emits:["click"],setup(e,{slots:t}){const{linkTag:r,linkAttrs:n,linkClass:i,navigateOnClick:o}=useRouterLink(),a=computed((()=>({class:"q-breadcrumbs__el q-link flex inline items-center relative-position "+(!0!==e.disable?"q-link--focusable"+i.value:"q-breadcrumbs__el--disable"),...n.value,onClick:o}))),s=computed((()=>"q-breadcrumbs__el-icon"+(void 0!==e.label?" q-breadcrumbs__el-icon--with-label":"")));return()=>{const n=[];return void 0!==e.icon&&n.push(h$2(QIcon,{class:s.value,name:e.icon})),void 0!==e.label&&n.push(e.label),h$2(r.value,{...a.value},hMergeSlot(t.default,n))}}}),disabledValues=["",!0],QBreadcrumbs=createComponent({name:"QBreadcrumbs",props:{...useAlignProps,separator:{type:String,default:"/"},separatorColor:String,activeColor:{type:String,default:"primary"},gutter:{type:String,validator:e=>["none","xs","sm","md","lg","xl"].includes(e),default:"sm"}},setup(e,{slots:t}){const r=useAlign(e),n=computed((()=>`flex items-center ${r.value}${"none"===e.gutter?"":` q-gutter-${e.gutter}`}`)),i=computed((()=>e.separatorColor?` text-${e.separatorColor}`:"")),o=computed((()=>` text-${e.activeColor}`));return()=>{if(void 0===t.default)return;const r=getNormalizedVNodes(hSlot(t.default));if(0===r.length)return;let a=1;const s=[],l=r.filter((e=>"QBreadcrumbsEl"===e.type?.name)).length,c=void 0!==t.separator?t.separator:()=>e.separator;return r.forEach((e=>{if("QBreadcrumbsEl"===e.type?.name){const t=a<l,r=(!0===t?"":" q-breadcrumbs--last")+(!0!==(null!==e.props&&disabledValues.includes(e.props.disable))&&!0===t?o.value:"");a++,s.push(h$2("div",{class:`flex items-center${r}`},[e])),!0===t&&s.push(h$2("div",{class:"q-breadcrumbs__separator"+i.value},c()))}else s.push(e)})),h$2("div",{class:"q-breadcrumbs"},[h$2("div",{class:n.value},s)])}}}),QSlideTransition=createComponent({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:t,emit:r}){let n,i,o,a,s=!1,l=null,c=null;function u(){n?.(),n=null,s=!1,null!==l&&(clearTimeout(l),l=null),null!==c&&(clearTimeout(c),c=null),i?.removeEventListener("transitionend",o),o=null}function h(t,r,i){void 0!==r&&(t.style.height=`${r}px`),t.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,s=!0,n=i}function d(e,t){e.style.overflowY=null,e.style.height=null,e.style.transition=null,u(),t!==a&&r(t)}function p(t,r){let n=0;i=t,!0===s?(u(),n=t.offsetHeight===t.scrollHeight?0:void 0):(a="hide",t.style.overflowY="hidden"),h(t,n,r),l=setTimeout((()=>{l=null,t.style.height=`${t.scrollHeight}px`,o=e=>{c=null,Object(e)===e&&e.target!==t||d(t,"show")},t.addEventListener("transitionend",o),c=setTimeout(o,1.1*e.duration)}),100)}function f(t,r){let n;i=t,!0===s?u():(a="show",t.style.overflowY="hidden",n=t.scrollHeight),h(t,n,r),l=setTimeout((()=>{l=null,t.style.height=0,o=e=>{c=null,Object(e)===e&&e.target!==t||d(t,"hide")},t.addEventListener("transitionend",o),c=setTimeout(o,1.1*e.duration)}),100)}return onBeforeUnmount((()=>{!0===s&&u()})),()=>h$2(Transition,{css:!1,appear:e.appear,onEnter:p,onLeave:f},t.default)}}),itemGroups=shallowReactive({}),LINK_PROPS=Object.keys(useRouterLinkProps),QExpansionItem=createComponent({name:"QExpansionItem",props:{...useRouterLinkProps,...useModelToggleProps,...useDarkProps,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...useModelToggleEmits,"click","afterShow","afterHide"],setup(e,{slots:t,emit:r}){const{proxy:{$q:n}}=getCurrentInstance(),i=useDark(e,n),o=ref$1(null!==e.modelValue?e.modelValue:e.defaultOpened),a=ref$1(null),s=useId(),{show:l,hide:c,toggle:u}=useModelToggle({showing:o});let h,d;const p=computed((()=>`q-expansion-item q-item-type q-expansion-item--${!0===o.value?"expanded":"collapsed"} q-expansion-item--${!0===e.popup?"popup":"standard"}`)),f=computed((()=>{if(void 0===e.contentInsetLevel)return null;const t=!0===n.lang.rtl?"Right":"Left";return{["padding"+t]:56*e.contentInsetLevel+"px"}})),m=computed((()=>!0!==e.disable&&(void 0!==e.href||void 0!==e.to&&null!==e.to&&""!==e.to))),g=computed((()=>{const t={};return LINK_PROPS.forEach((r=>{t[r]=e[r]})),t})),y=computed((()=>!0===m.value||!0!==e.expandIconToggle)),_=computed((()=>void 0!==e.expandedIcon&&!0===o.value?e.expandedIcon:e.expandIcon||n.iconSet.expansionItem[!0===e.denseToggle?"denseIcon":"icon"])),v=computed((()=>!0!==e.disable&&(!0===m.value||!0===e.expandIconToggle))),b=computed((()=>({expanded:!0===o.value,detailsId:s.value,toggle:u,show:l,hide:c}))),w=computed((()=>{const t=void 0!==e.toggleAriaLabel?e.toggleAriaLabel:n.lang.label[!0===o.value?"collapse":"expand"](e.label);return{role:"button","aria-expanded":!0===o.value?"true":"false","aria-controls":s.value,"aria-label":t}}));function x(e){!0!==m.value&&u(e),r("click",e)}function S(e){13===e.keyCode&&E(e,!0)}function E(e,t){!0!==t&&!0!==e.qAvoidFocus&&a.value?.focus(),u(e),stopAndPrevent$1(e)}function T(){r("afterShow")}function A(){r("afterHide")}function C(){void 0===h&&(h=uid$3()),!0===o.value&&(itemGroups[e.group]=h);const t=watch$2(o,(t=>{!0===t?itemGroups[e.group]=h:itemGroups[e.group]===h&&delete itemGroups[e.group]})),r=watch$2((()=>itemGroups[e.group]),((e,t)=>{t===h&&void 0!==e&&e!==h&&c()}));d=()=>{t(),r(),itemGroups[e.group]===h&&delete itemGroups[e.group],d=void 0}}function I(){let r;return void 0!==t.header?r=[].concat(t.header(b.value)):(r=[h$2(QItemSection,(()=>[h$2(QItemLabel,{lines:e.labelLines},(()=>e.label||"")),e.caption?h$2(QItemLabel,{lines:e.captionLines,caption:!0},(()=>e.caption)):null]))],e.icon&&r[!0===e.switchToggleSide?"push":"unshift"](h$2(QItemSection,{side:!0===e.switchToggleSide,avatar:!0!==e.switchToggleSide},(()=>h$2(QIcon,{name:e.icon}))))),!0!==e.disable&&!0!==e.hideExpandIcon&&r[!0===e.switchToggleSide?"unshift":"push"](function(){const t={class:["q-focusable relative-position cursor-pointer"+(!0===e.denseToggle&&!0===e.switchToggleSide?" items-end":""),e.expandIconClass],side:!0!==e.switchToggleSide,avatar:e.switchToggleSide},r=[h$2(QIcon,{class:"q-expansion-item__toggle-icon"+(void 0===e.expandedIcon&&!0===o.value?" q-expansion-item__toggle-icon--rotated":""),name:_.value})];return!0===v.value&&(Object.assign(t,{tabindex:0,...w.value,onClick:E,onKeyup:S}),r.unshift(h$2("div",{ref:a,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),h$2(QItemSection,t,(()=>r))}()),r}function k(){const t={ref:"item",style:e.headerStyle,class:e.headerClass,dark:i.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return!0===y.value&&(t.clickable=!0,t.onClick=x,Object.assign(t,!0===m.value?g.value:w.value)),h$2(QItem,t,I)}function P(){return withDirectives(h$2("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:f.value,id:s.value},hSlot(t.default)),[[vShow,o.value]])}function M(){const t=[k(),h$2(QSlideTransition,{duration:e.duration,onShow:T,onHide:A},P)];return!0===e.expandSeparator&&t.push(h$2(QSeparator,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:i.value}),h$2(QSeparator,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:i.value})),t}return watch$2((()=>e.group),(e=>{d?.(),void 0!==e&&C()})),void 0!==e.group&&C(),onBeforeUnmount((()=>{d?.()})),()=>h$2("div",{class:p.value},[h$2("div",{class:"q-expansion-item__container relative-position"},M())])}});function parseFeatures(e){const t=Object.assign({noopener:!0},e),r=[];for(const n in t){const e=t[n];!0===e?r.push(n):(isNumber$2(e)||"string"==typeof e&&""!==e)&&r.push(n+"="+e)}return r.join(",")}function openWindow(e,t,r){let n=window.open;if(!0===Platform.is.cordova)if(void 0!==cordova?.InAppBrowser?.open)n=cordova.InAppBrowser.open;else if(void 0!==navigator?.app)return navigator.app.loadUrl(e,{openExternal:!0});const i=n(e,"_blank",parseFeatures(r));if(i)return Platform.is.desktop&&i.focus(),i}const openURL=(e,t,r)=>{if(!0!==Platform.is.ios||void 0===window.SafariViewController)return openWindow(e,t,r);window.SafariViewController.isAvailable((n=>{n?window.SafariViewController.show({url:e},noop$2,t):openWindow(e,t,r)}))},QToolbarTitle=createComponent({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:t}){const r=computed((()=>"q-toolbar__title ellipsis"+(!0===e.shrink?" col-shrink":"")));return()=>h$2("div",{class:r.value},hSlot(t.default))}});
/*! Capacitor: https://capacitorjs.com/ - MIT License */
var ExceptionCode,ExceptionCode2;ExceptionCode2=ExceptionCode||(ExceptionCode={}),ExceptionCode2.Unimplemented="UNIMPLEMENTED",ExceptionCode2.Unavailable="UNAVAILABLE";class CapacitorException extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const getPlatformId=e=>{var t,r;return(null==e?void 0:e.androidBridge)?"android":(null===(r=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===r?void 0:r.bridge)?"ios":"web"},createCapacitor=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},n=r.Plugins=r.Plugins||{},i=()=>null!==t?t.name:getPlatformId(e),o=e=>{var t;return null===(t=r.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))},a=new Map;return r.convertFileSrc||(r.convertFileSrc=e=>e),r.getPlatform=i,r.handleError=t=>e.console.error(t),r.isNativePlatform=()=>"web"!==i(),r.isPluginAvailable=e=>{const t=a.get(e);return!!(null==t?void 0:t.platforms.has(i()))||!!o(e)},r.registerPlugin=(e,s={})=>{const l=a.get(e);if(l)return l.proxy;const c=i(),u=o(e);let h;const d=n=>{let i;const o=(...o)=>{const a=(async()=>(!h&&c in s?h=h="function"==typeof s[c]?await s[c]():s[c]:null!==t&&!h&&"web"in s&&(h=h="function"==typeof s.web?await s.web():s.web),h))().then((t=>{const a=((t,n)=>{var i,o;if(!u){if(t)return null===(o=t[n])||void 0===o?void 0:o.bind(t);throw new CapacitorException(`"${e}" plugin is not implemented on ${c}`,ExceptionCode.Unimplemented)}{const o=null==u?void 0:u.methods.find((e=>n===e.name));if(o)return"promise"===o.rtype?t=>r.nativePromise(e,n.toString(),t):(t,i)=>r.nativeCallback(e,n.toString(),t,i);if(t)return null===(i=t[n])||void 0===i?void 0:i.bind(t)}})(t,n);if(a){const e=a(...o);return i=null==e?void 0:e.remove,e}throw new CapacitorException(`"${e}.${n}()" is not implemented on ${c}`,ExceptionCode.Unimplemented)}));return"addListener"===n&&(a.remove=async()=>i()),a};return o.toString=()=>`${n.toString()}() { [capacitor code] }`,Object.defineProperty(o,"name",{value:n,writable:!1,configurable:!1}),o},p=d("addListener"),f=d("removeListener"),m=(e,t)=>{const r=p({eventName:e},t),n=async()=>{const n=await r;f({eventName:e,callbackId:n},t)},i=new Promise((e=>r.then((()=>e({remove:n})))));return i.remove=async()=>{await n()},i},g=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return u?m:p;case"removeListener":return f;default:return d(t)}}});return n[e]=g,a.set(e,{name:e,proxy:g,platforms:new Set([...Object.keys(s),...u?[c]:[]])}),g},r.Exception=CapacitorException,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},initCapacitorGlobal=e=>e.Capacitor=createCapacitor(e),Capacitor=initCapacitorGlobal("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:{}),registerPlugin=Capacitor.registerPlugin;class WebPlugin{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),r&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const n=this.listeners[e];if(n)n.forEach((e=>e(t)));else if(r){let r=this.retainedEventArguments[e];r||(r=[]),r.push(t),this.retainedEventArguments[e]=r}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new Capacitor.Exception(e,ExceptionCode.Unimplemented)}unavailable(e="not available"){return new Capacitor.Exception(e,ExceptionCode.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const n=r.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach((t=>{this.notifyListeners(e,t)})))}}const encode=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),decode=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class CapacitorCookiesPluginWeb extends WebPlugin{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[r,n]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=decode(r).trim(),n=decode(n).trim(),t[r]=n})),t}async setCookie(e){try{const t=encode(e.key),r=encode(e.value),n=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${n}; path=${i}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}registerPlugin("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});const readBlobAsBase64=async e=>new Promise(((t,r)=>{const n=new FileReader;n.onload=()=>{const e=n.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},n.onerror=e=>r(e),n.readAsDataURL(e)})),normalizeHttpHeaders=(e={})=>{const t=Object.keys(e);return Object.keys(e).map((e=>e.toLocaleLowerCase())).reduce(((r,n,i)=>(r[n]=e[t[i]],r)),{})},buildUrlParams=(e,t=!0)=>{if(!e)return null;return Object.entries(e).reduce(((e,r)=>{const[n,i]=r;let o,a;return Array.isArray(i)?(a="",i.forEach((e=>{o=t?encodeURIComponent(e):e,a+=`${n}=${o}&`})),a.slice(0,-1)):(o=t?encodeURIComponent(i):i,a=`${n}=${o}`),`${e}&${a}`}),"").substr(1)},buildRequestInit=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),n=normalizeHttpHeaders(e.headers)["content-type"]||"";if("string"==typeof e.data)r.body=e.data;else if(n.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[r,n]of Object.entries(e.data||{}))t.set(r,n);r.body=t.toString()}else if(n.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,r)=>{t.append(r,e)}));else for(const r of Object.keys(e.data))t.append(r,e.data[r]);r.body=t;const n=new Headers(r.headers);n.delete("content-type"),r.headers=n}else(n.includes("application/json")||"object"==typeof e.data)&&(r.body=JSON.stringify(e.data));return r};class CapacitorHttpPluginWeb extends WebPlugin{async request(e){const t=buildRequestInit(e,e.webFetchExtra),r=buildUrlParams(e.params,e.shouldEncodeUrlParams),n=r?`${e.url}?${r}`:e.url,i=await fetch(n,t),o=i.headers.get("content-type")||"";let a,s,{responseType:l="text"}=i.ok?e:{};switch(o.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":s=await i.blob(),a=await readBlobAsBase64(s);break;case"json":a=await i.json();break;default:a=await i.text()}const c={};return i.headers.forEach(((e,t)=>{c[t]=e})),{data:a,headers:c,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}var SystemBarsStyle,SystemBarsStyle2,SystemBarType,SystemBarType2;registerPlugin("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb}),SystemBarsStyle2=SystemBarsStyle||(SystemBarsStyle={}),SystemBarsStyle2.Dark="DARK",SystemBarsStyle2.Light="LIGHT",SystemBarsStyle2.Default="DEFAULT",SystemBarType2=SystemBarType||(SystemBarType={}),SystemBarType2.StatusBar="StatusBar",SystemBarType2.NavigationBar="NavigationBar";class SystemBarsPluginWeb extends WebPlugin{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}registerPlugin("SystemBars",{web:()=>new SystemBarsPluginWeb});const Device=registerPlugin("Device",{web:()=>__vitePreload((()=>Promise.resolve().then((()=>web))),void 0,import.meta.url).then((e=>new e.DeviceWeb))});var maplibreGl$1={exports:{}},maplibreGl=maplibreGl$1.exports,hasRequiredMaplibreGl;
/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.17.0/LICENSE.txt
 */function requireMaplibreGl(){return hasRequiredMaplibreGl||(hasRequiredMaplibreGl=1,maplibreGl$1.exports=function(){var e={},t={};function r(r,n,i){if(t[r]=i,"index"===r){var o="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",a={};return t.shared(a),t.index(e,a),"undefined"!=typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))),e}}return r("shared",["exports"],(function(e){function t(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function r(e,t){this.x=e,this.y=t}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i,o;"function"==typeof SuppressedError&&SuppressedError,r.prototype={clone(){return new r(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:r},r.convert=function(e){if(e instanceof r)return e;if(Array.isArray(e))return new r(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new r(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};var a=function(){if(o)return i;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return o=1,i=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},i}(),s=n(a);let l,c;function u(){return null==l&&(l="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),l}function h(){if(null==c&&(c=!1,u())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let n=0;n<e*e;n++){const r=4*n;t.fillStyle=`rgb(${r},${r+1},${r+2})`,t.fillRect(n%e,Math.floor(n/e),1,1)}const r=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&r[t]!==t){c=!0;break}}}return c||!1}var d=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array;function f(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function m(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function y(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function _(e,t,r){var n=new p(3);return n[0]=e,n[1]=t,n[2]=r,n}function v(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function w(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2];return e[0]=i*l-o*s,e[1]=o*a-n*l,e[2]=n*s-i*a,e}var x,S=y;function E(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function T(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function A(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"zyx",o=Math.PI/360;t*=o,n*=o,r*=o;var a=Math.sin(t),s=Math.cos(t),l=Math.sin(r),c=Math.cos(r),u=Math.sin(n),h=Math.cos(n);switch(i){case"xyz":e[0]=a*c*h+s*l*u,e[1]=s*l*h-a*c*u,e[2]=s*c*u+a*l*h,e[3]=s*c*h-a*l*u;break;case"xzy":e[0]=a*c*h-s*l*u,e[1]=s*l*h-a*c*u,e[2]=s*c*u+a*l*h,e[3]=s*c*h+a*l*u;break;case"yxz":e[0]=a*c*h+s*l*u,e[1]=s*l*h-a*c*u,e[2]=s*c*u-a*l*h,e[3]=s*c*h+a*l*u;break;case"yzx":e[0]=a*c*h+s*l*u,e[1]=s*l*h+a*c*u,e[2]=s*c*u-a*l*h,e[3]=s*c*h-a*l*u;break;case"zxy":e[0]=a*c*h-s*l*u,e[1]=s*l*h+a*c*u,e[2]=s*c*u+a*l*h,e[3]=s*c*h-a*l*u;break;case"zyx":e[0]=a*c*h-s*l*u,e[1]=s*l*h+a*c*u,e[2]=s*c*u-a*l*h,e[3]=s*c*h+a*l*u;break;default:throw new Error("Unknown angle order "+i)}return e}function C(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function I(e,t){var r=new p(2);return r[0]=e,r[1]=t,r}g(),x=new p(4),p!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0,x[3]=0),g(),_(1,0,0),_(0,1,0),T(),T(),f(),C();const k=8192;function P(e,t,r){return t*(k/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}function M(e,t){return(e%t+t)%t}function R(e,t,r){return e*(1-r)+t*r}function D(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function O(e,t,r,n){const i=new s(e,t,r,n);return e=>i.solve(e)}const L=O(.25,.1,.25,1);function B(e,t,r){return Math.min(r,Math.max(t,e))}function $(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function z(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}let F=1;function q(e,t,r){const n={};for(const i in e)n[i]=t.call(this,e[i],i,e);return n}function N(e,t,r){const n={};for(const i in e)t.call(this,e[i],i,e)&&(n[i]=e[i]);return n}function j(e){return Array.isArray(e)?e.map(j):"object"==typeof e&&e?q(e,j):e}const U={};function V(e){U[e]||(U[e]=!0)}function G(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function W(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let H=null;function Z(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function X(e,r,n,i,o){return t(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const a=null==t?void 0:t.format;if(!a||!a.startsWith("BGR")&&!a.startsWith("RGB"))throw new Error(`Unrecognized format ${a}`);const s=a.startsWith("BGR"),l=new Uint8ClampedArray(i*o*4);if(yield t.copyTo(l,function(e,t,r,n,i){const o=4*Math.max(-t,0),a=(Math.max(0,r)-r)*n*4+o,s=4*n,l=Math.max(0,t),c=Math.max(0,r);return{rect:{x:l,y:c,width:Math.min(e.width,t+n)-l,height:Math.min(e.height,r+i)-c},layout:[{offset:a,stride:s}]}}(e,r,n,i,o)),s)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}}))}let K,Q;function J(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}function ee(e){return e*Math.PI/180}function te(e){return e/Math.PI*180}const re={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ne={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ie="AbortError";class oe extends Error{constructor(e=ie){super(e instanceof Error?e.message:e),this.name=ie,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function ae(e){return e.name===ie}const se={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function le(e){return se.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const ce="global-dispatcher";class ue extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}}const he=()=>W(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,de=function(e,r){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){const t=le(e.url);if(t)return t(e,r);if(W(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:ce},r)}if(!(/^file:/.test(n=e.url)||/^file:/.test(he())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,r){return t(this,void 0,void 0,(function*(){const t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:he(),signal:r.signal});let n,i;"json"!==e.type||t.headers.has("Accept")||t.headers.set("Accept","application/json");try{n=yield fetch(t)}catch(a){if(ae(a))throw a;throw new ue(0,a.message,e.url,new Blob)}if(!n.ok){const t=yield n.blob();throw new ue(n.status,n.statusText,e.url,t)}i="arrayBuffer"===e.type||"image"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text();const o=yield i;return r.signal.throwIfAborted(),{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}))}(e,r);if(W(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:ce},r)}var n,i,o;return i=e,o=r,new Promise(((e,t)=>{var r;const n=new XMLHttpRequest;n.open(i.method||"GET",i.url,!0),"arrayBuffer"!==i.type&&"image"!==i.type||(n.responseType="arraybuffer");for(const o in i.headers)n.setRequestHeader(o,i.headers[o]);"json"===i.type&&(n.responseType="text",(null===(r=i.headers)||void 0===r?void 0:r.Accept)||n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===i.credentials,n.onerror=()=>{t(new Error(n.statusText))},n.onload=()=>{if(!o.signal.aborted)if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let o=n.response;if("json"===i.type)try{o=JSON.parse(n.response)}catch(r){return void t(r)}e({data:o,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")})}else{const e=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});t(new ue(n.status,n.statusText,i.url,e))}},o.signal.addEventListener("abort",(()=>{n.abort(),t(new oe(o.signal.reason))})),n.send(i.body)}))};function pe(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function fe(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function me(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}class ge{constructor(e,t={}){z(this,t),this.type=e}}class ye extends ge{constructor(e,t={}){super("error",z({error:e},t))}}class _e{on(e,t){return this._listeners=this._listeners||{},fe(e,t,this._listeners),{unsubscribe:()=>{this.off(e,t)}}}off(e,t){return me(e,t,this._listeners),me(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},fe(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new ge(e,t||{}));const r=e.type;if(this.listens(r)){e.target=this;const t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of t)r.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const o of n)me(r,o,this._oneTimeListeners),o.call(this,e);const i=this._eventedParent;i&&(z(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const be=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function we(e,t){const r={};for(const n in e)"ref"!==n&&(r[n]=e[n]);return be.forEach((e=>{e in t&&(r[e]=t[e])})),r}function xe(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!xe(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!xe(e[r],t[r]))return!1;return!0}return e===t}function Se(e,t){e.push(t)}function Ee(e,t,r){Se(r,{command:"addSource",args:[e,t[e]]})}function Te(e,t,r){Se(t,{command:"removeSource",args:[e]}),r[e]=!0}function Ae(e,t,r,n){Te(e,r,n),Ee(e,t,r)}function Ce(e,t,r){let n;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&"data"!==n&&!xe(e[r][n],t[r][n]))return!1;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&"data"!==n&&!xe(e[r][n],t[r][n]))return!1;return!0}function Ie(e,t,r,n,i,o){e=e||{},t=t||{};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(xe(e[a],t[a])||r.push({command:o,args:[n,a,t[a],i]}));for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&!Object.prototype.hasOwnProperty.call(e,a)&&(xe(e[a],t[a])||r.push({command:o,args:[n,a,t[a],i]}))}function ke(e){return e.id}function Pe(e,t){return e[t.id]=t,e}class Me{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function Re(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}class De extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Oe{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[r,n]of t)this.bindings[r]=n}concat(e){return new Oe(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Le={kind:"null"},Be={kind:"number"},$e={kind:"string"},ze={kind:"boolean"},Fe={kind:"color"},qe={kind:"projectionDefinition"},Ne={kind:"object"},je={kind:"value"},Ue={kind:"collator"},Ve={kind:"formatted"},Ge={kind:"padding"},We={kind:"colorArray"},He={kind:"numberArray"},Ze={kind:"resolvedImage"},Ye={kind:"variableAnchorOffsetCollection"};function Xe(e,t){return{kind:"array",itemType:e,N:t}}function Ke(e){if("array"===e.kind){const t=Ke(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const Qe=[Le,Be,$e,ze,Fe,qe,Ve,Ne,Xe(je),Ge,He,We,Ze,Ye];function Je(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Je(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of Qe)if(!Je(e,t))return null}return`Expected ${Ke(e)} but found ${Ke(t)} instead.`}function et(e,t){return t.some((t=>t.kind===e.kind))}function tt(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function rt(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const nt=.96422,it=.82521,ot=4/29,at=6/29,st=3*at*at,lt=at*at*at,ct=Math.PI/180,ut=180/Math.PI;function ht(e){return(e%=360)<0&&(e+=360),e}function dt([e,t,r,n]){let i,o;const a=ft((.2225045*(e=pt(e))+.7168786*(t=pt(t))+.0606169*(r=pt(r)))/1);e===t&&t===r?i=o=a:(i=ft((.4360747*e+.3850649*t+.1430804*r)/nt),o=ft((.0139322*e+.0971045*t+.7141733*r)/it));const s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function pt(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ft(e){return e>lt?Math.pow(e,1/3):e/st+ot}function mt([e,t,r,n]){let i=(e+16)/116,o=isNaN(t)?i:i+t/500,a=isNaN(r)?i:i-r/200;return i=1*yt(i),o=nt*yt(o),a=it*yt(a),[gt(3.1338561*o-1.6168667*i-.4906146*a),gt(-.9787684*o+1.9161415*i+.033454*a),gt(.0719453*o-.2289914*i+1.4052427*a),n]}function gt(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function yt(e){return e>at?e*e*e:st*(e-ot)}const _t=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function vt(e,t){return _t(e,t)?e[t]:void 0}function bt(e){return parseInt(e.padEnd(2,e),16)/255}function wt(e,t){return xt(t?e/100:e,0,1)}function xt(e,t,r){return Math.min(Math.max(t,e),r)}function St(e){return!e.some(Number.isNaN)}const Et={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Tt(e,t,r){return e+r*(t-e)}function At(e,t,r){return e.map(((e,n)=>Tt(e,t[n],r)))}class Ct{constructor(e,t,r,n=1,i=!0){this.r=e,this.g=t,this.b=r,this.a=n,i||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Ct)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=vt(Et,e);if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let r=1;return[bt(e.slice(r,r+=t)),bt(e.slice(r,r+=t)),bt(e.slice(r,r+=t)),bt(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,r,n,i,o,a,s,l,c,u,h,d]=t,p=[i||" ",s||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[n,a,c].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[xt(+r/t,0,1),xt(+o/t,0,1),xt(+l/t,0,1),h?wt(+h,d):1];if(St(e))return e}}return}}const r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){const[e,t,n,i,o,a,s,l,c]=r,u=[n||" ",o||" ",s].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const e=[+t,xt(+i,0,100),xt(+a,0,100),l?wt(+l,c):1];if(St(e))return function([e,t,r,n]){function i(n){const i=(n+e/30)%12,o=t*Math.min(r,1-r);return r-o*Math.max(-1,Math.min(i-3,9-i,1))}return e=ht(e),t/=100,r/=100,[i(0),i(8),i(4),n]}(e)}}}(e);return t?new Ct(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,i=n||1/0;return this.overwriteGetter("rgb",[e/i,t/i,r/i,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,r,n,i]=dt(e),o=Math.sqrt(r*r+n*n);return[Math.round(1e4*o)?ht(Math.atan2(n,r)*ut):NaN,o,t,i]}(this.rgb))}get lab(){return this.overwriteGetter("lab",dt(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map((e=>Math.round(255*e))).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,i,o,a]=At(e.rgb,t.rgb,r);return new Ct(n,i,o,a,!1)}case"hcl":{const[n,i,o,a]=e.hcl,[s,l,c,u]=t.hcl;let h,d;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?h=NaN:(h=s,1!==o&&0!==o||(d=l)):(h=n,1!==c&&0!==c||(d=i));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),h=n+r*e}const[p,f,m,g]=function([e,t,r,n]){return e=isNaN(e)?0:e*ct,mt([r,Math.cos(e)*t,Math.sin(e)*t,n])}([h,null!=d?d:Tt(i,l,r),Tt(o,c,r),Tt(a,u,r)]);return new Ct(p,f,m,g,!1)}case"lab":{const[n,i,o,a]=mt(At(e.lab,t.lab,r));return new Ct(n,i,o,a,!1)}}}}Ct.black=new Ct(0,0,0,1),Ct.white=new Ct(1,1,1,1),Ct.transparent=new Ct(0,0,0,0),Ct.red=new Ct(1,0,0,1);class It{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const kt=["bottom","center","top"];class Pt{constructor(e,t,r,n,i,o){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i,this.verticalAlign=o}}class Mt{constructor(e){this.sections=e}static fromString(e){return new Mt([new Pt(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Mt?e:Mt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class Rt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Rt)return e;if("number"==typeof e)return new Rt([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Rt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new Rt(At(e.values,t.values,r))}}class Dt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Dt)return e;if("number"==typeof e)return new Dt([e]);if(Array.isArray(e)){for(const t of e)if("number"!=typeof t)return;return new Dt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new Dt(At(e.values,t.values,r))}}class Ot{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ot)return e;if("string"==typeof e){const t=Ct.parse(e);if(!t)return;return new Ot([t])}if(!Array.isArray(e))return;const t=[];for(const r of e){if("string"!=typeof r)return;const e=Ct.parse(r);if(!e)return;t.push(e)}return new Ot(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,n="rgb"){const i=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let o=0;o<e.values.length;o++)i.push(Ct.interpolate(e.values[o],t.values[o],r,n));return new Ot(i)}}class Lt extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Bt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class $t{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof $t)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!=typeof r||!Bt.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new $t(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,i=t.values;if(n.length!==i.length)throw new Lt(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new Lt(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${n[a]}, to[${a}]: ${i[a]}`);o.push(n[a]);const[e,t]=n[a+1],[s,l]=i[a+1];o.push([Tt(e,s,r),Tt(t,l,r)])}return new $t(o)}}class zt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new zt({name:e,available:!1}):null}}class Ft{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new Ft(e,t,r)}static parse(e){return e instanceof Ft?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new Ft(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new Ft(e.from,e.to,e.transition):"string"==typeof e?new Ft(e,e,1):void 0}}function qt(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Nt(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Ft||e instanceof Ct||e instanceof It||e instanceof Mt||e instanceof Rt||e instanceof Dt||e instanceof Ot||e instanceof $t||e instanceof zt)return!0;if(Array.isArray(e)){for(const t of e)if(!Nt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Nt(e[t]))return!1;return!0}return!1}function jt(e){if(null===e)return Le;if("string"==typeof e)return $e;if("boolean"==typeof e)return ze;if("number"==typeof e)return Be;if(e instanceof Ct)return Fe;if(e instanceof Ft)return qe;if(e instanceof It)return Ue;if(e instanceof Mt)return Ve;if(e instanceof Rt)return Ge;if(e instanceof Dt)return He;if(e instanceof Ot)return We;if(e instanceof $t)return Ye;if(e instanceof zt)return Ze;if(Array.isArray(e)){const t=e.length;let r;for(const n of e){const e=jt(n);if(r){if(r===e)continue;r=je;break}r=e}return Xe(r||je,t)}return Ne}function Ut(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Ct||e instanceof Ft||e instanceof Mt||e instanceof Rt||e instanceof Dt||e instanceof Ot||e instanceof $t||e instanceof zt?e.toString():JSON.stringify(e)}class Vt{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Nt(e[1]))return t.error("invalid value");const r=e[1];let n=jt(r);const i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new Vt(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Gt={string:$e,number:Be,boolean:ze,object:Ne};class Wt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,o;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in Gt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=Gt[r],n++}else i=je;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=Xe(i,o)}else{if(!Gt[i])throw new Error(`Types doesn't contain name = ${i}`);r=Gt[i]}const o=[];for(;n<e.length;n++){const r=t.parse(e[n],n,je);if(!r)return null;o.push(r)}return new Wt(r,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!Je(this.type,jt(r)))return r;if(t===this.args.length-1)throw new Lt(`Expected value to be of type ${Ke(this.type)}, but found ${Ke(jt(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Ht={"to-boolean":ze,"to-color":Fe,"to-number":Be,"to-string":$e};class Zt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!Ht[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=Ht[r],i=[];for(let o=1;o<e.length;o++){const r=t.parse(e[o],o,je);if(!r)return null;i.push(r)}return new Zt(n,i)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Ct)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:qt(t[0],t[1],t[2],t[3]),!r))return new Ct(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Lt(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=Rt.parse(t);if(n)return n}throw new Lt(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Dt.parse(t);if(n)return n}throw new Lt(`Could not parse numberArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Ot.parse(t);if(n)return n}throw new Lt(`Could not parse colorArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=$t.parse(t);if(n)return n}throw new Lt(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Lt(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Mt.fromString(Ut(this.args[0].evaluate(e)));case"resolvedImage":return zt.fromString(Ut(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Ut(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Yt=["Unknown","Point","LineString","Polygon"];class Xt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Yt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Ct.parse(e),this._parseColorCache.set(e,t)),t}}class Kt{constructor(e,t,r=[],n,i=new Oe,o=[]){this.registry=e,this.path=r,this.key=r.map((e=>`[${e}]`)).join(""),this.scope=i,this.errors=o,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new Wt(t,[e]):"coerce"===r?new Zt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=e[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const o=this.registry[i];if(o){let i=o.parse(e,this);if(!i)return null;if(this.expectedType){const e=this.expectedType,n=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==n.kind){if("projectionDefinition"===e.kind&&["string","array"].includes(n.kind)||["color","formatted","resolvedImage"].includes(e.kind)&&["value","string"].includes(n.kind)||["padding","numberArray"].includes(e.kind)&&["value","number","array"].includes(n.kind)||"colorArray"===e.kind&&["value","string","array"].includes(n.kind)||"variableAnchorOffsetCollection"===e.kind&&["value","array"].includes(n.kind))i=r(i,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,n))return null}else i=r(i,e,t.typeAnnotation||"assert")}if(!(i instanceof Vt)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){const e=new Xt;try{i=new Vt(i.type,i.evaluate(e))}catch(n){return this.error(n.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new Kt(this.registry,this._isConstant,n,t||null,i,this.errors)}error(e,...t){const r=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new De(r,e))}checkSubtype(e,t){const r=Je(e,t);return r&&this.error(r),r}}class Qt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let i=1;i<e.length-1;i+=2){const n=e[i];if("string"!=typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,i);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);const o=t.parse(e[i+1],i+1);if(!o)return null;r.push([n,o])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new Qt(r,n):null}outputDefined(){return this.result.outputDefined()}}class Jt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new Jt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class er{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Be),n=t.parse(e[2],2,Xe(t.expectedType||je));return r&&n?new er(n.type.itemType,r,n):null}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Lt(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new Lt(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new Lt(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class tr{constructor(e,t){this.type=ze,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);return r&&n?et(r.type,[ze,$e,Be,Le,je])?new tr(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ke(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!tt(t,["boolean","string","number","null"]))throw new Lt(`Expected first argument to be of type boolean, string, number or null, but found ${Ke(jt(t))} instead.`);if(!tt(r,["string","array"]))throw new Lt(`Expected second argument to be of type array or string, but found ${Ke(jt(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class rr{constructor(e,t,r){this.type=Be,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,je);if(!r||!n)return null;if(!et(r.type,[ze,$e,Be,Le,je]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ke(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Be);return i?new rr(r,n,i):null}return new rr(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!tt(t,["boolean","string","number","null"]))throw new Lt(`Expected first argument to be of type boolean, string, number or null, but found ${Ke(jt(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),tt(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(tt(r,["array"]))return r.indexOf(t,n);throw new Lt(`Expected second argument to be of type array or string, but found ${Ke(jt(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class nr{constructor(e,t,r,n,i,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},o=[];for(let l=2;l<e.length-1;l+=2){let a=e[l];const s=e[l+1];Array.isArray(a)||(a=[a]);const c=t.concat(l);if(0===a.length)return c.error("Expected at least one branch label.");for(const e of a){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,jt(e)))return null}else r=jt(e);if(void 0!==i[String(e)])return c.error("Branch labels must be unique.");i[String(e)]=o.length}const u=t.parse(s,l,n);if(!u)return null;n=n||u.type,o.push(u)}const a=t.parse(e[1],1,je);if(!a)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==a.type.kind&&t.concat(1).checkSubtype(r,a.type)?null:new nr(r,n,a,i,o,s):null}evaluate(e){const t=this.input.evaluate(e);return(jt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class ir{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let o=1;o<e.length-1;o+=2){const i=t.parse(e[o],o,ze);if(!i)return null;const a=t.parse(e[o+1],o+1,r);if(!a)return null;n.push([i,a]),r=r||a.type}const i=t.parse(e[e.length-1],e.length-1,r);if(!i)return null;if(!r)throw new Error("Can't infer output type");return new ir(r,n,i)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}}class or{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,je),n=t.parse(e[2],2,Be);if(!r||!n)return null;if(!et(r.type,[Xe(je),$e,je]))return t.error(`Expected first argument to be of type array or string, but found ${Ke(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Be);return i?new or(r.type,r,n,i):null}return new or(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),tt(t,["string"]))return[...t].slice(r,n).join("");if(tt(t,["array"]))return t.slice(r,n);throw new Lt(`Expected first argument to be of type array or string, but found ${Ke(jt(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ar(e,t){const r=e.length-1;let n,i,o=0,a=r,s=0;for(;o<=a;)if(s=Math.floor((o+a)/2),n=e[s],i=e[s+1],n<=t){if(s===r||t<i)return s;o=s+1}else{if(!(n>t))throw new Lt("Input is not a number.");a=s-1}return 0}class sr{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,i]of r)this.labels.push(n),this.outputs.push(i)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,Be);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let o=1;o<e.length;o+=2){const r=1===o?-1/0:e[o],a=e[o+1],s=o,l=o+1;if("number"!=typeof r)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=r)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=t.parse(a,l,i);if(!c)return null;i=i||c.type,n.push([r,c])}return new sr(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[ar(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function lr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cr,ur,hr=function(){if(ur)return cr;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return ur=1,cr=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},cr}(),dr=lr(hr);class pr{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[o,a]of i)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(e,t,r,n){let i=0;if("exponential"===e.name)i=fr(t,e.base,r,n);else if("linear"===e.name)i=fr(t,1,r,n);else if("cubic-bezier"===e.name){const o=e.controlPoints;i=new dr(o[0],o[1],o[2],o[3]).solve(fr(t,1,r,n))}return i}static parse(e,t){let[r,n,i,...o]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,Be),!i)return null;const a=[];let s=null;"interpolate-hcl"!==r&&"interpolate-lab"!==r||t.expectedType==We?t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType):s=Fe;for(let l=0;l<o.length;l+=2){const e=o[l],r=o[l+1],n=l+3,i=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(a.length&&a[a.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=t.parse(r,i,s);if(!c)return null;s=s||c.type,a.push([e,c])}return rt(s,Be)||rt(s,qe)||rt(s,Fe)||rt(s,Ge)||rt(s,He)||rt(s,We)||rt(s,Ye)||rt(s,Xe(Be))?new pr(s,r,n,i,a):t.error(`Type ${Ke(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const o=ar(t,n),a=pr.interpolationFactor(this.interpolation,n,t[o],t[o+1]),s=r[o].evaluate(e),l=r[o+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Tt(s,l,a);case"color":return Ct.interpolate(s,l,a);case"padding":return Rt.interpolate(s,l,a);case"colorArray":return Ot.interpolate(s,l,a);case"numberArray":return Dt.interpolate(s,l,a);case"variableAnchorOffsetCollection":return $t.interpolate(s,l,a);case"array":return At(s,l,a);case"projectionDefinition":return Ft.interpolate(s,l,a)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ct.interpolate(s,l,a,"hcl");case"colorArray":return Ot.interpolate(s,l,a,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ct.interpolate(s,l,a,"lab");case"colorArray":return Ot.interpolate(s,l,a,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function fr(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}const mr={color:Ct.interpolate,number:Tt,padding:Rt.interpolate,numberArray:Dt.interpolate,colorArray:Ot.interpolate,variableAnchorOffsetCollection:$t.interpolate,array:At};class gr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const a of e.slice(1)){const e=t.parse(a,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}if(!r)throw new Error("No output type");const o=n&&i.some((e=>Je(n,e.type)));return new gr(o?je:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(e),r&&r instanceof zt&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function yr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function _r(e,t,r,n){return 0===n.compare(t,r)}function vr(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=ze,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let o=t.parse(e[1],1,je);if(!o)return null;if(!yr(r,o.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${Ke(o.type)}'.`);let a=t.parse(e[2],2,je);if(!a)return null;if(!yr(r,a.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${Ke(a.type)}'.`);if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error(`Cannot compare types '${Ke(o.type)}' and '${Ke(a.type)}'.`);n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new Wt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new Wt(o.type,[a])));let s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,Ue),!s)return null}return new i(o,a,s)}evaluate(i){const o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const t=jt(o),r=jt(a);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new Lt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=jt(o),r=jt(a);if("string"!==e.kind||"string"!==r.kind)return t(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):t(i,o,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const br=vr("==",(function(e,t,r){return t===r}),_r),wr=vr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!_r(0,t,r,n)})),xr=vr("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),Sr=vr(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),Er=vr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),Tr=vr(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0}));class Ar{constructor(e,t,r){this.type=Ue,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,ze);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,ze);if(!i)return null;let o=null;return r.locale&&(o=t.parse(r.locale,1,$e),!o)?null:new Ar(n,i,o)}evaluate(e){return new It(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Cr{constructor(e,t,r,n,i){this.type=$e,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Be);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,$e),!i))return null;let o=null;if(n.currency&&(o=t.parse(n.currency,1,$e),!o))return null;let a=null;if(n["min-fraction-digits"]&&(a=t.parse(n["min-fraction-digits"],1,Be),!a))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,Be),!s)?null:new Cr(r,i,o,a,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ir{constructor(e){this.type=Ve,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let o=1;o<=e.length-1;++o){const r=e[o];if(i&&"object"==typeof r&&!Array.isArray(r)){i=!1;let e=null;if(r["font-scale"]&&(e=t.parse(r["font-scale"],1,Be),!e))return null;let o=null;if(r["text-font"]&&(o=t.parse(r["text-font"],1,Xe($e)),!o))return null;let a=null;if(r["text-color"]&&(a=t.parse(r["text-color"],1,Fe),!a))return null;let s=null;if(r["vertical-align"]){if("string"==typeof r["vertical-align"]&&!kt.includes(r["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${r["vertical-align"]}' instead.`);if(s=t.parse(r["vertical-align"],1,$e),!s)return null}const l=n[n.length-1];l.scale=e,l.font=o,l.textColor=a,l.verticalAlign=s}else{const r=t.parse(e[o],1,je);if(!r)return null;const a=r.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:r,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ir(n)}evaluate(e){return new Mt(this.sections.map((t=>{const r=t.content.evaluate(e);return jt(r)===Ze?new Pt("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new Pt(Ut(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class kr{constructor(e){this.type=Ze,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,$e);return r?new kr(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=zt.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class Pr{constructor(e){this.type=Be,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${Ke(r.type)} instead.`):new Pr(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new Lt(`Expected value to be of type string or array, but found ${Ke(jt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Mr=8192;function Rr(e,t){const r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*Mr),Math.round(n*i*Mr)]}function Dr(e,t){const r=Math.pow(2,t.z);return[(i=(e[0]/Mr+t.x)/r,360*i-180),(n=(e[1]/Mr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90)];var n,i}function Or(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Lr(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Br(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],o=e[0]-r[0],a=e[1]-r[1];return n*a-o*i==0&&n*o<=0&&i*a<=0}function $r(e,t,r,n){return 0!=(i=[n[0]-r[0],n[1]-r[1]])[0]*(o=[t[0]-e[0],t[1]-e[1]])[1]-i[1]*o[0]&&!(!Ur(e,t,r,n)||!Ur(r,n,e,t));var i,o}function zr(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if($r(e,t,n[r],n[r+1]))return!0;return!1}function Fr(e,t,r=!1){let n=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(Br(e,s[t],s[t+1]))return r;(o=s[t])[1]>(i=e)[1]!=(a=s[t+1])[1]>i[1]&&i[0]<(a[0]-o[0])*(i[1]-o[1])/(a[1]-o[1])+o[0]&&(n=!n)}var i,o,a;return n}function qr(e,t){for(const r of t)if(Fr(e,r))return!0;return!1}function Nr(e,t){for(const r of e)if(!Fr(r,t))return!1;for(let r=0;r<e.length-1;++r)if(zr(e[r],e[r+1],t))return!1;return!0}function jr(e,t){for(const r of t)if(Nr(e,r))return!0;return!1}function Ur(e,t,r,n){const i=n[0]-r[0],o=n[1]-r[1],a=(e[0]-r[0])*o-i*(e[1]-r[1]),s=(t[0]-r[0])*o-i*(t[1]-r[1]);return a>0&&s<0||a<0&&s>0}function Vr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=[];for(let n=0;n<e[i].length;n++){const a=Rr(e[i][n],r);Or(t,a),o.push(a)}n.push(o)}return n}function Gr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=Vr(e[i],t,r);n.push(o)}return n}function Wr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}Or(t,e)}function Hr(e,t,r,n){const i=Math.pow(2,n.z)*Mr,o=[n.x*Mr,n.y*Mr],a=[];for(const s of e)for(const e of s){const n=[e.x+o[0],e.y+o[1]];Wr(n,t,r,i),a.push(n)}return a}function Zr(e,t,r,n){const i=Math.pow(2,n.z)*Mr,o=[n.x*Mr,n.y*Mr],a=[];for(const l of e){const e=[];for(const r of l){const n=[r.x+o[0],r.y+o[1]];Or(t,n),e.push(n)}a.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of a)for(const n of e)Wr(n,t,r,i)}var s;return a}class Yr{constructor(e,t){this.type=ze,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Nt(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length)return new Yr(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Yr(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Yr(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const o=Vr(t.coordinates,n,i),a=Hr(e.geometry(),r,n,i);if(!Lr(r,n))return!1;for(const e of a)if(!Fr(e,o))return!1}if("MultiPolygon"===t.type){const o=Gr(t.coordinates,n,i),a=Hr(e.geometry(),r,n,i);if(!Lr(r,n))return!1;for(const e of a)if(!qr(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const o=Vr(t.coordinates,n,i),a=Zr(e.geometry(),r,n,i);if(!Lr(r,n))return!1;for(const e of a)if(!Nr(e,o))return!1}if("MultiPolygon"===t.type){const o=Gr(t.coordinates,n,i),a=Zr(e.geometry(),r,n,i);if(!Lr(r,n))return!1;for(const e of a)if(!jr(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Xr=class{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const o=n+1;if(o<this.length&&r(t[o],t[n])<0&&(n=o),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}};function Kr(e,t,r=0,n=e.length-1,i=Jr){for(;n>r;){if(n-r>600){const o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);Kr(e,t,Math.max(r,Math.floor(t-a*l/o+c)),Math.min(n,Math.floor(t+(o-a)*l/o+c)),i)}const o=e[t];let a=r,s=n;for(Qr(e,r,t),i(e[n],o)>0&&Qr(e,r,n);a<s;){for(Qr(e,a,s),a++,s--;i(e[a],o)<0;)a++;for(;i(e[s],o)>0;)s--}0===i(e[r],o)?Qr(e,r,s):(s++,Qr(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}}function Qr(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Jr(e,t){return e<t?-1:e>t?1:0}function en(e,t){if(e.length<=1)return[e];const r=[];let n,i;for(const o of e){const e=rn(o);0!==e&&(o.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(n&&r.push(n),n=[o]):n.push(o))}if(n&&r.push(n),t>1)for(let o=0;o<r.length;o++)r[o].length<=t||(Kr(r[o],t,1,r[o].length-1,tn),r[o]=r[o].slice(0,t));return r}function tn(e,t){return t.area-e.area}function rn(e){let t=0;for(let r,n,i=0,o=e.length,a=o-1;i<o;a=i++)r=e[i],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}const nn=1/298.257223563,on=nn*(2-nn),an=Math.PI/180;class sn{constructor(e){const t=6378.137*an*1e3,r=Math.cos(e*an),n=1/(1-on*(1-r*r)),i=Math.sqrt(n);this.kx=t*i*r,this.ky=t*i*n*(1-on)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,i,o,a=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],c=e[s][1],u=this.wrap(e[s+1][0]-l)*this.kx,h=(e[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(this.wrap(t[0]-l)*this.kx*u+(t[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=e[s+1][0],c=e[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=this.wrap(t[0]-l)*this.kx,h=(t[1]-c)*this.ky;const p=u*u+h*h;p<a&&(a=p,r=l,n=c,i=s,o=d)}return{point:[r,n],index:i,t:Math.max(0,Math.min(1,o))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function ln(e,t){return t[0]-e[0]}function cn(e){return e[1]-e[0]+1}function un(e,t){return e[1]>=e[0]&&e[1]<t}function hn(e,t){if(e[0]>e[1])return[null,null];const r=cn(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function dn(e,t){if(!un(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)Or(r,e[n]);return r}function pn(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)Or(t,e);return t}function fn(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function mn(e,t,r){if(!fn(e)||!fn(t))return NaN;let n=0,i=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),r.distance([0,0],[n,i])}function gn(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function yn(e,t,r,n,i){const o=Math.min(gn(e,[r,n],i),gn(t,[r,n],i)),a=Math.min(gn(r,[e,t],i),gn(n,[e,t],i));return Math.min(o,a)}function _n(e,t,r,n,i){if(!un(t,e.length)||!un(n,r.length))return 1/0;let o=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],s=e[a+1];for(let e=n[0];e<n[1];++e){const n=r[e],a=r[e+1];if($r(t,s,n,a))return 0;o=Math.min(o,yn(t,s,n,a,i))}}return o}function vn(e,t,r,n,i){if(!un(t,e.length)||!un(n,r.length))return NaN;let o=1/0;for(let a=t[0];a<=t[1];++a)for(let t=n[0];t<=n[1];++t)if(o=Math.min(o,i.distance(e[a],r[t])),0===o)return o;return o}function bn(e,t,r){if(Fr(e,t,!0))return 0;let n=1/0;for(const i of t){const t=i[0],o=i[i.length-1];if(t!==o&&(n=Math.min(n,gn(e,[o,t],r)),0===n))return n;const a=r.pointOnLine(i,e);if(n=Math.min(n,r.distance(e,a.point)),0===n)return n}return n}function wn(e,t,r,n){if(!un(t,e.length))return NaN;for(let o=t[0];o<=t[1];++o)if(Fr(e[o],r,!0))return 0;let i=1/0;for(let o=t[0];o<t[1];++o){const t=e[o],a=e[o+1];for(const e of r)for(let r=0,o=e.length,s=o-1;r<o;s=r++){const o=e[s],l=e[r];if($r(t,a,o,l))return 0;i=Math.min(i,yn(t,a,o,l,n))}}return i}function xn(e,t){for(const r of e)for(const e of r)if(Fr(e,t,!0))return!0;return!1}function Sn(e,t,r,n=1/0){const i=pn(e),o=pn(t);if(n!==1/0&&mn(i,o,r)>=n)return n;if(Lr(i,o)){if(xn(e,t))return 0}else if(xn(t,e))return 0;let a=1/0;for(const s of e)for(let e=0,n=s.length,i=n-1;e<n;i=e++){const n=s[i],o=s[e];for(const e of t)for(let t=0,i=e.length,s=i-1;t<i;s=t++){const i=e[s],l=e[t];if($r(n,o,i,l))return 0;a=Math.min(a,yn(n,o,i,l,r))}}return a}function En(e,t,r,n,i,o){if(!o)return;const a=mn(dn(n,o),i,r);a<t&&e.push([a,o,[0,0]])}function Tn(e,t,r,n,i,o,a){if(!o||!a)return;const s=mn(dn(n,o),dn(i,a),r);s<t&&e.push([s,o,a])}function An(e,t,r,n,i=1/0){let o=Math.min(n.distance(e[0],r[0][0]),i);if(0===o)return o;const a=new Xr([[0,[0,e.length-1],[0,0]]],ln),s=pn(r);for(;a.length>0;){const i=a.pop();if(i[0]>=o)continue;const l=i[1],c=t?50:100;if(cn(l)<=c){if(!un(l,e.length))return NaN;if(t){const t=wn(e,l,r,n);if(isNaN(t)||0===t)return t;o=Math.min(o,t)}else for(let t=l[0];t<=l[1];++t){const i=bn(e[t],r,n);if(o=Math.min(o,i),0===o)return 0}}else{const r=hn(l,t);En(a,o,n,e,s,r[0]),En(a,o,n,e,s,r[1])}}return o}function Cn(e,t,r,n,i,o=1/0){let a=Math.min(o,i.distance(e[0],r[0]));if(0===a)return a;const s=new Xr([[0,[0,e.length-1],[0,r.length-1]]],ln);for(;s.length>0;){const o=s.pop();if(o[0]>=a)continue;const l=o[1],c=o[2],u=t?50:100,h=n?50:100;if(cn(l)<=u&&cn(c)<=h){if(!un(l,e.length)&&un(c,r.length))return NaN;let o;if(t&&n)o=_n(e,l,r,c,i),a=Math.min(a,o);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=c[0];e<=c[1];++e)if(o=gn(r[e],t,i),a=Math.min(a,o),0===a)return a}else if(!t&&n){const t=r.slice(c[0],c[1]+1);for(let r=l[0];r<=l[1];++r)if(o=gn(e[r],t,i),a=Math.min(a,o),0===a)return a}else o=vn(e,l,r,c,i),a=Math.min(a,o)}else{const o=hn(l,t),u=hn(c,n);Tn(s,a,i,e,r,o[0],u[0]),Tn(s,a,i,e,r,o[0],u[1]),Tn(s,a,i,e,r,o[1],u[0]),Tn(s,a,i,e,r,o[1],u[1])}}return a}function In(e){return"MultiPolygon"===e.type?e.coordinates.map((e=>({type:"Polygon",coordinates:e}))):"MultiLineString"===e.type?e.coordinates.map((e=>({type:"LineString",coordinates:e}))):"MultiPoint"===e.type?e.coordinates.map((e=>({type:"Point",coordinates:e}))):[e]}class kn{constructor(e,t){this.type=Be,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Nt(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new kn(t,t.features.map((e=>In(e.geometry))).flat());if("Feature"===t.type)return new kn(t,In(t.geometry));if("type"in t&&"coordinates"in t)return new kn(t,In(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>Dr([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const i=new sn(n[0][1]);let o=1/0;for(const a of t){switch(a.type){case"Point":o=Math.min(o,Cn(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,Cn(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,An(n,!1,a.coordinates,i,o))}if(0===o)return o}return o}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>Dr([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const i=new sn(n[0][1]);let o=1/0;for(const a of t){switch(a.type){case"Point":o=Math.min(o,Cn(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,Cn(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,An(n,!0,a.coordinates,i,o))}if(0===o)return o}return o}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=en(r,0).map((t=>t.map((t=>t.map((t=>Dr([t.x,t.y],e.canonical))))))),i=new sn(n[0][0][0][1]);let o=1/0;for(const a of t)for(const e of n){switch(a.type){case"Point":o=Math.min(o,An([a.coordinates],!1,e,i,o));break;case"LineString":o=Math.min(o,An(a.coordinates,!0,e,i,o));break;case"Polygon":o=Math.min(o,Sn(e,a.coordinates,i,o))}if(0===o)return o}return o}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Pn{constructor(e){this.type=je,this.key=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return null==r?t.error("Global state property must be defined."):"string"!=typeof r?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Pn(r)}evaluate(e){var t;const r=null===(t=e.globals)||void 0===t?void 0:t.globalState;return r&&0!==Object.keys(r).length?vt(r,this.key):null}eachChild(){}outputDefined(){return!1}}const Mn={"==":br,"!=":wr,">":Sr,"<":xr,">=":Tr,"<=":Er,array:Wt,at:er,boolean:Wt,case:ir,coalesce:gr,collator:Ar,format:Ir,image:kr,in:tr,"index-of":rr,interpolate:pr,"interpolate-hcl":pr,"interpolate-lab":pr,length:Pr,let:Qt,literal:Vt,match:nr,number:Wt,"number-format":Cr,object:Wt,slice:or,step:sr,string:Wt,"to-boolean":Zt,"to-color":Zt,"to-number":Zt,"to-string":Zt,var:Jt,within:Yr,distance:kn,"global-state":Pn};class Rn{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=Rn.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let s=null;for(const[l,c]of a){s=new Kt(t.registry,$n,t.path,null,t.scope);const n=[];let o=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(l)?l[t-1]:l.type,a=s.parse(r,1+n.length,i);if(!a){o=!0;break}n.push(a)}if(!o)if(Array.isArray(l)&&l.length!==n.length)s.error(`Expected ${l.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){const t=Array.isArray(l)?l[e]:l.type,r=n[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new Rn(r,i,c,n)}}if(1===a.length)t.errors.push(...s.errors);else{const r=(a.length?a:o).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map(Ke).join(", ")})`:`(${Ke(t.type)}...)`;var t})).join(" | "),n=[];for(let i=1;i<e.length;i++){const r=t.parse(e[i],1+n.length);if(!r)return null;n.push(Ke(r.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Rn.definitions=t;for(const r in t)e[r]=Rn}}function Dn(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const o=i?i.evaluate(e):1,a=qt(t,r,n,o);if(a)throw new Lt(a);return new Ct(t/255,r/255,n/255,o,!1)}function On(e,t){return e in t}function Ln(e,t){const r=t[e];return void 0===r?null:r}function Bn(e){return{type:e}}function $n(e){if(e instanceof Jt)return $n(e.boundExpression);if(e instanceof Rn&&"error"===e.name)return!1;if(e instanceof Ar)return!1;if(e instanceof Yr)return!1;if(e instanceof kn)return!1;if(e instanceof Pn)return!1;const t=e instanceof Zt||e instanceof Wt;let r=!0;return e.eachChild((e=>{r=t?r&&$n(e):r&&e instanceof Vt})),!!r&&zn(e)&&qn(e,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function zn(e){if(e instanceof Rn){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Yr)return!1;if(e instanceof kn)return!1;let t=!0;return e.eachChild((e=>{t&&!zn(e)&&(t=!1)})),t}function Fn(e){if(e instanceof Rn&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!Fn(e)&&(t=!1)})),t}function qn(e,t){if(e instanceof Rn&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!qn(e,t)&&(r=!1)})),r}function Nn(e){return{result:"success",value:e}}function jn(e){return{result:"error",value:e}}function Un(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Vn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Gn(e){return!!e.expression&&e.expression.interpolated}function Wn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Hn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&jt(e)===Ne}function Zn(e){return e}function Yn(e,t){const r=e.stops&&"object"==typeof e.stops[0][0],n=r||!(r||void 0!==e.property),i=e.type||(Gn(t)?"exponential":"interval"),o=function(e){switch(e.type){case"color":return Ct.parse;case"padding":return Rt.parse;case"numberArray":return Dt.parse;case"colorArray":return Ot.parse;default:return null}}(t);if(o&&((e=Re({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],o(e[1])]))),e.default=o(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==(a=e.colorSpace)&&"hcl"!==a&&"lab"!==a)throw new Error(`Unknown color space: "${e.colorSpace}"`);var a;const s=function(e){switch(e){case"exponential":return Jn;case"interval":return Qn;case"categorical":return Kn;case"identity":return ei;default:throw new Error(`Unknown function type "${e}"`)}}(i);let l,c;if("categorical"===i){l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];c=typeof e.stops[0][0]}if(r){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],o=i[0].zoom;void 0===r[o]&&(r[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},n.push(o)),r[o].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,Yn(r[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:pr.interpolationFactor.bind(void 0,o),zoomStops:i.map((e=>e[0])),evaluate:({zoom:r},n)=>Jn({stops:i,base:e.base},t,r).evaluate(r,n)}}if(n){const r="exponential"===i?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:pr.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:r})=>s(e,t,r,l,c)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?Xn(e.default,t.default):s(e,t,i,l,c)}}}function Xn(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Kn(e,t,r,n,i){return Xn(typeof r===i?n[r]:void 0,e.default,t.default)}function Qn(e,t,r){if("number"!==Wn(r))return Xn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=ar(e.stops.map((e=>e[0])),r);return e.stops[i][1]}function Jn(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==Wn(r))return Xn(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const o=ar(e.stops.map((e=>e[0])),r),a=function(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],l=e.stops[o+1][1],c=mr[t.type]||Zn;return"function"==typeof s.evaluate?{evaluate(...t){const r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return c(r,n,a,e.colorSpace)}}:c(s,l,a,e.colorSpace)}function ei(e,t,r){switch(t.type){case"color":r=Ct.parse(r);break;case"formatted":r=Mt.fromString(r.toString());break;case"resolvedImage":r=zt.fromString(r.toString());break;case"padding":r=Rt.parse(r);break;case"colorArray":r=Ot.parse(r);break;case"numberArray":r=Dt.parse(r);break;default:Wn(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return Xn(r,e.default,t.default)}Rn.register(Mn,{error:[{kind:"error"},[$e],(e,[t])=>{throw new Lt(t.evaluate(e))}],typeof:[$e,[je],(e,[t])=>Ke(jt(t.evaluate(e)))],"to-rgba":[Xe(Be,4),[Fe],(e,[t])=>{const[r,n,i,o]=t.evaluate(e).rgb;return[255*r,255*n,255*i,o]}],rgb:[Fe,[Be,Be,Be],Dn],rgba:[Fe,[Be,Be,Be,Be],Dn],has:{type:ze,overloads:[[[$e],(e,[t])=>On(t.evaluate(e),e.properties())],[[$e,Ne],(e,[t,r])=>On(t.evaluate(e),r.evaluate(e))]]},get:{type:je,overloads:[[[$e],(e,[t])=>Ln(t.evaluate(e),e.properties())],[[$e,Ne],(e,[t,r])=>Ln(t.evaluate(e),r.evaluate(e))]]},"feature-state":[je,[$e],(e,[t])=>Ln(t.evaluate(e),e.featureState||{})],properties:[Ne,[],e=>e.properties()],"geometry-type":[$e,[],e=>e.geometryType()],id:[je,[],e=>e.id()],zoom:[Be,[],e=>e.globals.zoom],"heatmap-density":[Be,[],e=>e.globals.heatmapDensity||0],elevation:[Be,[],e=>e.globals.elevation||0],"line-progress":[Be,[],e=>e.globals.lineProgress||0],accumulated:[je,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Be,Bn(Be),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[Be,Bn(Be),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:Be,overloads:[[[Be,Be],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Be],(e,[t])=>-t.evaluate(e)]]},"/":[Be,[Be,Be],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Be,[Be,Be],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Be,[Be],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))],log2:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Be,[Be],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Be,[Be],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Be,[Be],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Be,[Be],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Be,[Be],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Be,[Be],(e,[t])=>Math.atan(t.evaluate(e))],min:[Be,Bn(Be),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[Be,Bn(Be),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[Be,[Be],(e,[t])=>Math.abs(t.evaluate(e))],round:[Be,[Be],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Be,[Be],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Be,[Be],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[ze,[$e,je],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[ze,[je],(e,[t])=>e.id()===t.value],"filter-type-==":[ze,[$e],(e,[t])=>e.geometryType()===t.value],"filter-<":[ze,[$e,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[ze,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[ze,[$e,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[ze,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[ze,[$e,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[ze,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[ze,[$e,je],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[ze,[je],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[ze,[je],(e,[t])=>t.value in e.properties()],"filter-has-id":[ze,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[ze,[Xe($e)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[ze,[Xe(je)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[ze,[$e,Xe(je)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[ze,[$e,Xe(je)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:ze,overloads:[[[ze,ze],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Bn(ze),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:ze,overloads:[[[ze,ze],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Bn(ze),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[ze,[ze],(e,[t])=>!t.evaluate(e)],"is-supported-script":[ze,[$e],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[$e,[$e],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[$e,[$e],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[$e,Bn(je),(e,t)=>t.map((t=>Ut(t.evaluate(e)))).join("")],"resolved-locale":[$e,[Ue],(e,[t])=>t.evaluate(e).resolvedLocale()]});class ti{constructor(e,t,r){this.expression=e,this._warningHistory={},this._evaluator=new Xt,this._defaultValue=t?function(e){if("color"===e.type&&Hn(e.default))return new Ct(0,0,0,0);switch(e.type){case"color":return Ct.parse(e.default)||null;case"padding":return Rt.parse(e.default)||null;case"numberArray":return Dt.parse(e.default)||null;case"colorArray":return Ot.parse(e.default)||null;case"variableAnchorOffsetCollection":return $t.parse(e.default)||null;case"projectionDefinition":return Ft.parse(e.default)||null;default:return void 0===e.default?null:e.default}}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null,this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._globalState&&(e=ui(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,o){this._globalState&&(e=ui(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Lt(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0),this._defaultValue}}}function ri(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Mn}function ni(e,t,r){const n=new Kt(Mn,$n,[],t?function(e){const t={color:Fe,string:$e,number:Be,enum:$e,boolean:ze,formatted:Ve,padding:Ge,numberArray:He,colorArray:We,projectionDefinition:qe,resolvedImage:Ze,variableAnchorOffsetCollection:Ye};return"array"===e.type?Xe(t[e.value]||je,e.length):t[e.type]}(t):void 0),i=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?Nn(new ti(i,t,r)):jn(n.errors)}class ii{constructor(e,t,r){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Fn(t.expression),this.globalStateRefs=ci(t.expression),this._globalState=r}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._globalState&&(e=ui(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._globalState&&(e=ui(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,i,o)}}class oi{constructor(e,t,r,n,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Fn(t.expression),this.globalStateRefs=ci(t.expression),this.interpolationType=n,this._globalState=i}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._globalState&&(e=ui(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._globalState&&(e=ui(e,this._globalState)),this._styleExpression.evaluate(e,t,r,n,i,o)}interpolationFactor(e,t,r){return this.interpolationType?pr.interpolationFactor(this.interpolationType,e,t,r):0}}function ai(e,t,r){const n=ni(e,t,r);if("error"===n.result)return n;const i=n.value.expression,o=zn(i);if(!o&&!Un(t))return jn([new De("","data expressions not supported")]);const a=qn(i,["zoom"]);if(!a&&!Vn(t))return jn([new De("","zoom expressions not supported")]);const s=li(i);return s||a?s instanceof De?jn([s]):s instanceof pr&&!Gn(t)?jn([new De("",'"interpolate" expressions cannot be used with this property')]):Nn(s?new oi(o?"camera":"composite",n.value,s.labels,s instanceof pr?s.interpolation:void 0,r):new ii(o?"constant":"source",n.value,r)):jn([new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class si{constructor(e,t){this._parameters=e,this._specification=t,Re(this,Yn(this._parameters,this._specification))}static deserialize(e){return new si(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function li(e){let t=null;if(e instanceof Qt)t=li(e.result);else if(e instanceof gr){for(const r of e.args)if(t=li(r),t)break}else(e instanceof sr||e instanceof pr)&&e.input instanceof Rn&&"zoom"===e.input.name&&(t=e);return t instanceof De||e.eachChild((e=>{const r=li(e);r instanceof De?t=r:!t&&r?t=new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new De("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function ci(e,t=new Set){return e instanceof Pn&&t.add(e.key),e.eachChild((e=>{ci(e,t)})),t}function ui(e,t){const{zoom:r,heatmapDensity:n,elevation:i,lineProgress:o,isSupportedScript:a,accumulated:s}=null!=e?e:{};return{zoom:r,heatmapDensity:n,elevation:i,lineProgress:o,isSupportedScript:a,accumulated:s,globalState:t}}function hi(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!hi(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const di={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function pi(e,t){if(null==e)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};hi(e)||(e=gi(e));const r=ni(e,di,t);if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,t,n)=>r.value.evaluate(e,t,{},n),needGeometry:mi(e),getGlobalStateRefs:()=>ci(r.value.expression)}}function fi(e,t){return e<t?-1:e>t?1:0}function mi(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(mi(e[t]))return!0;return!1}function gi(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?yi(e[1],e[2],"=="):"!="===t?bi(yi(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?yi(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(gi))):"all"===t?["all"].concat(e.slice(1).map(gi)):"none"===t?["all"].concat(e.slice(1).map(gi).map(bi)):"in"===t?_i(e[1],e.slice(2)):"!in"===t?bi(_i(e[1],e.slice(2))):"has"===t?vi(e[1]):"!has"!==t||bi(vi(e[1]));var r}function yi(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function _i(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(fi)]]:["filter-in-small",e,["literal",t]]}}function vi(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function bi(e){return["!",e]}function wi(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+=`${wi(r)},`;return`${t}]`}const r=Object.keys(e).sort();let n="{";for(let i=0;i<r.length;i++)n+=`${JSON.stringify(r[i])}:${wi(e[r[i]])},`;return`${n}}`}function xi(e){let t="";for(const r of be)t+=`/${wi(e[r])}`;return t}function Si(e){const t=e.value;return t?[new Me(e.key,t,"constants have been deprecated as of v8")]:[]}function Ei(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ti(e){if(Array.isArray(e))return e.map(Ti);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Ti(e[r]);return t}return Ei(e)}function Ai(e){const t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=e.validateSpec;let l=[];const c=Wn(r);if("object"!==c)return[new Me(t,r,`object expected, ${c} found`)];for(const u in r){const e=u.split(".")[0],c=vt(n,e)||n["*"];let h;if(vt(i,e))h=i[e];else if(vt(n,e)){if(void 0===r[u])continue;h=s}else if(i["*"])h=i["*"];else{if(!n["*"]){l.push(new Me(t,r[u],`unknown property "${u}"`));continue}h=s}l=l.concat(h({key:(t?`${t}.`:t)+u,value:r[u],valueSpec:c,style:o,styleSpec:a,object:r,objectKey:u,validateSpec:s},r))}for(const u in n)i[u]||n[u].required&&void 0===n[u].default&&void 0===r[u]&&l.push(new Me(t,r,`missing required property "${u}"`));return l}function Ci(e){const t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,o=e.key,a=e.arrayElementValidator||e.validateSpec;if("array"!==Wn(t))return[new Me(o,t,`array expected, ${Wn(t)} found`)];if(r.length&&t.length!==r.length)return[new Me(o,t,`array length ${r.length} expected, length ${t.length} found`)];let s={type:r.value,values:r.values};i.$version<7&&(s.function=r.function),"object"===Wn(r.value)&&(s=r.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(a({array:t,arrayIndex:c,value:t[c],valueSpec:s,validateSpec:e.validateSpec,style:n,styleSpec:i,key:`${o}[${c}]`}));return l}function Ii(e){const t=e.key,r=e.value,n=e.valueSpec;let i=Wn(r);return"number"===i&&r!=r&&(i="NaN"),"number"!==i?[new Me(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new Me(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new Me(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function ki(e){const t=e.valueSpec,r=Ei(e.value.type);let n,i,o,a={};const s="categorical"!==r&&void 0===e.value.property,l=!s,c="array"===Wn(e.value.stops)&&"array"===Wn(e.value.stops[0])&&"object"===Wn(e.value.stops[0][0]),u=Ai({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new Me(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Ci({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===Wn(n)&&0===n.length&&t.push(new Me(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&u.push(new Me(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||u.push(new Me(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Gn(e.valueSpec)&&u.push(new Me(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!Un(e.valueSpec)?u.push(new Me(e.key,e.value,"property functions not supported")):s&&!Vn(e.valueSpec)&&u.push(new Me(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!c||void 0!==e.value.property||u.push(new Me(e.key,e.value,'"property" property is required')),u;function h(e){let r=[];const n=e.value,s=e.key;if("array"!==Wn(n))return[new Me(s,n,`array expected, ${Wn(n)} found`)];if(2!==n.length)return[new Me(s,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==Wn(n[0]))return[new Me(s,n,`object expected, ${Wn(n[0])} found`)];if(void 0===n[0].zoom)return[new Me(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Me(s,n,"object stop key must have value")];if(o&&o>Ei(n[0].zoom))return[new Me(s,n[0].zoom,"stop zoom values must appear in ascending order")];Ei(n[0].zoom)!==o&&(o=Ei(n[0].zoom),i=void 0,a={}),r=r.concat(Ai({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Ii,value:d}}))}else r=r.concat(d({key:`${s}[0]`,value:n[0],validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return ri(Ti(n[1]))?r.concat([new Me(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${s}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,o){const s=Wn(e.value),l=Ei(e.value),c=null!==e.value?e.value:o;if(n){if(s!==n)return[new Me(e.key,c,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Me(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return Un(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Me(e.key,c,n)]}return"categorical"!==r||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===s&&void 0!==i&&l<i?[new Me(e.key,c,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in a?[new Me(e.key,c,"stop domain values must be unique")]:(a[l]=!0,[])):[new Me(e.key,c,`integer expected, found ${l}`)]}}function Pi(e){const t=("property"===e.expressionContext?ai:ni)(Ti(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new Me(`${e.key}${t.key}`,e.value,t.message)));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Me(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Fn(r))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Fn(r))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!qn(r,["zoom","feature-state"]))return[new Me(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!zn(r))return[new Me(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mi(e){const t=e.key,r=e.value,n=Wn(r);return"string"!==n?[new Me(t,r,`color expected, ${n} found`)]:Ct.parse(String(r))?[]:[new Me(t,r,`color expected, "${r}" found`)]}function Ri(e){const t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(Ei(r))&&i.push(new Me(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(Ei(r))&&i.push(new Me(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function Di(e){return hi(Ti(e.value))?Pi(Re({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Oi(e)}function Oi(e){const t=e.value,r=e.key;if("array"!==Wn(t))return[new Me(r,t,`array expected, ${Wn(t)} found`)];const n=e.styleSpec;let i,o=[];if(t.length<1)return[new Me(r,t,"filter array must have at least 1 element")];switch(o=o.concat(Ri({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ei(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Ei(t[1])&&o.push(new Me(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&o.push(new Me(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=Wn(t[1]),"string"!==i&&o.push(new Me(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let a=2;a<t.length;a++)i=Wn(t[a]),"$type"===Ei(t[1])?o=o.concat(Ri({key:`${r}[${a}]`,value:t[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new Me(`${r}[${a}]`,t[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)o=o.concat(Oi({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Wn(t[1]),2!==t.length?o.push(new Me(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==i&&o.push(new Me(`${r}[1]`,t[1],`string expected, ${i} found`))}return o}function Li(e,t){const r=e.key,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.value,s=e.objectKey,l=o[`${t}_${e.layerType}`];if(!l)return[];const c=s.match(/^(.*)-transition$/);if("paint"===t&&c&&l[c[1]]&&l[c[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});const u=e.valueSpec||l[s];if(!u)return[new Me(r,a,`unknown property "${s}"`)];let h;if("string"===Wn(a)&&Un(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(a)))return[new Me(r,a,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===e.layerType&&"text-font"===s&&Hn(Ti(a))&&"identity"===Ei(a.type)&&d.push(new Me(r,a,'"text-font" does not support identity functions')),d.concat(n({key:e.key,value:a,valueSpec:u,style:i,styleSpec:o,expressionContext:"property",propertyType:t,propertyKey:s}))}function Bi(e){return Li(e,"paint")}function $i(e){return Li(e,"layout")}function zi(e){let t=[];const r=e.value,n=e.key,i=e.style,o=e.styleSpec;if("object"!==Wn(r))return[new Me(n,r,`object expected, ${Wn(r)} found`)];r.type||r.ref||t.push(new Me(n,r,'either "type" or "ref" is required'));let a=Ei(r.type);const s=Ei(r.ref);if(r.id){const o=Ei(r.id);for(let a=0;a<e.arrayIndex;a++){const e=i.layers[a];Ei(e.id)===o&&t.push(new Me(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new Me(n,r[e],`"${e}" is prohibited for ref layers`))})),i.layers.forEach((t=>{Ei(t.id)===s&&(e=t)})),e?e.ref?t.push(new Me(n,r.ref,"ref cannot reference another ref layer")):a=Ei(e.type):t.push(new Me(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==a)if(r.source){const e=i.sources&&i.sources[r.source],o=e&&Ei(e.type);e?"vector"===o&&"raster"===a?t.push(new Me(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==o&&"hillshade"===a||"raster-dem"!==o&&"color-relief"===a?t.push(new Me(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===o&&"raster"!==a?t.push(new Me(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==o||r["source-layer"]?"raster-dem"===o&&"hillshade"!==a&&"color-relief"!==a?t.push(new Me(n,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==a||!r.paint||!r.paint["line-gradient"]||"geojson"===o&&e.lineMetrics||t.push(new Me(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Me(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Me(n,r.source,`source "${r.source}" not found`))}else t.push(new Me(n,r,'missing required property "source"'));return t=t.concat(Ai({key:n,value:r,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:Di,layout:e=>Ai({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>$i(Re({layerType:a},e))}}),paint:e=>Ai({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Bi(Re({layerType:a},e))}})}})),t}function Fi(e){const t=e.value,r=e.key,n=Wn(t);return"string"!==n?[new Me(r,t,`string expected, ${n} found`)]:[]}const qi={promoteId:function({key:e,value:t}){if("string"===Wn(t))return Fi({key:e,value:t});{const r=[];for(const n in t)r.push(...Fi({key:`${e}.${n}`,value:t[n]}));return r}}};function Ni(e){const t=e.value,r=e.key,n=e.styleSpec,i=e.style,o=e.validateSpec;if(!t.type)return[new Me(r,t,'"type" is required')];const a=Ei(t.type);let s;switch(a){case"vector":case"raster":return s=Ai({key:r,value:t,valueSpec:n[`source_${a.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:qi,validateSpec:o}),s;case"raster-dem":return s=function(e){var t;const r=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,i=e.styleSpec,o=i.source_raster_dem,a=e.style;let s=[];const l=Wn(n);if(void 0===n)return s;if("object"!==l)return s.push(new Me("source_raster_dem",n,`object expected, ${l} found`)),s;const c="custom"===Ei(n.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const d in n)!c&&u.includes(d)?s.push(new Me(d,n[d],`In "${r}": "${d}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):o[d]?s=s.concat(e.validateSpec({key:d,value:n[d],valueSpec:o[d],validateSpec:e.validateSpec,style:a,styleSpec:i})):s.push(new Me(d,n[d],`unknown property "${d}"`));return s}({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=Ai({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:qi}),t.cluster)for(const e in t.clusterProperties){const[n,i]=t.clusterProperties[e],o="string"==typeof n?[n,["accumulated"],["get",e]]:n;s.push(...Pi({key:`${r}.${e}.map`,value:i,expressionContext:"cluster-map"})),s.push(...Pi({key:`${r}.${e}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return Ai({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return Ai({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new Me(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ri({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function ji(e){const t=e.value,r=e.styleSpec,n=r.light,i=e.style;let o=[];const a=Wn(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new Me("light",t,`object expected, ${a} found`)]),o;for(const s in t){const a=s.match(/^(.*)-transition$/);o=o.concat(a&&n[a[1]]&&n[a[1]].transition?e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r}):n[s]?e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Me(s,t[s],`unknown property "${s}"`)])}return o}function Ui(e){const t=e.value,r=e.styleSpec,n=r.sky,i=e.style,o=Wn(t);if(void 0===t)return[];if("object"!==o)return[new Me("sky",t,`object expected, ${o} found`)];let a=[];for(const s in t)a=a.concat(n[s]?e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r}):[new Me(s,t[s],`unknown property "${s}"`)]);return a}function Vi(e){const t=e.value,r=e.styleSpec,n=r.terrain,i=e.style;let o=[];const a=Wn(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new Me("terrain",t,`object expected, ${a} found`)]),o;for(const s in t)o=o.concat(n[s]?e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Me(s,t[s],`unknown property "${s}"`)]);return o}function Gi(e){let t=[];const r=e.value,n=e.key;if(Array.isArray(r)){const i=[],o=[];for(const a in r)r[a].id&&i.includes(r[a].id)&&t.push(new Me(n,r,`all the sprites' ids must be unique, but ${r[a].id} is duplicated`)),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&t.push(new Me(n,r,`all the sprites' URLs must be unique, but ${r[a].url} is duplicated`)),o.push(r[a].url),t=t.concat(Ai({key:`${n}[${a}]`,value:r[a],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return Fi({key:n,value:r})}function Wi(e){return Boolean(e)&&e.constructor===Object}function Hi(e){return Wi(e.value)?[]:[new Me(e.key,e.value,`object expected, ${Wn(e.value)} found`)]}const Zi={"*":()=>[],array:Ci,boolean:function(e){const t=e.value,r=e.key,n=Wn(t);return"boolean"!==n?[new Me(r,t,`boolean expected, ${n} found`)]:[]},number:Ii,color:Mi,constants:Si,enum:Ri,filter:Di,function:ki,layer:zi,object:Ai,source:Ni,light:ji,sky:Ui,terrain:Vi,projection:function(e){const t=e.value,r=e.styleSpec,n=r.projection,i=e.style,o=Wn(t);if(void 0===t)return[];if("object"!==o)return[new Me("projection",t,`object expected, ${o} found`)];let a=[];for(const s in t)a=a.concat(n[s]?e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r}):[new Me(s,t[s],`unknown property "${s}"`)]);return a},projectionDefinition:function(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const n=Wn(r);return"array"!==n||(i=r,Array.isArray(i)&&3===i.length&&"string"==typeof i[0]&&"string"==typeof i[1]&&"number"==typeof i[2])||function(e){return!!["interpolate","step","literal"].includes(e[0])}(r)?["array","string"].includes(n)?[]:[new Me(t,r,`projection expected, invalid type "${n}" found`)]:[new Me(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)];var i},string:Fi,formatted:function(e){return 0===Fi(e).length?[]:Pi(e)},resolvedImage:function(e){return 0===Fi(e).length?[]:Pi(e)},padding:function(e){const t=e.key,r=e.value;if("array"===Wn(r)){if(r.length<1||r.length>4)return[new Me(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const n={type:"number"};let i=[];for(let o=0;o<r.length;o++)i=i.concat(e.validateSpec({key:`${t}[${o}]`,value:r[o],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ii({key:t,value:r,valueSpec:{}})},numberArray:function(e){const t=e.key,r=e.value;if("array"===Wn(r)){const n={type:"number"};if(r.length<1)return[new Me(t,r,"array length at least 1 expected, length 0 found")];let i=[];for(let o=0;o<r.length;o++)i=i.concat(e.validateSpec({key:`${t}[${o}]`,value:r[o],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ii({key:t,value:r,valueSpec:{}})},colorArray:function(e){const t=e.key,r=e.value;if("array"===Wn(r)){if(r.length<1)return[new Me(t,r,"array length at least 1 expected, length 0 found")];let e=[];for(let n=0;n<r.length;n++)e=e.concat(Mi({key:`${t}[${n}]`,value:r[n]}));return e}return Mi({key:t,value:r})},variableAnchorOffsetCollection:function(e){const t=e.key,r=e.value,n=Wn(r),i=e.styleSpec;if("array"!==n||r.length<1||r.length%2!=0)return[new Me(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(Ri({key:`${t}[${a}]`,value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(Ci({key:`${t}[${a+1}]`,value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return o},sprite:Gi,state:Hi,fontFaces:function(e){const t=e.key,r=e.value,n=e.validateSpec,i=e.styleSpec,o=e.style;if(!Wi(r))return[new Me(t,r,`object expected, ${Wn(r)} found`)];const a=[];for(const s in r){const e=r[s],l=Wn(e);if("string"===l)a.push(...Fi({key:`${t}.${s}`,value:e}));else if("array"===l){const r={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[l,c]of e.entries())a.push(...Ai({key:`${t}.${s}[${l}]`,value:c,valueSpec:r,styleSpec:i,style:o,validateSpec:n}))}else a.push(new Me(`${t}.${s}`,e,`string or array expected, ${l} found`))}return a}};function Yi(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=Yi,r.expression&&Hn(Ei(t))?ki(e):r.expression&&ri(Ti(t))?Pi(e):r.type&&Zi[r.type]?Zi[r.type](e):Ai(Re({},e,{valueSpec:r.type?n[r.type]:r}))}function Xi(e){const t=e.value,r=e.key,n=Fi(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Me(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Me(r,t,'"glyphs" url must include a "{range}" token'))),n}function Ki(e,t=ve){let r=[];return r=r.concat(Yi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Yi,objectElementValidators:{glyphs:Xi,"*":()=>[]}})),e.constants&&(r=r.concat(Si({key:"constants",value:e.constants}))),Ji(r)}function Qi(e){return function(t){return e(Object.assign({},t,{validateSpec:Yi}))}}function Ji(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function eo(e){return function(...t){return Ji(e.apply(this,t))}}Ki.source=eo(Qi(Ni)),Ki.sprite=eo(Qi(Gi)),Ki.glyphs=eo(Qi(Xi)),Ki.light=eo(Qi(ji)),Ki.sky=eo(Qi(Ui)),Ki.terrain=eo(Qi(Vi)),Ki.state=eo(Qi(Hi)),Ki.layer=eo(Qi(zi)),Ki.filter=eo(Qi(Di)),Ki.paintProperty=eo(Qi(Bi)),Ki.layoutProperty=eo(Qi($i));const to={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class ro{constructor(e,t){this._globalState=t,this.setValue(e)}evaluate(){var e;return null!==(e=this._literalValue)&&void 0!==e?e:this._compiledValue.evaluate({})}setValue(e){if(null==e||"visible"===e||"none"===e)return this._literalValue="none"===e?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const t=ni(e,to,this._globalState);if("error"===t.result)throw this._literalValue="visible",this._compiledValue=void 0,new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=t.value,this._globalStateRefs=ci(t.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const no=ve,io=Ki,oo=io.light,ao=io.sky,so=io.paintProperty,lo=io.layoutProperty;function co(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new ye(new Error(n.message))),r=!0;return r}class uo{constructor(e,t,r){const n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(let e=0;e<this.d*this.d;e++){const t=i[3+e],r=i[3+e+1];n.push(t===r?null:i.subarray(t,r))}const o=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],o),this.bboxes=i.subarray(o),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;const i=r/t*e;this.min=-i,this.max=e+i}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,i,o){this.cells[i].push(o)}query(e,t,r,n,i){const o=this.min,a=this.max;if(e<=o&&t<=o&&a<=r&&a<=n&&!i)return Array.prototype.slice.call(this.keys);{const o=[];return this._forEachCell(e,t,r,n,this._queryCell,o,{},i),o}}_queryCell(e,t,r,n,i,o,a,s){const l=this.cells[i];if(null!==l){const i=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===a[h]){const l=4*h;(s?s(c[l+0],c[l+1],c[l+2],c[l+3]):e<=c[l+2]&&t<=c[l+3]&&r>=c[l+0]&&n>=c[l+1])?(a[h]=!0,o.push(i[h])):a[h]=!1}}}}_forEachCell(e,t,r,n,i,o,a,s){const l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(r),h=this._convertToCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&i.call(this,e,t,r,n,c,o,a,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let r=0;for(let o=0;o<this.cells.length;o++)r+=this.cells[o].length;const n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let i=t;for(let o=0;o<e.length;o++){const t=e[o];n[3+o]=i,n.set(t,i),i+=t.length}return n[3+e.length]=i,n.set(this.keys,i),i+=this.keys.length,n[3+e.length+1]=i,n.set(this.bboxes,i),i+=this.bboxes.length,n.buffer}static serialize(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new uo(e.buffer)}}const ho={};function po(e,t,r={}){if(ho[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),ho[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}po("Object",Object),po("Set",Set),po("TransferableGridIndex",uo),po("Color",Ct),po("Error",Error),po("AJAXError",ue),po("ResolvedImage",zt),po("StylePropertyFunction",si),po("StyleExpression",ti,{omit:["_evaluator"]}),po("ZoomDependentExpression",oi),po("ZoomConstantExpression",ii),po("CompoundExpression",Rn,{omit:["_evaluate"]});for(const $f in Mn)Mn[$f]._classRegistryKey||po(`Expression_${$f}`,Mn[$f]);function fo(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function mo(e){return e.$name||e.constructor._classRegistryKey}function go(e){return!function(e){if(null===e||"object"!=typeof e)return!1;const t=mo(e);return!(!t||"Object"===t)}(e)&&(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||fo(e)||Z(e)||ArrayBuffer.isView(e)||e instanceof ImageData)}function yo(e,t){if(go(e))return(fo(e)||Z(e))&&t&&t.push(e),ArrayBuffer.isView(e)&&t&&t.push(e.buffer),e instanceof ImageData&&t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const n of e)r.push(yo(n,t));return r}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);const r=mo(e);if(!r)throw new Error(`can't serialize object of unregistered class ${e.constructor.name}`);if(!ho[r])throw new Error(`${r} is not registered.`);const{klass:n}=ho[r],i=n.serialize?n.serialize(e,t):{};if(n.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in e){if(!e.hasOwnProperty(n))continue;if(ho[r].omit.indexOf(n)>=0)continue;const o=e[n];i[n]=ho[r].shallow.indexOf(n)>=0?o:yo(o,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}function _o(e){if(go(e))return e;if(Array.isArray(e))return e.map(_o);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);const t=mo(e)||"Object";if(!ho[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=ho[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const i of Object.keys(e)){if("$name"===i)continue;const r=e[i];n[i]=ho[t].shallow.indexOf(i)>=0?r:_o(r)}return n}class vo{constructor(){this.first=!0}update(e,t){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}function bo(e){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))}function wo(e){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))}function xo(e){return/\s/u.test(String.fromCodePoint(e))}function So(e){for(const t of e)if(wo(t.codePointAt(0)))return!0;return!1}function Eo(e){for(const t of e)if(!Co(t.codePointAt(0)))return!1;return!0}function To(e){const t=e.map((e=>{try{return new RegExp(`\\p{sc=${e}}`,"u").source}catch(t){return null}})).filter((e=>e));return new RegExp(t.join("|"),"u")}const Ao=To(["Arab","Dupl","Mong","Ougr","Syrc"]);function Co(e){return!Ao.test(String.fromCodePoint(e))}function Io(e){return!(wo(e)||(t=e,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(t))));var t}const ko=To(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Po(e){return ko.test(String.fromCodePoint(e))}function Mo(e,t){return!(!t&&Po(e)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(e)))}function Ro(e){for(const t of e)if(Po(t.codePointAt(0)))return!0;return!1}const Do=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){if(Do.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(e,r){return t(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if("loading"!==e.pluginStatus)return this.setState(e),e;const t=e.pluginURL,n=new Promise((e=>{this.loadScriptResolve=e}));r(t);const i=new Promise((e=>setTimeout((()=>e()),this.TIMEOUT)));if(yield Promise.race([n,i]),this.isParsed()){const e={pluginStatus:"loaded",pluginURL:t};return this.setState(e),e}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${t}`)}))}};class Oo{constructor(e,t){this.isSupportedScript=Lo,this.zoom=e,t?(this.now=t.now||0,this.fadeDuration=t.fadeDuration||0,this.zoomHistory=t.zoomHistory||new vo,this.transition=t.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vo,this.transition={})}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}function Lo(e){return function(e,t){for(const r of e)if(!Mo(r.codePointAt(0),t))return!1;return!0}(e,"loaded"===Do.getRTLTextPluginStatus())}const Bo="-transition";class $o{constructor(e,t,r){this.property=e,this.value=t,this.expression=function(e,t,r){if(Hn(e))return new si(e,t);if(ri(e)){const n=ai(e,t,r);if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return n.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=Ct.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"numberArray"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"colorArray"!==t.type||"string"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)?r=$t.parse(e):"projectionDefinition"===t.type&&"string"==typeof e&&(r=Ft.parse(e)):r=Ot.parse(e):r=Dt.parse(e):r=Rt.parse(e),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification,r)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class zo{constructor(e,t){this.property=e,this.value=new $o(e,void 0,t)}transitioned(e,t){return new qo(this.property,this.value,t,z({},e.transition,this.transition),e.now)}untransitioned(){return new qo(this.property,this.value,null,{},0)}}class Fo{constructor(e,t){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=t}getValue(e){return j(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new zo(this._values[e].property,this._globalState)),this._values[e].value=new $o(this._values[e].property,null===t?void 0:j(t),this._globalState)}getTransition(e){return j(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new zo(this._values[e].property,this._globalState)),this._values[e].transition=j(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[`${t}${Bo}`]=n)}return e}transitioned(e,t){const r=new No(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new No(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class qo{constructor(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return o.possiblyEvaluate(e,t,r);{const a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),i,D(a))}}return i}}class No{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new Vo(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class jo{constructor(e,t){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=t}hasValue(e){return void 0!==this._values[e].value}getValue(e){return j(this._values[e].value)}setValue(e,t){this._values[e]=new $o(this._values[e].property,null===t?void 0:j(t),this._globalState)}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new Vo(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class Uo{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class Vo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Go{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){const n=mr[this.specification.type];return n?n(e,t,r):e}}class Wo{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return new Uo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Uo(this,{kind:"constant",value:void 0},e.parameters);const n=mr[this.specification.type];if(n){const i=n(e.value.value,t.value.value,r);return new Uo(this,{kind:"constant",value:i},e.parameters)}return e}evaluate(e,t,r,n,i,o){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,o)}}class Ho extends Wo{possiblyEvaluate(e,t,r,n){if(void 0===e.value)return new Uo(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n),o="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(o,o,o,t);return new Uo(this,{kind:"constant",value:a},t)}if("camera"===e.expression.kind){const r=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Uo(this,{kind:"constant",value:r},t)}return new Uo(this,e.expression,t)}evaluate(e,t,r,n,i,o){if("source"===e.kind){const a=e.evaluate(t,r,n,i,o);return this._calculate(a,a,a,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Zo{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new Oo(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Oo(Math.floor(t.zoom),t)),e.expression.evaluate(new Oo(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Yo{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class Xo{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const r=e[t];r.specification.overridable&&this.overridableProperties.push(t);const n=this.defaultPropertyValues[t]=new $o(r,void 0,void 0),i=this.defaultTransitionablePropertyValues[t]=new zo(r,void 0);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}}po("DataDrivenProperty",Wo),po("DataConstantProperty",Go),po("CrossFadedDataDrivenProperty",Ho),po("CrossFadedProperty",Zo),po("ColorRampProperty",Yo);class Ko extends _e{constructor(e,t,r){if(super(),this.id=e.id,this.type=e.type,this._globalState=r,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(n=this.visibility,new ro(n,r)),"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=pi(e.filter,r)),t.layout&&(this._unevaluatedLayout=new jo(t.layout,r)),t.paint)){this._transitionablePaint=new Fo(t.paint,r);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Vo(t.paint)}var n}setFilter(e){this.filter=e,this._featureFilter=pi(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const t of this._visibilityExpression.getGlobalStateRefs())e.add(t);if(this._unevaluatedLayout)for(const t in this._unevaluatedLayout._values){const r=this._unevaluatedLayout._values[t];for(const t of r.getGlobalStateRefs())e.add(t)}for(const t of this._featureFilter.getGlobalStateRefs())e.add(t);return e}getPaintAffectingGlobalStateRefs(){var e;const t=new globalThis.Map;if(this._transitionablePaint)for(const r in this._transitionablePaint._values){const n=this._transitionablePaint._values[r].value;for(const i of n.getGlobalStateRefs()){const o=null!==(e=t.get(i))&&void 0!==e?e:[];o.push({name:r,value:n.value}),t.set(i,o)}}return t}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,t,r={}){if(null==t||!this._validate(lo,`layers.${this.id}.layout.${e}`,e,t,r))return"visibility"===e?(this.visibility=t,this._visibilityExpression.setValue(t),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,t)}getPaintProperty(e){return e.endsWith(Bo)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(so,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(e.endsWith(Bo))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const r=this._transitionablePaint._values[e],n="cross-faded-data-driven"===r.property.specification["property-type"],i=r.value.isDataDriven(),o=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const a=this._transitionablePaint._values[e].value;return a.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(e,o,a)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e=this.minzoom,t=!1){return!!(this.minzoom&&e<(t?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this._evaluatedVisibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),N(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n,i={}){return(!i||!1!==i.validate)&&co(this,e.call(io,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Uo&&Un(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}let Qo;var Jo={get paint(){return Qo=Qo||new Xo({"raster-opacity":new Go(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new Go(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Go(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Go(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new Go(ve.paint_raster["raster-saturation"]),"raster-contrast":new Go(ve.paint_raster["raster-contrast"]),"raster-resampling":new Go(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new Go(ve.paint_raster["raster-fade-duration"])})}};class ea extends Ko{constructor(e,t){super(e,Jo,t)}}const ta={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ra{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class na{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ia(e,t=1){let r=0,n=0;return{members:e.map((e=>{const i=ta[e.type].BYTES_PER_ELEMENT,o=r=oa(r,Math.max(t,i)),a=e.components||1;return n=Math.max(n,i),r+=i*a,{name:e.name,type:e.type,components:a,offset:o}})),size:oa(r,Math.max(n,t)),alignment:t}}function oa(e,t){return Math.ceil(e/t)*t}class aa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}aa.prototype.bytesPerElement=4,po("StructArrayLayout2i4",aa);class sa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}sa.prototype.bytesPerElement=6,po("StructArrayLayout3i6",sa);class la extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=i,e}}la.prototype.bytesPerElement=8,po("StructArrayLayout4i8",la);class ca extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e}}ca.prototype.bytesPerElement=12,po("StructArrayLayout2i4i12",ca);class ua extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=i,this.uint8[l+6]=o,this.uint8[l+7]=a,e}}ua.prototype.bytesPerElement=8,po("StructArrayLayout2i4ub8",ua);class ha extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}ha.prototype.bytesPerElement=8,po("StructArrayLayout2f8",ha);class da extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,o,a,s,l,c)}emplace(e,t,r,n,i,o,a,s,l,c,u){const h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=r,this.uint16[h+2]=n,this.uint16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,e}}da.prototype.bytesPerElement=20,po("StructArrayLayout10ui20",da);class pa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,t,r,n,i,o,a,s)}emplace(e,t,r,n,i,o,a,s,l){const c=8*e;return this.uint16[c+0]=t,this.uint16[c+1]=r,this.uint16[c+2]=n,this.uint16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=l,e}}pa.prototype.bytesPerElement=16,po("StructArrayLayout8ui16",pa);class fa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,r,n,i,o,a,s,l,c,u,h)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=i,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}fa.prototype.bytesPerElement=24,po("StructArrayLayout4i4ui4i24",fa);class ma extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}ma.prototype.bytesPerElement=12,po("StructArrayLayout3f12",ma);class ga extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}ga.prototype.bytesPerElement=4,po("StructArrayLayout1ul4",ga);class ya extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,o,a,s,l)}emplace(e,t,r,n,i,o,a,s,l,c){const u=10*e,h=5*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+3]=i,this.int16[u+4]=o,this.int16[u+5]=a,this.uint32[h+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,e}}ya.prototype.bytesPerElement=20,po("StructArrayLayout6i1ul2ui20",ya);class _a extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e}}_a.prototype.bytesPerElement=12,po("StructArrayLayout2i2i2i12",_a);class va extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const a=4*e,s=8*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.int16[s+6]=i,this.int16[s+7]=o,e}}va.prototype.bytesPerElement=16,po("StructArrayLayout2f1f2i16",va);class ba extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=16*e,l=4*e,c=8*e;return this.uint8[s+0]=t,this.uint8[s+1]=r,this.float32[l+1]=n,this.float32[l+2]=i,this.int16[c+6]=o,this.int16[c+7]=a,e}}ba.prototype.bytesPerElement=16,po("StructArrayLayout2ub2f2i16",ba);class wa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}wa.prototype.bytesPerElement=6,po("StructArrayLayout3ui6",wa);class xa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y){const _=24*e,v=12*e,b=48*e;return this.int16[_+0]=t,this.int16[_+1]=r,this.uint16[_+2]=n,this.uint16[_+3]=i,this.uint32[v+2]=o,this.uint32[v+3]=a,this.uint32[v+4]=s,this.uint16[_+10]=l,this.uint16[_+11]=c,this.uint16[_+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[b+36]=p,this.uint8[b+37]=f,this.uint8[b+38]=m,this.uint32[v+10]=g,this.int16[_+22]=y,e}}xa.prototype.bytesPerElement=48,po("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xa);class Sa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C){const I=this.length;return this.resize(I+1),this.emplace(I,e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C)}emplace(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C,I){const k=32*e,P=16*e;return this.int16[k+0]=t,this.int16[k+1]=r,this.int16[k+2]=n,this.int16[k+3]=i,this.int16[k+4]=o,this.int16[k+5]=a,this.int16[k+6]=s,this.int16[k+7]=l,this.uint16[k+8]=c,this.uint16[k+9]=u,this.uint16[k+10]=h,this.uint16[k+11]=d,this.uint16[k+12]=p,this.uint16[k+13]=f,this.uint16[k+14]=m,this.uint16[k+15]=g,this.uint16[k+16]=y,this.uint16[k+17]=_,this.uint16[k+18]=v,this.uint16[k+19]=b,this.uint16[k+20]=w,this.uint16[k+21]=x,this.uint16[k+22]=S,this.uint32[P+12]=E,this.float32[P+13]=T,this.float32[P+14]=A,this.uint16[k+30]=C,this.uint16[k+31]=I,e}}Sa.prototype.bytesPerElement=64,po("StructArrayLayout8i15ui1ul2f2ui64",Sa);class Ea extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Ea.prototype.bytesPerElement=4,po("StructArrayLayout1f4",Ea);class Ta extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[6*e+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}Ta.prototype.bytesPerElement=12,po("StructArrayLayout1ui2f12",Ta);class Aa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=r,this.uint16[i+3]=n,e}}Aa.prototype.bytesPerElement=8,po("StructArrayLayout1ul2ui8",Aa);class Ca extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}Ca.prototype.bytesPerElement=4,po("StructArrayLayout2ui4",Ca);class Ia extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Ia.prototype.bytesPerElement=2,po("StructArrayLayout1ui2",Ia);class ka extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,e}}ka.prototype.bytesPerElement=16,po("StructArrayLayout4f16",ka);class Pa extends ra{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new r(this.anchorPointX,this.anchorPointY)}}Pa.prototype.size=20;class Ma extends ya{get(e){return new Pa(this,e)}}po("CollisionBoxArray",Ma);class Ra extends ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ra.prototype.size=48;class Da extends xa{get(e){return new Ra(this,e)}}po("PlacedSymbolArray",Da);class Oa extends ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Oa.prototype.size=64;class La extends Sa{get(e){return new Oa(this,e)}}po("SymbolInstanceArray",La);class Ba extends Ea{getoffsetX(e){return this.float32[1*e+0]}}po("GlyphOffsetArray",Ba);class $a extends sa{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}po("SymbolLineVertexArray",$a);class za extends ra{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}za.prototype.size=12;class Fa extends Ta{get(e){return new za(this,e)}}po("TextAnchorOffsetArray",Fa);class qa extends ra{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}qa.prototype.size=8;class Na extends Aa{get(e){return new qa(this,e)}}po("FeatureIndexArray",Na);class ja extends aa{}class Ua extends aa{}class Va extends aa{}class Ga extends ca{}class Wa extends ua{}class Ha extends ha{}class Za extends da{}class Ya extends pa{}class Xa extends fa{}class Ka extends ma{}class Qa extends ga{}class Ja extends _a{}class es extends ba{}class ts extends wa{}class rs extends Ca{}const ns=ia([{name:"a_pos",components:2,type:"Int16"}],4),{members:is}=ns;class os{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,t,r,n){const i=this.segments[this.segments.length-1];return e>os.MAX_VERTEX_ARRAY_LENGTH&&V(`Max vertices per segment is ${os.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${os.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!i||i.vertexLength+e>os.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n?this.createNewSegment(t,r,n):i}createNewSegment(e,t,r){const n={vertexOffset:e.length,primitiveOffset:t.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==r&&(n.sortKey=r),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(n),n}getOrCreateLatestSegment(e,t,r){return this.prepareSegment(0,e,t,r)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new os([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}function as(e,t){return 256*(e=B(Math.floor(e),0,255))+B(Math.floor(t),0,255)}os.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,po("SegmentVector",os);const ss=ia([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ls=ia([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var cs,us,hs,ds={exports:{}},ps={exports:{}},fs={exports:{}},ms=function(){if(hs)return ds.exports;hs=1;var e=(cs||(cs=1,ps.exports=function(e,t){var r,n,i,o,a,s,l,c;for(n=e.length-(r=3&e.length),i=t,a=3432918353,s=461845907,c=0;c<n;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}),ps.exports),t=(us||(us=1,fs.exports=function(e,t){for(var r,n=e.length,i=t^n,o=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}),fs.exports);return ds.exports=e,ds.exports.murmur3=e,ds.exports.murmur2=t,ds.exports}(),gs=n(ms);class ys{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(_s(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=_s(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=t?n=e:r=e+1}const i=[];for(;this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(e,t){const r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return vs(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){const t=new ys;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function _s(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:gs(String(e))}function vs(e,t,r,n){for(;r<n;){const i=e[r+n>>1];let o=r-1,a=n+1;for(;;){do{o++}while(e[o]<i);do{a--}while(e[a]>i);if(o>=a)break;bs(e,o,a),bs(t,3*o,3*a),bs(t,3*o+1,3*a+1),bs(t,3*o+2,3*a+2)}a-r<n-a?(vs(e,t,r,a),r=a+1):(vs(e,t,a+1,n),n=a)}}function bs(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}po("FeaturePositionMap",ys);class ws{constructor(e,t){this.gl=e.gl,this.location=t}}class xs extends ws{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ss extends ws{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Es extends ws{constructor(e,t){super(e,t),this.current=Ct.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Ts=new Float32Array(16);function As(e){return[as(255*e.r,255*e.g),as(255*e.b,255*e.a)]}class Cs{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new Es(e,t):new xs(e,t)}}class Is{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,t){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,t.y,t.height,t.width]}setUniform(e,t,r,n){let i=null;"u_pattern_to"===n?i=this.patternTo:"u_pattern_from"===n?i=this.patternFrom:"u_dasharray_to"===n?i=this.dashTo:"u_dasharray_from"===n?i=this.dashFrom:"u_pixel_ratio_to"===n?i=this.pixelRatioTo:"u_pixel_ratio_from"===n&&(i=this.pixelRatioFrom),null!==i&&e.set(i)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)||"u_dasharray_"===r.substr(0,12)?new Ss(e,t):new xs(e,t)}}class ks{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r){const n=this.paintVertexArray.length,i=this.expression.evaluate(new Oo(0,r),t,{},r.canonical,[],r.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(n,e,i)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate(new Oo(0,i),r,n);this._setPaintValue(e,t,o)}_setPaintValue(e,t,r){if("color"===this.type){const n=As(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ps{constructor(e,t,r,n,i,o){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,r){const n=this.expression.evaluate(new Oo(this.zoom,r),t,{},r.canonical,[],r.formattedSection),i=this.expression.evaluate(new Oo(this.zoom+1,r),t,{},r.canonical,[],r.formattedSection),o=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(o,e,n,i)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate(new Oo(this.zoom,i),r,n),a=this.expression.evaluate(new Oo(this.zoom+1,i),r,n);this._setPaintValue(e,t,o,a)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=As(r),o=As(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],o[0],o[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=B(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new xs(e,t)}}class Ms{constructor(e,t,r,n,i,o){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,r){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,this.getPositionIds(t),r)}updatePaintArray(e,t,r,n,i){this._setPaintValues(e,t,this.getPositionIds(r),i)}_setPaintValues(e,t,r,n){const i=this.getPositions(n);if(!i||!r)return;const o=i[r.min],a=i[r.mid],s=i[r.max];if(o&&a&&s)for(let l=e;l<t;l++)this.emplace(this.zoomInPaintVertexArray,l,a,o),this.emplace(this.zoomOutPaintVertexArray,l,a,s)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const t=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,t,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,t,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Rs extends Ms{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return ss.members}emplace(e,t,r,n){e.emplace(t,r.tlbr[0],r.tlbr[1],r.tlbr[2],r.tlbr[3],n.tlbr[0],n.tlbr[1],n.tlbr[2],n.tlbr[3],r.pixelRatio,n.pixelRatio)}}class Ds extends Ms{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return ls.members}emplace(e,t,r,n){e.emplace(t,0,r.y,r.height,r.width,0,n.y,n.height,n.width)}}class Os{constructor(e,t,r){this.binders={},this._buffers=[];const n=[];for(const i in e.paint._values){if(!r(i))continue;const o=e.paint.get(i);if(!(o instanceof Uo&&Un(o.property.specification)))continue;const a=Bs(i,e.type),s=o.value,l=o.property.specification.type,c=o.property.useIntegerZoom,u=o.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[i]=h?new Is(s.value,a):new Cs(s.value,a,l),n.push(`/u_${i}`);else if("source"===s.kind||h){const r=$s(i,l,"source");this.binders[i]=h?"line-dasharray"===i?new Ds(s,l,c,t,r,e.id):new Rs(s,l,c,t,r,e.id):new ks(s,a,l,r),n.push(`/a_${i}`)}else{const e=$s(i,l,"composite");this.binders[i]=new Ps(s,a,l,c,t,e),n.push(`/z_${i}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof ks||t instanceof Ps?t.maxValue:0}populatePaintArrays(e,t,r){for(const n in this.binders){const i=this.binders[n];(i instanceof ks||i instanceof Ps||i instanceof Ms)&&i.populatePaintArray(e,t,r)}}setConstantPatternPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof Is&&n.setConstantPatternPositions(e,t)}}setConstantDashPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof Is&&n.setConstantDashPositions(e,t)}}updatePaintArrays(e,t,r,n,i){let o=!1;for(const a in e){const s=t.getPositions(a);for(const t of s){const s=r.feature(t.index);for(const r in this.binders){const l=this.binders[r];if((l instanceof ks||l instanceof Ps||l instanceof Ms)&&!0===l.expression.isStateDependent){const c=n.paint.get(r);l.expression=c.value,l.updatePaintArray(t.start,t.end,s,e[a],i),o=!0}}}}return o}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof Cs||r instanceof Is)&&e.push(...r.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof ks||r instanceof Ps)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof Ms){const t=r.getVertexAttributes();for(const r of t)e.push(r.name)}}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof Cs||r instanceof Is||r instanceof Ps)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const r=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof Cs||i instanceof Is||i instanceof Ps)for(const o of i.uniformNames)if(t[o]){const a=i.getBinding(e,t[o],o);r.push({name:o,property:n,binding:a})}}return r}setUniforms(e,t,r,n){for(const{name:i,property:o,binding:a}of t)this.binders[o].setUniform(a,n,r.get(o),i)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const r=this.binders[t];if(e&&r instanceof Ms){const t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof ks||r instanceof Ps)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof ks||r instanceof Ps||r instanceof Ms)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof ks||t instanceof Ps||t instanceof Ms)&&t.destroy()}}}class Ls{constructor(e,t,r=()=>!0){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new Os(n,t,r);this.needsUpload=!1,this._featureMap=new ys,this._bufferOffset=0}populatePaintArrays(e,t,r,n){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(e,t,n);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(const i of r)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Bs(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function $s(e,t,r){const n={color:{source:ha,composite:ka},number:{source:Ea,composite:ha}},i={"line-pattern":{source:Za,composite:Za},"fill-pattern":{source:Za,composite:Za},"fill-extrusion-pattern":{source:Za,composite:Za},"line-dasharray":{source:Ya,composite:Ya}}[e];return i&&i[r]||n[t][r]}po("ConstantBinder",Cs),po("CrossFadedConstantBinder",Is),po("SourceExpressionBinder",ks),po("CrossFadedPatternBinder",Rs),po("CrossFadedDasharrayBinder",Ds),po("CompositeExpressionBinder",Ps),po("ProgramConfiguration",Os,{omit:["_buffers"]}),po("ProgramConfigurationSet",Ls);const zs=Math.pow(2,14)-1,Fs=-zs-1;function qs(e){const t=k/e.extent,r=e.loadGeometry();for(let n=0;n<r.length;n++){const e=r[n];for(let r=0;r<e.length;r++){const n=e[r],i=Math.round(n.x*t),o=Math.round(n.y*t);n.x=B(i,Fs,zs),n.y=B(o,Fs,zs),(i<n.x||i>n.x+1||o<n.y||o>n.y+1)&&V("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Ns(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?qs(e):[]}}const js=-32768;function Us(e,t,r,n,i){e.emplaceBack(js+8*t+n,js+8*r+i)}class Vs{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Ua,this.indexArray=new ts,this.segments=new os,this.programConfigurations=new Ls(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){const n=this.layers[0],i=[];let o=null,a=!1,s="heatmap"===n.type;if("circle"===n.type){const e=n;o=e.layout.get("circle-sort-key"),a=!o.isConstant(),s=s||"map"===e.paint.get("circle-pitch-alignment")}const l=s?t.subdivisionGranularity.circle:1;for(const{feature:c,id:u,index:h,sourceLayerIndex:d}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Ns(c,e);if(!this.layers[0]._featureFilter.filter(new Oo(this.zoom),t,r))continue;const n=a?o.evaluate(t,{},r):void 0,s={id:u,properties:c.properties,type:c.type,sourceLayerIndex:d,index:h,geometry:e?t.geometry:qs(c),patterns:{},sortKey:n};i.push(s)}a&&i.sort(((e,t)=>e.sortKey-t.sortKey));for(const c of i){const{geometry:n,index:i,sourceLayerIndex:o}=c,a=e[i].feature;this.addFeature(c,n,i,r,l),t.featureIndex.insert(a,n,i,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,is),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n,i=1){let o;switch(i){case 1:o=[0,7];break;case 3:o=[0,2,5,7];break;case 5:o=[0,1,3,4,6,7];break;case 7:o=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${i}; valid values are 1, 3, 5, 7.`)}const a=o.length;for(const s of t)for(const t of s){const r=t.x,n=t.y;if(r<0||r>=k||n<0||n>=k)continue;const i=this.segments.prepareSegment(a*a,this.layoutVertexArray,this.indexArray,e.sortKey),s=i.vertexLength;for(let e=0;e<a;e++)for(let t=0;t<a;t++)Us(this.layoutVertexArray,r,n,o[t],o[e]);for(let e=0;e<a-1;e++)for(let t=0;t<a-1;t++){const r=s+e*a+t,n=s+(e+1)*a+t;this.indexArray.emplaceBack(r,n+1,r+1),this.indexArray.emplaceBack(r,n,n+1)}i.vertexLength+=a*a,i.primitiveLength+=(a-1)*(a-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:{},canonical:n})}}function Gs(e,t){for(let r=0;r<e.length;r++)if(el(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(el(e,t[r]))return!0;return!!Ys(e,t)}function Ws(e,t,r){return!!el(e,t)||!!Ks(t,e,r)}function Hs(e,t){if(1===e.length)return Js(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(el(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(Js(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Ys(e,t[r]))return!0;return!1}function Zs(e,t,r){if(e.length>1){if(Ys(e,t))return!0;for(let n=0;n<t.length;n++)if(Ks(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(Ks(e[n],t,r))return!0;return!1}function Ys(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)if(Xs(n,i,t[e],t[e+1]))return!0}return!1}function Xs(e,t,r,n){return G(e,r,n)!==G(t,r,n)&&G(e,t,r)!==G(e,t,n)}function Ks(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let i=1;i<t.length;i++)if(Qs(e,t[i-1],t[i])<n)return!0;return!1}function Qs(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function Js(e,t){let r,n,i,o=!1;for(let a=0;a<e.length;a++){r=e[a];for(let e=0,a=r.length-1;e<r.length;a=e++)n=r[e],i=r[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(o=!o)}return o}function el(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const o=e[n],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function tl(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const o=G(e,t,r[0]);return o!==G(e,t,r[1])||o!==G(e,t,r[2])||o!==G(e,t,r[3])}function rl(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function nl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function il(e,t,n,i,o){if(!t[0]&&!t[1])return e;const a=r.convert(t)._mult(o);"viewport"===n&&a._rotate(-i);const s=[];for(let r=0;r<e.length;r++)s.push(e[r].sub(a));return s}function ol(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],i=t.at(-1);(0===r||i&&!n.equals(i))&&t.push(n)}return t}function al({queryGeometry:e,size:t},r){return Ws(e,r,t)}function sl({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},o){return Ws(e,o,t*(r.projectTileCoordinates(o.x,o.y,n,i).signedDistanceFromCamera/r.cameraToCenterDistance))}function ll({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},o){const a=r.projectTileCoordinates(o.x,o.y,n,i).signedDistanceFromCamera,s=t*(r.cameraToCenterDistance/a);return Ws(e,hl(o,r,n,i),s)}function cl({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i},o){return Ws(e,hl(o,r,n,i),t)}function ul({queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i,pitchAlignment:o="map",pitchScale:a="map"},s){const l="map"===o?"map"===a?al:sl:"map"===a?ll:cl,c={queryGeometry:e,size:t,transform:r,unwrappedTileID:n,getElevation:i};for(const u of s)for(const e of u)if(l(c,e))return!0;return!1}function hl(e,t,n,i){const o=t.projectTileCoordinates(e.x,e.y,n,i).point;return new r((.5*o.x+.5)*t.width,(.5*-o.y+.5)*t.height)}let dl,pl;po("CircleBucket",Vs,{omit:["layers"]});var fl={get paint(){return pl=pl||new Xo({"circle-radius":new Wo(ve.paint_circle["circle-radius"]),"circle-color":new Wo(ve.paint_circle["circle-color"]),"circle-blur":new Wo(ve.paint_circle["circle-blur"]),"circle-opacity":new Wo(ve.paint_circle["circle-opacity"]),"circle-translate":new Go(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new Go(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Go(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Go(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wo(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wo(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wo(ve.paint_circle["circle-stroke-opacity"])})},get layout(){return dl=dl||new Xo({"circle-sort-key":new Wo(ve.layout_circle["circle-sort-key"])})}};class ml extends Ko{constructor(e,t){super(e,fl,t)}createBucket(e){return new Vs(e)}queryRadius(e){const t=e;return rl("circle-radius",this,t)+rl("circle-stroke-width",this,t)+nl(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:o,unwrappedTileID:a,getElevation:s}){const l=il(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-i.bearingInRadians,o),c=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),u=this.paint.get("circle-pitch-scale"),h=this.paint.get("circle-pitch-alignment");let d,p;return"map"===h?(d=l,p=c*o):(f=i,m=a,g=s,d=l.map((e=>hl(e,f,m,g))),p=c),ul({queryGeometry:d,size:p,transform:i,unwrappedTileID:a,getElevation:s,pitchAlignment:h,pitchScale:u},n);var f,m,g}}class gl extends Vs{}let yl;po("HeatmapBucket",gl,{omit:["layers"]});var _l={get paint(){return yl=yl||new Xo({"heatmap-radius":new Wo(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wo(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Go(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Yo(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Go(ve.paint_heatmap["heatmap-opacity"])})}};function vl(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`)}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function bl(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;const i=vl({},{width:t,height:r},n);wl(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function wl(e,t,r,n,i,o){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const a=e.data,s=t.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){const c=((r.y+l)*e.width+r.x)*o,u=((n.y+l)*t.width+n.x)*o;for(let e=0;e<i.width*o;e++)s[u+e]=a[c+e]}return t}class xl{constructor(e,t){vl(this,e,1,t)}resize(e){bl(this,e,1)}clone(){return new xl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){wl(e,t,r,n,i,1)}}class Sl{constructor(e,t){vl(this,e,4,t)}resize(e){bl(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Sl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){wl(e,t,r,n,i,4)}setPixel(e,t,r){const n=4*(e*this.width+t);this.data[n+0]=Math.round(255*r.r/r.a),this.data[n+1]=Math.round(255*r.g/r.a),this.data[n+2]=Math.round(255*r.b/r.a),this.data[n+3]=Math.round(255*r.a)}}function El(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new Sl({width:r,height:n});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const o=(n,o,a)=>{t[e.evaluationKey]=a;const s=e.expression.evaluate(t);i.setPixel(n/4/r,o/4,s)};if(e.clips)for(let a=0,s=0;a<n;++a,s+=4*r)for(let t=0,n=0;t<r;t++,n+=4){const i=t/(r-1),{start:l,end:c}=e.clips[a];o(s,n,l*(1-i)+c*i)}else for(let a=0,s=0;a<r;a++,s+=4)o(0,s,a/(r-1));return i}po("AlphaImage",xl),po("RGBAImage",Sl);const Tl="big-fb";class Al extends Ko{createBucket(e){return new gl(e)}constructor(e,t){super(e,_l,t),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=El({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Tl)&&this.heatmapFbos.delete(Tl)}queryRadius(e){return rl("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:o,unwrappedTileID:a,getElevation:s}){return ul({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(t,r)*o,transform:i,unwrappedTileID:a,getElevation:s},n)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&!this.isHidden()}}let Cl;var Il={get paint(){return Cl=Cl||new Xo({"hillshade-illumination-direction":new Go(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Go(ve.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Go(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Go(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Go(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Go(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Go(ve.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Go(ve.paint_hillshade["hillshade-method"])})}};class kl extends Ko{constructor(e,t){super(e,Il,t),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,t=this.paint.get("hillshade-illumination-altitude").values,r=this.paint.get("hillshade-highlight-color").values,n=this.paint.get("hillshade-shadow-color").values;const i=Math.max(e.length,t.length,r.length,n.length);e=e.concat(Array(i-e.length).fill(e.at(-1))),t=t.concat(Array(i-t.length).fill(t.at(-1))),r=r.concat(Array(i-r.length).fill(r.at(-1))),n=n.concat(Array(i-n.length).fill(n.at(-1)));const o=t.map(ee);return{directionRadians:e.map(ee),altitudeRadians:o,shadowColor:n,highlightColor:r}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&!this.isHidden()}}let Pl;var Ml={get paint(){return Pl=Pl||new Xo({"color-relief-opacity":new Go(ve["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Yo(ve["paint_color-relief"]["color-relief-color"])})}};class Rl{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,t,r){const{width:n,height:i}=e,o=!(this.size&&this.size[0]===n&&this.size[1]===i||r),{context:a}=this,{gl:s}=a;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),o)this.size=[n,i],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Z(e)?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,n,i,0,this.format,s.UNSIGNED_BYTE,e.data);else{const{x:t,y:o}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||Z(e)?s.texSubImage2D(s.TEXTURE_2D,0,t,o,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,t,o,n,i,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D),a.pixelStoreUnpackFlipY.setDefault(),a.pixelStoreUnpack.setDefault(),a.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,t,r){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Dl{constructor(e,t,r,n=1,i=1,o=1,a=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))return void V(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;const s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=i,this.blueFactor=o,this.baseShift=a;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let l=0;l<s;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(s,l)]=this.data[this._idx(s-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,s)]=this.data[this._idx(l,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let l=0;l<s;l++)for(let e=0;e<s;e++){const t=this.get(l,e);t>this.max&&(this.max=t),t<this.min&&(this.min=t)}}get(e,t){const r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return this.unpack(r[n],r[n+1],r[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${t}, dim: ${this.dim}`);return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}pack(e){return Ol(e,this.getUnpackVector())}getPixels(){return new Sl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}const s=-t*this.dim,l=-r*this.dim;for(let c=o;c<a;c++)for(let t=n;t<i;t++)this.data[this._idx(t,c)]=e.data[this._idx(t+s,c+l)]}}function Ol(e,t){const r=t[0],n=t[1],i=t[2],o=t[3],a=Math.min(r,n,i),s=Math.round((e+o)/a);return{r:Math.floor(s*a/r)%256,g:Math.floor(s*a/n)%256,b:Math.floor(s*a/i)%256}}po("DEMData",Dl);class Ll extends Ko{constructor(e,t){super(e,Ml,t)}_createColorRamp(e){const t={elevationStops:[],colorStops:[]},r=this._transitionablePaint._values["color-relief-color"].value.expression;if(r instanceof ii&&r._styleExpression.expression instanceof pr){this.colorRampExpression=r;const e=r._styleExpression.expression;t.elevationStops=e.labels,t.colorStops=[];for(const r of t.elevationStops)t.colorStops.push(e.evaluate({globals:{elevation:r}}))}if(t.elevationStops.length<1&&(t.elevationStops=[0],t.colorStops=[Ct.transparent]),t.elevationStops.length<2&&(t.elevationStops.push(t.elevationStops[0]+1),t.colorStops.push(t.colorStops[0])),t.elevationStops.length<=e)return t;const n={elevationStops:[],colorStops:[]},i=(t.elevationStops.length-1)/(e-1);for(let o=0;o<t.elevationStops.length-.5;o+=i)n.elevationStops.push(t.elevationStops[Math.round(o)]),n.colorStops.push(t.colorStops[Math.round(o)]);return V(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${t.elevationStops.length}`),n}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,t,r){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const n=this._createColorRamp(t),i=new Sl({width:n.colorStops.length,height:1}),o=new Sl({width:n.colorStops.length,height:1});for(let a=0;a<n.elevationStops.length;a++){const e=Ol(n.elevationStops[a],r);o.setPixel(0,a,new Ct(e.r/255,e.g/255,e.b/255,1)),i.setPixel(0,a,n.colorStops[a])}return this.colorRampTextures={elevationTexture:new Rl(e,o,e.gl.RGBA),colorTexture:new Rl(e,i,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const Bl=ia([{name:"a_pos",components:2,type:"Int16"}],4),{members:$l}=Bl;function zl(e,t,r){const n=r.patternDependencies;let i=!1;for(const o of t){const t=o.paint.get(`${e}-pattern`);t.isConstant()||(i=!0);const r=t.constantOr(null);r&&(i=!0,n[r.to]=!0,n[r.from]=!0)}return i}function Fl(e,t,r,n,i){const{zoom:o}=n,a=i.patternDependencies;for(const s of t){const t=s.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:o-1},r,{},i.availableImages),n=t.evaluate({zoom:o},r,{},i.availableImages),l=t.evaluate({zoom:o+1},r,{},i.availableImages);e=e&&e.name?e.name:e,n=n&&n.name?n.name:n,l=l&&l.name?l.name:l,a[e]=!0,a[n]=!0,a[l]=!0,r.patterns[s.id]={min:e,mid:n,max:l}}}return r}function ql(e,t,r,n,i){let o;if(i===function(e,t,r,n){let i=0;for(let o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,r,n)>0)for(let a=t;a<r;a+=n)o=lc(a/n|0,e[a],e[a+1],o);else for(let a=r-n;a>=t;a-=n)o=lc(a/n|0,e[a],e[a+1],o);return o&&rc(o,o.next)&&(cc(o),o=o.next),o}function Nl(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!rc(n,n.next)&&0!==tc(n.prev,n,n.next))n=n.next;else{if(cc(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function jl(e,t,r,n,i,o,a){if(!e)return;!a&&o&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=Xl(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let o=null;for(t=0;i;){t++;let a=i,s=0;for(let e=0;e<r&&(s++,a=a.nextZ,a);e++);let l=r;for(;s>0||l>0&&a;)0!==s&&(0===l||!a||i.z<=a.z)?(n=i,i=i.nextZ,s--):(n=a,a=a.nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=a}o.nextZ=null,r*=2}while(t>1)}(i)}(e,n,i,o);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(o?Vl(e,n,i,o):Ul(e))t.push(l.i,e.i,c.i),cc(e),e=c.next,s=c.next;else if((e=c)===s){a?1===a?jl(e=Gl(Nl(e),t),t,r,n,i,o,2):2===a&&Wl(e,t,r,n,i,o):jl(Nl(e),t,r,n,i,o,1);break}}}function Ul(e){const t=e.prev,r=e,n=e.next;if(tc(t,r,n)>=0)return!1;const i=t.x,o=r.x,a=n.x,s=t.y,l=r.y,c=n.y,u=Math.min(i,o,a),h=Math.min(s,l,c),d=Math.max(i,o,a),p=Math.max(s,l,c);let f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Jl(i,s,o,l,a,c,f.x,f.y)&&tc(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Vl(e,t,r,n){const i=e.prev,o=e,a=e.next;if(tc(i,o,a)>=0)return!1;const s=i.x,l=o.x,c=a.x,u=i.y,h=o.y,d=a.y,p=Math.min(s,l,c),f=Math.min(u,h,d),m=Math.max(s,l,c),g=Math.max(u,h,d),y=Xl(p,f,t,r,n),_=Xl(m,g,t,r,n);let v=e.prevZ,b=e.nextZ;for(;v&&v.z>=y&&b&&b.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==a&&Jl(s,u,l,h,c,d,v.x,v.y)&&tc(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&Jl(s,u,l,h,c,d,b.x,b.y)&&tc(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==a&&Jl(s,u,l,h,c,d,v.x,v.y)&&tc(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=_;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==a&&Jl(s,u,l,h,c,d,b.x,b.y)&&tc(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Gl(e,t){let r=e;do{const n=r.prev,i=r.next.next;!rc(n,i)&&nc(n,r,r.next,i)&&ac(n,i)&&ac(i,n)&&(t.push(n.i,r.i,i.i),cc(r),cc(r.next),r=e=i),r=r.next}while(r!==e);return Nl(r)}function Wl(e,t,r,n,i,o){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&ec(a,e)){let s=sc(a,e);return a=Nl(a,a.next),s=Nl(s,s.next),jl(a,t,r,n,i,o,0),void jl(s,t,r,n,i,o,0)}e=e.next}a=a.next}while(a!==e)}function Hl(e,t){let r=e.x-t.x;return 0===r&&(r=e.y-t.y,0===r)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function Zl(e,t){const r=function(e,t){let r=t;const n=e.x,i=e.y;let o,a=-1/0;if(rc(e,r))return r;do{if(rc(e,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){const e=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>a&&(a=e,o=r.x<r.next.x?r:r.next,e===n))return o}r=r.next}while(r!==t);if(!o)return null;const s=o,l=o.x,c=o.y;let u=1/0;r=o;do{if(n>=r.x&&r.x>=l&&n!==r.x&&Ql(i<c?n:a,i,l,c,i<c?a:n,i,r.x,r.y)){const t=Math.abs(i-r.y)/(n-r.x);ac(r,e)&&(t<u||t===u&&(r.x>o.x||r.x===o.x&&Yl(o,r)))&&(o=r,u=t)}r=r.next}while(r!==s);return o}(e,t);if(!r)return t;const n=sc(r,e);return Nl(n,n.next),Nl(r,r.next)}function Yl(e,t){return tc(e.prev,e,t.prev)<0&&tc(t.next,e,e.next)<0}function Xl(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Kl(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Ql(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function Jl(e,t,r,n,i,o,a,s){return!(e===a&&t===s)&&Ql(e,t,r,n,i,o,a,s)}function ec(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&nc(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(ac(e,t)&&ac(t,e)&&function(e,t){let r=e,n=!1;const i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(tc(e.prev,e,t.prev)||tc(e,t.prev,t))||rc(e,t)&&tc(e.prev,e,e.next)>0&&tc(t.prev,t,t.next)>0)}function tc(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function rc(e,t){return e.x===t.x&&e.y===t.y}function nc(e,t,r,n){const i=oc(tc(e,t,r)),o=oc(tc(e,t,n)),a=oc(tc(r,n,e)),s=oc(tc(r,n,t));return i!==o&&a!==s||!(0!==i||!ic(e,r,t))||!(0!==o||!ic(e,n,t))||!(0!==a||!ic(r,e,n))||!(0!==s||!ic(r,t,n))}function ic(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function oc(e){return e>0?1:e<0?-1:0}function ac(e,t){return tc(e.prev,e,e.next)<0?tc(e,t,e.next)>=0&&tc(e,e.prev,t)>=0:tc(e,t,e.prev)<0||tc(e,e.next,t)<0}function sc(e,t){const r=uc(e.i,e.x,e.y),n=uc(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function lc(e,t,r,n){const i=uc(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function cc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function uc(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class hc{constructor(e,t){if(t>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=t}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class dc{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}dc.noSubdivision=new dc({fill:new hc(0,0),line:new hc(0,0),tile:new hc(0,0),stencil:new hc(0,0),circle:1}),po("SubdivisionGranularityExpression",hc),po("SubdivisionGranularitySetting",dc);const pc=-32768,fc=32767;class mc{constructor(e,t){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=k/e,this._canonical=t}_getKey(e,t){return(e+=32768)<<16|t+32768}_vertexToIndex(e,t){if(e<-32768||t<-32768||e>32767||t>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const r=0|Math.round(e),n=0|Math.round(t),i=this._getKey(r,n);if(this._vertexDictionary.has(i))return this._vertexDictionary.get(i);const o=this._vertexBuffer.length/2;return this._vertexDictionary.set(i,o),this._vertexBuffer.push(r,n),o}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(e,t){const r=[];for(let n=0;n<t.length;n+=3){const i=t[n],o=t[n+1],a=t[n+2],s=e[2*i],l=e[2*i+1];(e[2*o]-s)*(e[2*a+1]-l)-(e[2*o+1]-l)*(e[2*a]-s)>0?(r.push(i),r.push(a),r.push(o)):(r.push(i),r.push(o),r.push(a))}return r}(this._vertexBuffer,e);const t=[],r=e.length;for(let n=0;n<r;n+=3){const r=[e[n+0],e[n+1],e[n+2]],i=[this._vertexBuffer[2*e[n+0]+0],this._vertexBuffer[2*e[n+0]+1],this._vertexBuffer[2*e[n+1]+0],this._vertexBuffer[2*e[n+1]+1],this._vertexBuffer[2*e[n+2]+0],this._vertexBuffer[2*e[n+2]+1]];let o=1/0,a=1/0,s=-1/0,l=-1/0;for(let e=0;e<3;e++){const t=i[2*e],r=i[2*e+1];o=Math.min(o,t),s=Math.max(s,t),a=Math.min(a,r),l=Math.max(l,r)}if(o===s||a===l)continue;const c=Math.floor(o/this._granularityCellSize),u=Math.ceil(s/this._granularityCellSize),h=Math.floor(a/this._granularityCellSize),d=Math.ceil(l/this._granularityCellSize);if(c!==u||h!==d)for(let e=h;e<d;e++){const n=this._scanlineGenerateVertexRingForCellRow(e,i,r);_c(this._vertexBuffer,n,t)}else t.push(...r)}return t}_scanlineGenerateVertexRingForCellRow(e,t,r){const n=e*this._granularityCellSize,i=n+this._granularityCellSize,o=[];for(let a=0;a<3;a++){const e=t[2*a],s=t[2*a+1],l=t[2*(a+1)%6],c=t[(2*(a+1)+1)%6],u=t[2*(a+2)%6],h=t[(2*(a+2)+1)%6],d=l-e,p=c-s,f=0===d,m=0===p,g=(n-s)/p,y=(i-s)/p,_=Math.min(g,y),v=Math.max(g,y);if(!m&&(_>=1||v<=0)||m&&(s<n||s>i)){c>=n&&c<=i&&o.push(r[(a+1)%3]);continue}!m&&_>0&&o.push(this._vertexToIndex(e+d*_,s+p*_));const b=e+d*Math.max(_,0),w=e+d*Math.min(v,1);f||this._generateIntraEdgeVertices(o,e,s,l,c,b,w),!m&&v<1&&o.push(this._vertexToIndex(e+d*v,s+p*v)),(m||c>=n&&c<=i)&&o.push(r[(a+1)%3]),!m&&(c<=n||c>=i)&&this._generateInterEdgeVertices(o,e,s,l,c,u,h,w,n,i)}return o}_generateIntraEdgeVertices(e,t,r,n,i,o,a){const s=n-t,l=i-r,c=0===l,u=c?Math.min(t,n):Math.min(o,a),h=c?Math.max(t,n):Math.max(o,a),d=Math.floor(u/this._granularityCellSize)+1,p=Math.ceil(h/this._granularityCellSize)-1;if(c?t<n:o<a)for(let f=d;f<=p;f++){const n=f*this._granularityCellSize;e.push(this._vertexToIndex(n,r+l*(n-t)/s))}else for(let f=p;f>=d;f--){const n=f*this._granularityCellSize;e.push(this._vertexToIndex(n,r+l*(n-t)/s))}}_generateInterEdgeVertices(e,t,r,n,i,o,a,s,l,c){const u=i-r,h=o-n,d=a-i,p=(l-i)/d,f=(c-i)/d,m=Math.min(p,f),g=Math.max(p,f),y=n+h*m;let _=Math.floor(Math.min(y,s)/this._granularityCellSize)+1,v=Math.ceil(Math.max(y,s)/this._granularityCellSize)-1,b=s<y;const w=0===d;if(w&&(a===l||a===c))return;if(w||m>=1||g<=0){const e=r-a,n=o+(t-o)*Math.min((l-a)/e,(c-a)/e);_=Math.floor(Math.min(n,s)/this._granularityCellSize)+1,v=Math.ceil(Math.max(n,s)/this._granularityCellSize)-1,b=s<n}const x=u>0?c:l;if(b)for(let S=_;S<=v;S++)e.push(this._vertexToIndex(S*this._granularityCellSize,x));else for(let S=v;S>=_;S--)e.push(this._vertexToIndex(S*this._granularityCellSize,x))}_generateOutline(e){const t=[];for(const r of e){const e=yc(r,this._granularity,!0),n=this._pointArrayToIndices(e),i=[];for(let t=1;t<n.length;t++)i.push(n[t-1]),i.push(n[t]);t.push(i)}return t}_handlePoles(e){let t=!1,r=!1;this._canonical&&(0===this._canonical.y&&(t=!0),this._canonical.y===(1<<this._canonical.z)-1&&(r=!0)),(t||r)&&this._fillPoles(e,t,r)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let t=0;t<e.length;t+=2){const r=e[t+1];r===pc&&(e[t+1]=-32767),r===fc&&(e[t+1]=32766)}}_generatePoleQuad(e,t,r,n,i,o){n>i!=(o===pc)?(e.push(t),e.push(r),e.push(this._vertexToIndex(n,o)),e.push(r),e.push(this._vertexToIndex(i,o)),e.push(this._vertexToIndex(n,o))):(e.push(r),e.push(t),e.push(this._vertexToIndex(n,o)),e.push(this._vertexToIndex(i,o)),e.push(r),e.push(this._vertexToIndex(n,o)))}_fillPoles(e,t,r){const n=this._vertexBuffer,i=k,o=e.length;for(let a=2;a<o;a+=3){const o=e[a-2],s=e[a-1],l=e[a],c=n[2*o],u=n[2*o+1],h=n[2*s],d=n[2*s+1],p=n[2*l],f=n[2*l+1];t&&(0===u&&0===d&&this._generatePoleQuad(e,o,s,c,h,pc),0===d&&0===f&&this._generatePoleQuad(e,s,l,h,p,pc),0===f&&0===u&&this._generatePoleQuad(e,l,o,p,c,pc)),r&&(u===i&&d===i&&this._generatePoleQuad(e,o,s,c,h,fc),d===i&&f===i&&this._generatePoleQuad(e,s,l,h,p,fc),f===i&&u===i&&this._generatePoleQuad(e,l,o,p,c,fc))}}_initializeVertices(e){for(let t=0;t<e.length;t+=2)this._vertexToIndex(e[t],e[t+1])}subdividePolygonInternal(e,t){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:r,holeIndices:n}=function(e){const t=[],r=[];for(const n of e)if(0!==n.length){n!==e[0]&&t.push(r.length/2);for(let e=0;e<n.length;e++)r.push(n[e].x),r.push(n[e].y)}return{flattened:r,holeIndices:t}}(e);let i;this._initializeVertices(r);try{const e=function(e,t,r=2){const n=t&&t.length,i=n?t[0]*r:e.length;let o=ql(e,0,i,r,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c;if(n&&(o=function(e,t,r,n){const i=[];for(let o=0,a=t.length;o<a;o++){const r=ql(e,t[o]*n,o<a-1?t[o+1]*n:e.length,n,!1);r===r.next&&(r.steiner=!0),i.push(Kl(r))}i.sort(Hl);for(let o=0;o<i.length;o++)r=Zl(i[o],r);return r}(e,t,o,r)),e.length>80*r){s=e[0],l=e[1];let t=s,n=l;for(let o=r;o<i;o+=r){const r=e[o],i=e[o+1];r<s&&(s=r),i<l&&(l=i),r>t&&(t=r),i>n&&(n=i)}c=Math.max(t-s,n-l),c=0!==c?32767/c:0}return jl(o,a,r,s,l,c,0),a}(r,n),t=this._convertIndices(r,e);i=this._subdivideTrianglesScanline(t)}catch(a){}let o=[];return t&&(o=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(i),{verticesFlattened:this._vertexBuffer,indicesTriangles:i,indicesLineList:o}}_convertIndices(e,t){const r=[];for(let n=0;n<t.length;n++)r.push(this._vertexToIndex(e[2*t[n]],e[2*t[n]+1]));return r}_pointArrayToIndices(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];t.push(this._vertexToIndex(n.x,n.y))}return t}}function gc(e,t,r,n=!0){return new mc(r,t).subdividePolygonInternal(e,n)}function yc(e,t,n=!1){if(!e||e.length<1)return[];if(e.length<2)return[];const i=e[0],o=e[e.length-1],a=n&&(i.x!==o.x||i.y!==o.y);if(t<2)return a?[...e,e[0]]:[...e];const s=Math.floor(k/t),l=[];l.push(new r(e[0].x,e[0].y));const c=e.length,u=a?c:c-1;for(let h=0;h<u;h++){const t=e[h],n=h<c-1?e[h+1]:e[0],i=t.x,o=t.y,a=n.x,u=n.y,d=i!==a,p=o!==u;if(!d&&!p)continue;const f=a-i,m=u-o,g=Math.abs(f),y=Math.abs(m);let _=i,v=o;for(;;){const e=f>0?(Math.floor(_/s)+1)*s:(Math.ceil(_/s)-1)*s,t=m>0?(Math.floor(v/s)+1)*s:(Math.ceil(v/s)-1)*s,n=Math.abs(_-e),i=Math.abs(v-t),o=Math.abs(_-a),c=Math.abs(v-u),h=d?n/g:Number.POSITIVE_INFINITY,b=p?i/y:Number.POSITIVE_INFINITY;if((o<=n||!d)&&(c<=i||!p))break;if(h<b&&d||!p){_=e,v+=m*h;const t=new r(_,Math.round(v));l[l.length-1].x===t.x&&l[l.length-1].y===t.y||l.push(t)}else{_+=f*b,v=t;const e=new r(Math.round(_),v);l[l.length-1].x===e.x&&l[l.length-1].y===e.y||l.push(e)}}const b=new r(a,u);l[l.length-1].x===b.x&&l[l.length-1].y===b.y||l.push(b)}return l}function _c(e,t,r){if(0===t.length)throw new Error("Subdivision vertex ring is empty.");let n=0,i=e[2*t[0]];for(let l=1;l<t.length;l++){const r=e[2*t[l]];r<i&&(i=r,n=l)}const o=t.length;let a=n,s=(a+1)%o;for(;;){const n=a-1>=0?a-1:o-1,i=(s+1)%o,l=e[2*t[n]],c=e[2*t[i]],u=e[2*t[a]],h=e[2*t[a]+1],d=e[2*t[s]+1];let p=!1;if(l<c)p=!0;else if(l>c)p=!1;else{const r=d-h,o=-(e[2*t[s]]-u),a=h<d?1:-1;((l-u)*r+(e[2*t[n]+1]-h)*o)*a>((c-u)*r+(e[2*t[i]+1]-h)*o)*a&&(p=!0)}if(p){const e=t[n],i=t[a],l=t[s];e!==i&&e!==l&&i!==l&&r.push(l,i,e),a--,a<0&&(a=o-1)}else{const e=t[i],n=t[a],l=t[s];e!==n&&e!==l&&n!==l&&r.push(l,n,e),s++,s>=o&&(s=0)}if(n===i)break}}function vc(e,t,r,n,i,o,a,s,l){const c=i.length/2,u=a&&s&&l;if(c<os.MAX_VERTEX_ARRAY_LENGTH){const h=t.prepareSegment(c,r,n),d=h.vertexLength;for(let e=0;e<o.length;e+=3)n.emplaceBack(d+o[e],d+o[e+1],d+o[e+2]);let p,f;h.vertexLength+=c,h.primitiveLength+=o.length/3,u&&(f=a.prepareSegment(c,r,s),p=f.vertexLength,f.vertexLength+=c);for(let t=0;t<i.length;t+=2)e(i[t],i[t+1]);if(u)for(let e=0;e<l.length;e++){const t=l[e];for(let e=1;e<t.length;e+=2)s.emplaceBack(p+t[e-1],p+t[e]);f.primitiveLength+=t.length/2}}else!function(e,t,r,n,i,o){const a=[];for(let h=0;h<n.length/2;h++)a.push(-1);const s={count:0};let l=0,c=e.getOrCreateLatestSegment(t,r),u=c.vertexLength;for(let h=2;h<i.length;h+=3){const d=i[h-2],p=i[h-1],f=i[h];let m=a[d]<l,g=a[p]<l,y=a[f]<l;c.vertexLength+((m?1:0)+(g?1:0)+(y?1:0))>os.MAX_VERTEX_ARRAY_LENGTH&&(c=e.createNewSegment(t,r),l=s.count,m=!0,g=!0,y=!0,u=0);const _=bc(a,n,o,s,d,m,c),v=bc(a,n,o,s,p,g,c),b=bc(a,n,o,s,f,y,c);r.emplaceBack(u+_-l,u+v-l,u+b-l),c.primitiveLength++}}(t,r,n,i,o,e),u&&function(e,t,r,n,i,o){const a=[];for(let h=0;h<n.length/2;h++)a.push(-1);const s={count:0};let l=0,c=e.getOrCreateLatestSegment(t,r),u=c.vertexLength;for(let h=0;h<i.length;h++){const d=i[h];for(let p=1;p<i[h].length;p+=2){const i=d[p-1],h=d[p];let f=a[i]<l,m=a[h]<l;c.vertexLength+((f?1:0)+(m?1:0))>os.MAX_VERTEX_ARRAY_LENGTH&&(c=e.createNewSegment(t,r),l=s.count,f=!0,m=!0,u=0);const g=bc(a,n,o,s,i,f,c),y=bc(a,n,o,s,h,m,c);r.emplaceBack(u+g-l,u+y-l),c.primitiveLength++}}}(a,r,s,i,l,e),t.forceNewSegmentOnNextPrepare(),null==a||a.forceNewSegmentOnNextPrepare()}function bc(e,t,r,n,i,o,a){if(o){const o=n.count;return r(t[2*i],t[2*i+1]),e[i]=n.count,n.count++,a.vertexLength++,o}return e[i]}class wc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Va,this.indexArray=new ts,this.indexArray2=new rs,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new os,this.segments2=new os,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasDependencies=zl("fill",this.layers,t);const n=this.layers[0].layout.get("fill-sort-key"),i=!n.isConstant(),o=[];for(const{feature:a,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=Ns(a,e);if(!this.layers[0]._featureFilter.filter(new Oo(this.zoom),u,r))continue;const h=i?n.evaluate(u,{},r,t.availableImages):void 0,d={id:s,properties:a.properties,type:a.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:qs(a),patterns:{},sortKey:h};o.push(d)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const a of o){const{geometry:n,index:i,sourceLayerIndex:o}=a;if(this.hasDependencies){const e=Fl("fill",this.layers,a,{zoom:this.zoom},t);this.patternFeatures.push(e)}else this.addFeature(a,n,i,r,{},t.subdivisionGranularity);t.featureIndex.insert(e[i].feature,n,i,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$l),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i,o){for(const a of en(t,500)){const e=gc(a,n,o.fill.getGranularityForZoomLevel(n.z)),t=this.layoutVertexArray;vc(((e,r)=>{t.emplaceBack(e,r)}),this.segments,this.layoutVertexArray,this.indexArray,e.verticesFlattened,e.indicesTriangles,this.segments2,this.indexArray2,e.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,canonical:n})}}let xc,Sc;po("FillBucket",wc,{omit:["layers","patternFeatures"]});var Ec={get paint(){return Sc=Sc||new Xo({"fill-antialias":new Go(ve.paint_fill["fill-antialias"]),"fill-opacity":new Wo(ve.paint_fill["fill-opacity"]),"fill-color":new Wo(ve.paint_fill["fill-color"]),"fill-outline-color":new Wo(ve.paint_fill["fill-outline-color"]),"fill-translate":new Go(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new Go(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ho(ve.paint_fill["fill-pattern"])})},get layout(){return xc=xc||new Xo({"fill-sort-key":new Wo(ve.layout_fill["fill-sort-key"])})}};class Tc extends Ko{constructor(e,t){super(e,Ec,t)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new wc(e)}queryRadius(){return nl(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:t,transform:r,pixelsToTileUnits:n}){return Hs(il(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-r.bearingInRadians,n),t)}isTileClipped(){return!0}}const Ac=ia([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Cc=ia([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ic}=Ac;class kc{constructor(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(Pc,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos,n=[];let i,o=1,a=0,s=0,l=0;for(;e.pos<t;){if(a<=0){const t=e.readVarint();o=7&t,a=t>>3}if(a--,1===o||2===o)s+=e.readSVarint(),l+=e.readSVarint(),1===o&&(i&&n.push(i),i=[]),i&&i.push(new r(s,l));else{if(7!==o)throw new Error(`unknown command ${o}`);i&&i.push(i[0].clone())}}return i&&n.push(i),n}bbox(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,c=-1/0;for(;e.pos<t;){if(n<=0){const t=e.readVarint();r=7&t,n=t>>3}if(n--,1===r||2===r)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>c&&(c=o);else if(7!==r)throw new Error(`unknown command ${r}`)}return[a,l,s,c]}toGeoJSON(e,t,r){const n=this.extent*Math.pow(2,r),i=this.extent*e,o=this.extent*t,a=this.loadGeometry();function s(e){return[360*(e.x+i)/n-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+o)/n)*Math.PI))-90]}function l(e){return e.map(s)}let c;if(1===this.type){const e=[];for(const r of a)e.push(r[0]);const t=l(e);c=1===e.length?{type:"Point",coordinates:t[0]}:{type:"MultiPoint",coordinates:t}}else if(2===this.type){const e=a.map(l);c=1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}}else{if(3!==this.type)throw new Error("unknown feature type");{const e=Mc(a),t=[];for(const r of e)t.push(r.map(l));c=1===t.length?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}}}const u={type:"Feature",geometry:c,properties:this.properties};return null!=this.id&&(u.id=this.id),u}}function Pc(e,t,r){1===e?t.id=r.readVarint():2===e?function(e,t){const r=e.readVarint()+e.pos;for(;e.pos<r;){const r=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[r]=n}}(r,t):3===e?t.type=r.readVarint():4===e&&(t._geometry=r.pos)}function Mc(e){const t=e.length;if(t<=1)return[e];const r=[];let n,i;for(let o=0;o<t;o++){const t=Rc(e[o]);0!==t&&(void 0===i&&(i=t<0),i===t<0?(n&&r.push(n),n=[e[o]]):n&&n.push(e[o]))}return n&&r.push(n),r}function Rc(e){let t=0;for(let r,n,i=0,o=e.length,a=o-1;i<o;a=i++)r=e[i],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}kc.types=["Unknown","Point","LineString","Polygon"];class Dc{constructor(e,t){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Oc,this,t),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const t=this._pbf.readVarint()+this._pbf.pos;return new kc(this._pbf,t,this.extent,this._keys,this._values)}}function Oc(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){let t=null;const r=e.readVarint()+e.pos;for(;e.pos<r;){const r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}if(null==t)throw new Error("unknown feature value");return t}(r))}class Lc{constructor(e,t){this.layers=e.readFields(Bc,{},t)}}function Bc(e,t,r){if(3===e){const e=new Dc(r,r.readVarint()+r.pos);e.length&&(t[e.name]=e)}}const $c=Math.pow(2,13);function zc(e,t,r,n,i,o,a,s){e.emplaceBack(t,r,2*Math.floor(n*$c)+a,i*$c*2,o*$c*2,Math.round(s))}class Fc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new Ga,this.centroidVertexArray=new ja,this.indexArray=new ts,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new os,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.features=[],this.hasDependencies=zl("fill-extrusion",this.layers,t);for(const{feature:n,id:i,index:o,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,s=Ns(n,e);if(!this.layers[0]._featureFilter.filter(new Oo(this.zoom),s,r))continue;const l={id:i,sourceLayerIndex:a,index:o,geometry:e?s.geometry:qs(n),properties:n.properties,type:n.type,patterns:{}};this.hasDependencies?this.features.push(Fl("fill-extrusion",this.layers,l,{zoom:this.zoom},t)):this.addFeature(l,l.geometry,o,r,{},t.subdivisionGranularity),t.featureIndex.insert(n,l.geometry,o,a,this.index,!0)}}addFeatures(e,t,r){for(const n of this.features){const{geometry:i}=n;this.addFeature(n,i,n.index,t,r,e.subdivisionGranularity)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r})}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ic),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Cc.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,i,o){for(const a of en(t,500)){const t={x:0,y:0,sampleCount:0},r=this.layoutVertexArray.length;this.processPolygon(t,n,e,a,o);const i=this.layoutVertexArray.length-r,s=Math.floor(t.x/t.sampleCount),l=Math.floor(t.y/t.sampleCount);for(let e=0;e<i;e++)this.centroidVertexArray.emplaceBack(s,l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,canonical:n})}processPolygon(e,t,r,n,i){if(n.length<1)return;if(jc(n[0]))return;for(const u of n)0!==u.length&&qc(e,u);const o={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},a=i.fill.getGranularityForZoomLevel(t.z),s="Polygon"===kc.types[r.type];for(const u of n){if(0===u.length)continue;if(jc(u))continue;const e=yc(u,a,s);this._generateSideFaces(e,o)}if(!s)return;const l=gc(n,t,a,!1),c=this.layoutVertexArray;vc(((e,t)=>{zc(c,e,t,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,l.verticesFlattened,l.indicesTriangles)}_generateSideFaces(e,t){let r=0;for(let n=1;n<e.length;n++){const i=e[n],o=e[n-1];if(Nc(i,o))continue;t.segment.vertexLength+4>os.MAX_VERTEX_ARRAY_LENGTH&&(t.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const a=i.sub(o)._perp()._unit(),s=o.dist(i);r+s>32768&&(r=0),zc(this.layoutVertexArray,i.x,i.y,a.x,a.y,0,0,r),zc(this.layoutVertexArray,i.x,i.y,a.x,a.y,0,1,r),r+=s,zc(this.layoutVertexArray,o.x,o.y,a.x,a.y,0,0,r),zc(this.layoutVertexArray,o.x,o.y,a.x,a.y,0,1,r);const l=t.segment.vertexLength;this.indexArray.emplaceBack(l,l+2,l+1),this.indexArray.emplaceBack(l+1,l+2,l+3),t.segment.vertexLength+=4,t.segment.primitiveLength+=2}}}function qc(e,t){for(let r=0;r<t.length;r++){const n=t[r];r===t.length-1&&t[0].x===n.x&&t[0].y===n.y||(e.x+=n.x,e.y+=n.y,e.sampleCount++)}}function Nc(e,t){return e.x===t.x&&(e.x<0||e.x>k)||e.y===t.y&&(e.y<0||e.y>k)}function jc(e){return e.every((e=>e.x<0))||e.every((e=>e.x>k))||e.every((e=>e.y<0))||e.every((e=>e.y>k))}let Uc;po("FillExtrusionBucket",Fc,{omit:["layers","features"]});var Vc={get paint(){return Uc=Uc||new Xo({"fill-extrusion-opacity":new Go(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wo(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Go(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Go(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ho(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wo(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wo(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Go(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Gc extends Ko{constructor(e,t){super(e,Vc,t)}createBucket(e){return new Fc(e)}queryRadius(){return nl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:n,geometry:i,transform:o,pixelsToTileUnits:a,pixelPosMatrix:s}){const l=il(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-o.bearingInRadians,a),c=this.paint.get("fill-extrusion-height").evaluate(t,n),u=this.paint.get("fill-extrusion-base").evaluate(t,n),h=function(e,t){const n=[];for(const i of e){const e=[i.x,i.y,0,1];E(e,e,t),n.push(new r(e[0]/e[3],e[1]/e[3]))}return n}(l,s),d=function(e,t,n,i){const o=[],a=[],s=i[8]*t,l=i[9]*t,c=i[10]*t,u=i[11]*t,h=i[8]*n,d=i[9]*n,p=i[10]*n,f=i[11]*n;for(const m of e){const e=[],t=[];for(const n of m){const o=n.x,a=n.y,m=i[0]*o+i[4]*a+i[12],g=i[1]*o+i[5]*a+i[13],y=i[2]*o+i[6]*a+i[14],_=i[3]*o+i[7]*a+i[15],v=y+c,b=_+u,w=m+h,x=g+d,S=y+p,E=_+f,T=new r((m+s)/b,(g+l)/b);T.z=v/b,e.push(T);const A=new r(w/E,x/E);A.z=S/E,t.push(A)}o.push(e),a.push(t)}return[o,a]}(i,u,c,s);return function(e,t,r){let n=1/0;Hs(r,t)&&(n=Hc(r,t[0]));for(let i=0;i<t.length;i++){const o=t[i],a=e[i];for(let e=0;e<o.length-1;e++){const t=o[e],i=[t,o[e+1],a[e+1],a[e],t];Gs(r,i)&&(n=Math.min(n,Hc(r,i)))}}return n!==1/0&&n}(d[0],d[1],h)}}function Wc(e,t){return e.x*t.x+e.y*t.y}function Hc(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const o=t[r],a=e[0],s=i.sub(n),l=o.sub(n),c=a.sub(n),u=Wc(s,s),h=Wc(s,l),d=Wc(l,l),p=Wc(c,s),f=Wc(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,_=n.z*(1-g-y)+i.z*g+o.z*y;if(isFinite(_))return _}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const Zc=ia([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Yc}=Zc,Xc=ia([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Kc}=Xc,Qc=Math.cos(Math.PI/180*37.5),Jc=Math.pow(2,14)/.5;class eu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Wa,this.layoutVertexArray2=new Ha,this.indexArray=new ts,this.programConfigurations=new Ls(e.layers,e.zoom),this.segments=new os,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasDependencies=zl("line",this.layers,t)||this.hasLineDasharray(this.layers);const n=this.layers[0].layout.get("line-sort-key"),i=!n.isConstant(),o=[];for(const{feature:a,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Ns(a,e);if(!this.layers[0]._featureFilter.filter(new Oo(this.zoom),t,r))continue;const u=i?n.evaluate(t,{},r):void 0,h={id:s,properties:a.properties,type:a.type,sourceLayerIndex:c,index:l,geometry:e?t.geometry:qs(a),patterns:{},dashes:{},sortKey:u};o.push(h)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const a of o){const{geometry:n,index:i,sourceLayerIndex:o}=a;this.hasDependencies?(zl("line",this.layers,t)?Fl("line",this.layers,a,{zoom:this.zoom},t):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,a,this.zoom,t),this.patternFeatures.push(a)):this.addFeature(a,n,i,r,{},{},t.subdivisionGranularity),t.featureIndex.insert(e[i].feature,n,i,o,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,{imagePositions:r,dashPositions:n})}addFeatures(e,t,r,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,t,r,n,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Kc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yc),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i,o,a){const s=this.layers[0].layout,l=s.get("line-join").evaluate(e,{}),c=s.get("line-cap"),u=s.get("line-miter-limit"),h=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const d of t)this.addLine(d,e,l,c,u,h,n,a);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{imagePositions:i,dashPositions:o,canonical:n})}addLine(e,t,r,n,i,o,a,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=yc(e,a?s.line.getGranularityForZoomLevel(a.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===kc.types[t.type];let c=e.length;for(;c>=2&&e[c-1].equals(e[c-2]);)c--;let u=0;for(;u<c-1&&e[u].equals(e[u+1]);)u++;if(c<(l?3:2))return;"bevel"===r&&(i=1.05);const h=this.overscaling<=16?122880/(512*this.overscaling):0,d=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);let p,f,m,g,y;this.e1=this.e2=-1,l&&(p=e[c-2],y=e[u].sub(p)._unit()._perp());for(let _=u;_<c;_++){if(m=_===c-1?l?e[u+1]:void 0:e[_+1],m&&e[_].equals(m))continue;y&&(g=y),p&&(f=p),p=e[_],y=m?m.sub(p)._unit()._perp():g,g=g||y;let t=g.add(y);0===t.x&&0===t.y||t._unit();const a=g.x*y.x+g.y*y.y,s=t.x*y.x+t.y*y.y,v=0!==s?1/s:1/0,b=2*Math.sqrt(2-2*s),w=s<Qc&&f&&m,x=g.x*y.y-g.y*y.x>0;if(w&&_>u){const e=p.dist(f);if(e>2*h){const t=p.sub(p.sub(f)._mult(h/e)._round());this.updateDistance(f,t),this.addCurrentVertex(t,g,0,0,d),f=t}}const S=f&&m;let E=S?r:l?"butt":n;if(S&&"round"===E&&(v<o?E="miter":v<=2&&(E="fakeround")),"miter"===E&&v>i&&(E="bevel"),"bevel"===E&&(v>2&&(E="flipbevel"),v<i&&(E="miter")),f&&this.updateDistance(f,p),"miter"===E)t._mult(v),this.addCurrentVertex(p,t,0,0,d);else if("flipbevel"===E){if(v>100)t=y.mult(-1);else{const e=v*g.add(y).mag()/g.sub(y).mag();t._perp()._mult(e*(x?-1:1))}this.addCurrentVertex(p,t,0,0,d),this.addCurrentVertex(p,t.mult(-1),0,0,d)}else if("bevel"===E||"fakeround"===E){const e=-Math.sqrt(v*v-1),t=x?e:0,r=x?0:e;if(f&&this.addCurrentVertex(p,g,t,r,d),"fakeround"===E){const e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+a*(a*(3.55645-1.43519*a)-3.2452))*e*e+(.848013+a*(.215638*a-1.06021)))}const n=y.sub(g)._mult(r)._add(g)._unit()._mult(x?-1:1);this.addHalfVertex(p,n.x,n.y,!1,x,0,d)}}m&&this.addCurrentVertex(p,y,-t,-r,d)}else if("butt"===E)this.addCurrentVertex(p,t,0,0,d);else if("square"===E){const e=f?1:-1;this.addCurrentVertex(p,t,e,e,d)}else"round"===E&&(f&&(this.addCurrentVertex(p,g,0,0,d),this.addCurrentVertex(p,g,1,1,d,!0)),m&&(this.addCurrentVertex(p,y,-1,-1,d,!0),this.addCurrentVertex(p,y,0,0,d)));if(w&&_<c-1){const e=p.dist(m);if(e>2*h){const t=p.add(m.sub(p)._mult(h/e)._round());this.updateDistance(p,t),this.addCurrentVertex(t,y,0,0,d),p=t}}}}addCurrentVertex(e,t,r,n,i,o=!1){const a=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,o,!1,r,i),this.addHalfVertex(e,a,s,o,!0,-n,i),this.distance>Jc/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,i,o))}addHalfVertex({x:e,y:t},r,n,i,o,a,s){const l=.5*(this.lineClips?this.scaledDistance*(Jc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(o?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,c,this.e2),s.primitiveLength++),o?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}hasLineDasharray(e){for(const t of e){const e=t.paint.get("line-dasharray");if(e&&!e.isConstant())return!0}return!1}addLineDashDependencies(e,t,r,n){for(const i of e){const e=i.paint.get("line-dasharray");if(!e||"constant"===e.value.kind)continue;const o="round"===i.layout.get("line-cap"),a={dasharray:e.value.evaluate({zoom:r-1},t,{}),round:o},s={dasharray:e.value.evaluate({zoom:r},t,{}),round:o},l={dasharray:e.value.evaluate({zoom:r+1},t,{}),round:o},c=`${a.dasharray.join(",")},${a.round}`,u=`${s.dasharray.join(",")},${s.round}`,h=`${l.dasharray.join(",")},${l.round}`;n.dashDependencies[c]=a,n.dashDependencies[u]=s,n.dashDependencies[h]=l,t.dashes[i.id]={min:c,mid:u,max:h}}}}let tu,ru;po("LineBucket",eu,{omit:["layers","patternFeatures"]});var nu={get paint(){return ru=ru||new Xo({"line-opacity":new Wo(ve.paint_line["line-opacity"]),"line-color":new Wo(ve.paint_line["line-color"]),"line-translate":new Go(ve.paint_line["line-translate"]),"line-translate-anchor":new Go(ve.paint_line["line-translate-anchor"]),"line-width":new Wo(ve.paint_line["line-width"]),"line-gap-width":new Wo(ve.paint_line["line-gap-width"]),"line-offset":new Wo(ve.paint_line["line-offset"]),"line-blur":new Wo(ve.paint_line["line-blur"]),"line-dasharray":new Ho(ve.paint_line["line-dasharray"]),"line-pattern":new Ho(ve.paint_line["line-pattern"]),"line-gradient":new Yo(ve.paint_line["line-gradient"])})},get layout(){return tu=tu||new Xo({"line-cap":new Go(ve.layout_line["line-cap"]),"line-join":new Wo(ve.layout_line["line-join"]),"line-miter-limit":new Go(ve.layout_line["line-miter-limit"]),"line-round-limit":new Go(ve.layout_line["line-round-limit"]),"line-sort-key":new Wo(ve.layout_line["line-sort-key"])})}};class iu extends Wo{possiblyEvaluate(e,t){return t=new Oo(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=z({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}let ou;class au extends Ko{constructor(e,t){super(e,nu,t),this.gradientVersion=0,ou||(ou=new iu(nu.paint.properties["line-width"].specification),ou.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!(void 0===e._styleExpression)&&e._styleExpression.expression instanceof sr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=ou.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new eu(e)}queryRadius(e){const t=e,r=su(rl("line-width",this,t),rl("line-gap-width",this,t)),n=rl("line-offset",this,t);return r/2+Math.abs(n)+nl(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:n,geometry:i,transform:o,pixelsToTileUnits:a}){const s=il(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-o.bearingInRadians,a),l=a/2*su(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),c=this.paint.get("line-offset").evaluate(t,n);return c&&(i=function(e,t){const n=[];for(let i=0;i<e.length;i++){const o=ol(e[i]),a=[];for(let e=0;e<o.length;e++){const n=o[e],i=o[e-1],s=o[e+1],l=0===e?new r(0,0):n.sub(i)._unit()._perp(),c=e===o.length-1?new r(0,0):s.sub(n)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),a.push(u._mult(t)._add(n))}n.push(a)}return n}(i,c*a)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(el(e,i[t]))return!0;if(Zs(e,i,r))return!0}return!1}(s,i,l)}isTileClipped(){return!0}}function su(e,t){return t>0?t+2*e:e}const lu=ia([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cu=ia([{name:"a_projected_pos",components:3,type:"Float32"}],4);ia([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uu=ia([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ia([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hu=ia([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),du=ia([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function pu(e,t,r){return e.sections.forEach((e=>{e.text=function(e,t,r){const n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Do.applyArabicShaping&&(e=Do.applyArabicShaping(e)),e}(e.text,t,r)})),e}ia([{name:"triangle",components:3,type:"Uint16"}]),ia([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ia([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ia([{type:"Float32",name:"offsetX"}]),ia([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ia([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var fu=24;const mu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},gu={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},yu={40:!0};function _u(e,t,r,n,i,o){if("fontStack"in t){const n=r[t.fontStack],o=n&&n[e];return o?o.metrics.advance*t.scale+i:0}{const e=n[t.imageName];return e?e.displaySize[0]*t.scale*fu/o+i:0}}function vu(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function bu(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function wu(e,t,r,n,i,o){let a=null,s=vu(t,r,i,o);for(const l of n){const e=vu(t-l.x,r,i,o)+l.badness;e<=s&&(a=l,s=e)}return{index:e,x:t,priorBreak:a,badness:s}}function xu(e){return e?xu(e.priorBreak).concat(e.index):[]}class Su{constructor(e="",t=[],r=[]){this.text=e,this.sections=t,this.sectionIndex=r,this.imageSectionID=null}static fromFeature(e,t){const r=new Su;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=function(e){let t="",r={premature:!0,value:void 0};const n=e[Symbol.iterator]();let i=n.next();const o=e[Symbol.iterator]();o.next();let a=o.next();for(;!i.done;)t+=!a.done&&Io(a.value.codePointAt(0))&&!mu[a.value]||!r.premature&&Io(r.value.codePointAt(0))&&!mu[r.value]||!mu[i.value]?i.value:mu[i.value],r={value:i.value,premature:!1},i=n.next(),a=o.next();return t}(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),t=e?e[0].length:0,r=this.text.match(/\S\s*$/),n=r?r[0].length-1:0;this.text=this.text.substring(t,this.text.length-n),this.sectionIndex=this.sectionIndex.slice(t,this.sectionIndex.length-n)}substring(e,t){const r=[...this.text].slice(e,t).join(""),n=this.sectionIndex.slice(e,t);return new Su(r,this.sections,n)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}getMaxImageSize(e){let t=0,r=0;for(let n=0;n<this.length();n++){const i=this.getSection(n);if("imageName"in i){const n=e[i.imageName];if(!n)continue;const o=n.displaySize;t=Math.max(t,o[0]),r=Math.max(r,o[1])}}return{maxImageWidth:t,maxImageHeight:r}}addTextSection(e,t){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||t});const r=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>r)))}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void V("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:t}),this.sectionIndex.push(this.sections.length-1)):V("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,t,r,n,i){const o=[],a=this.determineAverageLineWidth(e,t,r,n,i),s=this.hasZeroWidthSpaces();let l=0,c=0;const u=this.text[Symbol.iterator]();let h=u.next();const d=this.text[Symbol.iterator]();d.next();let p=d.next();const f=this.text[Symbol.iterator]();f.next(),f.next();let m=f.next();for(;!h.done;){const t=this.getSection(c),g=h.value.codePointAt(0);if(xo(g)||(l+=_u(g,t,r,n,e,i)),!p.done){const e=bo(g),r=p.value.codePointAt(0);(gu[g]||e||"imageName"in t||!m.done&&yu[r])&&o.push(wu(c+1,l,a,o,bu(g,r,e&&s),!1))}c++,h=u.next(),p=d.next(),m=f.next()}return xu(wu(this.length(),l,a,o,0,!0))}determineAverageLineWidth(e,t,r,n,i){let o=0,a=0;for(const s of this.text){const t=this.getSection(a);o+=_u(s.codePointAt(0),t,r,n,e,i),a++}return o/Math.max(1,Math.ceil(o/t))}}const Eu=4294967296,Tu=1/Eu,Au="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class Cu{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,r=this.length){for(;this.pos<r;){const r=this.readVarint(),n=r>>3,i=this.pos;this.type=7&r,e(n,t,this),this.pos===i&&this.skip(r)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Eu;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Eu;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let r,n;return n=t[this.pos++],r=127&n,n<128?r:(n=t[this.pos++],r|=(127&n)<<7,n<128?r:(n=t[this.pos++],r|=(127&n)<<14,n<128?r:(n=t[this.pos++],r|=(127&n)<<21,n<128?r:(n=t[this.pos],r|=(15&n)<<28,function(e,t,r){const n=r.buf;let i,o;if(o=n[r.pos++],i=(112&o)>>4,o<128)return Iu(e,i,t);if(o=n[r.pos++],i|=(127&o)<<3,o<128)return Iu(e,i,t);if(o=n[r.pos++],i|=(127&o)<<10,o<128)return Iu(e,i,t);if(o=n[r.pos++],i|=(127&o)<<17,o<128)return Iu(e,i,t);if(o=n[r.pos++],i|=(127&o)<<24,o<128)return Iu(e,i,t);if(o=n[r.pos++],i|=(1&o)<<31,o<128)return Iu(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(r,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return Boolean(this.readVarint())}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Au?Au.decode(this.buf.subarray(t,e)):function(e,t,r){let n="",i=t;for(;i<r;){const t=e[i];let o,a,s,l=null,c=t>239?4:t>223?3:t>191?2:1;if(i+c>r)break;1===c?t<128&&(l=t):2===c?(o=e[i+1],128==(192&o)&&(l=(31&t)<<6|63&o,l<=127&&(l=null))):3===c?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&t)<<12|(63&o)<<6|63&a,(l<=2047||l>=55296&&l<=57343)&&(l=null))):4===c&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&t)<<18|(63&o)<<12|(63&a)<<6|63&s,(l<=65535||l>=1114112)&&(l=null))),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(e){const t=7&e;if(0===t)for(;this.buf[this.pos++]>127;);else if(2===t)this.pos=this.readVarint()+this.pos;else if(5===t)this.pos+=4;else{if(1!==t)throw new Error(`Unimplemented type: ${t}`);this.pos+=8}}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const e=new Uint8Array(t);e.set(this.buf),this.buf=e,this.dataView=new DataView(e.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Tu),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Tu),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?function(e,t){let r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),4294967295^r?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");var i,o;t.realloc(10),i=r,(o=t).buf[o.pos++]=127&i|128,i>>>=7,o.buf[o.pos++]=127&i|128,i>>>=7,o.buf[o.pos++]=127&i|128,i>>>=7,o.buf[o.pos++]=127&i|128,o.buf[o.pos]=127&(i>>>=7),function(e,t){const r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const t=this.pos;this.pos=function(e,t,r){for(let n,i,o=0;o<t.length;o++){if(n=t.charCodeAt(o),n>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);const r=this.pos-t;r>=128&&ku(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let r=0;r<t;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,t){this.pos++;const r=this.pos;e(t,this);const n=this.pos-r;n>=128&&ku(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n}writeMessage(e,t,r){this.writeTag(e,2),this.writeRawMessage(t,r)}writePackedVarint(e,t){t.length&&this.writeMessage(e,Pu,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,Mu,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,Ou,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,Ru,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,Du,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,Lu,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,Bu,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,$u,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,zu,t)}writeBytesField(e,t){this.writeTag(e,2),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,5),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,5),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,1),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,1),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,0),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,0),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,2),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,5),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,1),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function Iu(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ku(e,t,r){const n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(let i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function Pu(e,t){for(let r=0;r<e.length;r++)t.writeVarint(e[r])}function Mu(e,t){for(let r=0;r<e.length;r++)t.writeSVarint(e[r])}function Ru(e,t){for(let r=0;r<e.length;r++)t.writeFloat(e[r])}function Du(e,t){for(let r=0;r<e.length;r++)t.writeDouble(e[r])}function Ou(e,t){for(let r=0;r<e.length;r++)t.writeBoolean(e[r])}function Lu(e,t){for(let r=0;r<e.length;r++)t.writeFixed32(e[r])}function Bu(e,t){for(let r=0;r<e.length;r++)t.writeSFixed32(e[r])}function $u(e,t){for(let r=0;r<e.length;r++)t.writeFixed64(e[r])}function zu(e,t){for(let r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Fu(e,t,r){1===e&&r.readMessage(qu,t)}function qu(e,t,r){if(3===e){const{id:e,bitmap:n,width:i,height:o,left:a,top:s,advance:l}=r.readMessage(Nu,{});t.push({id:e,bitmap:new xl({width:i+6,height:o+6},n),metrics:{width:i,height:o,left:a,top:s,advance:l}})}}function Nu(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function ju(e){let t=0,r=0;for(const a of e)t+=a.w*a.h,r=Math.max(r,a.w);e.sort(((e,t)=>t.h-e.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,o=0;for(const a of e)for(let e=n.length-1;e>=0;e--){const t=n[e];if(!(a.w>t.w||a.h>t.h)){if(a.x=t.x,a.y=t.y,o=Math.max(o,a.y+a.h),i=Math.max(i,a.x+a.w),a.w===t.w&&a.h===t.h){const t=n.pop();t&&e<n.length&&(n[e]=t)}else a.h===t.h?(t.x+=a.w,t.w-=a.w):a.w===t.w?(t.y+=a.h,t.h-=a.h):(n.push({x:t.x+a.w,y:t.y,w:t.w-a.w,h:a.h}),t.y+=a.h,t.h-=a.h);break}}return{w:i,h:o,fill:t/(i*o)||0}}class Uu{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:o,textFitWidth:a,textFitHeight:s}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=o,this.version=r,this.textFitWidth=a,this.textFitHeight=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Vu{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:o,h:a}=ju(i),s=new Sl({width:o||1,height:a||1});for(const l in e){const t=e[l],n=r[l].paddedRect;Sl.copy(t.data,s,{x:0,y:0},{x:n.x+1,y:n.y+1},t.data)}for(const l in t){const e=t[l],r=n[l].paddedRect,i=r.x+1,o=r.y+1,a=e.data.width,c=e.data.height;Sl.copy(e.data,s,{x:0,y:0},{x:i,y:o},e.data),Sl.copy(e.data,s,{x:0,y:c-1},{x:i,y:o-1},{width:a,height:1}),Sl.copy(e.data,s,{x:0,y:0},{x:i,y:o+c},{width:a,height:1}),Sl.copy(e.data,s,{x:a-1,y:0},{x:i-1,y:o},{width:1,height:c}),Sl.copy(e.data,s,{x:0,y:0},{x:i+a,y:o},{width:1,height:c})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(o),t[n]=new Uu(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}var Gu;function Wu(t,r,n,i,o,a,s,l,c,u,h,d,p,f,m){const g=Su.fromFeature(t,o);let y;d===e.az.vertical&&g.verticalizePunctuation();let _=g.determineLineBreaks(u,a,r,i,f);const{processBidirectionalText:v,processStyledBidirectionalText:b}=Do;if(v&&1===g.sections.length){y=[],_=_.map((e=>g.toCodeUnitIndex(e)));const e=v(g.toString(),_);for(const t of e){const e=[...t].map((()=>0));y.push(new Su(t,g.sections,e))}}else if(b){y=[],_=_.map((e=>g.toCodeUnitIndex(e)));let e=0;const t=[];for(const n of g.text)t.push(...Array(n.length).fill(g.sectionIndex[e])),e++;const r=b(g.text,t,_);for(const n of r){const e=[];let t="";for(const r of n[0])e.push(n[1][t.length]),t+=r;y.push(new Su(n[0],g.sections,e))}}else y=function(e,t){const r=[];let n=0;for(const i of t)r.push(e.substring(n,i)),n=i;return n<e.length()&&r.push(e.substring(n,e.length())),r}(g,_);const w=[],x={positionedLines:w,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(e,t,r,n,i,o,a,s,l,c,u,h){let d=0,p=0,f=0,m=0;const g="right"===s?1:"left"===s?0:.5,y=fu/h;let _=0;for(const w of i){w.trim();const i=w.getMaxScale(),a={positionedGlyphs:[],lineOffset:0};e.positionedLines[_]=a;const s=a.positionedGlyphs;let h=0;if(!w.length()){p+=o,++_;continue}const v=Zu(n,w,y);let b=0;for(const o of w.text){const a=w.getSection(b),f=o.codePointAt(0),m=Xu(l,u,f),g={glyph:f,imageName:null,x:d,y:p+-17,vertical:m,scale:1,fontStack:"",sectionIndex:w.getSectionIndex(b),metrics:null,rect:null};let _;if("fontStack"in a){if(_=Ku(a,f,m,v,t,r),!_)continue;g.fontStack=a.fontStack}else{if(e.iconsInText=!0,a.scale*=y,_=Qu(a,m,i,v,n),!_)continue;h=Math.max(h,_.imageOffset),g.imageName=a.imageName}const{rect:x,metrics:S,baselineOffset:E}=_;g.y+=E,g.scale=a.scale,g.metrics=S,g.rect=x,s.push(g),m?(e.verticalizable=!0,d+=("imageName"in a?S.advance:fu)*a.scale+c):d+=S.advance*a.scale+c,b++}0!==s.length&&(f=Math.max(d-c,f),Ju(s,0,s.length-1,g)),d=0,a.lineOffset=Math.max(h,(i-1)*fu);const x=o*i+h;p+=x,m=Math.max(x,m),++_}const{horizontalAlign:v,verticalAlign:b}=Hu(a);(function(e,t,r,n,i,o,a,s,l){const c=(t-r)*i;let u=0;u=o!==a?-s*n- -17:-n*l*a+.5*a;for(const h of e)for(const e of h.positionedGlyphs)e.x+=c,e.y+=u})(e.positionedLines,g,v,b,f,m,o,p,i.length),e.top+=-b*p,e.bottom=e.top+p,e.left+=-v*f,e.right=e.left+f}(x,r,n,i,y,s,l,c,d,u,p,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(w)&&x}function Hu(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Zu(e,t,r){const n=t.getMaxScale()*fu,{maxImageWidth:i,maxImageHeight:o}=t.getMaxImageSize(e),a=Math.max(n,o*r);return{verticalLineContentWidth:Math.max(n,i*r),horizontalLineContentHeight:a}}function Yu(e){switch(e){case"top":return 0;case"center":return.5;default:return 1}}function Xu(t,r,n){return!(t===e.az.horizontal||!r&&!wo(n)||r&&(xo(n)||(i=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(i)))));var i}function Ku(e,t,r,n,i,o){const a=o[e.fontStack],s=function(e,t,r,n){if(e&&e.rect)return e;const i=t[r.fontStack],o=i&&i[n];return o?{rect:null,metrics:o.metrics}:null}(a&&a[t],i,e,t);if(null===s)return null;let l;if(r)l=n.verticalLineContentWidth-e.scale*fu;else{const t=Yu(e.verticalAlign);l=(n.horizontalLineContentHeight-e.scale*fu)*t}return{rect:s.rect,metrics:s.metrics,baselineOffset:l}}function Qu(e,t,r,n,i){const o=i[e.imageName];if(!o)return null;const a=o.paddedRect,s=o.displaySize,l={width:s[0],height:s[1],left:1,top:-3,advance:t?s[1]:s[0]};let c;if(t)c=n.verticalLineContentWidth-s[1]*e.scale;else{const t=Yu(e.verticalAlign);c=(n.horizontalLineContentHeight-s[1]*e.scale)*t}return{rect:a,metrics:l,baselineOffset:c,imageOffset:(t?s[0]:s[1])*e.scale-fu*r}}function Ju(e,t,r,n){if(0===n)return;const i=e[r],o=(e[r].x+i.metrics.advance*i.scale)*n;for(let a=t;a<=r;a++)e[a].x-=o}function eh(e,t,r){const{horizontalAlign:n,verticalAlign:i}=Hu(r),o=t[0]-e.displaySize[0]*n,a=t[1]-e.displaySize[1]*i;return{image:e,top:a,bottom:a+e.displaySize[1],left:o,right:o+e.displaySize[0]}}function th(e){var t,r;let n=e.left,i=e.top,o=e.right-n,a=e.bottom-i;const s=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(r=e.image.textFitHeight)&&void 0!==r?r:"stretchOrShrink",c=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&o/a<c||"proportional"===s){const e=Math.ceil(a*c);n*=e/o,o=e}}else if("proportional"===s&&"stretchOnly"===l&&0!==c&&o/a>c){const e=Math.ceil(o/c);i*=e/a,a=e}return{x1:n,y1:i,x2:n+o,y2:i+a}}function rh(e,t,r,n,i,o){const a=e.image;let s;if(a.content){const e=a.content,t=a.pixelRatio||1;s=[e[0]/t,e[1]/t,a.displaySize[0]-e[2]/t,a.displaySize[1]-e[3]/t]}const l=t.left*o,c=t.right*o;let u,h,d,p;"width"===r||"both"===r?(p=i[0]+l-n[3],h=i[0]+c+n[1]):(p=i[0]+(l+c-a.displaySize[0])/2,h=p+a.displaySize[0]);const f=t.top*o,m=t.bottom*o;return"height"===r||"both"===r?(u=i[1]+f-n[0],d=i[1]+m+n[2]):(u=i[1]+(f+m-a.displaySize[1])/2,d=u+a.displaySize[1]),{image:a,top:u,right:h,bottom:d,left:p,collisionPadding:s}}po("ImagePosition",Uu),po("ImageAtlas",Vu),e.az=void 0,(Gu=e.az||(e.az={}))[Gu.none=0]="none",Gu[Gu.horizontal=1]="horizontal",Gu[Gu.vertical=2]="vertical",Gu[Gu.horizontalOnly=3]="horizontalOnly";const nh=128,ih=32640;function oh(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Oo(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let o=i;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const a=t[i],s=t[o];return"composite"===r.kind?{kind:"composite",minZoom:a,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:a,maxZoom:s,minSize:r.evaluate(new Oo(a)),maxSize:r.evaluate(new Oo(s)),interpolationType:n}}}function ah(e,t,r){let n="never";const i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}const sh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lh(e,t,r,n,i,o,a,s,l,c,u,h,d){const p=s?Math.min(ih,Math.round(s[0])):0,f=s?Math.min(ih,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),o,a,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function ch(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function uh(e){for(const t of e.sections)if(Ro(t.text))return!0;return!1}class hh{constructor(e){this.layoutVertexArray=new Xa,this.indexArray=new ts,this.programConfigurations=e,this.segments=new os,this.dynamicLayoutVertexArray=new Ka,this.opacityVertexArray=new Qa,this.hasVisibleVertices=!1,this.placedSymbolArray=new Da}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,cu.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,sh,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}po("SymbolBuffers",hh);class dh{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new os,this.collisionVertexArray=new es}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,uu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}po("CollisionBuffers",dh);class ph{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oh(this.zoom,r["text-size"]),this.iconSizeData=oh(this.zoom,r["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),o=n.get("symbol-z-order");this.canOverlap="never"!==ah(n,"text-overlap","text-allow-overlap")||"never"!==ah(n,"icon-overlap","icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==o&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((t=>e.az[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new hh(new Ls(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new hh(new Ls(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new Ba,this.lineVertexArray=new $a,this.symbolInstances=new La,this.textAnchorOffsets=new Fa}calculateGlyphDependencies(e,t,r,n,i){for(const o of e)if(t[o.codePointAt(0)]=!0,(r||n)&&i){const e=mu[o];e&&(t[e.codePointAt(0)]=!0)}}populate(t,r,n){const i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof Mt&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=r.iconDependencies,p=r.glyphDependencies,f=r.availableImages,m=new Oo(this.zoom);for(const{feature:g,id:y,index:_,sourceLayerIndex:v}of t){const t=i._featureFilter.needGeometry,r=Ns(g,t);if(!i._featureFilter.filter(m,r,n))continue;let s,l;if(t||(r.geometry=qs(g)),c){const e=i.getValueAndResolveTokens("text-field",r,n,f),t=Mt.factory(e),o=this.hasRTLText=this.hasRTLText||uh(t);(!o||"unavailable"===Do.getRTLTextPluginStatus()||o&&Do.isParsed())&&(s=pu(t,i,r))}if(u){const e=i.getValueAndResolveTokens("icon-image",r,n,f);l=e instanceof zt?e:zt.fromString(e)}if(!s&&!l)continue;const b=this.sortFeaturesByKey?h.evaluate(r,{},n):void 0;if(this.features.push({id:y,text:s,icon:l,index:_,sourceLayerIndex:v,geometry:r.geometry,properties:g.properties,type:kc.types[g.type],sortKey:b}),l&&(d[l.name]=!0),s){const t=a.evaluate(r,{},n).join(","),i="viewport"!==o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.az.vertical)>=0;for(const e of s.sections)if(e.image)d[e.image.name]=!0;else{const r=So(s.toString()),n=e.fontStack||t,o=p[n]=p[n]||{};this.calculateGlyphDependencies(e.text,o,i,this.allowVerticalPlacement,r)}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function o(t){n.push(e[t]),i++}function a(e,t,i){const o=r[e];return delete r[e],r[t]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function s(e,r,i){const o=t[r];return delete t[r],t[e]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function l(e,t,r){const n=r?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){o(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in r&&f in t&&r[p]!==t[f]){const e=s(p,f,h),i=a(p,f,n[e].geometry);delete t[p],delete r[f],r[l(d,n[i].geometry,!0)]=i,n[e].geometry=null}else p in r?a(p,f,h):f in t?s(p,f,h):(o(c),t[p]=i-1,r[f]=i-1)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,{imagePositions:r}),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,{imagePositions:r}))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]);const i={};for(let o=e.segment+1;o<t.length;o++)i[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:r},o<t.length-1&&(r+=t[o+1].dist(t[o]));for(let o=e.segment||0;o>=0;o--)i[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:n},o>0&&(n+=t[o-1].dist(t[o]));for(let e=0;e<t.length;e++){const t=i[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,n,i,o,a,s,l,c,u,h,d){const p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*r.length,f,p,this.canOverlap?a.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,_=this.allowVerticalPlacement&&s===e.az.vertical?Math.PI/2:0,v=a.text&&a.text.sections;for(let e=0;e<r.length;e++){const{tl:i,tr:o,bl:s,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:b,glyphOffset:w,isSDF:x,sectionIndex:S}=r[e],E=m.vertexLength,T=w[1];lh(f,l.x,l.y,i.x,T+i.y,u.x,u.y,n,x,h.x,h.y,y,b),lh(f,l.x,l.y,o.x,T+o.y,u.x+u.w,u.y,n,x,g.x,h.y,y,b),lh(f,l.x,l.y,s.x,T+s.y,u.x,u.y+u.h,n,x,h.x,g.y,y,b),lh(f,l.x,l.y,c.x,T+c.y,u.x+u.w,u.y+u.h,n,x,g.x,g.y,y,b),ch(t.dynamicLayoutVertexArray,l,_),p.emplaceBack(E,E+2,E+1),p.emplaceBack(E+1,E+2,E+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(w[0]),e!==r.length-1&&S===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,a,a.index,{imagePositions:{},canonical:d,formattedSection:v&&v[S]})}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,t,r,n,i,o){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,t,n,i,o,a,s){const l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),c=l.vertexLength,u=o.layoutVertexArray,h=o.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,h,a,d,p,new r(e,t)),this._addCollisionDebugVertex(u,h,a,d,p,new r(n,t)),this._addCollisionDebugVertex(u,h,a,d,p,new r(n,i)),this._addCollisionDebugVertex(u,h,a,d,p,new r(e,i)),l.vertexLength+=4;const f=o.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let i=e;i<t;i++){const e=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,n?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dh(Ja,hu.members,rs),this.iconCollisionBox=new dh(Ja,hu.members,rs);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,o,a,s,l){const c={};for(let u=t;u<r;u++){const t=e.get(u);c.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.textFeatureIndex=t.featureIndex;break}for(let u=n;u<i;u++){const t=e.get(u);c.verticalTextBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalTextFeatureIndex=t.featureIndex;break}for(let u=o;u<a;u++){const t=e.get(u);c.iconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.iconFeatureIndex=t.featureIndex;break}for(let u=s;u<l;u++){const t=e.get(u);c.verticalIconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalIconFeatureIndex=t.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let i=r.vertexStartIndex;i<n;i+=4)e.indexArray.emplaceBack(i,i+2,i+1),e.indexArray.emplaceBack(i+1,i+2,i+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],o=[];for(let a=0;a<this.symbolInstances.length;++a){o.push(a);const e=this.symbolInstances.get(a);n.push(0|Math.round(t*e.anchorX+r*e.anchorY)),i.push(e.featureIndex)}return o.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),o}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fh,mh;po("SymbolBucket",ph,{omit:["layers","collisionBoxArray","features","compareText"]}),ph.MAX_GLYPHS=65535,ph.addDynamicAttributes=ch;var gh={get paint(){return mh=mh||new Xo({"icon-opacity":new Wo(ve.paint_symbol["icon-opacity"]),"icon-color":new Wo(ve.paint_symbol["icon-color"]),"icon-halo-color":new Wo(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wo(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wo(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new Go(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new Go(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wo(ve.paint_symbol["text-opacity"]),"text-color":new Wo(ve.paint_symbol["text-color"],{runtimeType:Fe,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Wo(ve.paint_symbol["text-halo-color"]),"text-halo-width":new Wo(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new Wo(ve.paint_symbol["text-halo-blur"]),"text-translate":new Go(ve.paint_symbol["text-translate"]),"text-translate-anchor":new Go(ve.paint_symbol["text-translate-anchor"])})},get layout(){return fh=fh||new Xo({"symbol-placement":new Go(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new Go(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Go(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wo(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Go(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Go(ve.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Go(ve.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Go(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new Go(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Go(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wo(ve.layout_symbol["icon-size"]),"icon-text-fit":new Go(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Go(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wo(ve.layout_symbol["icon-image"]),"icon-rotate":new Wo(ve.layout_symbol["icon-rotate"]),"icon-padding":new Wo(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new Go(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new Wo(ve.layout_symbol["icon-offset"]),"icon-anchor":new Wo(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Go(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Go(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Go(ve.layout_symbol["text-rotation-alignment"]),"text-field":new Wo(ve.layout_symbol["text-field"]),"text-font":new Wo(ve.layout_symbol["text-font"]),"text-size":new Wo(ve.layout_symbol["text-size"]),"text-max-width":new Wo(ve.layout_symbol["text-max-width"]),"text-line-height":new Go(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new Wo(ve.layout_symbol["text-letter-spacing"]),"text-justify":new Wo(ve.layout_symbol["text-justify"]),"text-radial-offset":new Wo(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Go(ve.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Wo(ve.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Wo(ve.layout_symbol["text-anchor"]),"text-max-angle":new Go(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new Go(ve.layout_symbol["text-writing-mode"]),"text-rotate":new Wo(ve.layout_symbol["text-rotate"]),"text-padding":new Go(ve.layout_symbol["text-padding"]),"text-keep-upright":new Go(ve.layout_symbol["text-keep-upright"]),"text-transform":new Wo(ve.layout_symbol["text-transform"]),"text-offset":new Wo(ve.layout_symbol["text-offset"]),"text-allow-overlap":new Go(ve.layout_symbol["text-allow-overlap"]),"text-overlap":new Go(ve.layout_symbol["text-overlap"]),"text-ignore-placement":new Go(ve.layout_symbol["text-ignore-placement"]),"text-optional":new Go(ve.layout_symbol["text-optional"])})}};class yh{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Le,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}po("FormatSectionOverride",yh,{omit:["defaultValue"]});class _h extends Ko{constructor(e,t){super(e,gh,t)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const r of e)t.indexOf(r)<0&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||ri(o.value)||!i?i:(a=t.properties,i.replace(/{([^{}]+)}/g,((e,t)=>a&&t in a?String(a[t]):"")));var a}createBucket(e){return new ph(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of gh.paint.overridableProperties){if(!_h.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new yh(t),n=new ti(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new ii("source",n):new oi("composite",n,t.value.zoomStops),this.paint._values[e]=new Uo(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&_h.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=gh.paint.properties[t];let i=!1;const o=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof Mt)o(r.value.value.sections);else if("source"===r.value.kind||"composite"===r.value.kind){const e=t=>{i||(t instanceof Vt&&jt(t.value)===Ve?o(t.value.sections):t instanceof Ir?o(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}}let vh;var bh={get paint(){return vh=vh||new Xo({"background-color":new Go(ve.paint_background["background-color"]),"background-pattern":new Zo(ve.paint_background["background-pattern"]),"background-opacity":new Go(ve.paint_background["background-opacity"])})}};class wh extends Ko{constructor(e,t){super(e,bh,t)}}class xh extends Ko{constructor(e,t){super(e,{},t),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Sh{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Eh={once:!0},Th=6371008.8;class Ah{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ah($(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Th*Math.acos(Math.min(i,1))}static convert(e){if(e instanceof Ah)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Ah(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Ah(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ch=2*Math.PI*Th;function Ih(e){return Ch*Math.cos(e*Math.PI/180)}function kh(e){return(180+e)/360}function Ph(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Mh(e,t){return e/Ih(t)}function Rh(e){return 360*e-180}function Dh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Oh(e,t){return e*Ih(Dh(t))}class Lh{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){const r=Ah.convert(e);return new Lh(kh(r.lng),Ph(r.lat),Mh(t,r.lat))}toLngLat(){return new Ah(Rh(this.x),Dh(this.y))}toAltitude(){return Oh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ch*(e=Dh(this.y),1/Math.cos(e*Math.PI/180));var e}}function Bh(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class $h{constructor(e,t,r){if(i=t,o=r,(n=e)<0||n>25||o<0||o>=Math.pow(2,n)||i<0||i>=Math.pow(2,n))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);var n,i,o;this.z=e,this.x=t,this.y=r,this.key=qh(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){const n=(o=this.y,a=this.z,s=Bh(256*(i=this.x),256*(o=Math.pow(2,a)-o-1),a),l=Bh(256*(i+1),256*(o+1),a),s[0]+","+s[1]+","+l[0]+","+l[1]);var i,o,a,s,l;const c=function(e,t,r){let n,i="";for(let o=e;o>0;o--)n=1<<o-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new r((e.x*t-this.x)*k,(e.y*t-this.y)*k)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zh{constructor(e,t){this.wrap=e,this.canonical=t,this.key=qh(e,t.z,t.z,t.x,t.y)}}class Fh{constructor(e,t,r,n,i){if(this.terrainRttPosMatrix32f=null,e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new $h(r,+n,+i),this.key=qh(t,e,r,n,i)}clone(){return new Fh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new Fh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Fh(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?qh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):qh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;if(this.overscaledZ-e.overscaledZ<=0)return!1;if(0===e.overscaledZ)return this.overscaledZ>0;const t=this.canonical.z-e.canonical.z;return!(t<0)&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Fh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Fh(t,this.wrap,t,r,n),new Fh(t,this.wrap,t,r+1,n),new Fh(t,this.wrap,t,r,n+1),new Fh(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Fh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Fh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Lh(e.x-this.wrap,e.y))}}function qh(e,t,r,n,i){(e*=2)<0&&(e=-1*e-1);const o=1<<r;return(o*o*e+o*i+n).toString(36)+r.toString(36)+t.toString(36)}function Nh(e,t){return t?e.properties[t]:e.id}function jh(e,t){const r={id:e.id};if(t.removeAllProperties&&(delete e.removeProperties,delete e.addOrUpdateProperties,delete t.removeProperties),t.removeProperties)for(const n of t.removeProperties){const t=e.addOrUpdateProperties.findIndex((e=>e.key===n));t>-1&&e.addOrUpdateProperties.splice(t,1)}return(e.removeAllProperties||t.removeAllProperties)&&(r.removeAllProperties=!0),(e.removeProperties||t.removeProperties)&&(r.removeProperties=[...e.removeProperties||[],...t.removeProperties||[]]),(e.addOrUpdateProperties||t.addOrUpdateProperties)&&(r.addOrUpdateProperties=[...e.addOrUpdateProperties||[],...t.addOrUpdateProperties||[]]),(e.newGeometry||t.newGeometry)&&(r.newGeometry=t.newGeometry||e.newGeometry),r}function Uh(e){var t,r;if(!e)return{};const n={};return n.removeAll=e.removeAll,n.remove=new Set(e.remove||[]),n.add=new Map(null===(t=e.add)||void 0===t?void 0:t.map((e=>[e.id,e]))),n.update=new Map(null===(r=e.update)||void 0===r?void 0:r.map((e=>[e.id,e]))),n}po("CanonicalTileID",$h),po("OverscaledTileID",Fh,{omit:["terrainRttPosMatrix32f"]});class Vh{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const t=new Vh;return t.extend(e(new r(this.minX,this.minY))),t.extend(e(new r(this.maxX,this.minY))),t.extend(e(new r(this.minX,this.maxY))),t.extend(e(new r(this.maxX,this.maxY))),t}static fromPoints(e){const t=new Vh;for(const r of e)t.extend(r);return t}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class Gh{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Wh{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,this._x=r,this._y=n,this._z=t,this.properties=e.properties,this.id=i}projectPoint(e,t,r,n){return[360*(e.x+t)/n-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+r)/n)*Math.PI))-90]}projectLine(e,t,r,n){return e.map((e=>this.projectPoint(e,t,r,n)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,t=e.extent*Math.pow(2,this._z),r=e.extent*this._x,n=e.extent*this._y,i=e.loadGeometry();switch(e.type){case 1:{const e=[];for(const t of i)e.push(t[0]);const o=this.projectLine(e,r,n,t);this._geometry=1===e.length?{type:"Point",coordinates:o[0]}:{type:"MultiPoint",coordinates:o};break}case 2:{const e=i.map((e=>this.projectLine(e,r,n,t)));this._geometry=1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e};break}case 3:{const e=Mc(i),o=[];for(const i of e)o.push(i.map((e=>this.projectLine(e,r,n,t))));this._geometry=1===o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&"_x"!==t&&"_y"!==t&&"_z"!==t&&(e[t]=this[t]);return e}}class Hh{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,t,r){this._name=e,this.dataBuffer=t,"number"==typeof r?this._size=r:(this.nullabilityBuffer=r,this._size=r.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class Zh extends Hh{}class Yh extends Zh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Xh extends Zh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Kh extends Hh{delta;constructor(e,t,r,n){super(e,t,n),this.delta=r}}class Qh extends Kh{constructor(e,t,r,n){super(e,Int32Array.of(t),r,n)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Jh extends Hh{constructor(e,t,r){super(e,Int32Array.of(t),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}class ed{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,t,r,n,i=4096){this._name=e,this._geometryVector=t,this._idVector=r,this._propertyVectors=n,this._extent=i}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((e=>[e.name,e])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let t=0;for(;t<this.numFeatures;){let r;this.idVector&&(r=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(t)):this.idVector.getValue(t));const n=e?.next().value,i={};for(const e of this.propertyVectors){if(!e)continue;const r=e.name,n=e.getValue(t);null!==n&&(i[r]=n)}t++,yield{id:r,geometry:n,properties:i}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],t=this.geometryVector.getGeometries();for(let r=0;r<this.numFeatures;r++){let n;this.idVector&&(n=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(r)):this.idVector.getValue(r));const i={coordinates:t[r],type:this.geometryVector.geometryType(r)},o={};for(const e of this.propertyVectors){if(!e)continue;const t=e.name,n=e.getValue(r);null!==n&&(o[t]=n)}e.push({id:n,geometry:i,properties:o})}return e}containsMaxSaveIntegerValues(e){return e instanceof Yh||e instanceof Jh&&e instanceof Qh||e instanceof Xh}}class td{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var rd,nd,id,od,ad,sd,ld,cd,ud,hd,dd;function pd(e,t,r){const n=new Int32Array(r);let i=0,o=t.get();for(let a=0;a<n.length;a++){let t=e[o++],r=127&t;t<128||(t=e[o++],r|=(127&t)<<7,t<128||(t=e[o++],r|=(127&t)<<14,t<128||(t=e[o++],r|=(127&t)<<21,t<128||(t=e[o++],r|=(15&t)<<28)))),n[i++]=r}return t.set(o),n}function fd(e,t,r){const n=new BigInt64Array(r);for(let i=0;i<n.length;i++)n[i]=vd(e,t);return n}function md(e,t){let r,n;return n=e[t.get()],t.increment(),r=127&n,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<7,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<14,n<128?r:(n=e[t.get()],t.increment(),r|=(127&n)<<21,n<128?r:(n=e[t.get()],r|=(15&n)<<28,function(e,t,r){let n,i;if(i=t[r.get()],r.increment(),n=(112&i)>>4,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<3,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<10,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<17,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(127&i)<<24,i<128)return 4294967296*n+(e>>>0);if(i=t[r.get()],r.increment(),n|=(1&i)<<31,i<128)return 4294967296*n+(e>>>0);throw new Error("Expected varint not more than 10 bytes")}(r,e,t)))))}function gd(e,t,r,n){throw new Error("FastPFor is not implemented yet.")}function yd(e){return e>>>1^-(1&e)}function _d(e){return e>>1n^-(1n&e)}function vd(e,t){let r=0n,n=0,i=t.get();for(;i<e.length;){const t=e[i++];if(r|=BigInt(127&t)<<BigInt(n),!(128&t))break;if(n+=7,n>=64)throw new Error("Varint too long")}return t.set(i),r}function bd(e,t,r){const n=new Int32Array(r);let i=0;for(let o=0;o<t;o++){const r=e[o];n.fill(e[o+t],i,i+r),i+=r}return n}function wd(e,t,r){const n=new BigInt64Array(r);let i=0;for(let o=0;o<t;o++){const r=Number(e[o]);n.fill(e[o+t],i,i+r),i+=r}return n}function xd(e,t,r){const n=new Float64Array(r);let i=0;for(let o=0;o<t;o++){const r=e[o];n.fill(e[o+t],i,i+r),i+=r}return n}function Sd(e){const t=e.length/4*4;let r=1;if(t>=4)for(let n=e[0];r<t-4;r+=4)n=e[r]+=n,n=e[r+1]+=n,n=e[r+2]+=n,n=e[r+3]+=n;for(;r!=e.length;)e[r]+=e[r-1],++r}function Ed(e){e[0]=e[0]>>>1^-(1&e[0]),e[1]=e[1]>>>1^-(1&e[1]);const t=e.length/4*4;let r=2;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],o=e[r+3];e[r]=(t>>>1^-(1&t))+e[r-2],e[r+1]=(n>>>1^-(1&n))+e[r-1],e[r+2]=(i>>>1^-(1&i))+e[r],e[r+3]=(o>>>1^-(1&o))+e[r+1]}for(;r!=e.length;r+=2)e[r]=(e[r]>>>1^-(1&e[r]))+e[r-2],e[r+1]=(e[r+1]>>>1^-(1&e[r+1]))+e[r-1]}(dd=rd||(rd={})).NONE="NONE",dd.DELTA="DELTA",dd.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",dd.RLE="RLE",dd.MORTON="MORTON",dd.PDE="PDE",function(e){e.NONE="NONE",e.FAST_PFOR="FAST_PFOR",e.VARINT="VARINT",e.ALP="ALP"}(nd||(nd={})),function(e){e.PRESENT="PRESENT",e.DATA="DATA",e.OFFSET="OFFSET",e.LENGTH="LENGTH"}(id||(id={}));class Td{_dictionaryType;_offsetType;_lengthType;constructor(e,t,r){this._dictionaryType=e,this._offsetType=t,this._lengthType=r}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Ad(e,t){const r=function(e,t){const r=e[t.get()],n=Object.values(id)[r>>4];let i=null;switch(n){case id.DATA:i=new Td(Object.values(od)[15&r]);break;case id.OFFSET:i=new Td(null,Object.values(ad)[15&r]);break;case id.LENGTH:i=new Td(null,null,Object.values(sd)[15&r])}t.increment();const o=e[t.get()],a=Object.values(rd)[o>>5],s=Object.values(rd)[o>>2&7],l=Object.values(nd)[3&o];t.increment();const c=pd(e,t,2),u=c[0];return{physicalStreamType:n,logicalStreamType:i,logicalLevelTechnique1:a,logicalLevelTechnique2:s,physicalLevelTechnique:l,numValues:u,byteLength:c[1],decompressedCount:u}}(e,t);return r.logicalLevelTechnique1===rd.MORTON?function(e,t,r){const n=pd(t,r,2);return{physicalStreamType:e.physicalStreamType,logicalStreamType:e.logicalStreamType,logicalLevelTechnique1:e.logicalLevelTechnique1,logicalLevelTechnique2:e.logicalLevelTechnique2,physicalLevelTechnique:e.physicalLevelTechnique,numValues:e.numValues,byteLength:e.byteLength,decompressedCount:e.decompressedCount,numBits:n[0],coordinateShift:n[1]}}(r,e,t):rd.RLE!==r.logicalLevelTechnique1&&rd.RLE!==r.logicalLevelTechnique2||nd.NONE===r.physicalLevelTechnique?r:function(e,t,r){const n=pd(t,r,2);return{physicalStreamType:e.physicalStreamType,logicalStreamType:e.logicalStreamType,logicalLevelTechnique1:e.logicalLevelTechnique1,logicalLevelTechnique2:e.logicalLevelTechnique2,physicalLevelTechnique:e.physicalLevelTechnique,numValues:e.numValues,byteLength:e.byteLength,decompressedCount:n[1],runs:n[0],numRleValues:n[1]}}(r,e,t)}!function(e){e.NONE="NONE",e.SINGLE="SINGLE",e.SHARED="SHARED",e.VERTEX="VERTEX",e.MORTON="MORTON",e.FSST="FSST"}(od||(od={})),function(e){e.VERTEX="VERTEX",e.INDEX="INDEX",e.STRING="STRING",e.KEY="KEY"}(ad||(ad={})),function(e){e.VAR_BINARY="VAR_BINARY",e.GEOMETRIES="GEOMETRIES",e.PARTS="PARTS",e.RINGS="RINGS",e.TRIANGLES="TRIANGLES",e.SYMBOL="SYMBOL",e.DICTIONARY="DICTIONARY"}(sd||(sd={})),function(e){e[e.FLAT=0]="FLAT",e[e.CONST=1]="CONST",e[e.SEQUENCE=2]="SEQUENCE",e[e.DICTIONARY=3]="DICTIONARY",e[e.FSST_DICTIONARY=4]="FSST_DICTIONARY"}(ld||(ld={}));class Cd{values;_size;constructor(e,t){this.values=e,this._size=t}get(e){const t=Math.floor(e/8);return 1==(this.values[t]>>e%8&1)}set(e,t){const r=Math.floor(e/8);this.values[r]=this.values[r]|(t?1:0)<<e%8}getInt(e){const t=Math.floor(e/8);return this.values[t]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function Id(e,t,r,n,i){return function(e,t,r){switch(t.logicalLevelTechnique1){case rd.DELTA:return t.logicalLevelTechnique2===rd.RLE?function(e,t,r){const n=new Int32Array(r);let i=0,o=0;for(let a=0;a<t;a++){const r=e[a],s=yd(e[a+t]);for(let e=0;e<r;e++)o+=s,n[i++]=o}return n}(e,t.runs,t.numRleValues):(function(e){e[0]=e[0]>>>1^-(1&e[0]);const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],o=e[r+3];e[r]=(t>>>1^-(1&t))+e[r-1],e[r+1]=(n>>>1^-(1&n))+e[r],e[r+2]=(i>>>1^-(1&i))+e[r+1],e[r+3]=(o>>>1^-(1&o))+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]>>>1^-(1&e[r]))+e[r-1]}(e),e);case rd.RLE:return n=e,i=t,r?function(e,t,r){const n=new Int32Array(r);let i=0;for(let o=0;o<t;o++){const r=e[o];let a=e[o+t];a=a>>>1^-(1&a),n.fill(a,i,i+r),i+=r}return n}(n,i.runs,i.numRleValues):bd(n,i.runs,i.numRleValues);case rd.MORTON:return Sd(e),e;case rd.COMPONENTWISE_DELTA:return Ed(e),e;case rd.NONE:return r&&function(e){for(let t=0;t<e.length;t++){const r=e[t];e[t]=r>>>1^-(1&r)}}(e),e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}var n,i}(Pd(e,t,r),r,n)}function kd(e,t,r){return function(e,t){if(t.logicalLevelTechnique1===rd.DELTA&&t.logicalLevelTechnique2===rd.NONE)return function(e){const t=new Int32Array(e.length+1);t[0]=0,t[1]=yd(e[0]);let r=t[1],n=2;for(;n!=t.length;++n){const i=e[n-1];r+=i>>>1^-(1&i),t[n]=t[n-1]+r}return t}(e);if(t.logicalLevelTechnique1===rd.RLE&&t.logicalLevelTechnique2===rd.NONE)return function(e,t,r){const n=new Int32Array(r+1);n[0]=0;let i=1,o=n[0];for(let a=0;a<t;a++){const r=e[a],s=e[a+t];for(let e=i;e<i+r;e++)n[e]=s+o,o=n[e];i+=r}return n}(e,t.runs,t.numRleValues);if(t.logicalLevelTechnique1===rd.NONE&&t.logicalLevelTechnique2===rd.NONE){!function(e){let t=0;for(let r=0;r<e.length;r++)e[r]+=t,t=e[r]}(e);const r=new Int32Array(t.numValues+1);return r[0]=0,r.set(e,1),r}if(t.logicalLevelTechnique1===rd.DELTA&&t.logicalLevelTechnique2===rd.RLE){const r=function(e,t,r){const n=new Int32Array(r+1);n[0]=0;let i=1,o=n[0];for(let a=0;a<t;a++){const r=e[a];let s=e[a+t];s=s>>>1^-(1&s);for(let e=i;e<i+r;e++)n[e]=s+o,o=n[e];i+=r}return n}(e,t.runs,t.numRleValues);return Sd(r),r}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}(Pd(e,t,r),r)}function Pd(e,t,r){const n=r.physicalLevelTechnique;if(n===nd.FAST_PFOR)return gd();if(n===nd.VARINT)return pd(e,t,r.numValues);if(n===nd.NONE){const n=t.get();t.add(r.byteLength);const i=e.subarray(n,t.get());return new Int32Array(i)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Md(e,t,r,n){const i=Pd(e,t,r);if(1===i.length){const e=i[0];return n?yd(e):e}return n?yd(i[1]):function(e){return e[1]}(i)}function Rd(e,t,r){return function(e){if(2==e.length){const t=yd(e[1]);return[t,t]}return[yd(e[2]),yd(e[3])]}(Pd(e,t,r))}function Dd(e,t,r){return function(e){if(2==e.length){const t=_d(e[1]);return[t,t]}return[_d(e[2]),_d(e[3])]}(fd(e,t,r.numValues))}function Od(e,t,r,n){return function(e,t,r){switch(t.logicalLevelTechnique1){case rd.DELTA:return t.logicalLevelTechnique2===rd.RLE?function(e,t,r){const n=new BigInt64Array(r);let i=0,o=0n;for(let a=0;a<t;a++){const r=Number(e[a]),s=_d(e[a+t]);for(let e=0;e<r;e++)o+=s,n[i++]=o}return n}(e,t.runs,t.numRleValues):(function(e){e[0]=e[0]>>1n^-(1n&e[0]);const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],o=e[r+3];e[r]=(t>>1n^-(1n&t))+e[r-1],e[r+1]=(n>>1n^-(1n&n))+e[r],e[r+2]=(i>>1n^-(1n&i))+e[r+1],e[r+3]=(o>>1n^-(1n&o))+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]>>1n^-(1n&e[r]))+e[r-1]}(e),e);case rd.RLE:return n=e,i=t,r?function(e,t,r){const n=new BigInt64Array(r);let i=0;for(let o=0;o<t;o++){const r=Number(e[o]);let a=e[o+t];a=a>>1n^-(1n&a),n.fill(a,i,i+r),i+=r}return n}(n,i.runs,i.numRleValues):wd(n,i.runs,i.numRleValues);case rd.NONE:return r&&function(e){for(let t=0;t<e.length;t++){const r=e[t];e[t]=r>>1n^-(1n&r)}}(e),e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}var n,i}(fd(e,t,r.numValues),r,n)}function Ld(e,t,r,n){const i=fd(e,t,r.numValues);if(1===i.length){const e=i[0];return n?_d(e):e}return n?_d(i[1]):function(e){return e[1]}(i)}function Bd(e,t,r,n,i){return function(e,t,r,n){switch(t.logicalLevelTechnique1){case rd.DELTA:return t.logicalLevelTechnique2===rd.RLE&&(e=bd(e,t.runs,t.numRleValues)),function(e,t){const r=new Int32Array(e.size());let n=0;e.get(0)?(r[0]=e.get(0)?t[0]>>>1^-(1&t[0]):0,n=1):r[0]=0;let i=1;for(;i!=r.length;++i)r[i]=e.get(i)?r[i-1]+(t[n]>>>1^-(1&t[n++])):r[i-1];return r}(n,e);case rd.RLE:return function(e,t,r,n){const i=t;return r?function(e,t,r){const n=new Int32Array(e.size());let i=0;for(let o=0;o<r;o++){const a=t[o];let s=t[o+r];s=s>>>1^-(1&s);for(let t=i;t<i+a;t++)e.get(t)?n[t]=s:(n[t]=0,i++);i+=a}return n}(n,e,i.runs):function(e,t,r){const n=new Int32Array(e.size());let i=0;for(let o=0;o<r;o++){const a=t[o],s=t[o+r];for(let t=i;t<i+a;t++)e.get(t)?n[t]=s:(n[t]=0,i++);i+=a}return n}(n,e,i.runs)}(e,t,r,n);case rd.MORTON:return Sd(e),e;case rd.COMPONENTWISE_DELTA:return Ed(e),e;case rd.NONE:return e=r?function(e,t){const r=new Int32Array(e.size());let n=0,i=0;for(;i!=r.length;++i)if(e.get(i)){const e=t[n++];r[i]=e>>>1^-(1&e)}else r[i]=0;return r}(n,e):function(e,t){const r=new Int32Array(e.size());let n=0,i=0;for(;i!=r.length;++i)r[i]=e.get(i)?t[n++]:0;return r}(n,e);default:throw new Error("The specified Logical level technique is not supported")}}(r.physicalLevelTechnique===nd.FAST_PFOR?gd():pd(e,t,r.numValues),r,n,i)}function $d(e,t,r,n){const i=e.logicalLevelTechnique1;if(i===rd.RLE)return 1===e.runs?ld.CONST:ld.FLAT;const o=t instanceof Cd?t.size():t;if(i===rd.DELTA&&e.logicalLevelTechnique2===rd.RLE){const t=e.runs,i=2;if(e.numRleValues!==o)return ld.FLAT;if(1===t)return ld.SEQUENCE;if(2===t){const t=n.get();let o;if(e.physicalLevelTechnique===nd.VARINT)o=pd(r,n,4);else{const e=n.get();o=new Int32Array(r.buffer,r.byteOffset+e,4)}if(n.set(t),o[2]===i&&o[3]===i)return ld.SEQUENCE}}return 1===e.numValues?ld.CONST:ld.FLAT}class zd extends Zh{getValueFromBuffer(e){return this.dataBuffer[e]}}class Fd extends Kh{constructor(e,t,r,n){super(e,BigInt64Array.of(t),r,n)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class qd{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,t,r){this._geometryOffsets=e,this._partOffsets=t,this._ringOffsets=r}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function Nd(e,t,r){return{x:jd(e,t)-r,y:jd(e>>1,t)-r}}function jd(e,t){let r=0;for(let n=0;n<t;n++)r|=(e&1<<2*n)>>n;return r}!function(e){e[e.POINT=0]="POINT",e[e.LINESTRING=1]="LINESTRING",e[e.POLYGON=2]="POLYGON",e[e.MULTIPOINT=3]="MULTIPOINT",e[e.MULTILINESTRING=4]="MULTILINESTRING",e[e.MULTIPOLYGON=5]="MULTIPOLYGON"}(cd||(cd={})),function(e){e[e.POINT=0]="POINT",e[e.LINESTRING=1]="LINESTRING",e[e.POLYGON=2]="POLYGON"}(ud||(ud={})),function(e){e[e.MORTON=0]="MORTON",e[e.VEC_2=1]="VEC_2",e[e.VEC_3=2]="VEC_3"}(hd||(hd={}));class Ud{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((e=>[e]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,t){return[e].concat(t)}createMultiPolygon(e){return e.flat()}}function Vd(e){const t=new Array(e.numGeometries);let n=1,i=1,o=1,a=0;const s=new Ud;let l=0,c=0;const u=e.mortonSettings,h=e.topologyVector,d=h.geometryOffsets,p=h.partOffsets,f=h.ringOffsets,m=e.vertexOffsets,g=e.containsPolygonGeometry(),y=e.vertexBuffer;for(let _=0;_<e.numGeometries;_++){const h=e.geometryType(_);if(h===cd.POINT){if(m&&0!==m.length)if(e.vertexBufferType===hd.VEC_2){const e=2*m[c++],n=new r(y[e],y[e+1]);t[a++]=s.createPoint(n)}else{const e=Nd(y[m[c++]],u.numBits,u.coordinateShift),n=new r(e.x,e.y);t[a++]=s.createPoint(n)}else{const e=new r(y[l++],y[l++]);t[a++]=s.createPoint(e)}d&&o++,p&&n++,f&&i++}else if(h===cd.MULTIPOINT){const e=d[o]-d[o-1];o++;const n=new Array(e);if(m&&0!==m.length){for(let t=0;t<e;t++){const e=2*m[c++];n[t]=new r(y[e],y[e+1])}t[a++]=s.createMultiPoint(n)}else{for(let t=0;t<e;t++){const e=y[l++],i=y[l++];n[t]=new r(e,i)}t[a++]=s.createMultiPoint(n)}}else if(h===cd.LINESTRING){let r,h=0;g?(h=f[i]-f[i-1],i++):h=p[n]-p[n-1],n++,m&&0!==m.length?(r=e.vertexBufferType===hd.VEC_2?Yd(y,m,c,h,!1):Xd(y,m,c,h,!1,u),c+=h):(r=Zd(y,l,h,!1),l+=2*h),t[a++]=s.createLineString(r),d&&o++}else if(h===cd.POLYGON){const r=p[n]-p[n-1];n++;const h=new Array(r-1);let g=f[i]-f[i-1];if(i++,m&&0!==m.length){const r=e.vertexBufferType===hd.VEC_2?Wd(y,m,c,g):Hd(y,m,c,g,0,u);c+=g;for(let t=0;t<h.length;t++)g=f[i]-f[i-1],i++,h[t]=e.vertexBufferType===hd.VEC_2?Wd(y,m,c,g):Hd(y,m,c,g,0,u),c+=g;t[a++]=s.createPolygon(r,h)}else{const e=Gd(y,l,g);l+=2*g;for(let t=0;t<h.length;t++)g=f[i]-f[i-1],i++,h[t]=Gd(y,l,g),l+=2*g;t[a++]=s.createPolygon(e,h)}d&&o++}else if(h===cd.MULTILINESTRING){const r=d[o]-d[o-1];o++;const h=new Array(r);if(m&&0!==m.length){for(let t=0;t<r;t++){let r=0;g?(r=f[i]-f[i-1],i++):r=p[n]-p[n-1],n++;const o=e.vertexBufferType===hd.VEC_2?Yd(y,m,c,r,!1):Xd(y,m,c,r,!1,u);h[t]=o,c+=r}t[a++]=s.createMultiLineString(h)}else{for(let e=0;e<r;e++){let t=0;g?(t=f[i]-f[i-1],i++):t=p[n]-p[n-1],n++,h[e]=Zd(y,l,t,!1),l+=2*t}t[a++]=s.createMultiLineString(h)}}else{if(h!==cd.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const r=d[o]-d[o-1];o++;const h=new Array(r);let g=0;if(m&&0!==m.length){for(let t=0;t<r;t++){const r=p[n]-p[n-1];n++;const o=new Array(r-1);g=f[i]-f[i-1],i++;const a=e.vertexBufferType===hd.VEC_2?Wd(y,m,c,g):Hd(y,m,c,g,0,u);c+=g;for(let t=0;t<o.length;t++)g=f[i]-f[i-1],i++,o[t]=e.vertexBufferType===hd.VEC_2?Wd(y,m,c,g):Hd(y,m,c,g,0,u),c+=g;h[t]=s.createPolygon(a,o)}t[a++]=s.createMultiPolygon(h)}else{for(let e=0;e<r;e++){const t=p[n]-p[n-1];n++;const r=new Array(t-1);g=f[i]-f[i-1],i++;const o=Gd(y,l,g);l+=2*g;for(let e=0;e<r.length;e++){const t=f[i]-f[i-1];i++,r[e]=Gd(y,l,t),l+=2*t}h[e]=s.createPolygon(o,r)}t[a++]=s.createMultiPolygon(h)}}}}return t}function Gd(e,t,r){return Zd(e,t,r,!0)}function Wd(e,t,r,n){return Yd(e,t,r,n,!0)}function Hd(e,t,r,n,i,o){return Xd(e,t,r,n,!0,o)}function Zd(e,t,n,i){const o=new Array(i?n+1:n);for(let a=0;a<2*n;a+=2)o[a/2]=new r(e[t+a],e[t+a+1]);return i&&(o[o.length-1]=o[0]),o}function Yd(e,t,n,i,o){const a=new Array(o?i+1:i);for(let s=0;s<2*i;s+=2){const i=2*t[n+s/2];a[s/2]=new r(e[i],e[i+1])}return o&&(a[a.length-1]=a[0]),a}function Xd(e,t,n,i,o,a){const s=new Array(o?i+1:i);for(let l=0;l<i;l++){const i=Nd(e[t[n+l]],a.numBits,a.coordinateShift);s[l]=new r(i.x,i.y)}return o&&(s[s.length-1]=s[0]),s}class Kd{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,t,r,n,i){this._vertexBufferType=e,this._topologyVector=t,this._vertexOffsets=r,this._vertexBuffer=n,this._mortonSettings=i}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Vd(this);let t=0;for(;t<this.numGeometries;)yield{coordinates:e[t],type:this.geometryType(t)},t++}getSimpleEncodedVertex(e){const t=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[t],this.vertexBuffer[t+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const t=Nd(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[t.x,t.y]}const t=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[t],this.vertexBuffer[t+1]]}getGeometries(){return Vd(this)}get mortonSettings(){return this._mortonSettings}}class Qd extends Kd{_numGeometries;_geometryType;constructor(e,t,r,n,i,o,a){super(r,n,i,o,a),this._numGeometries=e,this._geometryType=t}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===cd.POLYGON||this._geometryType===cd.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Jd extends Kd{_geometryTypes;constructor(e,t,r,n,i,o){super(e,r,n,i,o),this._geometryTypes=t}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===cd.POLYGON||this.geometryType(e)===cd.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class ep{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,t,r,n){this._triangleOffsets=e,this._indexBuffer=t,this._vertexBuffer=r,this._topologyVector=n}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),t=this._topologyVector,n=t.partOffsets,i=t.ringOffsets,o=t.geometryOffsets;let a=0,s=1,l=1,c=1;for(let u=0;u<this.numGeometries;u++)switch(this.geometryType(u)){case cd.POLYGON:{const t=n[s]-n[s-1];s++;const h=[];for(let e=0;e<t;e++){const e=i[l]-i[l-1];l++;const t=[];for(let n=0;n<e;n++){const e=this._vertexBuffer[a++],n=this._vertexBuffer[a++];t.push(new r(e,n))}t.length>0&&t.push(t[0]),h.push(t)}e[u]=h,o&&c++}break;case cd.MULTIPOLYGON:{const t=o[c]-o[c-1];c++;const h=[];for(let e=0;e<t;e++){const e=n[s]-n[s-1];s++;for(let t=0;t<e;t++){const e=i[l]-i[l-1];l++;const t=[];for(let n=0;n<e;n++){const e=this._vertexBuffer[a++],n=this._vertexBuffer[a++];t.push(new r(e,n))}t.length>0&&t.push(t[0]),h.push(t)}}e[u]=h}}return e}[Symbol.iterator](){return null}}function tp(e,t,r,n,i,o){return new rp(e,t,r,n,i,o)}class rp extends ep{_numGeometries;_geometryType;constructor(e,t,r,n,i,o){super(r,n,i,o),this._numGeometries=e,this._geometryType=t}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function np(e,t,r,n,i){return new ip(e,t,r,n,i)}class ip extends ep{_geometryTypes;constructor(e,t,r,n,i){super(t,r,n,i),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function op(e,t,r,n,i){const o=Ad(e,r);let a=null,s=null,l=null,c=null,u=null,h=null,d=null,p=null;if($d(o,n,e,r)===ld.CONST){const i=Md(e,r,o,!1);for(let n=0;n<t-1;n++){const t=Ad(e,r);switch(t.physicalStreamType){case id.LENGTH:switch(t.logicalStreamType.lengthType){case sd.GEOMETRIES:a=kd(e,r,t);break;case sd.PARTS:s=kd(e,r,t);break;case sd.RINGS:l=kd(e,r,t);break;case sd.TRIANGLES:d=kd(e,r,t)}break;case id.OFFSET:switch(t.logicalStreamType.offsetType){case ad.VERTEX:c=Id(e,r,t,!1);break;case ad.INDEX:p=Id(e,r,t,!1)}break;case id.DATA:od.VERTEX===t.logicalStreamType.dictionaryType?u=Id(e,r,t,!0):(h={numBits:t.numBits,coordinateShift:t.coordinateShift},u=Id(e,r,t,!1))}}return null!==p?null!=a||null!=s?tp(n,i,d,p,u,new qd(a,s,l)):tp(n,i,d,p,u):null===h?(f=n,m=i,g=new qd(a,s,l),y=c,_=u,new Qd(f,m,hd.VEC_2,g,y,_)):function(e,t,r,n,i,o){return new Qd(e,t,hd.MORTON,r,n,i,o)}(n,i,new qd(a,s,l),c,u,h)}var f,m,g,y,_;const v=Id(e,r,o,!1);for(let b=0;b<t-1;b++){const t=Ad(e,r);switch(t.physicalStreamType){case id.LENGTH:switch(t.logicalStreamType.lengthType){case sd.GEOMETRIES:a=Id(e,r,t,!1);break;case sd.PARTS:s=Id(e,r,t,!1);break;case sd.RINGS:l=Id(e,r,t,!1);break;case sd.TRIANGLES:d=kd(e,r,t)}break;case id.OFFSET:switch(t.logicalStreamType.offsetType){case ad.VERTEX:c=Id(e,r,t,!1);break;case ad.INDEX:p=Id(e,r,t,!1)}break;case id.DATA:od.VERTEX===t.logicalStreamType.dictionaryType?u=Id(e,r,t,!0):(h={numBits:t.numBits,coordinateShift:t.coordinateShift},u=Id(e,r,t,!1))}}return null!==p&&null===s?np(v,d,p,u):(null!==a?(a=ap(v,a,2),null!==s&&null!==l?(s=sp(v,a,s,!1),l=function(e,t,r,n){const i=new Int32Array(r[r.length-1]+1);let o=0;i[0]=o;let a=1,s=1,l=0;for(let c=0;c<e.length;c++){const u=e[c],h=t[c+1]-t[c];if(0!==u&&3!==u)for(let e=0;e<h;e++){const e=r[a]-r[a-1];a++;for(let t=0;t<e;t++)o=i[s++]=o+n[l++]}else for(let e=0;e<h;e++)i[s++]=++o,a++}return i}(v,a,s,l)):null!==s&&(s=function(e,t,r){const n=new Int32Array(t[t.length-1]+1);let i=0;n[0]=i;let o=1,a=0;for(let s=0;s<e.length;s++){const l=e[s],c=t[s+1]-t[s];if(4===l||1===l)for(let e=0;e<c;e++)i=n[o++]=i+r[a++];else for(let e=0;e<c;e++)n[o++]=++i}return n}(v,a,s))):null!==s&&null!==l?(s=ap(v,s,1),l=sp(v,s,l,!0)):null!==s&&(s=ap(v,s,0)),null!==p?np(v,d,p,u,new qd(a,s,l)):null===h?function(e,t,r,n){return new Jd(hd.VEC_2,e,t,r,n)}(v,new qd(a,s,l),c,u):function(e,t,r,n,i){return new Jd(hd.MORTON,e,t,r,n,i)}(v,new qd(a,s,l),c,u,h))}function ap(e,t,r){const n=new Int32Array(e.length+1);let i=0;n[0]=i;let o=0;for(let a=0;a<e.length;a++)i=n[a+1]=i+(e[a]>r?t[o++]:1);return n}function sp(e,t,r,n){const i=new Int32Array(t[t.length-1]+1);let o=0;i[0]=o;let a=1,s=0;for(let l=0;l<e.length;l++){const c=e[l],u=t[l+1]-t[l];if(5===c||2===c||n&&(4===c||1===c))for(let e=0;e<u;e++)o=i[a++]=o+r[s++];else for(let e=0;e<u;e++)i[a++]=++o}return i}class lp extends Hh{dataVector;constructor(e,t,r){super(e,t.getBuffer(),r),this.dataVector=t}getValueFromBuffer(e){return this.dataVector.get(e)}}class cp extends Zh{getValueFromBuffer(e){return this.dataBuffer[e]}}class up extends Hh{constructor(e,t,r){super(e,BigInt64Array.of(t),r)}getValueFromBuffer(e){return this.dataBuffer[0]}}function hp(e,t,r){return dp(e,Math.ceil(t/8),r)}function dp(e,t,r){const n=new Uint8Array(t);let i=0;for(;i<t;){const t=e[r.increment()];if(t<=127){const o=t+3,a=e[r.increment()],s=i+o;n.fill(a,i,s),i=s}else{const o=256-t;for(let t=0;t<o;t++)n[i++]=e[r.increment()]}}return n}const pp=new TextDecoder;function fp(e,t,r){return r-t>=12?pp.decode(e.subarray(t,r)):function(e,t,r){let n="",i=t;for(;i<r;){const t=e[i];let o,a,s,l=null,c=t>239?4:t>223?3:t>191?2:1;if(i+c>r)break;1===c?t<128&&(l=t):2===c?(o=e[i+1],128==(192&o)&&(l=(31&t)<<6|63&o,l<=127&&(l=null))):3===c?(o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&t)<<12|(63&o)<<6|63&a,(l<=2047||l>=55296&&l<=57343)&&(l=null))):4===c&&(o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&t)<<18|(63&o)<<12|(63&a)<<6|63&s,(l<=65535||l>=1114112)&&(l=null))),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(e,t,r)}class mp extends Hh{offsetBuffer;constructor(e,t,r,n){super(e,r,n),this.offsetBuffer=t}}class gp extends mp{textEncoder;constructor(e,t,r,n){super(e,t,r,n??t.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return fp(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class yp extends mp{indexBuffer;textEncoder;constructor(e,t,r,n,i){super(e,r,n,i??t.length),this.indexBuffer=t,this.indexBuffer=t,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const t=this.indexBuffer[e];return fp(this.dataBuffer,this.offsetBuffer[t],this.offsetBuffer[t+1])}}class _p extends mp{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,t,r,n,i,o,a){super(e,r,n,a),this.indexBuffer=t,this.symbolOffsetBuffer=i,this.symbolTableBuffer=o,this.textEncoder=new TextEncoder}getValueFromBuffer(e){null==this.decodedDictionary&&(null==this.symbolLengthBuffer&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=function(e,t,r){const n=[],i=new Array(t.length).fill(0);for(let o=1;o<t.length;o++)i[o]=i[o-1]+t[o-1];for(let o=0;o<r.length;o++)if(255===r[o])n.push(r[++o]);else{const a=t[r[o]],s=i[r[o]];for(let t=0;t<a;t++)n.push(e[s+t])}return new Uint8Array(n)}(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const t=this.indexBuffer[e];return fp(this.decodedDictionary,this.offsetBuffer[t],this.offsetBuffer[t+1])}offsetToLengthBuffer(e){const t=new Uint32Array(e.length-1);let r=e[0];for(let n=1;n<e.length;n++){const i=e[n];t[n-1]=i-r,r=i}return t}}function vp(e,t,r,n,i,o){return"scalarType"===r.type?function(e,t,r,n,i,o){let a=null,s=0;if(0===e)return null;if(o.nullable){const e=Ad(t,r);s=e.numValues;const n=r.get(),i=hp(t,s,r);r.set(n+e.byteLength),a=new Cd(i,e.numValues)}const l=a??n;switch(i.physicalType){case 4:case 3:return function(e,t,r,n,i){const o=Ad(e,t),a=$d(o,i,e,t),s=3===n.physicalType;if(a===ld.FLAT){const n=bp(i)?Bd(e,t,o,s,i):Id(e,t,o,s);return new Yh(r.name,n,i)}if(a===ld.SEQUENCE){const n=Rd(e,t,o);return new Qh(r.name,n[0],n[1],o.numRleValues)}{const n=Md(e,t,o,s);return new Jh(r.name,n,i)}}(t,r,o,i,l);case 9:return function(e,t,r,n,i){let o=null,a=null,s=null,l=null,c=null,u=null,h=null,d=null;for(let b=0;b<n;b++){const e=Ad(t,r);if(0!==e.byteLength)switch(e.physicalStreamType){case id.PRESENT:{const n=hp(t,e.numValues,r);u=new Cd(n,e.numValues);break}case id.OFFSET:a=null!=i||null!=u?Bd(t,r,e,!1,i??u):Id(t,r,e,!1);break;case id.LENGTH:{const n=kd(t,r,e);sd.DICTIONARY===e.logicalStreamType.lengthType?o=n:sd.SYMBOL===e.logicalStreamType.lengthType?l=n:h=n;break}case id.DATA:{const n=t.subarray(r.get(),r.get()+e.byteLength);r.add(e.byteLength);const i=e.logicalStreamType.dictionaryType;od.FSST===i?c=n:od.SINGLE===i||od.SHARED===i?s=n:od.NONE===i&&(d=n);break}}}return p=e,m=a,g=o,y=s,_=l,v=i??u,((f=c)?new _p(p,m,g,y,_,f,v):null)??function(e,t,r,n,i){return t?i?new yp(e,r,n,t,i):new yp(e,r,n,t):null}(e,s,a,o,i??u)??function(e,t,r,n,i){if(!t||!r)return null;if(n)return i?new yp(e,n,t,r,i):new yp(e,n,t,r);if(i&&i.size()!==t.length-1){const n=new Int32Array(i.size());let o=0;for(let e=0;e<i.size();e++)n[e]=i.get(e)?o++:0;return new yp(e,n,t,r,i)}return i?new gp(e,t,r,i):new gp(e,t,r)}(e,h,d,a,i??u);var p,f,m,g,y,_,v}(o.name,t,r,o.nullable?e-1:e,a);case 0:return function(e,t,r,n,i){const o=Ad(e,t),a=o.numValues,s=t.get(),l=bp(i)?function(e,t,r,n){const i=dp(e,Math.ceil(t/8),r),o=new Cd(i,t),a=n.size(),s=new Cd(new Uint8Array(a),a);let l=0;for(let c=0;c<n.size();c++){const e=!!n.get(c)&&o.get(l++);s.set(c,e)}return s.getBuffer()}(e,a,t,i):hp(e,a,t);t.set(s+o.byteLength);const c=new Cd(l,a);return new lp(r.name,c,i)}(t,r,o,0,l);case 6:case 5:return function(e,t,r,n,i){const o=Ad(e,t),a=$d(o,n,e,t),s=5===i.physicalType;if(a===ld.FLAT){const i=bp(n)?(c=s,u=n,function(e,t,r,n){switch(t.logicalLevelTechnique1){case rd.DELTA:return t.logicalLevelTechnique2===rd.RLE&&(e=wd(e,t.runs,t.numRleValues)),function(e,t){const r=new BigInt64Array(e.size());let n=0;e.get(0)?(r[0]=e.get(0)?t[0]>>1n^-(1n&t[0]):0n,n=1):r[0]=0n;let i=1;for(;i!=r.length;++i)r[i]=e.get(i)?r[i-1]+(t[n]>>1n^-(1n&t[n++])):r[i-1];return r}(n,e);case rd.RLE:return function(e,t,r,n){const i=t;return r?function(e,t,r){const n=new BigInt64Array(e.size());let i=0;for(let o=0;o<r;o++){const a=Number(t[o]);let s=t[o+r];s=s>>1n^-(1n&s);for(let t=i;t<i+a;t++)e.get(t)?n[t]=s:(n[t]=0n,i++);i+=a}return n}(n,e,i.runs):function(e,t,r){const n=new BigInt64Array(e.size());let i=0;for(let o=0;o<r;o++){const a=Number(t[o]),s=t[o+r];for(let t=i;t<i+a;t++)e.get(t)?n[t]=s:(n[t]=0n,i++);i+=a}return n}(n,e,i.runs)}(e,t,r,n);case rd.NONE:return e=r?function(e,t){const r=new BigInt64Array(e.size());let n=0,i=0;for(;i!=r.length;++i)if(e.get(i)){const e=t[n++];r[i]=e>>1n^-(1n&e)}else r[i]=0n;return r}(n,e):function(e,t){const r=new BigInt64Array(e.size());let n=0,i=0;for(;i!=r.length;++i)r[i]=e.get(i)?t[n++]:0n;return r}(n,e);default:throw new Error("The specified Logical level technique is not supported")}}(fd(e,t,(l=o).numValues),l,c,u)):Od(e,t,o,s);return new zd(r.name,i,n)}var l,c,u;if(a===ld.SEQUENCE){const n=Dd(e,t,o);return new Fd(r.name,n[0],n[1],o.numRleValues)}{const i=Ld(e,t,o,s);return new up(r.name,i,n)}}(t,r,o,l,i);case 7:return function(e,t,r,n){const i=Ad(e,t),o=bp(n)?function(e,t,r,n){const i=t.get(),o=i+n*Float32Array.BYTES_PER_ELEMENT,a=new Uint8Array(e.subarray(i,o)).buffer,s=new Float32Array(a);t.set(o);const l=r.size(),c=new Float32Array(l);let u=0;for(let h=0;h<l;h++)c[h]=r.get(h)?s[u++]:0;return c}(e,t,n,i.numValues):function(e,t,r){const n=t.get(),i=n+r*Float32Array.BYTES_PER_ELEMENT,o=new Uint8Array(e.subarray(n,i)).buffer,a=new Float32Array(o);return t.set(i),a}(e,t,i.numValues);return new cp(r.name,o,n)}(t,r,o,l);case 8:return function(e,t,r,n){const i=Ad(e,t),o=bp(n)?function(e,t,r,n){const i=t.get(),o=i+n*Float64Array.BYTES_PER_ELEMENT,a=new Uint8Array(e.subarray(i,o)).buffer,s=new Float64Array(a);t.set(o);const l=r.size(),c=new Float64Array(l);let u=0;for(let h=0;h<l;h++)c[h]=r.get(h)?s[u++]:0;return c}(e,t,n,i.numValues):function(e,t,r){const n=t.get(),i=n+r*Float64Array.BYTES_PER_ELEMENT,o=new Uint8Array(e.subarray(n,i)).buffer,a=new Float64Array(o);return t.set(i),a}(e,t,i.numValues);return new Xh(r.name,o,n)}(t,r,o,l);default:throw new Error(`The specified data type for the field is currently not supported: ${i}`)}}(n,e,t,i,r.scalarType,r):1!=n?null:function(e,t,r,n){let i=null,o=null,a=null,s=null,l=!1;for(;!l;){const r=Ad(e,t);switch(r.physicalStreamType){case id.LENGTH:sd.DICTIONARY===r.logicalStreamType.lengthType?i=kd(e,t,r):a=kd(e,t,r);break;case id.DATA:od.SINGLE===r.logicalStreamType.dictionaryType||od.SHARED===r.logicalStreamType.dictionaryType?(o=e.subarray(t.get(),t.get()+r.byteLength),l=!0):s=e.subarray(t.get(),t.get()+r.byteLength),t.add(r.byteLength)}}const c=r.complexType.children,u=[];let h=0;for(const d of c){const l=pd(e,t,1)[0];if(0==l)continue;const c=`${r.name}${"default"===d.name?"":":"+d.name}`;if(2!==l||"scalarField"!==d.type||9!==d.scalarField.physicalType)throw new Error("Currently only optional string fields are implemented for a struct.");const p=Ad(e,t),f=hp(e,p.numValues,t),m=Ad(e,t),g=m.decompressedCount!==n?Bd(e,t,m,!1,new Cd(f,p.numValues)):Id(e,t,m,!1);u[h++]=s?new _p(c,g,i,o,a,s,new Cd(f,p.numValues)):new yp(c,g,i,o,new Cd(f,p.numValues))}return u}(e,t,r,i)}function bp(e){return e instanceof Cd}function wp(e){if("id"===e.name)return!1;if("scalarType"===e.type){const t=e.scalarType;if("physicalType"===t.type)switch(t.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if("logicalType"===t.type)return!1}else if("complexType"===e.type){const t=e.complexType;if("physicalType"===t.type)switch(t.physicalType){case 0:case 1:return!0;default:return!1}}return!1}const xp=new TextDecoder;function Sp(e,t){const r=pd(e,t,1)[0];if(0===r)return"";const n=t.get(),i=e.subarray(n,n+r);return t.add(r),xp.decode(i)}function Ep(e,t){const r=pd(e,t,1)[0]>>>0,n=!!(4&r),i=!!(2&r),o=pd(e,t,1)[0]>>>0,a={};if(1&r&&(a.nullable=!0),i){const i={};if(n?(i.type="logicalType",i.logicalType=o):(i.type="physicalType",i.physicalType=o),8&r){const r=pd(e,t,1)[0]>>>0;i.children=new Array(r);for(let n=0;n<r;n++)i.children[n]=Ep(e,t)}a.type="complexField",a.complexField=i}else{const e={};n?(e.type="logicalType",e.logicalType=o):(e.type="physicalType",e.physicalType=o),a.type="scalarField",a.scalarField=e}return a}function Tp(e,t){const r=pd(e,t,1)[0]>>>0,n=function(e){switch(e){case 0:case 1:case 2:case 3:{const t={};t.nullable=!!(1&e),t.columnScope=0;const r={};return r.physicalType=e>1?6:4,r.type="physicalType",t.scalarType=r,t.type="scalarType",t}case 4:{const e={nullable:!1,columnScope:0},t={type:"physicalType",physicalType:0};return e.type="complexType",e.complexType=t,e}case 30:{const e={nullable:!1,columnScope:0},t={type:"physicalType",physicalType:1};return e.type="complexType",e.complexType=t,e}default:return function(e){let t=null;switch(e){case 10:case 11:t=0;break;case 12:case 13:t=1;break;case 14:case 15:t=2;break;case 16:case 17:t=3;break;case 18:case 19:t=4;break;case 20:case 21:t=5;break;case 22:case 23:t=6;break;case 24:case 25:t=7;break;case 26:case 27:t=8;break;case 28:case 29:t=9;break;default:return null}const r={};r.nullable=!!(1&e),r.columnScope=0;const n={type:"physicalType"};return n.physicalType=t,r.type="scalarType",r.scalarType=n,r}(e)}}(r);if(!n)throw new Error(`Unsupported column type code: ${r}`);if(r>=10?n.name=Sp(e,t):r>=0&&r<=3?n.name="id":4===r&&(n.name="geometry"),function(e){return 30===e}(r)){const r=pd(e,t,1)[0]>>>0,i=n.complexType;i.children=new Array(r);for(let n=0;n<r;n++)i.children[n]=Ep(e,t)}return n}function Ap(e,t){const r={featureTables:[]},n={};n.name=Sp(e,t);const i=pd(e,t,1)[0]>>>0,o=pd(e,t,1)[0]>>>0;n.columns=new Array(o);for(let a=0;a<o;a++)n.columns[a]=Tp(e,t);return r.featureTables.push(n),[r,i]}function Cp(e,t,r,n,i,o,a=!1){const s=t.scalarType.physicalType,l=$d(i,o,e,r);if(4===s)switch(l){case ld.FLAT:{const t=Id(e,r,i,!1);return new Yh(n,t,o)}case ld.SEQUENCE:{const t=Rd(e,r,i);return new Qh(n,t[0],t[1],i.numRleValues)}case ld.CONST:{const t=Md(e,r,i,!1);return new Jh(n,t,o)}}else switch(l){case ld.FLAT:{if(a){const t=(c=r,function(e,t){switch(t.logicalLevelTechnique1){case rd.DELTA:return t.logicalLevelTechnique2===rd.RLE&&(e=xd(e,t.runs,t.numRleValues)),function(e){e[0]=e[0]%2==1?(e[0]+1)/-2:e[0]/2;const t=e.length/4*4;let r=1;if(t>=4)for(;r<t-4;r+=4){const t=e[r],n=e[r+1],i=e[r+2],o=e[r+3];e[r]=(t%2==1?(t+1)/-2:t/2)+e[r-1],e[r+1]=(n%2==1?(n+1)/-2:n/2)+e[r],e[r+2]=(i%2==1?(i+1)/-2:i/2)+e[r+1],e[r+3]=(o%2==1?(o+1)/-2:o/2)+e[r+2]}for(;r!=e.length;++r)e[r]=(e[r]%2==1?(e[r]+1)/-2:e[r]/2)+e[r-1]}(e),e;case rd.RLE:return xd(e,(r=t).runs,r.numRleValues);case rd.NONE:return e;default:throw new Error(`The specified Logical level technique is not supported: ${t.logicalLevelTechnique1}`)}var r}(function(e,t,r){const n=new Float64Array(t);for(let i=0;i<t;i++)n[i]=md(e,r);return n}(e,(u=i).numValues,c),u));return new Xh(n,t,o)}const t=Od(e,r,i,!1);return new zd(n,t,o)}case ld.SEQUENCE:{const t=Dd(e,r,i);return new Fd(n,t[0],t[1],i.numRleValues)}case ld.CONST:{const t=Ld(e,r,i,!1);return new up(n,t,o)}}var c,u;throw new Error("Vector type not supported for id column.")}class Ip{constructor(e,t){var r;switch(this._featureData=e,this.properties=this._featureData.properties||{},null===(r=this._featureData.geometry)||void 0===r?void 0:r.type){case cd.POINT:case cd.MULTIPOINT:this.type=1;break;case cd.LINESTRING:case cd.MULTILINESTRING:this.type=2;break;case cd.POLYGON:case cd.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=t,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const t of this._featureData.geometry.coordinates){const n=[];for(const e of t)n.push(new r(e.x,e.y));e.push(n)}return e}}class kp{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new Ip(this.features[e],this.extent)}}class Pp{constructor(e){this.layers={};const t=function(e,t,r=!0){const n=new td(0),i=[];for(;n.get()<e.length;){const t=pd(e,n,1)[0]>>>0,o=n.get()+t;if(o>e.length)throw new Error(`Block overruns tile: ${o} > ${e.length}`);if(1!=pd(e,n,1)[0]>>>0){n.set(o);continue}const a=Ap(e,n),s=a[1],l=a[0].featureTables[0];let c=null,u=null;const h=[];let d=0;for(const i of l.columns){const t=i.name;if("id"===t){let o=null;if(i.nullable){const t=Ad(e,n),r=n.get(),i=hp(e,t.numValues,n);n.set(r+t.byteLength),o=new Cd(i,t.numValues)}const a=Ad(e,n);d=a.decompressedCount,c=Cp(e,i,n,t,a,o??d,r)}else if("geometry"===t){const t=pd(e,n,1)[0];if(0===d){const t=n.get();d=Ad(e,n).decompressedCount,n.set(t)}u=op(e,t,n,d)}else{const t=wp(i)?pd(e,n,1)[0]:1;if(0===t&&"scalarType"===i.type)continue;const r=vp(e,n,i,t,d);if(r)if(Array.isArray(r))for(const e of r)h.push(e);else h.push(r)}}const p=new ed(l.name,u,c,h,s);i.push(p),n.set(o)}return i}(new Uint8Array(e));this.layers=t.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:new kp(t)})),{})}}class Mp{constructor(e,t){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=t,"id"in e&&("string"==typeof e.id?this.id=parseInt(e.id,10):"number"!=typeof e.id||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],t=1===this.feature.type?[this.feature.geometry]:this.feature.geometry;for(const n of t){const t=[];for(const e of n)t.push(new r(e[0],e[1]));e.push(t)}return e}}const Rp="_geojsonTileLayer";function Dp(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);const r={keys:[],values:[],keycache:{},valuecache:{}};for(let o=0;o<e.length;o++)r.feature=e.feature(o),t.writeMessage(2,Op,r);const n=r.keys;for(const o of n)t.writeStringField(3,o);const i=r.values;for(const o of i)t.writeMessage(4,Fp,o)}function Op(e,t){if(!e.feature)return;const r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,Lp,e),t.writeVarintField(3,r.type),t.writeMessage(4,zp,r)}function Lp(e,t){for(const r in e.feature?.properties){let n=e.feature.properties[r],i=e.keycache[r];if(null==n)continue;void 0===i&&(e.keys.push(r),i=e.keys.length-1,e.keycache[r]=i),t.writeVarint(i),"string"!=typeof n&&"boolean"!=typeof n&&"number"!=typeof n&&(n=JSON.stringify(n));const o=typeof n+":"+n;let a=e.valuecache[o];void 0===a&&(e.values.push(n),a=e.values.length-1,e.valuecache[o]=a),t.writeVarint(a)}}function Bp(e,t){return(t<<3)+(7&e)}function $p(e){return e<<1^e>>31}function zp(e,t){const r=e.loadGeometry(),n=e.type;let i=0,o=0;for(const a of r){let r=1;1===n&&(r=a.length),t.writeVarint(Bp(1,r));const s=3===n?a.length-1:a.length;for(let e=0;e<s;e++){1===e&&1!==n&&t.writeVarint(Bp(2,s-1));const r=a[e].x-i,l=a[e].y-o;t.writeVarint($p(r)),t.writeVarint($p(l)),i+=r,o+=l}3===e.type&&t.writeVarint(Bp(7,1))}}function Fp(e,t){const r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}class qp{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new uo(k,16,0),this.grid3D=new uo(k,16,0),this.featureIndexArray=new Na,this.promoteId=t}insert(e,t,r,n,i,o){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);const s=o?this.grid3D:this.grid;for(let l=0;l<t.length;l++){const e=t[l],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const n=e[t];r[0]=Math.min(r[0],n.x),r[1]=Math.min(r[1],n.y),r[2]=Math.max(r[2],n.x),r[3]=Math.max(r[3],n.y)}r[0]<k&&r[1]<k&&r[2]>=0&&r[3]>=0&&s.insert(a,r[0],r[1],r[2],r[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers="mlt"!==this.encoding?new Lc(new Cu(this.rawTileData)).layers:new Pp(this.rawTileData).layers,this.sourceLayerCoder=new Gh(this.vtLayers?Object.keys(this.vtLayers).sort():[Rp])),this.vtLayers}query(e,t,n,i){this.loadVTLayers();const o=e.params,a=k/e.tileSize/e.scale,s=pi(o.filter,o.globalState),l=e.queryGeometry,c=e.queryPadding*a,u=Vh.fromPoints(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=Vh.fromPoints(e.cameraQueryGeometry).expandBy(c),p=this.grid3D.query(d.minX,d.minY,d.maxX,d.maxY,((t,n,i,o)=>function(e,t,n,i,o){for(const r of e)if(t<=r.x&&n<=r.y&&i>=r.x&&o>=r.y)return!0;const a=[new r(t,n),new r(t,o),new r(i,o),new r(i,n)];if(e.length>2)for(const r of a)if(el(e,r))return!0;for(let r=0;r<e.length-1;r++)if(tl(e[r],e[r+1],a))return!0;return!1}(e.cameraQueryGeometry,t-c,n-c,i+c,o+c)));for(const r of p)h.push(r);h.sort(jp);const f={};let m;for(let r=0;r<h.length;r++){const c=h[r];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(f,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,s,o.layers,o.availableImages,t,n,i,((t,r,n)=>(d||(d=qs(t)),r.queryIntersectsFeature({queryGeometry:l,feature:t,featureState:n,geometry:d,zoom:this.z,transform:e.transform,pixelsToTileUnits:a,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return f}loadMatchingFeature(e,t,r,n,i,o,a,s,l,c,u){const h=this.bucketLayerIDs[t];if(o&&!h.some((e=>o.has(e))))return;const d=this.sourceLayerCoder.decode(r),p=this.vtLayers[d].feature(n);if(i.needGeometry){const e=Ns(p,!0);if(!i.filter(new Oo(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new Oo(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let m=0;m<h.length;m++){const t=h[m];if(o&&!o.has(t))continue;const r=s[t];if(!r)continue;let i={};f&&c&&(i=c.getState(r.sourceLayer||Rp,f));const d=z({},l[t]);d.paint=Np(d.paint,r.paint,p,i,a),d.layout=Np(d.layout,r.layout,p,i,a);const g=!u||u(p,r,i);if(!g)continue;const y=new Wh(p,this.z,this.x,this.y,f);y.layer=d;let _=e[t];void 0===_&&(_=e[t]=[]),_.push({featureIndex:n,feature:y,intersectionZ:g})}}lookupSymbolFeatures(e,t,r,n,i,o,a,s){const l={};this.loadVTLayers();const c=pi(i.filterSpec,i.globalState);for(const u of e)this.loadMatchingFeature(l,r,n,u,c,o,a,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){var r;let n=e.id;return this.promoteId&&(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof n&&(n=Number(n)),void 0===n&&(null===(r=e.properties)||void 0===r?void 0:r.cluster)&&this.promoteId&&(n=Number(e.properties.cluster_id))),n}}function Np(e,t,r,n,i){return q(e,((e,o)=>{const a=t instanceof Vo?t.get(o):null;return a&&a.evaluate?a.evaluate(r,n,i):a}))}function jp(e,t){return t-e}function Up(e,t,n,i,o){const a=[];for(let s=0;s<e.length;s++){const l=e[s];let c;for(let e=0;e<l.length-1;e++){let s=l[e],u=l[e+1];s.x<t&&u.x<t||(s.x<t?s=new r(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<t&&(u=new r(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new r(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new r(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=i&&u.x>=i||(s.x>=i?s=new r(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=i&&(u=new r(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=o&&u.y>=o||(s.y>=o?s=new r(s.x+(o-s.y)/(u.y-s.y)*(u.x-s.x),o)._round():u.y>=o&&(u=new r(s.x+(o-s.y)/(u.y-s.y)*(u.x-s.x),o)._round()),c&&s.equals(c[c.length-1])||(c=[s],a.push(c)),c.push(u)))))}}return a}function Vp(e,t,r,n,i){switch(t){case 1:return function(e,t,r,n){const i=[];for(const o of e)for(const e of o){const o=0===n?e.x:e.y;o>=t&&o<=r&&i.push([e])}return i}(e,r,n,i);case 2:return Wp(e,r,n,i,!1);case 3:return Wp(e,r,n,i,!0)}return[]}function Gp(e,t,n,i,o){const a=0===i?Hp:Zp;let s=[];const l=[];for(let r=0;r<e.length-1;r++){const c=e[r],u=e[r+1],h=0===i?c.x:c.y,d=0===i?u.x:u.y;let p=!1;h<t?d>t&&s.push(a(c,u,t)):h>n?d<n&&s.push(a(c,u,n)):s.push(c),d<t&&h>=t&&(s.push(a(c,u,t)),p=!0),d>n&&h<=n&&(s.push(a(c,u,n)),p=!0),!o&&p&&(l.push(s),s=[])}const c=e.length-1,u=0===i?e[c].x:e[c].y;return u>=t&&u<=n&&s.push(e[c]),o&&s.length>0&&!s[0].equals(s[s.length-1])&&s.push(new r(s[0].x,s[0].y)),s.length>0&&l.push(s),l}function Wp(e,t,r,n,i){const o=[];for(const a of e){const e=Gp(a,t,r,n,i);e.length>0&&o.push(...e)}return o}function Hp(e,t,n){return new r(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))}function Zp(e,t,n){return new r(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)}po("FeatureIndex",qp,{omit:["rawTileData","sourceLayerCoder"]});class Yp extends r{constructor(e,t,r,n){super(e,t),this.angle=r,void 0!==n&&(this.segment=n)}clone(){return new Yp(this.x,this.y,this.angle,this.segment)}}function Xp(e,t,r,n,i){if(void 0===t.segment||0===r)return!0;let o=t,a=t.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;const l=[];let c=0;for(;s<r/2;){const t=e[a],r=e[a+1];if(!r)return!1;let o=e[a-1].angleTo(t)-t.angleTo(r);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:o}),c+=o;s-l[0].distance>n;)c-=l.shift().angleDelta;if(c>i)return!1;a++,s+=t.dist(r)}return!0}function Kp(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Qp(e,t,r){return e?.6*t*r:0}function Jp(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function ef(e,t,r,n,i,o){const a=Qp(r,i,o),s=Jp(r,n)*o;let l=0;const c=Kp(e)/2;for(let u=0;u<e.length-1;u++){const r=e[u],n=e[u+1],i=r.dist(n);if(l+i>c){const o=(c-l)/i,h=mr.number(r.x,n.x,o),d=mr.number(r.y,n.y,o),p=new Yp(h,d,n.angleTo(r),u);return p._round(),!a||Xp(e,p,s,a,t)?p:void 0}l+=i}}function tf(e,t,r,n,i,o,a,s,l){const c=Qp(n,o,a),u=Jp(n,i),h=u*a,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),rf(e,d?t/2*s%t:(u/2+2*o)*a*s%t,t,c,r,h,d,!1,l)}function rf(e,t,r,n,i,o,a,s,l){const c=o/2,u=Kp(e);let h=0,d=t-r,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],a=e[f+1],s=t.dist(a),m=a.angleTo(t);for(;d+r<h+s;){d+=r;const g=(d-h)/s,y=mr.number(t.x,a.x,g),_=mr.number(t.y,a.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=u){const t=new Yp(y,_,m,f);t._round(),n&&!Xp(e,t,o,n,i)||p.push(t)}}h+=s}return s||p.length||a||(p=rf(e,h/2,r,n,i,o,a,!0,l)),p}function nf(e,t,n,i){const o=[],a=e.image,s=a.pixelRatio,l=a.paddedRect.w-2,c=a.paddedRect.h-2;let u={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};const h=a.stretchX||[[0,l]],d=a.stretchY||[[0,c]],p=(e,t)=>e+t[1]-t[0],f=h.reduce(p,0),m=d.reduce(p,0),g=l-f,y=c-m;let _=0,v=f,b=0,w=m,x=0,S=g,E=0,T=y;if(a.content&&i){const t=a.content,r=t[2]-t[0],n=t[3]-t[1];(a.textFitWidth||a.textFitHeight)&&(u=th(e)),_=of(h,0,t[0]),b=of(d,0,t[1]),v=of(h,t[0],t[2]),w=of(d,t[1],t[3]),x=t[0]-_,E=t[1]-b,S=r-v,T=n-w}const A=u.x1,C=u.y1,I=u.x2-A,k=u.y2-C,P=(e,i,o,l)=>{const c=sf(e.stretch-_,v,I,A),u=lf(e.fixed-x,S,e.stretch,f),h=sf(i.stretch-b,w,k,C),d=lf(i.fixed-E,T,i.stretch,m),p=sf(o.stretch-_,v,I,A),g=lf(o.fixed-x,S,o.stretch,f),y=sf(l.stretch-b,w,k,C),P=lf(l.fixed-E,T,l.stretch,m),M=new r(c,h),R=new r(p,h),D=new r(p,y),O=new r(c,y),L=new r(u/s,d/s),B=new r(g/s,P/s),$=t*Math.PI/180;if($){const e=Math.sin($),t=Math.cos($),r=[t,-e,e,t];M._matMult(r),R._matMult(r),O._matMult(r),D._matMult(r)}const z=e.stretch+e.fixed,F=i.stretch+i.fixed;return{tl:M,tr:R,bl:O,br:D,tex:{x:a.paddedRect.x+1+z,y:a.paddedRect.y+1+F,w:o.stretch+o.fixed-z,h:l.stretch+l.fixed-F},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:B,minFontScaleX:S/s/I,minFontScaleY:T/s/k,isSDF:n}};if(i&&(a.stretchX||a.stretchY)){const e=af(h,g,f),t=af(d,y,m);for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)o.push(P(n,t[e],i,t[e+1]))}}else o.push(P({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return o}function of(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function af(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[i,o]of e){const e=n[n.length-1];n.push({fixed:i-e.stretch,stretch:e.stretch}),n.push({fixed:i-e.stretch,stretch:e.stretch+(o-i)})}return n.push({fixed:t+1,stretch:r}),n}function sf(e,t,r,n){return e/t*r+n}function lf(e,t,r,n){return e-t*r/n}po("Anchor",Yp);class cf{constructor(e,t,n,i,o,a,s,l,c,u){var h;if(this.boxStartIndex=e.length,c){let e=a.top,t=a.bottom;const r=a.collisionPadding;r&&(e-=r[1],t+=r[3]);let n=t-e;n>0&&(n=Math.max(10,n),this.circleDiameter=n)}else{const c=(null===(h=a.image)||void 0===h?void 0:h.content)&&(a.image.textFitWidth||a.image.textFitHeight)?th(a):{x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};c.y1=c.y1*s-l[0],c.y2=c.y2*s+l[2],c.x1=c.x1*s-l[3],c.x2=c.x2*s+l[1];const d=a.collisionPadding;if(d&&(c.x1-=d[0]*s,c.y1-=d[1]*s,c.x2+=d[2]*s,c.y2+=d[3]*s),u){const e=new r(c.x1,c.y1),t=new r(c.x2,c.y1),n=new r(c.x1,c.y2),i=new r(c.x2,c.y2),o=u*Math.PI/180;e._rotate(o),t._rotate(o),n._rotate(o),i._rotate(o),c.x1=Math.min(e.x,t.x,n.x,i.x),c.x2=Math.max(e.x,t.x,n.x,i.x),c.y1=Math.min(e.y,t.y,n.y,i.y),c.y2=Math.max(e.y,t.y,n.y,i.y)}e.emplaceBack(t.x,t.y,c.x1,c.y1,c.x2,c.y2,n,i,o)}this.boxEndIndex=e.length}}class uf{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const o=n+1;if(o<this.length&&r(t[o],t[n])<0&&(n=o),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}}function hf(e,t=1,n=!1){const i=Vh.fromPoints(e[0]),o=Math.min(i.width(),i.height());let a=o/2;const s=new uf([],df),{minX:l,minY:c,maxX:u,maxY:h}=i;if(0===o)return new r(l,c);for(let r=l;r<u;r+=o)for(let t=c;t<h;t+=o)s.push(new pf(r+a,t+a,a,e));let d=function(e){let t=0,r=0,n=0;const i=e[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){const e=i[o],a=i[s],l=e.x*a.y-a.x*e.y;r+=(e.x+a.x)*l,n+=(e.y+a.y)*l,t+=3*l}return new pf(r/t,n/t,0,e)}(e),p=s.length;for(;s.length;){const r=s.pop();(r.d>d.d||!d.d)&&(d=r),r.max-d.d<=t||(a=r.h/2,s.push(new pf(r.p.x-a,r.p.y-a,a,e)),s.push(new pf(r.p.x+a,r.p.y-a,a,e)),s.push(new pf(r.p.x-a,r.p.y+a,a,e)),s.push(new pf(r.p.x+a,r.p.y+a,a,e)),p+=4)}return d.p}function df(e,t){return t.max-e.max}function pf(e,t,n,i){this.p=new r(e,t),this.h=n,this.d=function(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){const o=t[i];for(let t=0,i=o.length,a=i-1;t<i;a=t++){const i=o[t],s=o[a];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(r=!r),n=Math.min(n,Qs(e,i,s))}}return(r?1:-1)*Math.sqrt(n)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}var ff;e.aP=void 0,(ff=e.aP||(e.aP={}))[ff.center=1]="center",ff[ff.left=2]="left",ff[ff.right=3]="right",ff[ff.top=4]="top",ff[ff.bottom=5]="bottom",ff[ff["top-left"]=6]="top-left",ff[ff["top-right"]=7]="top-right",ff[ff["bottom-left"]=8]="bottom-left",ff[ff["bottom-right"]=9]="bottom-right";const mf=Number.POSITIVE_INFINITY;function gf(e,t){return t[1]!==mf?function(e,t,r){let n=0,i=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,i]}(e,t[0],t[1]):function(e,t){let r=0,n=0;t<0&&(t=0);const i=t/Math.SQRT2;switch(e){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function yf(e,t,r){var n;const i=e.layout,o=null===(n=i.get("text-variable-anchor-offset"))||void 0===n?void 0:n.evaluate(t,{},r);if(o){const e=o.values,t=[];for(let r=0;r<e.length;r+=2){const n=t[r]=e[r],i=e[r+1].map((e=>e*fu));n.startsWith("top")?i[1]-=7:n.startsWith("bottom")&&(i[1]+=7),t[r+1]=i}return new $t(t)}const a=i.get("text-variable-anchor");if(a){let n;n=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[i.get("text-radial-offset").evaluate(t,{},r)*fu,mf]:i.get("text-offset").evaluate(t,{},r).map((e=>e*fu));const o=[];for(const e of a)o.push(e,gf(e,n));return new $t(o)}return null}function _f(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vf(t,r,n,i,o,a,s,l,c,u,h,d){let p=a.textMaxSize.evaluate(r,{});void 0===p&&(p=s);const f=t.layers[0].layout,m=f.get("icon-offset").evaluate(r,{},h),g=wf(n.horizontal),y=s/24,_=t.tilePixelRatio*y,v=t.tilePixelRatio*p/24,b=t.tilePixelRatio*l,w=t.tilePixelRatio*f.get("symbol-spacing"),x=f.get("text-padding")*t.tilePixelRatio,S=function(e,t,r,n=1){const i=e.get("icon-padding").evaluate(t,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}(f,r,h,t.tilePixelRatio),E=f.get("text-max-angle")/180*Math.PI,T="viewport"!==f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),A="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),C=f.get("symbol-placement"),I=w/2,P=f.get("icon-text-fit");let M;i&&"none"!==P&&(t.allowVerticalPlacement&&n.vertical&&(M=rh(i,n.vertical,P,f.get("icon-text-fit-padding"),m,y)),g&&(i=rh(i,g,P,f.get("icon-text-fit-padding"),m,y)));const R=h?d.line.getGranularityForZoomLevel(h.z):1,D=(l,d)=>{d.x<0||d.x>=k||d.y<0||d.y>=k||function(t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T){const A=t.addToLineVertexArray(r,n);let C,I,k,P,M=0,R=0,D=0,O=0,L=-1,B=-1;const $={};let z=gs("");if(t.allowVerticalPlacement&&i.vertical){const e=l.layout.get("text-rotate").evaluate(w,{},E)+90;k=new cf(c,r,u,h,d,i.vertical,p,f,m,e),s&&(P=new cf(c,r,u,h,d,s,y,_,m,e))}if(o){const n=l.layout.get("icon-rotate").evaluate(w,{}),i="none"!==l.layout.get("icon-text-fit"),a=nf(o,n,S,i),p=s?nf(s,n,S,i):void 0;I=new cf(c,r,u,h,d,o,y,_,!1,n),M=4*a.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[nh*l.layout.get("icon-size").evaluate(w,{})],m[0]>ih&&V(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[nh*x.compositeIconSizes[0].evaluate(w,{},E),nh*x.compositeIconSizes[1].evaluate(w,{},E)],(m[0]>ih||m[1]>ih)&&V(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,a,m,b,v,w,e.az.none,r,A.lineStartIndex,A.lineLength,-1,E),L=t.icon.placedSymbolArray.length-1,p&&(R=4*p.length,t.addSymbols(t.icon,p,m,b,v,w,e.az.vertical,r,A.lineStartIndex,A.lineLength,-1,E),B=t.icon.placedSymbolArray.length-1)}const F=Object.keys(i.horizontal);for(const V of F){const n=i.horizontal[V];if(!C){z=gs(n.text);const e=l.layout.get("text-rotate").evaluate(w,{},E);C=new cf(c,r,u,h,d,n,p,f,m,e)}const o=1===n.positionedLines.length;if(D+=bf(t,r,n,a,l,m,w,g,A,i.vertical?e.az.horizontal:e.az.horizontalOnly,o?F:[V],$,L,x,E),o)break}i.vertical&&(O+=bf(t,r,i.vertical,a,l,m,w,g,A,e.az.vertical,["vertical"],$,B,x,E));const q=C?C.boxStartIndex:t.collisionBoxArray.length,N=C?C.boxEndIndex:t.collisionBoxArray.length,j=k?k.boxStartIndex:t.collisionBoxArray.length,U=k?k.boxEndIndex:t.collisionBoxArray.length,G=I?I.boxStartIndex:t.collisionBoxArray.length,W=I?I.boxEndIndex:t.collisionBoxArray.length,H=P?P.boxStartIndex:t.collisionBoxArray.length,Z=P?P.boxEndIndex:t.collisionBoxArray.length;let Y=-1;const X=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;Y=X(C,Y),Y=X(k,Y),Y=X(I,Y),Y=X(P,Y);const K=Y>-1?1:0;K&&(Y*=T/fu),t.glyphOffsetArray.length>=ph.MAX_GLYPHS&&V("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,w.sortKey);const Q=yf(l,w,E),[J,ee]=function(t,r){const n=t.length,i=null==r?void 0:r.values;if((null==i?void 0:i.length)>0)for(let o=0;o<i.length;o+=2){const r=i[o+1];t.emplaceBack(e.aP[i[o]],r[0],r[1])}return[n,t.length]}(t.textAnchorOffsets,Q);t.symbolInstances.emplaceBack(r.x,r.y,$.right>=0?$.right:-1,$.center>=0?$.center:-1,$.left>=0?$.left:-1,$.vertical||-1,L,B,z,q,N,j,U,G,W,H,Z,u,D,O,M,R,K,0,p,Y,J,ee)}(t,d,l,n,i,o,M,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,_,[x,x,x,x],T,c,b,S,A,m,r,a,u,h,s)};if("line"===C)for(const e of Up(r.geometry,0,0,k,k)){const r=yc(e,R),o=tf(r,w,E,n.vertical||g,i,24,v,t.overscaling,k);for(const e of o)g&&xf(t,g.text,I,e)||D(r,e)}else if("line-center"===C){for(const e of r.geometry)if(e.length>1){const t=yc(e,R),r=ef(t,E,n.vertical||g,i,24,v);r&&D(t,r)}}else if("Polygon"===r.type)for(const e of en(r.geometry,0)){const t=hf(e,16);D(yc(e[0],R,!0),new Yp(t.x,t.y,0))}else if("LineString"===r.type)for(const e of r.geometry){const t=yc(e,R);D(t,new Yp(t[0].x,t[0].y,0))}else if("Point"===r.type)for(const e of r.geometry)for(const t of e)D([t],new Yp(t.x,t.y,0))}function bf(e,t,n,i,o,a,s,l,c,u,h,d,p,f,m){const g=function(e,t,n,i,o,a,s,l){const c=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,u=[];for(const h of t.positionedLines)for(const e of h.positionedGlyphs){if(!e.rect)continue;const i=e.rect||{};let a=4,d=!0,p=1,f=0;const m=(o||l)&&e.vertical,g=e.metrics.advance*e.scale/2;if(l&&t.verticalizable&&(f=h.lineOffset/2-(e.imageName?-(fu-e.metrics.width*e.scale)/2:(e.scale-1)*fu)),e.imageName){const t=s[e.imageName];d=t.sdf,p=t.pixelRatio,a=1/p}const y=o?[e.x+g,e.y]:[0,0];let _=o?[0,0]:[e.x+g+n[0],e.y+n[1]-f],v=[0,0];m&&(v=_,_=[0,0]);const b=e.metrics.isDoubleResolution?2:1,w=(e.metrics.left-a)*e.scale-g+_[0],x=(-e.metrics.top-a)*e.scale+_[1],S=w+i.w/b*e.scale/p,E=x+i.h/b*e.scale/p,T=new r(w,x),A=new r(S,x),C=new r(w,E),I=new r(S,E);if(m){const t=new r(-g,g- -17),n=-Math.PI/2,i=12-g,o=new r(22-i,-(e.imageName?i:0)),a=new r(...v);T._rotateAround(n,t)._add(o)._add(a),A._rotateAround(n,t)._add(o)._add(a),C._rotateAround(n,t)._add(o)._add(a),I._rotateAround(n,t)._add(o)._add(a)}if(c){const e=Math.sin(c),t=Math.cos(c),r=[t,-e,e,t];T._matMult(r),A._matMult(r),C._matMult(r),I._matMult(r)}const k=new r(0,0),P=new r(0,0);u.push({tl:T,tr:A,bl:C,br:I,tex:i,writingMode:t.writingMode,glyphOffset:y,sectionIndex:e.sectionIndex,isSDF:d,pixelOffsetTL:k,pixelOffsetBR:P,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,o,a,s,i,e.allowVerticalPlacement),y=e.textSizeData;let _=null;"source"===y.kind?(_=[nh*o.layout.get("text-size").evaluate(s,{})],_[0]>ih&&V(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===y.kind&&(_=[nh*f.compositeTextSizes[0].evaluate(s,{},m),nh*f.compositeTextSizes[1].evaluate(s,{},m)],(_[0]>ih||_[1]>ih)&&V(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),e.addSymbols(e.text,g,_,l,a,s,u,t,c.lineStartIndex,c.lineLength,p,m);for(const r of h)d[r]=e.text.placedSymbolArray.length-1;return 4*g.length}function wf(e){for(const t in e)return e[t];return null}function xf(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}const Sf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ef{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const i=Sf[15&r];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new Ef(a,o,i,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=Sf.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+a+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Tf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a){for(let a=h;a<=u;a++){const s=o[2*a],c=o[2*a+1];s>=e&&s<=r&&c>=t&&c<=n&&l.push(i[a])}continue}const d=h+u>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=r&&f>=t&&f<=n&&l.push(i[d]),(0===c?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?r>=p:n>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:i,nodeSize:o}=this,a=[0,n.length-1,0],s=[],l=r*r;for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o){for(let r=h;r<=u;r++)kf(i[2*r],i[2*r+1],e,t)<=l&&s.push(n[r]);continue}const d=h+u>>1,p=i[2*d],f=i[2*d+1];kf(p,f,e,t)<=l&&s.push(n[d]),(0===c?e-r<=p:t-r<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?e+r>=p:t+r>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return s}}function Tf(e,t,r,n,i,o){if(i-n<=r)return;const a=n+i>>1;Af(e,t,a,n,i,o),Tf(e,t,r,n,a-1,1-o),Tf(e,t,r,a+1,i,1-o)}function Af(e,t,r,n,i,o){for(;i>n;){if(i-n>600){const a=i-n+1,s=r-n+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);Af(e,t,r,Math.max(n,Math.floor(r-s*c/a+u)),Math.min(i,Math.floor(r+(a-s)*c/a+u)),o)}const a=t[2*r+o];let s=n,l=i;for(Cf(e,t,n,r),t[2*i+o]>a&&Cf(e,t,n,i);s<l;){for(Cf(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*n+o]===a?Cf(e,t,n,l):(l++,Cf(e,t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function Cf(e,t,r,n){If(e,r,n),If(t,2*r,2*n),If(t,2*r+1,2*n+1)}function If(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function kf(e,t,r,n){const i=e-r,o=t-n;return i*i+o*o}var Pf;e.cI=void 0,(Pf=e.cI||(e.cI={})).create="create",Pf.load="load",Pf.fullLoad="fullLoad";let Mf=null,Rf=[];const Df=1e3/60,Of="loadTime",Lf="fullLoadTime",Bf={mark(e){performance.mark(e)},frame(e){const t=e;null!=Mf&&Rf.push(t-Mf),Mf=t},clearMetrics(){Mf=null,Rf=[],performance.clearMeasures(Of),performance.clearMeasures(Lf);for(const t in e.cI)performance.clearMarks(e.cI[t])},getPerformanceMetrics(){performance.measure(Of,e.cI.create,e.cI.load),performance.measure(Lf,e.cI.create,e.cI.fullLoad);const t=performance.getEntriesByName(Of)[0].duration,r=performance.getEntriesByName(Lf)[0].duration,n=Rf.length,i=1/(Rf.reduce(((e,t)=>e+t),0)/n/1e3),o=Rf.filter((e=>e>Df)).reduce(((e,t)=>e+(t-Df)/Df),0);return{loadTime:t,fullLoadTime:r,fps:i,percentDroppedFrames:o/(n+o)*100,totalFrames:n}}};e.$=u,e.A=p,e.B=co,e.C=io,e.D=Go,e.E=_e,e.F=function([e,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(t)*Math.sin(r),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}},e.G=mr,e.H=Oo,e.I=Uu,e.J=ao,e.K=function(e){if(null==H){const t=e.navigator?e.navigator.userAgent:null;H=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return H},e.L=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Sh((()=>this.process())),this.subscription=J(this.target,"message",(e=>this.receive(e)),!1),this.globalScope=W(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}unregisterMessageHandler(e){delete this.messageHandlers[e]}sendAsync(e,t){return new Promise(((r,n)=>{const i=Math.round(1e18*Math.random()).toString(36).substring(0,10),o=t?J(t.signal,"abort",(()=>{null==o||o.unsubscribe(),delete this.resolveRejects[i];const t={id:i,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)}),Eh):null;this.resolveRejects[i]={resolve:e=>{null==o||o.unsubscribe(),r(e)},reject:e=>{null==o||o.unsubscribe(),n(e)}};const a=[],s=Object.assign(Object.assign({},e),{id:i,sourceMapId:this.mapId,origin:location.origin,data:yo(e.data,a)});this.target.postMessage(s,{transfer:a})}))}receive(e){const t=e.data,r=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&"resource://android"!==t.origin&&"resource://android"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[r];const e=this.abortControllers[r];return delete this.abortControllers[r],void(e&&e.abort())}if(W(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(0===this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,r){return t(this,void 0,void 0,(function*(){if("<response>"===r.type){const t=this.resolveRejects[e];if(delete this.resolveRejects[e],!t)return;return void(r.error?t.reject(_o(r.error)):t.resolve(_o(r.data)))}if(!this.messageHandlers[r.type])return void this.completeTask(e,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const t=_o(r.data),n=new AbortController;this.abortControllers[e]=n;try{const i=yield this.messageHandlers[r.type](r.sourceMapId,t,n);this.completeTask(e,null,i)}catch(i){this.completeTask(e,i)}}))}completeTask(e,t,r){const n=[];delete this.abortControllers[e];const i={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?yo(t):null,data:yo(r,n)};this.target.postMessage(i,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.M=ce,e.N=function(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.O=function(e,t,r){var n,i,o,a,s,l,c,u,h,d,p,f,m=r[0],g=r[1],y=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=n=t[0],e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=n*m+s*g+h*y+t[12],e[13]=i*m+l*g+d*y+t[13],e[14]=o*m+c*g+p*y+t[14],e[15]=a*m+u*g+f*y+t[15]),e},e.P=r,e.Q=function(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.R=Sl,e.S=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15],v=r[0],b=r[1],w=r[2],x=r[3];return e[0]=v*n+b*s+w*h+x*m,e[1]=v*i+b*l+w*d+x*g,e[2]=v*o+b*c+w*p+x*y,e[3]=v*a+b*u+w*f+x*_,e[4]=(v=r[4])*n+(b=r[5])*s+(w=r[6])*h+(x=r[7])*m,e[5]=v*i+b*l+w*d+x*g,e[6]=v*o+b*c+w*p+x*y,e[7]=v*a+b*u+w*f+x*_,e[8]=(v=r[8])*n+(b=r[9])*s+(w=r[10])*h+(x=r[11])*m,e[9]=v*i+b*l+w*d+x*g,e[10]=v*o+b*c+w*p+x*y,e[11]=v*a+b*u+w*f+x*_,e[12]=(v=r[12])*n+(b=r[13])*s+(w=r[14])*h+(x=r[15])*m,e[13]=v*i+b*l+w*d+x*g,e[14]=v*o+b*c+w*p+x*y,e[15]=v*a+b*u+w*f+x*_,e},e.T=Rl,e.U=function(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r},e.V=Ah,e.W=$,e.X=Ph,e.Y=kh,e.Z=ae,e._=t,e.a=oe,e.a$=b,e.a0=h,e.a1=X,e.a2=Fh,e.a3=Rh,e.a4=Dh,e.a5=k,e.a6=function(e,t,r){if(!e)return t||{};if(!t)return e||{};const n=Uh(e),i=Uh(t);!function(e,t){t.removeAll&&(e.add.clear(),e.update.clear(),e.remove.clear(),t.remove.clear());for(const r of t.remove)e.add.delete(r),e.update.delete(r);for(const[r,n]of t.update){const i=e.update.get(r);i&&(t.update.set(r,jh(i,n)),e.update.delete(r))}}(n,i);const o={};if((n.removeAll||i.removeAll)&&(o.removeAll=!0),o.remove=new Set([...n.remove,...i.remove]),o.add=new Map([...n.add,...i.add]),o.update=new Map([...n.update,...i.update]),o.remove.size&&o.add.size)for(const a of o.add.keys())o.remove.delete(a);return function(e){const t={};return e.removeAll&&(t.removeAll=e.removeAll),e.remove&&(t.remove=Array.from(e.remove)),e.add&&(t.add=Array.from(e.add.values())),e.update&&(t.update=Array.from(e.update.values())),t}(o)},e.a7=function(e,t){const r=new Map;if(null==e)return r;if(null==e.type)return r;if("Feature"===e.type){const n=Nh(e,t);if(null==n)return;return r.set(n,e),r}if("FeatureCollection"===e.type){const n=new Set;for(const i of e.features){const e=Nh(i,t);if(null==e)return;if(n.has(e))return;n.add(e),r.set(e,i)}return r}},e.a8=function(e,t,r){var n,i;const o=[];if(t.removeAll)e.clear();else if(t.remove)for(const a of t.remove){const t=e.get(a);t&&(o.push(t.geometry),e.delete(a))}if(t.add)for(const a of t.add){const t=Nh(a,r);if(null==t)continue;const n=e.get(t);n&&o.push(n.geometry),o.push(a.geometry),e.set(t,a)}if(t.update)for(const a of t.update){const t=e.get(a.id);if(!t)continue;const r=!!a.newGeometry,s=a.removeAllProperties||(null===(n=a.removeProperties)||void 0===n?void 0:n.length)>0||(null===(i=a.addOrUpdateProperties)||void 0===i?void 0:i.length)>0;if(!r&&!s)continue;o.push(t.geometry);const l=Object.assign({},t);if(e.set(a.id,l),r&&(o.push(a.newGeometry),l.geometry=a.newGeometry),s){if(l.properties=a.removeAllProperties?{}:Object.assign({},l.properties||{}),a.removeProperties)for(const e of a.removeProperties)delete l.properties[e];if(a.addOrUpdateProperties)for(const{key:e,value:t}of a.addOrUpdateProperties)l.properties[e]=t}}return o},e.a9=Lh,e.aA=function(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/nh:"composite"===e.kind?mr.number(n/nh,i/nh,r):t},e.aB=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=r*s-n*a,v=r*l-i*a,b=r*c-o*a,w=n*l-i*s,x=n*c-o*s,S=i*c-o*l,E=u*m-h*f,T=u*g-d*f,A=u*y-p*f,C=h*g-d*m,I=h*y-p*m,k=d*y-p*g,P=_*k-v*I+b*C+w*A-x*T+S*E;return P?(e[0]=(s*k-l*I+c*C)*(P=1/P),e[1]=(i*I-n*k-o*C)*P,e[2]=(m*S-g*x+y*w)*P,e[3]=(d*x-h*S-p*w)*P,e[4]=(l*A-a*k-c*T)*P,e[5]=(r*k-i*A+o*T)*P,e[6]=(g*b-f*S-y*v)*P,e[7]=(u*S-d*b+p*v)*P,e[8]=(a*I-s*A+c*E)*P,e[9]=(n*A-r*I-o*E)*P,e[10]=(f*x-m*b+y*_)*P,e[11]=(h*b-u*x-p*_)*P,e[12]=(s*T-a*C-l*E)*P,e[13]=(r*C-n*T+i*E)*P,e[14]=(m*v-f*w-g*_)*P,e[15]=(u*w-h*v+d*_)*P,e):null},e.aC=C,e.aD=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},e.aE=function(e){return e[0]=0,e[1]=0,e},e.aF=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},e.aG=ch,e.aH=E,e.aI=function(e,t,n,i){const o=t.y-e.y,a=t.x-e.x,s=i.y-n.y,l=i.x-n.x,c=s*a-l*o;if(0===c)return null;const u=(l*(e.y-n.y)-s*(e.x-n.x))/c;return new r(e.x+u*a,e.y+u*o)},e.aJ=Up,e.aK=Gs,e.aL=function(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const o of e)t=Math.min(t,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return[t,r,n,i]},e.aM=fu,e.aN=P,e.aO=function(e,t,r,n,i=!1){if(!r[0]&&!r[1])return[0,0];const o=i?"map"===n?-e.bearingInRadians:0:"viewport"===n?e.bearingInRadians:0;if(o){const e=Math.sin(o),t=Math.cos(o);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}return[i?r[0]:P(t,r[0],e.zoom),i?r[1]:P(t,r[1],e.zoom)]},e.aQ=ah,e.aR=_f,e.aS=Hu,e.aT=Ef,e.aU=ia,e.aV=dc,e.aW=ja,e.aX=os,e.aY=ts,e.aZ=te,e.a_=Oh,e.aa=Vh,e.ab=25,e.ac=$h,e.ad=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const n of e){const e=window.document.createElement("source");pe(n)||(t.crossOrigin="Anonymous"),e.src=n,t.appendChild(e)}}))},e.ae=Me,e.af=function(){return F++},e.ag=Ma,e.ah=ph,e.ai=Rp,e.aj=pi,e.ak=Ns,e.al=Wh,e.am=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>{const o=n||i;return t[r]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.an=B,e.ao=85.051129,e.ap=ee,e.aq=function(e){return Math.pow(2,e)},e.ar=m,e.as=Mh,e.at=function(e){return Math.log(e)/Math.LN2},e.au=function(e){var t=e[0],r=e[1];return t*t+r*r},e.av=function(e){if(!e.length)return new Set;const t=Math.max(...e.map((e=>e.canonical.z)));let r=1/0,n=-1/0,i=1/0,o=-1/0;const a=[];for(const l of e){const{x:e,y:s,z:c}=l.canonical,u=Math.pow(2,t-c),h=e*u,d=s*u;a.push({id:l,x:h,y:d}),h<r&&(r=h),h>n&&(n=h),d<i&&(i=d),d>o&&(o=d)}const s=new Set;for(const l of a)l.x!==r&&l.x!==n&&l.y!==i&&l.y!==o||s.add(l.id);return s},e.aw=function(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x},e.ax=class{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const r of t)this.remove(r.value.tileID,r)}},e.ay=function(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:o,maxZoom:a}=e,s=i?B(pr.interpolationFactor(i,t,o,a),0,1):0;"camera"===e.kind?n=mr.number(e.minSize,e.maxSize,s):r=s}return{uSizeT:r,uSize:n}},e.b=Z,e.b$=Es,e.b0=v,e.b1=function(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.b2=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.b3=function(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e},e.b4=w,e.b5=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.b6=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.b7=y,e.b8=function(e,t,r){const n=t[0]*r[0]+t[1]*r[1]+t[2]*r[2];return 0===n?null:(-(e[0]*r[0]+e[1]*r[1]+e[2]*r[2])-r[3])/n},e.b9=S,e.bA=function(){return new Float64Array(3)},e.bB=A,e.bC=function(e,t,r){var n=r[0],i=r[1],o=r[2],a=r[3],s=t[0],l=t[1],c=t[2],u=i*c-o*l,h=o*s-n*c,d=n*l-i*s;return e[0]=s+a*(u+=u)+i*(d+=d)-o*(h+=h),e[1]=l+a*h+o*u-n*d,e[2]=c+a*d+n*h-i*u,e},e.bD=function(e,t,r){const n=(i=[e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2]])[0]*((u=i[8])*(a=i[4])-(s=i[5])*(c=i[7]))+i[1]*(-u*(o=i[3])+s*(l=i[6]))+i[2]*(c*o-a*l);var i,o,a,s,l,c,u;if(0===n)return null;const h=w([],[t[0],t[1],t[2]],[r[0],r[1],r[2]]),d=w([],[r[0],r[1],r[2]],[e[0],e[1],e[2]]),p=w([],[e[0],e[1],e[2]],[t[0],t[1],t[2]]),f=b([],h,-e[3]);return v(f,f,b([],d,-t[3])),v(f,f,b([],p,-r[3])),b(f,f,1/n),f},e.bE=Th,e.bF=function(){return new Float64Array(4)},e.bG=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},e.bH=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},e.bI=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},e.bJ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-u*n,e[2]=s*i-h*n,e[3]=l*i-d*n,e[8]=o*n+c*i,e[9]=a*n+u*i,e[10]=s*n+h*i,e[11]=l*n+d*i,e},e.bK=function(e,t){const r=M(e,360),n=M(t,360),i=n-r,o=n>r?i-360:i+360;return Math.abs(i)<Math.abs(o)?i:o},e.bL=function(e){return e[0]=0,e[1]=0,e[2]=0,e},e.bM=function(e,t,r,n){const i=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+n*n);e/=i,t/=i,r/=o,n/=o;const a=Math.acos(e*r+t*n);return-t*r+e*n>0?a:-a},e.bN=function(e,t){const r=M(e,2*Math.PI),n=M(t,2*Math.PI);return Math.min(Math.abs(r-n),Math.abs(r-n+2*Math.PI),Math.abs(r-n-2*Math.PI))},e.bO=function(){const e={},t=ve.$version;for(const r in ve.$root){const n=ve.$root[r];if(n.required){let i=null;i="version"===r?t:"array"===n.type?[]:{},null!=i&&(e[r]=i)}}return e},e.bP=he,e.bQ=vo,e.bR=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(!e(t[n],r[n]))return!1;return!0}return t===r},e.bS=function(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=we(e[r],t[e[r].ref]));return e},e.bT=function(e,t){if("custom"===e.type)return new xh(e,t);switch(e.type){case"background":return new wh(e,t);case"circle":return new ml(e,t);case"color-relief":return new Ll(e,t);case"fill":return new Tc(e,t);case"fill-extrusion":return new Gc(e,t);case"heatmap":return new Al(e,t);case"hillshade":return new kl(e,t);case"line":return new au(e,t);case"raster":return new ea(e,t);case"symbol":return new _h(e,t)}},e.bU=e=>"raster"===e.type,e.bV=j,e.bW=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let r=[];try{if(!xe(e.version,t.version))return[{command:"setStyle",args:[t]}];xe(e.center,t.center)||r.push({command:"setCenter",args:[t.center]}),xe(e.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),xe(e.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),xe(e.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),xe(e.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),xe(e.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),xe(e.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),xe(e.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),xe(e.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),xe(e.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),xe(e.light,t.light)||r.push({command:"setLight",args:[t.light]}),xe(e.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),xe(e.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),xe(e.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const n={},i=[];!function(e,t,r,n){let i;for(i in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)||Te(i,r,n));for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)?xe(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&Ce(e,t,i)?Se(r,{command:"setGeoJSONSourceData",args:[i,t[i].data]}):Ae(i,t,r,n)):Ee(i,t,r))}(e.sources,t.sources,i,n);const o=[];e.layers&&e.layers.forEach((e=>{"source"in e&&n[e.source]?r.push({command:"removeLayer",args:[e.id]}):o.push(e)})),r=r.concat(i),function(e,t,r){t=t||[];const n=(e=e||[]).map(ke),i=t.map(ke),o=e.reduce(Pe,{}),a=t.reduce(Pe,{}),s=n.slice(),l=Object.create(null);let c,u,h,d,p;for(let f=0,m=0;f<n.length;f++)c=n[f],Object.prototype.hasOwnProperty.call(a,c)?m++:(Se(r,{command:"removeLayer",args:[c]}),s.splice(s.indexOf(c,m),1));for(let f=0,m=0;f<i.length;f++)c=i[i.length-1-f],s[s.length-1-f]!==c&&(Object.prototype.hasOwnProperty.call(o,c)?(Se(r,{command:"removeLayer",args:[c]}),s.splice(s.lastIndexOf(c,s.length-m),1)):m++,d=s[s.length-f],Se(r,{command:"addLayer",args:[a[c],d]}),s.splice(s.length-f,0,c),l[c]=!0);for(let f=0;f<i.length;f++)if(c=i[f],u=o[c],h=a[c],!l[c]&&!xe(u,h))if(xe(u.source,h.source)&&xe(u["source-layer"],h["source-layer"])&&xe(u.type,h.type)){for(p in Ie(u.layout,h.layout,r,c,null,"setLayoutProperty"),Ie(u.paint,h.paint,r,c,null,"setPaintProperty"),xe(u.filter,h.filter)||Se(r,{command:"setFilter",args:[c,h.filter]}),xe(u.minzoom,h.minzoom)&&xe(u.maxzoom,h.maxzoom)||Se(r,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?Ie(u[p],h[p],r,c,p.slice(6),"setPaintProperty"):xe(u[p],h[p])||Se(r,{command:"setLayerProperty",args:[c,p,h[p]]}));for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&!Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?Ie(u[p],h[p],r,c,p.slice(6),"setPaintProperty"):xe(u[p],h[p])||Se(r,{command:"setLayerProperty",args:[c,p,h[p]]}))}else Se(r,{command:"removeLayer",args:[c]}),d=s[s.lastIndexOf(c)+1],Se(r,{command:"addLayer",args:[h,d]})}(o,t.layers,r)}catch(n){r=[{command:"setStyle",args:[t]}]}return r},e.bX=function(e){const t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.bY=q,e.bZ=N,e.b_=class extends ws{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.ba=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.bb=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},e.bc=zh,e.bd=qh,e.be=function(e,t,r,n,i){var o=1/Math.tan(t/2);if(e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){var a=1/(n-i);e[10]=(i+n)*a,e[14]=2*i*n*a}else e[10]=-1,e[14]=-2*n;return e},e.bf=function(e){var t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.bg=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+u*n,e[2]=s*i+h*n,e[3]=l*i+d*n,e[4]=c*i-o*n,e[5]=u*i-a*n,e[6]=h*i-s*n,e[7]=d*i-l*n,e},e.bh=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+u*n,e[6]=s*i+h*n,e[7]=l*i+d*n,e[8]=c*i-o*n,e[9]=u*i-a*n,e[10]=h*i-s*n,e[11]=d*i-l*n,e},e.bi=function(){const e=new Float32Array(16);return m(e),e},e.bj=function(){const e=new Float64Array(16);return m(e),e},e.bk=function(){return new Float64Array(16)},e.bl=function(e,t,r){const n=new Float64Array(4);return A(n,e,t-90,r),n},e.bm=function(e,t,r,n){var i,o,a,s,l,c=t[0],u=t[1],h=t[2],p=t[3],f=r[0],m=r[1],g=r[2],y=r[3];return(o=c*f+u*m+h*g+p*y)<0&&(o=-o,f=-f,m=-m,g=-g,y=-y),1-o>d?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-n)*i)/a,l=Math.sin(n*i)/a):(s=1-n,l=n),e[0]=s*c+l*f,e[1]=s*u+l*m,e[2]=s*h+l*g,e[3]=s*p+l*y,e},e.bn=function(e){const t=new Float64Array(9);var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v;h=(i=(n=e)[0])*(l=i+i),d=(o=n[1])*l,f=(a=n[2])*l,m=a*(c=o+o),y=(s=n[3])*l,_=s*c,v=s*(u=a+a),(r=t)[0]=1-(p=o*c)-(g=a*u),r[3]=d-v,r[6]=f+_,r[1]=d+v,r[4]=1-h-g,r[7]=m-y,r[2]=f-_,r[5]=m+y,r[8]=1-h-p;const b=te(-Math.asin(B(t[2],-1,1)));let w,x;return Math.hypot(t[5],t[8])<.001?(w=0,x=-te(Math.atan2(t[3],t[4]))):(w=te(0===t[5]&&0===t[8]?0:Math.atan2(t[5],t[8])),x=te(0===t[1]&&0===t[0]?0:Math.atan2(t[1],t[0]))),{roll:w,pitch:b+90,bearing:x}},e.bo=function(e,t){return e.roll==t.roll&&e.pitch==t.pitch&&e.bearing==t.bearing},e.bp=Ct,e.bq=xs,e.br=pc,e.bs=fc,e.bt=hc,e.bu=R,e.bv=D,e.bw=Ft,e.bx=function(e,t,r,n,i){return R(n,i,B((e-t)/(r-t),0,1))},e.by=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},e.bz=M,e.c=se,e.c$=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.c0=class extends ws{constructor(e,t){super(e,t),this.current=Ts}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.c1=Ss,e.c2=class extends ws{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.c3=class extends ws{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.c4=f,e.c5=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.c6=function(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e},e.c7=function(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(a+o)*c,e[15]=1,e},e.c8=class extends ws{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(4*e.length);for(let r=0;r<e.length;r++)t[4*r]=e[r].r,t[4*r+1]=e[r].g,t[4*r+2]=e[r].b,t[4*r+3]=e[r].a;this.gl.uniform4fv(this.location,t)}}},e.c9=class extends ws{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(e);this.gl.uniform1fv(this.location,t)}}},e.cA=function(e,t){var r;if(!ne[t])return!1;const n=null==e?void 0:e.target,i=(null===(r=null==n?void 0:n.ownerDocument)||void 0===r?void 0:r.defaultView)||window;return e instanceof i.MouseEvent||e instanceof i.WheelEvent},e.cB=function(e,t){return re[t]&&"touches"in e},e.cC=function(e){return re[e]||ne[e]},e.cD=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},e.cE=function(e,t){const{x:r,y:n}=Lh.fromLngLat(t);return!(e<0||e>25||n<0||n>=1||r<0||r>=1)},e.cF=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.cG=class extends sa{},e.cH=Bf,e.cJ=ue,e.cK=function(e,t){se.REGISTERED_PROTOCOLS[e]=t},e.cL=function(e){delete se.REGISTERED_PROTOCOLS[e]},e.cM=function(e,t){const r={};for(let i=0;i<e.length;i++){const n=t&&t[e[i].id]||xi(e[i]);t&&(t[e[i].id]=n);let o=r[n];o||(o=r[n]=[]),o.push(e[i])}const n=[];for(const i in r)n.push(r[i]);return n},e.cN=po,e.cO=Gh,e.cP=qp,e.cQ=Vu,e.cR=function(t){var r;t.bucket.createArrays(),t.bucket.tilePixelRatio=k/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const n=t.bucket.layers[0],i=n.layout,o=n._unevaluatedLayout._values,a={layoutIconSize:o["icon-size"].possiblyEvaluate(new Oo(t.bucket.zoom+1),t.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Oo(t.bucket.zoom+1),t.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Oo(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.textSizeData;a.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Oo(e),t.canonical),o["text-size"].possiblyEvaluate(new Oo(r),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.iconSizeData;a.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Oo(e),t.canonical),o["icon-size"].possiblyEvaluate(new Oo(r),t.canonical)]}const s=i.get("text-line-height")*fu,l="viewport"!==i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),c=i.get("text-keep-upright"),u=i.get("text-size");for(const h of t.bucket.features){const o=i.get("text-font").evaluate(h,{},t.canonical).join(","),d=u.evaluate(h,{},t.canonical),p=a.layoutTextSize.evaluate(h,{},t.canonical),f=a.layoutIconSize.evaluate(h,{},t.canonical),m={horizontal:{},vertical:void 0},g=h.text;let y,_=[0,0];if(g){const r=g.toString(),a=i.get("text-letter-spacing").evaluate(h,{},t.canonical)*fu,u=Eo(r)?a:0,f=i.get("text-anchor").evaluate(h,{},t.canonical),y=yf(n,h,t.canonical);if(!y){const e=i.get("text-radial-offset").evaluate(h,{},t.canonical);_=e?gf(f,[e*fu,mf]):i.get("text-offset").evaluate(h,{},t.canonical).map((e=>e*fu))}let v=l?"center":i.get("text-justify").evaluate(h,{},t.canonical);const b="point"===i.get("symbol-placement")?i.get("text-max-width").evaluate(h,{},t.canonical)*fu:1/0,w=()=>{t.bucket.allowVerticalPlacement&&So(r)&&(m.vertical=Wu(g,t.glyphMap,t.glyphPositions,t.imagePositions,o,b,s,f,"left",u,_,e.az.vertical,!0,p,d))};if(!l&&y){const r=new Set;if("auto"===v)for(let e=0;e<y.values.length;e+=2)r.add(_f(y.values[e]));else r.add(v);let n=!1;for(const i of r)if(!m.horizontal[i])if(n)m.horizontal[i]=m.horizontal[0];else{const r=Wu(g,t.glyphMap,t.glyphPositions,t.imagePositions,o,b,s,"center",i,u,_,e.az.horizontal,!1,p,d);r&&(m.horizontal[i]=r,n=1===r.positionedLines.length)}w()}else{"auto"===v&&(v=_f(f));const n=Wu(g,t.glyphMap,t.glyphPositions,t.imagePositions,o,b,s,f,v,u,_,e.az.horizontal,!1,p,d);n&&(m.horizontal[v]=n),w(),So(r)&&l&&c&&(m.vertical=Wu(g,t.glyphMap,t.glyphPositions,t.imagePositions,o,b,s,f,v,u,_,e.az.vertical,!1,p,d))}}let v=!1;if(h.icon&&h.icon.name){const e=t.imageMap[h.icon.name];e&&(y=eh(t.imagePositions[h.icon.name],i.get("icon-offset").evaluate(h,{},t.canonical),i.get("icon-anchor").evaluate(h,{},t.canonical)),v=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=v:t.bucket.sdfIcons!==v&&V("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==i.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const b=wf(m.horizontal)||m.vertical;(r=t.bucket).iconsInText||(r.iconsInText=!!b&&b.iconsInText),(b||y)&&vf(t.bucket,h,m,y,t.imageMap,a,p,f,_,v,t.canonical,t.subdivisionGranularity)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.cS=wc,e.cT=Fc,e.cU=eu,e.cV=function(e){const t=new Cu;return function(e,t){for(const r in e.layers)t.writeMessage(3,Dp,e.layers[r])}(e,t),t.finish()},e.cW=function(e,t,r,n,i,o){let a=Vp(e,t,r,i,0);return a=Vp(a,t,n,o,1),a},e.cX=class{constructor(e){this.maxEntries=e,this.map=new Map}get(e){const t=this.map.get(e);return void 0!==t&&(this.map.delete(e),this.map.set(e,t)),t}set(e,t){if(this.map.has(e))this.map.delete(e);else if(this.map.size>=this.maxEntries){const e=this.map.keys().next().value;this.map.delete(e)}this.map.set(e,t)}clear(){this.map.clear()}},e.cY=Lc,e.cZ=Cu,e.c_=Pp,e.ca=class extends va{},e.cb=du,e.cc=class extends wa{},e.cd=Tl,e.ce=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.cf=El,e.cg=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/(a=a||1),e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e},e.ch=class extends la{},e.ci=class extends Ia{},e.cj=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.ck=function(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],_=e[15],v=t[0],b=t[1],w=t[2],x=t[3],S=t[4],E=t[5],T=t[6],A=t[7],C=t[8],I=t[9],k=t[10],P=t[11],M=t[12],R=t[13],D=t[14],O=t[15];return Math.abs(r-v)<=d*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-b)<=d*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-w)<=d*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-x)<=d*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-S)<=d*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-E)<=d*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(l-T)<=d*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-A)<=d*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-C)<=d*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-I)<=d*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(p-k)<=d*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(f-P)<=d*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(m-M)<=d*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-R)<=d*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(y-D)<=d*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(_-O)<=d*Math.max(1,Math.abs(_),Math.abs(O))},e.cl=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.cm=e=>"symbol"===e.type,e.cn=e=>"circle"===e.type,e.co=e=>"heatmap"===e.type,e.cp=e=>"line"===e.type,e.cq=e=>"fill"===e.type,e.cr=e=>"fill-extrusion"===e.type,e.cs=e=>"hillshade"===e.type,e.ct=e=>"color-relief"===e.type,e.cu=e=>"background"===e.type,e.cv=e=>"custom"===e.type,e.cw=O,e.cx=function(e,t,r){if(t<=0)return e;const n=1/t;return void 0===r||Math.abs(r)<1e-10?Math.round(e*n)/n:(r>0?Math.ceil(e*n-1e-9):Math.floor(e*n+1e-10))/n},e.cy=function(e,t,r){const n=I(t.x-r.x,t.y-r.y),i=I(e.x-r.x,e.y-r.y);var o,a;return te(Math.atan2(n[0]*i[1]-n[1]*i[0],(o=n)[0]*(a=i)[0]+o[1]*a[1]))},e.cz=L,e.d=pe,e.d0=function(e,r,n,i,o){return t(this,void 0,void 0,(function*(){if(h())try{return yield X(e,r,n,i,o)}catch(t){}return function(e,t,r,n,i){const o=e.width,a=e.height;K&&Q||(K=new OffscreenCanvas(o,a),Q=K.getContext("2d",{willReadFrequently:!0})),K.width=o,K.height=a,Q.drawImage(e,0,0,o,a);const s=Q.getImageData(t,r,n,i);return Q.clearRect(0,0,o,a),s.data}(e,r,n,i,o)}))},e.d1=Dl,e.d2=n,e.d3=class{constructor(e,t){this.layers={[Rp]:this},this.name=Rp,this.version=t?t.version:1,this.extent=t?t.extent:4096,this.length=e.length,this.features=e}feature(e){return new Mp(this.features[e],this.extent)}},e.d4=ni,e.d5=Do,e.e=z,e.f=e=>t(void 0,void 0,void 0,(function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.g=le,e.h=e=>new Promise(((t,r)=>{const n=new Image;n.onload=()=>{t(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((()=>{n.src=Y}))},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?URL.createObjectURL(i):Y})),e.i=W,e.j=(e,t)=>de(z(e,{type:"json"}),t),e.k=ye,e.l=ge,e.m=de,e.n=(e,t)=>de(z(e,{type:"arrayBuffer"}),t),e.o=function(e){return new Cu(e).readFields(Fu,[])},e.p=ju,e.q=function(e){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(e))},e.r=xl,e.s=J,e.t=Xo,e.u=ve,e.v=no,e.w=V,e.x=Fo,e.y=oo,e.z=Bo})),r("worker",["./shared"],(function(e){class t{constructor(e,t){this.keyCache={},e&&this.replace(e,t)}replace(e,t){this._layerConfigs={},this._layers={},this.update(e,[],t)}update(t,r,n){for(const o of t){this._layerConfigs[o.id]=o;const t=this._layers[o.id]=e.bT(o,n);t._featureFilter=e.aj(t.filter,n),this.keyCache[o.id]&&delete this.keyCache[o.id]}for(const e of r)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const i=e.cM(Object.values(this._layerConfigs),this.keyCache);for(const o of i){const t=o.map((e=>this._layers[e.id])),r=t[0];if(r.isHidden())continue;const n=r.source||"";let i=this.familiesBySource[n];i||(i=this.familiesBySource[n]={});const a=r.sourceLayer||e.ai;let s=i[a];s||(s=i[a]=[]),s.push(t)}}}class r{constructor(t){const r={},n=[];for(const e in t){const i=t[e],o=r[e]={};for(const e in i){const t=i[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const r={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};n.push(r),o[e]={rect:r,metrics:t.metrics}}}const{w:i,h:o}=e.p(n),a=new e.r({width:i||1,height:o||1});for(const s in t){const n=t[s];for(const t in n){const i=n[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const o=r[s][t].rect;e.r.copy(i.bitmap,a,{x:0,y:0},{x:o.x+1,y:o.y+1},i.bitmap)}}this.image=a,this.positions=r}}e.cN("GlyphAtlas",r);class n{constructor(t){this.tileID=new e.a2(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,n,o,a,s){return e._(this,void 0,void 0,(function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.ag;const l=new e.cO(Object.keys(t.layers).sort()),c=new e.cP(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:o,subdivisionGranularity:s},d=n.familiesBySource[this.source];for(const r in d){const n=t.layers[r];if(!n)continue;1===n.version&&e.w(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const a=l.encode(r),s=[];for(let e=0;e<n.length;e++){const t=n.feature(e),i=c.getId(t,r);s.push({feature:t,id:i,index:e,sourceLayerIndex:a})}for(const t of d[r]){const r=t[0];r.source!==this.source&&e.w(`layer.source = ${r.source} does not equal this.source = ${this.source}`),r.isHidden(this.zoom,!0)||(i(t,this.zoom,o),(u[r.id]=r.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:a,sourceID:this.source})).populate(s,h,this.tileID.canonical),c.bucketLayerIDs.push(t.map((e=>e.id))))}}const p=e.bY(h.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.abort())),this.inFlightDependencies=[];let f=Promise.resolve({});if(Object.keys(p).length){const e=new AbortController;this.inFlightDependencies.push(e),f=a.sendAsync({type:"GG",data:{stacks:p,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}const m=Object.keys(h.iconDependencies);let g=Promise.resolve({});if(m.length){const e=new AbortController;this.inFlightDependencies.push(e),g=a.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},e)}const y=Object.keys(h.patternDependencies);let _=Promise.resolve({});if(y.length){const e=new AbortController;this.inFlightDependencies.push(e),_=a.sendAsync({type:"GI",data:{icons:y,source:this.source,tileID:this.tileID,type:"patterns"}},e)}const v=h.dashDependencies;let b=Promise.resolve({});if(Object.keys(v).length){const e=new AbortController;this.inFlightDependencies.push(e),b=a.sendAsync({type:"GDA",data:{dashes:v}},e)}const[w,x,S,E]=yield Promise.all([f,g,_,b]),T=new r(w),A=new e.cQ(x,S);for(const t in u){const r=u[t];r instanceof e.ah?(i(r.layers,this.zoom,o),e.cR({bucket:r,glyphMap:w,glyphPositions:T.positions,imageMap:x,imagePositions:A.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:h.subdivisionGranularity})):r.hasDependencies&&(r instanceof e.cS||r instanceof e.cT||r instanceof e.cU)&&(i(r.layers,this.zoom,o),r.addFeatures(h,this.tileID.canonical,A.patternPositions,E))}return this.status="done",{buckets:Object.values(u).filter((e=>!e.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:T.image,imageAtlas:A,dashPositions:E,glyphMap:this.returnDependencies?w:null,iconMap:this.returnDependencies?x:null,glyphPositions:this.returnDependencies?T.positions:null}}))}}function i(t,r,n){const i=new e.H(r);for(const e of t)e.recalculate(i,n)}class o{constructor(e,t,r,n,i){this.type=e,this.properties=r||{},this.extent=i,this.pointsArray=t,this.id=n}loadGeometry(){return this.pointsArray.map((t=>t.map((t=>new e.P(t.x,t.y)))))}}class a{constructor(e,t,r){this.version=2,this._myFeatures=e,this.name=t,this.length=e.length,this.extent=r}feature(e){return this._myFeatures[e]}}class s{constructor(){this.layers={}}addLayer(e){this.layers[e.name]=e}}function l(t){let r=e.cV(t);return 0===r.byteOffset&&r.byteLength===r.buffer.byteLength||(r=new Uint8Array(r)),{vectorTile:t,rawData:r.buffer}}function c(t,r,n){const{extent:i}=t,s=Math.pow(2,n.z-r.z),l=(n.x-r.x*s)*i,c=(n.y-r.y*s)*i,u=[];for(let a=0;a<t.length;a++){const r=t.feature(a);let n=r.loadGeometry();for(const e of n)for(const t of e)t.x=t.x*s-l,t.y=t.y*s-c;const h=128;n=e.cW(n,r.type,-h,-h,i+h,i+h),0!==n.length&&u.push(new o(r.type,n,r.properties,r.id,i))}return new a(u,t.name,i)}class u{constructor(t,r,n){this.actor=t,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new e.cX(1e3)}loadVectorTile(t,r){return e._(this,void 0,void 0,(function*(){const n=yield e.n(t.request,r);try{return{vectorTile:"mlt"!==t.encoding?new e.cY(new e.cZ(n.data)):new e.c_(n.data),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){const e=new Uint8Array(n.data);let r=`Unable to parse the tile at ${t.request.url}, `;throw r+=31===e[0]&&139===e[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${i.message}`,new Error(r)}}))}loadTile(t){return e._(this,void 0,void 0,(function*(){const{uid:r,overzoomParameters:i}=t;i&&(t.request=i.overzoomRequest);const o=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.c$(t.request),a=new n(t);this.loading[r]=a;const s=new AbortController;a.abort=s;try{const n=yield this.loadVectorTile(t,s);if(delete this.loading[r],!n)return null;if(i){const e=this._getOverzoomTile(t,n.vectorTile);n.rawData=e.rawData,n.vectorTile=e.vectorTile}const l=n.rawData,c={};n.expires&&(c.expires=n.expires),n.cacheControl&&(c.cacheControl=n.cacheControl);const u={};if(o){const e=o.finish();e&&(u.resourceTiming=JSON.parse(JSON.stringify(e)))}a.vectorTile=n.vectorTile;const h=a.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);this.loaded[r]=a,this.fetching[r]={rawTileData:l,cacheControl:c,resourceTiming:u};try{const r=yield h;return e.e({rawTileData:l.slice(0),encoding:t.encoding},r,c,u)}finally{delete this.fetching[r]}}catch(l){throw delete this.loading[r],a.status="done",this.loaded[r]=a,l}}))}_getOverzoomTile(e,t){const{tileID:r,source:n,overzoomParameters:i}=e,{maxZoomTileID:o}=i,a=`${o.key}_${r.key}`,u=this.overzoomedTileResultCache.get(a);if(u)return u;const h=new s,d=this.layerIndex.familiesBySource[n];for(const s in d){const e=t.layers[s];if(!e)continue;const n=c(e,o,r.canonical);n.length>0&&h.addLayer(n)}const p=l(h);return this.overzoomedTileResultCache.set(a,p),p}reloadTile(t){return e._(this,void 0,void 0,(function*(){const r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,"parsing"===n.status){const i=yield n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);let o;if(this.fetching[r]){const{rawTileData:n,cacheControl:a,resourceTiming:s}=this.fetching[r];delete this.fetching[r],o=e.e({rawTileData:n.slice(0),encoding:t.encoding},i,a,s)}else o=i;return o}if("done"===n.status&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity)}))}abortTile(t){return e._(this,void 0,void 0,(function*(){const e=this.loading,r=t.uid;e&&e[r]&&e[r].abort&&(e[r].abort.abort(),delete e[r])}))}removeTile(t){return e._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}))}}class h{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,(function*(){const{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=t,c=i.width+2,u=i.height+2,h=e.b(i)?new e.R({width:c,height:u},yield e.d0(i,-1,-1,c,u)):i,d=new e.d1(r,h,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=d,d}))}removeTile(e){const t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}}var d,p,f=function(){if(p)return d;function e(e,r){if(0!==e.length){t(e[0],r);for(var n=1;n<e.length;n++)t(e[n],!r)}}function t(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}return p=1,d=function t(r,n){var i,o=r&&r.type;if("FeatureCollection"===o)for(i=0;i<r.features.length;i++)t(r.features[i],n);else if("GeometryCollection"===o)for(i=0;i<r.geometries.length;i++)t(r.geometries[i],n);else if("Feature"===o)t(r.geometry,n);else if("Polygon"===o)e(r.coordinates,n);else if("MultiPolygon"===o)for(i=0;i<r.coordinates.length;i++)e(r.coordinates[i],n);return r}}(),m=e.d2(f);const g={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},y=Math.fround||(_=new Float32Array(1),e=>(_[0]=+e,_[0]));var _;class v{constructor(e){this.options=Object.assign(Object.create(g),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:r,maxZoom:n}=this.options;e.length,this.points=e;const i=[];for(let a=0;a<e.length;a++){const t=e[a];if(!t.geometry)continue;const[r,n]=t.geometry.coordinates,o=y(x(r)),s=y(S(n));i.push(o,s,1/0,a,-1,1),this.options.reduce&&i.push(0)}let o=this.trees[n+1]=this._createTree(i);for(let a=n;a>=r;a--)Date.now(),o=this.trees[a]=this._createTree(this._cluster(o,a));return this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,o],t),a=this.getClusters([-180,n,i,o],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(x(r),S(o),x(i),S(n)),l=a.data,c=[];for(const u of s){const e=this.stride*u;c.push(l[e+5]>1?b(l,e,this.clusterProps):this.points[l[e+3]])}return c}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const o=i.data;if(t*this.stride>=o.length)throw new Error(n);const a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(o[t*this.stride],o[t*this.stride+1],a),l=[];for(const c of s){const t=c*this.stride;o[t+4]===e&&l.push(o[t+5]>1?b(o,t,this.clusterProps):this.points[o[t+3]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,r){const n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:a}=this.options,s=a/o,l=(r-s)/i,c=(r+1+s)/i,u={features:[]};return this._addTileFeatures(n.range((t-s)/i,l,(t+1+s)/i,c),n.data,t,r,i,u),0===t&&this._addTileFeatures(n.range(1-s/i,l,1,c),n.data,i,r,i,u),t===i-1&&this._addTileFeatures(n.range(0,l,s/i,c),n.data,-1,r,i,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const o=this.getChildren(t);for(const a of o){const t=a.properties;if(t&&t.cluster?i+t.point_count<=n?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,r,n,i):i<n?i++:e.push(a),e.length===r)break}return i}_createTree(t){const r=new e.aT(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)r.add(t[e],t[e+1]);return r.finish(),r.data=t,r}_addTileFeatures(e,t,r,n,i,o){for(const a of e){const e=a*this.stride,s=t[e+5]>1;let l,c,u;if(s)l=w(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const r=this.points[t[e+3]];l=r.properties;const[n,i]=r.geometry.coordinates;c=x(n),u=S(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-r)),Math.round(this.options.extent*(u*i-n))]],tags:l};let d;d=s||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:r,extent:n,reduce:i,minPoints:o}=this.options,a=r/(n*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let u=0;u<s.length;u+=c){if(s[u+2]<=t)continue;s[u+2]=t;const r=s[u],n=s[u+1],h=e.within(s[u],s[u+1],a),d=s[u+5];let p=d;for(const e of h){const r=e*c;s[r+2]>t&&(p+=s[r+5])}if(p>d&&p>=o){let e,o=r*d,a=n*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const r of h){const n=r*c;if(s[n+2]<=t)continue;s[n+2]=t;const l=s[n+5];o+=s[n]*l,a+=s[n+1]*l,s[n+4]=m,i&&(e||(e=this._map(s,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,n)))}s[u+4]=m,l.push(o/p,a/p,1/0,m,-1,p),i&&l.push(f)}else{for(let e=0;e<c;e++)l.push(s[u+e]);if(p>1)for(const e of h){const r=e*c;if(!(s[r+2]<=t)){s[r+2]=t;for(let e=0;e<c;e++)l.push(s[r+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){const n=this.clusterProps[e[t+6]];return r?Object.assign({},n):n}const n=this.points[e[t+3]].properties,i=this.options.map(n);return r&&i===n?Object.assign({},i):i}}function b(e,t,r){return{type:"Feature",id:e[t+3],properties:w(e,t,r),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),E(e[t+1])]}};var n}function w(e,t,r){const n=e[t+5],i=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,o=e[t+6],a=-1===o?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:i})}function x(e){return e/360+.5}function S(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function E(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function T(e,t,r,n){let i=n;const o=t+(r-t>>1);let a,s=r-t;const l=e[t],c=e[t+1],u=e[r],h=e[r+1];for(let d=t+3;d<r;d+=3){const t=A(e[d],e[d+1],l,c,u,h);if(t>i)a=d,i=t;else if(t===i){const e=Math.abs(d-o);e<s&&(a=d,s=e)}}i>n&&(a-t>3&&T(e,t,a,n),e[a+2]=i,r-a>3&&T(e,a,r,n))}function A(e,t,r,n,i,o){let a=i-r,s=o-n;if(0!==a||0!==s){const l=((e-r)*a+(t-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=e-r,s=t-n,a*a+s*s}function C(e,t,r,n){const i={type:t,geom:r},o={id:null==e?null:e,type:i.type,geometry:i.geom,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(i.type){case"Point":case"MultiPoint":case"LineString":I(o,i.geom);break;case"Polygon":I(o,i.geom[0]);break;case"MultiLineString":for(const e of i.geom)I(o,e);break;case"MultiPolygon":for(const e of i.geom)I(o,e[0])}return o}function I(e,t){for(let r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function k(e,t){const r=[];switch(e.type){case"FeatureCollection":for(let n=0;n<e.features.length;n++)P(r,e.features[n],t,n);break;case"Feature":P(r,e,t);break;default:P(r,{geometry:e,properties:void 0},t)}return r}function P(e,t,r,n){if(!t.geometry)return;if("GeometryCollection"===t.geometry.type){for(const i of t.geometry.geometries)P(e,{id:t.id,geometry:i,properties:t.properties},r,n);return}const i=t.geometry.coordinates;if(!i?.length)return;const o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);let a=t.id;switch(r.promoteId?a=t.properties?.[r.promoteId]:r.generateId&&(a=n||0),t.geometry.type){case"Point":{const r=[];return M(t.geometry.coordinates,r),void e.push(C(a,t.geometry.type,r,t.properties))}case"MultiPoint":{const r=[];for(const e of t.geometry.coordinates)M(e,r);return void e.push(C(a,t.geometry.type,r,t.properties))}case"LineString":{const r=[];return R(t.geometry.coordinates,r,o,!1),void e.push(C(a,t.geometry.type,r,t.properties))}case"MultiLineString":{if(r.lineMetrics){for(const r of t.geometry.coordinates){const n=[];R(r,n,o,!1),e.push(C(a,"LineString",n,t.properties))}return}const n=[];return D(t.geometry.coordinates,n,o,!1),void e.push(C(a,t.geometry.type,n,t.properties))}case"Polygon":{const r=[];return D(t.geometry.coordinates,r,o,!0),void e.push(C(a,t.geometry.type,r,t.properties))}case"MultiPolygon":{const r=[];for(const e of t.geometry.coordinates){const t=[];D(e,t,o,!0),r.push(t)}return void e.push(C(a,t.geometry.type,r,t.properties))}default:throw new Error("Input data is not a valid GeoJSON object.")}}function M(e,t){t.push(O(e[0]),L(e[1]),0)}function R(e,t,r,n){let i,o,a=0;for(let l=0;l<e.length;l++){const r=O(e[l][0]),s=L(e[l][1]);t.push(r,s,0),l>0&&(a+=n?(i*s-r*o)/2:Math.sqrt(Math.pow(r-i,2)+Math.pow(s-o,2))),i=r,o=s}const s=t.length-3;t[2]=1,r>0&&T(t,0,s,r),t[s+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function D(e,t,r,n){for(let i=0;i<e.length;i++){const o=[];R(e[i],o,r,n),t.push(o)}}function O(e){return e/360+.5}function L(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function B(e,t,r,n,i,o,a,s){if(n/=t,o>=(r/=t)&&a<n)return e;if(a<r||o>=n)return null;const l=[];for(const c of e){const e=0===i?c.minX:c.minY,t=0===i?c.maxX:c.maxY;if(e>=r&&t<n)l.push(c);else if(!(t<r||e>=n))switch(c.type){case"Point":case"MultiPoint":{const e=[];if($(c.geometry,e,r,n,i),!e.length)continue;l.push(C(c.id,3===e.length?"Point":"MultiPoint",e,c.tags));continue}case"LineString":{const e=[];if(z(c.geometry,e,r,n,i,!1,s.lineMetrics),!e.length)continue;if(s.lineMetrics){for(const t of e)l.push(C(c.id,c.type,t,c.tags));continue}if(e.length>1){l.push(C(c.id,"MultiLineString",e,c.tags));continue}l.push(C(c.id,c.type,e[0],c.tags));continue}case"MultiLineString":{const e=[];if(q(c.geometry,e,r,n,i,!1),!e.length)continue;if(1===e.length){l.push(C(c.id,"LineString",e[0],c.tags));continue}l.push(C(c.id,c.type,e,c.tags));continue}case"Polygon":{const e=[];if(q(c.geometry,e,r,n,i,!0),!e.length)continue;l.push(C(c.id,c.type,e,c.tags));continue}case"MultiPolygon":{const e=[];for(const t of c.geometry){const o=[];q(t,o,r,n,i,!0),o.length&&e.push(o)}if(!e.length)continue;l.push(C(c.id,c.type,e,c.tags));continue}}}return l.length?l:null}function $(e,t,r,n,i){for(let o=0;o<e.length;o+=3){const a=e[o+i];a>=r&&a<=n&&N(t,e[o],e[o+1],e[o+2])}}function z(e,t,r,n,i,o,a){let s=F(e);const l=0===i?j:U;let c,u,h=e.start;for(let g=0;g<e.length-3;g+=3){const d=e[g],p=e[g+1],f=e[g+2],m=e[g+3],y=e[g+4],_=0===i?d:p,v=0===i?m:y;let b=!1;a&&(c=Math.sqrt(Math.pow(d-m,2)+Math.pow(p-y,2))),_<r?v>r&&(u=l(s,d,p,m,y,r),a&&(s.start=h+c*u)):_>n?v<n&&(u=l(s,d,p,m,y,n),a&&(s.start=h+c*u)):N(s,d,p,f),v<r&&_>=r&&(u=l(s,d,p,m,y,r),b=!0),v>n&&_<=n&&(u=l(s,d,p,m,y,n),b=!0),!o&&b&&(a&&(s.end=h+c*u),t.push(s),s=F(e)),a&&(h+=c)}let d=e.length-3;const p=e[d],f=e[d+1],m=0===i?p:f;m>=r&&m<=n&&N(s,p,f,e[d+2]),d=s.length-3,o&&d>=3&&(s[d]!==s[0]||s[d+1]!==s[1])&&N(s,s[0],s[1],s[2]),s.length&&t.push(s)}function F(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function q(e,t,r,n,i,o){for(const a of e)z(a,t,r,n,i,o,!1)}function N(e,t,r,n){e.push(t,r,n)}function j(e,t,r,n,i,o){const a=(o-t)/(n-t);return N(e,o,r+(i-r)*a,1),a}function U(e,t,r,n,i,o){const a=(o-r)/(i-r);return N(e,t+(n-t)*a,o,1),a}function V(e,t){const r=t.buffer/t.extent;let n=e;const i=B(e,1,-1-r,r,0,-1,2,t),o=B(e,1,1-r,2+r,0,-1,2,t);return i||o?(n=B(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=G(i,1).concat(n)),o&&(n=n.concat(G(o,-1))),n):n}function G(e,t){const r=[];for(const n of e)switch(n.type){case"Point":case"MultiPoint":case"LineString":{const e=W(n.geometry,t);r.push(C(n.id,n.type,e,n.tags));continue}case"MultiLineString":case"Polygon":{const e=[];for(const r of n.geometry)e.push(W(r,t));r.push(C(n.id,n.type,e,n.tags));continue}case"MultiPolygon":{const e=[];for(const r of n.geometry){const n=[];for(const e of r)n.push(W(e,t));e.push(n)}r.push(C(n.id,n.type,e,n.tags));continue}}return r}function W(e,t){const r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(let n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function H(e,t){if(e.transformed)return e;const r=1<<e.z,n=e.x,i=e.y;for(const o of e.features){if(1===o.type){const e=[];for(let a=0;a<o.geometry.length;a+=2)e.push(Z(o.geometry[a],o.geometry[a+1],t,r,n,i));o.geometry=e;continue}const e=[];for(const a of o.geometry){const o=[];for(let e=0;e<a.length;e+=2)o.push(Z(a[e],a[e+1],t,r,n,i));e.push(o)}o.geometry=e}return e.transformed=!0,e}function Z(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function Y(e,t,r,n,i){const o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const s of e)X(a,s,o,i);return a}function X(e,t,r,n){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY);let i,o=t.tags||null;switch(t.type){case"Point":case"MultiPoint":{const r=[];for(let n=0;n<t.geometry.length;n+=3)r.push(t.geometry[n],t.geometry[n+1]),e.numPoints++,e.numSimplified++;if(!r.length)return;i={type:1,tags:o,geometry:r};break}case"LineString":{const a=[];if(K(a,t.geometry,e,r,!1,!1),!a.length)return;if(n.lineMetrics){o={};for(const e in t.tags)o[e]=t.tags[e];o.mapbox_clip_start=t.geometry.start/t.geometry.size,o.mapbox_clip_end=t.geometry.end/t.geometry.size}i={type:2,tags:o,geometry:a};break}case"MultiLineString":case"Polygon":{const n=[];for(let i=0;i<t.geometry.length;i++)K(n,t.geometry[i],e,r,"Polygon"===t.type,0===i);if(!n.length)return;i={type:"Polygon"===t.type?3:2,tags:o,geometry:n};break}case"MultiPolygon":{const n=[];for(let i=0;i<t.geometry.length;i++){const o=t.geometry[i];for(let t=0;t<o.length;t++)K(n,o[t],e,r,!0,0===t)}if(!n.length)return;i={type:3,tags:o,geometry:n};break}}null!==t.id&&(i.id=t.id),e.features.push(i)}function K(e,t,r,n,i,o){const a=n*n;if(n>0&&t.size<(i?a:n))return void(r.numPoints+=t.length/3);const s=[];for(let l=0;l<t.length;l+=3)(0===n||t[l+2]>a)&&(r.numSimplified++,s.push(t[l],t[l+1])),r.numPoints++;i&&function(e,t){let r=0;for(let n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(let n=0,i=e.length;n<i/2;n+=2){const t=e[n],r=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=t,e[i-1-n]=r}}(s,o),e.push(s)}function Q(e,t,r){const n=!!t.newGeometry,i=t.removeAllProperties||t.removeProperties?.length>0||t.addOrUpdateProperties?.length>0;if(n){let n=k({type:"FeatureCollection",features:[{type:"Feature",id:e.id,geometry:t.newGeometry,properties:i?J(e.tags,t):e.tags}]},r);return n=V(n,r),n[0]}if(i){const r={...e};return r.tags=J(r.tags,t),r}return null}function J(e,t){if(t.removeAllProperties)return{};const r={...e||{}};if(t.removeProperties)for(const n of t.removeProperties)delete r[n];if(t.addOrUpdateProperties)for(const{key:n,value:i}of t.addOrUpdateProperties)r[n]=i;return r}const ee={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,updateable:!1,debug:0};class te{options;tiles;tileCoords;stats={};total=0;source;constructor(e,t){const r=(t=this.options=Object.assign({},ee,t)).debug;if(t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let n=k(e,t);this.tiles={},this.tileCoords=[],r&&(this.stats={},this.total=0),n=V(n,t),n.length&&this.splitTile(n,0,0,0),t.updateable&&(this.source=n),r&&n.length}splitTile(e,t,r,n,i,o,a){const s=[e,t,r,n],l=this.options,c=l.debug;for(;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();const u=1<<t,h=re(t,r,n);let d=this.tiles[h];if(!d&&(d=this.tiles[h]=Y(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n,id:h}),c)){const e=`z${t}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}if(d.source=e,null==i){if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===i)continue;if(null!=i){const e=i-t;if(r!==o>>e||n!==a>>e)continue}}if(d.source=null,!e.length)continue;const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let y=null,_=null,v=null,b=null;const w=B(e,u,r-p,r+m,0,d.minX,d.maxX,l),x=B(e,u,r+f,r+g,0,d.minX,d.maxX,l);w&&(y=B(w,u,n-p,n+m,1,d.minY,d.maxY,l),_=B(w,u,n+f,n+g,1,d.minY,d.maxY,l)),x&&(v=B(x,u,n-p,n+m,1,d.minY,d.maxY,l),b=B(x,u,n+f,n+g,1,d.minY,d.maxY,l)),s.push(y||[],t+1,2*r,2*n),s.push(_||[],t+1,2*r,2*n+1),s.push(v||[],t+1,2*r+1,2*n),s.push(b||[],t+1,2*r+1,2*n+1)}}getTile(e,t,r){e=+e,t=+t,r=+r;const n=this.options,{extent:i,debug:o}=n;if(e<0||e>24)return null;const a=1<<e,s=re(e,t=t+a&a-1,r);if(this.tiles[s])return H(this.tiles[s],i);let l,c=e,u=t,h=r;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[re(c,u,h)];return l?.source?(this.splitTile(l.source,c,u,h,e,t,r),this.tiles[s]?H(this.tiles[s],i):null):null}invalidateTiles(e){const t=this.options,{debug:r}=t;let n=1/0,i=-1/0,o=1/0,a=-1/0;for(const c of e)n=Math.min(n,c.minX),i=Math.max(i,c.maxX),o=Math.min(o,c.minY),a=Math.max(a,c.maxY);const s=t.buffer/t.extent,l=new Set;for(const c in this.tiles){const t=this.tiles[c],u=1<<t.z,h=(t.x-s)/u,d=(t.x+1+s)/u,p=(t.y-s)/u,f=(t.y+1+s)/u;if(i<h||n>=d||a<p||o>=f)continue;let m=!1;for(const r of e)if(r.maxX>=h&&r.minX<d&&r.maxY>=p&&r.minY<f){m=!0;break}if(m){if(r){const e=`z${t.z}`;this.stats[e]=(this.stats[e]||0)-1,this.total--}delete this.tiles[c],l.add(c)}}l.size&&(this.tileCoords=this.tileCoords.filter((e=>!l.has(e.id))))}updateData(e){const t=this.options,r=t.debug;if(!t.updateable)throw new Error("to update tile geojson `updateable` option must be set to true");const{affected:n,source:i}=function(e,t,r){const n=(i=t)?{removeAll:i.removeAll,remove:new Set(i.remove||[]),add:new Map(i.add?.map((e=>[e.id,e]))),update:new Map(i.update?.map((e=>[e.id,e])))}:{remove:new Set,add:new Map,update:new Map};var i;let o=[];if(n.removeAll&&(o=e,e=[]),n.remove.size||n.add.size){const t=[];for(const r of e){const{id:e}=r;(n.remove.has(e)||n.add.has(e))&&t.push(r)}if(t.length){o.push(...t);const r=new Set(t.map((e=>e.id)));e=e.filter((e=>!r.has(e.id)))}if(n.add.size){let t=k({type:"FeatureCollection",features:Array.from(n.add.values())},r);t=V(t,r),o.push(...t),e.push(...t)}}if(n.update.size)for(const[a,s]of n.update){const t=e.findIndex((e=>e.id===a));if(-1===t)continue;const n=e[t],i=Q(n,s,r);i&&(o.push(n,i),e[t]=i)}return{affected:o,source:e}}(this.source,e,t);if(!n.length)return;this.source=i,this.invalidateTiles(n);const[o,a,s]=[0,0,0],l=Y(this.source,o,a,s,this.options);l.source=this.source;const c=re(o,a,s);if(this.tiles[c]=l,this.tileCoords.push({z:o,x:a,y:s,id:c}),r){const e=`z${o}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}}}function re(e,t,r){return 32*((1<<e)*r+t)+e}class ne extends u{constructor(e,t,r,n=ie){super(e,t,r),this._dataUpdateable=new Map,this._createGeoJSONIndex=n}loadVectorTile(t,r){return e._(this,void 0,void 0,(function*(){const r=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);return n?l(new e.d3(n.features,{version:2,extent:e.a5})):null}))}loadData(t){return e._(this,void 0,void 0,(function*(){var r;null===(r=this._pendingRequest)||void 0===r||r.abort();const n=this._startPerformance(t);this._pendingRequest=new AbortController;try{(!this._pendingData||t.request||t.data||t.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest));const e=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(e,t),this.loaded={};const r={};return t.request&&(r.data=e),this._finishPerformance(n,t,r),r}catch(i){if(delete this._pendingRequest,e.Z(i))return{abandoned:!0};throw i}}))}_startPerformance(t){var r;if(null===(r=null==t?void 0:t.request)||void 0===r?void 0:r.collectResourceTiming)return new e.c$(t.request)}_finishPerformance(e,t,r){if(!e)return;const n=e.finish();n&&(r.resourceTiming={},r.resourceTiming[t.source]=JSON.parse(JSON.stringify(n)))}getData(){return e._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(e){const t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,r){return e._(this,void 0,void 0,(function*(){let e;if(t.request?e=yield this.loadGeoJSONFromUrl(t.request,t.promoteId,r):t.data?e=this._loadGeoJSONFromObject(t.data,t.promoteId):t.dataDiff&&(e=this._loadGeoJSONFromDiff(t.dataDiff,t.promoteId,t.source)),delete this._pendingRequest,"object"!=typeof e)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);return m(e,!0),t.filter&&(e=this._filterGeoJSON(e,t.filter)),e}))}loadGeoJSONFromUrl(t,r,n){return e._(this,void 0,void 0,(function*(){const i=yield e.j(t,n);return this._dataUpdateable=e.a7(i.data,r),i.data}))}_loadGeoJSONFromObject(t,r){return this._dataUpdateable=e.a7(t,r),t}_loadGeoJSONFromDiff(t,r,n){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${n}`);e.a8(this._dataUpdateable,t,r);const i=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(i)}_filterGeoJSON(t,r){const n=e.d4(r,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const i=t.features.filter((e=>n.value.evaluate({zoom:0},e)));return this._toFeatureCollection(i)}_toFeatureCollection(e){return{type:"FeatureCollection",features:e}}removeSource(t){return e._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}function ie(t,r){return r.cluster?new v(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const n={},i={},o={accumulated:null,zoom:0},a={properties:null},s=Object.keys(r);for(const l of s){const[t,o]=r[l],a=e.d4(o),s=e.d4("string"==typeof t?[t,["accumulated"],["get",l]]:t);n[l]=a.value,i[l]=s.value}return t.map=e=>{a.properties=e;const t={};for(const r of s)t[r]=n[r].evaluate(o,a);return t},t.reduce=(e,t)=>{a.properties=t;for(const r of s)o.accumulated=e[r],e[r]=i[r].evaluate(o,a)},t}(r)).load(t.features):(n=t,i=r.geojsonVtOptions,new te(n,i));var n,i}class oe{constructor(t){this.self=t,this.actor=new e.L(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.cK,this.self.removeProtocol=e.cL,this.self.registerRTLTextPlugin=t=>{e.d5.setMethods(t)},this.actor.registerMessageHandler("LDT",((e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t))),this.actor.registerMessageHandler("RDT",((t,r)=>e._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(t,r.source).removeTile(r)})))),this.actor.registerMessageHandler("GCEZ",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterExpansionZoom(r)})))),this.actor.registerMessageHandler("GCC",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterChildren(r)})))),this.actor.registerMessageHandler("GCL",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterLeaves(r)})))),this.actor.registerMessageHandler("LD",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t))),this.actor.registerMessageHandler("GD",((e,t)=>this._getWorkerSource(e,t.type,t.source).getData())),this.actor.registerMessageHandler("LT",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t))),this.actor.registerMessageHandler("RT",((e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t))),this.actor.registerMessageHandler("AT",((e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t))),this.actor.registerMessageHandler("RMT",((e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t))),this.actor.registerMessageHandler("RS",((t,r)=>e._(this,void 0,void 0,(function*(){if(!this.workerSources[t]||!this.workerSources[t][r.type]||!this.workerSources[t][r.type][r.source])return;const e=this.workerSources[t][r.type][r.source];delete this.workerSources[t][r.type][r.source],void 0!==e.removeSource&&e.removeSource(r)})))),this.actor.registerMessageHandler("RM",(t=>e._(this,void 0,void 0,(function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t],this.globalStates.delete(t)})))),this.actor.registerMessageHandler("SR",((t,r)=>e._(this,void 0,void 0,(function*(){this.referrer=r})))),this.actor.registerMessageHandler("SRPS",((e,t)=>this._syncRTLPluginState(e,t))),this.actor.registerMessageHandler("IS",((t,r)=>e._(this,void 0,void 0,(function*(){this.self.importScripts(r)})))),this.actor.registerMessageHandler("SI",((e,t)=>this._setImages(e,t))),this.actor.registerMessageHandler("UL",((t,r)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).update(r.layers,r.removedIds,this._getGlobalState(t))})))),this.actor.registerMessageHandler("UGS",((t,r)=>e._(this,void 0,void 0,(function*(){const e=this._getGlobalState(t);for(const t in r)e[t]=r[t]})))),this.actor.registerMessageHandler("SL",((t,r)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).replace(r,this._getGlobalState(t))}))))}_getGlobalState(e){let t=this.globalStates.get(e);return t||(t={},this.globalStates.set(e,t)),t}_setImages(t,r){return e._(this,void 0,void 0,(function*(){this.availableImages[t]=r;for(const e in this.workerSources[t]){const n=this.workerSources[t][e];for(const e in n)n[e].availableImages=r}}))}_syncRTLPluginState(t,r){return e._(this,void 0,void 0,(function*(){return yield e.d5.syncState(r,this.self.importScripts)}))}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new t),r}_getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={sendAsync:(t,r)=>(t.targetMapId=e,this.actor.sendAsync(t,r))};switch(t){case"vector":this.workerSources[e][t][r]=new u(n,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][r]=new ne(n,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][r]=new this.externalWorkerSourceTypes[t](n,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][r]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new h),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new oe(self)),oe})),r("index",["exports","./shared"],(function(e,t){var r="5.17.0";function n(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}let i,o,a;const s={frame(e,r,n,i){const o=i||window,a=o.requestAnimationFrame((e=>{s(),r(e)})),{unsubscribe:s}=t.s(e.signal,"abort",(()=>{s(),o.cancelAnimationFrame(a),n(new t.a(e.signal.reason))}),!1)},frameAsync(e,t){return new Promise(((r,n)=>{this.frame(e,r,n,t)}))},getImageData(e,t=0){return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height),r},resolveURL:e=>(i||(i=document.createElement("a")),i.href=e,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return void 0!==a?a:!!matchMedia&&(null==o&&(o=matchMedia("(prefers-reduced-motion: reduce)")),o.matches)},set prefersReducedMotion(e){a=e}},l=new class{constructor(){this._realTime="undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return null!==this._frozenAt?this._frozenAt:this._realTime()}setNow(e){this._frozenAt=e}restoreNow(){this._frozenAt=null}isFrozen(){return null!==this._frozenAt}};function c(){return l.getCurrentTime()}class u{static testProp(e){if(!u.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in u.docStyle)return e[t];return e[0]}static create(e,t,r){const n=window.document.createElement(e);return void 0!==t&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){u.docStyle&&u.selectProp&&(u.userSelect=u.docStyle[u.selectProp],u.docStyle[u.selectProp]="none")}static enableDrag(){u.docStyle&&u.selectProp&&(u.docStyle[u.selectProp]=u.userSelect)}static setTransform(e,t){e.style[u.transformProp]=t}static addEventListener(e,t,r,n={}){e.addEventListener(t,r,"passive"in n?n:n.capture)}static removeEventListener(e,t,r,n={}){e.removeEventListener(t,r,"passive"in n?n:n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",u.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",u.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",u.suppressClickInternal,!0)}),0)}static getScale(e){const t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,r,n){const i=r.boundingClientRect;return new t.P((n.clientX-i.left)/r.x-e.clientLeft,(n.clientY-i.top)/r.y-e.clientTop)}static mousePos(e,t){const r=u.getScale(e);return u.getPoint(e,r,t)}static touchPos(e,t){const r=[],n=u.getScale(e);for(let i=0;i<t.length;i++)r.push(u.getPoint(e,n,t[i]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const t=(new DOMParser).parseFromString(e,"text/html").body||document.createElement("body"),r=t.querySelectorAll("script");for(const n of r)n.remove();return u.clean(t),t.innerHTML}static isPossiblyDangerous(e,t){const r=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!r.includes("javascript:")&&!r.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const t=e.children;for(const r of t)u.removeAttributes(r),u.clean(r)}static removeAttributes(e){for(const{name:t,value:r}of e.attributes)u.isPossiblyDangerous(t,r)&&e.removeAttribute(t)}}u.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,u.selectProp=u.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),u.transformProp=u.testProp(["transform","WebkitTransform"]);const h={supported:!1,testSupport:function(e){!f&&p&&(m?g(e):d=e)}};let d,p,f=!1,m=!1;function g(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,p),e.isContextLost())return;h.supported=!0}catch(r){}e.deleteTexture(t),f=!0}var y;"undefined"!=typeof document&&(p=document.createElement("img"),p.onload=()=>{d&&g(d),d=null,m=!0},p.onerror=()=>{f=!0,d=null},p.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let r,n,i,o;e.resetRequestQueue=()=>{r=[],n=0,i=0,o={}},e.addThrottleControl=e=>{const t=i++;return o[t]=e,t},e.removeThrottleControl=e=>{delete o[e],s()},e.getImage=(e,n,i=!0)=>new Promise(((o,a)=>{h.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),r.push({abortController:n,requestParameters:e,supportImageRefresh:i,state:"queued",onError:e=>{a(e)},onSuccess:e=>{o(e)}}),s()}));const a=e=>t._(this,void 0,void 0,(function*(){e.state="running";const{requestParameters:r,supportImageRefresh:i,onError:o,onSuccess:a,abortController:c}=e,u=!1===i&&!t.i(self)&&!t.g(r.url)&&(!r.headers||Object.keys(r.headers).reduce(((e,t)=>e&&"accept"===t),!0));n++;const h=u?l(r,c):t.m(r,c);try{const r=yield h;delete e.abortController,e.state="completed",r.data instanceof HTMLImageElement||t.b(r.data)?a(r):r.data&&a({data:yield(d=r.data,"function"==typeof createImageBitmap?t.f(d):t.h(d)),cacheControl:r.cacheControl,expires:r.expires})}catch(p){delete e.abortController,o(p)}finally{n--,s()}var d})),s=()=>{const e=(()=>{for(const e of Object.keys(o))if(o[e]())return!0;return!1})()?t.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=n;t<e&&r.length>0;t++){const e=r.shift();e.abortController.signal.aborted?t--:a(e)}},l=(e,r)=>new Promise(((n,i)=>{const o=new Image,a=e.url,s=e.credentials;s&&"include"===s?o.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.d(a))&&(o.crossOrigin="anonymous"),r.signal.addEventListener("abort",(()=>{o.src="",i(new t.a(r.signal.reason))})),o.fetchPriority="high",o.onload=()=>{o.onerror=o.onload=null,n({data:o})},o.onerror=()=>{o.onerror=o.onload=null,r.signal.aborted||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},o.src=a}))}(y||(y={})),y.resetRequestQueue();class _{constructor(e){this._transformRequestFn=null!=e?e:null}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function v(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const r=[];for(const{id:n,url:i}of e){const e=`${n}${i}`;-1===r.indexOf(e)&&(r.push(e),t.push({id:n,url:i}))}}return t}function b(e,t,r){try{const n=new URL(e);return n.pathname+=`${t}${r}`,n.toString()}catch(n){throw new Error(`Invalid sprite URL "${e}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function w(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class x extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const e of Object.keys(this.images))this.removeImage(e);this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const e=r.spriteData;r.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),r.spriteData=null}return r}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,r){let n=!0;const i=r.data||r.spriteData;return this._validateStretch(r.stretchX,i&&i.width)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,i&&i.height)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const r=t.spriteData,n=r&&r.width||t.data.width,i=r&&r.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||i<e[1]||e[2]<0||n<e[2]||e[3]<0||i<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){const n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((t,r)=>{let n=!0;if(!this.isLoaded())for(const i of e)this.images[i]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})}))}_getImagesForIds(e){const r={};for(const n of e){let e=this.getImage(n);e||(this.fire(new t.l("styleimagemissing",{id:n})),e=this.getImage(n)),e?r[n]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){const r=this.patterns[e],n=this.getImage(e);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{const r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new t.I(r,n);this.patterns[e]={bin:r,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.T(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:r,h:n}=t.p(e),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const o in this.patterns){const{bin:e}=this.patterns[o],r=e.x+1,n=e.y+1,a=this.getImage(o).data,s=a.width,l=a.height;t.R.copy(a,i,{x:0,y:0},{x:r,y:n},{width:s,height:l}),t.R.copy(a,i,{x:0,y:l-1},{x:r,y:n-1},{width:s,height:1}),t.R.copy(a,i,{x:0,y:0},{x:r,y:n+l},{width:s,height:1}),t.R.copy(a,i,{x:s-1,y:0},{x:r-1,y:n},{width:1,height:l}),t.R.copy(a,i,{x:0,y:0},{x:r+s,y:n},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const e=this.getImage(r);e||t.w(`Image with ID: "${r}" was not found`),w(e)&&this.updateImage(r,e)}}cloneImages(){const e={};for(const t in this.images){const r=this.images[t];e[t]=Object.assign(Object.assign({},r),{data:r.data?r.data.clone():null})}return e}}const S=1e20;function E(e,t,r,n,i,o,a,s,l){for(let c=t;c<t+n;c++)T(e,r*o+c,o,i,a,s,l);for(let c=r;c<r+i;c++)T(e,c*o+t,1,n,a,s,l)}function T(e,t,r,n,i,o,a){o[0]=0,a[0]=-S,a[1]=S,i[0]=e[t];for(let s=1,l=0,c=0;s<n;s++){i[s]=e[t+s*r];const n=s*s;do{const e=o[l];c=(i[s]-i[e]+n-e*e)/(s-e)/2}while(c<=a[l]&&--l>-1);l++,o[l]=s,a[l]=c,a[l+1]=S}for(let s=0,l=0;s<n;s++){for(;a[l+1]<s;)l++;const n=o[l],c=s-n;e[t+s*r]=i[n]+c*c}}const A=t.v.layout_symbol["text-font"].default.join(",");class C{constructor(e,t,r){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={},this.lang=r}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,(function*(){const t=[];for(const i in e)for(const r of e[i])t.push(this._getAndCacheGlyphsPromise(i,r));const r=yield Promise.all(t),n={};for(const{stack:e,id:i,glyph:o}of r)n[e]||(n[e]={}),n[e][i]=o&&{id:o.id,bitmap:o.bitmap.clone(),metrics:o.metrics};return n}))}_getAndCacheGlyphsPromise(e,r){return t._(this,void 0,void 0,(function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=t.glyphs[r];return void 0!==n?{stack:e,id:r,glyph:n}:!this.url||this._charUsesLocalIdeographFontFamily(r)?(n=t.glyphs[r]=this._drawGlyph(t,e,r),{stack:e,id:r,glyph:n}):yield this._downloadAndCacheRangePromise(e,r)}))}_downloadAndCacheRangePromise(e,r){return t._(this,void 0,void 0,(function*(){const t=this.entries[e],n=Math.floor(r/256);if(t.ranges[n])return{stack:e,id:r,glyph:null};if(!t.requests[n]){const r=C.loadGlyphRange(e,n,this.url,this.requestManager);t.requests[n]=r}try{const i=yield t.requests[n];for(const e in i)t.glyphs[+e]=i[+e];return t.ranges[n]=!0,{stack:e,id:r,glyph:i[r]||null}}catch(i){const o=t.glyphs[r]=this._drawGlyph(t,e,r);return this._warnOnMissingGlyphRange(o,n,r,i),{stack:e,id:r,glyph:o}}}))}_warnOnMissingGlyphRange(e,r,n,i){const o=256*r,a=o+255,s=n.toString(16).padStart(4,"0").toUpperCase();t.w(`Unable to load glyph range ${r}, ${o}-${a}. Rendering codepoint U+${s} locally instead. ${i}`)}_charUsesLocalIdeographFontFamily(e){return!!this.localIdeographFontFamily&&t.q(e)}_drawGlyph(e,r,n){const i=r===A&&""!==this.localIdeographFontFamily&&this._charUsesLocalIdeographFontFamily(n),o=i?"ideographTinySDF":"tinySDF";e[o]||(e[o]=this._createTinySDF(i?this.localIdeographFontFamily:r));const a=e[o].draw(String.fromCodePoint(n)),s=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(n));return{id:n,bitmap:new t.r({width:a.width||60,height:a.height||60},a.data),metrics:{width:s?0:a.glyphWidth/2||24,height:a.glyphHeight/2||24,left:a.glyphLeft/2+.5||0,top:a.glyphTop/2-27.5||-8,advance:s?0:a.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(e){const t=e?e.split(","):[];t.push("sans-serif");const r=t.map((e=>/[-\w]+/.test(e)?e:`'${CSS.escape(e)}'`)).join(",");return new C.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:r,fontWeight:this._fontWeight(t[0]),fontStyle:this._fontStyle(t[0]),lang:this.lang})}_fontStyle(e){return/italic/i.test(e)?"italic":/oblique/i.test(e)?"oblique":"normal"}_fontWeight(e){const t={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let r;for(const[n,i]of Object.entries(t))new RegExp(`\\b${n}\\b`,"i").test(e)&&(r=`${i}`);return r}destroy(){for(const e in this.entries){const t=this.entries[e];t.tinySDF&&(t.tinySDF=null),t.ideographTinySDF&&(t.ideographTinySDF=null),t.glyphs={},t.requests={},t.ranges={}}this.entries={}}}C.loadGlyphRange=function(e,r,n,i){return t._(this,void 0,void 0,(function*(){const o=256*r,a=o+255,s=i.transformRequest(n.replace("{fontstack}",e).replace("{range}",`${o}-${a}`),"Glyphs"),l=yield t.n(s,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${r}, ${o}-${a}`);const c={};for(const e of t.o(l.data))c[e.id]=e;return c}))},C.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal",lang:s=null}={}){this.buffer=t,this.cutoff=n,this.radius=r,this.lang=s;const l=this.size=e+4*t,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${e}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),l=Math.min(this.size-this.buffer,a+Math.ceil(n)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:a,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;this.lang&&(f.lang=this.lang),f.clearRect(m,m,s,l),f.fillText(e,m,m+a);const _=f.getImageData(m,m,s,l);y.fill(S,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<s;e++){const t=_.data[4*(v*s+e)+3]/255;if(0===t)continue;const r=(v+m)*c+e+m;if(1===t)y[r]=0,g[r]=S;else{const e=.5-t;y[r]=e>0?e*e:0,g[r]=e<0?e*e:0}}E(y,0,0,c,u,c,this.f,this.v,this.z),E(g,m,m,s,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(y[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class I{constructor(){this.specification=t.u.light.position}possiblyEvaluate(e,r){return t.F(e.expression.evaluate(r))}interpolate(e,r,n){return{x:t.G.number(e.x,r.x,n),y:t.G.number(e.y,r.y,n),z:t.G.number(e.z,r.z,n)}}}let k;class P extends t.E{constructor(e){super(),k=k||new t.t({anchor:new t.D(t.u.light.anchor),position:new I,color:new t.D(t.u.light.color),intensity:new t.D(t.u.light.intensity)}),this._transitionable=new t.x(k,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(t.y,e,r))for(const n in e){const r=e[n];n.endsWith(t.z)?this._transitionable.setTransition(n.slice(0,-t.z.length),r):this._transitionable.setValue(n,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n){return(!n||!1!==n.validate)&&t.B(this,e.call(t.C,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.u}))}}const M=new t.t({"sky-color":new t.D(t.u.sky["sky-color"]),"horizon-color":new t.D(t.u.sky["horizon-color"]),"fog-color":new t.D(t.u.sky["fog-color"]),"fog-ground-blend":new t.D(t.u.sky["fog-ground-blend"]),"horizon-fog-blend":new t.D(t.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new t.D(t.u.sky["sky-horizon-blend"]),"atmosphere-blend":new t.D(t.u.sky["atmosphere-blend"])});class R extends t.E{constructor(e){super(),this._transitionable=new t.x(M,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.H(0))}setSky(e,r={}){if(!this._validate(t.J,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const r in e){const n=e[r];r.endsWith(t.z)?this._transitionable.setTransition(r.slice(0,-t.z.length),n):this._transitionable.setValue(r,n)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n={}){return!1!==(null==n?void 0:n.validate)&&t.B(this,e.call(t.C,t.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.u})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class D{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,o=e[0]*r,a=!0;n.push({left:i,right:o,isDash:a,zeroLength:0===e[0]});let s=e[0];for(let l=1;l<e.length;l++){a=!a;const t=e[l];i=s*r,s+=t,o=s*r,n.push({left:i,right:o,isDash:a,zeroLength:0===t})}return n}addRoundDash(e,t,r){const n=t/2;for(let i=-r;i<=r;i++){const t=this.width*(this.nextRow+r+i);let o=0,a=e[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++o]);const l=Math.abs(s-a.left),c=Math.abs(s-a.right),u=Math.min(l,c);let h;const d=i/r*(n+1);if(a.isDash){const e=n-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=n-Math.sqrt(u*u+d*d);this.data[t+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let a=e.length-1;a>=0;--a){const t=e[a],r=e[a+1];t.zeroLength?e.splice(a,1):r&&r.isDash===t.isDash&&(r.left=t.left,e.splice(a,1))}const t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);const n=this.width*this.nextRow;let i=0,o=e[i];for(let a=0;a<this.width;a++){a/o.right>1&&(o=e[++i]);const t=Math.abs(a-o.left),r=Math.abs(a-o.right),s=Math.min(t,r);this.data[n+a]=Math.max(0,Math.min(255,(o.isDash?s:-s)+128))}}addDash(e,r){const n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return t.w("LineAtlas out of space"),null;let o=0;for(let t=0;t<e.length;t++)o+=e[t];if(0!==o){const t=this.width/o,i=this.getDashRanges(e,this.width,t);r?this.addRoundDash(i,t,n):this.addRegularDash(i)}const a={y:this.nextRow+n,height:2*n,width:o};return this.nextRow+=i,this.dirty=!0,a}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}const O="maplibre_preloaded_worker_pool";class L{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<L.workerCount;)this.workers.push(new Worker(t.c.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[O]}numActive(){return Object.keys(this.active).length}}const B=Math.floor(s.hardwareConcurrency/2);let $,z;function F(){return $||($=new L),$}L.workerCount=t.K(globalThis)?Math.max(Math.min(B,3),1):1;class q{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const n=this.workerPool.acquire(r);for(let i=0;i<n.length;i++){const e=new t.L(n[i],r);e.name=`Worker ${i}`,this.actors.push(e)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){const r=[];for(const n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((e=>{e.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const r of this.actors)r.registerMessageHandler(e,t)}unregisterMessageHandler(e){for(const t of this.actors)t.unregisterMessageHandler(e)}}function N(){return z||(z=new q(F(),t.M),z.registerMessageHandler("GR",((e,r,n)=>t.m(r,n)))),z}function j(e,r){const n=t.N();return t.O(n,n,[1,1,0]),t.Q(n,n,[.5*e.width,.5*e.height,1]),e.calculatePosMatrix?t.S(n,n,e.calculatePosMatrix(r.toUnwrapped())):n}function U(e,t,r,n,i,o,a){var s;const l=function(e,t,r){if(e)for(const n of e){const e=t[n];if(e&&e.source===r&&"fill-extrusion"===e.type)return!0}else for(const n in t){const e=t[n];if(e.source===r&&"fill-extrusion"===e.type)return!0}return!1}(null!==(s=null==i?void 0:i.layers)&&void 0!==s?s:null,t,e.id),c=o.maxPitchScaleFactor(),u=e.tilesIn(n,c,l);u.sort(V);const h=[];for(const d of u)h.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,r,e.getState(),d.queryGeometry,d.cameraQueryGeometry,d.scale,i,o,c,j(o,d.tileID),a?(e,t)=>a(d.tileID,e,t):void 0)});return function(e,t){for(const r in e)for(const n of e[r])G(n,t);return e}(function(e){const t={},r={};for(const n of e){const e=n.queryResults,i=n.wrappedTileID,o=r[i]=r[i]||{};for(const r in e){const n=e[r],i=o[r]=o[r]||{},a=t[r]=t[r]||[];for(const e of n)i[e.featureIndex]||(i[e.featureIndex]=!0,a.push(e))}}return t}(h),e)}function V(e,t){const r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function G(e,t){const r=e.feature,n=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}function W(e,r,n,i){return t._(this,void 0,void 0,(function*(){let o=e;if(e.url?o=(yield t.j(r.transformRequest(e.url,"Source"),n)).data:yield s.frameAsync(n,i),!o)return null;const a=t.U(t.e(o,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in o&&o.vector_layers&&(a.vectorLayerIds=o.vector_layers.map((e=>e.id))),a}))}class H{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.V?new t.V(e.lng,e.lat):t.V.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.V?new t.V(e.lng,e.lat):t.V.convert(e),this}extend(e){const r=this._sw,n=this._ne;let i,o;if(e instanceof t.V)i=e,o=e;else{if(!(e instanceof H))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(H.convert(e)):this.extend(t.V.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.V.convert(e)):this;if(i=e._sw,o=e._ne,!i||!o)return this}return r||n?(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),n.lng=Math.max(o.lng,n.lng),n.lat=Math.max(o.lat,n.lat)):(this._sw=new t.V(i.lng,i.lat),this._ne=new t.V(o.lng,o.lat)),this}getCenter(){return new t.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.V(this.getWest(),this.getNorth())}getSouthEast(){return new t.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:n}=t.V.convert(e);let i=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}intersects(e){if(!((e=H.convert(e)).getNorth()>=this.getSouth()&&e.getSouth()<=this.getNorth()))return!1;const r=Math.abs(this.getEast()-this.getWest()),n=Math.abs(e.getEast()-e.getWest());if(r>=360||n>=360)return!0;const i=t.W(this.getWest(),-180,180),o=t.W(this.getEast(),-180,180),a=t.W(e.getWest(),-180,180),s=t.W(e.getEast(),-180,180),l=i>=o,c=a>=s;return!(!l||!c)||(l?s>=i||a<=o:c?o>=a||i<=s:a<=o&&s>=i)}static convert(e){return e instanceof H?e:e?new H(e):e}static fromLngLat(e,r=0){const n=360*r/40075017,i=n/Math.cos(Math.PI/180*e.lat);return new H(new t.V(e.lng-i,e.lat-n),new t.V(e.lng+i,e.lat+n))}adjustAntiMeridian(){const e=new t.V(this._sw.lng,this._sw.lat),r=new t.V(this._ne.lng,this._ne.lat);return new H(e,e.lng>r.lng?new t.V(r.lng+360,r.lat):r)}}class Z{constructor(e,t,r){this.bounds=H.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),n=Math.floor(t.Y(this.bounds.getWest())*r),i=Math.floor(t.X(this.bounds.getNorth())*r),o=Math.ceil(t.Y(this.bounds.getEast())*r),a=Math.ceil(t.X(this.bounds.getSouth())*r);return e.x>=n&&e.x<o&&e.y>=i&&e.y<a}}class Y extends t.E{constructor(e,r,n,i){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.U(r,["url","scheme","tileSize","promoteId","encoding"])),this._options=t.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield W(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new Z(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})))}catch(de){this._tileJSONRequest=null,this._loaded=!0,t.Z(de)||this.fire(new t.k(de))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(e)};r.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise(((t,r)=>{e.reloadPromise={resolve:t,reject:r}}))}else e.actor=this.dispatcher.getActor(),n="LT";e.abortController=new AbortController;try{const t=yield e.actor.sendAsync({type:n,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(i){if(delete e.abortController,e.aborted)return;if(i&&404!==i.status)throw i;this._afterTileLoadWorkerResponse(e,null)}}))}_getOverzoomParameters(e){if(e.tileID.canonical.z<=this.maxzoom)return;if(void 0===this.map._zoomLevelsToOverscale)return;const t=e.tileID.scaledTo(this.maxzoom).canonical,r=t.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:t,overzoomRequest:this.map._requestManager.transformRequest(r,"Tile")}}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){const t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class X extends t.E{constructor(e,r,n,i){super(),this.id=e,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},r),t.e(this,t.U(r,["url","scheme","tileSize"]))}load(){return t._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield W(this._options,this.map._requestManager,this._tileJSONRequest,this.map._ownerWindow);this._tileJSONRequest=null,this._loaded=!0,r&&(t.e(this,r),r.bounds&&(this.tileBounds=new Z(r.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this._loaded=!0,t.Z(r)||this.fire(new t.k(r))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const n=yield y.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){this.map._refreshExpiredTiles&&(n.cacheControl||n.expires)&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const r=this.map.painter.context,i=r.gl,o=n.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.T(r,o,i.RGBA,{useMipmap:!0}),e.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class K extends X{constructor(e,r,n,i){super(e,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return t._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const r=yield y.getImage(n,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){const n=r.data;this.map._refreshExpiredTiles&&(r.cacheControl||r.expires)&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const i=t.b(n)&&t.$()?n:yield this.readImageNow(n),o={type:this.type,uid:e.uid,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();const t=yield e.actor.sendAsync({type:"LDT",data:o});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(i){if(delete e.abortController,e.aborted)e.state="unloaded";else if(i)throw e.state="errored",i}}))}readImageNow(e){return t._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&t.a0()){const n=e.width+2,i=e.height+2;try{return new t.R({width:n,height:i},yield t.a1(e,-1,-1,n,i))}catch(r){}}return s.getImageData(e,1)}))}_getNeighboringTiles(e){const r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,o=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.a2(e.overscaledZ,o,r.z,i,r.y).key]={backfilled:!1},l[new t.a2(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(l[new t.a2(e.overscaledZ,o,r.z,i,r.y-1).key]={backfilled:!1},l[new t.a2(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.a2(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.a2(e.overscaledZ,o,r.z,i,r.y+1).key]={backfilled:!1},l[new t.a2(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.a2(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}function Q(e){return"GeometryCollection"===e.type?e.geometries.map((e=>e.coordinates)).flat(1/0):e.coordinates.flat(1/0)}function J(e){const t=new H;let r;switch(e.type){case"FeatureCollection":r=e.features.map((e=>Q(e.geometry))).flat(1/0);break;case"Feature":r=Q(e.geometry);break;default:r=Q(e)}if(0==r.length)return t;for(let n=0;n<r.length-1;n+=2)t.extend([r[n],r[n+1]]);return t}class ee extends t.E{constructor(e,r,n,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:r.data},this.actor=n.getActor(),this.setEventedParent(i),this._data="string"==typeof r.data?{url:r.data}:{geojson:r.data},this._options=t.e({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,void 0!==r.clusterMaxZoom&&this.maxzoom<=r.clusterMaxZoom&&t.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=t.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==r.buffer?r.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==r.tolerance?r.tolerance:.375),extent:t.a5,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(r.clusterMaxZoom),minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.a5,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return void 0!==this._pendingWorkerUpdate.data||void 0!==this._pendingWorkerUpdate.diff||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(e){return e*(t.a5/this.tileSize)}_getClusterMaxZoom(e){const r=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||void 0===e||t.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${r}"`),r}load(){return t._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e,t){this._data="string"==typeof e?{url:e}:{geojson:e},this._pendingWorkerUpdate={data:e};const r=this._updateWorkerData();return t?r:this}updateData(e,r){this._pendingWorkerUpdate.diff=t.a6(this._pendingWorkerUpdate.diff,e);const n=this._updateWorkerData();return r?n:this}getData(){return t._(this,void 0,void 0,(function*(){const e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getBounds(){return t._(this,void 0,void 0,(function*(){return J(yield this.getData())}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}_updateWorkerData(){return t._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void t.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:e,diff:r}=this._pendingWorkerUpdate,n=this._getLoadGeoJSONParameters(e,r);void 0!==e?this._pendingWorkerUpdate.data=void 0:r&&(this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,yield this._dispatchWorkerUpdate(n)}))}_getLoadGeoJSONParameters(e,r){const n=t.e({type:this.type},this.workerOptions);return"string"==typeof e?(n.request=this.map._requestManager.transformRequest(s.resolveURL(e),"Source"),n.request.collectResourceTiming=this._collectResourceTiming,n):void 0!==e?(n.data=e,n):r?(n.dataDiff=r,n):n}_dispatchWorkerUpdate(e){return t._(this,void 0,void 0,(function*(){this._isUpdatingWorker=!0,this.fire(new t.l("dataloading",{dataType:"source"}));try{const r=yield this.actor.sendAsync({type:"LD",data:e});if(this._isUpdatingWorker=!1,this._removed||r.abandoned)return void this.fire(new t.l("dataabort",{dataType:"source"}));r.data&&(this._data={geojson:r.data});const n=this._applyDiffToSource(e.dataDiff),i=this._getShouldReloadTileOptions(n),o={dataType:"source"};this._applyResourceTiming(o,r),this.fire(new t.l("data",Object.assign(Object.assign({},o),{sourceDataType:"metadata"}))),this.fire(new t.l("data",Object.assign(Object.assign({},o),{sourceDataType:"content",shouldReloadTileOptions:i})))}catch(r){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new t.l("dataabort",{dataType:"source"}));this.fire(new t.k(r))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyResourceTiming(e,r){var n;if(!this._collectResourceTiming)return;const i=null===(n=r.resourceTiming)||void 0===n?void 0:n[this.id];if(!i)return;const o=i.slice(0);(null==o?void 0:o.length)&&t.e(e,{resourceTiming:o})}_applyDiffToSource(e){if(!e)return;const r="string"==typeof this.promoteId?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const e=t.a7(this._data.geojson,r);if(!e)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:e}}if(!this._data.updateable)return;const n=t.a8(this._data.updateable,e,r);return e.removeAll||this._options.cluster?void 0:n}_getShouldReloadTileOptions(e){if(e)return{affectedBounds:e.filter(Boolean).map((e=>J(e)))}}shouldReloadTile(e,{affectedBounds:r}){if("loading"===e.state)return!0;if("unloaded"===e.state)return!1;const{buffer:n,extent:i}=this.workerOptions.geojsonVtOptions,o=function({x:e,y:r,z:n},i=0){const o=t.a3((e-i)/Math.pow(2,n)),a=t.a4((r+1+i)/Math.pow(2,n)),s=t.a3((e+1+i)/Math.pow(2,n)),l=t.a4((r-i)/Math.pow(2,n));return new H([o,a],[s,l])}(e.tileID.canonical,n/i);for(const t of r)if(o.intersects(t))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.actor?"RT":"LT";e.actor=this.actor;const r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const n=yield this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,"RT"===t)}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class te extends t.E{constructor(e,t,r,n){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}load(e){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const t=yield y.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,t.Z(r)||this.fire(new t.k(r))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(t.a9.fromLngLat);var n;return this.tileID=function(e){const r=t.aa.fromPoints(e),n=r.width(),i=r.height(),o=Math.max(n,i),a=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),s=Math.pow(2,a);return new t.ac(a,Math.floor((r.minX+r.maxX)/2*s),Math.floor((r.minY+r.maxY)/2*s))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map((e=>this.tileID.getTilePoint(e)._round())),this.flippedWindingOrder=((n=this.tileCoords)[1].x-n[0].x)*(n[2].y-n[0].y)-(n[1].y-n[0].y)*(n[2].x-n[0].x)<0,this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new t.T(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:r,minY:n,maxX:i,maxY:o}=t.aa.fromPoints(e),a={};for(let s=0;s<=t.ab;s++){const e=Math.pow(2,s),t=Math.floor(r*e),l=Math.floor(n*e),c=Math.floor(i*e),u=Math.floor(o*e),h=(t%e+e)%e,d=c%e,p=Math.floor(t/e),f=Math.floor(c/e);a[s]={minWrap:p,maxWrap:f,minTileXWrapped:h,maxTileXWrapped:d,minTileY:l,maxTileY:u}}return a}}class re extends te{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{const e=yield t.ad(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new t.k(r))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.k(new t.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new t.T(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ne extends te{constructor(e,r,n,i){super(e,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new t.k(new t.ae(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.k(new t.ae(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.k(new t.ae(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.k(new t.ae(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.k(new t.ae(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context,n=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new t.T(r,this.canvas,n.RGBA,{premultiply:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ie={},oe=e=>{switch(e){case"geojson":return ee;case"image":return te;case"raster":return X;case"raster-dem":return K;case"vector":return Y;case"video":return re;case"canvas":return ne}return ie[e]},ae="RTLPluginLoaded";class se extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=N()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((e=>{throw this.status="error",e}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,(function*(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=s.resolveURL(e),!this.url)throw new Error(`requested url ${e} is invalid`);if("unavailable"===this.status){if(!t)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()}))}_requestImport(){return t._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.l(ae))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let le=null;function ce(){return le||(le=new se),le}var ue,he,de;(de=ue||(ue={}))[de.Base=0]="Base",de[de.Parent=1]="Parent",function(e){e[e.Departing=0]="Departing",e[e.Incoming=1]="Incoming"}(he||(he={}));class pe{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=e,this.uid=t.af(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(e){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(e||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:e,fadingDirection:t,fadingParentID:r,fadeEndTime:n}){this.resetFadeLogic(),this.fadingRole=e,this.fadingDirection=t,this.fadingParentID=r,this.fadeEndTime=n}setSelfFadeLogic(e){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=e}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=c(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData,this.latestFeatureIndex.encoding=e.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const r={};if(!t)return r;for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)r[t.id]=n}}return r}(e.buckets,null==r?void 0:r.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.ah){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.ah&&r.hasRTLText){this.hasRTLText=!0,ce().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new t.ag}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const t in this.buckets){const r=this.buckets[t];r.uploadPending()&&r.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new t.T(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new t.T(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,o,a,s,l,c,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*l,getElevation:u},e,t,r):{}}querySourceFeatures(e,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),o=r&&r.sourceLayer?r.sourceLayer:"",a=i[t.ai]||i[o];if(!a)return;const s=t.aj(null==r?void 0:r.filter,null==r?void 0:r.globalState),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<a.length;d++){const r=a.feature(d);if(s.needGeometry){const e=t.ak(r,!0);if(!s.filter(new t.H(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.H(this.tileID.overscaledZ),r))continue;const i=n.getId(r,o),p=new t.al(r,l,c,u,i);p.tile=h,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const r=t.am(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(r)if(this.expirationTime<r)t=!0;else{const n=this.expirationTime-r;n?this.expirationTime=e+Math.max(n,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!r.style.hasLayer(i))continue;const o=this.buckets[i],a=o.layers[0].sourceLayer||t.ai,s=n[a],l=e[a];if(!s||!l||0===Object.keys(l).length)continue;o.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const c=r&&r.style&&r.style.getLayer(i);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(o)))}}holdingForSymbolFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(e){this.symbolFadeHoldUntil=c()+e}setDependencies(e,t){const r={};for(const n of t)r[n]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const r of e){const e=this.dependencies[r];if(e)for(const r of t)if(e[r])return!0}return!1}}class fe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){const i=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.e(this.stateChanges[e][i],n),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])n[t]||(this.deletedStates[e][i][t]=null)}else for(const t in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,r){const n=String(r),i=t.e({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][r];if(null===t)return{};for(const e in t)delete i[e]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,r){const n={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const e={};for(const r in this.stateChanges[i])this.state[i][r]||(this.state[i][r]={}),t.e(this.state[i][r],this.stateChanges[i][r]),e[r]=this.state[i][r];n[i]=e}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const e={};if(null===this.deletedStates[i])for(const t in this.state[i])e[t]={},this.state[i][t]={};else for(const t in this.deletedStates[i]){if(null===this.deletedStates[i][t])this.state[i][t]={};else for(const e of Object.keys(this.deletedStates[i][t]))delete this.state[i][t][e];e[t]=this.state[i][t]}n[i]=n[i]||{},t.e(n[i],e)}this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length&&e.setFeatureState(n,r)}}const me=89.25;function ge(e,r){const n=t.an(r.lat,-t.ao,t.ao);return new t.P(t.Y(r.lng)*e,t.X(n)*e)}function ye(e,r){return new t.a9(r.x/e,r.y/e).toLngLat()}function _e(e){return e.cameraToCenterDistance*Math.min(.85*Math.tan(t.ap(90-e.pitch)),Math.tan(t.ap(me-e.pitch)))}function ve(e,r){const n=e.canonical,i=r/t.aq(n.z),o=n.x+Math.pow(2,n.z)*e.wrap,a=t.ar(new Float64Array(16));return t.O(a,a,[o*i,n.y*i,0]),t.Q(a,a,[i/t.a5,i/t.a5,1]),a}function be(e,r,n,i,o){const a=t.a9.fromLngLat(e,r),s=o*t.as(1,e.lat),{x:l,y:c,z:u}=we(n,i);return new t.a9(a.x+s*-l,a.y+s*-c,a.z+s*-u)}function we(e,r){const n=t.ap(e),i=t.ap(r),o=Math.cos(-n),a=Math.sin(n);return{x:a*Math.sin(i),y:-a*Math.cos(i),z:o}}function xe(e,t,r){const n=t.intersectsFrustum(e);if(!r||0===n)return n;const i=t.intersectsPlane(r);return 0===i?0:2===n&&2===i?2:1}function Se(e,t,r){let n=0;const i=(r-t)/10;for(let o=0;o<10;o++)n+=i*Math.pow(Math.cos(t+(o+.5)/10*(r-t)),e);return n}function Ee(e,r){return function(n,i,o,a,s){const l=2*((e-1)/t.at(Math.cos(t.ap(me-s))/Math.cos(t.ap(me)))-1),c=Math.acos(o/a),u=2*Se(l-1,0,t.ap(s/2)),h=Math.min(t.ap(me),c+t.ap(s/2)),d=Se(l-1,Math.min(h,c-t.ap(s/2)),h),p=Math.atan(i/o),f=Math.hypot(i,o);let m=n;return m+=t.at(a/f/Math.max(.5,Math.cos(t.ap(s/2)))),m+=l*t.at(Math.cos(p))/2,m-=t.at(Math.max(1,d/u/r))/2,m}}const Te=Ee(9.314,3);function Ae(e,r){const n=(r.roundZoom?Math.round:Math.floor)(e.zoom+t.at(e.tileSize/r.tileSize));return Math.max(0,n)}function Ce(e,r){const n=e.getCameraFrustum(),i=e.getClippingPlane(),o=e.screenPointToMercatorCoordinate(e.getCameraPoint()),a=t.a9.fromLngLat(e.center,e.elevation);o.z=a.z+Math.cos(e.pitchInRadians)*e.cameraToCenterDistance/e.worldSize;const s=e.getCoveringTilesDetailsProvider(),l=s.allowVariableZoom(e,r),c=Ae(e,r),u=r.minzoom||0,h=void 0!==r.maxzoom?r.maxzoom:e.maxZoom,d=Math.min(Math.max(0,c),h),p=Math.pow(2,d),f=[p*o.x,p*o.y,0],m=[p*a.x,p*a.y,0],g=Math.hypot(a.x-o.x,a.y-o.y),y=Math.abs(a.z-o.z),_=Math.hypot(g,y),v=e=>({zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),b=[],w=[];if(e.renderWorldCopies&&s.allowWorldCopies())for(let t=1;t<=3;t++)b.push(v(-t)),b.push(v(t));for(b.push(v(0));b.length>0;){const p=b.pop(),g=p.x,v=p.y;let x=p.fullyVisible;const S={x:g,y:v,z:p.zoom},E=s.getTileBoundingVolume(S,p.wrap,e.elevation,r);if(!x){const e=xe(n,E,i);if(0===e)continue;x=2===e}const T=s.distanceToTile2d(o.x,o.y,S,E);let A=c;l&&(A=(r.calculateTileZoom||Te)(e.zoom+t.at(e.tileSize/r.tileSize),T,y,_,e.fov)),A=(r.roundZoom?Math.round:Math.floor)(A),A=Math.max(0,A);const C=Math.min(A,h);if(p.wrap=s.getWrap(a,S,p.wrap),p.zoom>=C){if(p.zoom<u)continue;const e=d-p.zoom,n=f[0]-.5-(g<<e),i=f[1]-.5-(v<<e),o=r.reparseOverscaled?Math.max(p.zoom,A):p.zoom;w.push({tileID:new t.a2(p.zoom===h?o:p.zoom,p.wrap,p.zoom,g,v),distanceSq:t.au([m[0]-.5-g,m[1]-.5-v]),tileDistanceToCamera:Math.sqrt(n*n+i*i)})}else for(let e=0;e<4;e++)b.push({zoom:p.zoom+1,x:(g<<1)+e%2,y:(v<<1)+(e>>1),wrap:p.wrap,fullyVisible:x})}return w.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}const Ie=t.aa.fromPoints([new t.P(0,0),new t.P(t.a5,t.a5)]);function ke(e){return"raster"===e||"image"===e||"video"===e}function Pe(e,t,r,n,i,o,a){if(!t.hasData())return!1;const{tileID:s,fadingRole:l,fadingDirection:c,fadingParentID:u}=t;if(l===ue.Base&&c===he.Incoming&&u)return r[u.key]=u,!0;const h=Math.max(s.overscaledZ-i,o);for(let d=s.overscaledZ-1;d>=h;d--){const i=s.scaledTo(d),o=e.getLoadedTile(i);if(o)return t.setCrossFadeLogic({fadingRole:ue.Base,fadingDirection:he.Incoming,fadingParentID:o.tileID,fadeEndTime:n+a}),o.setCrossFadeLogic({fadingRole:ue.Parent,fadingDirection:he.Departing,fadeEndTime:n+a}),r[i.key]=i,!0}return!1}function Me(e,t,r,n,i,o){if(!t.hasData())return!1;const a=t.tileID.children(i);let s=Re(e,t,a,r,n,i,o);if(s)return!0;for(const l of a)Re(e,t,l.children(i),r,n,i,o)&&(s=!0);return s}function Re(e,t,r,n,i,o,a){if(r[0].overscaledZ>=o)return!1;let s=!1;for(const l of r){const r=e.getLoadedTile(l);if(!r)continue;const{fadingRole:o,fadingDirection:c,fadingParentID:u}=r;o===ue.Base&&c===he.Departing&&u||(r.setCrossFadeLogic({fadingRole:ue.Base,fadingDirection:he.Departing,fadingParentID:t.tileID,fadeEndTime:i+a}),t.setCrossFadeLogic({fadingRole:ue.Parent,fadingDirection:he.Incoming,fadeEndTime:i+a})),n[l.key]=l,s=!0}return s}function De(e,t,r,n){const i=e.tileID;return!!e.selfFading||!e.hasData()&&!!t.has(i)&&(e.setSelfFadeLogic(r+n),!0)}function Oe(e,t){var r;e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let n=t.tileID.canonical.x-e.tileID.canonical.x;const i=t.tileID.canonical.y-e.tileID.canonical.y,o=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+o)?n+=o:1===Math.abs(n-o)&&(n-=o)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,i),(null===(r=e.neighboringTiles)||void 0===r?void 0:r[a])&&(e.neighboringTiles[a].backfilled=!0)))}class Le{constructor(){this._tiles={}}handleWrapJump(e){const t={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),t[n.tileID.key]=n}this._tiles=t}setFeatureState(e,t){for(const r in this._tiles)this._tiles[r].setFeatureState(e,t)}getAllTiles(){return Object.values(this._tiles)}getAllIds(e=!1){return e?Object.values(this._tiles).map((e=>e.tileID)).sort(t.aw).map((e=>e.key)):Object.keys(this._tiles)}getTileById(e){return this._tiles[e]}setTile(e,t){this._tiles[e]=t}deleteTileById(e){delete this._tiles[e]}getLoadedTile(e){const t=this.getTileById(e.key);return(null==t?void 0:t.hasData())?t:null}isIdRenderable(e,t=!1){var r;return null===(r=this.getTileById(e))||void 0===r?void 0:r.isRenderable(t)}getRenderableIds(e=0,r){const n=[];for(const t of this.getAllIds())this.isIdRenderable(t,r)&&n.push(this.getTileById(t));return r?n.sort(((r,n)=>{const i=r.tileID,o=n.tileID,a=new t.P(i.canonical.x,i.canonical.y)._rotate(-e),s=new t.P(o.canonical.x,o.canonical.y)._rotate(-e);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((e=>e.tileID.key)):n.map((e=>e.tileID)).sort(t.aw).map((e=>e.key))}}class Be extends t.E{constructor(e,r,n){super(),this.id=e,this.dispatcher=n,this.on("data",(e=>this._dataHandler(e))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((e,t,r,n)=>{const i=new(oe(t.type))(e,t,r,n);if(i.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${i.id}`);return i})(e,r,n,this),this._inViewTiles=new Le,this._outOfViewCache=new t.ax(0,(e=>this._unloadTile(e))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new fe,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){for(const t of this._inViewTiles.getAllTiles())t.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e),this._inViewTiles=new Le}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e of this._inViewTiles.getAllTiles())if("loaded"!==e.state&&"errored"!==e.state)return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,n){return t._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,n)}catch(i){e.state="errored",404!==i.status?this._source.fire(new t.k(i,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const t of this._inViewTiles.getAllTiles())t.upload(e),t.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(e){var t;return this._inViewTiles.getRenderableIds(null===(t=this.transform)||void 0===t?void 0:t.bearingInRadians,e)}hasRenderableParent(e){const t=e.overscaledZ-1;if(t>=this._source.minzoom){const r=this.getLoadedTile(e.scaledTo(t));if(r)return this._inViewTiles.isIdRenderable(r.tileID.key)}return!1}reload(e,t=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const r of this._inViewTiles.getAllIds()){const n=this._inViewTiles.getTileById(r);t&&!this._source.shouldReloadTile(n,t)||(e?this._reloadTile(r,"expired"):"errored"!==n.state&&this._reloadTile(r,"reloading"))}}}_reloadTile(e,r){return t._(this,void 0,void 0,(function*(){const t=this._inViewTiles.getTileById(e);t&&("loading"!==t.state&&(t.state=r),yield this._loadTile(t,e,r))}))}_tileLoaded(e,r,n){e.timeAdded=c(),e.selfFading&&(e.fadeEndTime=e.timeAdded+this._rasterFadeDuration),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&function(e,t){var r,n;const i=t.getRenderableIds();for(const o of i){if(!e.neighboringTiles||!e.neighboringTiles[o])continue;const i=t.getTileById(o);e.neighboringTiles[o].backfilled||Oe(e,i),(null===(n=null===(r=i.neighboringTiles)||void 0===r?void 0:r[e.tileID.key])||void 0===n?void 0:n.backfilled)||Oe(i,e)}}(e,this._inViewTiles),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.l("data",{dataType:"source",tile:e,coord:e.tileID}))}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._inViewTiles.getTileById(e)}_retainLoadedChildren(e,t){const r=this._getLoadedDescendents(t),n=new Set;for(const i of t){const t=r[i.key];if(!(null==t?void 0:t.length)){n.add(i);continue}const o=i.overscaledZ+Be.maxOverzooming,a=t.filter((e=>e.tileID.overscaledZ<=o));if(!a.length){n.add(i);continue}const s=Math.min(...a.map((e=>e.tileID.overscaledZ))),l=a.filter((e=>e.tileID.overscaledZ===s)).map((e=>e.tileID));for(const r of l)e[r.key]=r;this._areDescendentsComplete(l,s,i.overscaledZ)||n.add(i)}return n}_getLoadedDescendents(e){var t;const r={};for(const n of this._inViewTiles.getAllTiles().filter((e=>e.hasData())))for(const i of e)n.tileID.isChildOf(i)&&(r[t=i.key]||(r[t]=[])).push(n);return r}_areDescendentsComplete(e,t,r){return 1===e.length&&e[0].isOverscaled()?e[0].overscaledZ===t:Math.pow(4,t-r)===e.length}getLoadedTile(e){return this._inViewTiles.getLoadedTile(e)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,i=Math.floor(r*n*(null===this._maxTileCacheZoomLevels?t.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._outOfViewCache.setMaxSize(o)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);this._prevLng=e,t&&(this._inViewTiles.handleWrapJump(t),this._resetTileReloadTimers())}update(e,r){if(!this._sourceLoaded||this._paused)return;let n;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.a2(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(n=Ce(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:"vector"===this._source.type&&void 0!==this.map._zoomLevelsToOverscale?e.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(n=n.filter((e=>this._source.hasTile(e))))):n=[],this.usedForTerrain&&(n=this._addTerrainIdealTiles(n));const i=0===n.length&&!this._updated&&this._didEmitContent;this._updated=!0,i&&this.fire(new t.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const o=Ae(e,this._source),a=this._updateRetainedTiles(n,o),s=ke(this._source.type);s&&this._rasterFadeDuration>0&&!r&&function(e,r,n,i,o,a,s){const l=c(),u=t.av(r);for(const t of r){const r=e.getTileById(t.key);r.fadingDirection!==he.Departing&&0!==r.fadeOpacity||r.resetFadeLogic(),Pe(e,r,n,l,i,o,s)||Me(e,r,n,l,a,s)||De(r,u,l,s)||r.resetFadeLogic()}}(this._inViewTiles,n,a,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),s?this._cleanUpRasterTiles(a):this._cleanUpVectorTiles(a)}_cleanUpRasterTiles(e){for(const t of this._inViewTiles.getAllIds())e[t]||this._removeTile(t)}_cleanUpVectorTiles(e){for(const t of this._inViewTiles.getAllIds()){const r=this._inViewTiles.getTileById(t);e[t]?r.clearSymbolFadeHold():r.hasSymbolBuckets?r.holdingForSymbolFade()?r.symbolFadeFinished()&&this._removeTile(t):r.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(t)}}_addTerrainIdealTiles(e){const t=[];for(const r of e)if(r.canonical.z>this._source.minzoom){const e=r.scaledTo(r.canonical.z-1);t.push(e);const n=r.scaledTo(Math.max(this._source.minzoom,Math.min(r.canonical.z,5)));t.push(n)}return e.concat(t)}releaseSymbolFadeTiles(){for(const e of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(e).holdingForSymbolFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var r;const n=new Set;for(const l of e)this._addTile(l).hasData()||n.add(l);const i=e.reduce(((e,t)=>(e[t.key]=t,e)),{}),o=this._retainLoadedChildren(i,n),a={},s=Math.max(t-Be.maxUnderzooming,this._source.minzoom);for(const l of o){let e=this._inViewTiles.getTileById(l.key),t=null==e?void 0:e.wasRequested();for(let n=l.overscaledZ-1;n>=s;--n){const o=l.scaledTo(n);if(a[o.key])break;if(a[o.key]=!0,e=this.getTile(o),!e&&t&&(e=this._addTile(o)),e){const n=e.hasData();if((n||!(null===(r=this.map)||void 0===r?void 0:r.cancelPendingTileRequestsWhileZooming)||t)&&(i[o.key]=o),t=e.wasRequested(),n)break}}}return i}_addTile(e){let r=this._inViewTiles.getTileById(e.key);if(r)return r;r=this._outOfViewCache.getAndRemove(e),r&&(r.resetFadeLogic(),this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null));const n=r;return r||(r=new pe(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._inViewTiles.setTile(e.key,r),n||this._source.fire(new t.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){this._clearTileReloadTimer(e);const r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),r))}_clearTileReloadTimer(e){const t=this._timers[e];t&&(clearTimeout(t),delete this._timers[e])}_resetTileReloadTimers(){for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e of this._inViewTiles.getAllIds()){const t=this._inViewTiles.getTileById(e);this._setTileReloadTimer(e,t)}}refreshTiles(e){for(const t of this._inViewTiles.getAllIds()){const r=this._inViewTiles.getTileById(t);(this._inViewTiles.isIdRenderable(t)||"errored"==r.state)&&e.some((e=>e.equals(r.tileID.canonical)))&&this._reloadTile(t,"expired")}}_removeTile(e){const t=this._inViewTiles.getTileById(e);t&&(t.uses--,this._inViewTiles.deleteTileById(e),this._clearTileReloadTimer(e),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._outOfViewCache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){"source"===e.dataType&&("metadata"!==e.sourceDataType?"content"===e.sourceDataType&&this._sourceLoaded&&!this._paused&&(this.reload(e.sourceDataChanged,e.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e of this._inViewTiles.getAllIds())this._removeTile(e);this._outOfViewCache.reset()}tilesIn(e,r,n){const i=[],o=this.transform;if(!o)return i;const a=o.getCoveringTilesDetailsProvider().allowWorldCopies(),s=n?o.getCameraQueryGeometry(e):e,l=e=>o.screenPointToMercatorCoordinate(e,this.terrain),c=this.transformBbox(e,l,!a),u=this.transformBbox(s,l,!a),h=this.getIds(),d=t.aa.fromPoints(u);for(let p=0;p<h.length;p++){const e=this._inViewTiles.getTileById(h[p]);if(e.holdingForSymbolFade())continue;const n=a?[e.tileID]:[e.tileID.unwrapTo(-1),e.tileID.unwrapTo(0)],s=Math.pow(2,o.zoom-e.tileID.overscaledZ),l=r*e.queryPadding*t.a5/e.tileSize/s;for(const r of n){const n=d.map((e=>r.getTilePoint(new t.a9(e.x,e.y))));if(n.expandBy(l),n.intersects(Ie)){const t=c.map((e=>r.getTilePoint(e))),n=u.map((e=>r.getTilePoint(e)));i.push({tile:e,tileID:a?r:r.unwrapTo(0),queryGeometry:t,cameraQueryGeometry:n,scale:s})}}}return i}transformBbox(e,r,n){let i=e.map(r);if(n){const n=t.aa.fromPoints(e);n.shrinkBy(.001*Math.min(n.width(),n.height()));const o=n.map(r);t.aa.fromPoints(i).covers(o)||(i=i.map((e=>e.x>.5?new t.a9(e.x-1,e.y,e.z):e)))}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._inViewTiles.getTileById(e).tileID));return this.transform&&this.transform.populateCache(t),t}hasTransition(){return!!this._source.hasTransition()||!(!ke(this._source.type)||!function(e,t){if(t<=0)return!1;const r=c();for(const n of e.getAllTiles())if(n.fadeEndTime>=r)return!0;return!1}(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(e){this._rasterFadeDuration=e}setFeatureState(e,r,n){this._state.updateState(e=e||t.ai,r,n)}removeFeatureState(e,r,n){this._state.removeFeatureState(e=e||t.ai,r,n)}getFeatureState(e,r){return this._state.getState(e=e||t.ai,r)}setDependencies(e,t,r){const n=this._inViewTiles.getTileById(e);n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(r).hasDependency(e,t)&&this._reloadTile(r,"reloading");this._outOfViewCache.filter((r=>!r.hasDependency(e,t)))}areTilesLoaded(){for(const e of this._inViewTiles.getAllTiles())if("loaded"!==e.state&&"errored"!==e.state)return!1;return!0}}Be.maxUnderzooming=10,Be.maxOverzooming=3;class $e{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.an(e,0,1);let r=1,n=this._distances[r];const i=e*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];const o=r-1,a=this._distances[o],s=n-a,l=s>0?(i-a)/s:0;return this.points[o].mult(1-l).add(this.points[r].mult(l))}}function ze(e,t){let r=!0;return"always"===e||"never"!==e&&"never"!==t||(r=!1),r}class Fe{constructor(e,t,r){const n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,o){this.boxCells[i].push(o)}_insertCircleCell(e,t,r,n,i,o){this.circleCells[i].push(o)}_query(e,t,r,n,i,o,a){if(r<0||e>this.width||n<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],r=this.circles[3*e+1],n=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-n,y1:r-n,x2:t+n,y2:r+n})}}else this._forEachCell(e,t,r,n,this._queryCell,s,{hitTest:i,overlapMode:o,seenUids:{box:{},circle:{}}},a);return s}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,i,o){return this._query(e,t,r,n,!0,i,o).length>0}hitTestCircle(e,t,r,n,i){const o=e-r,a=e+r,s=t-r,l=t+r;if(a<0||o>this.width||l<0||s>this.height)return!1;const c=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),c.length>0}_queryCell(e,t,r,n,i,o,a,s){const{seenUids:l,hitTest:c,overlapMode:u}=a,h=this.boxCells[i];if(null!==h){const i=this.bboxes;for(const a of h)if(!l.box[a]){l.box[a]=!0;const h=4*a,d=this.boxKeys[a];if(e<=i[h+2]&&t<=i[h+3]&&r>=i[h+0]&&n>=i[h+1]&&(!s||s(d))&&(!c||!ze(u,d.overlapMode))&&(o.push({key:d,x1:i[h],y1:i[h+1],x2:i[h+2],y2:i[h+3]}),c))return!0}}const d=this.circleCells[i];if(null!==d){const i=this.circles;for(const a of d)if(!l.circle[a]){l.circle[a]=!0;const h=3*a,d=this.circleKeys[a];if(this._circleAndRectCollide(i[h],i[h+1],i[h+2],e,t,r,n)&&(!s||s(d))&&(!c||!ze(u,d.overlapMode))){const e=i[h],t=i[h+1],r=i[h+2];if(o.push({key:d,x1:e-r,y1:t-r,x2:e+r,y2:t+r}),c)return!0}}}return!1}_queryCellCircle(e,t,r,n,i,o,a,s){const{circle:l,seenUids:c,overlapMode:u}=a,h=this.boxCells[i];if(null!==h){const e=this.bboxes;for(const t of h)if(!c.box[t]){c.box[t]=!0;const r=4*t,n=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!s||s(n))&&!ze(u,n.overlapMode))return o.push(!0),!0}}const d=this.circleCells[i];if(null!==d){const e=this.circles;for(const t of d)if(!c.circle[t]){c.circle[t]=!0;const r=3*t,n=this.circleKeys[t];if(this._circlesCollide(e[r],e[r+1],e[r+2],l.x,l.y,l.radius)&&(!s||s(n))&&!ze(u,n.overlapMode))return o.push(!0),!0}}}_forEachCell(e,t,r,n,i,o,a,s){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(i.call(this,e,t,r,n,this.xCellCount*l+d,o,a,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,o){const a=n-e,s=i-t,l=r+o;return l*l>a*a+s*s}_circleAndRectCollide(e,t,r,n,i,o,a){const s=(o-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;const c=(a-i)/2,u=Math.abs(t-(i+c));if(u>c+r)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=r*r}}function qe(e,r,i){const o=t.N();if(!e){const{vecSouth:e,vecEast:t}=je(r),i=n();i[0]=t[0],i[1]=t[1],i[2]=e[0],i[3]=e[1],a=i,(d=(l=(s=i)[0])*(h=s[3])-(u=s[2])*(c=s[1]))&&(a[0]=h*(d=1/d),a[1]=-c*d,a[2]=-u*d,a[3]=l*d),o[0]=i[0],o[1]=i[1],o[4]=i[2],o[5]=i[3]}var a,s,l,c,u,h,d;return t.Q(o,o,[1/i,1/i,1]),o}function Ne(e,r,n,i){if(e){const e=t.N();if(!r){const{vecSouth:t,vecEast:r}=je(n);e[0]=r[0],e[1]=r[1],e[4]=t[0],e[5]=t[1]}return t.Q(e,e,[i,i,1]),e}return n.pixelsToClipSpaceMatrix}function je(e){const r=Math.cos(e.rollInRadians),n=Math.sin(e.rollInRadians),i=Math.cos(e.pitchInRadians),o=Math.cos(e.bearingInRadians),a=Math.sin(e.bearingInRadians),s=t.aC();s[0]=-o*i*n-a*r,s[1]=-a*i*n+o*r;const l=t.aD(s);l<1e-9?t.aE(s):t.aF(s,s,1/l);const c=t.aC();c[0]=o*i*r-a*n,c[1]=a*i*r+o*n;const u=t.aD(c);return u<1e-9?t.aE(c):t.aF(c,c,1/u),{vecEast:c,vecSouth:s}}function Ue(e,r,n,i){let o;i?(o=[e,r,i(e,r),1],t.aH(o,o,n)):(o=[e,r,0,1],at(o,o,n));const a=o[3];return{point:new t.P(o[0]/a,o[1]/a),signedDistanceFromCamera:a,isOccluded:!1}}function Ve(e,t){return.5+e/t*.5}function Ge(e,t){return e.x>=-t[0]&&e.x<=t[0]&&e.y>=-t[1]&&e.y<=t[1]}function We(e,r,n,i,o,a,s,l,c,u,h,d,p){const f=n?e.textSizeData:e.iconSizeData,m=t.ay(f,r.transform.zoom),g=[256/r.width*2+1,256/r.height*2+1],y=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;y.clear();const _=e.lineVertexArray,v=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,b=r.transform.width/r.transform.height;let w=!1;for(let x=0;x<v.length;x++){const n=v.get(x);if(n.hidden||n.writingMode===t.az.vertical&&!w){ot(n.numGlyphs,y);continue}w=!1;const S=new t.P(n.anchorX,n.anchorY),E={getElevation:p,pitchedLabelPlaneMatrix:i,lineVertexArray:_,pitchWithMap:a,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:r.transform,tileAnchorPoint:S,unwrappedTileID:c,width:u,height:h,translation:d},T=et(n.anchorX,n.anchorY,E);if(!Ge(T.point,g)){ot(n.numGlyphs,y);continue}const A=Ve(r.transform.cameraToCenterDistance,T.signedDistanceFromCamera),C=t.aA(f,m,n),I=a?C*r.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,c)/A:C*A,k=Ye({projectionContext:E,pitchedLabelPlaneMatrixInverse:o,symbol:n,fontSize:I,flip:!1,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:y,aspectRatio:b,rotateToLine:l});w=k.useVertical,(k.notEnoughRoom||w||k.needsFlipping&&Ye({projectionContext:E,pitchedLabelPlaneMatrixInverse:o,symbol:n,fontSize:I,flip:!0,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:y,aspectRatio:b,rotateToLine:l}).notEnoughRoom)&&ot(n.numGlyphs,y)}n?e.text.dynamicLayoutVertexBuffer.updateData(y):e.icon.dynamicLayoutVertexBuffer.updateData(y)}function He(e,t,r,n,i,o,a,s){const l=o.glyphStartIndex+o.numGlyphs,c=o.lineStartIndex,u=o.lineStartIndex+o.lineLength,h=t.getoffsetX(o.glyphStartIndex),d=t.getoffsetX(l-1),p=nt(e*h,r,n,i,o.segment,c,u,s,a);if(!p)return null;const f=nt(e*d,r,n,i,o.segment,c,u,s,a);return f?s.projectionCache.anyProjectionOccluded?null:{first:p,last:f}:null}function Ze(e,r,n,i){return e===t.az.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(e===t.az.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function Ye(e){const{projectionContext:r,pitchedLabelPlaneMatrixInverse:n,symbol:i,fontSize:o,flip:a,keepUpright:s,glyphOffsetArray:l,dynamicLayoutVertexArray:c,aspectRatio:u,rotateToLine:h}=e,d=o/24,p=i.lineOffsetX*d,f=i.lineOffsetY*d;let m;if(i.numGlyphs>1){const e=i.glyphStartIndex+i.numGlyphs,t=i.lineStartIndex,o=i.lineStartIndex+i.lineLength,c=He(d,l,p,f,a,i,h,r);if(!c)return{notEnoughRoom:!0};const g=Je(c.first.point.x,c.first.point.y,r,n),y=Je(c.last.point.x,c.last.point.y,r,n);if(s&&!a){const e=Ze(i.writingMode,g,y,u);if(e)return e}m=[c.first];for(let n=i.glyphStartIndex+1;n<e-1;n++){const e=nt(d*l.getoffsetX(n),p,f,a,i.segment,t,o,r,h);if(!e)return{notEnoughRoom:!0};m.push(e)}m.push(c.last)}else{if(s&&!a){const e=Qe(r.tileAnchorPoint.x,r.tileAnchorPoint.y,r).point,o=i.lineStartIndex+i.segment+1,a=new t.P(r.lineVertexArray.getx(o),r.lineVertexArray.gety(o)),s=Qe(a.x,a.y,r),l=s.signedDistanceFromCamera>0?s.point:Xe(r.tileAnchorPoint,a,e,1,r),c=Je(e.x,e.y,r,n),h=Je(l.x,l.y,r,n),d=Ze(i.writingMode,c,h,u);if(d)return d}const e=nt(d*l.getoffsetX(i.glyphStartIndex),p,f,a,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,r,h);if(!e||r.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[e]}for(const g of m)t.aG(c,g.point,g.angle);return{}}function Xe(e,t,r,n,i){const o=e.add(e.sub(t)._unit()),a=Qe(o.x,o.y,i).point,s=r.sub(a);return r.add(s._mult(n/s.mag()))}function Ke(e,r,n){const i=r.projectionCache;if(i.projections[e])return i.projections[e];const o=new t.P(r.lineVertexArray.getx(e),r.lineVertexArray.gety(e)),a=Qe(o.x,o.y,r);if(a.signedDistanceFromCamera>0)return i.projections[e]=a.point,i.anyProjectionOccluded=i.anyProjectionOccluded||a.isOccluded,a.point;const s=e-n.direction;return Xe(0===n.distanceFromAnchor?r.tileAnchorPoint:new t.P(r.lineVertexArray.getx(s),r.lineVertexArray.gety(s)),o,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,r)}function Qe(e,t,r){const n=e+r.translation[0],i=t+r.translation[1];let o;return r.pitchWithMap?(o=Ue(n,i,r.pitchedLabelPlaneMatrix,r.getElevation),o.isOccluded=!1):(o=r.transform.projectTileCoordinates(n,i,r.unwrappedTileID,r.getElevation),o.point.x=(.5*o.point.x+.5)*r.width,o.point.y=(.5*-o.point.y+.5)*r.height),o}function Je(e,r,n,i){if(n.pitchWithMap){const o=[e,r,0,1];return t.aH(o,o,i),n.transform.projectTileCoordinates(o[0]/o[3],o[1]/o[3],n.unwrappedTileID,n.getElevation).point}return{x:e/n.width*2-1,y:1-r/n.height*2}}function et(e,t,r){return r.transform.projectTileCoordinates(e,t,r.unwrappedTileID,r.getElevation)}function tt(e,t,r){return e._unit()._perp()._mult(t*r)}function rt(e,r,n,i,o,a,s,l,c){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];const u=n.add(r);if(e+c.direction<i||e+c.direction>=o)return l.projectionCache.offsets[e]=u,u;const h=Ke(e+c.direction,l,c),d=tt(h.sub(n),s,c.direction),p=n.add(d),f=h.add(d);return l.projectionCache.offsets[e]=t.aI(a,u,p,f)||u,l.projectionCache.offsets[e]}function nt(e,t,r,n,i,o,a,s,l){const c=n?e-t:e+t;let u=c>0?1:-1,h=0;n&&(u*=-1,h=Math.PI),u<0&&(h+=Math.PI);let d,p=u>0?o+i:o+i+1;s.projectionCache.cachedAnchorPoint?d=s.projectionCache.cachedAnchorPoint:(d=Qe(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=d);let f,m,g=d,y=d,_=0,v=0;const b=Math.abs(c),w=[];let x;for(;_+v<=b;){if(p+=u,p<o||p>=a)return null;_+=v,y=g,m=f;const e={absOffsetX:b,direction:u,distanceFromAnchor:_,previousVertex:y};if(g=Ke(p,s,e),0===r)w.push(y),x=g.sub(y);else{let t;const n=g.sub(y);t=0===n.mag()?tt(Ke(p+u,s,e).sub(g),r,u):tt(n,r,u),m||(m=y.add(t)),f=rt(p,t,g,o,a,m,r,s,e),w.push(m),x=f.sub(m)}v=x.mag()}const S=x._mult((b-_)/v)._add(m||y),E=h+Math.atan2(g.y-y.y,g.x-y.x);return w.push(S),{point:S,angle:l?E:0,path:w}}const it=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ot(e,t){for(let r=0;r<e;r++){const e=t.length;t.resize(e+4),t.float32.set(it,3*e)}}function at(e,t,r){const n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}const st=100;class lt{constructor(e,t=new Fe(e.width+200,e.height+200,25),r=new Fe(e.width+200,e.height+200,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+st,this.screenBottomBoundary=e.height+st,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,i,o,a,s,l,c,u,h){const d=this.projectAndGetPerspectiveRatio(e.anchorPointX+s[0],e.anchorPointY+s[1],i,c,h),p=r*d.perspectiveRatio;let f;if(o||a)f=this._projectCollisionBox(e,p,n,i,o,a,s,d,c,u,h);else{const t=d.x+(u?u.x*p:0),r=d.y+(u?u.y*p:0);f={allPointsOccluded:!1,box:[t+e.x1*p,r+e.y1*p,t+e.x2*p,r+e.y2*p]}}const[m,g,y,_]=f.box,v=o?f.allPointsOccluded:d.isOccluded;let b=v;return b||(b=d.perspectiveRatio<this.perspectiveRatioCutoff),b||(b=!this.isInsideGrid(m,g,y,_)),b||"always"!==t&&this.grid.hitTest(m,g,y,_,t,l)?{box:[m,g,y,_],placeable:!1,offscreen:!1,occluded:v}:{box:[m,g,y,_],placeable:!0,offscreen:this.isOffscreen(m,g,y,_),occluded:v}}placeCollisionCircles(e,r,n,i,o,a,s,l,c,u,h,d,p,f){const m=[],g=new t.P(r.anchorX,r.anchorY),y=this.getPerspectiveRatio(g.x,g.y,a,f),_=(c?o*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,a)/y:o*y)/t.aM,v={getElevation:f,pitchedLabelPlaneMatrix:s,lineVertexArray:n,pitchWithMap:c,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:g,unwrappedTileID:a,width:this.transform.width,height:this.transform.height,translation:p},b=He(_,i,r.lineOffsetX*_,r.lineOffsetY*_,!1,r,!1,v);let w=!1,x=!1,S=!0;if(b){const r=.5*h*y+d,n=new t.P(-100,-100),i=new t.P(this.screenRightBoundary,this.screenBottomBoundary),o=new $e,a=b.first,s=b.last;let p=[];for(let e=a.path.length-1;e>=1;e--)p.push(a.path[e]);for(let e=1;e<s.path.length;e++)p.push(s.path[e]);const f=2.5*r;if(c){const e=this.projectPathToScreenSpace(p,v);p=e.some((e=>e.signedDistanceFromCamera<=0))?[]:e.map((e=>e.point))}let g=[];if(p.length>0){const e=p[0].clone(),r=p[0].clone();for(let t=1;t<p.length;t++)e.x=Math.min(e.x,p[t].x),e.y=Math.min(e.y,p[t].y),r.x=Math.max(r.x,p[t].x),r.y=Math.max(r.y,p[t].y);g=e.x>=n.x&&r.x<=i.x&&e.y>=n.y&&r.y<=i.y?[p]:r.x<n.x||e.x>i.x||r.y<n.y||e.y>i.y?[]:t.aJ([p],n.x,n.y,i.x,i.y)}for(const t of g){o.reset(t,.25*r);let n=0;n=o.length<=.5*r?1:Math.ceil(o.paddedLength/f)+1;for(let t=0;t<n;t++){const i=t/Math.max(n-1,1),a=o.lerp(i),s=a.x+st,c=a.y+st;m.push(s,c,r,0);const h=s-r,d=c-r,p=s+r,f=c+r;if(S=S&&this.isOffscreen(h,d,p,f),x=x||this.isInsideGrid(h,d,p,f),"always"!==e&&this.grid.hitTestCircle(s,c,r,e,u)&&(w=!0,!l))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!l&&w||!x||y<this.perspectiveRatioCutoff?[]:m,offscreen:S,collisionDetected:w}}projectPathToScreenSpace(e,r){return function(e){let t=0,r=0,n=0,i=0;for(let o=0;o<e.length;o++)e[o].isOccluded?(n=o+1,i=0):(i++,i>r&&(r=i,t=n));return e.slice(t,t+r)}(function(e,r){const n=t.N();return t.aB(n,r.pitchedLabelPlaneMatrix),e.map((e=>{const t=Ue(e.x,e.y,n,r.getElevation),i=r.transform.projectTileCoordinates(t.point.x,t.point.y,r.unwrappedTileID,r.getElevation);return i.point.x=(.5*i.point.x+.5)*r.width,i.point.y=(.5*-i.point.y+.5)*r.height,i}))}(e,r))}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[],n=new t.aa;for(const h of e){const e=new t.P(h.x+st,h.y+st);n.extend(e),r.push(e)}const{minX:i,minY:o,maxX:a,maxY:s}=n,l=this.grid.query(i,o,a,s).concat(this.ignoredGrid.query(i,o,a,s)),c={},u={};for(const h of l){const e=h.key;if(void 0===c[e.bucketInstanceId]&&(c[e.bucketInstanceId]={}),c[e.bucketInstanceId][e.featureIndex])continue;const n=[new t.P(h.x1,h.y1),new t.P(h.x2,h.y1),new t.P(h.x2,h.y2),new t.P(h.x1,h.y2)];t.aK(r,n)&&(c[e.bucketInstanceId][e.featureIndex]=!0,void 0===u[e.bucketInstanceId]&&(u[e.bucketInstanceId]=[]),u[e.bucketInstanceId].push(e.featureIndex))}return u}insertCollisionBox(e,t,r,n,i,o){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:o,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i,o){const a=r?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:o,overlapMode:t};for(let l=0;l<e.length;l+=4)a.insertCircle(s,e[l],e[l+1],e[l+2])}projectAndGetPerspectiveRatio(e,r,n,i,o){if(o){let n;i?(n=[e,r,i(e,r),1],t.aH(n,n,o)):(n=[e,r,0,1],at(n,n,o));const a=n[3];return{x:(n[0]/a+1)/2*this.transform.width+st,y:(-n[1]/a+1)/2*this.transform.height+st,perspectiveRatio:.5+this.transform.cameraToCenterDistance/a*.5,isOccluded:!1,signedDistanceFromCamera:a}}{const t=this.transform.projectTileCoordinates(e,r,n,i);return{x:(t.point.x+1)/2*this.transform.width+st,y:(1-t.point.y)/2*this.transform.height+st,perspectiveRatio:.5+this.transform.cameraToCenterDistance/t.signedDistanceFromCamera*.5,isOccluded:t.isOccluded,signedDistanceFromCamera:t.signedDistanceFromCamera}}}getPerspectiveRatio(e,t,r,n){const i=this.transform.projectTileCoordinates(e,t,r,n);return.5+this.transform.cameraToCenterDistance/i.signedDistanceFromCamera*.5}isOffscreen(e,t,r,n){return r<st||e>=this.screenRightBoundary||n<st||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const e=t.ar([]);return t.O(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,n,i,o,a,s,l,c,u,h){let d=1,p=0,f=0,m=1;const g=e.anchorPointX+s[0],y=e.anchorPointY+s[1];if(a&&!o){const e=this.projectAndGetPerspectiveRatio(g+1,y,i,c,h),t=e.x-l.x,r=Math.atan((e.y-l.y)/t)+(t<0?Math.PI:0),n=Math.sin(r),o=Math.cos(r);d=o,p=n,f=-n,m=o}else if(!a&&o){const e=je(this.transform);d=e.vecEast[0],p=e.vecEast[1],f=e.vecSouth[0],m=e.vecSouth[1]}let _=l.x,v=l.y,b=r;o&&(_=g,v=y,b=Math.pow(2,-(this.transform.zoom-n.overscaledZ)),b*=this.transform.getPitchedTextCorrection(g,y,i),u||(b*=t.an(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),u&&(_+=d*u.x*b+f*u.y*b,v+=p*u.x*b+m*u.y*b);const w=e.x1*b,x=e.x2*b,S=(w+x)/2,E=e.y1*b,T=e.y2*b,A=(E+T)/2,C=[{offsetX:w,offsetY:E},{offsetX:S,offsetY:E},{offsetX:x,offsetY:E},{offsetX:x,offsetY:A},{offsetX:x,offsetY:T},{offsetX:S,offsetY:T},{offsetX:w,offsetY:T},{offsetX:w,offsetY:A}];let I=[];for(const{offsetX:P,offsetY:M}of C)I.push(new t.P(_+d*P+f*M,v+p*P+m*M));let k=!1;if(o){const e=I.map((e=>this.projectAndGetPerspectiveRatio(e.x,e.y,i,c,h)));k=e.some((e=>!e.isOccluded)),I=e.map((e=>new t.P(e.x,e.y)))}else k=!0;return{box:t.aL(I),allPointsOccluded:!k}}}class ct{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class ut{constructor(e,t,r,n,i){this.text=new ct(e?e.text:null,t,r,i),this.icon=new ct(e?e.icon:null,t,n,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ht{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class dt{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class pt{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function ft(e,r,n,i,o){const{horizontalAlign:a,verticalAlign:s}=t.aS(e);return new t.P(-(a-.5)*r+i[0]*o,-(s-.5)*n+i[1]*o)}class mt{constructor(e,t,r,n,i){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new lt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new pt(n),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const t=this.terrain;return t?(r,n)=>t.getElevation(e,r,n):null}getBucketParts(e,r,n,i){const o=n.getBucket(r),a=n.latestFeatureIndex;if(!o||!a||r.id!==o.layerIds[0])return;const s=n.collisionBoxArray,l=o.layers[0].layout,c=o.layers[0].paint,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),h=n.tileSize/t.a5,d=n.tileID.toUnwrapped(),p="map"===l.get("text-rotation-alignment"),f=t.aN(n,1,this.transform.zoom),m=t.aO(this.collisionIndex.transform,n,c.get("text-translate"),c.get("text-translate-anchor")),g=t.aO(this.collisionIndex.transform,n,c.get("icon-translate"),c.get("icon-translate-anchor")),y=qe(p,this.transform,f);this.retainedQueryData[o.bucketInstanceId]=new dt(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID);const _={bucket:o,layout:l,translationText:m,translationIcon:g,unwrappedTileID:d,pitchedLabelPlaneMatrix:y,scale:u,textPixelRatio:h,holdingForFade:n.holdingForSymbolFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ay(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(const t of o.sortKeyRanges){const{sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i}=t;e.push({sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i,parameters:_})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:_})}attemptAnchorPlacement(e,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b){const w=t.aP[e.textAnchor],x=[e.textOffset0,e.textOffset1],S=ft(w,n,i,x,o),E=this.collisionIndex.placeCollisionBox(r,d,l,c,u,s,a,g,h.predicate,v,S,b);if((!_||this.collisionIndex.placeCollisionBox(_,d,l,c,u,s,a,y,h.predicate,v,S,b).placeable)&&E.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(e=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:x,width:n,height:i,anchor:w,textBoxScale:o,prevAnchor:e},this.markUsedJustification(f,w,p,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,p),this.placedOrientations[p.crossTileID]=m),{shift:S,placedGlyphBoxes:E}}}placeLayerBucketPart(e,r,n){const{bucket:i,layout:o,translationText:a,translationIcon:s,unwrappedTileID:l,pitchedLabelPlaneMatrix:c,textPixelRatio:u,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:p,collisionGroup:f}=e.parameters,m=o.get("text-optional"),g=o.get("icon-optional"),y=t.aQ(o,"text-overlap","text-allow-overlap"),_="always"===y,v=t.aQ(o,"icon-overlap","icon-allow-overlap"),b="always"===v,w="map"===o.get("text-rotation-alignment"),x="map"===o.get("text-pitch-alignment"),S="none"!==o.get("icon-text-fit"),E="viewport-y"===o.get("symbol-z-order"),T=_&&(b||!i.hasIconData()||g),A=b&&(_||!i.hasTextData()||m);!i.collisionArrays&&d&&i.deserializeCollisionBoxes(d);const C=this.retainedQueryData[i.bucketInstanceId].tileID,I=this._getTerrainElevationFunc(C),k=this.transform.getFastPathSimpleProjectionMatrix(C),P=(e,d,b)=>{var E,P;if(r[e.crossTileID])return;if(h)return void(this.placements[e.crossTileID]=new ht(!1,!1,!1));let M=!1,R=!1,D=!0,O=null,L={box:null,placeable:!1,offscreen:null,occluded:!1},B={placeable:!1},$=null,z=null,F=null,q=0,N=0,j=0;d.textFeatureIndex?q=d.textFeatureIndex:e.useRuntimeCollisionCircles&&(q=e.featureIndex),d.verticalTextFeatureIndex&&(N=d.verticalTextFeatureIndex);const U=d.textBox;if(U){const r=r=>{let n=t.az.horizontal;if(i.allowVerticalPlacement&&!r&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,n=t,this.markUsedOrientation(i,n,e))}return n},o=(r,n)=>{if(i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&d.verticalTextBox){for(const e of i.writingModes)if(e===t.az.vertical?(L=n(),B=L):L=r(),L&&L.placeable)break}else L=r()},c=e.textAnchorOffsetStartIndex,h=e.textAnchorOffsetEndIndex;if(h===c){const n=(t,r)=>{const n=this.collisionIndex.placeCollisionBox(t,y,u,C,l,x,w,a,f.predicate,I,void 0,k);return n&&n.placeable&&(this.markUsedOrientation(i,r,e),this.placedOrientations[e.crossTileID]=r),n};o((()=>n(U,t.az.horizontal)),(()=>{const r=d.verticalTextBox;return i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&r?n(r,t.az.vertical):{box:null,offscreen:null}})),r(L&&L.placeable)}else{let p=t.aP[null===(P=null===(E=this.prevPlacement)||void 0===E?void 0:E.variableOffsets[e.crossTileID])||void 0===P?void 0:P.anchor];const m=(t,r,o)=>{const d=t.x2-t.x1,m=t.y2-t.y1,g=e.textBoxScale,_=S&&"never"===v?r:null;let b=null,E="never"===y?1:2,T="never";p&&E++;for(let n=0;n<E;n++){for(let r=c;r<h;r++){const n=i.textAnchorOffsets.get(r);if(p&&n.textAnchor!==p)continue;const c=this.attemptAnchorPlacement(n,t,d,m,g,w,x,u,C,l,f,T,e,i,o,a,s,_,I);if(c&&(b=c.placedGlyphBoxes,b&&b.placeable))return M=!0,O=c.shift,b}p?p=null:T=y}return n&&!b&&(b={box:this.collisionIndex.placeCollisionBox(U,"always",u,C,l,x,w,a,f.predicate,I,void 0,k).box,offscreen:!1,placeable:!1,occluded:!1}),b};o((()=>m(U,d.iconBox,t.az.horizontal)),(()=>{const r=d.verticalTextBox;return i.allowVerticalPlacement&&(!L||!L.placeable)&&e.numVerticalGlyphVertices>0&&r?m(r,d.verticalIconBox,t.az.vertical):{box:null,occluded:!0,offscreen:null}})),L&&(M=L.placeable,D=L.offscreen);const g=r(L&&L.placeable);if(!M&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(i,t.anchor,e,g))}}}if($=L,M=$&&$.placeable,D=$&&$.offscreen,e.useRuntimeCollisionCircles&&e.centerJustifiedTextSymbolIndex>=0){const r=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),s=t.aA(i.textSizeData,p,r),u=o.get("text-padding");z=this.collisionIndex.placeCollisionCircles(y,r,i.lineVertexArray,i.glyphOffsetArray,s,l,c,n,x,f.predicate,e.collisionCircleDiameter,u,a,I),z.circles.length&&z.collisionDetected&&!n&&t.w("Collisions detected, but collision boxes are not shown"),M=_||z.circles.length>0&&!z.collisionDetected,D=D&&z.offscreen}if(d.iconFeatureIndex&&(j=d.iconFeatureIndex),d.iconBox){const e=e=>this.collisionIndex.placeCollisionBox(e,v,u,C,l,x,w,s,f.predicate,I,S&&O?O:void 0,k);B&&B.placeable&&d.verticalIconBox?(F=e(d.verticalIconBox),R=F.placeable):(F=e(d.iconBox),R=F.placeable),D=D&&F.offscreen}const V=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,G=g||0===e.numIconVertices;V||G?G?V||(R=R&&M):M=R&&M:R=M=R&&M;const W=R&&F.placeable;if(M&&$.placeable&&this.collisionIndex.insertCollisionBox($.box,y,o.get("text-ignore-placement"),i.bucketInstanceId,B&&B.placeable&&N?N:q,f.ID),W&&this.collisionIndex.insertCollisionBox(F.box,v,o.get("icon-ignore-placement"),i.bucketInstanceId,j,f.ID),z&&M&&this.collisionIndex.insertCollisionCircles(z.circles,y,o.get("text-ignore-placement"),i.bucketInstanceId,q,f.ID),n&&this.storeCollisionData(i.bucketInstanceId,b,d,$,F,z),0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new ht((M||T)&&!(null==$?void 0:$.occluded),(R||A)&&!(null==F?void 0:F.occluded),D||i.justReloaded),r[e.crossTileID]=!0};if(E){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=i.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let e=t.length-1;e>=0;--e){const r=t[e];P(i.symbolInstances.get(r),i.collisionArrays[r],r)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)P(i.symbolInstances.get(t),i.collisionArrays[t],t);i.justReloaded=!1}storeCollisionData(e,t,r,n,i,o){if(r.textBox||r.iconBox){let o,a;this.collisionBoxArrays.has(e)?o=this.collisionBoxArrays.get(e):(o=new Map,this.collisionBoxArrays.set(e,o)),o.has(t)?a=o.get(t):(a={text:null,icon:null},o.set(t,a)),r.textBox&&(a.text=n.box),r.iconBox&&(a.icon=i.box)}if(o){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=[]);for(let e=0;e<o.circles.length;e+=4)t.push(o.circles[e+0]-st),t.push(o.circles[e+1]-st),t.push(o.circles[e+2]),t.push(o.collisionDetected?1:0)}}markUsedJustification(e,r,n,i){let o;o=i===t.az.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[t.aR(r)];const a=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const t of a)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=o>=0&&t!==o?0:n.crossTileID)}markUsedOrientation(e,r,n){const i=r===t.az.horizontal||r===t.az.horizontalOnly?r:0,o=r===t.az.vertical?r:0,a=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const t of a)e.text.placedSymbolArray.get(t).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=o)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(const s in this.placements){const e=this.placements[s],t=i[s];t?(this.opacities[s]=new ut(t,n,e.text,e.icon),r=r||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[s]=new ut(null,n,e.text,e.icon,e.skipFade),r=r||e.text||e.icon)}for(const s in i){const e=i[s];if(!this.opacities[s]){const t=new ut(e,n,!1,!1);t.isHidden()||(this.opacities[s]=t,r=r||e.text.placed||e.icon.placed)}}for(const s in o)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=o[s]);for(const s in a)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=a[s]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const r={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,n.tileID,r,n.collisionBoxArray)}}updateBucketOpacities(e,r,n,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const o=e.layers[0],a=o.layout,s=new ut(null,0,!1,!1,!0),l=a.get("text-allow-overlap"),c=a.get("icon-allow-overlap"),u=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===a.get("text-rotation-alignment"),d="map"===a.get("text-pitch-alignment"),p="none"!==a.get("icon-text-fit"),f=new ut(null,0,l&&(c||!e.hasIconData()||a.get("icon-optional")),c&&(l||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const m=(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r);e.hasVisibleVertices=e.hasVisibleVertices||r!==Tt},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let y=0;y<e.symbolInstances.length;y++){const r=e.symbolInstances.get(y),{numHorizontalGlyphVertices:i,numVerticalGlyphVertices:o,crossTileID:a}=r;let l=this.opacities[a];n[a]?l=s:l||(l=f,this.opacities[a]=l),n[a]=!0;const c=r.numIconVertices>0,_=this.placedOrientations[r.crossTileID],v=_===t.az.vertical,b=_===t.az.horizontal||_===t.az.horizontalOnly;if(i>0||o>0){const t=Et(l.text);m(e.text,i,v?Tt:t),m(e.text,o,b?Tt:t);const n=l.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=n||v?1:0)})),r.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=n||b?1:0);const a=this.variableOffsets[r.crossTileID];a&&this.markUsedJustification(e,a.anchor,r,_);const s=this.placedOrientations[r.crossTileID];s&&(this.markUsedJustification(e,"left",r,s),this.markUsedOrientation(e,s,r))}if(c){const t=Et(l.icon),n=!(p&&r.verticalPlacedIconSymbolIndex&&v);r.placedIconSymbolIndex>=0&&(m(e.icon,r.numIconVertices,n?t:Tt),e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=l.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,r.numVerticalIconVertices,n?Tt:t),e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=l.icon.isHidden())}const w=g&&g.has(y)?g.get(y):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const r=e.collisionArrays[y];if(r){let n=new t.P(0,0);if(r.textBox||r.verticalTextBox){let t=!0;if(u){const e=this.variableOffsets[a];e?(n=ft(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),h&&n._rotate(d?-this.transform.bearingInRadians:this.transform.bearingInRadians)):t=!1}if(r.textBox||r.verticalTextBox){let i;r.textBox&&(i=v),r.verticalTextBox&&(i=b),gt(e.textCollisionBox.collisionVertexArray,l.text.placed,!t||i,w.text,n.x,n.y)}}if(r.iconBox||r.verticalIconBox){const t=Boolean(!b&&r.verticalIconBox);let i;r.iconBox&&(i=t),r.verticalIconBox&&(i=!t),gt(e.iconCollisionBox.collisionVertexArray,l.icon.placed,i,w.icon,p?n.x:0,p?n.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function gt(e,t,r,n,i,o){n&&0!==n.length||(n=[0,0,0,0]);const a=n[0]-st,s=n[1]-st,l=n[2]-st,c=n[3]-st;e.emplaceBack(t?1:0,r?1:0,i||0,o||0,a,s),e.emplaceBack(t?1:0,r?1:0,i||0,o||0,l,s),e.emplaceBack(t?1:0,r?1:0,i||0,o||0,l,c),e.emplaceBack(t?1:0,r?1:0,i||0,o||0,a,c)}const yt=Math.pow(2,25),_t=Math.pow(2,24),vt=Math.pow(2,17),bt=Math.pow(2,16),wt=Math.pow(2,9),xt=Math.pow(2,8),St=Math.pow(2,1);function Et(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*yt+t*_t+r*vt+t*bt+r*wt+t*xt+r*St+t}const Tt=0;class At{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){const o=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(o,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<o.length;)if(t.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0;return!1}}class Ct{constructor(e,t,r,n,i,o,a,s){this.placement=new mt(e,t,o,a,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){const n=c(),i=()=>!this._forceFullPlacement&&c()-n>2;for(;this._currentPlacementIndex>=0;){const n=t[e[this._currentPlacementIndex]],o=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=o)&&(!n.maxzoom||n.maxzoom>o)){if(this._inProgressLayer||(this._inProgressLayer=new At(n)),this._inProgressLayer.continuePlacement(r[n.source],this.placement,this._showCollisionBoxes,n,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const It=512/t.a5/2;class kt{constructor(e,r,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};const i=new Map;for(let t=0;t<r.length;t++){const e=r.get(t),n=e.key,o=i.get(n);o?o.push(e):i.set(n,[e])}for(const[o,a]of i){const e={positions:a.map((e=>({x:Math.floor(e.anchorX*It),y:Math.floor(e.anchorY*It)}))),crossTileIDs:a.map((e=>e.crossTileID))};if(e.positions.length>128){const r=new t.aT(e.positions.length,16,Uint16Array);for(const{x:t,y:n}of e.positions)r.add(t,n);r.finish(),delete e.positions,e.index=r}this._symbolsByKey[o]=e}}getScaledCoordinates(e,r){const{x:n,y:i,z:o}=this.tileID.canonical,{x:a,y:s,z:l}=r.canonical,c=It/Math.pow(2,l-o),u=(s*t.a5+e.anchorY)*c,h=i*t.a5*It;return{x:Math.floor((a*t.a5+e.anchorX)*c-n*t.a5*It),y:Math.floor(u-h)}}findMatches(e,t,r){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const o=e.get(i);if(o.crossTileID)continue;const a=this._symbolsByKey[o.key];if(!a)continue;const s=this.getScaledCoordinates(o,t);if(a.index){const e=a.index.range(s.x-n,s.y-n,s.x+n,s.y+n).sort();for(const t of e){const e=a.crossTileIDs[t];if(!r[e]){r[e]=!0,o.crossTileID=e;break}}}else if(a.positions)for(let e=0;e<a.positions.length;e++){const t=a.positions[e],i=a.crossTileIDs[e];if(Math.abs(t.x-s.x)<=n&&Math.abs(t.y-s.y)<=n&&!r[i]){r[i]=!0,o.crossTileID=i;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class Pt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Mt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const r in this.indexes){const e=this.indexes[r],n={};for(const r in e){const i=e[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[r]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const i in this.indexes){const r=this.indexes[i];if(Number(i)>e.overscaledZ)for(const i in r){const o=r[i];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,n)}else{const o=r[e.scaledTo(Number(i)).key];o&&o.findMatches(t.symbolInstances,e,n)}}for(let i=0;i<t.symbolInstances.length;i++){const e=t.symbolInstances.get(i);e.crossTileID||(e.crossTileID=r.generate(),n[e.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new kt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r of t.getCrossTileIDsLists())for(const t of r)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const r in this.indexes){const n=this.indexes[r];for(const i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}class Rt{constructor(){this.layerIndexes={},this.crossTileIDs=new Pt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Mt);let i=!1;const o={};n.handleWrapJump(r);for(const a of t){const t=a.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(a.tileID,t,this.crossTileIDs)&&(i=!0),o[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(i=!0),i}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const r in this.layerIndexes)t[r]||delete this.layerIndexes[r]}}var Dt="void main() {fragColor=vec4(1.0);}";const Ot={prelude:Lt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;"),projectionMercator:Lt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Lt("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),background:Lt("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Lt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Lt("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Lt(Dt,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Lt("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),heatmapTexture:Lt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Lt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Lt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Lt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else\n{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Lt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Lt(Dt,"in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:Lt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:Lt("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillOutlinePattern:Lt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillPattern:Lt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Lt("in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Lt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Lt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Lt("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Lt("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Lt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Lt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Lt("uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}"),lineGradientSDF:Lt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define mediump vec4 dasharray_from\n#pragma mapbox: define mediump vec4 dasharray_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dasharray_from\n#pragma mapbox: initialize mediump vec4 dasharray_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nfloat u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}"),raster:Lt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Lt("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Lt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Lt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Lt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Lt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Lt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Lt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Lt("#ifdef GL_ES\nprecision highp float;\n#endif\nin vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Lt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Lt(e,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/in ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(i):i,s={};return{fragmentSource:e=e.replace(r,((e,t,r,n,i)=>(s[i]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nin ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = u_${i};\n#endif\n`))),vertexSource:t=t.replace(r,((e,t,r,n,i)=>{const o="float"===n?"vec2":"vec4",a=i.match(/color/)?"color":o;return s[i]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${o} a_${i};\nout ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${a}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${o} a_${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = unpack_mix_${a}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`})),staticAttributes:n,staticUniforms:a}}class Bt{constructor(e,t,r){this.vertexBuffer=e,this.indexBuffer=t,this.segments=r}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $t=t.aU([{name:"a_pos",type:"Int16",components:2}]);const zt="#define PROJECTION_MERCATOR",Ft="mercator";class qt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ft}get shaderDefine(){return zt}get shaderPreludeCode(){return Ot.projectionMercator}get vertexShaderPreludeCode(){return Ot.projectionMercator.vertexSource}get subdivisionGranularity(){return t.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,n,i,o){if(this._cachedMesh)return this._cachedMesh;const a=new t.aW;a.emplaceBack(0,0),a.emplaceBack(t.a5,0),a.emplaceBack(0,t.a5),a.emplaceBack(t.a5,t.a5);const s=e.createVertexBuffer(a,$t.members),l=t.aX.simpleSegment(0,0,4,2),c=new t.aY;c.emplaceBack(1,0,2),c.emplaceBack(1,2,3);const u=e.createIndexBuffer(c);return this._cachedMesh=new Bt(s,u,l),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Nt{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,r,n){return null!=r.top&&null!=e.top&&(this.top=t.G.number(e.top,r.top,n)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.G.number(e.bottom,r.bottom,n)),null!=r.left&&null!=e.left&&(this.left=t.G.number(e.left,r.left,n)),null!=r.right&&null!=e.right&&(this.right=t.G.number(e.right,r.right,n)),this}getCenter(e,r){const n=t.an((this.left+e-this.right)/2,0,e),i=t.an((this.top+r-this.bottom)/2,0,r);return new t.P(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Nt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function jt(e,t){if(!e.renderWorldCopies||e.lngRange)return;const r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}function Ut(e){return Math.max(0,Math.floor(e))}class Vt{constructor(e,r){var n;this.applyConstrain=(e,t)=>null!==this._constrainOverride?this._constrainOverride(e,t):this._callbacks.defaultConstrain(e,t),this._callbacks=e,this._tileSize=512,this._renderWorldCopies=void 0===(null==r?void 0:r.renderWorldCopies)||!!(null==r?void 0:r.renderWorldCopies),this._minZoom=(null==r?void 0:r.minZoom)||0,this._maxZoom=(null==r?void 0:r.maxZoom)||22,this._minPitch=null==(null==r?void 0:r.minPitch)?0:null==r?void 0:r.minPitch,this._maxPitch=null==(null==r?void 0:r.maxPitch)?60:null==r?void 0:r.maxPitch,this._constrainOverride=null!==(n=null==r?void 0:r.constrainOverride)&&void 0!==n?n:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new t.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ut(this._zoom),this._scale=t.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Nt,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,n){this._constrainOverride=e.constrainOverride,this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ut(this._zoom),this._scale=t.aq(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Nt(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!n&&e.autoCalculateNearFarZ,r&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get constrainOverride(){return this._constrainOverride}setConstrainOverride(e){void 0===e&&(e=null),this._constrainOverride!==e&&(this._constrainOverride=e,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=t.W(e,-180,180)*Math.PI/180;var i,o,a,s,l,c,u,h,d;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=n(),i=this._rotationMatrix,a=-this._bearingInRadians,s=(o=this._rotationMatrix)[0],l=o[1],c=o[2],u=o[3],h=Math.sin(a),d=Math.cos(a),i[0]=s*d+c*h,i[1]=l*d+u*h,i[2]=s*-h+c*d,i[3]=l*-h+u*d)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=t.an(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const t=e/180*Math.PI;this._rollInRadians!==t&&(this._unmodified=!1,this._rollInRadians=t,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return t.aZ(this._fovInRadians)}setFov(e){e=t.an(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=t.ap(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.applyConstrain(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=t.aq(r),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,t){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=t,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this.constrainInternal(),this._calcMatrices()}resize(e,t,r=!0){this._width=e,this._height=t,r&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new H([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-t.ao,t.ao])}getCameraQueryGeometry(e,r){if(1===r.length)return[r[0],e];{const{minX:n,minY:i,maxX:o,maxY:a}=t.aa.fromPoints(r).extend(e);return[new t.P(n,i),new t.P(o,i),new t.P(o,a),new t.P(n,a),new t.P(n,i)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:t,zoom:r}=this.applyConstrain(this.center,this.zoom);this.setCenter(t),this.setZoom(r),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=t.ar(new Float64Array(16));t.Q(e,e,[this._width/2,-this._height/2,1]),t.O(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=t.ar(new Float64Array(16)),t.Q(e,e,[1,-1,1]),t.O(e,e,[-1,-1,0]),t.Q(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,n,i){const o=void 0!==n?n:this.bearing,a=i=void 0!==i?i:this.pitch,{distanceToCenter:s,clampedElevation:l}=this._distanceToCenterFromAltElevationPitch(r,this.elevation,a),{x:c,y:u}=we(a,o),h=t.a9.fromLngLat(e,r);let d,p,f=t.a_(1,h.y),m=0;do{if(m+=1,m>10)break;p=s/f,d=new t.a9(h.x+c*p,h.y+u*p),f=1/d.meterInMercatorCoordinateUnits()}while(Math.abs(s-p*f)>1e-12);return{center:d.toLngLat(),elevation:l,zoom:t.at(this.height/2/Math.tan(this.fovInRadians/2)/p/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=1/this.worldSize,n=t.as(1,this.center.lat)*this.worldSize,i=t.a9.fromLngLat(this.center,this.elevation),o=i.x/r,a=i.y/r,s=i.z/r,l=this.pitch,c=this.bearing,{x:u,y:h,z:d}=we(l,c),p=this.cameraToCenterDistance,f=o+p*-u,m=a+p*-h,g=s+p*d,{distanceToCenter:y,clampedElevation:_}=this._distanceToCenterFromAltElevationPitch(g/n,e,l),v=y*n,b=new t.a9((f+u*v)*r,(m+h*v)*r,0).toLngLat(),w=t.as(1,b.lat),x=t.at(this.height/2/Math.tan(this.fovInRadians/2)/y/w/this.tileSize);this._elevation=_,this._center=b,this.setZoom(x)}_distanceToCenterFromAltElevationPitch(e,r,n){const i=-Math.cos(t.ap(n)),o=e-r;let a,s=r;return i*o>=0||Math.abs(i)<.1?(a=1e4,s=e+a*i):a=-o/i,{distanceToCenter:a,clampedElevation:s}}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=t.as(1,this.center.lat)*this.worldSize;return be(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/t.a5,1/r/t.a5]}}class Gt{constructor(e,r){this.min=e,this.max=r,this.center=t.a$([],t.b0([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],n=t.b1(this.min),i=t.b1(this.max);for(let t=0;t<r.length;t++)n[t]=r[t]?this.min[t]:this.center[t],i[t]=r[t]?this.center[t]:this.max[t];return i[2]=this.max[2],new Gt(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let t=!0;for(let r=0;r<e.planes.length;r++){const n=this.intersectsPlane(e.planes[r]);if(0===n)return 0;1===n&&(t=!1)}return t?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let t=e[3],r=e[3];for(let n=0;n<3;n++)e[n]>0?(t+=e[n]*this.min[n],r+=e[n]*this.max[n]):(r+=e[n]*this.min[n],t+=e[n]*this.max[n]);return t>=0?2:r<0?0:1}}class Wt{distanceToTile2d(e,t,r,n){const i=n.distanceX([e,t]),o=n.distanceY([e,t]);return Math.hypot(i,o)}getWrap(e,t,r){return r}getTileBoundingVolume(e,r,n,i){var o,a;let s=0,l=0;if(null==i?void 0:i.terrain){const c=new t.a2(e.z,r,e.z,e.x,e.y),u=i.terrain.getMinMaxElevation(c);s=null!==(o=u.minElevation)&&void 0!==o?o:Math.min(0,n),l=null!==(a=u.maxElevation)&&void 0!==a?a:Math.max(0,n)}const c=1<<e.z;return new Gt([r+e.x/c,e.y/c,s],[r+(e.x+1)/c,(e.y+1)/c,l])}allowVariableZoom(e,r){const n=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,i=t.an(78.5-n/2,0,60);return!!r.terrain||e.pitch>i}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ht{constructor(e,t,r){this.points=e,this.planes=t,this.aabb=r}static fromInvProjectionMatrix(e,r=1,n=0,i,o){const a=o?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],s=Math.pow(2,n),l=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>function(e,r,n,i){const o=t.aH([],e,r),a=1/o[3]/n*i;return t.b6(o,o,[a,a,1/o[3],a])}(n,e,r,s)));i&&function(e,r,n,i){const o=i?4:0,a=i?0:4;let s=0;const l=[],c=[];for(let d=0;d<4;d++){const r=t.b2([],e[d+a],e[d+o]),n=t.b7(r);t.a$(r,r,1/n),l.push(n),c.push(r)}for(let d=0;d<4;d++){const r=t.b8(e[d+o],c[d],n);s=null!==r&&r>=0?Math.max(s,r):Math.max(s,l[d])}const u=function(e,r){const n=t.b2([],e[r[0]],e[r[1]]),i=t.b2([],e[r[2]],e[r[1]]),o=[0,0,0,0];return t.b3(o,t.b4([],n,i)),o[3]=-t.b5(o,e[r[0]]),o}(e,r),h=function(e,r){const n=t.b9(e),i=t.ba([],e,1/n),o=t.b2([],r,t.a$([],i,t.b5(r,i))),a=t.b9(o);if(a>0){const e=Math.sqrt(1-i[3]*i[3]),n=t.a$([],i,-i[3]),s=t.b0([],n,t.a$([],o,e/a));return t.bb(r,s)}return null}(n,u);if(null!==h){const e=h/t.b5(c[0],u);s=Math.min(s,e)}for(let t=0;t<4;t++){const r=Math.min(s,l[t]);e[t+a]=[e[t+o][0]+c[t][0]*r,e[t+o][1]+c[t][1]*r,e[t+o][2]+c[t][2]*r,1]}}(l,a[0],i,o);const c=a.map((e=>{const r=t.b2([],l[e[0]],l[e[1]]),n=t.b2([],l[e[2]],l[e[1]]),i=t.b3([],t.b4([],r,n)),o=-t.b5(i,l[e[1]]);return i.concat(o)})),u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],h=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const t of l)for(let e=0;e<3;e++)u[e]=Math.min(u[e],t[e]),h[e]=Math.max(h[e],t[e]);return new Ht(l,c,new Gt(u,h))}}class Zt{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,t){}constructor(e){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(e,r)=>{r=t.an(+r,this.minZoom,this.maxZoom);const n={center:new t.V(e.lng,e.lat),zoom:r};let i=this._helper._lngRange;if(!this._helper._renderWorldCopies&&null===i){const e=180-1e-10;i=[-e,e]}const o=this.tileSize*t.aq(n.zoom);let a=0,s=o,l=0,c=o,u=0,h=0;const{x:d,y:p}=this.size;if(this._helper._latRange){const e=this._helper._latRange;a=t.X(e[1])*o,s=t.X(e[0])*o,s-a<p&&(u=p/(s-a))}i&&(l=t.W(t.Y(i[0])*o,0,o),c=t.W(t.Y(i[1])*o,0,o),c<l&&(c+=o),c-l<d&&(h=d/(c-l)));const{x:f,y:m}=ge(o,e);let g,y;const _=Math.max(h||0,u||0);if(_){const e=new t.P(h?(c+l)/2:f,u?(s+a)/2:m);return n.center=ye(o,e).wrap(),n.zoom+=t.at(_),n}if(this._helper._latRange){const e=p/2;m-e<a&&(y=a+e),m+e>s&&(y=s-e)}if(i){const e=(l+c)/2;let r=f;this._helper._renderWorldCopies&&(r=t.W(f,e-o/2,e+o/2));const n=d/2;r-n<l&&(g=l+n),r+n>c&&(g=c-n)}if(void 0!==g||void 0!==y){const e=new t.P(null!=g?g:f,null!=y?y:m);n.center=ye(o,e).wrap()}return n},this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Vt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._coveringTilesDetailsProvider=new Wt}clone(){const e=new Zt;return e.apply(this,!1),e}apply(e,t,r){this._helper.apply(e,t,r)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new t.bc(0,e)];if(this._helper._renderWorldCopies){const n=this.screenPointToMercatorCoordinate(new t.P(0,0)),i=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,0)),o=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,this._helper._height)),a=this.screenPointToMercatorCoordinate(new t.P(0,this._helper._height)),s=Math.floor(Math.min(n.x,i.x,o.x,a.x)),l=Math.floor(Math.max(n.x,i.x,o.x,a.x)),c=1;for(let u=s-c;u<=l+c;u++)0!==u&&r.push(new t.bc(u,e))}return r}getCameraFrustum(){return Ht.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const t=this.screenPointToLocation(this.centerPoint,e),r=e?e.getElevationForLngLatZoom(t,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(r)}setLocationAtPoint(e,r){const n=t.as(this.elevation,this.center.lat),i=this.screenPointToMercatorCoordinateAtZ(r,n),o=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,n),a=t.a9.fromLngLat(e),s=new t.a9(a.x-(i.x-o.x),a.y-(i.y-o.y));this.setCenter(null==s?void 0:s.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(t.a9.fromLngLat(e),r.getElevationForLngLat(e,this),this._pixelMatrix3D):this.coordinatePoint(t.a9.fromLngLat(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}screenPointToMercatorCoordinate(e,t){if(t){const r=t.pointCoordinate(e);if(null!=r)return r}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const n=r||0,i=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.aH(i,i,this._pixelMatrixInverse),t.aH(o,o,this._pixelMatrixInverse);const a=i[3],s=o[3],l=i[1]/a,c=o[1]/s,u=i[2]/a,h=o[2]/s,d=u===h?0:(n-u)/(h-u);return new t.a9(t.G.number(i[0]/a,o[0]/s,d)/this.worldSize,t.G.number(l,c,d)/this.worldSize,n)}coordinatePoint(e,r=0,n=this._pixelMatrix){const i=[e.x*this.worldSize,e.y*this.worldSize,r,1];return t.aH(i,i,n),new t.P(i[0]/i[3],i[1]/i[3])}getBounds(){const e=Math.max(0,this._helper._height/2-_e(this));return(new H).extend(this.screenPointToLocation(new t.P(0,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new t.P(0,this._helper._height)))}isPointOnMapSurface(e,t){return t?null!=t.pointCoordinate(e):e.y>this.height/2-_e(this)}calculatePosMatrix(e,r=!1,n){var i;const o=null!==(i=e.key)&&void 0!==i?i:t.bd(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),a=r?this._alignedPosMatrixCache:this._posMatrixCache;if(a.has(o)){const e=a.get(o);return n?e.f32:e.f64}const s=ve(e,this.worldSize);t.S(s,r?this._alignedProjMatrix:this._viewProjMatrix,s);const l={f64:s,f32:new Float32Array(s)};return a.set(o,l),n?l.f32:l.f64}calculateFogMatrix(e){const r=e.key,n=this._fogMatrixCacheF32;if(n.has(r))return n.get(r);const i=ve(e,this.worldSize);return t.S(i,this._fogMatrix,i),n.set(r,new Float32Array(i)),n.get(r)}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}_calculateNearFarZIfNeeded(e,r,n){if(!this._helper.autoCalculateNearFarZ)return;const i=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),o=e-i*this._helper._pixelPerMeter/Math.cos(r),a=i<0?o:e,s=Math.PI/2+this.pitchInRadians,l=t.ap(this.fov)*(Math.abs(Math.cos(t.ap(this.roll)))*this.height+Math.abs(Math.sin(t.ap(this.roll)))*this.width)/this.height*(.5+n.y/this.height),c=Math.sin(l)*a/Math.sin(t.an(Math.PI-s-l,.01,Math.PI-.01)),u=_e(this),h=Math.atan(u/this._helper.cameraToCenterDistance),d=t.ap(.75),p=h>d?2*h*(.5+n.y/(2*u)):d,f=Math.sin(p)*a/Math.sin(t.an(Math.PI-s-p,.01,Math.PI-.01)),m=Math.min(c,f);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*m+a),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=ge(this.worldSize,this.center),n=r.x,i=r.y;this._helper._pixelPerMeter=t.as(1,this.center.lat)*this.worldSize;const o=t.ap(Math.min(this.pitch,me)),a=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(o));let s;this._calculateNearFarZIfNeeded(a,o,e),s=new Float64Array(16),t.be(s,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),t.aB(this._invProjMatrix,s),s[8]=2*-e.x/this._helper._width,s[9]=2*e.y/this._helper._height,this._projectionMatrix=t.bf(s),t.Q(s,s,[1,-1,1]),t.O(s,s,[0,0,-this._helper.cameraToCenterDistance]),t.bg(s,s,-this.rollInRadians),t.bh(s,s,this.pitchInRadians),t.bg(s,s,-this.bearingInRadians),t.O(s,s,[-n,-i,0]),this._mercatorMatrix=t.Q([],s,[this.worldSize,this.worldSize,this.worldSize]),t.Q(s,s,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=t.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,s),t.O(s,s,[0,0,-this.elevation]),this._viewProjMatrix=s,this._invViewProjMatrix=t.aB([],s);const l=[0,0,-1,1];t.aH(l,l,this._invViewProjMatrix),this._cameraPosition=[l[0]/l[3],l[1]/l[3],l[2]/l[3]],this._fogMatrix=new Float64Array(16),t.be(this._fogMatrix,this.fovInRadians,this.width/this.height,a,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,t.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),t.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),t.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),t.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),t.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),t.O(this._fogMatrix,this._fogMatrix,[-n,-i,0]),t.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),t.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=t.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,s);const c=this._helper._width%2/2,u=this._helper._height%2/2,h=Math.cos(this.bearingInRadians),d=Math.sin(-this.bearingInRadians),p=n-Math.round(n)+h*c+d*u,f=i-Math.round(i)+h*u+d*c,m=new Float64Array(s);if(t.O(m,m,[p>.5?p-1:p,f>.5?f-1:f,0]),this._alignedProjMatrix=m,s=t.aB(new Float64Array(16),this._pixelMatrix),!s)throw new Error("failed to invert matrix");this._pixelMatrixInverse=s,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new t.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.aH(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=t.as(1,this.center.lat)*this.worldSize;return be(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const n=t.a9.fromLngLat(e),i=[n.x*this.worldSize,n.y*this.worldSize,r,1];return t.aH(i,i,this._viewProjMatrix),i[2]/i[3]}getProjectionData(e){const{overscaledTileID:r,aligned:n,applyTerrainMatrix:i}=e,o=this._helper.getMercatorTileCoordinates(r),a=r?this.calculatePosMatrix(r,n,!0):null;let s;return s=r&&r.terrainRttPosMatrix32f&&i?r.terrainRttPosMatrix32f:a||t.bi(),{mainMatrix:s,tileMercatorCoords:o,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:s}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,t,r){return 1}transformLightDirection(e){return t.b1(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,n,i){const o=this.calculatePosMatrix(n);let a;i?(a=[e,r,i(e,r),1],t.aH(a,a,o)):(a=[e,r,0,1],at(a,a,o));const s=a[3];return{point:new t.P(a[0]/s,a[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}populateCache(e){for(const t of e)this.calculatePosMatrix(t)}getMatrixForModel(e,r){const n=t.a9.fromLngLat(e,r),i=n.meterInMercatorCoordinateUnits(),o=t.bj();return t.O(o,o,[n.x,n.y,n.z]),t.bg(o,o,Math.PI),t.bh(o,o,Math.PI/2),t.Q(o,o,[-i,i,i]),o}getProjectionDataForCustomLayer(e=!0){const r=new t.a2(0,0,0,0,0),n=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),i=ve(r,this.worldSize);t.S(i,this._viewProjMatrix,i),n.tileMercatorCoords=[0,0,1,1];const o=[t.a5,t.a5,this.worldSize/this._helper.pixelsPerMeter],a=t.bk();return t.Q(a,i,o),n.fallbackMatrix=a,n.mainMatrix=a,n}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Yt(){t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Xt(e){if(e.useSlerp)if(e.k<1){const r=t.bl(e.startEulerAngles.roll,e.startEulerAngles.pitch,e.startEulerAngles.bearing),n=t.bl(e.endEulerAngles.roll,e.endEulerAngles.pitch,e.endEulerAngles.bearing),i=new Float64Array(4);t.bm(i,r,n,e.k);const o=t.bn(i);e.tr.setRoll(o.roll),e.tr.setPitch(o.pitch),e.tr.setBearing(o.bearing)}else e.tr.setRoll(e.endEulerAngles.roll),e.tr.setPitch(e.endEulerAngles.pitch),e.tr.setBearing(e.endEulerAngles.bearing);else e.tr.setRoll(t.G.number(e.startEulerAngles.roll,e.endEulerAngles.roll,e.k)),e.tr.setPitch(t.G.number(e.startEulerAngles.pitch,e.endEulerAngles.pitch,e.k)),e.tr.setBearing(t.G.number(e.startEulerAngles.bearing,e.endEulerAngles.bearing,e.k))}function Kt(e,r,n,i,o){const a=o.padding,s=ge(o.worldSize,n.getNorthWest()),l=ge(o.worldSize,n.getNorthEast()),c=ge(o.worldSize,n.getSouthEast()),u=ge(o.worldSize,n.getSouthWest()),h=t.ap(-i),d=s.rotate(h),p=l.rotate(h),f=c.rotate(h),m=u.rotate(h),g=new t.P(Math.max(d.x,p.x,m.x,f.x),Math.max(d.y,p.y,m.y,f.y)),y=new t.P(Math.min(d.x,p.x,m.x,f.x),Math.min(d.y,p.y,m.y,f.y)),_=g.sub(y),v=(o.width-(a.left+a.right+r.left+r.right))/_.x,b=(o.height-(a.top+a.bottom+r.top+r.bottom))/_.y;if(b<0||v<0)return void Yt();const w=Math.min(t.at(o.scale*Math.min(v,b)),e.maxZoom),x=t.P.convert(e.offset),S=new t.P((r.left-r.right)/2,(r.top-r.bottom)/2).rotate(t.ap(i)),E=x.add(S).mult(o.scale/t.aq(w));return{center:ye(o.worldSize,s.add(c).div(2).sub(E)),zoom:w,bearing:i}}class Qt{get useGlobeControls(){return!1}handlePanInertia(e,t){const r=e.mag(),n=Math.abs(_e(t));return{easingOffset:e.mult(Math.min(.75*n/r,1)),easingCenter:t.center}}handleMapControlsRollPitchBearingZoom(e,t){e.bearingDelta&&t.setBearing(t.bearing+e.bearingDelta),e.pitchDelta&&t.setPitch(t.pitch+e.pitchDelta),e.rollDelta&&t.setRoll(t.roll+e.rollDelta),e.zoomDelta&&t.setZoom(t.zoom+e.zoomDelta)}handleMapControlsPan(e,t,r){e.around.distSqr(t.centerPoint)<.01||t.setLocationAtPoint(r,e.around)}cameraForBoxAndBearing(e,t,r,n,i){return Kt(e,t,r,n,i)}handleJumpToCenterZoom(e,r){e.zoom!==(void 0!==r.zoom?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),void 0!==r.center&&e.setCenter(t.V.convert(r.center))}handleEaseTo(e,r){const n=e.zoom,i=e.padding,o={roll:e.roll,pitch:e.pitch,bearing:e.bearing},a={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},s=void 0!==r.zoom,l=!e.isPaddingEqual(r.padding);let c=!1;const u=s?+r.zoom:e.zoom;let h=e.centerPoint.add(r.offsetAsPoint);const d=e.screenPointToLocation(h),{center:p,zoom:f}=e.applyConstrain(t.V.convert(r.center||d),null!=u?u:n);jt(e,p);const m=ge(e.worldSize,d),g=ge(e.worldSize,p).sub(m),y=t.aq(f-n);return c=f!==n,{easeFunc:s=>{if(c&&e.setZoom(t.G.number(n,f,s)),t.bo(o,a)||Xt({startEulerAngles:o,endEulerAngles:a,tr:e,k:s,useSlerp:o.roll!=a.roll}),l&&(e.interpolatePadding(i,r.padding,s),h=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const r=t.aq(e.zoom-n),i=f>n?Math.min(2,y):Math.max(.5,y),o=Math.pow(i,1-s),a=ye(e.worldSize,m.add(g.mult(s*o)).mult(r));e.setLocationAtPoint(e.renderWorldCopies?a.wrap():a,h)}},isZooming:c,elevationCenter:p}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.zoom,o=e.applyConstrain(t.V.convert(r.center||r.locationAtOffset),n?+r.zoom:i),a=o.center,s=o.zoom;jt(e,a);const l=ge(e.worldSize,r.locationAtOffset),c=ge(e.worldSize,a).sub(l),u=c.mag(),h=t.aq(s-i);let d;if(void 0!==r.minZoom){const n=Math.min(+r.minZoom,i,s),o=e.applyConstrain(a,n).zoom;d=t.aq(o-i)}return{easeFunc:(r,n,o,u)=>{e.setZoom(1===r?s:i+t.at(n));const h=1===r?a:ye(e.worldSize,l.add(c.mult(o)).mult(n));e.setLocationAtPoint(e.renderWorldCopies?h.wrap():h,u)},scaleOfZoom:h,targetCenter:a,scaleOfMinZoom:d,pixelPathLength:u}}}class Jt{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}Jt.Replace=[1,0],Jt.disabled=new Jt(Jt.Replace,t.bp.transparent,[!1,!1,!1,!1]),Jt.unblended=new Jt(Jt.Replace,t.bp.transparent,[!0,!0,!0,!0]),Jt.alphaBlended=new Jt([1,771],t.bp.transparent,[!0,!0,!0,!0]);const er=2305;class tr{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}tr.disabled=new tr(!1,1029,er),tr.backCCW=new tr(!0,1029,er),tr.frontCCW=new tr(!0,1028,er);class rr{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}rr.ReadOnly=!1,rr.ReadWrite=!0,rr.disabled=new rr(519,rr.ReadOnly,[0,1]);const nr=7680;class ir{constructor(e,t,r,n,i,o){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=o}}ir.disabled=new ir({func:519,mask:0},0,0,nr,nr,nr);const or=new WeakMap;function ar(e){var t;if(or.has(e))return or.get(e);{const r=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return or.set(e,r),r}}class sr{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,n=r.gl;this._texFormat=n.RGBA,this._texType=n.UNSIGNED_BYTE;const i=new t.aW;i.emplaceBack(-1,-1),i.emplaceBack(2,-1),i.emplaceBack(-1,2);const o=new t.aY;o.emplaceBack(0,1,2),this._fullscreenTriangle=new Bt(r.createVertexBuffer(i,$t.members),r.createIndexBuffer(o),t.aX.simpleSegment(0,0,i.length,o.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(n.TEXTURE1);const a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(a),ar(n)&&(this._pbo=n.createBuffer(),n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.bufferData(n.PIXEL_PACK_BUFFER,4,n.STREAM_READ),n.bindBuffer(n.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,t){const r=this._updateCount;return this._readbackQueue?r>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():r>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,t),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,t=e.gl;e.activeTexture.set(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const n=this._cachedRenderContext.context,i=n.gl;if(this._bindFramebuffer(),n.viewport.set([0,0,this._texWidth,this._texHeight]),n.clear({color:t.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(n,i.TRIANGLES,rr.disabled,ir.disabled,Jt.unblended,tr.disabled,((e,t)=>({u_input:e,u_output_expected:t}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ar(i)){i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),i.bindBuffer(i.PIXEL_PACK_BUFFER,null);const e=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);i.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:e}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ar(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return t.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=sr._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let t=0;return t+=e[0]/256,t+=e[1]/65536,t+=e[2]/16777216,e[3]<127&&(t=-t),t/128}}const lr=t.a5/128;function cr(e,r){const n=void 0!==e.granularity?Math.max(e.granularity,1):1,i=n+(e.generateBorders?2:0),o=n+(e.extendToNorthPole||e.generateBorders?1:0)+(e.extendToSouthPole||e.generateBorders?1:0),a=i+1,s=o+1,l=e.generateBorders?-1:0,c=e.generateBorders||e.extendToNorthPole?-1:0,u=n+(e.generateBorders?1:0),h=n+(e.generateBorders||e.extendToSouthPole?1:0),d=a*s,p=i*o*6,f=a*s>65536;if(f&&"16bit"===r)throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const m=f||"32bit"===r,g=new Int16Array(2*d);let y=0;for(let b=c;b<=h;b++)for(let r=l;r<=u;r++){let i=r/n*t.a5;-1===r&&(i=-lr),r===n+1&&(i=t.a5+lr);let o=b/n*t.a5;-1===b&&(o=e.extendToNorthPole?t.br:-lr),b===n+1&&(o=e.extendToSouthPole?t.bs:t.a5+lr),g[y++]=i,g[y++]=o}const _=m?new Uint32Array(p):new Uint16Array(p);let v=0;for(let t=0;t<o;t++)for(let e=0;e<i;e++){const r=e+1+t*a,n=e+(t+1)*a,i=e+1+(t+1)*a;_[v++]=e+t*a,_[v++]=n,_[v++]=r,_[v++]=r,_[v++]=n,_[v++]=i}return{vertices:g.buffer.slice(0),indices:_.buffer.slice(0),uses32bitIndices:m}}const ur=new t.aV({fill:new t.bt(128,2),line:new t.bt(512,0),tile:new t.bt(128,32),stencil:new t.bt(128,1),circle:3});class hr{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ot.projectionGlobe}get vertexShaderPreludeCode(){return Ot.projectionMercator.vertexSource}get subdivisionGranularity(){return ur}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new sr(e));const r=t.X(this._errorQueryLatitudeDegrees),n=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,i=this._errorMeasurement.updateErrorLoop(r,n),o=c();i!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=i,this._errorMeasurementLastChangeTime=o);const a=Math.min(Math.max((o-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=t.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,t.bv(a))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,t,r,n,i){const o=("stencil"===i?ur.stencil:ur.tile).getGranularityForZoomLevel(t.z);return this._getMesh(e,{granularity:o,generateBorders:r,extendToNorthPole:0===t.y&&n,extendToSouthPole:t.y===(1<<t.z)-1&&n})}_getMesh(e,r){const n=this._getMeshKey(r);if(n in this._tileMeshCache)return this._tileMeshCache[n];const i=function(e,r){const n=cr(r,"16bit"),i=t.aW.deserialize({arrayBuffer:n.vertices,length:n.vertices.byteLength/2/2}),o=t.aY.deserialize({arrayBuffer:n.indices,length:n.indices.byteLength/2/3});return new Bt(e.createVertexBuffer(i,$t.members),e.createIndexBuffer(o),t.aX.simpleSegment(0,0,i.length,o.length))}(e,r);return this._tileMeshCache[n]=i,i}recalculate(e){}hasTransition(){const e=c();let t=!1;return t=t||(e-this._errorMeasurementLastChangeTime)/1e3<.7,t=t||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,t}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const dr=new t.t({type:new t.D(t.u.projection.type)});class pr extends t.E{constructor(e){super(),this._transitionable=new t.x(dr,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.H(0)),this._mercatorProjection=new qt,this._verticalPerspectiveProjection=new hr}get transitionState(){const e=this.properties.get("type");if("string"==typeof e&&"mercator"===e)return 0;if("string"==typeof e&&"vertical-perspective"===e)return 1;if(e instanceof t.bw){if("vertical-perspective"===e.from&&"mercator"===e.to)return 1-e.transition;if("mercator"===e.from&&"vertical-perspective"===e.to)return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,t,r,n,i){return this.currentProjection.getMeshFromTileID(e,t,r,n,i)}setProjection(e){this._transitionable.setValue("type",(null==e?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function fr(e){const t=yr(e.worldSize,e.center.lat);return 2*Math.PI*t}function mr(e,r,n,i,o){const a=1/(1<<o),s=r/t.a5*a+i*a,l=t.bz((e/t.a5*a+n*a)*Math.PI*2+Math.PI,2*Math.PI),c=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,u=Math.cos(c),h=new Float64Array(3);return h[0]=Math.sin(l)*u,h[1]=Math.sin(c),h[2]=Math.cos(l)*u,h}function gr(e){return function(e,t){const r=Math.cos(t),n=new Float64Array(3);return n[0]=Math.sin(e)*r,n[1]=Math.sin(t),n[2]=Math.cos(e)*r,n}(e.lng*Math.PI/180,e.lat*Math.PI/180)}function yr(e,t){return e/(2*Math.PI)/Math.cos(t*Math.PI/180)}function _r(e){const r=Math.asin(e[1])/Math.PI*180,n=Math.sqrt(e[0]*e[0]+e[2]*e[2]);if(n>1e-6){const i=e[0]/n,o=Math.acos(e[2]/n),a=(i>0?o:-o)/Math.PI*180;return new t.V(t.W(a,-180,180),r)}return new t.V(0,r)}function vr(e){return Math.cos(e*Math.PI/180)}function br(e,r){const n=vr(e),i=vr(r);return t.at(i/n)}function wr(e,r){const n=e.rotate(r.bearingInRadians),i=r.zoom+br(r.center.lat,0),o=t.bu(1/vr(r.center.lat),1/vr(Math.min(Math.abs(r.center.lat),60)),t.bx(i,7,3,0,1)),a=360/fr({worldSize:r.worldSize,center:{lat:r.center.lat}});return new t.V(r.center.lng-n.x*a*o,t.an(r.center.lat+n.y*a,-t.ao,t.ao))}function xr(e){const t=.5*e,r=Math.sin(t),n=Math.cos(t);return Math.log(r+n)-Math.log(n-r)}function Sr(e,r,n,i){const o=e.lat+n*i;if(Math.abs(n)>1){const a=(Math.sign(e.lat+n)!==Math.sign(e.lat)?-Math.abs(e.lat):Math.abs(e.lat))*Math.PI/180,s=Math.abs(e.lat+n)*Math.PI/180,l=xr(a+i*(s-a)),c=xr(a),u=xr(s);return new t.V(e.lng+r*((l-c)/(u-c)),o)}return new t.V(e.lng+r*i,o)}class Er{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,t,r,n){const i=`${e.z}_${e.x}_${e.y}_${(null==n?void 0:n.terrain)?"t":""}`,o=this._cache.get(i);if(o)return o;const a=this._cachePrevious.get(i);if(a)return this._cache.set(i,a),a;const s=this._boundingVolumeFactory(e,t,r,n);return this._cache.set(i,s),this._hadAnyChanges=!0,s}}class Tr{constructor(e,t,r,n){this.min=r,this.max=n,this.points=e,this.planes=t}static fromAabb(e,t){const r=[];for(let n=0;n<8;n++)r.push([1&~n?e[0]:t[0],1==(n>>1&1)?t[1]:e[1],1==(n>>2&1)?t[2]:e[2]]);return new Tr(r,[[-1,0,0,t[0]],[1,0,0,-e[0]],[0,-1,0,t[1]],[0,1,0,-e[1]],[0,0,-1,t[2]],[0,0,1,-e[2]]],e,t)}static fromCenterSizeAngles(e,r,n){const i=t.bB([],n[0],n[1],n[2]),o=t.bC([],[r[0],0,0],i),a=t.bC([],[0,r[1],0],i),s=t.bC([],[0,0,r[2]],i),l=[...e],c=[...e];for(let t=0;t<8;t++)for(let r=0;r<3;r++){const n=e[r]+o[r]*(1&~t?-1:1)+a[r]*(1==(t>>1&1)?1:-1)+s[r]*(1==(t>>2&1)?1:-1);l[r]=Math.min(l[r],n),c[r]=Math.max(c[r],n)}const u=[];for(let h=0;h<8;h++){const r=[...e];t.b0(r,r,t.a$([],o,1&~h?-1:1)),t.b0(r,r,t.a$([],a,1==(h>>1&1)?1:-1)),t.b0(r,r,t.a$([],s,1==(h>>2&1)?1:-1)),u.push(r)}return new Tr(u,[[...o,-t.b5(o,u[0])],[...a,-t.b5(a,u[0])],[...s,-t.b5(s,u[0])],[-o[0],-o[1],-o[2],-t.b5(o,u[7])],[-a[0],-a[1],-a[2],-t.b5(a,u[7])],[-s[0],-s[1],-s[2],-t.b5(s,u[7])]],l,c)}intersectsFrustum(e){let t=!0;const r=this.points.length,n=this.planes.length,i=e.planes.length,o=e.points.length;for(let a=0;a<i;a++){const n=e.planes[a];let i=0;for(let e=0;e<r;e++){const t=this.points[e];n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=0&&i++}if(0===i)return 0;i<r&&(t=!1)}if(t)return 2;for(let a=0;a<n;a++){const t=this.planes[a];let r=0;for(let n=0;n<o;n++){const i=e.points[n];t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]>=0&&r++}if(0===r)return 0}return 1}intersectsPlane(e){const t=this.points.length;let r=0;for(let n=0;n<t;n++){const t=this.points[n];e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]>=0&&r++}return r===t?2:0===r?0:1}}function Ar(e,t,r){const n=e-t;return n<0?-n:Math.max(0,n-r)}function Cr(e,t,r,n,i){const o=e-r;let a;return a=o<0?Math.min(-o,1+o-i):o>1?Math.min(Math.max(o-i,0),1-o):0,Math.max(a,Ar(t,n,i))}class Ir{constructor(){this._boundingVolumeCache=new Er(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,t,r,n){const i=1<<r.z,o=1/i,a=r.x/i,s=r.y/i;let l=2;return l=Math.min(l,Cr(e,t,a,s,o)),l=Math.min(l,Cr(e,t,a+.5,-s-o,o)),l=Math.min(l,Cr(e,t,a+.5,2-s-o,o)),l}getWrap(e,t,r){const n=1<<t.z,i=1/n,o=t.x/n,a=Ar(e.x,o,i),s=Ar(e.x,o-1,i),l=Ar(e.x,o+1,i),c=Math.min(a,s,l);return c===l?1:c===s?-1:0}allowVariableZoom(e,t){return Ae(e,t)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,t,r,n){return this._boundingVolumeCache.getTileBoundingVolume(e,t,r,n)}_computeTileBoundingVolume(e,r,n,i){var o,a;let s=0,l=0;if(null==i?void 0:i.terrain){const c=new t.a2(e.z,r,e.z,e.x,e.y),u=i.terrain.getMinMaxElevation(c);s=null!==(o=u.minElevation)&&void 0!==o?o:Math.min(0,n),l=null!==(a=u.maxElevation)&&void 0!==a?a:Math.max(0,n)}if(s/=t.bE,l/=t.bE,s+=1,l+=1,e.z<=0)return Tr.fromAabb([-l,-l,-l],[l,l,l]);if(1===e.z)return Tr.fromAabb([0===e.x?-l:0,0===e.y?0:-l,-l],[0===e.x?0:l,0===e.y?l:0,l]);{const r=[mr(0,0,e.x,e.y,e.z),mr(t.a5,0,e.x,e.y,e.z),mr(t.a5,t.a5,e.x,e.y,e.z),mr(0,t.a5,e.x,e.y,e.z)],n=[];for(const e of r)n.push(t.a$([],e,l));if(l!==s)for(const e of r)n.push(t.a$([],e,s));0===e.y&&n.push([0,1,0]),e.y===(1<<e.z)-1&&n.push([0,-1,0]);const i=[1,1,1],o=[-1,-1,-1];for(const e of n)for(let t=0;t<3;t++)i[t]=Math.min(i[t],e[t]),o[t]=Math.max(o[t],e[t]);const a=mr(t.a5/2,t.a5/2,e.x,e.y,e.z),c=t.b4([],[0,1,0],a);t.b3(c,c);const u=t.b4([],a,c);t.b3(u,u);const h=t.b4([],r[2],r[1]);t.b3(h,h);const d=t.b4([],r[0],r[3]);t.b3(d,d),n.push(t.a$([],a,l)),e.y>=(1<<e.z)/2&&n.push(t.a$([],mr(t.a5/2,0,e.x,e.y,e.z),l)),e.y<(1<<e.z)/2&&n.push(t.a$([],mr(t.a5/2,t.a5,e.x,e.y,e.z),l));const p=kr(a,n),f=kr(u,n),m=[-a[0],-a[1],-a[2],p.max],g=[a[0],a[1],a[2],-p.min],y=[-u[0],-u[1],-u[2],f.max],_=[u[0],u[1],u[2],-f.min],v=[...h,0],b=[...d,0],w=[];return 0===e.y?w.push(t.bD(b,v,m),t.bD(b,v,g)):w.push(t.bD(y,v,m),t.bD(y,v,g),t.bD(y,b,m),t.bD(y,b,g)),e.y===(1<<e.z)-1?w.push(t.bD(b,v,m),t.bD(b,v,g)):w.push(t.bD(_,v,m),t.bD(_,v,g),t.bD(_,b,m),t.bD(_,b,g)),new Tr(w,[m,g,y,_,v,b],i,o)}}}function kr(e,r){let n=1/0,i=-1/0;for(const o of r){const r=t.b5(e,o);n=Math.min(n,r),i=Math.max(i,r)}return{min:n,max:i}}class Pr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t){this._helper.resize(e,t)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(e){this._cachedClippingPlane=t.bF(),this._projectionMatrix=t.bj(),this._globeViewProjMatrix32f=t.bi(),this._globeViewProjMatrixNoCorrection=t.bj(),this._globeViewProjMatrixNoCorrectionInverted=t.bj(),this._globeProjMatrixInverted=t.bj(),this._cameraPosition=t.bA(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(e,r)=>{const n=t.an(e.lat,-t.ao,t.ao),i=t.an(+r,this.minZoom+br(0,n),this.maxZoom);return{center:new t.V(e.lng,n),zoom:i}},this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Vt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._coveringTilesDetailsProvider=new Ir}clone(){const e=new Pr;return e.apply(this,!1),e}apply(e,t,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e,t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=t.bA();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:t,applyGlobeMatrix:r}=e,n=this._helper.getMercatorTileCoordinates(t);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:n,clippingPlane:this._cachedClippingPlane,projectionTransition:r?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,n=this.cameraToCenterDistance/e,i=Math.sin(r)*n,o=Math.cos(r)*n+1,a=1/Math.sqrt(i*i+o*o)*1;let s=-i,l=o;const c=Math.sqrt(s*s+l*l);s/=c,l/=c;const u=[0,s,l];t.bG(u,u,[0,0,0],-this.bearingInRadians),t.bH(u,u,[0,0,0],-1*this.center.lat*Math.PI/180),t.bI(u,u,[0,0,0],this.center.lng*Math.PI/180);const h=1/t.b7(u);return t.a$(u,u,h),[...u,-a*h]}isLocationOccluded(e){return!this.isSurfacePointVisible(gr(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,n=this._helper._center.lat*Math.PI/180,i=Math.cos(n),o=[Math.sin(r)*i,Math.sin(n),Math.cos(r)*i],a=[o[2],0,-o[0]],s=[0,0,0];t.b4(s,a,o),t.b3(a,a),t.b3(s,s);const l=[0,0,0];return t.b3(l,[a[0]*e[0]+s[0]*e[1]+o[0]*e[2],a[1]*e[0]+s[1]*e[1]+o[1]*e[2],a[2]*e[0]+s[2]*e[1]+o[2]*e[2]]),l}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,n){const i=function(e,r,n){const i=1/(1<<n.z);return new t.a9(e/t.a5*i+n.x*i,r/t.a5*i+n.y*i)}(e,r,n.canonical),o=(a=i.y,[t.bz(i.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI]);var a;return this.getCircleRadiusCorrection()/Math.cos(o[1])}projectTileCoordinates(e,r,n,i){const o=n.canonical,a=mr(e,r,o.x,o.y,o.z),s=1+(i?i(e,r):0)/t.bE,l=[a[0]*s,a[1]*s,a[2]*s,1];t.aH(l,l,this._globeViewProjMatrixNoCorrection);const c=this._cachedClippingPlane,u=c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]<0;return{point:new t.P(l[0]/l[3],l[1]/l[3]),signedDistanceFromCamera:l[3],isOccluded:u}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=yr(this.worldSize,this.center.lat),r=t.bk(),n=t.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),t.be(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const i=this.centerOffset;r[8]=2*-i.x/this._helper._width,r[9]=2*i.y/this._helper._height,this._projectionMatrix=t.bf(r),this._globeProjMatrixInverted=t.bk(),t.aB(this._globeProjMatrixInverted,r),t.O(r,r,[0,0,-this.cameraToCenterDistance]),t.bg(r,r,this.rollInRadians),t.bh(r,r,-this.pitchInRadians),t.bg(r,r,this.bearingInRadians),t.O(r,r,[0,0,-e]);const o=t.bA();o[0]=e,o[1]=e,o[2]=e,t.bh(n,r,this.center.lat*Math.PI/180),t.bJ(n,n,-this.center.lng*Math.PI/180),t.Q(n,n,o),this._globeViewProjMatrixNoCorrection=n,t.bh(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),t.bJ(r,r,-this.center.lng*Math.PI/180),t.Q(r,r,o),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=t.bk(),t.aB(this._globeViewProjMatrixNoCorrectionInverted,n);const a=t.bA();this._cameraPosition=t.bA(),this._cameraPosition[2]=this.cameraToCenterDistance/e,t.bG(this._cameraPosition,this._cameraPosition,a,-this.rollInRadians),t.bH(this._cameraPosition,this._cameraPosition,a,this.pitchInRadians),t.bG(this._cameraPosition,this._cameraPosition,a,-this.bearingInRadians),t.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),t.bH(this._cameraPosition,this._cameraPosition,a,-this.center.lat*Math.PI/180),t.bI(this._cameraPosition,this._cameraPosition,a,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const s=t.bf(this._globeViewProjMatrixNoCorrectionInverted);t.Q(s,s,[1,1,-1]),this._cachedFrustum=Ht.fromInvProjectionMatrix(s,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){t.w("calculateFogMatrix is not supported on globe projection.");const r=t.bk();return t.ar(r),r}getVisibleUnwrappedCoordinates(e){return[new t.bc(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&t.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const n=gr(e);t.a$(n,n,1+r/t.bE);const i=t.bF();return t.aH(i,[n[0],n[1],n[2],1],this._globeViewProjMatrixNoCorrection),i[2]/i[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,n=[new t.P(0,0),new t.P(e,0),new t.P(this.width,0),new t.P(this.width,r),new t.P(this.width,this.height),new t.P(e,this.height),new t.P(0,this.height),new t.P(0,r)],i=[];for(const t of n)i.push(this.unprojectScreenPoint(t));let o=0,a=0,s=0,l=0;const c=this.center;for(const h of i){const e=t.bK(c.lng,h.lng),r=t.bK(c.lat,h.lat);e<a&&(a=e),e>o&&(o=e),r<l&&(l=r),r>s&&(s=r)}const u=[c.lng+a,c.lat+l,c.lng+o,c.lat+s];return this.isSurfacePointOnScreen([0,1,0])&&(u[3]=90,u[0]=-180,u[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(u[1]=-90,u[0]=-180,u[2]=180),new H(u)}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,r){const n=gr(this.unprojectScreenPoint(r)),i=gr(e),o=t.bA();t.bL(o);const a=t.bA();t.bI(a,n,o,-this.center.lng*Math.PI/180),t.bH(a,a,o,this.center.lat*Math.PI/180);const s=i[0]*i[0]+i[2]*i[2],l=a[0]*a[0];if(s<l)return;const c=Math.sqrt(s-l),u=-c,h=t.bM(i[0],i[2],a[0],c),d=t.bM(i[0],i[2],a[0],u),p=t.bA();t.bI(p,i,o,-h);const f=t.bM(p[1],p[2],a[1],a[2]),m=t.bA();t.bI(m,i,o,-d);const g=t.bM(m[1],m[2],a[1],a[2]),y=.5*Math.PI,_=f>=-y&&f<=y,v=g>=-y&&g<=y;let b,w;if(_&&v){const e=this.center.lng*Math.PI/180,r=this.center.lat*Math.PI/180;t.bN(h,e)+t.bN(f,r)<t.bN(d,e)+t.bN(g,r)?(b=h,w=f):(b=d,w=g)}else if(_)b=h,w=f;else{if(!v)return;b=d,w=g}const x=b/Math.PI*180,S=w/Math.PI*180,E=this.center.lat;this.setCenter(new t.V(x,t.an(S,-90,90))),this.setZoom(this.zoom+br(E,this.center.lat))}locationToScreenPoint(e,r){const n=gr(e);if(r){const i=r.getElevationForLngLatZoom(e,this._helper._tileZoom);t.a$(n,n,1+i/t.bE)}return this._projectSurfacePointToScreen(n)}_projectSurfacePointToScreen(e){const r=t.bF();return t.aH(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new t.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const t=r.pointCoordinate(e);if(t)return t}return t.a9.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}isPointOnMapSurface(e,t){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(r,n)}getRayDirectionFromPixel(e){const r=t.bF();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,t.aH(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const n=t.bA();n[0]=r[0]-this._cameraPosition[0],n[1]=r[1]-this._cameraPosition[1],n[2]=r[2]-this._cameraPosition[2];const i=t.bA();return t.b3(i,n),i}isSurfacePointVisible(e){const t=this._cachedClippingPlane;return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=t.bF();return t.aH(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const n=t.b5(e,r),i=t.bA(),o=t.bA();t.a$(o,r,n),t.b2(i,e,o);const a=1-t.b5(i,i);if(a<0)return null;const s=t.b5(e,e)-1,l=-n+(n<0?1:-1)*Math.sqrt(a),c=s/l,u=l;return{tMin:Math.min(c,u),tMax:Math.max(c,u)}}unprojectScreenPoint(e){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e),i=this.rayPlanetIntersection(r,n);if(i){const e=t.bA();t.b0(e,r,[n[0]*i.tMin,n[1]*i.tMin,n[2]*i.tMin]);const o=t.bA();return t.b3(o,e),_r(o)}const o=this._cachedClippingPlane,a=o[0]*n[0]+o[1]*n[1]+o[2]*n[2],s=-t.bb(o,r)/a,l=t.bA();if(s>0)t.b0(l,r,[n[0]*s,n[1]*s,n[2]*s]);else{const e=t.bA();t.b0(e,r,[2*n[0],2*n[1],2*n[2]]);const i=t.bb(this._cachedClippingPlane,e);t.b2(l,e,[this._cachedClippingPlane[0]*i,this._cachedClippingPlane[1]*i,this._cachedClippingPlane[2]*i])}const c=function(e){const r=t.bA();return r[0]=e[0]*-e[3],r[1]=e[1]*-e[3],r[2]=e[2]*-e[3],{center:r,radius:Math.sqrt(1-e[3]*e[3])}}(o);return _r(function(e,r,n){const i=t.bA();t.b2(i,n,e);const o=t.bA();return t.by(o,e,i,r/t.b9(i)),o}(c.center,c.radius,l))}getMatrixForModel(e,r){const n=t.V.convert(e),i=1/t.bE,o=t.bj();return t.bJ(o,o,n.lng/180*Math.PI),t.bh(o,o,-n.lat/180*Math.PI),t.O(o,o,[0,0,1+r/t.bE]),t.bh(o,o,.5*Math.PI),t.Q(o,o,[i,i,i]),o}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new t.a2(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class Mr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,t){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=t,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(e){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(e,t)=>this.currentTransform.defaultConstrain(e,t),this.applyConstrain=(e,t)=>this._helper.applyConstrain(e,t),this._helper=new Vt({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(e,t)=>this.defaultConstrain(e,t)},e),this._globeness=1,this._mercatorTransform=new Zt,this._verticalPerspectiveTransform=new Pr}clone(){const e=new Mr;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this,!1),e}apply(e,t){this._helper.apply(e,t),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const t=this._mercatorTransform.getProjectionData(e),r=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?r.mainMatrix:t.mainMatrix,clippingPlane:r.clippingPlane,tileMercatorCoords:r.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:t.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return t.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return t.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,n){const i=this._mercatorTransform.getPitchedTextCorrection(e,r,n),o=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,n);return t.bu(i,o,this._globeness)}projectTileCoordinates(e,t,r,n){return this.currentTransform.projectTileCoordinates(e,t,r,n)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,t){return this.currentTransform.lngLatToCameraDepth(e,t)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,t){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,t),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(e,t),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(e,t){return this.currentTransform.locationToScreenPoint(e,t)}screenPointToMercatorCoordinate(e,t){return this.currentTransform.screenPointToMercatorCoordinate(e,t)}screenPointToLocation(e,t){return this.currentTransform.screenPointToLocation(e,t)}isPointOnMapSurface(e,t){return this.currentTransform.isPointOnMapSurface(e,t)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,t){return this.currentTransform.getMatrixForModel(e,t)}getProjectionDataForCustomLayer(e=!0){const t=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return t;const r=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return r.fallbackMatrix=t.mainMatrix,r}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Rr{get useGlobeControls(){return!0}handlePanInertia(e,r){const n=wr(e,r);return Math.abs(n.lng-r.center.lng)>180&&(n.lng=r.center.lng+179.5*Math.sign(n.lng-r.center.lng)),{easingCenter:n,easingOffset:new t.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const n=e.around,i=r.screenPointToLocation(n);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const o=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const a=r.zoom-o;if(0===a)return;const s=t.bK(r.center.lng,i.lng),l=s/(Math.abs(s/180)+1),c=t.bK(r.center.lat,i.lat),u=r.getRayDirectionFromPixel(n),h=r.cameraPosition,d=-1*t.b5(h,u),p=t.bA();t.b0(p,h,[u[0]*d,u[1]*d,u[2]*d]);const f=t.b7(p)-1,m=Math.exp(.5*-Math.max(f-.3,0)),g=yr(r.worldSize,r.center.lat)/Math.min(r.width,r.height),y=t.bx(g,.9,.5,1,.25),_=(1-t.aq(-a))*Math.min(m,y),v=r.center.lat,b=r.zoom,w=new t.V(r.center.lng+l*_,t.an(r.center.lat+c*_,-t.ao,t.ao));r.setLocationAtPoint(i,n);const x=r.center,S=t.bx(Math.abs(s),45,85,0,1),E=t.bx(g,.75,.35,0,1),T=Math.pow(Math.max(S,E),.25),A=t.bK(x.lng,w.lng),C=t.bK(x.lat,w.lat);r.setCenter(new t.V(x.lng+A*T,x.lat+C*T).wrap()),r.setZoom(b+br(v,r.center.lat))}handleMapControlsPan(e,t,r){if(!e.panDelta)return;const n=t.center.lat,i=t.zoom;t.setCenter(wr(e.panDelta,t).wrap()),t.setZoom(i+br(n,t.center.lat))}cameraForBoxAndBearing(e,r,n,i,o){const a=Kt(e,r,n,i,o),s=r.left/o.width*2-1,l=(o.width-r.right)/o.width*2-1,c=r.top/o.height*-2+1,u=(o.height-r.bottom)/o.height*-2+1,h=t.bK(n.getWest(),n.getEast())<0,d=h?n.getEast():n.getWest(),p=h?n.getWest():n.getEast(),f=Math.max(n.getNorth(),n.getSouth()),m=Math.min(n.getNorth(),n.getSouth()),g=d+.5*t.bK(d,p),y=f+.5*t.bK(f,m),_=o.clone();_.setCenter(a.center),_.setBearing(a.bearing),_.setPitch(0),_.setRoll(0),_.setZoom(a.zoom);const v=_.modelViewProjectionMatrix,b=[gr(n.getNorthWest()),gr(n.getNorthEast()),gr(n.getSouthWest()),gr(n.getSouthEast()),gr(new t.V(p,y)),gr(new t.V(d,y)),gr(new t.V(g,f)),gr(new t.V(g,m))],w=gr(a.center);let x=Number.POSITIVE_INFINITY;for(const t of b)s<0&&(x=Rr.getLesserNonNegativeNonNull(x,Rr.solveVectorScale(t,w,v,"x",s))),l>0&&(x=Rr.getLesserNonNegativeNonNull(x,Rr.solveVectorScale(t,w,v,"x",l))),c>0&&(x=Rr.getLesserNonNegativeNonNull(x,Rr.solveVectorScale(t,w,v,"y",c))),u<0&&(x=Rr.getLesserNonNegativeNonNull(x,Rr.solveVectorScale(t,w,v,"y",u)));if(Number.isFinite(x)&&0!==x)return a.zoom=_.zoom+t.at(x),a;Yt()}handleJumpToCenterZoom(e,r){const n=e.center.lat,i=e.applyConstrain(r.center?t.V.convert(r.center):e.center,e.zoom).center;e.setCenter(i.wrap());const o=void 0!==r.zoom?+r.zoom:e.zoom+br(n,i.lat);e.zoom!==o&&e.setZoom(o)}handleEaseTo(e,r){const n=e.zoom,i=e.center,o=e.padding,a={roll:e.roll,pitch:e.pitch,bearing:e.bearing},s={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},l=void 0!==r.zoom,c=!e.isPaddingEqual(r.padding);let u=!1;const h=r.center?t.V.convert(r.center):i,d=e.applyConstrain(h,n).center;jt(e,d);const p=e.clone();p.setCenter(d),p.setZoom(l?+r.zoom:n+br(i.lat,h.lat)),p.setBearing(r.bearing);const f=new t.P(t.an(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.an(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));p.setLocationAtPoint(d,f);const m=(r.offset&&r.offsetAsPoint.mag())>0?p.center:d,g=l?+r.zoom:n+br(i.lat,m.lat),y=n+br(i.lat,0),_=g+br(m.lat,0),v=t.bK(i.lng,m.lng),b=t.bK(i.lat,m.lat),w=t.aq(_-y);return u=g!==n,{easeFunc:n=>{if(t.bo(a,s)||Xt({startEulerAngles:a,endEulerAngles:s,tr:e,k:n,useSlerp:a.roll!=s.roll}),c&&e.interpolatePadding(o,r.padding,n),r.around)t.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const t=_>y?Math.min(2,w):Math.max(.5,w),r=Math.pow(t,1-n),o=Sr(i,v,b,n*r);e.setCenter(o.wrap())}if(u){const r=t.G.number(y,_,n)+br(0,e.center.lat);e.setZoom(r)}},isZooming:u,elevationCenter:m}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.center,o=e.zoom,a=e.padding,s=!e.isPaddingEqual(r.padding),l=e.applyConstrain(t.V.convert(r.center||r.locationAtOffset),o).center,c=n?+r.zoom:e.zoom+br(e.center.lat,l.lat),u=e.clone();u.setCenter(l),u.setZoom(c),u.setBearing(r.bearing);const h=new t.P(t.an(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.an(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));u.setLocationAtPoint(l,h);const d=u.center;jt(e,d);const p=function(e,r,n){const i=gr(r),o=gr(n),a=t.b5(i,o),s=Math.acos(a),l=fr(e);return s/(2*Math.PI)*l}(e,i,d),f=o+br(i.lat,0),m=c+br(d.lat,0),g=t.aq(m-f);let y;if("number"==typeof r.minZoom){const n=+r.minZoom+br(d.lat,0),i=Math.min(n,f,m)+br(0,d.lat),o=e.applyConstrain(d,i).zoom+br(d.lat,0);y=t.aq(o-f)}const _=t.bK(i.lng,d.lng),v=t.bK(i.lat,d.lat);return{easeFunc:(n,o,l,u)=>{const h=Sr(i,_,v,l);s&&e.interpolatePadding(a,r.padding,n);const p=1===n?d:h;e.setCenter(p.wrap());const m=f+t.at(o);e.setZoom(1===n?c:m+br(0,p.lat))},scaleOfZoom:g,targetCenter:d,scaleOfMinZoom:y,pixelPathLength:p}}static solveVectorScale(e,t,r,n,i){const o="x"===n?[r[0],r[4],r[8],r[12]]:[r[1],r[5],r[9],r[13]],a=[r[3],r[7],r[11],r[15]],s=e[0]*o[0]+e[1]*o[1]+e[2]*o[2],l=e[0]*a[0]+e[1]*a[1]+e[2]*a[2],c=t[0]*o[0]+t[1]*o[1]+t[2]*o[2],u=t[0]*a[0]+t[1]*a[1]+t[2]*a[2];return c+i*l===s+i*u||a[3]*(s-c)+o[3]*(u-l)+s*u==c*l?null:(c+o[3]-i*u-i*a[3])/(c-s-i*u+i*l)}static getLesserNonNegativeNonNull(e,t){return null!==t&&t>=0&&t<e?t:e}}class Dr{constructor(e){this._globe=e,this._mercatorCameraHelper=new Qt,this._verticalPerspectiveCameraHelper=new Rr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,t){return this.currentHelper.handlePanInertia(e,t)}handleMapControlsRollPitchBearingZoom(e,t){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,t)}handleMapControlsPan(e,t,r){this.currentHelper.handleMapControlsPan(e,t,r)}cameraForBoxAndBearing(e,t,r,n,i){return this.currentHelper.cameraForBoxAndBearing(e,t,r,n,i)}handleJumpToCenterZoom(e,t){this.currentHelper.handleJumpToCenterZoom(e,t)}handleEaseTo(e,t){return this.currentHelper.handleEaseTo(e,t)}handleFlyTo(e,t){return this.currentHelper.handleFlyTo(e,t)}}const Or=(e,r)=>t.B(e,r&&r.filter((e=>"source.canvas"!==e.identifier))),Lr=t.bO();class Br extends t.E{constructor(e,r={}){var n,i;super(),this._rtlPluginLoaded=()=>{for(const e in this.tileManagers){const t=this.tileManagers[e].getSource().type;"vector"!==t&&"geojson"!==t||this.tileManagers[e].reload()}},this.map=e,this.dispatcher=new q(F(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((e,t)=>this.getGlyphs(e,t))),this.dispatcher.registerMessageHandler("GI",((e,t)=>this.getImages(e,t))),this.dispatcher.registerMessageHandler("GDA",((e,t)=>this.getDashes(e,t))),this.imageManager=new x,this.imageManager.setEventedParent(this);const o=(null===(n=e._container)||void 0===n?void 0:n.lang)||"undefined"!=typeof document&&(null===(i=document.documentElement)||void 0===i?void 0:i.lang)||void 0;this.glyphManager=new C(e._requestManager,r.localIdeographFontFamily,o),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new Rt,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",t.bP()),ce().on(ae,this._rtlPluginLoaded),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.tileManagers[e.sourceId];if(!t)return;const r=t.getSource();if(r&&r.vectorLayerIds)for(const n in this._layers){const e=this._layers[n];e.source===r.id&&this._validateLayer(e)}}))}_setInitialValues(){var e;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new t.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new((null===(e=this.crossTileSymbolIndex)||void 0===e?void 0:e.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(e,r){var n,i,o;this._checkLoaded();const a=null===r?null!==(o=null===(i=null===(n=this.stylesheet.state)||void 0===n?void 0:n[e])||void 0===i?void 0:i.default)&&void 0!==o?o:null:r;if(t.bR(a,this._globalState[e]))return this;this._globalState[e]=a,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const r=[];for(const n in e)!t.bR(this._globalState[n],e[n].default)&&(r.push(n),this._globalState[n]=e[n].default);this._applyGlobalStateChanges(r)}_applyGlobalStateChanges(e){if(0===e.length)return;const t=new Set,r={};for(const n of e){r[n]=this._globalState[n];for(const e in this._layers){const r=this._layers[e],i=r.getLayoutAffectingGlobalStateRefs(),o=r.getPaintAffectingGlobalStateRefs(),a=r.getVisibilityAffectingGlobalStateRefs();if(i.has(n)&&t.add(r.source),o.has(n))for(const{name:e,value:t}of o.get(n))this._updatePaintProperty(r,e,t);(null==a?void 0:a.has(n))&&(r.recalculateVisibility(),this._updateLayer(r))}}this.dispatcher.broadcast("UGS",r);for(const n in this.tileManagers)t.has(n)&&(this._reloadSource(n),this._changed=!0)}loadURL(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),r.validate="boolean"!=typeof r.validate||r.validate;const i=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const o=this._loadStyleRequest;t.j(i,this._loadStyleRequest).then((e=>{this._loadStyleRequest=null,this._load(e.data,r,n)})).catch((e=>{this._loadStyleRequest=null,e&&!o.signal.aborted&&this.fire(new t.k(e))}))}loadJSON(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,s.frameAsync(this._frameRequest,this.map._ownerWindow).then((()=>{this._frameRequest=null,r.validate=!1!==r.validate,this._load(e,r,n)})).catch((()=>{}))}loadEmpty(){this.fire(new t.l("dataloading",{dataType:"style"})),this._load(Lr,{validate:!1})}_load(e,r,n){var i,o;let a=r.transformStyle?r.transformStyle(n,e):e;if(!r.validate||!Or(this,t.C(a))){a=Object.assign({},a),this._loaded=!0,this.stylesheet=a;for(const e in a.sources)this.addSource(e,a.sources[e],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new P(this.stylesheet.light),this._setProjectionInternal((null===(i=this.stylesheet.projection)||void 0===i?void 0:i.type)||"mercator"),this.sky=new R(this.stylesheet.sky),this.map.setTerrain(null!==(o=this.stylesheet.terrain)&&void 0!==o?o:null),this.fire(new t.l("data",{dataType:"style"})),this.fire(new t.l("style.load"))}}_createLayers(){var e,r,n;const i=t.bS(this.stylesheet.layers);this.setGlobalState(null!==(e=this.stylesheet.state)&&void 0!==e?e:null),this.dispatcher.broadcast("SL",i),this._order=i.map((e=>e.id)),this._layers={},this._serializedLayers=null;for(const o of i){const e=t.bT(o,this._globalState);if(e.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=e,t.bU(e)&&this.tileManagers[e.source]){const t=null!==(n=null===(r=o.paint)||void 0===r?void 0:r["raster-fade-duration"])&&void 0!==n?n:e.paint.get("raster-fade-duration");this.tileManagers[e.source].setRasterFadeDuration(t)}}}_loadSprite(e,r=!1,n=void 0){this.imageManager.setLoaded(!1);const i=new AbortController;let o;this._spriteRequest=i,function(e,r,n,i){return t._(this,void 0,void 0,(function*(){const o=v(e),a=n>1?"@2x":"",l={},c={};for(const{id:e,url:n}of o){const o=r.transformRequest(b(n,a,".json"),"SpriteJSON");l[e]=t.j(o,i);const s=r.transformRequest(b(n,a,".png"),"SpriteImage");c[e]=y.getImage(s,i)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(e,r){return t._(this,void 0,void 0,(function*(){const t={};for(const n in e){t[n]={};const i=s.getImageCanvasContext((yield r[n]).data),o=(yield e[n]).data;for(const e in o){const{width:r,height:a,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m}=o[e];t[n][e]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m,spriteData:{width:r,height:a,x:s,y:l,context:i}}}}return t}))}(l,c)}))}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((e=>{if(this._spriteRequest=null,e)for(const t in e){this._spritesImagesIds[t]=[];const n=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in e))):[];for(const e of n)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const i in e[t]){const n="default"===t?i:`${t}:${i}`;this._spritesImagesIds[t].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,e[t][i],!1):this.imageManager.addImage(n,e[t][i]),r&&(this._changedImages[n]=!0)}}})).catch((e=>{this._spriteRequest=null,o=e,i.signal.aborted||this.fire(new t.k(o))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"})),n&&n(o)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.tileManagers[e.source];if(!r)return;const n=e.sourceLayer;if(!n)return;const i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.k(new Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.tileManagers)if(!this.tileManagers[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const n=this._serializedAllLayers();if(!e||0===e.length)return Object.values(r?t.bV(n):n);const i=[];for(const o of e)if(n[o]){const e=r?t.bV(n[o]):n[o];i.push(e)}return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const r of t){const t=this._layers[r];"custom"!==t.type&&(e[r]=t.serialize())}return e}hasTransitions(){var e,t,r;if(null===(e=this.light)||void 0===e?void 0:e.hasTransition())return!0;if(null===(t=this.sky)||void 0===t?void 0:t.hasTransition())return!0;if(null===(r=this.projection)||void 0===r?void 0:r.hasTransition())return!0;for(const n in this.tileManagers)if(this.tileManagers[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const t=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(t.length||r.length)&&this._updateWorkerLayers(t,r);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const n in this._updatedPaintProps)this._layers[n].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const n={};for(const t in this.tileManagers){const e=this.tileManagers[t];n[t]=e.used,e.used=!1}for(const t of this._order){const r=this._layers[t];r.recalculate(e,this._availableImages),!r.isHidden(e.zoom)&&r.source&&(this.tileManagers[r.source].used=!0)}for(const i in n){const e=this.tileManagers[i];!!n[i]!=!!e.used&&e.fire(new t.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:i}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new t.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.tileManagers)this.tileManagers[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var n;this._checkLoaded();const i=this.serialize();if(e=r.transformStyle?r.transformStyle(i,e):e,(null===(n=r.validate)||void 0===n||n)&&Or(this,t.C(e)))return!1;(e=t.bV(e)).layers=t.bS(e.layers);const o=t.bW(i,e),a=this._getOperationsToPerform(o);if(a.unimplemented.length>0)throw new Error(`Unimplemented: ${a.unimplemented.join(", ")}.`);if(0===a.operations.length)return!1;for(const t of a.operations)t();return this.stylesheet=e,this._serializedLayers=null,this.fire(new t.l("style.load",{style:this})),!0}_getOperationsToPerform(e){const t=[],r=[];for(const n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":t.push((()=>this.addLayer.apply(this,n.args)));break;case"removeLayer":t.push((()=>this.removeLayer.apply(this,n.args)));break;case"setPaintProperty":t.push((()=>this.setPaintProperty.apply(this,n.args)));break;case"setLayoutProperty":t.push((()=>this.setLayoutProperty.apply(this,n.args)));break;case"setFilter":t.push((()=>this.setFilter.apply(this,n.args)));break;case"addSource":t.push((()=>this.addSource.apply(this,n.args)));break;case"removeSource":t.push((()=>this.removeSource.apply(this,n.args)));break;case"setLayerZoomRange":t.push((()=>this.setLayerZoomRange.apply(this,n.args)));break;case"setLight":t.push((()=>this.setLight.apply(this,n.args)));break;case"setGeoJSONSourceData":t.push((()=>this.setGeoJSONSourceData.apply(this,n.args)));break;case"setGlyphs":t.push((()=>this.setGlyphs.apply(this,n.args)));break;case"setSprite":t.push((()=>this.setSprite.apply(this,n.args)));break;case"setTerrain":t.push((()=>this.map.setTerrain.apply(this,n.args)));break;case"setSky":t.push((()=>this.setSky.apply(this,n.args)));break;case"setProjection":this.setProjection.apply(this,n.args);break;case"setGlobalState":t.push((()=>this.setGlobalState.apply(this,n.args)));break;case"setTransition":t.push((()=>{}));break;default:r.push(n.command)}return{operations:t,unimplemented:r}}addImage(e,r){if(this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,n={}){if(this._checkLoaded(),void 0!==this.tileManagers[e])throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.C.source,`sources.${e}`,r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const i=this.tileManagers[e]=new Be(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,(()=>({isSourceLoaded:i.loaded(),source:i.serialize(),sourceId:e}))),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.tileManagers[e])throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===e)return this.fire(new t.k(new Error(`Source "${e}" cannot be removed while layer "${n}" is using it.`)));const r=this.tileManagers[e];delete this.tileManagers[e],delete this._updatedSources[e],r.fire(new t.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.tileManagers[e])throw new Error(`There is no source with this ID=${e}`);const r=this.tileManagers[e].getSource();if("geojson"!==r.type)throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.tileManagers[e]&&this.tileManagers[e].getSource()}addLayer(e,r,n={}){this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.k(new Error(`Layer "${i}" already exists on this map.`)));let o;if("custom"===e.type){if(Or(this,t.bX(e)))return;o=t.bT(e,this._globalState)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(i,e.source),e=t.bV(e),e=t.e(e,{source:i})),this._validate(t.C.layer,`layers.${i}`,e,{arrayIndex:-1},n))return;o=t.bT(e,this._globalState),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}const a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)this.fire(new t.k(new Error(`Cannot add layer "${i}" before non-existing layer "${r}".`)));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.tileManagers[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const n=this._order.indexOf(e);this._order.splice(n,1);const i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new t.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new t.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,n){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,n={}){this._checkLoaded();const i=this.getLayer(e);if(i){if(!t.bR(i.filter,r))return null==r?(i.setFilter(void 0),void this._updateLayer(i)):void(this._validate(t.C.filter,`layers.${i.id}.filter`,r,null,n)||(i.setFilter(t.bV(r)),this._updateLayer(i)))}else this.fire(new t.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.bV(this.getLayer(e).filter)}setLayoutProperty(e,r,n,i={}){this._checkLoaded();const o=this.getLayer(e);o?t.bR(o.getLayoutProperty(r),n)||(o.setLayoutProperty(r,n,i),this._updateLayer(o)):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const n=this.getLayer(e);if(n)return n.getLayoutProperty(r);this.fire(new t.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,n,i={}){this._checkLoaded();const o=this.getLayer(e);o?t.bR(o.getPaintProperty(r),n)||this._updatePaintProperty(o,r,n,i):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,r,n,i={}){e.setPaintProperty(r,n,i)&&this._updateLayer(e),t.bU(e)&&"raster-fade-duration"===r&&this.tileManagers[e.source].setRasterFadeDuration(n),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,r){this._checkLoaded();const n=e.source,i=e.sourceLayer,o=this.tileManagers[n];if(void 0===o)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const a=o.getSource().type;"geojson"===a&&i?this.fire(new t.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,e.id,r)):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const n=e.source,i=this.tileManagers[n];if(void 0===i)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const o=i.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.k(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(a,e.id,r):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,n=e.sourceLayer,i=this.tileManagers[r];if(void 0!==i)return"vector"!==i.getSource().type||n?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,e.id)):void this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.bY(this.tileManagers,(e=>e.serialize())),r=this._serializeByIds(this._order,!0),n=this.map.getTerrain()||void 0,i=this.stylesheet;return t.bZ({version:i.version,name:i.name,metadata:i.metadata,light:i.light,sky:i.sky,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,projection:i.projection,sources:e,layers:r,terrain:n},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.tileManagers[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.tileManagers[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let o=this._order.length-1;o>=0;o--){const i=this._order[o];if(t(i)){r[i]=o;for(const t of e){const e=t[i];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const i=[];for(let o=this._order.length-1;o>=0;o--){const a=this._order[o];if(t(a))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(r[t.layer.id]<o)break;i.push(t),n.pop()}else for(const t of e){const e=t[a];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(e,r,n){r&&r.filter&&this._validate(t.C.filter,"queryRenderedFeatures.filter",r.filter,null,r);const i={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new t.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const e of r.layers){const r=this._layers[e];if(!r)return this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[r.source]=!0}}const o=[];r.availableImages=this._availableImages;const a=this._serializedAllLayers(),s=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,l=Object.assign(Object.assign({},r),{layers:s,globalState:this._globalState});for(const t in this.tileManagers)r.layers&&!i[t]||o.push(U(this.tileManagers[t],this._layers,a,e,l,n,this.map.terrain?(e,t,r)=>this.map.terrain.getElevation(e,t,r):void 0));return this.placement&&o.push(function(e,t,r,n,i,o,a){const s={},l=o.queryRenderedSymbols(n),c=[];for(const u of Object.keys(l).map(Number))c.push(a[u]);c.sort(V);for(const u of c){const r=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],t,u.bucketIndex,u.sourceLayerIndex,{filterSpec:i.filter,globalState:i.globalState},i.layers,i.availableImages,e);for(const e in r){const t=s[e]=s[e]||[],n=r[e];n.sort(((e,t)=>{const r=u.featureSortOrder;if(r){const n=r.indexOf(e.featureIndex);return r.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex}));for(const e of n)t.push(e)}}return function(e,t,r){for(const n in e)for(const i of e[n])G(i,r[t[n].source]);return e}(s,e,r)}(this._layers,a,this.tileManagers,e,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(e,r){(null==r?void 0:r.filter)&&this._validate(t.C.filter,"querySourceFeatures.filter",r.filter,null,r);const n=this.tileManagers[e];return n?function(e,t){const r=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],i={};for(let o=0;o<r.length;o++){const e=r[o],a=e.tileID.canonical.key;i[a]||(i[a]=!0,e.querySourceFeatures(n,t))}return n}(n,r?Object.assign(Object.assign({},r),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const n=this.light.getLight();let i=!1;for(const a in e)if(!t.bR(e[a],n[a])){i=!0;break}if(!i)return;const o={now:c(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(o)}getProjection(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const n=this.getSky();let i=!1;if(!e&&!n)return;if(e&&!n)i=!0;else if(!e&&n)i=!0;else for(const a in e)if(!t.bR(e[a],n[a])){i=!0;break}if(!i)return;const o={now:c(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(o)}_setProjectionInternal(e){const r=function(e,r){const n={constrainOverride:r};if(Array.isArray(e)){const t=new pr({type:e});return{projection:t,transform:new Mr(n),cameraHelper:new Dr(t)}}switch(e){case"mercator":return{projection:new qt,transform:new Zt(n),cameraHelper:new Qt};case"globe":{const e=new pr({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:e,transform:new Mr(n),cameraHelper:new Dr(e)}}case"vertical-perspective":return{projection:new hr,transform:new Pr(n),cameraHelper:new Rr};default:return t.w(`Unknown projection name: ${e}. Falling back to mercator projection.`),{projection:new qt,transform:new Zt(n),cameraHelper:new Qt}}}(e,this.map.transformConstrain);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const t in this.tileManagers)this.tileManagers[t].reload()}_validate(e,r,n,i,o={}){return(!o||!1!==o.validate)&&Or(this,e.call(t.C,t.e({key:r,style:this.serialize(),value:n,styleSpec:t.u},i)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ce().off(ae,this._rtlPluginLoaded);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.tileManagers){const e=this.tileManagers[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.tileManagers[e].clearTiles()}_reloadSource(e){this.tileManagers[e].resume(),this.tileManagers[e].reload()}_updateSources(e){for(const t in this.tileManagers)this.tileManagers[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.tileManagers)this._reloadSource(e)}_updatePlacement(e,t,r,n,i=!1){let o=!1,a=!1;const s={};for(const l of this._order){const t=this._layers[l];if("symbol"!==t.type)continue;if(!s[t.source]){const e=this.tileManagers[t.source];s[t.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(t,s[t.source],e.center.lng);o=o||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c(),e.zoom))&&(this.pauseablePlacement=new Ct(e,this.map.terrain,this._order,i,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(const l of this._order){const e=this._layers[l];"symbol"===e.type&&this.placement.updateLayerOpacities(e,s[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c())}_releaseSymbolFadeTiles(){for(const e in this.tileManagers)this.tileManagers[e].releaseSymbolFadeTiles()}getImages(e,r){return t._(this,void 0,void 0,(function*(){const e=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const t=this.tileManagers[r.source];return t&&t.setDependencies(r.tileID.key,r.type,r.icons),e}))}getGlyphs(e,r){return t._(this,void 0,void 0,(function*(){const e=yield this.glyphManager.getGlyphs(r.stacks),t=this.tileManagers[r.source];return t&&t.setDependencies(r.tileID.key,r.type,[""]),e}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(t.C.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,r){return t._(this,void 0,void 0,(function*(){const e={};for(const[t,n]of Object.entries(r.dashes))e[t]=this.lineAtlas.getDash(n.dasharray,n.round);return e}))}addSprite(e,r,n={},i){this._checkLoaded();const o=[{id:e,url:r}],a=[...v(this.stylesheet.sprite),...o];this._validate(t.C.sprite,"sprite",a,null,n)||(this.stylesheet.sprite=a,this._loadSprite(o,!0,i))}removeSprite(e){this._checkLoaded();const r=v(this.stylesheet.sprite);if(r.find((t=>t.id===e))){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;r.splice(r.findIndex((t=>t.id===e)),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}else this.fire(new t.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return v(this.stylesheet.sprite)}setSprite(e,r={},n){this._checkLoaded(),e&&this._validate(t.C.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const e in this.tileManagers){const t=this.tileManagers[e];t.setEventedParent(null),t.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const e in this._layers){const t=this._layers[e];t.setEventedParent(null),t.onRemove&&t.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var $r=t.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class zr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,i,o,a,s,l){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let u=0;!c&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||c||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,r,n,i,o,a,s,l):(e.bindVertexArray.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,r,n,i,o,a,s){const l=e.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a,this.boundDynamicVertexBuffer3=s,t.enableAttributes(u,e);for(const h of r)h.enableAttributes(u,e);o&&o.enableAttributes(u,e),a&&a.enableAttributes(u,e),s&&s.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,i);for(const h of r)h.bind(),h.setVertexAttribPointers(u,e,i);o&&(o.bind(),o.setVertexAttribPointers(u,e,i)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(u,e,i)),s&&(s.bind(),s.setVertexAttribPointers(u,e,i)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Fr=(e,r,n,i,o)=>({u_texture:0,u_ele_delta:e,u_fog_matrix:r,u_fog_color:n?n.properties.get("fog-color"):t.bp.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:o?0:n?n.calculateFogBlendOpacity(i):0,u_horizon_color:n?n.properties.get("horizon-color"):t.bp.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:o?1:0}),qr={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Nr(e){const t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;const n=e[r].split(" ");t.push(n.pop())}return t}class jr{constructor(e,r,n,i,o,a,s,l,c=[]){const u=e.gl;this.program=u.createProgram();const h=Nr(r.staticAttributes),d=n?n.getBinderAttributes():[],p=h.concat(d),f=Ot.prelude.staticUniforms?Nr(Ot.prelude.staticUniforms):[],m=s.staticUniforms?Nr(s.staticUniforms):[],g=r.staticUniforms?Nr(r.staticUniforms):[],y=n?n.getBinderUniforms():[],_=f.concat(m).concat(g).concat(y),v=[];for(const t of _)v.indexOf(t)<0&&v.push(t);const b=n?n.defines():[];ar(u)&&b.unshift("#version 300 es"),o&&b.push("#define OVERDRAW_INSPECTOR;"),a&&b.push("#define TERRAIN3D;"),l&&b.push(l),c&&b.push(...c);let w=b.concat(Ot.prelude.fragmentSource,s.fragmentSource,r.fragmentSource).join("\n"),x=b.concat(Ot.prelude.vertexSource,s.vertexSource,r.vertexSource).join("\n");ar(u)||(w=w.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D("),x=function(e){return e.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(x));const S=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(S,w),u.compileShader(S),!u.getShaderParameter(S,u.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${u.getShaderInfoLog(S)}`);u.attachShader(this.program,S);const E=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(E,x),u.compileShader(E),!u.getShaderParameter(E,u.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${u.getShaderInfoLog(E)}`);u.attachShader(this.program,E),this.attributes={};const T={};this.numAttributes=p.length;for(let t=0;t<this.numAttributes;t++)p[t]&&(u.bindAttribLocation(this.program,t,p[t]),this.attributes[p[t]]=t);if(u.linkProgram(this.program),!u.getProgramParameter(this.program,u.LINK_STATUS))throw new Error(`Program failed to link: ${u.getProgramInfoLog(this.program)}`);u.deleteShader(E),u.deleteShader(S);for(let t=0;t<v.length;t++){const e=v[t];if(e&&!T[e]){const t=u.getUniformLocation(this.program,e);t&&(T[e]=t)}}this.fixedUniforms=i(e,T),this.terrainUniforms=((e,r)=>({u_depth:new t.b_(e,r.u_depth),u_terrain:new t.b_(e,r.u_terrain),u_terrain_dim:new t.bq(e,r.u_terrain_dim),u_terrain_matrix:new t.c0(e,r.u_terrain_matrix),u_terrain_unpack:new t.c1(e,r.u_terrain_unpack),u_terrain_exaggeration:new t.bq(e,r.u_terrain_exaggeration)}))(e,T),this.projectionUniforms=((e,r)=>({u_projection_matrix:new t.c0(e,r.u_projection_matrix),u_projection_tile_mercator_coords:new t.c1(e,r.u_projection_tile_mercator_coords),u_projection_clipping_plane:new t.c1(e,r.u_projection_clipping_plane),u_projection_transition:new t.bq(e,r.u_projection_transition),u_projection_fallback_matrix:new t.c0(e,r.u_projection_fallback_matrix)}))(e,T),this.binderUniforms=n?n.getUniforms(e,T):[]}draw(e,t,r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_){const v=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(o),s){e.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,s.depthTexture),e.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}if(l)for(const w in l)this.projectionUniforms[qr[w]].set(l[w]);if(a)for(const w in this.fixedUniforms)this.fixedUniforms[w].set(a[w]);m&&m.setUniforms(e,this.binderUniforms,p,{zoom:f});let b=0;switch(t){case v.LINES:b=2;break;case v.TRIANGLES:b=3;break;case v.LINE_STRIP:b=1}for(const w of d.get()){const r=w.vaos||(w.vaos={});(r[c]||(r[c]=new zr)).bind(e,this,u,m?m.getPaintVertexBuffers():[],h,w.vertexOffset,g,y,_),v.drawElements(t,w.primitiveLength*b,v.UNSIGNED_SHORT,w.primitiveOffset*b*2)}}}function Ur(e,r,n){const i=1/t.aN(n,1,r.transform.tileZoom),o=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,r.transform.tileZoom)/o,s=a*(n.tileID.canonical.x+n.tileID.wrap*o),l=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}const Vr=(e,r,n,i)=>{const o=e.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.c4();"viewport"===o.properties.get("anchor")&&t.c5(l,e.transform.bearingInRadians),t.c6(s,s,l);const c=e.transform.transformLightDirection(s),u=o.properties.get("color");return{u_lightpos:s,u_lightpos_globe:c,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:n,u_fill_translate:i}},Gr=(e,r,n,i,o,a,s)=>t.e(Vr(e,r,n,i),Ur(a,e,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8}),Wr=(e,r,n,i)=>t.e(Ur(r,e,n),{u_fill_translate:i}),Hr=(e,t)=>({u_world:e,u_fill_translate:t}),Zr=(e,r,n,i,o)=>t.e(Wr(e,r,n,o),{u_world:i}),Yr=(e,r,n,i,o)=>{const a=e.transform;let s,l,c=0;if("map"===n.paint.get("circle-pitch-alignment")){const e=t.aN(r,1,a.zoom);s=!0,l=[e,e],c=e/(t.a5*Math.pow(2,r.tileID.overscaledZ))*2*Math.PI*o}else s=!1,l=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_pitch_with_map:+s,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:l,u_globe_extrude_scale:c,u_translate:i}},Xr=e=>({u_pixel_extrude_scale:[1/e.width,1/e.height]}),Kr=e=>({u_viewport_size:[e.width,e.height]}),Qr=(e,t=1)=>({u_color:e,u_overlay:0,u_overlay_scale:t}),Jr=(e,r,n,i)=>{const o=t.aN(e,1,r)/(t.a5*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*i;return{u_extrude_scale:t.aN(e,1,r),u_intensity:n,u_globe_extrude_scale:o}},en=(e,r,n,i)=>{const o=t.N();t.c7(o,0,e.width,e.height,0,0,1);const a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:n,u_color_ramp:i,u_opacity:r.paint.get("heatmap-opacity")}},tn=(e,t,r)=>{const n=r.paint.get("hillshade-accent-color");let i;switch(r.paint.get("hillshade-method")){case"basic":i=4;break;case"combined":i=1;break;case"igor":i=2;break;case"multidirectional":i=3;break;default:i=0}const o=r.getIlluminationProperties();for(let a=0;a<o.directionRadians.length;a++)"viewport"===r.paint.get("hillshade-illumination-anchor")&&(o.directionRadians[a]+=e.transform.bearingInRadians);return{u_image:0,u_latrange:nn(0,t.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:o.altitudeRadians,u_azimuths:o.directionRadians,u_accent:n,u_method:i,u_highlights:o.highlightColor,u_shadows:o.shadowColor}},rn=(e,r)=>{const n=r.stride,i=t.N();return t.c7(i,0,t.a5,-t.a5,0,0,1),t.O(i,i,[0,-t.a5,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:e.overscaledZ,u_unpack:r.getUnpackVector()}};function nn(e,r){const n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new t.a9(0,i/n).toLngLat().lat,new t.a9(0,(i+1)/n).toLngLat().lat]}const on=(e,t,r=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:r,u_opacity:e.paint.get("color-relief-opacity")}),an=(e,r,n,i)=>{const o=e.transform;return{u_translation:dn(e,r,n),u_ratio:i/t.aN(r,1,o.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},sn=(e,r,n,i,o)=>t.e(an(e,r,n,i),{u_image:0,u_image_height:o}),ln=(e,r,n,i,o)=>{const a=e.transform,s=hn(r,a);return{u_translation:dn(e,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:i/t.aN(r,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[s,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},cn=(e,r,n,i,o)=>{const a=hn(r,e.transform);return t.e(an(e,r,n,i),{u_tileratio:a,u_crossfade_from:o.fromScale,u_crossfade_to:o.toScale,u_image:0,u_mix:o.t,u_lineatlas_width:e.lineAtlas.width,u_lineatlas_height:e.lineAtlas.height})},un=(e,r,n,i,o,a)=>{const s=hn(r,e.transform);return t.e(an(e,r,n,i),{u_image:0,u_image_height:a,u_tileratio:s,u_crossfade_from:o.fromScale,u_crossfade_to:o.toScale,u_image_dash:1,u_mix:o.t,u_lineatlas_width:e.lineAtlas.width,u_lineatlas_height:e.lineAtlas.height})};function hn(e,r){return 1/t.aN(e,1,r.tileZoom)}function dn(e,r,n){return t.aO(e.transform,r,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const pn=(e,t,r,n,i)=>{return{u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(a=n.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=n.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:fn(n.paint.get("raster-hue-rotate")),u_coords_top:[i[0].x,i[0].y,i[1].x,i[1].y],u_coords_bottom:[i[3].x,i[3].y,i[2].x,i[2].y]};var o,a};function fn(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const mn=(e,t,r,n,i,o,a,s,l,c,u,h,d)=>{const p=a.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:p.width/p.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+n,u_is_along_line:i,u_is_variable_anchor:o,u_texsize:h,u_texture:0,u_translation:c,u_pitched_scale:d}},gn=(e,r,n,i,o,a,s,l,c,u,h,d,p,f)=>{const m=s.transform;return t.e(mn(e,r,n,i,o,a,s,l,c,u,h,d,f),{u_gamma_scale:i?Math.cos(m.pitch*Math.PI/180)*m.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:1})},yn=(e,r,n,i,o,a,s,l,c,u,h,d,p)=>t.e(gn(e,r,n,i,o,a,s,l,c,u,!0,h,0,p),{u_texsize_icon:d,u_texture_icon:1}),_n=(e,t)=>({u_opacity:e,u_color:t}),vn=(e,r,n,i,o)=>t.e(function(e,r,n,i){const o=n.imageManager.getPattern(e.from.toString()),a=n.imageManager.getPattern(e.to.toString()),{width:s,height:l}=n.imageManager.getPixelSize(),c=Math.pow(2,i.tileID.overscaledZ),u=i.tileSize*Math.pow(2,n.transform.tileZoom)/c,h=u*(i.tileID.canonical.x+i.tileID.wrap*c),d=u*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:o.tl,u_pattern_br_a:o.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,l],u_mix:r.t,u_pattern_size_a:o.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:r.fromScale,u_scale_b:r.toScale,u_tile_units_to_pixels:1/t.aN(i,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(n,o,r,i),{u_opacity:e}),bn=(e,t)=>{},wn={fillExtrusion:(e,r)=>({u_lightpos:new t.c2(e,r.u_lightpos),u_lightpos_globe:new t.c2(e,r.u_lightpos_globe),u_lightintensity:new t.bq(e,r.u_lightintensity),u_lightcolor:new t.c2(e,r.u_lightcolor),u_vertical_gradient:new t.bq(e,r.u_vertical_gradient),u_opacity:new t.bq(e,r.u_opacity),u_fill_translate:new t.c3(e,r.u_fill_translate)}),fillExtrusionPattern:(e,r)=>({u_lightpos:new t.c2(e,r.u_lightpos),u_lightpos_globe:new t.c2(e,r.u_lightpos_globe),u_lightintensity:new t.bq(e,r.u_lightintensity),u_lightcolor:new t.c2(e,r.u_lightcolor),u_vertical_gradient:new t.bq(e,r.u_vertical_gradient),u_height_factor:new t.bq(e,r.u_height_factor),u_opacity:new t.bq(e,r.u_opacity),u_fill_translate:new t.c3(e,r.u_fill_translate),u_image:new t.b_(e,r.u_image),u_texsize:new t.c3(e,r.u_texsize),u_pixel_coord_upper:new t.c3(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c3(e,r.u_pixel_coord_lower),u_scale:new t.c2(e,r.u_scale),u_fade:new t.bq(e,r.u_fade)}),fill:(e,r)=>({u_fill_translate:new t.c3(e,r.u_fill_translate)}),fillPattern:(e,r)=>({u_image:new t.b_(e,r.u_image),u_texsize:new t.c3(e,r.u_texsize),u_pixel_coord_upper:new t.c3(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c3(e,r.u_pixel_coord_lower),u_scale:new t.c2(e,r.u_scale),u_fade:new t.bq(e,r.u_fade),u_fill_translate:new t.c3(e,r.u_fill_translate)}),fillOutline:(e,r)=>({u_world:new t.c3(e,r.u_world),u_fill_translate:new t.c3(e,r.u_fill_translate)}),fillOutlinePattern:(e,r)=>({u_world:new t.c3(e,r.u_world),u_image:new t.b_(e,r.u_image),u_texsize:new t.c3(e,r.u_texsize),u_pixel_coord_upper:new t.c3(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c3(e,r.u_pixel_coord_lower),u_scale:new t.c2(e,r.u_scale),u_fade:new t.bq(e,r.u_fade),u_fill_translate:new t.c3(e,r.u_fill_translate)}),circle:(e,r)=>({u_camera_to_center_distance:new t.bq(e,r.u_camera_to_center_distance),u_scale_with_map:new t.b_(e,r.u_scale_with_map),u_pitch_with_map:new t.b_(e,r.u_pitch_with_map),u_extrude_scale:new t.c3(e,r.u_extrude_scale),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_globe_extrude_scale:new t.bq(e,r.u_globe_extrude_scale),u_translate:new t.c3(e,r.u_translate)}),collisionBox:(e,r)=>({u_pixel_extrude_scale:new t.c3(e,r.u_pixel_extrude_scale)}),collisionCircle:(e,r)=>({u_viewport_size:new t.c3(e,r.u_viewport_size)}),debug:(e,r)=>({u_color:new t.b$(e,r.u_color),u_overlay:new t.b_(e,r.u_overlay),u_overlay_scale:new t.bq(e,r.u_overlay_scale)}),depth:bn,clippingMask:bn,heatmap:(e,r)=>({u_extrude_scale:new t.bq(e,r.u_extrude_scale),u_intensity:new t.bq(e,r.u_intensity),u_globe_extrude_scale:new t.bq(e,r.u_globe_extrude_scale)}),heatmapTexture:(e,r)=>({u_matrix:new t.c0(e,r.u_matrix),u_world:new t.c3(e,r.u_world),u_image:new t.b_(e,r.u_image),u_color_ramp:new t.b_(e,r.u_color_ramp),u_opacity:new t.bq(e,r.u_opacity)}),hillshade:(e,r)=>({u_image:new t.b_(e,r.u_image),u_latrange:new t.c3(e,r.u_latrange),u_exaggeration:new t.bq(e,r.u_exaggeration),u_altitudes:new t.c9(e,r.u_altitudes),u_azimuths:new t.c9(e,r.u_azimuths),u_accent:new t.b$(e,r.u_accent),u_method:new t.b_(e,r.u_method),u_shadows:new t.c8(e,r.u_shadows),u_highlights:new t.c8(e,r.u_highlights)}),hillshadePrepare:(e,r)=>({u_matrix:new t.c0(e,r.u_matrix),u_image:new t.b_(e,r.u_image),u_dimension:new t.c3(e,r.u_dimension),u_zoom:new t.bq(e,r.u_zoom),u_unpack:new t.c1(e,r.u_unpack)}),colorRelief:(e,r)=>({u_image:new t.b_(e,r.u_image),u_unpack:new t.c1(e,r.u_unpack),u_dimension:new t.c3(e,r.u_dimension),u_elevation_stops:new t.b_(e,r.u_elevation_stops),u_color_stops:new t.b_(e,r.u_color_stops),u_color_ramp_size:new t.b_(e,r.u_color_ramp_size),u_opacity:new t.bq(e,r.u_opacity)}),line:(e,r)=>({u_translation:new t.c3(e,r.u_translation),u_ratio:new t.bq(e,r.u_ratio),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c3(e,r.u_units_to_pixels)}),lineGradient:(e,r)=>({u_translation:new t.c3(e,r.u_translation),u_ratio:new t.bq(e,r.u_ratio),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c3(e,r.u_units_to_pixels),u_image:new t.b_(e,r.u_image),u_image_height:new t.bq(e,r.u_image_height)}),linePattern:(e,r)=>({u_translation:new t.c3(e,r.u_translation),u_texsize:new t.c3(e,r.u_texsize),u_ratio:new t.bq(e,r.u_ratio),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_image:new t.b_(e,r.u_image),u_units_to_pixels:new t.c3(e,r.u_units_to_pixels),u_scale:new t.c2(e,r.u_scale),u_fade:new t.bq(e,r.u_fade)}),lineSDF:(e,r)=>({u_translation:new t.c3(e,r.u_translation),u_ratio:new t.bq(e,r.u_ratio),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c3(e,r.u_units_to_pixels),u_image:new t.b_(e,r.u_image),u_mix:new t.bq(e,r.u_mix),u_tileratio:new t.bq(e,r.u_tileratio),u_crossfade_from:new t.bq(e,r.u_crossfade_from),u_crossfade_to:new t.bq(e,r.u_crossfade_to),u_lineatlas_width:new t.bq(e,r.u_lineatlas_width),u_lineatlas_height:new t.bq(e,r.u_lineatlas_height)}),lineGradientSDF:(e,r)=>({u_translation:new t.c3(e,r.u_translation),u_ratio:new t.bq(e,r.u_ratio),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.c3(e,r.u_units_to_pixels),u_image:new t.b_(e,r.u_image),u_image_height:new t.bq(e,r.u_image_height),u_tileratio:new t.bq(e,r.u_tileratio),u_crossfade_from:new t.bq(e,r.u_crossfade_from),u_crossfade_to:new t.bq(e,r.u_crossfade_to),u_image_dash:new t.b_(e,r.u_image_dash),u_mix:new t.bq(e,r.u_mix),u_lineatlas_width:new t.bq(e,r.u_lineatlas_width),u_lineatlas_height:new t.bq(e,r.u_lineatlas_height)}),raster:(e,r)=>({u_tl_parent:new t.c3(e,r.u_tl_parent),u_scale_parent:new t.bq(e,r.u_scale_parent),u_buffer_scale:new t.bq(e,r.u_buffer_scale),u_fade_t:new t.bq(e,r.u_fade_t),u_opacity:new t.bq(e,r.u_opacity),u_image0:new t.b_(e,r.u_image0),u_image1:new t.b_(e,r.u_image1),u_brightness_low:new t.bq(e,r.u_brightness_low),u_brightness_high:new t.bq(e,r.u_brightness_high),u_saturation_factor:new t.bq(e,r.u_saturation_factor),u_contrast_factor:new t.bq(e,r.u_contrast_factor),u_spin_weights:new t.c2(e,r.u_spin_weights),u_coords_top:new t.c1(e,r.u_coords_top),u_coords_bottom:new t.c1(e,r.u_coords_bottom)}),symbolIcon:(e,r)=>({u_is_size_zoom_constant:new t.b_(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.b_(e,r.u_is_size_feature_constant),u_size_t:new t.bq(e,r.u_size_t),u_size:new t.bq(e,r.u_size),u_camera_to_center_distance:new t.bq(e,r.u_camera_to_center_distance),u_pitch:new t.bq(e,r.u_pitch),u_rotate_symbol:new t.b_(e,r.u_rotate_symbol),u_aspect_ratio:new t.bq(e,r.u_aspect_ratio),u_fade_change:new t.bq(e,r.u_fade_change),u_label_plane_matrix:new t.c0(e,r.u_label_plane_matrix),u_coord_matrix:new t.c0(e,r.u_coord_matrix),u_is_text:new t.b_(e,r.u_is_text),u_pitch_with_map:new t.b_(e,r.u_pitch_with_map),u_is_along_line:new t.b_(e,r.u_is_along_line),u_is_variable_anchor:new t.b_(e,r.u_is_variable_anchor),u_texsize:new t.c3(e,r.u_texsize),u_texture:new t.b_(e,r.u_texture),u_translation:new t.c3(e,r.u_translation),u_pitched_scale:new t.bq(e,r.u_pitched_scale)}),symbolSDF:(e,r)=>({u_is_size_zoom_constant:new t.b_(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.b_(e,r.u_is_size_feature_constant),u_size_t:new t.bq(e,r.u_size_t),u_size:new t.bq(e,r.u_size),u_camera_to_center_distance:new t.bq(e,r.u_camera_to_center_distance),u_pitch:new t.bq(e,r.u_pitch),u_rotate_symbol:new t.b_(e,r.u_rotate_symbol),u_aspect_ratio:new t.bq(e,r.u_aspect_ratio),u_fade_change:new t.bq(e,r.u_fade_change),u_label_plane_matrix:new t.c0(e,r.u_label_plane_matrix),u_coord_matrix:new t.c0(e,r.u_coord_matrix),u_is_text:new t.b_(e,r.u_is_text),u_pitch_with_map:new t.b_(e,r.u_pitch_with_map),u_is_along_line:new t.b_(e,r.u_is_along_line),u_is_variable_anchor:new t.b_(e,r.u_is_variable_anchor),u_texsize:new t.c3(e,r.u_texsize),u_texture:new t.b_(e,r.u_texture),u_gamma_scale:new t.bq(e,r.u_gamma_scale),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_is_halo:new t.b_(e,r.u_is_halo),u_translation:new t.c3(e,r.u_translation),u_pitched_scale:new t.bq(e,r.u_pitched_scale)}),symbolTextAndIcon:(e,r)=>({u_is_size_zoom_constant:new t.b_(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.b_(e,r.u_is_size_feature_constant),u_size_t:new t.bq(e,r.u_size_t),u_size:new t.bq(e,r.u_size),u_camera_to_center_distance:new t.bq(e,r.u_camera_to_center_distance),u_pitch:new t.bq(e,r.u_pitch),u_rotate_symbol:new t.b_(e,r.u_rotate_symbol),u_aspect_ratio:new t.bq(e,r.u_aspect_ratio),u_fade_change:new t.bq(e,r.u_fade_change),u_label_plane_matrix:new t.c0(e,r.u_label_plane_matrix),u_coord_matrix:new t.c0(e,r.u_coord_matrix),u_is_text:new t.b_(e,r.u_is_text),u_pitch_with_map:new t.b_(e,r.u_pitch_with_map),u_is_along_line:new t.b_(e,r.u_is_along_line),u_is_variable_anchor:new t.b_(e,r.u_is_variable_anchor),u_texsize:new t.c3(e,r.u_texsize),u_texsize_icon:new t.c3(e,r.u_texsize_icon),u_texture:new t.b_(e,r.u_texture),u_texture_icon:new t.b_(e,r.u_texture_icon),u_gamma_scale:new t.bq(e,r.u_gamma_scale),u_device_pixel_ratio:new t.bq(e,r.u_device_pixel_ratio),u_is_halo:new t.b_(e,r.u_is_halo),u_translation:new t.c3(e,r.u_translation),u_pitched_scale:new t.bq(e,r.u_pitched_scale)}),background:(e,r)=>({u_opacity:new t.bq(e,r.u_opacity),u_color:new t.b$(e,r.u_color)}),backgroundPattern:(e,r)=>({u_opacity:new t.bq(e,r.u_opacity),u_image:new t.b_(e,r.u_image),u_pattern_tl_a:new t.c3(e,r.u_pattern_tl_a),u_pattern_br_a:new t.c3(e,r.u_pattern_br_a),u_pattern_tl_b:new t.c3(e,r.u_pattern_tl_b),u_pattern_br_b:new t.c3(e,r.u_pattern_br_b),u_texsize:new t.c3(e,r.u_texsize),u_mix:new t.bq(e,r.u_mix),u_pattern_size_a:new t.c3(e,r.u_pattern_size_a),u_pattern_size_b:new t.c3(e,r.u_pattern_size_b),u_scale_a:new t.bq(e,r.u_scale_a),u_scale_b:new t.bq(e,r.u_scale_b),u_pixel_coord_upper:new t.c3(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.c3(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.bq(e,r.u_tile_units_to_pixels)}),terrain:(e,r)=>({u_texture:new t.b_(e,r.u_texture),u_ele_delta:new t.bq(e,r.u_ele_delta),u_fog_matrix:new t.c0(e,r.u_fog_matrix),u_fog_color:new t.b$(e,r.u_fog_color),u_fog_ground_blend:new t.bq(e,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new t.bq(e,r.u_fog_ground_blend_opacity),u_horizon_color:new t.b$(e,r.u_horizon_color),u_horizon_fog_blend:new t.bq(e,r.u_horizon_fog_blend),u_is_globe_mode:new t.bq(e,r.u_is_globe_mode)}),terrainDepth:(e,r)=>({u_ele_delta:new t.bq(e,r.u_ele_delta)}),terrainCoords:(e,r)=>({u_texture:new t.b_(e,r.u_texture),u_terrain_coords_id:new t.bq(e,r.u_terrain_coords_id),u_ele_delta:new t.bq(e,r.u_ele_delta)}),projectionErrorMeasurement:(e,r)=>({u_input:new t.bq(e,r.u_input),u_output_expected:new t.bq(e,r.u_output_expected)}),atmosphere:(e,r)=>({u_sun_pos:new t.c2(e,r.u_sun_pos),u_atmosphere_blend:new t.bq(e,r.u_atmosphere_blend),u_globe_position:new t.c2(e,r.u_globe_position),u_globe_radius:new t.bq(e,r.u_globe_radius),u_inv_proj_matrix:new t.c0(e,r.u_inv_proj_matrix)}),sky:(e,r)=>({u_sky_color:new t.b$(e,r.u_sky_color),u_horizon_color:new t.b$(e,r.u_horizon_color),u_horizon:new t.c3(e,r.u_horizon),u_horizon_normal:new t.c3(e,r.u_horizon_normal),u_sky_horizon_blend:new t.bq(e,r.u_sky_horizon_blend),u_sky_blend:new t.bq(e,r.u_sky_blend)})};class xn{constructor(e,t,r){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Sn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class En{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n],o=t.attributes[i.name];void 0!==o&&e.vertexAttribPointer(o,i.components,e[Sn[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class An extends Tn{getDefault(){return t.bp.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Cn extends Tn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class In extends Tn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class kn extends Tn{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Pn extends Tn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Mn extends Tn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Rn extends Tn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Dn extends Tn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class On extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class Ln extends Tn{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Bn extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class $n extends Tn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class zn extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class Fn extends Tn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class qn extends Tn{getDefault(){return t.bp.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Nn extends Tn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class jn extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class Un extends Tn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Vn extends Tn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Gn extends Tn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Wn extends Tn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Hn extends Tn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Zn extends Tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Yn extends Tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Xn extends Tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Kn extends Tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Qn extends Tn{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Jn extends Tn{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const r=this.gl;ar(r)?r.bindVertexArray(e):null===(t=r.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ei extends Tn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ti extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ri extends Tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ni extends Tn{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class ii extends ni{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class oi extends ni{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ai extends ni{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const si="Framebuffer is not complete";class li{constructor(e,t,r,n,i){this.context=e,this.width=t,this.height=r;const o=e.gl,a=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new ii(e,a),n)this.depthAttachment=i?new ai(e,a):new oi(e,a);else if(i)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error(si)}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class ci{constructor(e){var t,r;if(this.gl=e,this.clearColor=new An(this),this.clearDepth=new Cn(this),this.clearStencil=new In(this),this.colorMask=new kn(this),this.depthMask=new Pn(this),this.stencilMask=new Mn(this),this.stencilFunc=new Rn(this),this.stencilOp=new Dn(this),this.stencilTest=new On(this),this.depthRange=new Ln(this),this.depthTest=new Bn(this),this.depthFunc=new $n(this),this.blend=new zn(this),this.blendFunc=new Fn(this),this.blendColor=new qn(this),this.blendEquation=new Nn(this),this.cullFace=new jn(this),this.cullFaceSide=new Un(this),this.frontFace=new Vn(this),this.program=new Gn(this),this.activeTexture=new Wn(this),this.viewport=new Hn(this),this.bindFramebuffer=new Zn(this),this.bindRenderbuffer=new Yn(this),this.bindTexture=new Xn(this),this.bindVertexBuffer=new Kn(this),this.bindElementBuffer=new Qn(this),this.bindVertexArray=new Jn(this),this.pixelStoreUnpack=new ei(this),this.pixelStoreUnpackPremultiplyAlpha=new ti(this),this.pixelStoreUnpackFlipY=new ri(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),ar(e)){this.HALF_FLOAT=e.HALF_FLOAT;const n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==n?void 0:n.RGBA16F_EXT,this.RGB16F=null!==(r=e.RGB16F)&&void 0!==r?r:null==n?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new xn(this,e,t)}createVertexBuffer(e,t,r){return new En(this,e,t,r)}createRenderbuffer(e,t,r){const n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r,n){return new li(this,e,t,r,n)}clear({color:e,depth:t,stencil:r}){const n=this.gl;let i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(i|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==r&&(i|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(i)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.bR(e.blendFunction,Jt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return ar(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return ar(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let ui;function hi(e,r,n,i,o){const a=e.context,s=e.transform,l=a.gl,c=e.useProgram("collisionBox"),u=[];let h=0,d=0;for(let t=0;t<i.length;t++){const p=i[t],f=r.getTile(p).getBucket(n);if(!f)continue;const m=o?f.textCollisionBox:f.iconCollisionBox,g=f.collisionCircleArray;g.length>0&&(u.push({circleArray:g,circleOffset:d,coord:p}),h+=g.length/4,d=h),m&&c.draw(a,l.LINES,rr.disabled,ir.disabled,e.colorModeForRenderPass(),tr.disabled,Xr(e.transform),e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),s.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}if(!o||!u.length)return;const p=e.useProgram("collisionCircle"),f=new t.ca;f.resize(4*h),f._trim();let m=0;for(const t of u)for(let e=0;e<t.circleArray.length/4;e++){const r=4*e,n=t.circleArray[r+0],i=t.circleArray[r+1],o=t.circleArray[r+2],a=t.circleArray[r+3];f.emplace(m++,n,i,o,a,0),f.emplace(m++,n,i,o,a,1),f.emplace(m++,n,i,o,a,2),f.emplace(m++,n,i,o,a,3)}(!ui||ui.length<2*h)&&(ui=function(e){const r=2*e,n=new t.cc;n.resize(r),n._trim();for(let t=0;t<r;t++){const e=6*t;n.uint16[e+0]=4*t+0,n.uint16[e+1]=4*t+1,n.uint16[e+2]=4*t+2,n.uint16[e+3]=4*t+2,n.uint16[e+4]=4*t+3,n.uint16[e+5]=4*t+0}return n}(h));const g=a.createIndexBuffer(ui,!0),y=a.createVertexBuffer(f,t.cb.members,!0);for(const _ of u){const r=Kr(e.transform);p.draw(a,l.TRIANGLES,rr.disabled,ir.disabled,e.colorModeForRenderPass(),tr.disabled,r,e.style.map.terrain&&e.style.map.terrain.getTerrainData(_.coord),null,n.id,y,g,t.aX.simpleSegment(0,2*_.circleOffset,_.circleArray.length,_.circleArray.length/2),null,e.transform.zoom,null,null,null)}y.destroy(),g.destroy()}const di=t.ar(new Float32Array(16));function pi(e,r,n,i,o,a){const{horizontalAlign:s,verticalAlign:l}=t.aS(e);return new t.P((-(s-.5)*r/o+i[0])*a,(-(l-.5)*n/o+i[1])*a)}function fi(e,r,n,i,o,a){const s=r.tileAnchorPoint.add(new t.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let e=i.mult(a);n||(e=e.rotate(-o));const t=s.add(e);return Ue(t.x,t.y,r.pitchedLabelPlaneMatrix,r.getElevation).point}if(n){const t=Qe(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(e),n=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(i.rotate(n))}return e.add(i)}function mi(e,r,n,i,o,a,s,l,c,u,h,d){const p=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let y=0;y<p.length;y++){const m=p.get(y),_=m.hidden||!m.crossTileID||e.allowVerticalPlacement&&!m.placedOrientation?null:i[m.crossTileID];if(_){const i=new t.P(m.anchorX,m.anchorY),p={getElevation:d,width:o.width,height:o.height,pitchedLabelPlaneMatrix:a,pitchWithMap:n,transform:o,tileAnchorPoint:i,translation:u,unwrappedTileID:h},y=n?et(i.x,i.y,p):Qe(i.x,i.y,p),v=Ve(o.cameraToCenterDistance,y.signedDistanceFromCamera);let b=t.aA(e.textSizeData,l,m)*v/t.aM;n&&(b*=e.tilePixelRatio/s);const{width:w,height:x,anchor:S,textOffset:E,textBoxScale:T}=_,A=pi(S,w,x,E,T,b),C=o.getPitchedTextCorrection(i.x+u[0],i.y+u[1],h),I=fi(y.point,p,r,A,-o.bearingInRadians,C),k=e.allowVerticalPlacement&&m.placedOrientation===t.az.vertical?Math.PI/2:0;for(let e=0;e<m.numGlyphs;e++)t.aG(f,I,k);c&&m.associatedIconIndex>=0&&(g[m.associatedIconIndex]={shiftedAnchor:I,angle:k})}else ot(m.numGlyphs,f)}if(c){m.clear();const r=e.icon.placedSymbolArray;for(let e=0;e<r.length;e++){const n=r.get(e);if(n.hidden)ot(n.numGlyphs,m);else{const r=g[e];if(r)for(let e=0;e<n.numGlyphs;e++)t.aG(m,r.shiftedAnchor,r.angle);else ot(n.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function gi(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function yi(e,r,n,i,o,a,s,l,c,u,h,d,p){const f=e.context,m=f.gl,g=e.transform,y="map"===l,_="map"===c,v="viewport"!==l&&"point"!==n.layout.get("symbol-placement"),b=y&&!_&&!v,w=!n.layout.get("symbol-sort-key").isConstant();let x=!1;const S=e.getDepthModeForSublayer(0,rr.ReadOnly),E=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),T=[],A=g.getCircleRadiusCorrection();for(const C of i){const i=r.getTile(C),l=i.getBucket(n);if(!l)continue;const c=o?l.text:l.icon;if(!c||!c.segments.get().length||!c.hasVisibleVertices)continue;const h=c.programConfigurations.get(n.id),d=o||l.sdfIcons,f=o?l.textSizeData:l.iconSizeData,S=_||0!==g.pitch,I=e.useProgram(gi(d,o,l),h),k=t.ay(f,g.zoom),P=e.style.map.terrain&&e.style.map.terrain.getTerrainData(C);let M,R,D,O,L=[0,0],B=null;if(o)R=i.glyphAtlasTexture,D=m.LINEAR,M=i.glyphAtlasTexture.size,l.iconsInText&&(L=i.imageAtlasTexture.size,B=i.imageAtlasTexture,O=S||e.options.rotating||e.options.zooming||"composite"===f.kind||"camera"===f.kind?m.LINEAR:m.NEAREST);else{const t=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;R=i.imageAtlasTexture,D=d||e.options.rotating||e.options.zooming||t||S?m.LINEAR:m.NEAREST,M=i.imageAtlasTexture.size}const $=t.aN(i,1,e.transform.zoom),z=qe(y,e.transform,$),F=t.N();t.aB(F,z);const q=Ne(_,y,e.transform,$),N=t.aO(g,i,a,s),j=g.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!p,applyTerrainMatrix:!0}),U=E&&l.hasTextData(),V="none"!==n.layout.get("icon-text-fit")&&U&&l.hasIconData();if(v){const t=e.style.map.terrain?(t,r)=>e.style.map.terrain.getElevation(C,t,r):null,r="map"===n.layout.get("text-rotation-alignment");We(l,e,o,z,F,_,u,r,C.toUnwrapped(),g.width,g.height,N,t)}const G=o&&E||V,W=v||G?di:_?z:e.transform.clipSpaceToPixelsMatrix,H=d&&0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let Z;Z=d?l.iconsInText?yn(f.kind,k,b,_,v,G,e,W,q,N,M,L,A):gn(f.kind,k,b,_,v,G,e,W,q,N,o,M,0,A):mn(f.kind,k,b,_,v,G,e,W,q,N,o,M,A);const Y={program:I,buffers:c,uniformValues:Z,projectionData:j,atlasTexture:R,atlasTextureIcon:B,atlasInterpolation:D,atlasInterpolationIcon:O,isSDF:d,hasHalo:H};if(w&&l.canOverlap){x=!0;const e=c.segments.get();for(const r of e)T.push({segments:new t.aX([r]),sortKey:r.sortKey,state:Y,terrainData:P})}else T.push({segments:c.segments,sortKey:0,state:Y,terrainData:P})}x&&T.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of T){const r=t.state;if(f.activeTexture.set(m.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,m.CLAMP_TO_EDGE),r.atlasTextureIcon&&(f.activeTexture.set(m.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),r.isSDF){const i=r.uniformValues;r.hasHalo&&(i.u_is_halo=1,_i(r.buffers,t.segments,n,e,r.program,S,h,d,i,r.projectionData,t.terrainData)),i.u_is_halo=0}_i(r.buffers,t.segments,n,e,r.program,S,h,d,r.uniformValues,r.projectionData,t.terrainData)}}function _i(e,t,r,n,i,o,a,s,l,c,u){const h=n.context;i.draw(h,h.gl.TRIANGLES,o,a,s,tr.backCCW,l,u,c,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function vi(e,r,n,i,o){const a=e.context,s=a.gl,l=ir.disabled,c=new Jt([s.ONE,s.ONE],t.bp.transparent,[!0,!0,!0,!0]),u=r.getBucket(n);if(!u)return;const h=i.key;let d=n.heatmapFbos.get(h);d||(d=wi(a,r.tileSize,r.tileSize),n.heatmapFbos.set(h,d)),a.bindFramebuffer.set(d.framebuffer),a.viewport.set([0,0,r.tileSize,r.tileSize]),a.clear({color:t.bp.transparent});const p=u.programConfigurations.get(n.id),f=e.useProgram("heatmap",p,!o),m=e.transform.getProjectionData({overscaledTileID:r.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g=e.style.map.terrain.getTerrainData(i);f.draw(a,s.TRIANGLES,rr.disabled,l,c,tr.disabled,Jr(r,e.transform.zoom,n.paint.get("heatmap-intensity"),1),g,m,n.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,n.paint,e.transform.zoom,p)}function bi(e,t,r,n,i){const o=e.context,a=o.gl,s=e.transform;o.setColorMode(e.colorModeForRenderPass());const l=xi(o,t),c=r.key,u=t.heatmapFbos.get(c);if(!u)return;o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,u.colorAttachment.get()),o.activeTexture.set(a.TEXTURE1),l.bind(a.LINEAR,a.CLAMP_TO_EDGE);const h=s.getProjectionData({overscaledTileID:r,applyTerrainMatrix:i,applyGlobeMatrix:!n});e.useProgram("heatmapTexture").draw(o,a.TRIANGLES,rr.disabled,ir.disabled,e.colorModeForRenderPass(),tr.disabled,en(e,t,0,1),null,h,t.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments,t.paint,s.zoom),u.destroy(),t.heatmapFbos.delete(c)}function wi(e,t,r){var n,i;const o=e.gl,a=o.createTexture();o.bindTexture(o.TEXTURE_2D,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR);const s=null!==(n=e.HALF_FLOAT)&&void 0!==n?n:o.UNSIGNED_BYTE,l=null!==(i=e.RGBA16F)&&void 0!==i?i:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,t,r,0,o.RGBA,s,null);const c=e.createFramebuffer(t,r,!1,!1);return c.colorAttachment.set(a),c}function xi(e,r){return r.colorRampTexture||(r.colorRampTexture=new t.T(e,r.colorRamp,e.gl.RGBA)),r.colorRampTexture}function Si(e,r,n,i,o,a,s,l){let c=256;if(o.stepInterpolant){const i=r.getSource().maxzoom,o=s.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-s.canonical.z):1;c=t.an(t.ce(a.maxLineLength/t.a5*1024*o),256,n.maxTextureSize)}return l.gradient=t.cf({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:c,image:l.gradient||void 0,clips:a.lineClipsArray}),l.texture?l.texture.update(l.gradient):l.texture=new t.T(n,l.gradient,i.RGBA),l.version=o.gradientVersion,l.texture}function Ei(e,t,r,n,i){e.activeTexture.set(t.TEXTURE0),r.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),n.updatePaintBuffers(i)}function Ti(e,t,r,n,i,o){(i||e.lineAtlas.dirty)&&(t.activeTexture.set(r.TEXTURE0),e.lineAtlas.bind(t)),n.updatePaintBuffers(o)}function Ai(e,t,r,n,i,o,a){const s=o.gradients[i.id];let l=s.texture;i.gradientVersion!==s.version&&(l=Si(e,t,r,n,i,o,a,s)),r.activeTexture.set(n.TEXTURE0),l.bind(i.stepInterpolant?n.NEAREST:n.LINEAR,n.CLAMP_TO_EDGE)}function Ci(e,t,r,n,i,o,a,s,l){const c=o.gradients[i.id];let u=c.texture;i.gradientVersion!==c.version&&(u=Si(e,t,r,n,i,o,a,c)),r.activeTexture.set(n.TEXTURE0),u.bind(i.stepInterpolant?n.NEAREST:n.LINEAR,n.CLAMP_TO_EDGE),r.activeTexture.set(n.TEXTURE1),e.lineAtlas.bind(r),s.updatePaintBuffers(l)}function Ii(e,t,r,n,i){if(!r||!n||!n.imageAtlas)return;const o=n.imageAtlas.patternPositions;let a=o[r.to.toString()],s=o[r.from.toString()];if(!a&&s&&(a=s),!s&&a&&(s=a),!a||!s){const e=i.getPaintProperty(t);a=o[e],s=o[e]}a&&s&&e.setConstantPatternPositions(a,s)}function ki(e,r,n,i,o,a,s,l){const c=e.context.gl,u="fill-pattern",h=n.paint.get(u),d=h&&h.constantOr(1),p=n.getCrossfadeParameters();let f,m,g,y,_;const v=e.transform,b=n.paint.get("fill-translate"),w=n.paint.get("fill-translate-anchor");s?(m=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",f=c.LINES):(m=d?"fillPattern":"fill",f=c.TRIANGLES);const x=h.constantOr(null);for(const S of i){const i=r.getTile(S);if(d&&!i.patternsLoaded())continue;const h=i.getBucket(n);if(!h)continue;const E=h.programConfigurations.get(n.id),T=e.useProgram(m,E),A=e.style.map.terrain&&e.style.map.terrain.getTerrainData(S);d&&(e.context.activeTexture.set(c.TEXTURE0),i.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),E.updatePaintBuffers(p)),Ii(E,u,x,i,n);const C=v.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!l,applyTerrainMatrix:!0}),I=t.aO(v,i,b,w);if(s){y=h.indexBuffer2,_=h.segments2;const t=[c.drawingBufferWidth,c.drawingBufferHeight];g="fillOutlinePattern"===m&&d?Zr(e,p,i,t,I):Hr(t,I)}else y=h.indexBuffer,_=h.segments,g=d?Wr(e,p,i,I):{u_fill_translate:I};const k=e.stencilModeForClipping(S);T.draw(e.context,f,o,k,a,tr.backCCW,g,A,C,n.id,h.layoutVertexBuffer,y,_,n.paint,e.transform.zoom,E)}}function Pi(e,r,n,i,o,a,s,l){const c=e.context,u=c.gl,h="fill-extrusion-pattern",d=n.paint.get(h),p=d.constantOr(1),f=n.getCrossfadeParameters(),m=n.paint.get("fill-extrusion-opacity"),g=d.constantOr(null),y=e.transform;for(const _ of i){const i=r.getTile(_),d=i.getBucket(n);if(!d)continue;const v=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_),b=d.programConfigurations.get(n.id),w=e.useProgram(p?"fillExtrusionPattern":"fillExtrusion",b);p&&(e.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),b.updatePaintBuffers(f));const x=y.getProjectionData({overscaledTileID:_,applyGlobeMatrix:!l,applyTerrainMatrix:!0});Ii(b,h,g,i,n);const S=t.aO(y,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),E=n.paint.get("fill-extrusion-vertical-gradient"),T=p?Gr(e,E,m,S,_,f,i):Vr(e,E,m,S);w.draw(c,c.gl.TRIANGLES,o,a,s,tr.backCCW,T,v,x,n.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,n.paint,e.transform.zoom,b,e.style.map.terrain&&d.centroidVertexBuffer)}}function Mi(e,t,r,n,i,o,a,s,l){var c;const u=e.style.projection,h=e.context,d=e.transform,p=h.gl,f=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],m=e.useProgram("hillshade",null,!1,f),g=!e.options.moving;for(const y of n){const n=t.getTile(y),f=n.fbo;if(!f)continue;const _=u.getMeshFromTileID(h,y.canonical,s,!0,"raster"),v=null===(c=e.style.map.terrain)||void 0===c?void 0:c.getTerrainData(y);h.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,f.colorAttachment.get());const b=d.getProjectionData({overscaledTileID:y,aligned:g,applyGlobeMatrix:!l,applyTerrainMatrix:!0});m.draw(h,p.TRIANGLES,o,i[y.overscaledZ],a,tr.backCCW,tn(e,n,r),v,b,r.id,_.vertexBuffer,_.indexBuffer,_.segments)}}function Ri(e,r,n,i,o,a,s,l,c){var u;const h=e.style.projection,d=e.context,p=e.transform,f=d.gl,m=e.useProgram("colorRelief"),g=!e.options.moving;let y=!0,_=0;for(const v of i){const i=r.getTile(v),b=i.dem;if(y){const e=f.getParameter(f.MAX_TEXTURE_SIZE),{elevationTexture:t,colorTexture:r}=n.getColorRampTextures(d,e,b.getUnpackVector());d.activeTexture.set(f.TEXTURE1),t.bind(f.NEAREST,f.CLAMP_TO_EDGE),d.activeTexture.set(f.TEXTURE4),r.bind(f.LINEAR,f.CLAMP_TO_EDGE),y=!1,_=t.size[0]}if(!b||!b.data)continue;const w=b.stride,x=b.getPixels();if(d.activeTexture.set(f.TEXTURE0),d.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(w),i.demTexture){const e=i.demTexture;e.update(x,{premultiply:!1}),e.bind(f.LINEAR,f.CLAMP_TO_EDGE)}else i.demTexture=new t.T(d,x,f.RGBA,{premultiply:!1}),i.demTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE);const S=h.getMeshFromTileID(d,v.canonical,l,!0,"raster"),E=null===(u=e.style.map.terrain)||void 0===u?void 0:u.getTerrainData(v),T=p.getProjectionData({overscaledTileID:v,aligned:g,applyGlobeMatrix:!c,applyTerrainMatrix:!0});m.draw(d,f.TRIANGLES,a,o[v.overscaledZ],s,tr.backCCW,on(n,i.dem,_),E,T,n.id,S.vertexBuffer,S.indexBuffer,S.segments)}}const Di=[new t.P(0,0),new t.P(t.a5,0),new t.P(t.a5,t.a5),new t.P(0,t.a5)];function Oi(e,t,r,n,i,o,a,s,l=!1,c=!1){const u=n[n.length-1].overscaledZ,h=e.context,d=h.gl,p=e.useProgram("raster"),f=e.transform,m=e.style.projection,g=e.colorModeForRenderPass(),y=!e.options.moving,_=r.paint.get("raster-opacity"),v=r.paint.get("raster-resampling"),b=r.paint.get("raster-fade-duration"),w=!!e.style.map.terrain;for(const x of n){const n=e.getDepthModeForSublayer(x.overscaledZ-u,1===_?rr.ReadWrite:rr.ReadOnly,d.LESS),S=t.getTile(x),E="nearest"===v?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),S.texture.bind(E,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1);const{parentTile:T,parentScaleBy:A,parentTopLeft:C,fadeValues:I}=Li(S,t,b,w);S.fadeOpacity=I.tileOpacity,T?(T.fadeOpacity=I.parentTileOpacity,T.texture.bind(E,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST)):S.texture.bind(E,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),S.texture.useMipmap&&h.extTextureFilterAnisotropic&&e.transform.pitch>20&&d.texParameterf(d.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const k=e.style.map.terrain&&e.style.map.terrain.getTerrainData(x),P=f.getProjectionData({overscaledTileID:x,aligned:y,applyGlobeMatrix:!c,applyTerrainMatrix:!0}),M=pn(C,A,I.fadeMix,r,s),R=m.getMeshFromTileID(h,x.canonical,o,a,"raster");p.draw(h,d.TRIANGLES,n,i?i[x.overscaledZ]:ir.disabled,g,l?tr.frontCCW:tr.backCCW,M,k,P,r.id,R.vertexBuffer,R.indexBuffer,R.segments)}}function Li(e,r,n,i){const o={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(0===n||i)return o;if(e.fadingParentID){const i=r.getLoadedTile(e.fadingParentID);if(!i)return o;const a=Math.pow(2,i.tileID.overscaledZ-e.tileID.overscaledZ);return{parentTile:i,parentScaleBy:a,parentTopLeft:[e.tileID.canonical.x*a%1,e.tileID.canonical.y*a%1],fadeValues:function(e,r,n){const i=c(),o=(i-r.timeAdded)/n,a=e.fadingDirection===he.Incoming,s=t.an((i-e.timeAdded)/n,0,1),l=t.an(1-o,0,1),u=a?s:l;return{tileOpacity:u,parentTileOpacity:a?l:s,fadeMix:{opacity:1,mix:1-u}}}(e,i,n)}}return e.selfFading?{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:function(e,r){const n=(c()-e.timeAdded)/r,i=t.an(n,0,1);return{tileOpacity:i,fadeMix:{opacity:i,mix:0}}}(e,n)}:o}const Bi=new t.bp(1,0,0,1),$i=new t.bp(0,1,0,1),zi=new t.bp(0,0,1,1),Fi=new t.bp(1,0,1,1),qi=new t.bp(0,1,1,1);function Ni(e,t,r,n){Ui(e,0,t+r/2,e.transform.width,r,n)}function ji(e,t,r,n){Ui(e,t-r/2,0,r,e.transform.height,n)}function Ui(e,t,r,n,i,o){const a=e.context,s=a.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,r*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio),a.clear({color:o}),s.disable(s.SCISSOR_TEST)}function Vi(e,r,n){const i=e.context,o=i.gl,a=e.useProgram("debug"),s=rr.disabled,l=ir.disabled,c=e.colorModeForRenderPass(),u="$debug",h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(n);i.activeTexture.set(o.TEXTURE0);const d=r.getTileByID(n.key).latestRawTileData,p=Math.floor((d&&d.byteLength||0)/1024),f=r.getTile(n).tileSize,m=512/Math.min(f,512)*(n.overscaledZ/e.transform.zoom)*.5;let g=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(g+=` => ${n.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(e,`${g} ${p}kB`);const y=e.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});a.draw(i,o.TRIANGLES,s,l,Jt.alphaBlended,tr.disabled,Qr(t.bp.transparent,m),null,y,u,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),a.draw(i,o.LINE_STRIP,s,l,c,tr.disabled,Qr(t.bp.red),h,y,u,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function Gi(e,t,r,n){const{isRenderingGlobe:i}=n,o=e.context,a=o.gl,s=e.transform,l=e.colorModeForRenderPass(),c=e.getDepthModeFor3D(),u=e.useProgram("terrain");o.bindFramebuffer.set(null),o.viewport.set([0,0,e.width,e.height]);for(const h of r){const r=t.getTerrainMesh(h.tileID),n=e.renderToTexture.getTexture(h),d=t.getTerrainData(h.tileID);o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n.texture);const p=t.getMeshFrameDelta(s.zoom),f=s.calculateFogMatrix(h.tileID.toUnwrapped()),m=Fr(p,f,e.style.sky,s.pitch,i),g=s.getProjectionData({overscaledTileID:h.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(o,a.TRIANGLES,c,ir.disabled,l,tr.backCCW,m,d,g,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}function Wi(e,r){if(!r.mesh){const n=new t.aW;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const i=new t.aY;i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),r.mesh=new Bt(e.createVertexBuffer(n,$t.members),e.createIndexBuffer(i),t.aX.simpleSegment(0,0,n.length,i.length))}return r.mesh}class Hi{constructor(e,r){this.context=new ci(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Be.maxOverzooming+Be.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Rt}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const n of this.style._order)this.style._layers[n].resize()}setup(){const e=this.context,r=new t.aW;r.emplaceBack(0,0),r.emplaceBack(t.a5,0),r.emplaceBack(0,t.a5),r.emplaceBack(t.a5,t.a5),this.tileExtentBuffer=e.createVertexBuffer(r,$t.members),this.tileExtentSegments=t.aX.simpleSegment(0,0,4,2);const n=new t.aW;n.emplaceBack(0,0),n.emplaceBack(t.a5,0),n.emplaceBack(0,t.a5),n.emplaceBack(t.a5,t.a5),this.debugBuffer=e.createVertexBuffer(n,$t.members),this.debugSegments=t.aX.simpleSegment(0,0,4,5);const i=new t.ch;i.emplaceBack(0,0,0,0),i.emplaceBack(t.a5,0,t.a5,0),i.emplaceBack(0,t.a5,0,t.a5),i.emplaceBack(t.a5,t.a5,t.a5,t.a5),this.rasterBoundsBuffer=e.createVertexBuffer(i,$r.members),this.rasterBoundsSegments=t.aX.simpleSegment(0,0,4,2);const o=new t.aW;o.emplaceBack(0,0),o.emplaceBack(t.a5,0),o.emplaceBack(0,t.a5),o.emplaceBack(t.a5,t.a5),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(o,$t.members),this.rasterBoundsSegmentsPosOnly=t.aX.simpleSegment(0,0,4,5);const a=new t.aW;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,$t.members),this.viewportSegments=t.aX.simpleSegment(0,0,4,2);const s=new t.ci;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);const l=new t.aY;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);const c=this.context.gl;this.stencilClearMode=new ir({func:c.ALWAYS,mask:0},0,255,c.ZERO,c.ZERO,c.ZERO),this.tileExtentMesh=new Bt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=t.N();t.c7(n,0,this.width,this.height,0,0,1),t.Q(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const i={mainMatrix:n,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:n};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,rr.disabled,this.stencilClearMode,Jt.disabled,tr.disabled,null,null,i,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t,r){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source,this.nextStencilID+t.length>256&&this.clearStencil();const n=this.context;n.setColorMode(Jt.disabled),n.setDepthMode(rr.disabled);const i={};for(const o of t)i[o.key]=this.nextStencilID++;this._renderTileMasks(i,t,r,!0),this._renderTileMasks(i,t,r,!1),this._tileClippingMaskIDs=i}_renderTileMasks(e,t,r,n){const i=this.context,o=i.gl,a=this.style.projection,s=this.transform,l=this.useProgram("clippingMask");for(const c of t){const t=e[c.key],u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(c),h=a.getMeshFromTileID(this.context,c.canonical,n,!0,"stencil"),d=s.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!r,applyTerrainMatrix:!0});l.draw(i,o.TRIANGLES,rr.disabled,new ir({func:o.ALWAYS,mask:0},t,255,o.KEEP,o.KEEP,o.REPLACE),Jt.disabled,r?tr.disabled:tr.backCCW,null,u,d,"$clipping",h.vertexBuffer,h.indexBuffer,h.segments)}}_renderTilesDepthBuffer(){const e=this.context,t=e.gl,r=this.style.projection,n=this.transform,i=this.useProgram("depth"),o=this.getDepthModeFor3D(),a=Ce(n,{tileSize:n.tileSize});for(const s of a){const a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s),l=r.getMeshFromTileID(this.context,s.canonical,!0,!0,"raster"),c=n.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});i.draw(e,t.TRIANGLES,o,ir.disabled,Jt.disabled,tr.backCCW,null,a,c,"$clipping",l.vertexBuffer,l.indexBuffer,l.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new ir({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new ir({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const t=this.context.gl,r=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let r=0;r<i;r++)e[r+n]=new ir({func:t.GEQUAL,mask:255},r+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,r]}return[{[n]:ir.disabled},r]}stencilConfigForOverlapTwoPass(e){const t=this.context.gl,r=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(this.clearStencil(),i>1){const e={},o={};for(let r=0;r<i;r++)e[r+n]=new ir({func:t.GREATER,mask:255},i+1+r,255,t.KEEP,t.KEEP,t.REPLACE),o[r+n]=new ir({func:t.GREATER,mask:255},1+r,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID=2*i+1,[e,o,r]}return this.nextStencilID=3,[{[n]:new ir({func:t.GREATER,mask:255},2,255,t.KEEP,t.KEEP,t.REPLACE)},{[n]:new ir({func:t.GREATER,mask:255},1,255,t.KEEP,t.KEEP,t.REPLACE)},r]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new Jt([e.CONSTANT_COLOR,e.ONE],new t.bp(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Jt.unblended:Jt.alphaBlended}getDepthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return rr.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new rr(r||this.context.gl.LEQUAL,t,[n,n])}getDepthModeFor3D(){return new rr(this.context.gl.LEQUAL,rr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var n,i;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(c()),this.imageManager.beginFrame();const o=this.style._order,a=this.style.tileManagers,s={},l={},u={},h={isRenderingToTexture:!1,isRenderingGlobe:(null===(n=e.projection)||void 0===n?void 0:n.transitionState)>0};for(const t in a){const e=a[t];e.used&&e.prepare(this.context),s[t]=e.getVisibleCoordinates(!1),l[t]=s[t].slice().reverse(),u[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<o.length;t++)if(this.style._layers[o[t]].is3D()){this.opaquePassCutoff=t;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of o){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const r=l[e.source];("custom"===e.type||r.length)&&this.renderLayer(this,a[e.source],e,r,h)}if(null===(i=this.style.projection)||void 0===i||i.updateGPUdependent({context:this.context,useProgram:e=>this.useProgram(e)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.bp.black:t.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(e,t){const r=e.context,n=r.gl,i=((e,t,r)=>{const n=Math.cos(t.rollInRadians),i=Math.sin(t.rollInRadians),o=_e(t),a=t.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:e.properties.get("sky-color"),u_horizon_color:e.properties.get("horizon-color"),u_horizon:[(t.width/2-o*i)*r,(t.height/2+o*n)*r],u_horizon_normal:[-i,n],u_sky_horizon_blend:e.properties.get("sky-horizon-blend")*t.height/2*r,u_sky_blend:a}})(t,e.style.map.transform,e.pixelRatio),o=new rr(n.LEQUAL,rr.ReadWrite,[0,1]),a=ir.disabled,s=e.colorModeForRenderPass(),l=e.useProgram("sky"),c=Wi(r,t);l.draw(r,n.TRIANGLES,o,a,s,tr.disabled,i,null,void 0,"sky",c.vertexBuffer,c.indexBuffer,c.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[o[this.currentLayer]],t=a[e.source],r=s[e.source];this._renderTileClippingMasks(e,r,!1),this.renderLayer(this,t,e,r,h)}this.renderPass="translucent";let d=!1;for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const e=this.style._layers[o[this.currentLayer]],t=a[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e,h))continue;this.opaquePassEnabledForLayer()||d||(d=!0,h.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const r=("symbol"===e.type?u:l)[e.source];this._renderTileClippingMasks(e,s[e.source],!!this.renderToTexture),this.renderLayer(this,t,e,r,h)}if(h.isRenderingGlobe&&function(e,r,n){const i=e.context,o=i.gl,a=e.useProgram("atmosphere"),s=new rr(o.LEQUAL,rr.ReadOnly,[0,1]),l=e.transform,c=function(e,r){const n=e.properties.get("position"),i=[-n.x,-n.y,-n.z],o=t.ar(new Float64Array(16));return"map"===e.properties.get("anchor")&&(t.bg(o,o,r.rollInRadians),t.bh(o,o,-r.pitchInRadians),t.bg(o,o,r.bearingInRadians),t.bh(o,o,r.center.lat*Math.PI/180),t.bJ(o,o,-r.center.lng*Math.PI/180)),t.cg(i,i,o),i}(n,e.transform),u=l.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),h=r.properties.get("atmosphere-blend")*u.projectionTransition;if(0===h)return;const d=yr(l.worldSize,l.center.lat),p=l.inverseProjectionMatrix,f=new Float64Array(4);f[3]=1,t.aH(f,f,l.modelViewProjectionMatrix),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1,t.aH(f,f,p),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1;const m=((e,t,r,n,i)=>({u_sun_pos:e,u_atmosphere_blend:t,u_globe_position:r,u_globe_radius:n,u_inv_proj_matrix:i}))(c,h,[f[0],f[1],f[2]],d,p),g=Wi(i,r);a.draw(i,o.TRIANGLES,s,ir.disabled,Jt.alphaBlended,tr.disabled,m,null,null,"atmosphere",g.vertexBuffer,g.indexBuffer,g.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const e=function(e,t){let r=null;const n=Object.values(e._layers).flatMap((r=>r.source&&!r.isHidden(t)?[e.tileManagers[r.source]]:[])),i=n.filter((e=>"vector"===e.getSource().type)),o=n.filter((e=>"vector"!==e.getSource().type)),a=e=>{(!r||r.getSource().maxzoom<e.getSource().maxzoom)&&(r=e)};return i.forEach((e=>a(e))),r||o.forEach((e=>a(e))),r}(this.style,this.transform.zoom);e&&function(e,t,r){for(let n=0;n<r.length;n++)Vi(e,t,r[n])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Ni(e,e.transform.height-(t.top||0),3,Bi),Ni(e,t.bottom||0,3,$i),ji(e,t.left||0,3,zi),ji(e,e.transform.width-(t.right||0),3,Fi);const r=e.transform.centerPoint;var n,i,o,a;n=e,i=r.x,o=e.transform.height-r.y,Ui(n,i-1,o-10,2,20,a=qi),Ui(n,i-10,o-1,20,2,a)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,n=this.transform.modelViewProjectionMatrix;let i=this.terrainFacilitator.dirty;i||(i=e?!t.cj(r,n):!t.ck(r,n)),i||(i=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),i&&(t.cl(r,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,r){const n=e.context,i=n.gl,o=e.transform,a=Jt.unblended,s=new rr(i.LEQUAL,rr.ReadWrite,[0,1]),l=r.tileManager.getRenderableTiles(),c=e.useProgram("terrainDepth");n.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.bp.transparent,depth:1});for(const t of l){const e=r.getTerrainMesh(t.tileID),l=r.getTerrainData(t.tileID),u=o.getProjectionData({overscaledTileID:t.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),h={u_ele_delta:r.getMeshFrameDelta(o.zoom)};c.draw(n,i.TRIANGLES,s,ir.disabled,a,tr.backCCW,h,l,u,"terrain",e.vertexBuffer,e.indexBuffer,e.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,r){const n=e.context,i=n.gl,o=e.transform,a=Jt.unblended,s=new rr(i.LEQUAL,rr.ReadWrite,[0,1]),l=r.getCoordsTexture(),c=r.tileManager.getRenderableTiles(),u=e.useProgram("terrainCoords");n.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.bp.transparent,depth:1}),r.coordsIndex=[];for(const t of c){const e=r.getTerrainMesh(t.tileID),c=r.getTerrainData(t.tileID);n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);const h={u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0,u_ele_delta:r.getMeshFrameDelta(o.zoom)},d=o.getProjectionData({overscaledTileID:t.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(n,i.TRIANGLES,s,ir.disabled,a,tr.backCCW,h,c,d,"terrain",e.vertexBuffer,e.indexBuffer,e.segments),r.coordsIndex.push(t.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,r,n,i,o){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(i||[]).length)&&(this.id=n.id,t.cm(n)?function(e,r,n,i,o,a){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:s}=a,l=ir.disabled,c=e.colorModeForRenderPass();(n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,r,n,i,o,a,s,l,c){const u=r.transform,h=r.style.map.terrain,d="map"===o,p="map"===a;for(const f of e){const e=i.getTile(f),o=e.getBucket(n);if(!o||!o.text||!o.text.segments.get().length)continue;const a=t.ay(o.textSizeData,u.zoom),m=t.aN(e,1,r.transform.zoom),g=qe(d,r.transform,m),y="none"!==n.layout.get("icon-text-fit")&&o.hasIconData();if(a){const r=Math.pow(2,u.zoom-e.tileID.overscaledZ),n=h?(e,t)=>h.getElevation(f,e,t):null;mi(o,d,p,c,u,g,r,a,y,t.aO(u,e,s,l),f.toUnwrapped(),n)}}}(i,e,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),o),0!==n.paint.get("icon-opacity").constantOr(1)&&yi(e,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),l,c,s),0!==n.paint.get("text-opacity").constantOr(1)&&yi(e,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),l,c,s),r.map.showCollisionBoxes&&(hi(e,r,n,i,!0),hi(e,r,n,i,!1))}(e,r,n,i,this.style.placement.variableOffsets,o):t.cn(n)?function(e,r,n,i,o){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:a}=o,s=n.paint.get("circle-opacity"),l=n.paint.get("circle-stroke-width"),c=n.paint.get("circle-stroke-opacity"),u=!n.layout.get("circle-sort-key").isConstant();if(0===s.constantOr(1)&&(0===l.constantOr(1)||0===c.constantOr(1)))return;const h=e.context,d=h.gl,p=e.transform,f=e.getDepthModeForSublayer(0,rr.ReadOnly),m=ir.disabled,g=e.colorModeForRenderPass(),y=[],_=p.getCircleRadiusCorrection();for(let v=0;v<i.length;v++){const o=i[v],s=r.getTile(o),l=s.getBucket(n);if(!l)continue;const c=n.paint.get("circle-translate"),h=n.paint.get("circle-translate-anchor"),d=t.aO(p,s,c,h),f=l.programConfigurations.get(n.id),m=e.useProgram("circle",f),g=l.layoutVertexBuffer,b=l.indexBuffer,w=e.style.map.terrain&&e.style.map.terrain.getTerrainData(o),x={programConfiguration:f,program:m,layoutVertexBuffer:g,indexBuffer:b,uniformValues:Yr(e,s,n,d,_),terrainData:w,projectionData:p.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!a,applyTerrainMatrix:!0})};if(u){const e=l.segments.get();for(const r of e)y.push({segments:new t.aX([r]),sortKey:r.sortKey,state:x})}else y.push({segments:l.segments,sortKey:0,state:x})}u&&y.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of y){const{programConfiguration:r,program:i,layoutVertexBuffer:o,indexBuffer:a,uniformValues:s,terrainData:l,projectionData:c}=t.state;i.draw(h,d.TRIANGLES,f,m,g,tr.backCCW,s,l,c,n.id,o,a,t.segments,n.paint,e.transform.zoom,r)}}(e,r,n,i,o):t.co(n)?function(e,r,n,i,o){if(0===n.paint.get("heatmap-opacity"))return;const a=e.context,{isRenderingToTexture:s,isRenderingGlobe:l}=o;if(e.style.map.terrain){for(const t of i){const i=r.getTile(t);r.hasRenderableParent(t)||("offscreen"===e.renderPass?vi(e,i,n,t,l):"translucent"===e.renderPass&&bi(e,n,t,s,l))}a.viewport.set([0,0,e.width,e.height])}else"offscreen"===e.renderPass?function(e,r,n,i){const o=e.context,a=o.gl,s=e.transform,l=ir.disabled,c=new Jt([a.ONE,a.ONE],t.bp.transparent,[!0,!0,!0,!0]);(function(e,r,n){const i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,r.width/4,r.height/4]);let o=n.heatmapFbos.get(t.cd);o?(i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),e.bindFramebuffer.set(o.framebuffer)):(o=wi(e,r.width/4,r.height/4),n.heatmapFbos.set(t.cd,o))})(o,e,n),o.clear({color:t.bp.transparent});for(let t=0;t<i.length;t++){const u=i[t];if(r.hasRenderableParent(u))continue;const h=r.getTile(u),d=h.getBucket(n);if(!d)continue;const p=d.programConfigurations.get(n.id),f=e.useProgram("heatmap",p),m=s.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),g=s.getCircleRadiusCorrection();f.draw(o,a.TRIANGLES,rr.disabled,l,c,tr.backCCW,Jr(h,s.zoom,n.paint.get("heatmap-intensity"),g),null,m,n.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,n.paint,s.zoom,p)}o.viewport.set([0,0,e.width,e.height])}(e,r,n,i):"translucent"===e.renderPass&&function(e,r){const n=e.context,i=n.gl;n.setColorMode(e.colorModeForRenderPass());const o=r.heatmapFbos.get(t.cd);o&&(n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1),xi(n,r).bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(n,i.TRIANGLES,rr.disabled,ir.disabled,e.colorModeForRenderPass(),tr.disabled,en(e,r,0,1),null,null,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom))}(e,n)}(e,r,n,i,o):t.cp(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:o}=i,a=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(0===a.constantOr(1)||0===s.constantOr(1))return;const l=e.getDepthModeForSublayer(0,rr.ReadOnly),c=e.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),h=u.constantOr(1),d=r.paint.get("line-pattern"),p=d.constantOr(1),f=r.paint.get("line-gradient"),m=r.getCrossfadeParameters();let g;g=p?"linePattern":h&&f?"lineGradientSDF":h?"lineSDF":f?"lineGradient":"line";const y=e.context,_=y.gl,v=e.transform;let b=!0;for(const w of n){const n=t.getTile(w);if(p&&!n.patternsLoaded())continue;const i=n.getBucket(r);if(!i)continue;const a=i.programConfigurations.get(r.id),s=e.context.program.get(),x=e.useProgram(g,a),S=b||x.program!==s,E=e.style.map.terrain&&e.style.map.terrain.getTerrainData(w),T=d.constantOr(null),A=u&&u.constantOr(null);if(T&&n.imageAtlas){const e=n.imageAtlas,t=e.patternPositions[T.to.toString()],r=e.patternPositions[T.from.toString()];t&&r&&a.setConstantPatternPositions(t,r)}else if(A){const t="round"===r.layout.get("line-cap"),n=e.lineAtlas.getDash(A.to,t),i=e.lineAtlas.getDash(A.from,t);a.setConstantDashPositions(n,i)}const C=v.getProjectionData({overscaledTileID:w,applyGlobeMatrix:!o,applyTerrainMatrix:!0}),I=v.getPixelScale();let k;p?(k=ln(e,n,r,I,m),Ei(y,_,n,a,m)):h&&f?(k=un(e,n,r,I,m,i.lineClipsArray.length),Ci(e,t,y,_,r,i,w,a,m)):h?(k=cn(e,n,r,I,m),Ti(e,y,_,a,S,m)):f?(k=sn(e,n,r,I,i.lineClipsArray.length),Ai(e,t,y,_,r,i,w)):k=an(e,n,r,I);const P=e.stencilModeForClipping(w);x.draw(y,_.TRIANGLES,l,P,c,tr.disabled,k,E,C,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,r.paint,e.transform.zoom,a,i.layoutVertexBuffer2),b=!1}}(e,r,n,i,o):t.cq(n)?function(e,r,n,i,o){const a=n.paint.get("fill-color"),s=n.paint.get("fill-opacity");if(0===s.constantOr(1))return;const{isRenderingToTexture:l}=o,c=e.colorModeForRenderPass(),u=n.paint.get("fill-pattern"),h=e.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===a.constantOr(t.bp.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===h){const t=e.getDepthModeForSublayer(1,"opaque"===e.renderPass?rr.ReadWrite:rr.ReadOnly);ki(e,r,n,i,t,c,!1,l)}if("translucent"===e.renderPass&&n.paint.get("fill-antialias")){const t=e.getDepthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,rr.ReadOnly);ki(e,r,n,i,t,c,!0,l)}}(e,r,n,i,o):t.cr(n)?function(e,t,r,n,i){const o=r.paint.get("fill-extrusion-opacity");if(0===o)return;const{isRenderingToTexture:a}=i;if("translucent"===e.renderPass){const i=new rr(e.context.gl.LEQUAL,rr.ReadWrite,e.depthRangeFor3D);if(1!==o||r.paint.get("fill-extrusion-pattern").constantOr(1))Pi(e,t,r,n,i,ir.disabled,Jt.disabled,a),Pi(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass(),a);else{const o=e.colorModeForRenderPass();Pi(e,t,r,n,i,ir.disabled,o,a)}}}(e,r,n,i,o):t.cs(n)?function(e,r,n,i,o){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const{isRenderingToTexture:a}=o,s=e.context,l=e.style.projection.useSubdivision,c=e.getDepthModeForSublayer(0,rr.ReadOnly),u=e.colorModeForRenderPass();if("offscreen"===e.renderPass)!function(e,r,n,i,o,a,s){const l=e.context,c=l.gl;for(const u of n){const n=r.getTile(u),h=n.dem;if(!h||!h.data)continue;if(!n.needsHillshadePrepare)continue;const d=h.dim,p=h.stride,f=h.getPixels();if(l.activeTexture.set(c.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(p),n.demTexture){const e=n.demTexture;e.update(f,{premultiply:!1}),e.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.T(l,f,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);l.activeTexture.set(c.TEXTURE0);let m=n.fbo;if(!m){const e=new t.T(l,{width:d,height:d,data:null},c.RGBA);e.bind(c.LINEAR,c.CLAMP_TO_EDGE),m=n.fbo=l.createFramebuffer(d,d,!0,!1),m.colorAttachment.set(e.texture)}l.bindFramebuffer.set(m.framebuffer),l.viewport.set([0,0,d,d]),e.useProgram("hillshadePrepare").draw(l,c.TRIANGLES,o,a,s,tr.disabled,rn(n.tileID,h),null,null,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}(e,r,i,n,c,ir.disabled,u),s.viewport.set([0,0,e.width,e.height]);else if("translucent"===e.renderPass)if(l){const[t,o,s]=e.stencilConfigForOverlapTwoPass(i);Mi(e,r,n,s,t,c,u,!1,a),Mi(e,r,n,s,o,c,u,!0,a)}else{const[t,o]=e.getStencilConfigForOverlapAndUpdateStencilID(i);Mi(e,r,n,o,t,c,u,!1,a)}}(e,r,n,i,o):t.ct(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;if(!n.length)return;const{isRenderingToTexture:o}=i,a=e.style.projection.useSubdivision,s=e.getDepthModeForSublayer(0,rr.ReadOnly),l=e.colorModeForRenderPass();if(a){const[i,a,c]=e.stencilConfigForOverlapTwoPass(n);Ri(e,t,r,c,i,s,l,!1,o),Ri(e,t,r,c,a,s,l,!0,o)}else{const[i,a]=e.getStencilConfigForOverlapAndUpdateStencilID(n);Ri(e,t,r,a,i,s,l,!1,o)}}(e,r,n,i,o):t.bU(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!n.length)return;const{isRenderingToTexture:o}=i,a=t.getSource(),s=e.style.projection.useSubdivision;if(a instanceof te)Oi(e,t,r,n,null,!1,!1,a.tileCoords,a.flippedWindingOrder,o);else if(s){const[i,a,s]=e.stencilConfigForOverlapTwoPass(n);Oi(e,t,r,s,i,!1,!0,Di,!1,o),Oi(e,t,r,s,a,!0,!0,Di,!1,o)}else{const[i,a]=e.getStencilConfigForOverlapAndUpdateStencilID(n);Oi(e,t,r,a,i,!1,!0,Di,!1,o)}}(e,r,n,i,o):t.cu(n)?function(e,t,r,n,i){const o=r.paint.get("background-color"),a=r.paint.get("background-opacity");if(0===a)return;const{isRenderingToTexture:s}=i,l=e.context,c=l.gl,u=e.style.projection,h=e.transform,d=h.tileSize,p=r.paint.get("background-pattern");if(e.isPatternMissing(p))return;const f=!p&&1===o.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==f)return;const m=ir.disabled,g=e.getDepthModeForSublayer(0,"opaque"===f?rr.ReadWrite:rr.ReadOnly),y=e.colorModeForRenderPass(),_=e.useProgram(p?"backgroundPattern":"background"),v=n||Ce(h,{tileSize:d,terrain:e.style.map.terrain});p&&(l.activeTexture.set(c.TEXTURE0),e.imageManager.bind(e.context));const b=r.getCrossfadeParameters();for(const w of v){const t=h.getProjectionData({overscaledTileID:w,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),n=p?vn(a,e,p,{tileID:w,tileSize:d},b):_n(a,o),i=e.style.map.terrain&&e.style.map.terrain.getTerrainData(w),f=u.getMeshFromTileID(l,w.canonical,!1,!0,"raster");_.draw(l,c.TRIANGLES,g,m,y,tr.backCCW,n,i,t,r.id,f.vertexBuffer,f.indexBuffer,f.segments)}}(e,0,n,i,o):t.cv(n)&&function(e,t,r,n){const{isRenderingGlobe:i}=n,o=e.context,a=r.implementation,s=e.style.projection,l=e.transform,c=l.getProjectionDataForCustomLayer(i),u={farZ:l.farZ,nearZ:l.nearZ,fov:l.fov*Math.PI/180,modelViewProjectionMatrix:l.modelViewProjectionMatrix,projectionMatrix:l.projectionMatrix,shaderData:{variantName:s.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${s.shaderPreludeCode.vertexSource}`,define:s.shaderDefine},defaultProjectionData:c},h=a.renderingMode?a.renderingMode:"2d";if("offscreen"===e.renderPass){const t=a.prerender;t&&(e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),t.call(a,o.gl,u),o.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),o.setColorMode(e.colorModeForRenderPass()),o.setStencilMode(ir.disabled);const t="3d"===h?e.getDepthModeFor3D():e.getDepthModeForSublayer(0,rr.ReadOnly);o.setDepthMode(t),a.render(o.gl,u),o.setDirty(),e.setBaseState(),o.bindFramebuffer.set(null)}}(e,0,n,o))}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t,r=!1,n=[]){this.cache=this.cache||{};const i=!!this.style.map.terrain,o=this.style.projection,a=r?Ot.projectionMercator:o.shaderPreludeCode,s=r?zt:o.shaderDefine,l=e+(t?t.cacheKey:"")+`/${r?Ft:o.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(i?"/terrain":"")+(n?`/${n.join("/")}`:"");return this.cache[l]||(this.cache[l]=new jr(this.context,Ot[e],t,wn[e],this._showOverdrawInspector,i,a,s,n)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var e,t;if(this._tileTextures){for(const e in this._tileTextures){const t=this._tileTextures[e];if(t)for(const e of t)e.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&(null===(e=this.tileExtentMesh.vertexBuffer)||void 0===e||e.destroy()),this.tileExtentMesh&&(null===(t=this.tileExtentMesh.indexBuffer)||void 0===t||t.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const e in this.cache){const t=this.cache[e];t&&t.program&&this.context.gl.deleteProgram(t.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}function Zi(e,t){let r,n=!1,i=null,o=null;const a=()=>{i=null,n&&(e.apply(o,r),i=setTimeout(a,t),n=!1)};return(...e)=>(n=!0,o=this,r=e,i||a(),i)}class Yi{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(!this._isValidHash(e))return!1;const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,e)},this._removeHash=()=>{const e=this._getCurrentHash();if(0===e.length)return;const t=e.join("/");let r=t;r.split("&").length>0&&(r=r.split("&")[0]),this._hashName&&(r=`${this._hashName}=${t}`);let n=window.location.hash.replace(r,"");n.startsWith("#&")?n=n.slice(0,1)+n.slice(2):"#"===n&&(n="");let i=window.location.href.replace(/(#.+)?$/,n);i=i.replace("&&","&"),window.history.replaceState(window.history.state,null,i)},this._updateHash=Zi(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),o=Math.round(t.lng*i)/i,a=Math.round(t.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=e?`/${o}/${a}/${r}`:`${r}/${a}/${o}`,(s||l)&&(c+="/"+Math.round(10*s)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const e=this._hashName;let t=!1;const r=window.location.hash.slice(1).split("&").map((r=>{const n=r.split("=")[0];return n===e?(t=!0,`${n}=${c}`):r})).filter((e=>e));return t||r.push(`${e}=${c}`),`#${r.join("&")}`}return`#${c}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new t.V(+e[2],+e[1])}catch(o){return!1}const r=+e[0],n=+(e[3]||0),i=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&n>=-180&&n<=180&&i>=this._map.getMinPitch()&&i<=this._map.getMaxPitch()}}const Xi={linearity:.3,easing:t.cw(0,0,.3,1)},Ki=t.e({deceleration:2500,maxSpeed:1400},Xi),Qi=t.e({deceleration:20,maxSpeed:1400},Xi),Ji=t.e({deceleration:1e3,maxSpeed:360},Xi),eo=t.e({deceleration:1e3,maxSpeed:90},Xi),to=t.e({deceleration:1e3,maxSpeed:360},Xi);class ro{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,t=c();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)r.zoom+=t.zoomDelta||0,r.bearing+=t.bearingDelta||0,r.pitch+=t.pitchDelta||0,r.roll+=t.rollDelta||0,t.panDelta&&r.pan._add(t.panDelta),t.around&&(r.around=t.around),t.pinchAround&&(r.pinchAround=t.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){const o=io(r.pan.mag(),n,t.e({},Ki,e||{})),a=r.pan.mult(o.amount/r.pan.mag()),s=this._map.cameraHelper.handlePanInertia(a,this._map.transform);i.center=s.easingCenter,i.offset=s.easingOffset,no(i,o)}if(r.zoom){const e=io(r.zoom,n,Qi),o=t.cx(this._map.transform.zoom+e.amount,this._map.getZoomSnap(),e.amount);i.zoom=o,no(i,e)}if(r.bearing){const e=io(r.bearing,n,Ji);i.bearing=this._map.transform.bearing+t.an(e.amount,-179,179),no(i,e)}if(r.pitch){const e=io(r.pitch,n,eo);i.pitch=this._map.transform.pitch+e.amount,no(i,e)}if(r.roll){const e=io(r.roll,n,to);i.roll=this._map.transform.roll+t.an(e.amount,-179,179),no(i,e)}if(i.zoom||i.bearing){const e=void 0===r.pinchAround?r.around:r.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(i,{noMoveStart:!0})}}function no(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function io(e,r,n){const{maxSpeed:i,linearity:o,deceleration:a}=n,s=t.an(e*o/(r/1e3),-i,i),l=Math.abs(s)/(a*o);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}class oo extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n,i={}){n=n instanceof MouseEvent?n:new MouseEvent(e,n);const o=u.mousePos(r.getCanvas(),n),a=r.unproject(o);super(e,t.e({point:o,lngLat:a,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}}class ao extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){const i="touchend"===e?n.changedTouches:n.touches,o=u.touchPos(r.getCanvasContainer(),i),a=o.map((e=>r.unproject(e))),s=o.reduce(((e,t,r,n)=>e.add(t.div(n.length))),new t.P(0,0));super(e,{points:o,point:s,lngLats:a,lngLat:r.unproject(s),originalEvent:n}),this._defaultPrevented=!1}}class so extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class lo{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new so(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new oo(e.type,this._map,e))}mouseup(e){this._map.fire(new oo(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new oo(e.type,this._map,e))}dblclick(e){return this._firePreventable(new oo(e.type,this._map,e))}mouseover(e){this._map.fire(new oo(e.type,this._map,e))}mouseout(e){this._map.fire(new oo(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ao(e.type,this._map,e))}touchmove(e){this._map.fire(new ao(e.type,this._map,e))}touchend(e){this._map.fire(new ao(e.type,this._map,e))}touchcancel(e){this._map.fire(new ao(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class co{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new oo(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new oo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new oo(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class uo{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this._map.terrain)}}class ho{constructor(e,t){this._map=e,this._tr=new uo(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(u.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=r,this._box||(this._box=u.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const i=Math.min(n.x,r.x),o=Math.max(n.x,r.x),a=Math.min(n.y,r.y),s=Math.max(n.y,r.y);u.setTransform(this._box,`translate(${i}px,${a}px)`),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}mouseupWindow(e,r){if(!this._active)return;if(0!==e.button)return;const n=this._startPos,i=r;if(this.reset(),u.suppressClick(),n.x!==i.x||n.y!==i.y)return this._map.fire(new t.l("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.l(e,{originalEvent:r}))}}function po(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class fo{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){const r=new t.P(0,0);for(const t of e)r._add(t);return r.div(e.length)}(r),this.touches=po(n,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;const n=po(r,t);for(const i in this.touches){const e=n[i];(!e||e.dist(this.touches[i])>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class mo{constructor(e){this.singleTap=new fo(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){const n=this.singleTap.touchend(e,t,r);if(n){const t=e.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(n)<30;if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class go{constructor(e){this._tr=new uo(e),this._zoomIn=new mo({numTouches:1,numTaps:2}),this._zoomOut=new mo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,r,n){const i=this._zoomIn.touchend(e,r,n),o=this._zoomOut.touchend(e,r,n),a=this._tr;return i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:r=>r.easeTo({duration:300,zoom:t.cx(a.zoom+1,r.getZoomSnap()),around:a.unproject(i)},{originalEvent:e})}):o?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:r=>r.easeTo({duration:300,zoom:t.cx(a.zoom-1,r.getZoomSnap()),around:a.unproject(o)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yo{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.rollDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(t)?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const n=Array.isArray(t)?t[0]:t;return!this._moved&&n.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=n,this._move(r,n))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&u.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const _o=0,vo=2,bo={[_o]:1,[vo]:2};class wo{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=u.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const r=bo[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton)}isValidEndEvent(e){return u.mouseButton(e)===this._eventButton}}class xo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class So{constructor(e=new wo({checkCorrectEvent:()=>!0}),t=new xo){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=t}_executeRelevantHandler(e,t,r){return e instanceof MouseEvent?t(e):"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?r(e):void 0}startMove(e){this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.startMove(e)),(e=>this.oneFingerTouchMoveStateManager.startMove(e)))}endMove(e){this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.endMove(e)),(e=>this.oneFingerTouchMoveStateManager.endMove(e)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidStartEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidStartEvent(e)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidMoveEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(e)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidEndEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidEndEvent(e)))}}const Eo=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}};class To{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._active){if(!this._shouldBePrevented(r.length))return e.preventDefault(),this._calculateTransform(e,t,r);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&this._shouldBePrevented(r.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,n){n.length>0&&(this._active=!0);const i=po(n,r),o=new t.P(0,0),a=new t.P(0,0);let s=0;for(const t in i){const e=i[t],r=this._touches[t];r&&(o._add(e),a._add(e.sub(r)),s++,i[t]=e)}if(this._touches=i,this._shouldBePrevented(s)||!a.mag())return;const l=a.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ao{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();const[n,i]=this._firstTwoTouches,o=Co(r,t,n),a=Co(r,t,i);if(!o||!a)return;const s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;const[n,i]=this._firstTwoTouches,o=Co(r,t,n),a=Co(r,t,i);o&&a||(this._active&&u.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Co(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Io(e,t){return Math.log(e/t)/Math.LN2}class ko extends Ao{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Io(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Io(this._distance,r),pinchAround:t}}}function Po(e,t){return 180*e.angleWith(t)/Math.PI}class Mo extends Ao{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){const n=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Po(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,r=Po(e,this._startVector);return Math.abs(r)<t}}function Ro(e){return Math.abs(e.y)>Math.abs(e.x)}class Do extends Ao{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,Ro(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,i=t.mag()>=2;if(!n&&!i)return;if(!n||!i)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const o=e.y>0==t.y>0;return Ro(e)&&Ro(t)&&o}}const Oo={panStep:100,bearingStep:15,pitchStep:10};class Lo{constructor(e){this._tr=new uo(e);const t=Oo;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,n=0,i=0,o=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),o=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),o=1);break;case 38:e.shiftKey?i=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?i=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:s=>{const l=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:Bo,zoom:r?t.cx(l.zoom+r*(e.shiftKey?2:1),s.getZoomSnap()):l.zoom,bearing:l.bearing+n*this._bearingStep,pitch:l.pitch+i*this._pitchStep,offset:[-o*this._panStep,-a*this._panStep],center:l.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bo(e){return e*(2-e)}const $o=4.000244140625,zo=1/450;class Fo{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new uo(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=zo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=c(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==t&&t%$o==0?this._type="wheel":0!==t&&Math.abs(t)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=u.mousePos(this._map.getCanvas(),e),n=this._tr;this._aroundPoint=this._aroundCenter?n.transform.locationToScreenPoint(t.V.convert(n.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if("number"==typeof this._lastExpectedZoom){const t=e.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=t),"number"==typeof this._targetZoom&&(this._targetZoom+=t)}if(0!==this._delta){const r="wheel"===this._type&&Math.abs(this._delta)>$o?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==n&&(n=1/n);const i="number"!=typeof this._targetZoom?e.scale:t.aq(this._targetZoom),o=e.applyConstrain(e.getCameraLngLat(),t.at(i*n)).zoom,a=this._map.getZoomSnap();if("wheel"===this._type&&a>0){const r=t.cx(e.zoom,a);this._targetZoom=t.cx(o,a,o-r)}else this._targetZoom=o;"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"!=typeof this._targetZoom?e.zoom:this._targetZoom,n=this._startZoom,i=this._easing;let o,a=!1;if("wheel"===this._type&&n&&i){const e=c()-this._lastWheelEventTime,s=Math.min((e+5)/200,1),l=i(s);o=t.G.number(n,r,l),s<1?this._frameId||(this._frameId=!0):a=!0}else o=r,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=o,{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=t.cz;if(this._prevEase){const e=this._prevEase,n=(c()-e.start)/e.duration,i=e.easing(n+.01)-e.easing(n),o=.27/Math.sqrt(i*i+1e-4)*.01,a=Math.sqrt(.0729-o*o);r=t.cw(o,a,.25,1)}return this._prevEase={start:c(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class qo{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class No{constructor(e){this._tr=new uo(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:t.cx(this._tr.zoom+(e.shiftKey?-1:1),n.getZoomSnap()),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jo{constructor(){this._tap=new mo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint)if(this._tapTime){const n=t[0],i=e.timeStamp-this._tapTime<500,o=this._tapPoint.dist(n)<30;i&&o?r.length>0&&(this._swipePoint=n,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(e,t,r)}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){if(this._tapTime)this._swipePoint&&0===r.length&&this.reset();else{const n=this._tap.touchend(e,t,r);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uo{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vo{constructor(e,t,r,n){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=t,this._mousePitch=r,this._mouseRoll=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Go{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Wo{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=u.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=t,this._container.appendChild(n);const i=document.createElement("div");i.className="maplibregl-mobile-message",i.textContent=r,this._container.appendChild(i),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(u.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new t.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Ho=e=>e.zoom||e.drag||e.roll||e.pitch||e.rotate;class Zo extends t.l{}function Yo(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta||e.rollDelta}class Xo{get _ownerDocument(){var e;return(null===(e=this._el)||void 0===e?void 0:e.ownerDocument)||document}get _ownerWindow(){var e,t;return(null===(t=null===(e=this._el)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||window}constructor(e,r){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,r)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,i={needsRenderFrame:!1},o={},a={};for(const{handlerName:c,handler:h,allowed:d}of this._handlers){if(!h.isEnabled())continue;let s;if(this._blockedByActive(a,d,c))h.reset();else if(h[r||e.type]){if(t.cA(e,r||e.type)){const t=u.mousePos(this._map.getCanvas(),e);s=h[r||e.type](e,t)}else if(t.cB(e,r||e.type)){const t=this._getMapTouches(e.touches),n=u.touchPos(this._map.getCanvas(),t);s=h[r||e.type](e,n,t)}else t.cC(r||e.type)||(s=h[r||e.type](e));this.mergeHandlerResult(i,o,s,c,n),s&&s.needsRenderFrame&&this._triggerRenderFrame()}(s||h.isActive())&&(a[c]=h)}const s={};for(const t in this._previousActiveHandlers)a[t]||(s[t]=n);this._previousActiveHandlers=a,(Object.keys(s).length||Yo(i))&&(this._changes.push([i,o,s]),this._triggerRenderFrame()),(Object.keys(a).length||Yo(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:l}=i;l&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],l(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ro(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[this._ownerDocument,"mousemove",{capture:!0}],[this._ownerDocument,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[this._ownerWindow,"blur",void 0]];for(const[t,i,o]of this._listeners)u.addEventListener(t,i,t===this._ownerDocument?this.handleWindowEvent:this.handleEvent,o)}destroy(){for(const[e,t,r]of this._listeners)u.removeEventListener(e,t,e===this._ownerDocument?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){const r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new lo(r,e));const i=r.boxZoom=new ho(r,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();const o=r.cooperativeGestures=new Wo(r,e.cooperativeGestures);this._add("cooperativeGestures",o),e.cooperativeGestures&&o.enable();const a=new go(r),s=new No(r);r.doubleClickZoom=new qo(s,a),this._add("tapZoom",a),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const l=new jo;this._add("tapDragZoom",l);const c=r.touchPitch=new Do(r);this._add("touchPitch",c),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const h=()=>r.project(r.getCenter()),d=function({enable:e,clickTolerance:r,aroundCenter:n=!0,minPixelCenterThreshold:i=100,rotateDegreesPerPixelMoved:o=.8},a){const s=new wo({checkCorrectEvent:e=>0===u.mouseButton(e)&&e.ctrlKey||2===u.mouseButton(e)&&!e.ctrlKey});return new yo({clickTolerance:r,move:(e,r)=>{const s=a();if(n&&Math.abs(s.y-e.y)>i)return{bearingDelta:t.cy(new t.P(e.x,r.y),r,s)};let l=(r.x-e.x)*o;return n&&r.y<s.y&&(l=-l),{bearingDelta:l}},moveStateManager:s,enable:e,assignEvents:Eo})}(e,h),p=function({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5}){const n=new wo({checkCorrectEvent:e=>0===u.mouseButton(e)&&e.ctrlKey||2===u.mouseButton(e)});return new yo({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:n,enable:e,assignEvents:Eo})}(e),f=function({enable:e,clickTolerance:t,rollDegreesPerPixelMoved:r=.3},n){const i=new wo({checkCorrectEvent:e=>2===u.mouseButton(e)&&e.ctrlKey});return new yo({clickTolerance:t,move:(e,t)=>{const i=n();let o=(t.x-e.x)*r;return t.y<i.y&&(o=-o),{rollDelta:o}},moveStateManager:i,enable:e,assignEvents:Eo})}(e,h);r.dragRotate=new Vo(e,d,p,f),this._add("mouseRotate",d,["mousePitch"]),this._add("mousePitch",p,["mouseRotate","mouseRoll"]),this._add("mouseRoll",f,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const m=function({enable:e,clickTolerance:t}){const r=new wo({checkCorrectEvent:e=>0===u.mouseButton(e)&&!e.ctrlKey});return new yo({clickTolerance:t,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:r,enable:e,assignEvents:Eo})}(e),g=new To(e,r);r.dragPan=new Uo(n,m,g),this._add("mousePan",m),this._add("touchPan",g,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const y=new Mo,_=new ko;r.touchZoomRotate=new Go(n,_,y,l),this._add("touchRotate",y,["touchPan","touchZoom"]),this._add("touchZoom",_,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate),this._add("blockableMapEvent",new co(r));const v=r.scrollZoom=new Fo(r,(()=>this._triggerRenderFrame()));this._add("scrollZoom",v,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const b=r.keyboard=new Lo(r);this._add("keyboard",b),e.interactive&&e.keyboard&&r.keyboard.enable()}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Ho(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const r of e)this._el.contains(r.target)&&t.push(r);return t}mergeHandlerResult(e,r,n,i,o){if(!n)return;t.e(e,n);const a={handlerName:i,originalEvent:n.originalEvent||o};void 0!==n.zoomDelta&&(r.zoom=a),void 0!==n.panDelta&&(r.drag=a),void 0!==n.rollDelta&&(r.roll=a),void 0!==n.pitchDelta&&(r.pitch=a),void 0!==n.bearingDelta&&(r.rotate=a)}_applyChanges(){const e={},r={},n={};for(const[i,o,a]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),i.rollDelta&&(e.rollDelta=(e.rollDelta||0)+i.rollDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.e(r,o),t.e(n,a);this._updateMapTransform(e,r,n),this._changes=[]}_updateMapTransform(e,t,r){const n=this._map,i=n._getTransformForUpdate(),o=n.terrain;if(!(Yo(e)||o&&this._terrainMovement))return this._fireEvents(t,r,!0);n._stop(!0);let{panDelta:a,zoomDelta:s,bearingDelta:l,pitchDelta:c,rollDelta:u,around:h,pinchAround:d}=e;void 0!==d&&(h=d),h=h||n.transform.centerPoint,o&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const p={panDelta:a,zoomDelta:s,rollDelta:u,pitchDelta:c,bearingDelta:l,around:h};this._map.cameraHelper.useGlobeControls&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const f=h.distSqr(i.centerPoint)<.01?i.center:i.screenPointToLocation(a?h.sub(a):h);this._handleMapControls({terrain:o,tr:i,deltasForHelper:p,preZoomAroundLoc:f,combinedEventsInProgress:t,panDelta:a}),n._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_handleMapControls({terrain:e,tr:t,deltasForHelper:r,preZoomAroundLoc:n,combinedEventsInProgress:i,panDelta:o}){const a=this._map.cameraHelper;if(a.handleMapControlsRollPitchBearingZoom(r,t),e)return a.useGlobeControls?(this._terrainMovement||!i.drag&&!i.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void a.handleMapControlsPan(r,t,n)):this._terrainMovement||!i.drag&&!i.zoom?void(i.drag&&this._terrainMovement&&o?t.setCenter(t.screenPointToLocation(t.centerPoint.sub(o))):a.handleMapControlsPan(r,t,n)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void a.handleMapControlsPan(r,t,n));a.handleMapControlsPan(r,t,n)}_fireEvents(e,r,n){const i=Ho(this._eventsInProgress),o=Ho(e),a={};for(const t in e){const{originalEvent:r}=e[t];this._eventsInProgress[t]||(a[`${t}start`]=r),this._eventsInProgress[t]=e[t]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in a)this._fireEvent(t,a[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:r}=e[t];this._fireEvent(t,r)}const l={};let c;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:n}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],c=r[e]||n,l[`${t}end`]=c)}for(const t in l)this._fireEvent(t,l[t]);const u=Ho(this._eventsInProgress),h=(i||o)&&!u;if(h&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const e=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&e.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(e)}if(n&&h){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!e||!e.essential&&s.prefersReducedMotion?(this._map.fire(new t.l("moveend",{originalEvent:c})),r(this._map.getBearing())&&this._map.resetNorth()):(r(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new t.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Zo("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Ko extends t.E{constructor(e,t,r){super(),this._renderFrameCallback=()=>{const e=Math.min((c()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this._zoomSnap=r.zoomSnap,this.cameraHelper=t,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,t){e.apply(this.transform,!0),this.transform=e,this.cameraHelper=t}getCenter(){return new t.V(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,t){return this.jumpTo({elevation:e},t),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,n){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},r),n)}panTo(e,r,n){return this.easeTo(t.e({center:e},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,r,n){return this.easeTo(t.e({zoom:e},r),n)}zoomIn(e,r){return this.zoomTo(t.cx(this.getZoom()+1,this._zoomSnap),e,r),this}zoomOut(e,r){return this.zoomTo(t.cx(this.getZoom()-1,this._zoomSnap),e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)).fire(new t.l("moveend",r))),this}getBearing(){return this.transform.bearing}setZoomSnap(e){return this._zoomSnap=e,this}getZoomSnap(){return this._zoomSnap}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,r,n){return this.easeTo(t.e({bearing:e},r),n)}resetNorth(e,r){return this.rotateTo(0,t.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}getRoll(){return this.transform.roll}setRoll(e,t){return this.jumpTo({roll:e},t),this}cameraForBounds(e,t){e=H.convert(e).adjustAntiMeridian();const r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,r,n,i){const o={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.e({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const e=i.padding;i.padding={top:e,bottom:e,right:e,left:e}}const a=t.e(o,i.padding);i.padding=a;const s=this.transform,l=new H(e,r);return this.cameraHelper.cameraForBoxAndBearing(i,a,l,n,s)}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,r,n,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(t.P.convert(e)),this.transform.screenPointToLocation(t.P.convert(r)),n,i),i,o)}_fitInternal(e,r,n){return e?(delete(r=t.e(e,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(e,r){this.stop();const n=this._getTransformForUpdate();let i=!1,o=!1,a=!1;const s=n.zoom;this.cameraHelper.handleJumpToCenterZoom(n,e);const l=n.zoom!==s;return"elevation"in e&&n.elevation!==+e.elevation&&n.setElevation(+e.elevation),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.setBearing(+e.bearing)),"pitch"in e&&n.pitch!==+e.pitch&&(o=!0,n.setPitch(+e.pitch)),"roll"in e&&n.roll!==+e.roll&&(a=!0,n.setRoll(+e.roll)),null==e.padding||n.isPaddingEqual(e.padding)||n.setPadding(e.padding),this._applyUpdatedTransform(n),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)),l&&this.fire(new t.l("zoomstart",r)).fire(new t.l("zoom",r)).fire(new t.l("zoomend",r)),i&&this.fire(new t.l("rotatestart",r)).fire(new t.l("rotate",r)).fire(new t.l("rotateend",r)),o&&this.fire(new t.l("pitchstart",r)).fire(new t.l("pitch",r)).fire(new t.l("pitchend",r)),a&&this.fire(new t.l("rollstart",r)).fire(new t.l("roll",r)).fire(new t.l("rollend",r)),this.fire(new t.l("moveend",r))}calculateCameraOptionsFromTo(e,r,n,i=0){const o=t.a9.fromLngLat(e,r),a=t.a9.fromLngLat(n,i),s=a.x-o.x,l=a.y-o.y,c=a.z-o.z,u=Math.hypot(s,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),d=t.at(this.transform.cameraToCenterDistance/u/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let f=180*Math.acos(h/u)/Math.PI;return f=c<0?90-f:90+f,{center:a.toLngLat(),elevation:i,zoom:d,pitch:f,bearing:p}}calculateCameraOptionsFromCameraLngLatAltRotation(e,t,r,n,i){const o=this.transform.calculateCenterFromCameraLngLatAlt(e,t,r,n);return{center:o.center,elevation:o.elevation,zoom:o.zoom,bearing:r,pitch:n,roll:i}}easeTo(e,r){this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.cz},e)).animate||!e.essential&&s.prefersReducedMotion)&&(e.duration=0);const n=this._getTransformForUpdate(),i=this.getBearing(),o=n.pitch,a=n.roll,l="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:o,u="roll"in e?this._normalizeBearing(e.roll,a):a,h="padding"in e?e.padding:n.padding,d=t.P.convert(e.offset);let p,f;e.around&&(p=t.V.convert(e.around),f=n.locationToScreenPoint(p));const m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},g=this.cameraHelper.handleEaseTo(n,{bearing:l,pitch:c,roll:u,padding:h,around:p,aroundPoint:f,offsetAsPoint:d,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||i!==l,this._pitching=this._pitching||c!==o,this._rolling=this._rolling||u!==a,this._padding=!n.isPaddingEqual(h),this._zooming=this._zooming||g.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,m),this.terrain&&this._prepareElevation(g.elevationCenter),this._ease((t=>{g.easeFunc(t),this.terrain&&!e.freezeElevation&&this._updateElevation(t),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,t)}),e),this}_prepareEase(e,r,n={}){this._moving=!0,r||n.moving||this.fire(new t.l("movestart",e)),this._zooming&&!n.zooming&&this.fire(new t.l("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new t.l("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new t.l("pitchstart",e)),this._rolling&&!n.rolling&&this.fire(new t.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){void 0!==this._elevationStart&&void 0!==this._elevationCenter||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(r-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(t.G.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const t=e.getCameraLngLat(),r=e.getCameraAltitude(),n=this.terrain?this.terrain.getElevationForLngLatZoom(t,e.zoom):0;if(r<n){const r=this.calculateCameraOptionsFromTo(t,n,e.center,e.elevation);return{pitch:r.pitch,zoom:r.zoom}}return{}}_applyUpdatedTransform(e){const t=[];if(t.push((e=>this._elevateCameraIfInsideTerrain(e))),this.transformCameraUpdate&&t.push((e=>this.transformCameraUpdate(e))),!t.length)return;const r=e.clone();for(const n of t){const e=r.clone(),{center:t,zoom:i,roll:o,pitch:a,bearing:s,elevation:l}=n(e);t&&e.setCenter(t),void 0!==l&&e.setElevation(l),void 0!==i&&e.setZoom(i),void 0!==o&&e.setRoll(o),void 0!==a&&e.setPitch(a),void 0!==s&&e.setBearing(s),r.apply(e,!1)}this.transform.apply(r,!1)}_fireMoveEvents(e){this.fire(new t.l("move",e)),this._zooming&&this.fire(new t.l("zoom",e)),this._rotating&&this.fire(new t.l("rotate",e)),this._pitching&&this.fire(new t.l("pitch",e)),this._rolling&&this.fire(new t.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const n=this._zooming,i=this._rotating,o=this._pitching,a=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,n&&this.fire(new t.l("zoomend",e)),i&&this.fire(new t.l("rotateend",e)),o&&this.fire(new t.l("pitchend",e)),a&&this.fire(new t.l("rollend",e)),this.fire(new t.l("moveend",e))}flyTo(e,r){if(!e.essential&&s.prefersReducedMotion){const n=t.U(e,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(n,r)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.cz},e);const n=this._getTransformForUpdate(),i=n.bearing,o=n.pitch,a=n.roll,l=n.padding,c="bearing"in e?this._normalizeBearing(e.bearing,i):i,u="pitch"in e?+e.pitch:o,h="roll"in e?this._normalizeBearing(e.roll,a):a,d="padding"in e?e.padding:n.padding,p=t.P.convert(e.offset);let f=n.centerPoint.add(p);const m=n.screenPointToLocation(f),g=this.cameraHelper.handleFlyTo(n,{bearing:c,pitch:u,roll:h,padding:d,locationAtOffset:m,offsetAsPoint:p,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let y=e.curve;const _=Math.max(n.width,n.height),v=_/g.scaleOfZoom,b=g.pixelPathLength;"number"==typeof g.scaleOfMinZoom&&(y=Math.sqrt(_/g.scaleOfMinZoom/b*2));const w=y*y;function x(e){const t=(v*v-_*_+(e?-1:1)*w*w*b*b)/(2*(e?v:_)*w*b);return Math.log(Math.sqrt(t*t+1)-t)}function S(e){return(Math.exp(e)-Math.exp(-e))/2}function E(e){return(Math.exp(e)+Math.exp(-e))/2}const T=x(!1);let A=function(e){return E(T)/E(T+y*e)},C=function(e){return _*((E(T)*(S(t=T+y*e)/E(t))-S(T))/w)/b;var t},I=(x(!0)-T)/y;if(Math.abs(b)<2e-6||!isFinite(I)){if(Math.abs(_-v)<1e-6)return this.easeTo(e,r);const t=v<_?-1:1;I=Math.abs(Math.log(v/_))/y,C=()=>0,A=e=>Math.exp(t*y*e)}return e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/y:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=i!==c,this._pitching=u!==o,this._rolling=h!==a,this._padding=!n.isPaddingEqual(d),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(g.targetCenter),this._ease((s=>{const m=s*I,y=1/A(m),_=C(m);this._rotating&&n.setBearing(t.G.number(i,c,s)),this._pitching&&n.setPitch(t.G.number(o,u,s)),this._rolling&&n.setRoll(t.G.number(a,h,s)),this._padding&&(n.interpolatePadding(l,d,s),f=n.centerPoint.add(p)),g.easeFunc(s,y,_,f),this.terrain&&!e.freezeElevation&&this._updateElevation(s),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var r;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(r=this.handlers)||void 0===r||r.stop(!1),this}_ease(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=c(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=t.W(e,-180,180);const n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLat(t.V.convert(e),this.transform):null}}const Qo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Jo{constructor(e=Qo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=u.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=u.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=u.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.tileManagers;for(const n in t){const r=t[n];if(r.used||r.usedForTerrain){const t=r.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter((e=>String(e).trim())),e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,r)=>{for(let n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}));const r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=u.sanitize(r),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ea{constructor(e={}){this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=u.create("div","maplibregl-ctrl");const t=u.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){u.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ta{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(const n of r)if(n.id===e)return void(n.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ra=t.aU([{name:"a_pos3d",type:"Int16",components:3}]);class na extends t.E{constructor(e){super(),this._lastTilesetChange=c(),this.tileManager=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(e,r){this.tileManager.update(e,r),this._renderableTilesKeys=[];const n={};for(const i of Ce(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.tileManager._source.calculateTileZoom}))n[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.terrainRttPosMatrix32f=new Float64Array(16),t.c7(i.terrainRttPosMatrix32f,0,t.a5,t.a5,0,0,1),this._tiles[i.key]=new pe(i,this.tileSize),this._lastTilesetChange=c());for(const t in this._tiles)n[t]||delete this._tiles[t]}freeRtt(e){for(const t in this._tiles){const r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,t){return t?this._getTerrainCoordsForTileRanges(e,t):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const n of this._renderableTilesKeys){const i=this._tiles[n].tileID,o=e.clone(),a=t.bk();if(i.canonical.equals(e.canonical))t.c7(a,0,t.a5,t.a5,0,0,1);else if(i.canonical.isChildOf(e.canonical)){const r=i.canonical.z-e.canonical.z,n=i.canonical.x-(i.canonical.x>>r<<r),o=i.canonical.y-(i.canonical.y>>r<<r),s=t.a5>>r;t.c7(a,0,s,s,0,0,1),t.O(a,a,[-n*s,-o*s,0])}else{if(!e.canonical.isChildOf(i.canonical))continue;{const r=e.canonical.z-i.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r),o=e.canonical.y-(e.canonical.y>>r<<r),s=t.a5>>r;t.c7(a,0,t.a5,t.a5,0,0,1),t.O(a,a,[n*s,o*s,0]),t.Q(a,a,[1/2**r,1/2**r,0])}}o.terrainRttPosMatrix32f=new Float32Array(a),r[n]=o}return r}_getTerrainCoordsForTileRanges(e,r){const n={};for(const i of this._renderableTilesKeys){const o=this._tiles[i].tileID;if(!this._isWithinTileRanges(o,r))continue;const a=e.clone(),s=t.bk();if(o.canonical.z===e.canonical.z){const r=e.canonical.x-o.canonical.x+e.wrap*(1<<e.canonical.z),n=e.canonical.y-o.canonical.y;t.c7(s,0,t.a5,t.a5,0,0,1),t.O(s,s,[r*t.a5,n*t.a5,0])}else if(o.canonical.z>e.canonical.z){const r=o.canonical.z-e.canonical.z,n=o.canonical.x-(o.canonical.x>>r<<r)+e.wrap*(1<<o.canonical.z),i=o.canonical.y-(o.canonical.y>>r<<r),a=e.canonical.x-(o.canonical.x>>r),l=e.canonical.y-(o.canonical.y>>r),c=t.a5>>r;t.c7(s,0,c,c,0,0,1),t.O(s,s,[-n*c+a*t.a5,-i*c+l*t.a5,0])}else{const r=e.canonical.z-o.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r)+e.wrap*(1<<e.canonical.z),i=e.canonical.y-(e.canonical.y>>r<<r),a=(e.canonical.x>>r)-o.canonical.x,l=(e.canonical.y>>r)-o.canonical.y,c=t.a5<<r;t.c7(s,0,c,c,0,0,1),t.O(s,s,[n*t.a5+a*c,i*t.a5+l*c,0])}a.terrainRttPosMatrix32f=new Float32Array(s),n[i]=a}return n}getSourceTile(e,t){const r=this.tileManager._source;let n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let i=this.findTileInCaches(this._sourceTileCache[e.key]);if(!(null==i?void 0:i.dem)&&t)for(;n>=r.minzoom&&!(null==i?void 0:i.dem);)i=this.findTileInCaches(e.scaledTo(n--).key);return i}findTileInCaches(e){let t=this.tileManager.getTileByID(e);return t||(t=this.tileManager._outOfViewCache.getByKey(e),t)}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,t){const r=t[e.canonical.z];return!!r&&(e.wrap>r.minWrap||e.wrap<r.maxWrap||e.canonical.x>=r.minTileXWrapped&&e.canonical.x<=r.maxTileXWrapped&&e.canonical.y>=r.minTileY&&e.canonical.y<=r.maxTileY)}}class ia{constructor(e,t,r){this._meshCache={},this.painter=e,this.tileManager=new na(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,n,i=t.a5){var o;if(!(r>=0&&r<i&&n>=0&&n<i))return 0;const a=this.getTerrainData(e),s=null===(o=a.tile)||void 0===o?void 0:o.dem;if(!s)return 0;const l=t.cD([],[r/i*t.a5,n/i*t.a5],a.u_terrain_matrix),c=[l[0]*s.dim,l[1]*s.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,p=c[1]-h;return s.get(u,h)*(1-d)*(1-p)+s.get(u+1,h)*d*(1-p)+s.get(u,h+1)*(1-d)*p+s.get(u+1,h+1)*d*p}getElevationForLngLatZoom(e,r){if(!t.cE(r,e.wrap()))return 0;const{tileID:n,mercatorX:i,mercatorY:o}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(n,i%t.a5,o%t.a5,t.a5)}getElevationForLngLat(e,t){const r=Ce(t,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let n=0;for(const i of r)i.canonical.z>n&&(n=Math.min(i.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(e,n)}getElevation(e,r,n,i=t.a5){return this.getDEMElevation(e,r,n,i)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,r=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new t.T(e,r,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new t.T(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.ar([])}const r=this.tileManager.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const e=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new t.T(e,r.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),r.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const n=r&&r.toString()+r.tileID.key+e.key;if(n&&!this._demMatrixCache[n]){const n=this.tileManager.getSource().maxzoom;let i=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?i=e.canonical.z-n:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const o=e.canonical.x-(e.canonical.x>>i<<i),a=e.canonical.y-(e.canonical.y>>i<<i),s=t.cF(new Float64Array(16),[1/(t.a5<<i),1/(t.a5<<i),0]);t.O(s,s,[o*t.a5,a*t.a5,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,n=r.width/devicePixelRatio,i=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===i||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new t.T(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new t.T(r.context,{width:n,height:i,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(n,i,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,n,i))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,o=0;t<this._coordsTextureSize;t++)for(let e=0;e<this._coordsTextureSize;e++,o+=4)r[o+0]=255&e,r[o+1]=255&t,r[o+2]=e>>8<<4|t>>8,r[o+3]=0;const n=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),i=new t.T(e,n,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),n=this.painter.context,i=n.gl,o=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),a=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(o,s-a-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null);const l=r[0]+(r[2]>>4<<8),c=r[1]+((15&r[2])<<8),u=this.coordsIndex[255-r[3]],h=u&&this.tileManager.getTileByID(u);if(!h)return null;const d=this._coordsTextureSize,p=(1<<h.tileID.canonical.z)*d;return new t.a9((h.tileID.canonical.x*d+l)/p+h.tileID.wrap,(h.tileID.canonical.y*d+c)/p,this.getElevation(h.tileID,l,c,d))}depthAtPoint(e){const t=new Uint8Array(4),r=this.painter.context,n=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(e){var r;const n=(null===(r=this.painter.style.projection)||void 0===r?void 0:r.transitionState)>0,i=n&&0===e.canonical.y,o=n&&e.canonical.y===(1<<e.canonical.z)-1,a=`m_${i?"n":""}_${o?"s":""}`;if(this._meshCache[a])return this._meshCache[a];const s=this.painter.context,l=new t.cG,c=new t.aY,u=this.meshSize,h=t.a5/u,d=u*u;for(let t=0;t<=u;t++)for(let e=0;e<=u;e++)l.emplaceBack(e*h,t*h,0);for(let t=0;t<d;t+=u+1)for(let e=0;e<u;e++)c.emplaceBack(e+t,u+e+t+1,u+e+t+2),c.emplaceBack(e+t,u+e+t+2,e+t+1);const p=l.length,f=p+(u+1),m=(u+1)*u,g=i?t.br:0,y=i?0:1,_=o?t.bs:t.a5,v=o?0:1;for(let t=0;t<=u;t++)l.emplaceBack(t*h,g,y);for(let t=0;t<=u;t++)l.emplaceBack(t*h,_,v);for(let t=0;t<u;t++)c.emplaceBack(m+t,f+t,f+t+1),c.emplaceBack(m+t,f+t+1,m+t+1),c.emplaceBack(0+t,p+t+1,p+t),c.emplaceBack(0+t,0+t+1,p+t+1);const b=l.length,w=b+2*(u+1);for(const S of[0,1])for(let e=0;e<=u;e++)for(const r of[0,1])l.emplaceBack(S*t.a5,e*h,r);for(let t=0;t<2*u;t+=2)c.emplaceBack(b+t,b+t+1,b+t+3),c.emplaceBack(b+t,b+t+3,b+t+2),c.emplaceBack(w+t,w+t+3,w+t+1),c.emplaceBack(w+t,w+t+2,w+t+3);const x=new Bt(s.createVertexBuffer(l,ra.members),s.createIndexBuffer(c),t.aX.simpleSegment(0,0,l.length,c.length));return this._meshCache[a]=x,x}getMeshFrameDelta(e){return 2*Math.PI*t.bE/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var n;if(!t.cE(r,e.wrap()))return 0;const{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(e,r);return null!==(n=this.getMinMaxElevation(i).minElevation)&&void 0!==n?n:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,r){const n=t.a9.fromLngLat(e.wrap()),i=(1<<r)*t.a5,o=n.x*i,a=n.y*i,s=Math.floor(o/t.a5),l=Math.floor(a/t.a5);return{tileID:new t.a2(r,0,r,s,l),mercatorX:o,mercatorY:a}}}class oa{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new t.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(n.texture),{id:e,fbo:r,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((t=>e.id!==t)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((e=>!e.inUse))}}const aa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class sa{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new oa(e.context,30,t.tileManager.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=e._order.filter((r=>!e._layers[r].isHidden(t))),this._coordsAscending={};for(const r in e.tileManagers){this._coordsAscending[r]={};const t=e.tileManagers[r].getVisibleCoordinates(),n=e.tileManagers[r].getSource(),i=n instanceof te?n.terrainTileRanges:null;for(const e of t){const t=this.terrain.tileManager.getTerrainCoords(e,i);for(const e in t)this._coordsAscending[r][e]||(this._coordsAscending[r][e]=[]),this._coordsAscending[r][e].push(t[e])}}this._coordsAscendingStr={};for(const r of e._order){const t=e._layers[r],n=t.source;if(aa[t.type]&&!this._coordsAscendingStr[n]){this._coordsAscendingStr[n]={};for(const e in this._coordsAscending[n])this._coordsAscendingStr[n][e]=this._coordsAscending[n][e].map((e=>e.key)).sort().join()}}for(const r of this._renderableTiles)for(const e in this._coordsAscendingStr){const t=this._coordsAscendingStr[e][r.tileID.key];t&&t!==r.rttCoords[e]&&(r.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const n=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),i=e.type,o=this.painter,a=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(aa[i]&&(this._prevType&&aa[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(e.id),!a))return!0;if(aa[this._prevType]||aa[i]&&a){this._prevType=i;const e=this._stacks.length-1,r=this._stacks[e]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(Gi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[e]){const t=this.pool.getObjectForId(i.rtt[e].id);if(t.stamp===i.rtt[e].stamp){this.pool.useObject(t);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),i.rtt[e]={id:a.id,stamp:a.stamp},o.context.bindFramebuffer.set(a.fbo.framebuffer),o.context.clear({color:t.bp.transparent,stencil:0}),o.currentStencilSource=void 0;for(let e=0;e<r.length;e++){const t=o.style._layers[r[e]],s=t.source?this._coordsAscending[t.source][i.tileID.key]:[i.tileID];o.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),o._renderTileClippingMasks(t,s,!0),o.renderLayer(o,o.style.tileManagers[t.source],t,s,n),t.source&&(i.rttCoords[t.source]=this._coordsAscendingStr[t.source][i.tileID.key])}}return Gi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects(),aa[i]}return!1}}const la={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ca=r,ua={hash:!1,interactive:!0,bearingSnap:7,zoomSnap:0,attributionControl:Qo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},ha={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class da{constructor(e,r,n=!1){this.mousedown=e=>{this.startMove(e,u.mousePos(this.element,e)),u.addEventListener(window,"mousemove",this.mousemove),u.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.move(e,u.mousePos(this.element,e))},this.mouseup=e=>{this._rotatePitchHandler.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,e.targetTouches)[0],this.startMove(e,this._startPos),u.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=u.touchPos(this.element,e.targetTouches)[0],this.move(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const i=new So;this._rotatePitchHandler=new yo({clickTolerance:3,move:(e,i)=>{const o=r.getBoundingClientRect(),a=new t.P((o.bottom-o.top)/2,(o.right-o.left)/2);return{bearingDelta:t.cy(new t.P(e.x,i.y),i,a),pitchDelta:n?-.5*(i.y-e.y):void 0}},moveStateManager:i,enable:!0,assignEvents:()=>{}}),this.map=e,u.addEventListener(r,"mousedown",this.mousedown),u.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(r,"touchcancel",this.reset)}startMove(e,t){this._rotatePitchHandler.dragStart(e,t),u.disableDrag()}move(e,t){const r=this.map,{bearingDelta:n,pitchDelta:i}=this._rotatePitchHandler.dragMove(e,t)||{};n&&r.setBearing(r.getBearing()+n),i&&r.setPitch(r.getPitch()+i)}off(){const e=this.element;u.removeEventListener(e,"mousedown",this.mousedown),u.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend),u.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){u.enableDrag(),u.removeEventListener(window,"mousemove",this.mousemove),u.removeEventListener(window,"mouseup",this.mouseup),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend)}}let pa;function fa(e,r,n,i=!1){if(i||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return null==e?void 0:e.wrap();const o=new t.V(e.lng,e.lat);if(e=new t.V(e.lng,e.lat),r){const i=new t.V(e.lng-360,e.lat),o=new t.V(e.lng+360,e.lat),a=n.locationToScreenPoint(e).distSqr(r);n.locationToScreenPoint(i).distSqr(r)<a?e=i:n.locationToScreenPoint(o).distSqr(r)<a&&(e=o)}for(;Math.abs(e.lng-n.center.lng)>180;){const t=n.locationToScreenPoint(e);if(t.x>=0&&t.y>=0&&t.x<=n.width&&t.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e.lng!==o.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(e))?e:o}const ma={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ga(e,t,r){const n=e.classList;for(const i in ma)n.remove(`maplibregl-${r}-anchor-${i}`);n.add(`maplibregl-${r}-anchor-${t}`)}class ya extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{const t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},this._update=e=>{if(!this._map)return;const t=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!t)&&this._map.once("render",this._update),this._lngLat=fa(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||e&&"moveend"!==e.type||(this._pos=this._pos.round()),u.setTransform(this._element,`${ma[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),s.frameAsync(new AbortController,this._map._ownerWindow).then((()=>{this._updateOpacity(e&&"moveend"===e.type)})).catch((()=>{}))},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.l("dragstart"))),this.fire(new t.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.l("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div");const r=u.createNS("http://www.w3.org/2000/svg","svg"),n=41,i=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${n}px`),r.setAttributeNS(null,"width",`${i}px`),r.setAttributeNS(null,"viewBox",`0 0 ${i} ${n}`);const o=u.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");const a=u.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");const s=u.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");const l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of l){const t=u.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),s.appendChild(t)}const c=u.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=u.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const d=u.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=u.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=u.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=u.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=u.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=u.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),a.appendChild(s),a.appendChild(c),a.appendChild(d),a.appendChild(f),a.appendChild(m),r.appendChild(a),r.setAttributeNS(null,"height",n*this._scale+"px"),r.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(r),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),ga(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.V.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,r=13.5,n=Math.abs(r)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-r,-1*(t-r)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,n;const i=null===(r=this._map)||void 0===r?void 0:r.terrain,o=this._map.transform.isLocationOccluded(this._lngLat);if(!i||o){const e=o?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==e&&(this._element.style.opacity=e))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const a=this._map,s=a.terrain.depthAtPoint(this._pos),l=a.terrain.getElevationForLngLat(this._lngLat,a.transform);if(a.transform.lngLatToCameraDepth(this._lngLat,l)-s<.006)return void(this._element.style.opacity=this._opacity);const c=-this._offset.y/a.transform.pixelsPerMeter,u=Math.sin(a.getPitch()*Math.PI/180)*c,h=a.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),d=a.transform.lngLatToCameraDepth(this._lngLat,l+u)-h>.006;(null===(n=this._popup)||void 0===n?void 0:n.isOpen())&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return(void 0===this._opacity||void 0===e&&void 0===t)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const _a={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let va=0,ba=!1;const wa={maxWidth:100,unit:"metric"};function xa(e,t,r){const n=r&&r.maxWidth||100,i=e._container.clientHeight/2,o=e._container.clientWidth/2,a=e.unproject([o-n/2,i]),s=e.unproject([o+n/2,i]),l=Math.round(e.project(s).x-e.project(a).x),c=Math.min(n,l,e._container.clientWidth),u=a.distanceTo(s);if(r&&"imperial"===r.unit){const r=3.2808*u;r>5280?Sa(t,c,r/5280,e._getUIString("ScaleControl.Miles")):Sa(t,c,r,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Sa(t,c,u/1852,e._getUIString("ScaleControl.NauticalMiles")):u>=1e3?Sa(t,c,u/1e3,e._getUIString("ScaleControl.Kilometers")):Sa(t,c,u,e._getUIString("ScaleControl.Meters"))}function Sa(e,t,r,n){const i=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let r=e/t;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r),t*r}(r);e.style.width=t*(i/r)+"px",e.innerHTML=`${i}&nbsp;${n}`}const Ea={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},Ta=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Aa(e){if(e){if("number"==typeof e){const r=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(r,r),"top-right":new t.P(-r,r),bottom:new t.P(0,-e),"bottom-left":new t.P(r,-r),"bottom-right":new t.P(-r,-r),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const r=t.P.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return Aa(new t.P(0,0))}const Ca=r;e.AJAXError=t.cJ,e.Event=t.l,e.Evented=t.E,e.LngLat=t.V,e.MercatorCoordinate=t.a9,e.Point=t.P,e.addProtocol=t.cK,e.config=t.c,e.removeProtocol=t.cL,e.AttributionControl=Jo,e.BoxZoomHandler=ho,e.CanvasSource=ne,e.CooperativeGesturesHandler=Wo,e.DoubleClickZoomHandler=qo,e.DragPanHandler=Uo,e.DragRotateHandler=Vo,e.EdgeInsets=Nt,e.FullscreenControl=class extends t.E{constructor(e={}){super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){u.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=u.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);u.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=ee,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new t.V(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,i=this._map.getBearing(),o=t.e({bearing:i},this.options.fitBoundsOptions),a=H.fromLngLat(r,n);this._map.fitBounds(a,o,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new t.V(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&ba)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=u.create("button","maplibregl-ctrl-geolocate",this._container),u.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ya({element:this._dotElement}),this._circleElement=u.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ya({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{const r=(null==e?void 0:e[0])instanceof ResizeObserverEntry;e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||r||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.l("trackuserlocationend")),this.fire(new t.l("userlocationlostfocus")))}))}},this.options=t.e({},_a,e)}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return t._(this,arguments,void 0,(function*(e=!1){if(void 0!==pa&&!e)return pa;if(void 0===window.navigator.permissions)return pa=!!window.navigator.geolocation,pa;try{const e=yield window.navigator.permissions.query({name:"geolocation"});pa="denied"!==e.state}catch(t){pa=!!window.navigator.geolocation}return pa}))}().then((e=>this._finishSetupUI(e))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,va=0,ba=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const e=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&e))return;const t=this._map.project(e),r=this._map.unproject([t.x+100,t.y]),n=e.distanceTo(r)/100,i=2*this._accuracy/n;this._circleElement.style.width=`${i.toFixed(2)}px`,this._circleElement.style.height=`${i.toFixed(2)}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":va--,ba=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.l("trackuserlocationstart")),this.fire(new t.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),va++,va>1?(e={maximumAge:6e5,timeout:0},ba=!0):(e=this.options.positionOptions,ba=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.GlobeControl=class{constructor(){this._toggleProjection=()=>{var e;const t=null===(e=this._map.getProjection())||void 0===e?void 0:e.type;this._map.setProjection("mercator"!==t&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var e;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),"globe"===(null===(e=this._map.getProjection())||void 0===e?void 0:e.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=u.create("button","maplibregl-ctrl-globe",this._container),u.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},e.Hash=Yi,e.ImageSource=te,e.KeyboardHandler=Lo,e.LngLatBounds=H,e.LogoControl=ea,e.Map=class extends Ko{get _ownerWindow(){var e,t;return(null===(t=null===(e=this._container)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||window}constructor(e){var r,n;t.cH.mark(t.cI.create);const i=Object.assign(Object.assign(Object.assign({},ua),e),{canvasContextAttributes:Object.assign(Object.assign({},ua.canvasContextAttributes),e.canvasContextAttributes)});if(null!=i.minZoom&&null!=i.maxZoom&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=i.minPitch&&null!=i.maxPitch&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=i.minPitch&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=i.maxPitch&&i.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const o=new Zt,a=new Qt;void 0!==i.minZoom&&o.setMinZoom(i.minZoom),void 0!==i.maxZoom&&o.setMaxZoom(i.maxZoom),void 0!==i.minPitch&&o.setMinPitch(i.minPitch),void 0!==i.maxPitch&&o.setMaxPitch(i.maxPitch),void 0!==i.renderWorldCopies&&o.setRenderWorldCopies(i.renderWorldCopies),null!==i.transformConstrain&&o.setConstrainOverride(i.transformConstrain),super(o,a,{bearingSnap:i.bearingSnap,zoomSnap:i.zoomSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ta,this._controls=[],this._mapId=t.af(),this._lostContextStyle={style:null,images:null},this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const t of Object.values(this.style._layers))if(t.type,t._listeners)for(const[e]of Object.entries(t._listeners));this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new t.l("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new t.l("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},i.canvasContextAttributes),this._trackResize=!0===i.trackResize,this._bearingSnap=i.bearingSnap,this._zoomSnap=i.zoomSnap,this._centerClampedToGround=i.centerClampedToGround,this._refreshExpiredTiles=!0===i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=!0===i.crossSourceCollisions,this._collectResourceTiming=!0===i.collectResourceTiming,this._locale=Object.assign(Object.assign({},la),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this._zoomLevelsToOverscale=i.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=i.transformCameraUpdate,this.transformConstrain=i.transformConstrain,this.cancelPendingTileRequestsWhileZooming=!0===i.cancelPendingTileRequestsWhileZooming,void 0!==i.reduceMotion&&(s.prefersReducedMotion=i.reduceMotion),this._imageQueueHandle=y.addThrottleControl((()=>this.isMoving())),this._requestManager=new _(i.transformRequest),this._container=this._resolveContainer(i.container),i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window&&(this._ownerWindow.addEventListener("online",this._onWindowOnline,!1),this._setupResizeObserver()),this.handlers=new Xo(this,i),this._hash=i.hash&&new Yi("string"==typeof i.hash&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,elevation:i.elevation,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,roll:i.roll}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,t.e({},i.fitBoundsOptions,{duration:0}))));const l="string"==typeof i.style||!("globe"===(null===(n=null===(r=i.style)||void 0===r?void 0:r.projection)||void 0===n?void 0:n.type));this.resize(null,l),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new Jo("boolean"==typeof i.attributionControl?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new ea,i.logoPosition),this.on("style.load",(()=>{if(l||this._resizeTransform(),this.transform.unmodified){const e=t.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(e)}})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.l(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.l(`${e.dataType}dataloading`,e))})),this.on("dataabort",(e=>{this.fire(new t.l("sourcedataabort",e))}))}_getMapId(){return this._mapId}setGlobalStateProperty(e,t){return this.style.setGlobalStateProperty(e,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(e,r){if(void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}coveringTiles(e){return Ce(this.transform,e)}calculateCameraOptionsFromTo(e,t,r,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLat(r,this.transform)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e,r=!0){if(null!==this._lostContextStyle.style)return this;this._resizeInternal(r);const n=!this._moving;return n&&(this.stop(),this.fire(new t.l("movestart",e)).fire(new t.l("move",e))),this.fire(new t.l("resize",e)),n&&this.fire(new t.l("moveend",e)),this}_resizeInternal(e=!0){const[t,r]=this._containerDimensions(),n=this._getClampedPixelRatio(t,r);if(this._resizeCanvas(t,r,n),this.painter.resize(t,r,n),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const n=this._getClampedPixelRatio(t,r);this._resizeCanvas(t,r,n),this.painter.resize(t,r,n)}this._resizeTransform(e)}_resizeTransform(e=!0){var t;const[r,n]=this._containerDimensions();this.transform.resize(r,n,e),null===(t=this._requestedCameraState)||void 0===t||t.resize(r,n,e)}_getClampedPixelRatio(e,t){const{0:r,1:n}=this._maxCanvasSize,i=this.getPixelRatio(),o=e*i,a=t*i;return Math.min(o>r?r/o:1,a>n?n/a:1)*i}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(H.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom){const r=this.transform.zoom,n=this._getTransformForUpdate();return n.setMinZoom(e),this._applyUpdatedTransform(n),this._update(),r!==this.transform.zoom&&this.fire(new t.l("zoomstart")).fire(new t.l("zoom")).fire(new t.l("zoomend")).fire(new t.l("movestart")).fire(new t.l("move")).fire(new t.l("moveend")),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom){const r=this.transform.zoom,n=this._getTransformForUpdate();return n.setMaxZoom(e),this._applyUpdatedTransform(n),this._update(),r!==this.transform.zoom&&this.fire(new t.l("zoomstart")).fire(new t.l("zoom")).fire(new t.l("zoomend")).fire(new t.l("movestart")).fire(new t.l("move")).fire(new t.l("moveend")),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch){const r=this.transform.pitch,n=this._getTransformForUpdate();return n.setMinPitch(e),this._applyUpdatedTransform(n),this._update(),r!==this.transform.pitch&&this.fire(new t.l("pitchstart")).fire(new t.l("pitch")).fire(new t.l("pitchend")).fire(new t.l("movestart")).fire(new t.l("move")).fire(new t.l("moveend")),this}throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>180)throw new Error("maxPitch must be less than or equal to 180");if(e>=this.transform.minPitch){const r=this.transform.pitch,n=this._getTransformForUpdate();return n.setMaxPitch(e),this._applyUpdatedTransform(n),this._update(),r!==this.transform.pitch&&this.fire(new t.l("pitchstart")).fire(new t.l("pitch")).fire(new t.l("pitchend")).fire(new t.l("movestart")).fire(new t.l("move")).fire(new t.l("moveend")),this}throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.setRenderWorldCopies(e),this._update()}setTransformConstrain(e){return this.transform.setConstrainOverride(e),this._update()}project(e){return this.transform.locationToScreenPoint(t.V.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;const i=i=>{const o=t.filter((e=>this.getLayer(e))),a=0!==o.length?this.queryRenderedFeatures(i.point,{layers:o}):[];a.length?n||(n=!0,r.call(this,new oo(e,this,i.originalEvent,{features:a}))):n=!1};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const i=i=>{const o=t.filter((e=>this.getLayer(e)));(0!==o.length?this.queryRenderedFeatures(i.point,{layers:o}):[]).length?n=!0:n&&(n=!1,r.call(this,new oo(e,this,i.originalEvent)))},o=t=>{n&&(n=!1,r.call(this,new oo(e,this,t.originalEvent)))};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:o}}}{const n=e=>{const n=t.filter((e=>this.getLayer(e))),i=0!==n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];i.length&&(e.features=i,r.call(this,e),delete e.features)};return{layers:t,listener:r,delegates:{[e]:n}}}}_saveDelegatedListener(e,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(t)}_removeDelegatedListener(e,t,r){if(!this._delegatedListeners||!this._delegatedListeners[e])return;const n=this._delegatedListeners[e];for(let i=0;i<n.length;i++){const e=n[i];if(e.listener===r&&e.layers.length===t.length&&e.layers.every((e=>t.includes(e)))){for(const t in e.delegates)this.off(t,e.delegates[t]);return void n.splice(i,1)}}}on(e,t,r){if(void 0===r)return super.on(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);this._saveDelegatedListener(e,i);for(const o in i.delegates)this.on(o,i.delegates[o]);return{unsubscribe:()=>{this._removeDelegatedListener(e,n,r)}}}once(e,t,r){if(void 0===r)return super.once(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);for(const o in i.delegates){const t=i.delegates[o];i.delegates[o]=(...i)=>{this._removeDelegatedListener(e,n,r),t(...i)}}this._saveDelegatedListener(e,i);for(const o in i.delegates)this.once(o,i.delegates[o]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._removeDelegatedListener(e,"string"==typeof t?[t]:t,r),this)}queryRenderedFeatures(e,r){if(!this.style)return[];let n;const i=e instanceof t.P||Array.isArray(e),o=i?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(i?{}:e)||{},o instanceof t.P||"number"==typeof o[0])n=[t.P.convert(o)];else{const e=t.P.convert(o[0]),r=t.P.convert(o[1]);n=[e,new t.P(r.x,e.y),r,new t.P(e.x,r.y),e]}return this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,r){return!1!==(r=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){var r,n;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(e,t)));const i=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new Br(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,i):this.style.loadJSON(e,t,i),this):(null===(n=null===(r=this.style)||void 0===r?void 0:r.projection)||void 0===n||n.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Br(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if("string"==typeof e){const n=this._requestManager.transformRequest(e,"Style");t.j(n,new AbortController).then((e=>{this._updateDiff(e.data,r)})).catch((e=>{e&&this.fire(new t.k(e))}))}else"object"==typeof e&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(n){t.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){const r=this.style&&this.style.tileManagers[e];if(void 0!==r)return r.loaded();this.fire(new t.k(new Error(`There is no tile manager with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const r=this.style.tileManagers[e.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);null===this.terrain&&r.reload();for(const n in this.style._layers){const r=this.style._layers[n];"hillshade"===r.type&&r.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),"color-relief"===r.type&&r.source===e.source&&t.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ia(this.painter,r,e),this.painter.renderToTexture=new sa(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=t=>{var r;"style"===t.dataType?this.terrain.tileManager.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(r=t.source)||void 0===r?void 0:r.type)?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new t.l("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.tileManagers;for(const t of Object.values(e))if(!t.areTilesLoaded())return!1;return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}setSourceTileLodParams(e,t,r){if(r){const n=this.getSource(r);if(!n)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);n.calculateTileZoom=Ee(Math.max(1,e),Math.max(1,t))}else for(const n in this.style.tileManagers)this.style.tileManagers[n].getSource().calculateTileZoom=Ee(Math.max(1,e),Math.max(1,t));return this._update(!0),this}refreshTiles(e,r){const n=this.style.tileManagers[e];if(!n)throw new Error(`There is no tile manager with ID "${e}", cannot refresh tile`);void 0===r?n.reload(!0):n.refreshTiles(r.map((e=>new t.ac(e.z,e.x,e.y))))}addImage(e,r,n={}){const{pixelRatio:i=1,sdf:o=!1,stretchX:a,stretchY:l,content:c,textFitWidth:u,textFitHeight:h}=n;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||t.b(r))){if(void 0===r.width||void 0===r.height)return this.fire(new t.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:n,height:s,data:d}=r,p=r;return this.style.addImage(e,{data:new t.R({width:n,height:s},new Uint8Array(d)),pixelRatio:i,stretchX:a,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0,userImage:p}),p.onAdd&&p.onAdd(this,e),this}}{const{width:n,height:d,data:p}=s.getImageData(r);this.style.addImage(e,{data:new t.R({width:n,height:d},p),pixelRatio:i,stretchX:a,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0})}}updateImage(e,r){const n=this.style.getImage(e);if(!n)return this.fire(new t.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=r instanceof HTMLImageElement||t.b(r)?s.getImageData(r):r,{width:o,height:a,data:l}=i;if(void 0===o||void 0===a)return this.fire(new t.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==n.data.width||a!==n.data.height)return this.fire(new t.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(r instanceof HTMLImageElement||t.b(r));return n.data.replace(l,c),this.style.updateImage(e,n),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.k(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return y.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,(e=>{e||this._update(!0)})),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,(e=>{e||this._update(!0)})),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(e,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupResizeObserver(){var e;let t=!1;const r=Zi((e=>{this._trackResize&&!this._removed&&(this.resize(e),this.redraw())}),50),n=null!==(e=this._ownerWindow.ResizeObserver)&&void 0!==e?e:ResizeObserver;this._resizeObserver=new n((e=>{t?r(e):t=!0})),this._resizeObserver.observe(this._container)}_resolveContainer(e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`Container '${e}' not found.`);return t}if(e instanceof HTMLElement)return e;if(e&&"object"==typeof e&&1===e.nodeType)return e;throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=u.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=u.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);const i=this._controlContainer=u.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{o[e]=u.create("div",`maplibregl-ctrl-${e} `,i)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const e=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)}),{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,e):this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e),!r){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new Hi(r,this.transform),h.testSupport(r)}migrateProjection(e,r){super.migrateProjection(e,r),this.painter.transform=e,this.fire(new t.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){var r,n,i,o,a;const s=this._idleTriggered?this._fadeDuration:0,l=(null===(r=this.style.projection)||void 0===r?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,r=c();this.style.zoomHistory.update(e,r);const n=new t.H(e,{now:r,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=n.crossFadingFactor();1===i&&i===this._crossFadingFactor||(u=!0,this._crossFadingFactor=i),this.style.update(n)}const h=(null===(n=this.style.projection)||void 0===n?void 0:n.transitionState)>0!==l;null===(i=this.style.projection)||void 0===i||i.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState(null===(o=this.style.projection)||void 0===o?void 0:o.transitionState,null===(a=this.style.projection)||void 0===a?void 0:a.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||h)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,s,this._crossSourceCollisions,h),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new t.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.cH.mark(t.cI.load),this.fire(new t.l("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.l("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,t.cH.mark(t.cI.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&this._ownerWindow.removeEventListener("online",this._onWindowOnline,!1),y.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==r?void 0:r.loseContext)&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),u.remove(this._canvasContainer),u.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),t.cH.clearMetrics(),this._removed=!0,this.fire(new t.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,s.frame(this._frameRequest,(e=>{t.cH.frame(e),this._frameRequest=null;try{this._render(e)}catch(r){if(!t.Z(r)&&r.message!==si)throw r}}),(()=>{}),this._ownerWindow))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return ca}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(e){return this._lazyInitEmptyStyle(),this.style.setProjection(e),this._update(!0)}},e.MapMouseEvent=oo,e.MapTouchEvent=ao,e.MapWheelEvent=so,e.Marker=ya,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,t)=>{const r=this._map._getUIString(`NavigationControl.${t}`);e.title=r,e.setAttribute("aria-label",r)},this.options=t.e({},ha,e),this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),u.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),u.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=u.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new da(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const r=u.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}},e.Popup=class extends t.E{constructor(e){super(),this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=u.create("div","maplibregl-popup",this._map.getContainer()),this._tip=u.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=fa(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const t=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let r=this.options.anchor;const n=Aa(this.options.offset);if(!r){const e=this._container.offsetWidth,c=this._container.offsetHeight,u=(i=this.options.padding)?{top:null!==(o=i.top)&&void 0!==o?o:0,right:null!==(a=i.right)&&void 0!==a?a:0,bottom:null!==(s=i.bottom)&&void 0!==s?s:0,left:null!==(l=i.left)&&void 0!==l?l:0}:{top:0,right:0,bottom:0,left:0};let h;h=t.y+n.bottom.y<c+u.top?["top"]:t.y>this._map.transform.height-c-u.bottom?["bottom"]:[],t.x<e/2+u.left?h.push("left"):t.x>this._map.transform.width-e/2-u.right&&h.push("right"),r=0===h.length?"bottom":h.join("-")}var i,o,a,s,l;let c=t.add(n[r]);this.options.subpixelPositioning||(c=c.round()),u.setTransform(this._container,`${ma[r]} translate(${c.x}px,${c.y}px)`),ga(this._container,r,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(Ea),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.V.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),r=document.createElement("body");let n;for(r.innerHTML=e;n=r.firstChild,n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=u.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}setPadding(e){this.options.padding=e,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=u.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Ta);e&&e.focus()}},e.RasterDEMTileSource=K,e.RasterTileSource=X,e.ScaleControl=class{constructor(e){this._onMove=()=>{xa(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,xa(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},wa),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=Fo,e.Style=Br,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=u.create("button","maplibregl-ctrl-terrain",this._container),u.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){u.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=Do,e.TwoFingersTouchRotateHandler=Mo,e.TwoFingersTouchZoomHandler=ko,e.TwoFingersTouchZoomRotateHandler=Go,e.VectorTileSource=Y,e.VideoSource=re,e.addSourceType=(e,r)=>t._(void 0,void 0,void 0,(function*(){if(oe(e))throw new Error(`A source type called "${e}" already exists.`);var t;t=r,ie[e]=t})),e.clearPrewarmedResources=function(){const e=$;e&&e.isPreloaded()&&1===e.numActive()&&(e.release(O),$=null)},e.createTileMesh=cr,e.getMaxParallelImageRequests=function(){return t.c.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return ce().getRTLTextPluginStatus()},e.getVersion=function(){return Ca},e.getWorkerCount=function(){return L.workerCount},e.getWorkerUrl=function(){return t.c.WORKER_URL},e.importScriptInWorkers=function(e){return N().broadcast("IS",e)},e.isTimeFrozen=function(){return l.isFrozen()},e.now=c,e.prewarm=function(){F().acquire(O)},e.restoreNow=function(){l.restoreNow()},e.setMaxParallelImageRequests=function(e){t.c.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setNow=function(e){l.setNow(e)},e.setRTLTextPlugin=function(e,t){return ce().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){L.workerCount=e},e.setWorkerUrl=function(e){t.c.WORKER_URL=e}})),e}()),maplibreGl$1.exports}var maplibreGlExports=requireMaplibreGl();const QCarouselSlide=createComponent({name:"QCarouselSlide",props:{...usePanelChildProps,imgSrc:String},setup(e,{slots:t}){const r=computed((()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{}));return()=>h$2("div",{class:"q-carousel__slide",style:r.value},hSlot(t.default))}}),navigationPositionOptions=["top","right","bottom","left"],controlTypeOptions=["regular","flat","outline","push","unelevated"],QCarousel=createComponent({name:"QCarousel",props:{...useDarkProps,...usePanelProps,...useFullscreenProps,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>controlTypeOptions.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>navigationPositionOptions.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...useFullscreenEmits,...usePanelEmits],setup(e,{slots:t}){const{proxy:{$q:r}}=getCurrentInstance(),n=useDark(e,r);let i,o=null;const{updatePanelsList:a,getPanelContent:s,panelDirectives:l,goToPanel:c,previousPanel:u,nextPanel:h,getEnabledPanels:d,panelIndex:p}=usePanel(),{inFullscreen:f}=useFullscreen(),m=computed((()=>!0!==f.value&&void 0!==e.height?{height:e.height}:{})),g=computed((()=>!0===e.vertical?"vertical":"horizontal")),y=computed((()=>e.navigationPosition||(!0===e.vertical?"right":"bottom"))),_=computed((()=>`q-carousel q-panel-parent q-carousel--with${!0===e.padding?"":"out"}-padding`+(!0===f.value?" fullscreen":"")+(!0===n.value?" q-carousel--dark q-dark":"")+(!0===e.arrows?` q-carousel--arrows-${g.value}`:"")+(!0===e.navigation?` q-carousel--navigation-${y.value}`:""))),v=computed((()=>{const t=[e.prevIcon||r.iconSet.carousel[!0===e.vertical?"up":"left"],e.nextIcon||r.iconSet.carousel[!0===e.vertical?"down":"right"]];return!1===e.vertical&&!0===r.lang.rtl?t.reverse():t})),b=computed((()=>e.navigationIcon||r.iconSet.carousel.navigationIcon)),w=computed((()=>e.navigationActiveIcon||b.value)),x=computed((()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0})));function S(){const t=!0===isNumber$2(e.autoplay)?Math.abs(e.autoplay):5e3;null!==o&&clearTimeout(o),o=setTimeout((()=>{o=null,t>=0?h():u()}),t)}function E(t,r){return h$2("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${t} q-carousel__navigation--${y.value}`+(void 0!==e.controlColor?` text-${e.controlColor}`:"")},[h$2("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},d().map(r))])}return watch$2((()=>e.modelValue),(()=>{e.autoplay&&S()})),watch$2((()=>e.autoplay),(e=>{e?S():null!==o&&(clearTimeout(o),o=null)})),onMounted((()=>{e.autoplay&&S()})),onBeforeUnmount((()=>{null!==o&&clearTimeout(o)})),()=>(i=a(t),h$2("div",{class:_.value,style:m.value},[hDir("div",{class:"q-carousel__slides-container"},s(),"sl-cont",e.swipeable,(()=>l.value))].concat(function(){const r=[];if(!0===e.navigation){const e=void 0!==t["navigation-icon"]?t["navigation-icon"]:e=>h$2(QBtn,{key:"nav"+e.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${!0===e.active?"":"in"}active`,...e.btnProps,onClick:e.onClick}),n=i-1;r.push(E("buttons",((t,r)=>{const i=t.props.name,o=p.value===r;return e({index:r,maxIndex:n,name:i,active:o,btnProps:{icon:!0===o?w.value:b.value,size:"sm",...x.value},onClick:()=>{c(i)}})})))}else if(!0===e.thumbnails){const t=void 0!==e.controlColor?` text-${e.controlColor}`:"";r.push(E("thumbnails",(r=>{const n=r.props;return h$2("img",{key:"tmb#"+n.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${n.name===e.modelValue?"":"in"}active`+t,src:n.imgSrc||n["img-src"],onClick:()=>{c(n.name)}})})))}return!0===e.arrows&&p.value>=0&&((!0===e.infinite||p.value>0)&&r.push(h$2("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${g.value} absolute flex flex-center`},[h$2(QBtn,{icon:v.value[0],...x.value,onClick:u})])),(!0===e.infinite||p.value<i-1)&&r.push(h$2("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${g.value} absolute flex flex-center`},[h$2(QBtn,{icon:v.value[1],...x.value,onClick:h})]))),hMergeSlot(t.control,r)}())))}}),QBtnToggle=createComponent({name:"QBtnToggle",props:{...useFormProps,modelValue:{required:!0},options:{type:Array,required:!0,validator:e=>e.every((e=>("label"in e||"icon"in e||"slot"in e)&&"value"in e))},color:String,textColor:String,toggleColor:{type:String,default:"primary"},toggleTextColor:String,outline:Boolean,flat:Boolean,unelevated:Boolean,rounded:Boolean,push:Boolean,glossy:Boolean,size:String,padding:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,readonly:Boolean,disable:Boolean,stack:Boolean,stretch:Boolean,spread:Boolean,clearable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","clear","click"],setup(e,{slots:t,emit:r}){const n=computed((()=>void 0!==e.options.find((t=>t.value===e.modelValue)))),i=useFormInject(computed((()=>({type:"hidden",name:e.name,value:e.modelValue})))),o=computed((()=>getBtnDesignAttr(e))),a=computed((()=>({rounded:e.rounded,dense:e.dense,...o.value}))),s=computed((()=>e.options.map(((t,n)=>{const{attrs:i,value:o,slot:s,...c}=t;return{slot:s,props:{key:n,"aria-pressed":o===e.modelValue?"true":"false",...i,...c,...a.value,disable:!0===e.disable||!0===c.disable,color:o===e.modelValue?l(c,"toggleColor"):l(c,"color"),textColor:o===e.modelValue?l(c,"toggleTextColor"):l(c,"textColor"),noCaps:!0===l(c,"noCaps"),noWrap:!0===l(c,"noWrap"),size:l(c,"size"),padding:l(c,"padding"),ripple:l(c,"ripple"),stack:!0===l(c,"stack"),stretch:!0===l(c,"stretch"),onClick(n){!function(t,n,i){!0!==e.readonly&&(e.modelValue===t?!0===e.clearable&&(r("update:modelValue",null,null),r("clear")):r("update:modelValue",t,n),r("click",i))}(o,t,n)}}}}))));function l(t,r){return void 0===t[r]?e[r]:t[r]}function c(){const r=s.value.map((e=>h$2(QBtn,e.props,void 0!==e.slot?t[e.slot]:void 0)));return void 0!==e.name&&!0!==e.disable&&!0===n.value&&i(r,"push"),hMergeSlot(t.default,r)}return()=>h$2(QBtnGroup,{class:"q-btn-toggle",...o.value,rounded:e.rounded,stretch:e.stretch,glossy:e.glossy,spread:e.spread},c)}}),classes={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types={POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes$1={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},events$1={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},meta={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates={ACTIVE:"true",INACTIVE:"false"},interactions=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN$1=-90,LAT_RENDERED_MIN$1=-85,LAT_MAX$1=90,LAT_RENDERED_MAX$1=85,LNG_MIN$1=-270,LNG_MAX$1=270,Constants=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:LAT_MAX$1,LAT_MIN:LAT_MIN$1,LAT_RENDERED_MAX:LAT_RENDERED_MAX$1,LAT_RENDERED_MIN:LAT_RENDERED_MIN$1,LNG_MAX:LNG_MAX$1,LNG_MIN:LNG_MIN$1,activeStates:activeStates,classes:classes,cursors:cursors,events:events$1,geojsonTypes:geojsonTypes,interactions:interactions,meta:meta,modes:modes$1,sources:sources,types:types,updateActions:updateActions},Symbol.toStringTag,{value:"Module"}));function isOfMetaType(e){return function(t){const r=t.featureTarget;return!!r&&(!!r.properties&&r.properties.meta===e)}}function isShiftMousedown(e){return!!e.originalEvent&&(!!e.originalEvent.shiftKey&&0===e.originalEvent.button)}function isActiveFeature(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===activeStates.ACTIVE&&e.featureTarget.properties.meta===meta.FEATURE))}function isInactiveFeature(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===activeStates.INACTIVE&&e.featureTarget.properties.meta===meta.FEATURE))}function noTarget(e){return void 0===e.featureTarget}function isFeature(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&e.featureTarget.properties.meta===meta.FEATURE)}function isVertex$1(e){const t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===meta.VERTEX)}function isShiftDown(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}function isEscapeKey(e){return"Escape"===e.key||27===e.keyCode}function isEnterKey(e){return"Enter"===e.key||13===e.keyCode}function isBackspaceKey(e){return"Backspace"===e.key||8===e.keyCode}function isDeleteKey(e){return"Delete"===e.key||46===e.keyCode}function isDigit1Key(e){return"1"===e.key||49===e.keyCode}function isDigit2Key(e){return"2"===e.key||50===e.keyCode}function isDigit3Key(e){return"3"===e.key||51===e.keyCode}function isDigitKey(e){const t=e.key||String.fromCharCode(e.keyCode);return t>="0"&&t<="9"}function isTrue(){return!0}const common_selectors=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:isActiveFeature,isBackspaceKey:isBackspaceKey,isDeleteKey:isDeleteKey,isDigit1Key:isDigit1Key,isDigit2Key:isDigit2Key,isDigit3Key:isDigit3Key,isDigitKey:isDigitKey,isEnterKey:isEnterKey,isEscapeKey:isEscapeKey,isFeature:isFeature,isInactiveFeature:isInactiveFeature,isOfMetaType:isOfMetaType,isShiftDown:isShiftDown,isShiftMousedown:isShiftMousedown,isTrue:isTrue,isVertex:isVertex$1,noTarget:noTarget},Symbol.toStringTag,{value:"Module"}));var geojsonArea={},wgs84={},hasRequiredWgs84,hasRequiredGeojsonArea;function requireWgs84(){return hasRequiredWgs84||(hasRequiredWgs84=1,wgs84.RADIUS=6378137,wgs84.FLATTENING=1/298.257223563,wgs84.POLAR_RADIUS=6356752.3142),wgs84}function requireGeojsonArea(){if(hasRequiredGeojsonArea)return geojsonArea;hasRequiredGeojsonArea=1;var e=requireWgs84();function t(e){var t=0;if(e&&e.length>0){t+=Math.abs(r(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(r(e[n]))}return t}function r(t){var r,i,o,a,s,l,c=0,u=t.length;if(u>2){for(l=0;l<u;l++)l===u-2?(o=u-2,a=u-1,s=0):l===u-1?(o=u-1,a=0,s=1):(o=l,a=l+1,s=l+2),r=t[o],i=t[a],c+=(n(t[s][0])-n(r[0]))*Math.sin(n(i[1]));c=c*e.RADIUS*e.RADIUS/2}return c}function n(e){return e*Math.PI/180}return geojsonArea.geometry=function e(r){var n,i=0;switch(r.type){case"Polygon":return t(r.coordinates);case"MultiPolygon":for(n=0;n<r.coordinates.length;n++)i+=t(r.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<r.geometries.length;n++)i+=e(r.geometries[n]);return i}},geojsonArea.ring=r,geojsonArea}var geojsonAreaExports=requireGeojsonArea();const area=getDefaultExportFromCjs$1(geojsonAreaExports),FEATURE_SORT_RANKS={Point:0,LineString:1,MultiLineString:1,Polygon:2};function comparator(e,t){const r=FEATURE_SORT_RANKS[e.geometry.type]-FEATURE_SORT_RANKS[t.geometry.type];return 0===r&&e.geometry.type===geojsonTypes.POLYGON?e.area-t.area:r}function sortFeatures(e){return e.map((e=>(e.geometry.type===geojsonTypes.POLYGON&&(e.area=area.geometry({type:geojsonTypes.FEATURE,property:{},geometry:e.geometry})),e))).sort(comparator).map((e=>(delete e.area,e)))}function mapEventToBoundingBox(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function StringSet(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}StringSet.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},StringSet.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},StringSet.prototype.has=function(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])},StringSet.prototype.values=function(){const e=[];return Object.keys(this._items).forEach((t=>{e.push({k:t,v:this._items[t]})})),Object.keys(this._nums).forEach((t=>{e.push({k:JSON.parse(t),v:this._nums[t]})})),e.sort(((e,t)=>e.v-t.v)).map((e=>e.k))},StringSet.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const META_TYPES=[meta.FEATURE,meta.MIDPOINT,meta.VERTEX],featuresAt={click:featuresAtClick,touch:featuresAtTouch};function featuresAtClick(e,t,r){return featuresAt$1(e,t,r,r.options.clickBuffer)}function featuresAtTouch(e,t,r){return featuresAt$1(e,t,r,r.options.touchBuffer)}function featuresAt$1(e,t,r,n){if(null===r.map)return[];const i=e?mapEventToBoundingBox(e,n):t,o={};r.options.styles&&(o.layers=r.options.styles.map((e=>e.id)).filter((e=>null!=r.map.getLayer(e))));const a=r.map.queryRenderedFeatures(i,o).filter((e=>-1!==META_TYPES.indexOf(e.properties.meta))),s=new StringSet,l=[];return a.forEach((e=>{const t=e.properties.id;s.has(t)||(s.add(t),l.push(e))})),sortFeatures(l)}function getFeatureAtAndSetCursors(e,t){const r=featuresAt.click(e,null,t),n={mouse:cursors.NONE};return r[0]&&(n.mouse=r[0].properties.active===activeStates.ACTIVE?cursors.MOVE:cursors.POINTER,n.feature=r[0].properties.meta),-1!==t.events.currentModeName().indexOf("draw")&&(n.mouse=cursors.ADD),t.ui.queueMapClasses(n),t.ui.updateMapClasses(),r[0]}function euclideanDistance(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}const FINE_TOLERANCE=4,GROSS_TOLERANCE=12,INTERVAL=500;function isClick(e,t,r={}){const n=null!=r.fineTolerance?r.fineTolerance:FINE_TOLERANCE,i=null!=r.grossTolerance?r.grossTolerance:GROSS_TOLERANCE,o=null!=r.interval?r.interval:INTERVAL;e.point=e.point||t.point,e.time=e.time||t.time;const a=euclideanDistance(e.point,t.point);return a<n||a<i&&t.time-e.time<o}const TAP_TOLERANCE=25,TAP_INTERVAL=250;function isTap(e,t,r={}){const n=null!=r.tolerance?r.tolerance:TAP_TOLERANCE,i=null!=r.interval?r.interval:TAP_INTERVAL;e.point=e.point||t.point,e.time=e.time||t.time;return euclideanDistance(e.point,t.point)<n&&t.time-e.time<i}const ModeHandler=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on(e,t,n){if(void 0===r[e])throw new Error(`Invalid event type: ${e}`);r[e].push({selector:t,fn:n})},render(e){t.store.featureChanged(e)}},i=function(e,i){const o=r[e];let a=o.length;for(;a--;){const e=o[a];if(e.selector(i)){e.fn.call(n,i)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(e){i("drag",e)},click(e){i("click",e)},mousemove(e){i("mousemove",e)},mousedown(e){i("mousedown",e)},mouseup(e){i("mouseup",e)},mouseout(e){i("mouseout",e)},keydown(e){i("keydown",e)},keyup(e){i("keyup",e)},touchstart(e){i("touchstart",e)},touchmove(e){i("touchmove",e)},touchend(e){i("touchend",e)},tap(e){i("tap",e)}}};let customAlphabet=(e,t=21)=>(r=t)=>{let n="",i=0|r;for(;i--;)n+=e[Math.random()*e.length|0];return n};const nanoid=customAlphabet("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function generateID(){return nanoid()}const Feature=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||generateID(),this.type=t.geometry.type};Feature.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Feature.prototype.incomingCoords=function(e){this.setCoordinates(e)},Feature.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},Feature.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Feature.prototype.setProperty=function(e,t){this.properties[e]=t},Feature.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Feature.prototype.internal=function(e){const t={id:this.id,meta:meta.FEATURE,"meta:type":this.type,active:activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const Point$1=function(e,t){Feature.call(this,e,t)};Point$1.prototype=Object.create(Feature.prototype),Point$1.prototype.isValid=function(){return"number"==typeof this.coordinates[0]&&"number"==typeof this.coordinates[1]},Point$1.prototype.updateCoordinate=function(e,t,r){this.coordinates=3===arguments.length?[t,r]:[e,t],this.changed()},Point$1.prototype.getCoordinate=function(){return this.getCoordinates()};const LineString=function(e,t){Feature.call(this,e,t)};LineString.prototype=Object.create(Feature.prototype),LineString.prototype.isValid=function(){return this.coordinates.length>1},LineString.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])},LineString.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},LineString.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)},LineString.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};const Polygon=function(e,t){Feature.call(this,e,t),this.coordinates=this.coordinates.map((e=>e.slice(0,-1)))};Polygon.prototype=Object.create(Feature.prototype),Polygon.prototype.isValid=function(){return 0!==this.coordinates.length&&this.coordinates.every((e=>e.length>2))},Polygon.prototype.incomingCoords=function(e){this.coordinates=e.map((e=>e.slice(0,-1))),this.changed()},Polygon.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},Polygon.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map((e=>parseInt(e,10)));this.coordinates[n[0]].splice(n[1],0,[t,r])},Polygon.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map((e=>parseInt(e,10))),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))},Polygon.prototype.getCoordinate=function(e){const t=e.split(".").map((e=>parseInt(e,10))),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))},Polygon.prototype.getCoordinates=function(){return this.coordinates.map((e=>e.concat([e[0]])))},Polygon.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10);void 0===this.coordinates[i]&&(this.coordinates[i]=[]),this.coordinates[i][o]=[t,r]};const models$1={MultiPoint:Point$1,MultiLineString:LineString,MultiPolygon:Polygon},takeAction=(e,t,r,n,i)=>{const o=r.split("."),a=parseInt(o[0],10),s=o[1]?o.slice(1).join("."):null;return e[a][t](s,n,i)},MultiFeature=function(e,t){if(Feature.call(this,e,t),delete this.coordinates,this.model=models$1[t.geometry.type],void 0===this.model)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};function ModeInterface(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}MultiFeature.prototype=Object.create(Feature.prototype),MultiFeature.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map((e=>new t(this.ctx,{id:generateID(),type:geojsonTypes.FEATURE,properties:{},geometry:{coordinates:e,type:this.type.replace("Multi","")}})))},MultiFeature.prototype.isValid=function(){return this.features.every((e=>e.isValid()))},MultiFeature.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()},MultiFeature.prototype.getCoordinate=function(e){return takeAction(this.features,"getCoordinate",e)},MultiFeature.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map((e=>e.type===geojsonTypes.POLYGON?e.getCoordinates():e.coordinates))))},MultiFeature.prototype.updateCoordinate=function(e,t,r){takeAction(this.features,"updateCoordinate",e,t,r),this.changed()},MultiFeature.prototype.addCoordinate=function(e,t,r){takeAction(this.features,"addCoordinate",e,t,r),this.changed()},MultiFeature.prototype.removeCoordinate=function(e){takeAction(this.features,"removeCoordinate",e),this.changed()},MultiFeature.prototype.getFeatures=function(){return this.features},ModeInterface.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)},ModeInterface.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce(((e,t)=>(void 0===e[t.feature_id]&&(e[t.feature_id]=!0,this._ctx.store.get(t.feature_id).changed()),e)),{})},ModeInterface.prototype.getSelected=function(){return this._ctx.store.getSelected()},ModeInterface.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},ModeInterface.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)},ModeInterface.prototype.getFeature=function(e){return this._ctx.store.get(e)},ModeInterface.prototype.select=function(e){return this._ctx.store.select(e)},ModeInterface.prototype.deselect=function(e){return this._ctx.store.deselect(e)},ModeInterface.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)},ModeInterface.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)},ModeInterface.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},ModeInterface.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},ModeInterface.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)},ModeInterface.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)},ModeInterface.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)},ModeInterface.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)},ModeInterface.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)},ModeInterface.prototype.featuresAt=function(e,t,r="click"){if("click"!==r&&"touch"!==r)throw new Error("invalid buffer type");return featuresAt[r](e,t,this._ctx)},ModeInterface.prototype.newFeature=function(e){const t=e.geometry.type;return t===geojsonTypes.POINT?new Point$1(this._ctx,e):t===geojsonTypes.LINE_STRING?new LineString(this._ctx,e):t===geojsonTypes.POLYGON?new Polygon(this._ctx,e):new MultiFeature(this._ctx,e)},ModeInterface.prototype.isInstanceOf=function(e,t){if(e===geojsonTypes.POINT)return t instanceof Point$1;if(e===geojsonTypes.LINE_STRING)return t instanceof LineString;if(e===geojsonTypes.POLYGON)return t instanceof Polygon;if("MultiFeature"===e)return t instanceof MultiFeature;throw new Error(`Unknown feature class: ${e}`)},ModeInterface.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)},ModeInterface.prototype.onSetup=function(){},ModeInterface.prototype.onDrag=function(){},ModeInterface.prototype.onClick=function(){},ModeInterface.prototype.onMouseMove=function(){},ModeInterface.prototype.onMouseDown=function(){},ModeInterface.prototype.onMouseUp=function(){},ModeInterface.prototype.onMouseOut=function(){},ModeInterface.prototype.onKeyUp=function(){},ModeInterface.prototype.onKeyDown=function(){},ModeInterface.prototype.onTouchStart=function(){},ModeInterface.prototype.onTouchMove=function(){},ModeInterface.prototype.onTouchEnd=function(){},ModeInterface.prototype.onTap=function(){},ModeInterface.prototype.onStop=function(){},ModeInterface.prototype.onTrash=function(){},ModeInterface.prototype.onCombineFeature=function(){},ModeInterface.prototype.onUncombineFeature=function(){},ModeInterface.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const eventMapper={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},eventKeys=Object.keys(eventMapper);function objectToMode(e){const t=Object.keys(e);return function(r,n={}){let i={};const o=t.reduce(((t,r)=>(t[r]=e[r],t)),new ModeInterface(r));return{start(){i=o.onSetup(n),eventKeys.forEach((t=>{const r=eventMapper[t];let n=()=>!1;var a;e[r]&&(n=()=>!0),this.on(t,n,(a=r,e=>o[a](i,e)))}))},stop(){o.onStop(i)},trash(){o.onTrash(i)},combineFeatures(){o.onCombineFeatures(i)},uncombineFeatures(){o.onUncombineFeatures(i)},render(e,t){o.toDisplayFeatures(i,e,t)}}}}function events(e){const t=Object.keys(e.options.modes).reduce(((t,r)=>(t[r]=objectToMode(e.options.modes[r]),t)),{});let r={},n={};const i={};let o=null,a=null;i.drag=function(t,r){r({point:t.point,time:(new Date).getTime()})?(e.ui.queueMapClasses({mouse:cursors.DRAG}),a.drag(t)):t.originalEvent.stopPropagation()},i.mousedrag=function(e){i.drag(e,(e=>!isClick(r,e)))},i.touchdrag=function(e){i.drag(e,(e=>!isTap(n,e)))},i.mousemove=function(t){if(1===(void 0!==t.originalEvent.buttons?t.originalEvent.buttons:t.originalEvent.which))return i.mousedrag(t);const r=getFeatureAtAndSetCursors(t,e);t.featureTarget=r,a.mousemove(t)},i.mousedown=function(t){r={time:(new Date).getTime(),point:t.point};const n=getFeatureAtAndSetCursors(t,e);t.featureTarget=n,a.mousedown(t)},i.mouseup=function(t){const n=getFeatureAtAndSetCursors(t,e);t.featureTarget=n,isClick(r,{point:t.point,time:(new Date).getTime()})?a.click(t):a.mouseup(t)},i.mouseout=function(e){a.mouseout(e)},i.touchstart=function(t){if(!e.options.touchEnabled)return;n={time:(new Date).getTime(),point:t.point};const r=featuresAt.touch(t,null,e)[0];t.featureTarget=r,a.touchstart(t)},i.touchmove=function(t){if(e.options.touchEnabled)return a.touchmove(t),i.touchdrag(t)},i.touchend=function(t){if(t.originalEvent.preventDefault(),!e.options.touchEnabled)return;const r=featuresAt.touch(t,null,e)[0];t.featureTarget=r,isTap(n,{time:(new Date).getTime(),point:t.point})?a.tap(t):a.touchend(t)};const s=e=>{const t=isBackspaceKey(e),r=isDeleteKey(e),n=isDigitKey(e);return!(t||r||n)};function l(r,n,i={}){a.stop();const s=t[r];if(void 0===s)throw new Error(`${r} is not valid`);o=r;const l=s(e,n);a=ModeHandler(l,e),i.silent||e.map.fire(events$1.MODE_CHANGE,{mode:r}),e.store.setDirty(),e.store.render()}i.keydown=function(t){(t.srcElement||t.target).classList.contains(classes.CANVAS)&&((isBackspaceKey(t)||isDeleteKey(t))&&e.options.controls.trash?(t.preventDefault(),a.trash()):s(t)?a.keydown(t):isDigit1Key(t)&&e.options.controls.point?l(modes$1.DRAW_POINT):isDigit2Key(t)&&e.options.controls.line_string?l(modes$1.DRAW_LINE_STRING):isDigit3Key(t)&&e.options.controls.polygon&&l(modes$1.DRAW_POLYGON))},i.keyup=function(e){s(e)&&a.keyup(e)},i.zoomend=function(){e.store.changeZoom()},i.data=function(t){if("style"===t.dataType){const{setup:t,map:r,options:n,store:i}=e;n.styles.some((e=>r.getLayer(e.id)))||(t.addLayers(),i.setDirty(),i.render())}};const c={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start(){o=e.options.defaultMode,a=ModeHandler(t[o](e),e)},changeMode:l,actionable:function(t){let r=!1;Object.keys(t).forEach((e=>{if(void 0===c[e])throw new Error("Invalid action type");c[e]!==t[e]&&(r=!0),c[e]=t[e]})),r&&e.map.fire(events$1.ACTIONABLE,{actions:c})},currentModeName:()=>o,currentModeRender:(e,t)=>a.render(e,t),fire(t,r){e.map&&e.map.fire(t,r)},addEventListeners(){e.map.on("mousemove",i.mousemove),e.map.on("mousedown",i.mousedown),e.map.on("mouseup",i.mouseup),e.map.on("data",i.data),e.map.on("touchmove",i.touchmove),e.map.on("touchstart",i.touchstart),e.map.on("touchend",i.touchend),e.container.addEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",i.keydown),e.container.addEventListener("keyup",i.keyup))},removeEventListeners(){e.map.off("mousemove",i.mousemove),e.map.off("mousedown",i.mousedown),e.map.off("mouseup",i.mouseup),e.map.off("data",i.data),e.map.off("touchmove",i.touchmove),e.map.off("touchstart",i.touchstart),e.map.off("touchend",i.touchend),e.container.removeEventListener("mouseout",i.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",i.keydown),e.container.removeEventListener("keyup",i.keyup))},trash(e){a.trash(e)},combineFeatures(){a.combineFeatures()},uncombineFeatures(){a.uncombineFeatures()},getMode:()=>o}}function toDenseArray(e){return[].concat(e).filter((e=>void 0!==e))}function render(){const e=this;if(!(e.ctx.map&&void 0!==e.ctx.map.getSource(sources.HOT)))return s();const t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});let r=[],n=[];e.isDirty?n=e.getAllIds():(r=e.getChangedIds().filter((t=>void 0!==e.get(t))),n=e.sources.hot.filter((t=>t.properties.id&&-1===r.indexOf(t.properties.id)&&void 0!==e.get(t.properties.id))).map((e=>e.properties.id))),e.sources.hot=[];const i=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter((e=>{const t=e.properties.id||e.properties.parent;return-1===r.indexOf(t)}));const o=i!==e.sources.cold.length||n.length>0;function a(r,n){const i=e.get(r).internal(t);e.ctx.events.currentModeRender(i,(r=>{r.properties.mode=t,e.sources[n].push(r)}))}function s(){e.isDirty=!1,e.clearChangedIds()}r.forEach((e=>a(e,"hot"))),n.forEach((e=>a(e,"cold"))),o&&e.ctx.map.getSource(sources.COLD).setData({type:geojsonTypes.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(sources.HOT).setData({type:geojsonTypes.FEATURE_COLLECTION,features:e.sources.hot}),s()}function Store(e){let t;this._features={},this._featureIds=new StringSet,this._selectedFeatureIds=new StringSet,this._selectedCoordinates=[],this._changedFeatureIds=new StringSet,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=()=>{t||(t=requestAnimationFrame((()=>{t=null,render.call(this),this._emitSelectionChange&&(this.ctx.events.fire(events$1.SELECTION_CHANGE,{features:this.getSelected().map((e=>e.toGeoJSON())),points:this.getSelectedCoordinates().map((e=>({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.POINT,coordinates:e.coordinates}})))}),this._emitSelectionChange=!1),this.ctx.events.fire(events$1.RENDER,{})})))},this.isDirty=!1}function refreshSelectedCoordinates(e,t={}){const r=e._selectedCoordinates.filter((t=>e._selectedFeatureIds.has(t.feature_id)));e._selectedCoordinates.length===r.length||t.silent||(e._emitSelectionChange=!0),e._selectedCoordinates=r}Store.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}},Store.prototype.setDirty=function(){return this.isDirty=!0,this},Store.prototype.featureCreated=function(e,t={}){this._changedFeatureIds.add(e);if(!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)){const t=this.get(e);this.ctx.events.fire(events$1.CREATE,{features:[t.toGeoJSON()]})}return this},Store.prototype.featureChanged=function(e,t={}){this._changedFeatureIds.add(e);return!0!==(null!=t.silent?t.silent:this.ctx.options.suppressAPIEvents)&&this.ctx.events.fire(events$1.UPDATE,{action:t.action?t.action:updateActions.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this},Store.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},Store.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},Store.prototype.getAllIds=function(){return this._featureIds.values()},Store.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this},Store.prototype.delete=function(e,t={}){const r=[];return toDenseArray(e).forEach((e=>{this._featureIds.has(e)&&(this._featureIds.delete(e),this._selectedFeatureIds.delete(e),t.silent||-1===r.indexOf(this._features[e])&&r.push(this._features[e].toGeoJSON()),delete this._features[e],this.isDirty=!0)})),r.length&&this.ctx.events.fire(events$1.DELETE,{features:r}),refreshSelectedCoordinates(this,t),this},Store.prototype.get=function(e){return this._features[e]},Store.prototype.getAll=function(){return Object.keys(this._features).map((e=>this._features[e]))},Store.prototype.select=function(e,t={}){return toDenseArray(e).forEach((e=>{this._selectedFeatureIds.has(e)||(this._selectedFeatureIds.add(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))})),this},Store.prototype.deselect=function(e,t={}){return toDenseArray(e).forEach((e=>{this._selectedFeatureIds.has(e)&&(this._selectedFeatureIds.delete(e),this._changedFeatureIds.add(e),t.silent||(this._emitSelectionChange=!0))})),refreshSelectedCoordinates(this,t),this},Store.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this},Store.prototype.setSelected=function(e,t={}){return e=toDenseArray(e),this.deselect(this._selectedFeatureIds.values().filter((t=>-1===e.indexOf(t))),{silent:t.silent}),this.select(e.filter((e=>!this._selectedFeatureIds.has(e))),{silent:t.silent}),this},Store.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this},Store.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},Store.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},Store.prototype.getSelected=function(){return this.getSelectedIds().map((e=>this.get(e)))},Store.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map((e=>({coordinates:this.get(e.feature_id).getCoordinate(e.coord_path)})))},Store.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)},Store.prototype.setFeatureProperty=function(e,t,r,n={}){this.get(e).setProperty(t,r),this.featureChanged(e,{silent:n.silent,action:updateActions.CHANGE_PROPERTIES})},Store.prototype.storeMapConfig=function(){interactions.forEach((e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())}))},Store.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach((e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()}))},Store.prototype.getInitialConfigValue=function(e){return void 0===this._mapInitialConfig[e]||this._mapInitialConfig[e]};const classTypes=["mode","feature","mouse"];function ui(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},i={mode:null,feature:null,mouse:null};function o(e){i=Object.assign(i,e)}function a(){if(!e.container)return;const t=[],r=[];classTypes.forEach((e=>{i[e]!==n[e]&&(t.push(`${e}-${n[e]}`),null!==i[e]&&r.push(`${e}-${i[e]}`))})),t.length>0&&e.container.classList.remove(...t),r.length>0&&e.container.classList.add(...r),n=Object.assign(n,i)}function s(e,t={}){const n=document.createElement("button");return n.className=`${classes.CONTROL_BUTTON} ${t.className}`,n.setAttribute("title",t.title),t.container.appendChild(n),n.addEventListener("click",(n=>{n.preventDefault(),n.stopPropagation();if(n.target===r)return l(),void t.onDeactivate();c(e),t.onActivate()}),!0),n}function l(){r&&(r.classList.remove(classes.ACTIVE_BUTTON),r=null)}function c(e){l();const n=t[e];n&&n&&"trash"!==e&&(n.classList.add(classes.ACTIVE_BUTTON),r=n)}return{setActiveButton:c,queueMapClasses:o,updateMapClasses:a,clearMapClasses:function(){o({mode:null,feature:null,mouse:null}),a()},addButtons:function(){const r=e.options.controls,n=document.createElement("div");return n.className=`${classes.CONTROL_GROUP} ${classes.CONTROL_BASE}`,r?(r[types.POINT]&&(t[types.POINT]=s(types.POINT,{container:n,className:classes.CONTROL_BUTTON_POINT,title:"Marker tool "+(e.options.keybindings?"(1)":""),onActivate:()=>e.events.changeMode(modes$1.DRAW_POINT),onDeactivate:()=>e.events.trash()})),r[types.LINE]&&(t[types.LINE]=s(types.LINE,{container:n,className:classes.CONTROL_BUTTON_LINE,title:"LineString tool "+(e.options.keybindings?"(2)":""),onActivate:()=>e.events.changeMode(modes$1.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),r[types.POLYGON]&&(t[types.POLYGON]=s(types.POLYGON,{container:n,className:classes.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(e.options.keybindings?"(3)":""),onActivate:()=>e.events.changeMode(modes$1.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),r.trash&&(t.trash=s("trash",{container:n,className:classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),r.combine_features&&(t.combine_features=s("combineFeatures",{container:n,className:classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),r.uncombine_features&&(t.uncombine_features=s("uncombineFeatures",{container:n,className:classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}})),n):n},removeButtons:function(){Object.keys(t).forEach((e=>{const r=t[e];r.parentNode&&r.parentNode.removeChild(r),delete t[e]}))}}}function runSetup(e){let t=null,r=null;const n={onRemove(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(i){if(e.map=i,e.events=events(e),e.ui=ui(e),e.container=i.getContainer(),e.store=new Store(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=i.boxZoom.isEnabled(),i.boxZoom.disable();const t=i.dragPan.isEnabled();i.dragPan.disable(),i.dragPan.enable(),t||i.dragPan.disable()}return i.loaded()?n.connect():(i.on("load",n.connect),r=setInterval((()=>{i.loaded()&&n.connect()}),16)),e.events.start(),t},addLayers(){e.map.addSource(sources.COLD,{data:{type:geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(sources.HOT,{data:{type:geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach((t=>{e.map.addLayer(t)})),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach((t=>{e.map.getLayer(t.id)&&e.map.removeLayer(t.id)})),e.map.getSource(sources.COLD)&&e.map.removeSource(sources.COLD),e.map.getSource(sources.HOT)&&e.map.removeSource(sources.HOT)}};return e.setup=n,n}const blue="#3bb2d0",orange="#fbb03b",white="#fff",styles=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],orange,blue],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],orange,blue],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":white}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],orange,blue]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":white}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":orange}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":orange}}];function Point(e,t){this.x=e,this.y=t}function mouseEventPoint(e,t){const r=t.getBoundingClientRect();return new Point(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}function createVertex(e,t,r,n){return{type:geojsonTypes.FEATURE,properties:{meta:meta.VERTEX,parent:e,coord_path:r,active:n?activeStates.ACTIVE:activeStates.INACTIVE},geometry:{type:geojsonTypes.POINT,coordinates:t}}}function isNumber(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function coordEach(e,t,r){if(null!==e)for(var n,i,o,a,s,l,c,u,h=0,d=0,p=e.type,f="FeatureCollection"===p,m="Feature"===p,g=f?e.features.length:1,y=0;y<g;y++){s=(u=!!(c=f?e.features[y].geometry:m?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<s;_++){var v=0,b=0;if(null!==(a=u?c.geometries[_]:c)){l=a.coordinates;var w=a.type;switch(h=0,w){case null:break;case"Point":if(!1===t(l,d,y,v,b))return!1;d++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],d,y,v,b))return!1;d++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(i=0;i<l[n].length-h;i++){if(!1===t(l[n][i],d,y,v,b))return!1;d++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(b=0,i=0;i<l[n].length;i++){for(o=0;o<l[n][i].length-h;o++){if(!1===t(l[n][i][o],d,y,v,b))return!1;d++}b++}v++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===coordEach(a.geometries[n],t))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function clone(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return cloneFeature(e);case"FeatureCollection":return cloneFeatureCollection(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cloneGeometry(e);default:throw new Error("unknown GeoJSON type")}}function cloneFeature(e){const t={type:"Feature"};return Object.keys(e).forEach((r=>{switch(r){case"type":case"properties":case"geometry":return;default:t[r]=e[r]}})),t.properties=cloneProperties(e.properties),null==e.geometry?t.geometry=null:t.geometry=cloneGeometry(e.geometry),t}function cloneProperties(e){const t={};return e?(Object.keys(e).forEach((r=>{const n=e[r];"object"==typeof n?null===n?t[r]=null:Array.isArray(n)?t[r]=n.map((e=>e)):t[r]=cloneProperties(n):t[r]=n})),t):t}function cloneFeatureCollection(e){const t={type:"FeatureCollection"};return Object.keys(e).forEach((r=>{switch(r){case"type":case"features":return;default:t[r]=e[r]}})),t.features=e.features.map((e=>cloneFeature(e))),t}function cloneGeometry(e){const t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((e=>cloneGeometry(e))),t):(t.coordinates=deepSlice(e.coordinates),t)}function deepSlice(e){const t=e;return"object"!=typeof t[0]?t.slice():t.map((e=>deepSlice(e)))}function toMercator(e,t={}){return convert(e,"mercator",t)}function toWgs84(e,t={}){return convert(e,"wgs84",t)}function convert(e,t,r={}){var n=(r=r||{}).mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&isNumber(e[0])?e="mercator"===t?convertToMercator(e):convertToWgs84(e):(!0!==n&&(e=clone(e)),coordEach(e,(function(e){var r="mercator"===t?convertToMercator(e):convertToWgs84(e);e[0]=r[0],e[1]=r[1]}))),e}function convertToMercator(e){var t=Math.PI/180,r=6378137,n=20037508.342789244,i=[r*(Math.abs(e[0])<=180?e[0]:e[0]-360*sign(e[0]))*t,r*Math.log(Math.tan(.25*Math.PI+.5*e[1]*t))];return i[0]>n&&(i[0]=n),i[0]<-n&&(i[0]=-n),i[1]>n&&(i[1]=n),i[1]<-n&&(i[1]=-n),i}function convertToWgs84(e){var t=180/Math.PI,r=6378137;return[e[0]*t/r,(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/r)))*t]}function sign(e){return e<0?-1:e>0?1:0}function createMidpoint(e,t,r){const n=t.geometry.coordinates,i=r.geometry.coordinates;if(n[1]>LAT_RENDERED_MAX$1||n[1]<LAT_RENDERED_MIN$1||i[1]>LAT_RENDERED_MAX$1||i[1]<LAT_RENDERED_MIN$1)return null;const o=toMercator(n),a=toMercator(i),s=e=>Number(e.toFixed(8)),l=(e,t)=>(e+t)/2,c=toWgs84([l(o[0],a[0]),l(o[1],a[1])]),u=[s(c[0]),s(c[1])];return{type:geojsonTypes.FEATURE,properties:{meta:meta.MIDPOINT,parent:e,lng:u[0],lat:u[1],coord_path:r.properties.coord_path},geometry:{type:geojsonTypes.POINT,coordinates:u}}}function createSupplementaryPoints(e,t={},r=null){const{type:n,coordinates:i}=e.geometry,o=e.properties&&e.properties.id;let a=[];function s(e,r){let n="",i=null;e.forEach(((e,s)=>{const c=null!=r?`${r}.${s}`:String(s),u=createVertex(o,e,c,l(c));if(t.midpoints&&i){const e=createMidpoint(o,i,u);e&&a.push(e)}i=u;const h=JSON.stringify(e);n!==h&&a.push(u),0===s&&(n=h)}))}function l(e){return!!t.selectedPaths&&-1!==t.selectedPaths.indexOf(e)}return n===geojsonTypes.POINT?a.push(createVertex(o,i,r,l(r))):n===geojsonTypes.POLYGON?i.forEach(((e,t)=>{s(e,null!==r?`${r}.${t}`:String(t))})):n===geojsonTypes.LINE_STRING?s(i,r):0===n.indexOf(geojsonTypes.MULTI_PREFIX)&&function(){const r=n.replace(geojsonTypes.MULTI_PREFIX,"");i.forEach(((n,i)=>{const o={type:geojsonTypes.FEATURE,properties:e.properties,geometry:{type:r,coordinates:n}};a=a.concat(createSupplementaryPoints(o,t,i))}))}(),a}Point.prototype={clone(){return new Point(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround(e,t){const r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Point},Point.convert=function(e){if(e instanceof Point)return e;if(Array.isArray(e))return new Point(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new Point(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};const doubleClickZoom={enable(e){setTimeout((()=>{e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()}),0)},disable(e){setTimeout((()=>{e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()}),0)}},{LAT_MIN:LAT_MIN,LAT_MAX:LAT_MAX,LAT_RENDERED_MIN:LAT_RENDERED_MIN,LAT_RENDERED_MAX:LAT_RENDERED_MAX,LNG_MIN:LNG_MIN,LNG_MAX:LNG_MAX}=Constants;function extent(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],r=[e.geometry.coordinates].flat(t),n=r.map((e=>e[0])),i=r.map((e=>e[1])),o=e=>Math.min.apply(null,e),a=e=>Math.max.apply(null,e);return[o(n),o(i),a(n),a(i)]}function constrainFeatureMovement(e,t){let r=LAT_MIN,n=LAT_MAX,i=LAT_MIN,o=LAT_MAX,a=LNG_MAX,s=LNG_MIN;e.forEach((e=>{const t=extent(e),l=t[1],c=t[3],u=t[0],h=t[2];l>r&&(r=l),c<n&&(n=c),c>i&&(i=c),l<o&&(o=l),u<a&&(a=u),h>s&&(s=h)}));const l=t;return r+l.lat>LAT_RENDERED_MAX&&(l.lat=LAT_RENDERED_MAX-r),i+l.lat>LAT_MAX&&(l.lat=LAT_MAX-i),n+l.lat<LAT_RENDERED_MIN&&(l.lat=LAT_RENDERED_MIN-n),o+l.lat<LAT_MIN&&(l.lat=LAT_MIN-o),a+l.lng<=LNG_MIN&&(l.lng+=360*Math.ceil(Math.abs(l.lng)/360)),s+l.lng>=LNG_MAX&&(l.lng-=360*Math.ceil(Math.abs(l.lng)/360)),l}function moveFeatures(e,t){const r=constrainFeatureMovement(e.map((e=>e.toGeoJSON())),t);e.forEach((e=>{const t=e.getCoordinates(),n=e=>{const t={lng:e[0]+r.lng,lat:e[1]+r.lat};return[t.lng,t.lat]},i=e=>e.map((e=>n(e))),o=e=>e.map((e=>i(e)));let a;e.type===geojsonTypes.POINT?a=n(t):e.type===geojsonTypes.LINE_STRING||e.type===geojsonTypes.MULTI_POINT?a=t.map(n):e.type===geojsonTypes.POLYGON||e.type===geojsonTypes.MULTI_LINE_STRING?a=t.map(i):e.type===geojsonTypes.MULTI_POLYGON&&(a=t.map(o)),e.incomingCoords(a)}))}const SimpleSelect={onSetup:function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter((e=>void 0!==this.getFeature(e)))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t},fireUpdate:function(){this.fire(events$1.UPDATE,{action:updateActions.MOVE,features:this.getSelected().map((e=>e.toGeoJSON()))})},fireActionable:function(){const e=this.getSelected(),t=e.filter((e=>this.isInstanceOf("MultiFeature",e)));let r=!1;if(e.length>1){r=!0;const t=e[0].type.replace("Multi","");e.forEach((e=>{e.type.replace("Multi","")!==t&&(r=!1)}))}const n=t.length>0,i=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:i})},getUniqueIds:function(e){if(!e.length)return[];return e.map((e=>e.properties.id)).filter((e=>void 0!==e)).reduce(((e,t)=>(e.add(t),e)),new StringSet).values()},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){doubleClickZoom.enable(this)},onMouseMove:function(e,t){return isFeature(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0},onMouseOut:function(e){return!e.dragMoving||this.fireUpdate()}};SimpleSelect.onTap=SimpleSelect.onClick=function(e,t){return noTarget(t)?this.clickAnywhere(e,t):isOfMetaType(meta.VERTEX)(t)?this.clickOnVertex(e,t):isFeature(t)?this.clickOnFeature(e,t):void 0},SimpleSelect.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach((e=>this.doRender(e)))),doubleClickZoom.enable(this),this.stopExtendedInteractions(e)},SimpleSelect.clickOnVertex=function(e,t){this.changeMode(modes$1.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:cursors.MOVE})},SimpleSelect.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},SimpleSelect.clickOnFeature=function(e,t){doubleClickZoom.disable(this),this.stopExtendedInteractions(e);const r=isShiftDown(t),n=this.getSelectedIds(),i=t.featureTarget.properties.id,o=this.isSelected(i);if(!r&&o&&this.getFeature(i).type!==geojsonTypes.POINT)return this.changeMode(modes$1.DIRECT_SELECT,{featureId:i});o&&r?(this.deselect(i),this.updateUIClasses({mouse:cursors.POINTER}),1===n.length&&doubleClickZoom.enable(this)):!o&&r?(this.select(i),this.updateUIClasses({mouse:cursors.MOVE})):o||r||(n.forEach((e=>this.doRender(e))),this.setSelected(i),this.updateUIClasses({mouse:cursors.MOVE})),this.doRender(i)},SimpleSelect.onMouseDown=function(e,t){return e.initialDragPanState=this.map.dragPan.isEnabled(),isActiveFeature(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&isShiftMousedown(t)?this.startBoxSelect(e,t):void 0},SimpleSelect.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=mouseEventPoint(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},SimpleSelect.onTouchStart=function(e,t){if(isActiveFeature(t))return this.startOnActiveFeature(e,t)},SimpleSelect.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},SimpleSelect.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=mouseEventPoint(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),i=Math.max(e.boxSelectStartLocation.x,r.x),o=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),s=`translate(${n}px, ${o}px)`;e.boxSelectElement.style.transform=s,e.boxSelectElement.style.WebkitTransform=s,e.boxSelectElement.style.width=i-n+"px",e.boxSelectElement.style.height=a-o+"px"},SimpleSelect.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};moveFeatures(this.getSelected(),r),e.dragMoveLocation=t.lngLat},SimpleSelect.onTouchEnd=SimpleSelect.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,mouseEventPoint(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),i=this.getUniqueIds(n).filter((e=>!this.isSelected(e)));i.length&&(this.select(i),i.forEach((e=>this.doRender(e))),this.updateUIClasses({mouse:cursors.MOVE}))}this.stopExtendedInteractions(e)},SimpleSelect.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?activeStates.ACTIVE:activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active===activeStates.ACTIVE&&t.geometry.type!==geojsonTypes.POINT&&createSupplementaryPoints(t).forEach(r)},SimpleSelect.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},SimpleSelect.onCombineFeatures=function(){const e=this.getSelected();if(0===e.length||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let i=0;i<e.length;i++){const o=e[i];if(o.type.replace("Multi","")!==n)return;o.type.includes("Multi")?o.getCoordinates().forEach((e=>{t.push(e)})):t.push(o.getCoordinates()),r.push(o.toGeoJSON())}if(r.length>1){const e=this.newFeature({type:geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(e),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([e.id]),this.fire(events$1.COMBINE_FEATURES,{createdFeatures:[e.toGeoJSON()],deletedFeatures:r})}this.fireActionable()},SimpleSelect.onUncombineFeatures=function(){const e=this.getSelected();if(0===e.length)return;const t=[],r=[];for(let n=0;n<e.length;n++){const i=e[n];this.isInstanceOf("MultiFeature",i)&&(i.getFeatures().forEach((e=>{this.addFeature(e),e.properties=i.properties,t.push(e.toGeoJSON()),this.select([e.id])})),this.deleteFeature(i.id,{silent:!0}),r.push(i.toGeoJSON()))}t.length>1&&this.fire(events$1.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};const isVertex=isOfMetaType(meta.VERTEX),isMidpoint=isOfMetaType(meta.MIDPOINT),DirectSelect={fireUpdate:function(){this.fire(events$1.UPDATE,{action:updateActions.CHANGE_COORDINATES,features:this.getSelected().map((e=>e.toGeoJSON()))})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){null==e.initialDragPanState&&(e.initialDragPanState=this.map.dragPan.isEnabled()),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){e.canDragMove&&!0===e.initialDragPanState&&this.map.dragPan.enable(),e.initialDragPanState=null,e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);isShiftDown(t)||-1!==n?isShiftDown(t)&&-1===n&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];const i=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(i)},onMidpoint:function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map((t=>({feature_id:e,coord_path:t})))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){moveFeatures(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){const n=e.selectedCoordPaths.map((t=>e.feature.getCoordinate(t))),i=constrainFeatureMovement(n.map((e=>({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.POINT,coordinates:e}}))),r);for(let o=0;o<n.length;o++){const t=n[o];e.feature.updateCoordinate(e.selectedCoordPaths[o],t[0]+i.lng,t[1]+i.lat)}},clickNoTarget:function(){this.changeMode(modes$1.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(modes$1.SIMPLE_SELECT)},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),doubleClickZoom.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){doubleClickZoom.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=activeStates.ACTIVE,r(t),createSupplementaryPoints(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=activeStates.INACTIVE,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort(((e,t)=>t.localeCompare(e,"en",{numeric:!0}))).forEach((t=>e.feature.removeCoordinate(t))),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode(modes$1.SIMPLE_SELECT,{}))},onMouseMove:function(e,t){const r=isActiveFeature(t),n=isVertex(t),i=isMidpoint(t),o=0===e.selectedCoordPaths.length;r&&o||n&&!o?this.updateUIClasses({mouse:cursors.MOVE}):this.updateUIClasses({mouse:cursors.NONE});return(n||r||i)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0},onMouseOut:function(e){return e.dragMoving&&this.fireUpdate(),!0}};DirectSelect.onTouchStart=DirectSelect.onMouseDown=function(e,t){return isVertex(t)?this.onVertex(e,t):isActiveFeature(t)?this.onFeature(e,t):isMidpoint(t)?this.onMidpoint(e,t):void 0},DirectSelect.onDrag=function(e,t){if(!0!==e.canDragMove)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat},DirectSelect.onClick=function(e,t){return noTarget(t)?this.clickNoTarget(e,t):isActiveFeature(t)?this.clickActiveFeature(e,t):isInactiveFeature(t)?this.clickInactive(e,t):void this.stopDragging(e)},DirectSelect.onTap=function(e,t){return noTarget(t)?this.clickNoTarget(e,t):isActiveFeature(t)?this.clickActiveFeature(e,t):isInactiveFeature(t)?this.clickInactive(e,t):void 0},DirectSelect.onTouchEnd=DirectSelect.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const DrawPoint={};function isEventAtCoordinates(e,t){return!!e.lngLat&&(e.lngLat.lng===t[0]&&e.lngLat.lat===t[1])}DrawPoint.onSetup=function(){const e=this.newFeature({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:cursors.ADD}),this.activateUIButton(types.POINT),this.setActionableState({trash:!0}),{point:e}},DrawPoint.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT)},DrawPoint.onTap=DrawPoint.onClick=function(e,t){this.updateUIClasses({mouse:cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(events$1.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.point.id]})},DrawPoint.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},DrawPoint.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?activeStates.ACTIVE:activeStates.INACTIVE,!n)return r(t)},DrawPoint.onTrash=DrawPoint.stopDrawingAndRemove,DrawPoint.onKeyUp=function(e,t){if(isEscapeKey(t)||isEnterKey(t))return this.stopDrawingAndRemove(e,t)};const DrawPolygon={onSetup:function(){const e=this.newFeature({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),doubleClickZoom.disable(this),this.updateUIClasses({mouse:cursors.ADD}),this.activateUIButton(types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&isEventAtCoordinates(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),isVertex$1(t)&&this.updateUIClasses({mouse:cursors.POINTER})}};DrawPolygon.onTap=DrawPolygon.onClick=function(e,t){return isVertex$1(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},DrawPolygon.onKeyUp=function(e,t){isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT)):isEnterKey(t)&&this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},DrawPolygon.onStop=function(e){this.updateUIClasses({mouse:cursors.NONE}),doubleClickZoom.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(events$1.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT,{},{silent:!0})))},DrawPolygon.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?activeStates.ACTIVE:activeStates.INACTIVE,!n)return r(t);if(0===t.geometry.coordinates.length)return;const i=t.geometry.coordinates[0].length;if(!(i<3)){if(t.properties.meta=meta.FEATURE,r(createVertex(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),i>3){const n=t.geometry.coordinates[0].length-3;r(createVertex(e.polygon.id,t.geometry.coordinates[0][n],`0.${n}`,!1))}if(i<=4){const e=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:e,type:geojsonTypes.LINE_STRING}}),3===i)return}return r(t)}},DrawPolygon.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT)};const DrawLineString={onSetup:function(e){const t=(e=e||{}).featureId;let r,n,i="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let o=e.from;if(o&&"Feature"===o.type&&o.geometry&&"Point"===o.geometry.type&&(o=o.geometry),o&&"Point"===o.type&&o.coordinates&&2===o.coordinates.length&&(o=o.coordinates),!o||!Array.isArray(o))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===o[0]&&r.coordinates[a][1]===o[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else{if(r.coordinates[0][0]!==o[0]||r.coordinates[0][1]!==o[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");i="backwards",n=0,r.addCoordinate(n,...r.coordinates[0])}}else r=this.newFeature({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),doubleClickZoom.disable(this),this.updateUIClasses({mouse:cursors.ADD}),this.activateUIButton(types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:i}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&isEventAtCoordinates(t,e.line.coordinates[e.currentVertexPosition-1])||"backwards"===e.direction&&isEventAtCoordinates(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),"forward"===e.direction?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.line.id]})},onMouseMove:function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),isVertex$1(t)&&this.updateUIClasses({mouse:cursors.POINTER})}};DrawLineString.onTap=DrawLineString.onClick=function(e,t){if(isVertex$1(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},DrawLineString.onKeyUp=function(e,t){isEnterKey(t)?this.changeMode(modes$1.SIMPLE_SELECT,{featureIds:[e.line.id]}):isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT))},DrawLineString.onStop=function(e){doubleClickZoom.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.line.id)&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(events$1.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT,{},{silent:!0})))},DrawLineString.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(modes$1.SIMPLE_SELECT)},DrawLineString.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?activeStates.ACTIVE:activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=meta.FEATURE,r(createVertex(e.line.id,t.geometry.coordinates["forward"===e.direction?t.geometry.coordinates.length-2:1],""+("forward"===e.direction?t.geometry.coordinates.length-2:1),!1)),r(t))};const modes={simple_select:SimpleSelect,direct_select:DirectSelect,draw_point:DrawPoint,draw_polygon:DrawPolygon,draw_line_string:DrawLineString},defaultOptions={defaultMode:modes$1.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:styles,modes:modes,controls:{},userProperties:!1,suppressAPIEvents:!0},showControls={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},hideControls={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function addSources(e,t){return e.map((e=>e.source?e:Object.assign({},e,{id:`${e.id}.${t}`,source:"hot"===t?sources.HOT:sources.COLD})))}function setupOptions(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),!1===e.displayControlsDefault?t.controls=Object.assign({},hideControls,e.controls):t.controls=Object.assign({},showControls,e.controls),t=Object.assign({},defaultOptions,t),t.styles=addSources(t.styles,"cold").concat(addSources(t.styles,"hot")),t}var fastDeepEqual,hasRequiredFastDeepEqual;function requireFastDeepEqual(){return hasRequiredFastDeepEqual?fastDeepEqual:(hasRequiredFastDeepEqual=1,fastDeepEqual=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var a=o[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r})}var fastDeepEqualExports=requireFastDeepEqual();const isEqual=getDefaultExportFromCjs$1(fastDeepEqualExports);var geojsonNormalize,hasRequiredGeojsonNormalize;function requireGeojsonNormalize(){if(hasRequiredGeojsonNormalize)return geojsonNormalize;hasRequiredGeojsonNormalize=1,geojsonNormalize=function(t){if(!t||!t.type)return null;var r=e[t.type];if(!r)return null;if("geometry"===r)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===r)return{type:"FeatureCollection",features:[t]};if("featurecollection"===r)return t};var e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};return geojsonNormalize}var geojsonNormalizeExports=requireGeojsonNormalize();const normalize$1=getDefaultExportFromCjs$1(geojsonNormalizeExports);function stringSetsAreEqual(e,t){return e.length===t.length&&JSON.stringify(e.map((e=>e)).sort())===JSON.stringify(t.map((e=>e)).sort())}const featureTypes={Polygon:Polygon,LineString:LineString,Point:Point$1,MultiPolygon:MultiFeature,MultiLineString:MultiFeature,MultiPoint:MultiFeature};function setupAPI(e,t){t.modes=modes$1;const r=void 0===e.options.suppressAPIEvents||!!e.options.suppressAPIEvents;return t.getFeatureIdsAt=function(t){return featuresAt.click({point:t},null,e).map((e=>e.properties.id))},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map((t=>e.store.get(t))).map((e=>e.toGeoJSON()))}},t.getSelectedPoints=function(){return{type:geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map((e=>({type:geojsonTypes.FEATURE,properties:{},geometry:{type:geojsonTypes.POINT,coordinates:e.coordinates}})))}},t.set=function(r){if(void 0===r.type||r.type!==geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let i=e.store.getAllIds().slice();const o=t.add(r),a=new StringSet(o);return i=i.filter((e=>!a.has(e))),i.length&&t.delete(i),n(),o},t.add=function(t){const n=JSON.parse(JSON.stringify(normalize$1(t))).features.map((t=>{if(t.id=t.id||generateID(),null===t.geometry)throw new Error("Invalid geometry: null");if(void 0===e.store.get(t.id)||e.store.get(t.id).type!==t.geometry.type){const n=featureTypes[t.geometry.type];if(void 0===n)throw new Error(`Invalid geometry type: ${t.geometry.type}.`);const i=new n(e,t);e.store.add(i,{silent:r})}else{const n=e.store.get(t.id),i=n.properties;n.properties=t.properties,isEqual(i,t.properties)||e.store.featureChanged(n.id,{silent:r}),isEqual(n.getCoordinates(),t.geometry.coordinates)||n.incomingCoords(t.geometry.coordinates)}return t.id}));return e.store.render(),n},t.get=function(t){const r=e.store.get(t);if(r)return r.toGeoJSON()},t.getAll=function(){return{type:geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map((e=>e.toGeoJSON()))}},t.delete=function(n){return e.store.delete(n,{silent:r}),t.getMode()!==modes$1.DIRECT_SELECT||e.store.getSelectedIds().length?e.store.render():e.events.changeMode(modes$1.SIMPLE_SELECT,void 0,{silent:r}),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:r}),t.getMode()===modes$1.DIRECT_SELECT?e.events.changeMode(modes$1.SIMPLE_SELECT,void 0,{silent:r}):e.store.render(),t},t.changeMode=function(n,i={}){return n===modes$1.SIMPLE_SELECT&&t.getMode()===modes$1.SIMPLE_SELECT?(stringSetsAreEqual(i.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(i.featureIds,{silent:r}),e.store.render()),t):(n===modes$1.DIRECT_SELECT&&t.getMode()===modes$1.DIRECT_SELECT&&i.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(n,i,{silent:r}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:r}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:r}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:r}),t},t.setFeatureProperty=function(n,i,o){return e.store.setFeatureProperty(n,i,o,{silent:r}),t},t}const lib$2=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:common_selectors,ModeHandler:ModeHandler,StringSet:StringSet,constrainFeatureMovement:constrainFeatureMovement,createMidPoint:createMidpoint,createSupplementaryPoints:createSupplementaryPoints,createVertex:createVertex,doubleClickZoom:doubleClickZoom,euclideanDistance:euclideanDistance,featuresAt:featuresAt,getFeatureAtAndSetCursors:getFeatureAtAndSetCursors,isClick:isClick,isEventAtCoordinates:isEventAtCoordinates,isTap:isTap,mapEventToBoundingBox:mapEventToBoundingBox,moveFeatures:moveFeatures,sortFeatures:sortFeatures,stringSetsAreEqual:stringSetsAreEqual,theme:styles,toDenseArray:toDenseArray},Symbol.toStringTag,{value:"Module"})),setupDraw=function(e,t){const r={options:e=setupOptions(e)};t=setupAPI(r,t),r.api=t;const n=runSetup(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=types,t.options=e,t};function MapboxDraw(e){setupDraw(e,this)}function quickselect(e,t,r=0,n=e.length-1,i=defaultCompare){for(;n>r;){if(n-r>600){const o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);quickselect(e,t,Math.max(r,Math.floor(t-a*l/o+c)),Math.min(n,Math.floor(t+(o-a)*l/o+c)),i)}const o=e[t];let a=r,s=n;for(swap(e,r,t),i(e[n],o)>0&&swap(e,r,n);a<s;){for(swap(e,a,s),a++,s--;i(e[a],o)<0;)a++;for(;i(e[s],o)>0;)s--}0===i(e[r],o)?swap(e,r,s):(s++,swap(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}}function swap(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function defaultCompare(e,t){return e<t?-1:e>t?1:0}MapboxDraw.modes=modes,MapboxDraw.constants=Constants,MapboxDraw.lib=lib$2;let RBush$1=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!intersects(e,t))return r;const n=this.toBBox,i=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],s=t.leaf?n(a):a;intersects(e,s)&&(t.leaf?r.push(a):contains(e,s)?this._all(a,r):i.push(a))}t=i.pop()}return r}collides(e){let t=this.data;if(!intersects(e,t))return!1;const r=[];for(;t;){for(let n=0;n<t.children.length;n++){const i=t.children[n],o=t.leaf?this.toBBox(i):i;if(intersects(e,o)){if(t.leaf||contains(e,o))return!0;r.push(i)}}t=r.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=createNode([]),this}remove(e,t){if(!e)return this;let r=this.data;const n=this.toBBox(e),i=[],o=[];let a,s,l;for(;r||i.length;){if(r||(r=i.pop(),s=i[i.length-1],a=o.pop(),l=!0),r.leaf){const n=findItem(e,r.children,t);if(-1!==n)return r.children.splice(n,1),i.push(r),this._condense(i),this}l||r.leaf||!contains(r,n)?s?(a++,r=s.children[a],l=!1):r=null:(i.push(r),o.push(a),a=0,s=r,r=r.children[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,n){const i=r-t+1;let o,a=this._maxEntries;if(i<=a)return o=createNode(e.slice(t,r+1)),calcBBox(o,this.toBBox),o;n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1))),o=createNode([]),o.leaf=!1,o.height=n;const s=Math.ceil(i/a),l=s*Math.ceil(Math.sqrt(a));multiSelect(e,t,r,l,this.compareMinX);for(let c=t;c<=r;c+=l){const t=Math.min(c+l-1,r);multiSelect(e,c,t,s,this.compareMinY);for(let r=c;r<=t;r+=s){const i=Math.min(r+s-1,t);o.children.push(this._build(e,r,i,n-1))}}return calcBBox(o,this.toBBox),o}_chooseSubtree(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){let r,n=1/0,i=1/0;for(let o=0;o<t.children.length;o++){const a=t.children[o],s=bboxArea(a),l=enlargedArea(e,a)-s;l<i?(i=l,n=s<n?s:n,r=a):l===i&&s<n&&(n=s,r=a)}t=r||t.children[0]}return t}_insert(e,t,r){const n=r?e:this.toBBox(e),i=[],o=this._chooseSubtree(n,this.data,t,i);for(o.children.push(e),extend(o,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)}_split(e,t){const r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);const o=this._chooseSplitIndex(r,i,n),a=createNode(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,calcBBox(r,this.toBBox),calcBBox(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this.data=createNode([e,t]),this.data.height=e.height+1,this.data.leaf=!1,calcBBox(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let n,i=1/0,o=1/0;for(let a=t;a<=r-t;a++){const t=distBBox(e,0,a,this.toBBox),s=distBBox(e,a,r,this.toBBox),l=intersectionArea(t,s),c=bboxArea(t)+bboxArea(s);l<i?(i=l,n=a,o=c<o?c:o):l===i&&c<o&&(o=c,n=a)}return n||r-t}_chooseSplitAxis(e,t,r){const n=e.leaf?this.compareMinX:compareNodeMinX,i=e.leaf?this.compareMinY:compareNodeMinY;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);const i=this.toBBox,o=distBBox(e,0,t,i),a=distBBox(e,r-t,r,i);let s=bboxMargin(o)+bboxMargin(a);for(let l=t;l<r-t;l++){const t=e.children[l];extend(o,e.leaf?i(t):t),s+=bboxMargin(o)}for(let l=r-t-1;l>=t;l--){const t=e.children[l];extend(a,e.leaf?i(t):t),s+=bboxMargin(a)}return s}_adjustParentBBoxes(e,t,r){for(let n=r;n>=0;n--)extend(t[n],e)}_condense(e){for(let t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children,t.splice(t.indexOf(e[r]),1)):this.clear():calcBBox(e[r],this.toBBox)}};function findItem(e,t,r){if(!r)return t.indexOf(e);for(let n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function calcBBox(e,t){distBBox(e,0,e.children.length,t,e)}function distBBox(e,t,r,n,i){i||(i=createNode(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;o<r;o++){const t=e.children[o];extend(i,e.leaf?n(t):t)}return i}function extend(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function compareNodeMinX(e,t){return e.minX-t.minX}function compareNodeMinY(e,t){return e.minY-t.minY}function bboxArea(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function bboxMargin(e){return e.maxX-e.minX+(e.maxY-e.minY)}function enlargedArea(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function intersectionArea(e,t){const r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,o-n)}function contains(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function intersects(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function createNode(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function multiSelect(e,t,r,n,i){const o=[t,r];for(;o.length;){if((r=o.pop())-(t=o.pop())<=n)continue;const a=t+Math.ceil((r-t)/n/2)*n;quickselect(e,a,t,r,i),o.push(t,a,a,r)}}var punycode$1={exports:{}},punycode=punycode$1.exports,hasRequiredPunycode;
/*! https://mths.be/punycode v1.4.1 by @mathias */function requirePunycode(){return hasRequiredPunycode||(hasRequiredPunycode=1,e=punycode$1,t=punycode$1.exports,function(r){var n=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,o="object"==typeof commonjsGlobal&&commonjsGlobal;o.global!==o&&o.window!==o&&o.self!==o||(r=o);var a,s,l=2147483647,c=36,u=/^xn--/,h=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function g(e){throw new RangeError(p[e])}function y(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function _(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+y((e=e.replace(d,".")).split("."),t).join(".")}function v(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function b(e){return y(e,(function(e){var t="";return e>65535&&(t+=m((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=m(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function x(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=c)e=f(e/35);return f(n+36*e/(e+38))}function S(e){var t,r,n,i,o,a,s,u,h,d,p,m=[],y=e.length,_=0,v=128,w=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&g("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<y;){for(o=_,a=1,s=c;i>=y&&g("invalid-input"),((u=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:c)>=c||u>f((l-_)/a))&&g("overflow"),_+=u*a,!(u<(h=s<=w?1:s>=w+26?26:s-w));s+=c)a>f(l/(d=c-h))&&g("overflow"),a*=d;w=x(_-o,t=m.length+1,0==o),f(_/t)>l-v&&g("overflow"),v+=f(_/t),_%=t,m.splice(_++,0,v)}return b(m)}function E(e){var t,r,n,i,o,a,s,u,h,d,p,y,_,b,S,E=[];for(y=(e=v(e)).length,t=128,r=0,o=72,a=0;a<y;++a)(p=e[a])<128&&E.push(m(p));for(n=i=E.length,i&&E.push("-");n<y;){for(s=l,a=0;a<y;++a)(p=e[a])>=t&&p<s&&(s=p);for(s-t>f((l-r)/(_=n+1))&&g("overflow"),r+=(s-t)*_,t=s,a=0;a<y;++a)if((p=e[a])<t&&++r>l&&g("overflow"),p==t){for(u=r,h=c;!(u<(d=h<=o?1:h>=o+26?26:h-o));h+=c)S=u-d,b=c-d,E.push(m(w(d+S%b,0))),u=f(S/b);E.push(m(w(u,0))),o=x(r,_,n==i),r=0,++n}++r,++t}return E.join("")}if(a={version:"1.4.1",ucs2:{decode:v,encode:b},decode:S,encode:E,toASCII:function(e){return _(e,(function(e){return h.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return _(e,(function(e){return u.test(e)?S(e.slice(4).toLowerCase()):e}))}},n&&i)if(e.exports==n)i.exports=a;else for(s in a)a.hasOwnProperty(s)&&(n[s]=a[s]);else r.punycode=a}(punycode)),punycode$1.exports;var e,t}var empty$1=null;const empty$2=Object.freeze(Object.defineProperty({__proto__:null,default:empty$1},Symbol.toStringTag,{value:"Module"}));function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var mapshaper={exports:{}};const require$$8=getAugmentedNamespace(empty$2);var pathBrowserify,hasRequiredPathBrowserify;function requirePathBrowserify(){if(hasRequiredPathBrowserify)return pathBrowserify;function e(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function t(e,t){for(var r,n="",i=0,o=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)r=e.charCodeAt(s);else{if(47===r)break;r=47}if(47===r){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",i=0):i=(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),o=s,a=0;continue}}else if(2===n.length||1===n.length){n="",i=0,o=s,a=0;continue}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(o+1,s):n=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===r&&-1!==a?++a:a=-1}return n}hasRequiredPathBrowserify=1;var r={resolve:function(){for(var r,n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a;o>=0?a=arguments[o]:(void 0===r&&(r=process$1.cwd()),a=r),e(a),0!==a.length&&(n=a+"/"+n,i=47===a.charCodeAt(0))}return n=t(n,!i),i?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(r){if(e(r),0===r.length)return".";var n=47===r.charCodeAt(0),i=47===r.charCodeAt(r.length-1);return 0!==(r=t(r,!n)).length||n||(r="."),r.length>0&&i&&(r+="/"),n?"/"+r:r},isAbsolute:function(t){return e(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,n=0;n<arguments.length;++n){var i=arguments[n];e(i),i.length>0&&(void 0===t?t=i:t+="/"+i)}return void 0===t?".":r.normalize(t)},relative:function(t,n){if(e(t),e(n),t===n)return"";if((t=r.resolve(t))===(n=r.resolve(n)))return"";for(var i=1;i<t.length&&47===t.charCodeAt(i);++i);for(var o=t.length,a=o-i,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var l=n.length-s,c=a<l?a:l,u=-1,h=0;h<=c;++h){if(h===c){if(l>c){if(47===n.charCodeAt(s+h))return n.slice(s+h+1);if(0===h)return n.slice(s+h)}else a>c&&(47===t.charCodeAt(i+h)?u=h:0===h&&(u=0));break}var d=t.charCodeAt(i+h);if(d!==n.charCodeAt(s+h))break;47===d&&(u=h)}var p="";for(h=i+u+1;h<=o;++h)h!==o&&47!==t.charCodeAt(h)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(s+u):(s+=u,47===n.charCodeAt(s)&&++s,n.slice(s))},_makeLong:function(e){return e},dirname:function(t){if(e(t),0===t.length)return".";for(var r=t.charCodeAt(0),n=47===r,i=-1,o=!0,a=t.length-1;a>=1;--a)if(47===(r=t.charCodeAt(a))){if(!o){i=a;break}}else o=!1;return-1===i?n?"/":".":n&&1===i?"//":t.slice(0,i)},basename:function(t,r){if(void 0!==r&&"string"!=typeof r)throw new TypeError('"ext" argument must be a string');e(t);var n,i=0,o=-1,a=!0;if(void 0!==r&&r.length>0&&r.length<=t.length){if(r.length===t.length&&r===t)return"";var s=r.length-1,l=-1;for(n=t.length-1;n>=0;--n){var c=t.charCodeAt(n);if(47===c){if(!a){i=n+1;break}}else-1===l&&(a=!1,l=n+1),s>=0&&(c===r.charCodeAt(s)?-1==--s&&(o=n):(s=-1,o=l))}return i===o?o=l:-1===o&&(o=t.length),t.slice(i,o)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!a){i=n+1;break}}else-1===o&&(a=!1,o=n+1);return-1===o?"":t.slice(i,o)},extname:function(t){e(t);for(var r=-1,n=0,i=-1,o=!0,a=0,s=t.length-1;s>=0;--s){var l=t.charCodeAt(s);if(47!==l)-1===i&&(o=!1,i=s+1),46===l?-1===r?r=s:1!==a&&(a=1):-1!==r&&(a=-1);else if(!o){n=s+1;break}}return-1===r||-1===i||0===a||1===a&&r===i-1&&r===n+1?"":t.slice(r,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+n:r+e+n:n}("/",e)},parse:function(t){e(t);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return r;var n,i=t.charCodeAt(0),o=47===i;o?(r.root="/",n=1):n=0;for(var a=-1,s=0,l=-1,c=!0,u=t.length-1,h=0;u>=n;--u)if(47!==(i=t.charCodeAt(u)))-1===l&&(c=!1,l=u+1),46===i?-1===a?a=u:1!==h&&(h=1):-1!==a&&(h=-1);else if(!c){s=u+1;break}return-1===a||-1===l||0===h||1===h&&a===l-1&&a===s+1?-1!==l&&(r.base=r.name=0===s&&o?t.slice(1,l):t.slice(s,l)):(0===s&&o?(r.name=t.slice(1,a),r.base=t.slice(1,l)):(r.name=t.slice(s,a),r.base=t.slice(s,l)),r.ext=t.slice(a,l)),s>0?r.dir=t.slice(0,s-1):o&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,pathBrowserify=r}var browser={},hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,browser.endianness=function(){return"LE"},browser.hostname=function(){return"undefined"!=typeof location?location.hostname:""},browser.loadavg=function(){return[]},browser.uptime=function(){return 0},browser.freemem=function(){return Number.MAX_VALUE},browser.totalmem=function(){return Number.MAX_VALUE},browser.cpus=function(){return[]},browser.type=function(){return"Browser"},browser.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},browser.networkInterfaces=browser.getNetworkInterfaces=function(){return{}},browser.arch=function(){return"javascript"},browser.platform=function(){return"browser"},browser.tmpdir=browser.tmpDir=function(){return"/tmp"},browser.EOL="\n",browser.homedir=function(){return"/"}),browser}var tokml={},hasRequiredTokml;function requireTokml(){if(hasRequiredTokml)return tokml;hasRequiredTokml=1;const e=function(e,t,r){const n={type:String(e)};return null!=r||"string"!=typeof t&&!Array.isArray(t)?Object.assign(n,t):r=t,Array.isArray(r)?n.children=r:null!=r&&(n.value=String(r)),n},t=/["&'<>`]/g,r=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,i=/[|\\{}()[\]^$+*?.]/g,o=new WeakMap;function a(e,a){return e=e.replace(a.subset?function(e){let t=o.get(e);t||(t=function(e){const t=[];let r=-1;for(;++r<e.length;)t.push(e[r].replace(i,"\\$&"));return new RegExp("(?:"+t.join("|")+")","g")}(e),o.set(e,t));return t}(a.subset):t,s),a.subset||a.escapeOnly?e:e.replace(r,(function(e,t,r){return a.format(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)-56320+65536,r.charCodeAt(t+2),a)})).replace(n,s);function s(e,t,r){return a.format(e.charCodeAt(0),r.charCodeAt(t+1),a)}}function s(e){return"&#x"+e.toString(16).toUpperCase()+";"}const l=/[\u0000-\u0008\u000B\u000C\u000E-\u001F]/g;function c(e,t,r){const n=function(e){return String(e||"").replace(l,"")}(e);return r?n.replace(r,i):i(n);function i(e){return function(e,t){return a(e,Object.assign({format:s},t))}(e,{subset:t})}}const u=["\t","\n"," ",'"',"&","'","/","<","=",">"];function h(e){return c(e,u)}function d(e,t){const r=String(e);if("string"!=typeof t)throw new TypeError("Expected character");let n=0,i=r.indexOf(t);for(;-1!==i;)n++,i=r.indexOf(t,i+t.length);return n}function p(e,t){const r=String(e);let n=t.options.quote||'"';if(t.options.quoteSmart){const e='"'===n?"'":'"';d(r,n)>d(r,e)&&(n=e)}return n+c(r,["<","&",n])+n}const f={}.hasOwnProperty;const m=["&","<"];function g(e){return c(e.value,m)}const y=/\?>/g,_=[">"];const v=/]]>/g,b=[">"];const w={}.hasOwnProperty,x={root:E,element:function(e,t){const r=h(e.name),n=E(e,t),i=e.attributes||{},o=!n&&t.options.closeEmptyElements,a=[];let s;for(s in i)if(f.call(i,s)){const e=i[s];null!=e&&a.push(h(s)+"="+p(e,t))}return"<"+r+(0===a.length?"":" "+a.join(" "))+(o?(t.options.tightClose?"":" ")+"/":"")+">"+n+(o?"":"</"+r+">")},text:g,comment:function(e){return"\x3c!--"+c(e.value,["-"])+"--\x3e"},doctype:function(e,t){const r=h(e.name),n=e.public,i=e.system;let o="<!DOCTYPE";return""!==r&&(o+=" "+r),n?o+=" PUBLIC "+p(n,t):i&&(o+=" SYSTEM"),i&&(o+=" "+p(i,t)),o+">"},instruction:function(e){const t=h(e.name)||"x",r=c(e.value,_,y);return"<?"+t+(r?" "+r:"")+"?>"},cdata:function(e){return"<![CDATA["+c(e.value,b,v)+"]]>"},raw:function(e,t){return t.options.allowDangerousXml?e.value:g(e)}};function S(e,t){const r=e&&e.type;if(!r)throw new Error("Expected node, not `"+e+"`");if(!w.call(x,r))throw new Error("Cannot compile unknown node `"+r+"`");return(0,x[r])(e,t)}function E(e,t){const r=e&&e.children||[];let n=-1;const i=[];for(;++n<r.length;)i[n]=S(r[n],t);return i.join("")}function T(e,t){const r={options:{}};if("string"==typeof r.options.quote&&'"'!==r.options.quote&&"'"!==r.options.quote)throw new Error("Invalid quote `"+r.options.quote+"`, expected `'` or `\"`");return S(Array.isArray(e)?{type:"root",children:e}:e,r)}const A=function(e,t,...r){let n,i=-1;if(null==e)n={type:"root",children:[]},r.unshift(t);else{if("string"!=typeof e)throw new TypeError("Expected element name, got `"+e+"`");if(n={type:"element",name:e,attributes:{},children:[]},function(e){if(null==e||"object"!=typeof e||Array.isArray(e))return!1;return!0}(t)){let e;for(e in t)void 0===t[e]||null===t[e]||"number"==typeof t[e]&&Number.isNaN(t[e])||(n.attributes[e]=String(t[e]))}else r.unshift(t)}for(;++i<r.length;)C(n.children,r[i]);return n};function C(e,t){let r=-1;if(null==t);else if("string"==typeof t||"number"==typeof t)e.push({type:"text",value:String(t)});else if(Array.isArray(t))for(;++r<t.length;)C(e,t[r]);else{if("object"!=typeof t||!("type"in t))throw new TypeError("Expected node, nodes, string, got `"+t+"`");"root"===t.type?C(e,t.children):e.push(t)}}const I=e("text","\n"),k=e("text","  ");function P(e){switch(e.type){case"Feature":return D(e);case"folder":return function(e){const t=["string","number"].includes(typeof e.meta.id)?{id:String(e.meta.id)}:{};return[I,A("Folder",t,[I,...R(e.meta),I,k,...e.children.flatMap((e=>P(e)))])]}(e)}}const M=["address","description","name","open","visibility","phoneNumber"];function R(t){return M.filter((e=>void 0!==t[e])).map((r=>A(r,[e("text",String(t[r]))])))}function D(e){const{id:t}=e,r=["string","number"].includes(typeof t)?{id:t}:{};return[I,A("Placemark",r,[I,...$(e.properties),I,k,...e.geometry?[F(e.geometry)]:[]])]}function O(e){return`${e[0]},${e[1]}`}function L(t){return A("coordinates",[e("text",t.map(O).join("\n"))])}function B(e){switch(typeof e){case"string":return e;case"boolean":case"number":return String(e);case"object":try{return JSON.stringify(e)}catch(e2){return""}}return""}function $(t){if(!t)return[];const{name:r,description:n,visibility:i,...o}=t;return[r&&A("name",[e("text",B(r))]),n&&A("description",[e("text",(a=n,a&&"object"==typeof a&&"@type"in a&&"html"===a["@type"]&&"value"in a&&"string"==typeof a.value?e("cdata",a.value):B(a)))]),void 0!==i&&A("visibility",[e("text",i?"1":"0")]),A("ExtendedData",Object.entries(o).flatMap((([t,r])=>[I,k,A("Data",{name:t},[A("value",[e("text","string"==typeof r?r:JSON.stringify(r))])])])))].filter(Boolean);var a}const z=e=>A("LinearRing",[L(e)]);function F(t){switch(t.type){case"Point":return A("Point",[(r=t.coordinates,A("coordinates",[e("text",O(r))]))]);case"MultiPoint":return function(e){return A("MultiGeometry",e.coordinates.flatMap((e=>[I,F({type:"Point",coordinates:e})])))}(t);case"LineString":return A("LineString",[L(t.coordinates)]);case"MultiLineString":return function(e){return A("MultiGeometry",e.coordinates.flatMap((e=>[I,F({type:"LineString",coordinates:e})])))}(t);case"Polygon":return function(e){const[t,...r]=e.coordinates;return A("Polygon",[I,A("outerBoundaryIs",[I,k,z(t)]),...r.flatMap((e=>[I,A("innerBoundaryIs",[I,k,z(e)])]))])}(t);case"MultiPolygon":return function(e){return A("MultiGeometry",e.coordinates.flatMap((e=>[I,F({type:"Polygon",coordinates:e})])))}(t);case"GeometryCollection":return A("MultiGeometry",t.geometries.flatMap((e=>[I,F(e)])))}var r}return tokml.foldersToKML=function(t){return T(e("root",[A("kml",{xmlns:"http://www.opengis.net/kml/2.2"},A("Document",t.children.flatMap((e=>P(e)))))]))},tokml.toKML=function(t){return T(e("root",[A("kml",{xmlns:"http://www.opengis.net/kml/2.2"},A("Document",t.features.flatMap((e=>D(e)))))]))},tokml}var lib$1={},binding={},assert={exports:{}},errors={},hasRequiredErrors,assertion_error,hasRequiredAssertion_error,isArguments,hasRequiredIsArguments,implementation$3,hasRequiredImplementation$3,objectKeys,hasRequiredObjectKeys,implementation$2,hasRequiredImplementation$2,polyfill$2,hasRequiredPolyfill$2,implementation$1,hasRequiredImplementation$1,polyfill$1,hasRequiredPolyfill$1,callBound,hasRequiredCallBound,defineProperties_1,hasRequiredDefineProperties,shim$1,hasRequiredShim$1,objectIs,hasRequiredObjectIs,implementation,hasRequiredImplementation,polyfill,hasRequiredPolyfill,shim,hasRequiredShim,isNan,hasRequiredIsNan,comparisons,hasRequiredComparisons,hasRequiredAssert,zstream,hasRequiredZstream;function requireErrors(){if(hasRequiredErrors)return errors;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,r)}function r(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e2){return!1}}();return function(){var i,o=n(t);if(r){var a=n(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return function(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(this,i)}}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}hasRequiredErrors=1;var i,o,a={};function s(e,n,i){i||(i=Error);var o=function(i){!function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&t(e,r)}(s,i);var o,a=r(s);function s(t,r,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o=a.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i)),o.code=e,o}return o=s,Object.defineProperty(o,"prototype",{writable:!1}),o}(i);a[e]=o}function l(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}return s("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),s("ERR_INVALID_ARG_TYPE",(function(t,r,n){var o,a,s;if(void 0===i&&(i=requireAssert()),i("string"==typeof t,"'name' must be a string"),"string"==typeof r&&(a="not ",r.substr(0,a.length)===a)?(o="must not be",r=r.replace(/^not /,"")):o="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(t," argument"))s="The ".concat(t," ").concat(o," ").concat(l(r,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(t,".")?"property":"argument";s='The "'.concat(t,'" ').concat(c," ").concat(o," ").concat(l(r,"type"))}return s+=". Received type ".concat(e(n))}),TypeError),s("ERR_INVALID_ARG_VALUE",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===o&&(o=requireUtil$1());var n=o.inspect(t);return n.length>128&&(n="".concat(n.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(r,". Received ").concat(n)}),TypeError),s("ERR_INVALID_RETURN_VALUE",(function(t,r,n){var i;return i=n&&n.constructor&&n.constructor.name?"instance of ".concat(n.constructor.name):"type ".concat(e(n)),"Expected ".concat(t,' to be returned from the "').concat(r,'"')+" function but got ".concat(i,".")}),TypeError),s("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];void 0===i&&(i=requireAssert()),i(t.length>0,"At least one arg needs to be specified");var n="The ",o=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),o){case 1:n+="".concat(t[0]," argument");break;case 2:n+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:n+=t.slice(0,o-1).join(", "),n+=", and ".concat(t[o-1]," arguments")}return"".concat(n," must be specified")}),TypeError),errors.codes=a,errors}function requireAssertion_error(){if(hasRequiredAssertion_error)return assertion_error;function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t,r){return t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===d(t)?t:String(t)}function o(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return l(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},s(e)}function l(e,t,r){return(l=c()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&u(i,r.prototype),i}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e2){return!1}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}hasRequiredAssertion_error=1;var p=requireUtil$1().inspect,f=requireErrors().codes.ERR_INVALID_ARG_TYPE;function m(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}var g="",y="",_="",v="",b={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function w(e){var t=Object.keys(e),r=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){r[t]=e[t]})),Object.defineProperty(r,"message",{value:e.message}),r}function x(e){return p(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function S(e,t,r){var n="",i="",o=0,a="",s=!1,l=x(e),c=l.split("\n"),u=x(t).split("\n"),h=0,p="";if("strictEqual"===r&&"object"===d(e)&&"object"===d(t)&&null!==e&&null!==t&&(r="strictEqualObject"),1===c.length&&1===u.length&&c[0]!==u[0]){var f=c[0].length+u[0].length;if(f<=10){if(!("object"===d(e)&&null!==e||"object"===d(t)&&null!==t||0===e&&0===t))return"".concat(b[r],"\n\n")+"".concat(c[0]," !== ").concat(u[0],"\n")}else if("strictEqualObject"!==r){if(f<(process$1.stderr&&process$1.stderr.isTTY?process$1.stderr.columns:80)){for(;c[0][h]===u[0][h];)h++;h>2&&(p="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var r=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,r-e.length)}(" ",h),"^"),h=0)}}}for(var w=c[c.length-1],S=u[u.length-1];w===S&&(h++<2?a="\n  ".concat(w).concat(a):n=w,c.pop(),u.pop(),0!==c.length&&0!==u.length);)w=c[c.length-1],S=u[u.length-1];var E=Math.max(c.length,u.length);if(0===E){var T=l.split("\n");if(T.length>30)for(T[26]="".concat(g,"...").concat(v);T.length>27;)T.pop();return"".concat(b.notIdentical,"\n\n").concat(T.join("\n"),"\n")}h>3&&(a="\n".concat(g,"...").concat(v).concat(a),s=!0),""!==n&&(a="\n  ".concat(n).concat(a),n="");var A=0,C=b[r]+"\n".concat(y,"+ actual").concat(v," ").concat(_,"- expected").concat(v),I=" ".concat(g,"...").concat(v," Lines skipped");for(h=0;h<E;h++){var k=h-o;if(c.length<h+1)k>1&&h>2&&(k>4?(i+="\n".concat(g,"...").concat(v),s=!0):k>3&&(i+="\n  ".concat(u[h-2]),A++),i+="\n  ".concat(u[h-1]),A++),o=h,n+="\n".concat(_,"-").concat(v," ").concat(u[h]),A++;else if(u.length<h+1)k>1&&h>2&&(k>4?(i+="\n".concat(g,"...").concat(v),s=!0):k>3&&(i+="\n  ".concat(c[h-2]),A++),i+="\n  ".concat(c[h-1]),A++),o=h,i+="\n".concat(y,"+").concat(v," ").concat(c[h]),A++;else{var P=u[h],M=c[h],R=M!==P&&(!m(M,",")||M.slice(0,-1)!==P);R&&m(P,",")&&P.slice(0,-1)===M&&(R=!1,M+=","),R?(k>1&&h>2&&(k>4?(i+="\n".concat(g,"...").concat(v),s=!0):k>3&&(i+="\n  ".concat(c[h-2]),A++),i+="\n  ".concat(c[h-1]),A++),o=h,i+="\n".concat(y,"+").concat(v," ").concat(M),n+="\n".concat(_,"-").concat(v," ").concat(P),A+=2):(i+=n,n="",1!==k&&0!==h||(i+="\n  ".concat(M),A++))}if(A>20&&h<E-2)return"".concat(C).concat(I,"\n").concat(i,"\n").concat(g,"...").concat(v).concat(n,"\n")+"".concat(g,"...").concat(v)}return"".concat(C).concat(s?I:"","\n").concat(i).concat(n).concat(a).concat(p)}var E=function(e,r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(m,e);var i,s,l=(i=m,s=c(),function(){var e,t=h(i);if(s){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return o(this,e)});function m(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),"object"!==d(e)||null===e)throw new f("options","Object",e);var r=e.message,n=e.operator,i=e.stackStartFn,s=e.actual,c=e.expected,u=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=r)t=l.call(this,String(r));else if(process$1.stderr&&process$1.stderr.isTTY&&(process$1.stderr&&process$1.stderr.getColorDepth&&1!==process$1.stderr.getColorDepth()?(g="[34m",y="[32m",v="[39m",_="[31m"):(g="",y="",v="",_="")),"object"===d(s)&&null!==s&&"object"===d(c)&&null!==c&&"stack"in s&&s instanceof Error&&"stack"in c&&c instanceof Error&&(s=w(s),c=w(c)),"deepStrictEqual"===n||"strictEqual"===n)t=l.call(this,S(s,c,n));else if("notDeepStrictEqual"===n||"notStrictEqual"===n){var h=b[n],p=x(s).split("\n");if("notStrictEqual"===n&&"object"===d(s)&&null!==s&&(h=b.notStrictEqualObject),p.length>30)for(p[26]="".concat(g,"...").concat(v);p.length>27;)p.pop();t=1===p.length?l.call(this,"".concat(h," ").concat(p[0])):l.call(this,"".concat(h,"\n\n").concat(p.join("\n"),"\n"))}else{var E=x(s),T="",A=b[n];"notDeepEqual"===n||"notEqual"===n?(E="".concat(b[n],"\n\n").concat(E)).length>1024&&(E="".concat(E.slice(0,1021),"...")):(T="".concat(x(c)),E.length>512&&(E="".concat(E.slice(0,509),"...")),T.length>512&&(T="".concat(T.slice(0,509),"...")),"deepEqual"===n||"equal"===n?E="".concat(A,"\n\n").concat(E,"\n\nshould equal\n\n"):T=" ".concat(n," ").concat(T)),t=l.call(this,"".concat(E).concat(T))}return Error.stackTraceLimit=u,t.generatedMessage=!r,Object.defineProperty(a(t),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),t.code="ERR_ASSERTION",t.actual=s,t.expected=c,t.operator=n,Error.captureStackTrace&&Error.captureStackTrace(a(t),i),t.stack,t.name="AssertionError",o(t)}return n(m,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:r,value:function(e,r){return p(this,t(t({},r),{},{customInspect:!1,depth:0}))}}]),m}(s(Error),p.custom);return assertion_error=E}function requireIsArguments(){if(hasRequiredIsArguments)return isArguments;hasRequiredIsArguments=1;var e=Object.prototype.toString;return isArguments=function(t){var r=e.call(t),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),n}}function requireImplementation$3(){if(hasRequiredImplementation$3)return implementation$3;var e;if(hasRequiredImplementation$3=1,!Object.keys){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=requireIsArguments(),i=Object.prototype.propertyIsEnumerable,o=!i.call({toString:null},"toString"),a=i.call((function(){}),"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(e){var t=e.constructor;return t&&t.prototype===e},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},u=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!c["$"+e]&&t.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{l(window[e])}catch(e2){return!0}}catch(e2){return!0}return!1}();e=function(e){var i=null!==e&&"object"==typeof e,c="[object Function]"===r.call(e),h=n(e),d=i&&"[object String]"===r.call(e),p=[];if(!i&&!c&&!h)throw new TypeError("Object.keys called on a non-object");var f=a&&c;if(d&&e.length>0&&!t.call(e,0))for(var m=0;m<e.length;++m)p.push(String(m));if(h&&e.length>0)for(var g=0;g<e.length;++g)p.push(String(g));else for(var y in e)f&&"prototype"===y||!t.call(e,y)||p.push(String(y));if(o)for(var _=function(e){if("undefined"==typeof window||!u)return l(e);try{return l(e)}catch(e2){return!1}}(e),v=0;v<s.length;++v)_&&"constructor"===s[v]||!t.call(e,s[v])||p.push(s[v]);return p}}return implementation$3=e}function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var e=Array.prototype.slice,t=requireIsArguments(),r=Object.keys,n=r?function(e){return r(e)}:requireImplementation$3(),i=Object.keys;return n.shim=function(){if(Object.keys){var r=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);r||(Object.keys=function(r){return t(r)?i(e.call(r)):i(r)})}else Object.keys=n;return Object.keys||n},objectKeys=n}function requireImplementation$2(){if(hasRequiredImplementation$2)return implementation$2;hasRequiredImplementation$2=1;var e=requireObjectKeys(),t=requireShams$1()(),r=requireCallBound$1(),n=requireEsObjectAtoms(),i=r("Array.prototype.push"),o=r("Object.prototype.propertyIsEnumerable"),a=t?n.getOwnPropertySymbols:null;return implementation$2=function(r,s){if(null==r)throw new TypeError("target must be an object");var l=n(r);if(1===arguments.length)return l;for(var c=1;c<arguments.length;++c){var u=n(arguments[c]),h=e(u),d=t&&(n.getOwnPropertySymbols||a);if(d)for(var p=d(u),f=0;f<p.length;++f){var m=p[f];o(u,m)&&i(h,m)}for(var g=0;g<h.length;++g){var y=h[g];if(o(u,y)){var _=u[y];l[y]=_}}}return l},implementation$2}function requirePolyfill$2(){if(hasRequiredPolyfill$2)return polyfill$2;hasRequiredPolyfill$2=1;var e=requireImplementation$2();return polyfill$2=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},n=0;n<t.length;++n)r[t[n]]=t[n];var i=Object.assign({},r),o="";for(var a in i)o+=a;return e!==o}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(e2){return"y"===e[1]}return!1}()?e:Object.assign:e}}function requireImplementation$1(){if(hasRequiredImplementation$1)return implementation$1;hasRequiredImplementation$1=1;var e=function(e){return e!=e};return implementation$1=function(t,r){return 0===t&&0===r?1/t==1/r:t===r||!(!e(t)||!e(r))}}function requirePolyfill$1(){if(hasRequiredPolyfill$1)return polyfill$1;hasRequiredPolyfill$1=1;var e=requireImplementation$1();return polyfill$1=function(){return"function"==typeof Object.is?Object.is:e}}function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var e=requireGetIntrinsic(),t=requireCallBind(),r=t(e("String.prototype.indexOf"));return callBound=function(n,i){var o=e(n,!!i);return"function"==typeof o&&r(n,".prototype.")>-1?t(o):o}}function requireDefineProperties(){if(hasRequiredDefineProperties)return defineProperties_1;hasRequiredDefineProperties=1;var e=requireObjectKeys(),t="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,n=Array.prototype.concat,i=requireDefineDataProperty(),o=requireHasPropertyDescriptors()(),a=function(e,t,n,a){if(t in e)if(!0===a){if(e[t]===n)return}else if("function"!=typeof(s=a)||"[object Function]"!==r.call(s)||!a())return;var s;o?i(e,t,n,!0):i(e,t,n)},s=function(r,i){var o=arguments.length>2?arguments[2]:{},s=e(i);t&&(s=n.call(s,Object.getOwnPropertySymbols(i)));for(var l=0;l<s.length;l+=1)a(r,s[l],i[s[l]],o[s[l]])};return s.supportsDescriptors=!!o,defineProperties_1=s}function requireShim$1(){if(hasRequiredShim$1)return shim$1;hasRequiredShim$1=1;var e=requirePolyfill$1(),t=requireDefineProperties();return shim$1=function(){var r=e();return t(Object,{is:r},{is:function(){return Object.is!==r}}),r}}function requireObjectIs(){if(hasRequiredObjectIs)return objectIs;hasRequiredObjectIs=1;var e=requireDefineProperties(),t=requireCallBind(),r=requireImplementation$1(),n=requirePolyfill$1(),i=requireShim$1(),o=t(n(),Object);return e(o,{getPolyfill:n,implementation:r,shim:i}),objectIs=o}function requireImplementation(){return hasRequiredImplementation?implementation:(hasRequiredImplementation=1,implementation=function(e){return e!=e})}function requirePolyfill(){if(hasRequiredPolyfill)return polyfill;hasRequiredPolyfill=1;var e=requireImplementation();return polyfill=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:e}}function requireShim(){if(hasRequiredShim)return shim;hasRequiredShim=1;var e=requireDefineProperties(),t=requirePolyfill();return shim=function(){var r=t();return e(Number,{isNaN:r},{isNaN:function(){return Number.isNaN!==r}}),r}}function requireIsNan(){if(hasRequiredIsNan)return isNan;hasRequiredIsNan=1;var e=requireCallBind(),t=requireDefineProperties(),r=requireImplementation(),n=requirePolyfill(),i=requireShim(),o=e(n(),Number);return t(o,{getPolyfill:n,implementation:r,shim:i}),isNan=o}function requireComparisons(){if(hasRequiredComparisons)return comparisons;function e(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t);else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}hasRequiredComparisons=1;var n=void 0!==/a/g.flags,i=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},o=function(e){var t=[];return e.forEach((function(e,r){return t.push([r,e])})),t},a=Object.is?Object.is:requireObjectIs(),s=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},l=Number.isNaN?Number.isNaN:requireIsNan();function c(e){return e.call.bind(e)}var u=c(Object.prototype.hasOwnProperty),h=c(Object.prototype.propertyIsEnumerable),d=c(Object.prototype.toString),p=requireUtil$1().types,f=p.isAnyArrayBuffer,m=p.isArrayBufferView,g=p.isDate,y=p.isMap,_=p.isRegExp,v=p.isSet,b=p.isNativeError,w=p.isBoxedPrimitive,x=p.isNumberObject,S=p.isStringObject,E=p.isBooleanObject,T=p.isBigIntObject,A=p.isSymbolObject,C=p.isFloat32Array,I=p.isFloat64Array;function k(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(r<48||r>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function P(e){return Object.keys(e).filter(k).concat(s(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}
/*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
   * @license  MIT
   */function M(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}function R(e,t,i,o){if(e===t)return 0!==e||(!i||a(e,t));if(i){if("object"!==r(e))return"number"==typeof e&&l(e)&&l(t);if("object"!==r(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==r(e))return(null===t||"object"!==r(t))&&e==t;if(null===t||"object"!==r(t))return!1}var s,c,u,h,p=d(e);if(p!==d(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var k=P(e),R=P(t);return k.length===R.length&&O(e,t,i,o,1,k)}if("[object Object]"===p&&(!y(e)&&y(t)||!v(e)&&v(t)))return!1;if(g(e)){if(!g(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(_(e)){if(!_(t)||(u=e,h=t,!(n?u.source===h.source&&u.flags===h.flags:RegExp.prototype.toString.call(u)===RegExp.prototype.toString.call(h))))return!1}else if(b(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(m(e)){if(i||!C(e)&&!I(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===M(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e,t))return!1;var D=P(e),L=P(t);return D.length===L.length&&O(e,t,i,o,0,D)}if(v(e))return!(!v(t)||e.size!==t.size)&&O(e,t,i,o,2);if(y(e))return!(!y(t)||e.size!==t.size)&&O(e,t,i,o,3);if(f(e)){if(c=t,(s=e).byteLength!==c.byteLength||0!==M(new Uint8Array(s),new Uint8Array(c)))return!1}else if(w(e)&&!function(e,t){return x(e)?x(t)&&a(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):S(e)?S(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):E(e)?E(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):T(e)?T(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):A(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return O(e,t,i,o,0)}function D(e,t){return t.filter((function(t){return h(e,t)}))}function O(t,n,a,l,c,d){if(5===arguments.length){d=Object.keys(t);var p=Object.keys(n);if(d.length!==p.length)return!1}for(var f=0;f<d.length;f++)if(!u(n,d[f]))return!1;if(a&&5===arguments.length){var m=s(t);if(0!==m.length){var g=0;for(f=0;f<m.length;f++){var y=m[f];if(h(t,y)){if(!h(n,y))return!1;d.push(y),g++}else if(h(n,y))return!1}var _=s(n);if(m.length!==_.length&&D(n,_).length!==g)return!1}else{var v=s(n);if(0!==v.length&&0!==D(n,v).length)return!1}}if(0===d.length&&(0===c||1===c&&0===t.length||0===t.size))return!0;if(void 0===l)l={val1:new Map,val2:new Map,position:0};else{var b=l.val1.get(t);if(void 0!==b){var w=l.val2.get(n);if(void 0!==w)return b===w}l.position++}l.val1.set(t,l.position),l.val2.set(n,l.position);var x=function(t,n,a,s,l,c){var h=0;if(2===c){if(!function(e,t,n,o){for(var a=null,s=i(e),l=0;l<s.length;l++){var c=s[l];if("object"===r(c)&&null!==c)null===a&&(a=new Set),a.add(c);else if(!t.has(c)){if(n)return!1;if(!$(e,t,c))return!1;null===a&&(a=new Set),a.add(c)}}if(null!==a){for(var u=i(t),h=0;h<u.length;h++){var d=u[h];if("object"===r(d)&&null!==d){if(!L(a,d,n,o))return!1}else if(!n&&!e.has(d)&&!L(a,d,n,o))return!1}return 0===a.size}return!0}(t,n,a,l))return!1}else if(3===c){if(!function(t,n,i,a){for(var s=null,l=o(t),c=0;c<l.length;c++){var u=e(l[c],2),h=u[0],d=u[1];if("object"===r(h)&&null!==h)null===s&&(s=new Set),s.add(h);else{var p=n.get(h);if(void 0===p&&!n.has(h)||!R(d,p,i,a)){if(i)return!1;if(!z(t,n,h,d,a))return!1;null===s&&(s=new Set),s.add(h)}}}if(null!==s){for(var f=o(n),m=0;m<f.length;m++){var g=e(f[m],2),y=g[0],_=g[1];if("object"===r(y)&&null!==y){if(!F(s,t,y,_,i,a))return!1}else if(!(i||t.has(y)&&R(t.get(y),_,!1,a)||F(s,t,y,_,!1,a)))return!1}return 0===s.size}return!0}(t,n,a,l))return!1}else if(1===c)for(;h<t.length;h++){if(!u(t,h)){if(u(n,h))return!1;for(var d=Object.keys(t);h<d.length;h++){var p=d[h];if(!u(n,p)||!R(t[p],n[p],a,l))return!1}return d.length===Object.keys(n).length}if(!u(n,h)||!R(t[h],n[h],a,l))return!1}for(h=0;h<s.length;h++){var f=s[h];if(!R(t[f],n[f],a,l))return!1}return!0}(t,n,a,d,l,c);return l.val1.delete(t),l.val2.delete(n),x}function L(e,t,r,n){for(var o=i(e),a=0;a<o.length;a++){var s=o[a];if(R(t,s,r,n))return e.delete(s),!0}return!1}function B(e){switch(r(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(l(e))return!1}return!0}function $(e,t,r){var n=B(r);return null!=n?n:t.has(n)&&!e.has(n)}function z(e,t,r,n,i){var o=B(r);if(null!=o)return o;var a=t.get(o);return!(void 0===a&&!t.has(o)||!R(n,a,!1,i))&&(!e.has(o)&&R(n,a,!1,i))}function F(e,t,r,n,o,a){for(var s=i(e),l=0;l<s.length;l++){var c=s[l];if(R(r,c,o,a)&&R(n,t.get(c),o,a))return e.delete(c),!0}return!1}return comparisons={isDeepEqual:function(e,t){return R(e,t,false)},isDeepStrictEqual:function(e,t){return R(e,t,true)}}}function requireAssert(){if(hasRequiredAssert)return assert.exports;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}hasRequiredAssert=1;var r,n,i=requireErrors().codes,o=i.ERR_AMBIGUOUS_ARGUMENT,a=i.ERR_INVALID_ARG_TYPE,s=i.ERR_INVALID_ARG_VALUE,l=i.ERR_INVALID_RETURN_VALUE,c=i.ERR_MISSING_ARGS,u=requireAssertion_error(),h=requireUtil$1().inspect,d=requireUtil$1().types,p=d.isPromise,f=d.isRegExp,m=requirePolyfill$2()(),g=requirePolyfill$1()(),y=requireCallBound()("RegExp.prototype.test");function _(){var e=requireComparisons();r=e.isDeepEqual,n=e.isDeepStrictEqual}var v=!1,b=assert.exports=E,w={};function x(e){if(e.message instanceof Error)throw e.message;throw new u(e)}function S(e,t,r,n){if(!r){var i=!1;if(0===t)i=!0,n="No value argument passed to `assert.ok()`";else if(n instanceof Error)throw n;var o=new u({actual:r,expected:!0,message:n,operator:"==",stackStartFn:e});throw o.generatedMessage=i,o}}function E(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[E,t.length].concat(t))}b.fail=function e(t,r,n,i,o){var a,s=arguments.length;if(0===s)a="Failed";else if(1===s)n=t,t=void 0;else{if(!1===v)v=!0,(process$1.emitWarning?process$1.emitWarning:(()=>{}).bind(console))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094");2===s&&(i="!=")}if(n instanceof Error)throw n;var l={actual:t,expected:r,operator:void 0===i?"fail":i,stackStartFn:o||e};void 0!==n&&(l.message=n);var c=new u(l);throw a&&(c.message=a,c.generatedMessage=!0),c},b.AssertionError=u,b.ok=E,b.equal=function e(t,r,n){if(arguments.length<2)throw new c("actual","expected");t!=r&&x({actual:t,expected:r,message:n,operator:"==",stackStartFn:e})},b.notEqual=function e(t,r,n){if(arguments.length<2)throw new c("actual","expected");t==r&&x({actual:t,expected:r,message:n,operator:"!=",stackStartFn:e})},b.deepEqual=function e(t,n,i){if(arguments.length<2)throw new c("actual","expected");void 0===r&&_(),r(t,n)||x({actual:t,expected:n,message:i,operator:"deepEqual",stackStartFn:e})},b.notDeepEqual=function e(t,n,i){if(arguments.length<2)throw new c("actual","expected");void 0===r&&_(),r(t,n)&&x({actual:t,expected:n,message:i,operator:"notDeepEqual",stackStartFn:e})},b.deepStrictEqual=function e(t,i,o){if(arguments.length<2)throw new c("actual","expected");void 0===r&&_(),n(t,i)||x({actual:t,expected:i,message:o,operator:"deepStrictEqual",stackStartFn:e})},b.notDeepStrictEqual=function e(t,i,o){if(arguments.length<2)throw new c("actual","expected");void 0===r&&_();n(t,i)&&x({actual:t,expected:i,message:o,operator:"notDeepStrictEqual",stackStartFn:e})},b.strictEqual=function e(t,r,n){if(arguments.length<2)throw new c("actual","expected");g(t,r)||x({actual:t,expected:r,message:n,operator:"strictEqual",stackStartFn:e})},b.notStrictEqual=function e(t,r,n){if(arguments.length<2)throw new c("actual","expected");g(t,r)&&x({actual:t,expected:r,message:n,operator:"notStrictEqual",stackStartFn:e})};var T=t((function e(t,r,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.forEach((function(e){e in t&&(void 0!==n&&"string"==typeof n[e]&&f(t[e])&&y(t[e],n[e])?i[e]=n[e]:i[e]=t[e])}))}));function A(t,i,o,l){if("function"!=typeof i){if(f(i))return y(i,t);if(2===arguments.length)throw new a("expected",["Function","RegExp"],i);if("object"!==e(t)||null===t){var c=new u({actual:t,expected:i,message:o,operator:"deepStrictEqual",stackStartFn:l});throw c.operator=l.name,c}var h=Object.keys(i);if(i instanceof Error)h.push("name","message");else if(0===h.length)throw new s("error",i,"may not be an empty object");return void 0===r&&_(),h.forEach((function(e){"string"==typeof t[e]&&f(i[e])&&y(i[e],t[e])||function(e,t,r,i,o,a){if(!(r in e)||!n(e[r],t[r])){if(!i){var s=new T(e,o),l=new T(t,o,e),c=new u({actual:s,expected:l,operator:"deepStrictEqual",stackStartFn:a});throw c.actual=e,c.expected=t,c.operator=a.name,c}x({actual:e,expected:t,message:i,operator:a.name,stackStartFn:a})}}(t,i,e,o,h,l)})),!0}return void 0!==i.prototype&&t instanceof i||!Error.isPrototypeOf(i)&&!0===i.call({},t)}function C(e){if("function"!=typeof e)throw new a("fn","Function",e);try{e()}catch(e2){return e2}return w}function I(t){return p(t)||null!==t&&"object"===e(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function k(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!I(t=e()))throw new l("instance of Promise","promiseFn",t)}else{if(!I(e))throw new a("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return w})).catch((function(e){return e}))}))}function P(t,r,n,i){if("string"==typeof n){if(4===arguments.length)throw new a("error",["Object","Error","Function","RegExp"],n);if("object"===e(r)&&null!==r){if(r.message===n)throw new o("error/message",'The error message "'.concat(r.message,'" is identical to the message.'))}else if(r===n)throw new o("error/message",'The error "'.concat(r,'" is identical to the message.'));i=n,n=void 0}else if(null!=n&&"object"!==e(n)&&"function"!=typeof n)throw new a("error",["Object","Error","Function","RegExp"],n);if(r===w){var s="";n&&n.name&&(s+=" (".concat(n.name,")")),s+=i?": ".concat(i):".";var l="rejects"===t.name?"rejection":"exception";x({actual:void 0,expected:n,operator:t.name,message:"Missing expected ".concat(l).concat(s),stackStartFn:t})}if(n&&!A(r,n,i,t))throw r}function M(e,t,r,n){if(t!==w){if("string"==typeof r&&(n=r,r=void 0),!r||A(t,r)){var i=n?": ".concat(n):".",o="doesNotReject"===e.name?"rejection":"exception";x({actual:t,expected:r,operator:e.name,message:"Got unwanted ".concat(o).concat(i,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function R(t,r,n,i,o){if(!f(r))throw new a("regexp","RegExp",r);var s="match"===o;if("string"!=typeof t||y(r,t)!==s){if(n instanceof Error)throw n;var l=!n;n=n||("string"!=typeof t?'The "string" argument must be of type string. Received type '+"".concat(e(t)," (").concat(h(t),")"):(s?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(h(r),". Input:\n\n").concat(h(t),"\n"));var c=new u({actual:t,expected:r,message:n,operator:o,stackStartFn:i});throw c.generatedMessage=l,c}}function D(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[D,t.length].concat(t))}return b.throws=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];P.apply(void 0,[e,C(t)].concat(n))},b.rejects=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return k(t).then((function(t){return P.apply(void 0,[e,t].concat(n))}))},b.doesNotThrow=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];M.apply(void 0,[e,C(t)].concat(n))},b.doesNotReject=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return k(t).then((function(t){return M.apply(void 0,[e,t].concat(n))}))},b.ifError=function t(r){if(null!=r){var n="ifError got unwanted exception: ";"object"===e(r)&&"string"==typeof r.message?0===r.message.length&&r.constructor?n+=r.constructor.name:n+=r.message:n+=h(r);var i=new u({actual:r,expected:null,operator:"ifError",message:n,stackStartFn:t}),o=r.stack;if("string"==typeof o){var a=o.split("\n");a.shift();for(var s=i.stack.split("\n"),l=0;l<a.length;l++){var c=s.indexOf(a[l]);if(-1!==c){s=s.slice(0,c);break}}i.stack="".concat(s.join("\n"),"\n").concat(a.join("\n"))}throw i}},b.match=function e(t,r,n){R(t,r,n,e,"match")},b.doesNotMatch=function e(t,r,n){R(t,r,n,e,"doesNotMatch")},b.strict=m(D,b,{equal:b.strictEqual,deepEqual:b.deepStrictEqual,notEqual:b.notStrictEqual,notDeepEqual:b.notDeepStrictEqual}),b.strict.strict=b.strict,assert.exports}function requireZstream(){if(hasRequiredZstream)return zstream;return hasRequiredZstream=1,zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}var deflate={},common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,function(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},i={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(common)),common}var trees={},hasRequiredTrees,adler32_1,hasRequiredAdler32,crc32_1,hasRequiredCrc32,messages,hasRequiredMessages,hasRequiredDeflate;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var e=requireCommon();function t(e){for(var t=e.length;--t>=0;)e[t]=0}var r=256,n=286,i=30,o=15,a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);t(u);var h=new Array(60);t(h);var d=new Array(512);t(d);var p=new Array(256);t(p);var f=new Array(29);t(f);var m,g,y,_=new Array(i);function v(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function w(e){return e<256?d[e]:d[256+(e>>>7)]}function x(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,x(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function E(e,t,r){S(e,r[2*t],r[2*t+1])}function T(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function A(e,t,r){var n,i,a=new Array(16),s=0;for(n=1;n<=o;n++)a[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var l=e[2*i+1];0!==l&&(e[2*i]=T(a[l]++,l))}}function C(e){var t;for(t=0;t<n;t++)e.dyn_ltree[2*t]=0;for(t=0;t<i;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function I(e){e.bi_valid>8?x(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function P(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&k(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!k(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function M(e,t,n){var i,o,l,c,u=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],o=e.pending_buf[e.l_buf+u],u++,0===i?E(e,o,t):(E(e,(l=p[o])+r+1,t),0!==(c=a[l])&&S(e,o-=f[l],c),E(e,l=w(--i),n),0!==(c=s[l])&&S(e,i-=_[l],c))}while(u<e.last_lit);E(e,256,t)}function R(e,t){var r,n,i,a=t.dyn_tree,s=t.stat_desc.static_tree,l=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<c;r++)0!==a[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):a[2*r+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,l&&(e.static_len-=s[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)P(e,a,r);i=c;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],P(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,a[2*i]=a[2*r]+a[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,a[2*r+1]=a[2*n+1]=i,e.heap[1]=i++,P(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,a,s,l,c=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=o;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(a=c[2*c[2*(n=e.heap[r])+1]+1]+1)>m&&(a=m,g++),c[2*n+1]=a,n>u||(e.bl_count[a]++,s=0,n>=f&&(s=p[n-f]),l=c[2*n],e.opt_len+=l*(a+s),d&&(e.static_len+=l*(h[2*n+1]+s)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(a=m;0!==a;a--)for(n=e.bl_count[a];0!==n;)(i=e.heap[--r])>u||(c[2*i+1]!==a&&(e.opt_len+=(a-c[2*i+1])*c[2*i],c[2*i+1]=a),n--)}}(e,t),A(a,u,e.bl_count)}function D(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))}function O(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)do{E(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(E(e,i,e.bl_tree),s--),E(e,16,e.bl_tree),S(e,s-3,2)):s<=10?(E(e,17,e.bl_tree),S(e,s-3,3)):(E(e,18,e.bl_tree),S(e,s-11,7));s=0,o=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}}t(_);var L=!1;function B(t,r,n,i){S(t,0+(i?1:0),3),function(t,r,n){I(t),x(t,n),x(t,~n),e.arraySet(t.pending_buf,t.window,r,n,t.pending),t.pending+=n}(t,r,n)}return trees._tr_init=function(e){L||(!function(){var e,t,r,c,b,w=new Array(16);for(r=0,c=0;c<28;c++)for(f[c]=r,e=0;e<1<<a[c];e++)p[r++]=c;for(p[r-1]=c,b=0,c=0;c<16;c++)for(_[c]=b,e=0;e<1<<s[c];e++)d[b++]=c;for(b>>=7;c<i;c++)for(_[c]=b<<7,e=0;e<1<<s[c]-7;e++)d[256+b++]=c;for(t=0;t<=o;t++)w[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,w[8]++;for(;e<=255;)u[2*e+1]=9,e++,w[9]++;for(;e<=279;)u[2*e+1]=7,e++,w[7]++;for(;e<=287;)u[2*e+1]=8,e++,w[8]++;for(A(u,287,w),e=0;e<i;e++)h[2*e+1]=5,h[2*e]=T(e,5);m=new v(u,a,257,n,o),g=new v(h,s,0,i,o),y=new v(new Array(0),l,0,19,7)}(),L=!0),e.l_desc=new b(e.dyn_ltree,m),e.d_desc=new b(e.dyn_dtree,g),e.bl_desc=new b(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,C(e)},trees._tr_stored_block=B,trees._tr_flush_block=function(e,t,n,i){var o,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<r;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),s=function(e){var t;for(D(e,e.dyn_ltree,e.l_desc.max_code),D(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=o&&(o=a)):o=a=n+5,n+4<=o&&-1!==t?B(e,t,n,i):4===e.strategy||a===o?(S(e,2+(i?1:0),3),M(e,u,h)):(S(e,4+(i?1:0),3),function(e,t,r,n){var i;for(S(e,t-257,5),S(e,r-1,5),S(e,n-4,4),i=0;i<n;i++)S(e,e.bl_tree[2*c[i]+1],3);O(e,e.dyn_ltree,t-1),O(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),M(e,e.dyn_ltree,e.dyn_dtree)),C(e),i&&I(e)},trees._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(p[n]+r+1)]++,e.dyn_dtree[2*w(t)]++),e.last_lit===e.lit_bufsize-1},trees._tr_align=function(e){S(e,2,3),E(e,256,u),function(e){16===e.bi_valid?(x(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)},trees}function requireAdler32(){if(hasRequiredAdler32)return adler32_1;return hasRequiredAdler32=1,adler32_1=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16}}function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;var e=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();return crc32_1=function(t,r,n,i){var o=e,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^o[255&(t^r[s])];return~t},crc32_1}function requireMessages(){return hasRequiredMessages?messages:(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function requireDeflate(){if(hasRequiredDeflate)return deflate;hasRequiredDeflate=1;var e,t=requireCommon(),r=requireTrees(),n=requireAdler32(),i=requireCrc32(),o=requireMessages(),a=-2,s=258,l=262,c=103,u=113,h=666;function d(e,t){return e.msg=o[t],t}function p(e){return(e<<1)-(e>4?9:0)}function f(e){for(var t=e.length;--t>=0;)e[t]=0}function m(e){var r=e.state,n=r.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(t.arraySet(e.output,r.pending_buf,r.pending_out,n,e.next_out),e.next_out+=n,r.pending_out+=n,e.total_out+=n,e.avail_out-=n,r.pending-=n,0===r.pending&&(r.pending_out=0))}function g(e,t){r._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,m(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function _(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function v(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,c=e.nice_match,u=e.strstart>e.w_size-l?e.strstart-(e.w_size-l):0,h=e.window,d=e.w_mask,p=e.prev,f=e.strstart+s,m=h[o+a-1],g=h[o+a];e.prev_length>=e.good_match&&(i>>=2),c>e.lookahead&&(c=e.lookahead);do{if(h[(r=t)+a]===g&&h[r+a-1]===m&&h[r]===h[o]&&h[++r]===h[o+1]){o+=2,r++;do{}while(h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&h[++o]===h[++r]&&o<f);if(n=s-(f-o),o=f-s,n>a){if(e.match_start=t,a=n,n>=c)break;m=h[o+a-1],g=h[o+a]}}}while((t=p[t&d])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead}function b(e){var r,o,a,s,c,u,h,d,p,f,m=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-l)){t.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,r=o=e.hash_size;do{a=e.head[--r],e.head[r]=a>=m?a-m:0}while(--o);r=o=m;do{a=e.prev[--r],e.prev[r]=a>=m?a-m:0}while(--o);s+=m}if(0===e.strm.avail_in)break;if(u=e.strm,h=e.window,d=e.strstart+e.lookahead,p=s,f=void 0,(f=u.avail_in)>p&&(f=p),o=0===f?0:(u.avail_in-=f,t.arraySet(h,u.input,u.next_in,f,d),1===u.state.wrap?u.adler=n(u.adler,h,f,d):2===u.state.wrap&&(u.adler=i(u.adler,h,f,d)),u.next_in+=f,u.total_in+=f,f),e.lookahead+=o,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<l&&0!==e.strm.avail_in)}function w(e,t){for(var n,i;;){if(e.lookahead<l){if(b(e),e.lookahead<l&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-l&&(e.match_length=v(e,n)),e.match_length>=3)if(i=r._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function x(e,t){for(var n,i,o;;){if(e.lookahead<l){if(b(e),e.lookahead<l&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-l&&(e.match_length=v(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,i=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=r._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function S(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new t.Buf16(1146),this.dyn_dtree=new t.Buf16(122),this.bl_tree=new t.Buf16(78),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new t.Buf16(16),this.heap=new t.Buf16(573),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new t.Buf16(573),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function T(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:u,e.adler=2===t.wrap?0:1,t.last_flush=0,r._tr_init(t),0):d(e,a)}function A(t){var r,n=T(t);return 0===n&&((r=t.state).window_size=2*r.w_size,f(r.head),r.max_lazy_match=e[r.level].max_lazy,r.good_match=e[r.level].good_length,r.nice_match=e[r.level].nice_length,r.max_chain_length=e[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),n}function C(e,r,n,i,o,s){if(!e)return a;var l=1;if(-1===r&&(r=6),i<0?(l=0,i=-i):i>15&&(l=2,i-=16),o<1||o>9||8!==n||i<8||i>15||r<0||r>9||s<0||s>4)return d(e,a);8===i&&(i=9);var c=new E;return e.state=c,c.strm=e,c.wrap=l,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new t.Buf8(2*c.w_size),c.head=new t.Buf16(c.hash_size),c.prev=new t.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new t.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=r,c.strategy=s,c.method=n,A(e)}return e=[new S(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(b(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,g(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-l&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)})),new S(4,4,8,4,w),new S(4,5,16,8,w),new S(4,6,32,32,w),new S(4,4,16,16,x),new S(8,16,32,32,x),new S(8,16,128,128,x),new S(8,32,128,256,x),new S(32,128,258,1024,x),new S(32,258,258,4096,x)],deflate.deflateInit=function(e,t){return C(e,t,8,15,8,0)},deflate.deflateInit2=C,deflate.deflateReset=A,deflate.deflateResetKeep=T,deflate.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?a:(e.state.gzhead=t,0):a},deflate.deflate=function(t,n){var o,l,v,w;if(!t||!t.state||n>5||n<0)return t?d(t,a):a;if(l=t.state,!t.output||!t.input&&0!==t.avail_in||l.status===h&&4!==n)return d(t,0===t.avail_out?-5:a);if(l.strm=t,o=l.last_flush,l.last_flush=n,42===l.status)if(2===l.wrap)t.adler=0,y(l,31),y(l,139),y(l,8),l.gzhead?(y(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),y(l,255&l.gzhead.time),y(l,l.gzhead.time>>8&255),y(l,l.gzhead.time>>16&255),y(l,l.gzhead.time>>24&255),y(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),y(l,255&l.gzhead.os),l.gzhead.extra&&l.gzhead.extra.length&&(y(l,255&l.gzhead.extra.length),y(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(t.adler=i(t.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=69):(y(l,0),y(l,0),y(l,0),y(l,0),y(l,0),y(l,9===l.level?2:l.strategy>=2||l.level<2?4:0),y(l,3),l.status=u);else{var x=8+(l.w_bits-8<<4)<<8;x|=(l.strategy>=2||l.level<2?0:l.level<6?1:6===l.level?2:3)<<6,0!==l.strstart&&(x|=32),x+=31-x%31,l.status=u,_(l,x),0!==l.strstart&&(_(l,t.adler>>>16),_(l,65535&t.adler)),t.adler=1}if(69===l.status)if(l.gzhead.extra){for(v=l.pending;l.gzindex<(65535&l.gzhead.extra.length)&&(l.pending!==l.pending_buf_size||(l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),m(t),v=l.pending,l.pending!==l.pending_buf_size));)y(l,255&l.gzhead.extra[l.gzindex]),l.gzindex++;l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=73)}else l.status=73;if(73===l.status)if(l.gzhead.name){v=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),m(t),v=l.pending,l.pending===l.pending_buf_size)){w=1;break}w=l.gzindex<l.gzhead.name.length?255&l.gzhead.name.charCodeAt(l.gzindex++):0,y(l,w)}while(0!==w);l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),0===w&&(l.gzindex=0,l.status=91)}else l.status=91;if(91===l.status)if(l.gzhead.comment){v=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),m(t),v=l.pending,l.pending===l.pending_buf_size)){w=1;break}w=l.gzindex<l.gzhead.comment.length?255&l.gzhead.comment.charCodeAt(l.gzindex++):0,y(l,w)}while(0!==w);l.gzhead.hcrc&&l.pending>v&&(t.adler=i(t.adler,l.pending_buf,l.pending-v,v)),0===w&&(l.status=c)}else l.status=c;if(l.status===c&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&m(t),l.pending+2<=l.pending_buf_size&&(y(l,255&t.adler),y(l,t.adler>>8&255),t.adler=0,l.status=u)):l.status=u),0!==l.pending){if(m(t),0===t.avail_out)return l.last_flush=-1,0}else if(0===t.avail_in&&p(n)<=p(o)&&4!==n)return d(t,-5);if(l.status===h&&0!==t.avail_in)return d(t,-5);if(0!==t.avail_in||0!==l.lookahead||0!==n&&l.status!==h){var S=2===l.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(b(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(l,n):3===l.strategy?function(e,t){for(var n,i,o,a,l=e.window;;){if(e.lookahead<=s){if(b(e),e.lookahead<=s&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=l[o=e.strstart-1])===l[++o]&&i===l[++o]&&i===l[++o]){a=e.strstart+s;do{}while(i===l[++o]&&i===l[++o]&&i===l[++o]&&i===l[++o]&&i===l[++o]&&i===l[++o]&&i===l[++o]&&i===l[++o]&&o<a);e.match_length=s-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=r._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(l,n):e[l.level].func(l,n);if(3!==S&&4!==S||(l.status=h),1===S||3===S)return 0===t.avail_out&&(l.last_flush=-1),0;if(2===S&&(1===n?r._tr_align(l):5!==n&&(r._tr_stored_block(l,0,0,!1),3===n&&(f(l.head),0===l.lookahead&&(l.strstart=0,l.block_start=0,l.insert=0))),m(t),0===t.avail_out))return l.last_flush=-1,0}return 4!==n?0:l.wrap<=0?1:(2===l.wrap?(y(l,255&t.adler),y(l,t.adler>>8&255),y(l,t.adler>>16&255),y(l,t.adler>>24&255),y(l,255&t.total_in),y(l,t.total_in>>8&255),y(l,t.total_in>>16&255),y(l,t.total_in>>24&255)):(_(l,t.adler>>>16),_(l,65535&t.adler)),m(t),l.wrap>0&&(l.wrap=-l.wrap),0!==l.pending?0:1)},deflate.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==c&&t!==u&&t!==h?d(e,a):(e.state=null,t===u?d(e,-3):0):a},deflate.deflateSetDictionary=function(e,r){var i,o,s,l,c,u,h,d,p=r.length;if(!e||!e.state)return a;if(2===(l=(i=e.state).wrap)||1===l&&42!==i.status||i.lookahead)return a;for(1===l&&(e.adler=n(e.adler,r,p,0)),i.wrap=0,p>=i.w_size&&(0===l&&(f(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new t.Buf8(i.w_size),t.arraySet(d,r,p-i.w_size,i.w_size,0),r=d,p=i.w_size),c=e.avail_in,u=e.next_in,h=e.input,e.avail_in=p,e.next_in=0,e.input=r,b(i);i.lookahead>=3;){o=i.strstart,s=i.lookahead-2;do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[o+3-1])&i.hash_mask,i.prev[o&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=o,o++}while(--s);i.strstart=o,i.lookahead=2,b(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=u,e.input=h,e.avail_in=c,i.wrap=l,0},deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var inflate={},inffast,hasRequiredInffast,inftrees,hasRequiredInftrees,hasRequiredInflate,constants,hasRequiredConstants,hasRequiredBinding,hasRequiredLib$1,hasRequiredMapshaper;function requireInffast(){if(hasRequiredInffast)return inffast;hasRequiredInffast=1;return inffast=function(e,t){var r,n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A;r=e.state,n=e.next_in,T=e.input,i=n+(e.avail_in-5),o=e.next_out,A=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,h=r.wnext,d=r.window,p=r.hold,f=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,_=(1<<r.distbits)-1;e:do{f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),v=m[p&y];t:for(;;){if(p>>>=b=v>>>24,f-=b,0===(b=v>>>16&255))A[o++]=65535&v;else{if(!(16&b)){if(64&b){if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}v=m[(65535&v)+(p&(1<<b)-1)];continue t}for(w=65535&v,(b&=15)&&(f<b&&(p+=T[n++]<<f,f+=8),w+=p&(1<<b)-1,p>>>=b,f-=b),f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),v=g[p&_];;){if(p>>>=b=v>>>24,f-=b,16&(b=v>>>16&255)){if(x=65535&v,f<(b&=15)&&(p+=T[n++]<<f,(f+=8)<b&&(p+=T[n++]<<f,f+=8)),(x+=p&(1<<b)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=b,f-=b,x>(b=o-a)){if((b=x-b)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=0,E=d,0===h){if(S+=c-b,b<w){w-=b;do{A[o++]=d[S++]}while(--b);S=o-x,E=A}}else if(h<b){if(S+=c+h-b,(b-=h)<w){w-=b;do{A[o++]=d[S++]}while(--b);if(S=0,h<w){w-=b=h;do{A[o++]=d[S++]}while(--b);S=o-x,E=A}}}else if(S+=h-b,b<w){w-=b;do{A[o++]=d[S++]}while(--b);S=o-x,E=A}for(;w>2;)A[o++]=E[S++],A[o++]=E[S++],A[o++]=E[S++],w-=3;w&&(A[o++]=E[S++],w>1&&(A[o++]=E[S++]))}else{S=o-x;do{A[o++]=A[S++],A[o++]=A[S++],A[o++]=A[S++],w-=3}while(w>2);w&&(A[o++]=A[S++],w>1&&(A[o++]=A[S++]))}break}if(64&b){e.msg="invalid distance code",r.mode=30;break e}v=g[(65535&v)+(p&(1<<b)-1)]}}break}}while(n<i&&o<s);n-=w=f>>3,p&=(1<<(f-=w<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=f}}function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var e=requireCommon(),t=15,r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(a,s,l,c,u,h,d,p){var f,m,g,y,_,v,b,w,x,S=p.bits,E=0,T=0,A=0,C=0,I=0,k=0,P=0,M=0,R=0,D=0,O=null,L=0,B=new e.Buf16(16),$=new e.Buf16(16),z=null,F=0;for(E=0;E<=t;E++)B[E]=0;for(T=0;T<c;T++)B[s[l+T]]++;for(I=S,C=t;C>=1&&0===B[C];C--);if(I>C&&(I=C),0===C)return u[h++]=20971520,u[h++]=20971520,p.bits=1,0;for(A=1;A<C&&0===B[A];A++);for(I<A&&(I=A),M=1,E=1;E<=t;E++)if(M<<=1,(M-=B[E])<0)return-1;if(M>0&&(0===a||1!==C))return-1;for($[1]=0,E=1;E<t;E++)$[E+1]=$[E]+B[E];for(T=0;T<c;T++)0!==s[l+T]&&(d[$[s[l+T]]++]=T);if(0===a?(O=z=d,v=19):1===a?(O=r,L-=257,z=n,F-=257,v=256):(O=i,z=o,v=-1),D=0,T=0,E=A,_=h,k=I,P=0,g=-1,y=(R=1<<I)-1,1===a&&R>852||2===a&&R>592)return 1;for(;;){b=E-P,d[T]<v?(w=0,x=d[T]):d[T]>v?(w=z[F+d[T]],x=O[L+d[T]]):(w=96,x=0),f=1<<E-P,A=m=1<<k;do{u[_+(D>>P)+(m-=f)]=b<<24|w<<16|x}while(0!==m);for(f=1<<E-1;D&f;)f>>=1;if(0!==f?(D&=f-1,D+=f):D=0,T++,0==--B[E]){if(E===C)break;E=s[l+d[T]]}if(E>I&&(D&y)!==g){for(0===P&&(P=I),_+=A,M=1<<(k=E-P);k+P<C&&!((M-=B[k+P])<=0);)k++,M<<=1;if(R+=1<<k,1===a&&R>852||2===a&&R>592)return 1;u[g=D&y]=I<<24|k<<16|_-h}}return 0!==D&&(u[_+D]=E-P<<24|64<<16),p.bits=I,0}}function requireInflate(){if(hasRequiredInflate)return inflate;hasRequiredInflate=1;var e=requireCommon(),t=requireAdler32(),r=requireCrc32(),n=requireInffast(),i=requireInftrees(),o=-2,a=12,s=30;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(t){var r;return t&&t.state?(r=t.state,t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=1&r.wrap),r.mode=1,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new e.Buf32(852),r.distcode=r.distdyn=new e.Buf32(592),r.sane=1,r.back=-1,0):o}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):o}function d(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?o:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,h(e))):o}function p(e,t){var r,n;return e?(n=new c,e.state=n,n.window=null,0!==(r=d(e,t))&&(e.state=null),r):o}var f,m,g=!0;function y(t){if(g){var r;for(f=new e.Buf32(512),m=new e.Buf32(32),r=0;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(i(1,t.lens,0,288,f,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;i(2,t.lens,0,32,m,0,t.work,{bits:5}),g=!1}t.lencode=f,t.lenbits=9,t.distcode=m,t.distbits=5}function _(t,r,n,i){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new e.Buf8(a.wsize)),i>=a.wsize?(e.arraySet(a.window,r,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>i&&(o=i),e.arraySet(a.window,r,n-i,o,a.wnext),(i-=o)?(e.arraySet(a.window,r,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}return inflate.inflateReset=h,inflate.inflateReset2=d,inflate.inflateResetKeep=u,inflate.inflateInit=function(e){return p(e,15)},inflate.inflateInit2=p,inflate.inflate=function(c,u){var h,d,p,f,m,g,v,b,w,x,S,E,T,A,C,I,k,P,M,R,D,O,L,B,$=0,z=new e.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return o;(h=c.state).mode===a&&(h.mode=13),m=c.next_out,p=c.output,v=c.avail_out,f=c.next_in,d=c.input,g=c.avail_in,b=h.hold,w=h.bits,x=g,S=v,O=0;e:for(;;)switch(h.mode){case 1:if(0===h.wrap){h.mode=13;break}for(;w<16;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(2&h.wrap&&35615===b){h.check=0,z[0]=255&b,z[1]=b>>>8&255,h.check=r(h.check,z,2,0),b=0,w=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&b)<<8)+(b>>8))%31){c.msg="incorrect header check",h.mode=s;break}if(8!=(15&b)){c.msg="unknown compression method",h.mode=s;break}if(w-=4,D=8+(15&(b>>>=4)),0===h.wbits)h.wbits=D;else if(D>h.wbits){c.msg="invalid window size",h.mode=s;break}h.dmax=1<<D,c.adler=h.check=1,h.mode=512&b?10:a,b=0,w=0;break;case 2:for(;w<16;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(h.flags=b,8!=(255&h.flags)){c.msg="unknown compression method",h.mode=s;break}if(57344&h.flags){c.msg="unknown header flags set",h.mode=s;break}h.head&&(h.head.text=b>>8&1),512&h.flags&&(z[0]=255&b,z[1]=b>>>8&255,h.check=r(h.check,z,2,0)),b=0,w=0,h.mode=3;case 3:for(;w<32;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.head&&(h.head.time=b),512&h.flags&&(z[0]=255&b,z[1]=b>>>8&255,z[2]=b>>>16&255,z[3]=b>>>24&255,h.check=r(h.check,z,4,0)),b=0,w=0,h.mode=4;case 4:for(;w<16;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.head&&(h.head.xflags=255&b,h.head.os=b>>8),512&h.flags&&(z[0]=255&b,z[1]=b>>>8&255,h.check=r(h.check,z,2,0)),b=0,w=0,h.mode=5;case 5:if(1024&h.flags){for(;w<16;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.length=b,h.head&&(h.head.extra_len=b),512&h.flags&&(z[0]=255&b,z[1]=b>>>8&255,h.check=r(h.check,z,2,0)),b=0,w=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&((E=h.length)>g&&(E=g),E&&(h.head&&(D=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),e.arraySet(h.head.extra,d,f,E,D)),512&h.flags&&(h.check=r(h.check,d,E,f)),g-=E,f+=E,h.length-=E),h.length))break e;h.length=0,h.mode=7;case 7:if(2048&h.flags){if(0===g)break e;E=0;do{D=d[f+E++],h.head&&D&&h.length<65536&&(h.head.name+=String.fromCharCode(D))}while(D&&E<g);if(512&h.flags&&(h.check=r(h.check,d,E,f)),g-=E,f+=E,D)break e}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if(0===g)break e;E=0;do{D=d[f+E++],h.head&&D&&h.length<65536&&(h.head.comment+=String.fromCharCode(D))}while(D&&E<g);if(512&h.flags&&(h.check=r(h.check,d,E,f)),g-=E,f+=E,D)break e}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;w<16;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(b!==(65535&h.check)){c.msg="header crc mismatch",h.mode=s;break}b=0,w=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),c.adler=h.check=0,h.mode=a;break;case 10:for(;w<32;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}c.adler=h.check=l(b),b=0,w=0,h.mode=11;case 11:if(0===h.havedict)return c.next_out=m,c.avail_out=v,c.next_in=f,c.avail_in=g,h.hold=b,h.bits=w,2;c.adler=h.check=1,h.mode=a;case a:if(5===u||6===u)break e;case 13:if(h.last){b>>>=7&w,w-=7&w,h.mode=27;break}for(;w<3;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}switch(h.last=1&b,w-=1,3&(b>>>=1)){case 0:h.mode=14;break;case 1:if(y(h),h.mode=20,6===u){b>>>=2,w-=2;break e}break;case 2:h.mode=17;break;case 3:c.msg="invalid block type",h.mode=s}b>>>=2,w-=2;break;case 14:for(b>>>=7&w,w-=7&w;w<32;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if((65535&b)!=(b>>>16^65535)){c.msg="invalid stored block lengths",h.mode=s;break}if(h.length=65535&b,b=0,w=0,h.mode=15,6===u)break e;case 15:h.mode=16;case 16:if(E=h.length){if(E>g&&(E=g),E>v&&(E=v),0===E)break e;e.arraySet(p,d,f,E,m),g-=E,f+=E,v-=E,m+=E,h.length-=E;break}h.mode=a;break;case 17:for(;w<14;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(h.nlen=257+(31&b),b>>>=5,w-=5,h.ndist=1+(31&b),b>>>=5,w-=5,h.ncode=4+(15&b),b>>>=4,w-=4,h.nlen>286||h.ndist>30){c.msg="too many length or distance symbols",h.mode=s;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;w<3;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.lens[F[h.have++]]=7&b,b>>>=3,w-=3}for(;h.have<19;)h.lens[F[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,L={bits:h.lenbits},O=i(0,h.lens,0,19,h.lencode,0,h.work,L),h.lenbits=L.bits,O){c.msg="invalid code lengths set",h.mode=s;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;I=($=h.lencode[b&(1<<h.lenbits)-1])>>>16&255,k=65535&$,!((C=$>>>24)<=w);){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(k<16)b>>>=C,w-=C,h.lens[h.have++]=k;else{if(16===k){for(B=C+2;w<B;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(b>>>=C,w-=C,0===h.have){c.msg="invalid bit length repeat",h.mode=s;break}D=h.lens[h.have-1],E=3+(3&b),b>>>=2,w-=2}else if(17===k){for(B=C+3;w<B;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}w-=C,D=0,E=3+(7&(b>>>=C)),b>>>=3,w-=3}else{for(B=C+7;w<B;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}w-=C,D=0,E=11+(127&(b>>>=C)),b>>>=7,w-=7}if(h.have+E>h.nlen+h.ndist){c.msg="invalid bit length repeat",h.mode=s;break}for(;E--;)h.lens[h.have++]=D}}if(h.mode===s)break;if(0===h.lens[256]){c.msg="invalid code -- missing end-of-block",h.mode=s;break}if(h.lenbits=9,L={bits:h.lenbits},O=i(1,h.lens,0,h.nlen,h.lencode,0,h.work,L),h.lenbits=L.bits,O){c.msg="invalid literal/lengths set",h.mode=s;break}if(h.distbits=6,h.distcode=h.distdyn,L={bits:h.distbits},O=i(2,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,L),h.distbits=L.bits,O){c.msg="invalid distances set",h.mode=s;break}if(h.mode=20,6===u)break e;case 20:h.mode=21;case 21:if(g>=6&&v>=258){c.next_out=m,c.avail_out=v,c.next_in=f,c.avail_in=g,h.hold=b,h.bits=w,n(c,S),m=c.next_out,p=c.output,v=c.avail_out,f=c.next_in,d=c.input,g=c.avail_in,b=h.hold,w=h.bits,h.mode===a&&(h.back=-1);break}for(h.back=0;I=($=h.lencode[b&(1<<h.lenbits)-1])>>>16&255,k=65535&$,!((C=$>>>24)<=w);){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(I&&!(240&I)){for(P=C,M=I,R=k;I=($=h.lencode[R+((b&(1<<P+M)-1)>>P)])>>>16&255,k=65535&$,!(P+(C=$>>>24)<=w);){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}b>>>=P,w-=P,h.back+=P}if(b>>>=C,w-=C,h.back+=C,h.length=k,0===I){h.mode=26;break}if(32&I){h.back=-1,h.mode=a;break}if(64&I){c.msg="invalid literal/length code",h.mode=s;break}h.extra=15&I,h.mode=22;case 22:if(h.extra){for(B=h.extra;w<B;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.length+=b&(1<<h.extra)-1,b>>>=h.extra,w-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;I=($=h.distcode[b&(1<<h.distbits)-1])>>>16&255,k=65535&$,!((C=$>>>24)<=w);){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(!(240&I)){for(P=C,M=I,R=k;I=($=h.distcode[R+((b&(1<<P+M)-1)>>P)])>>>16&255,k=65535&$,!(P+(C=$>>>24)<=w);){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}b>>>=P,w-=P,h.back+=P}if(b>>>=C,w-=C,h.back+=C,64&I){c.msg="invalid distance code",h.mode=s;break}h.offset=k,h.extra=15&I,h.mode=24;case 24:if(h.extra){for(B=h.extra;w<B;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}h.offset+=b&(1<<h.extra)-1,b>>>=h.extra,w-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){c.msg="invalid distance too far back",h.mode=s;break}h.mode=25;case 25:if(0===v)break e;if(E=S-v,h.offset>E){if((E=h.offset-E)>h.whave&&h.sane){c.msg="invalid distance too far back",h.mode=s;break}E>h.wnext?(E-=h.wnext,T=h.wsize-E):T=h.wnext-E,E>h.length&&(E=h.length),A=h.window}else A=p,T=m-h.offset,E=h.length;E>v&&(E=v),v-=E,h.length-=E;do{p[m++]=A[T++]}while(--E);0===h.length&&(h.mode=21);break;case 26:if(0===v)break e;p[m++]=h.length,v--,h.mode=21;break;case 27:if(h.wrap){for(;w<32;){if(0===g)break e;g--,b|=d[f++]<<w,w+=8}if(S-=v,c.total_out+=S,h.total+=S,S&&(c.adler=h.check=h.flags?r(h.check,p,S,m-S):t(h.check,p,S,m-S)),S=v,(h.flags?b:l(b))!==h.check){c.msg="incorrect data check",h.mode=s;break}b=0,w=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;w<32;){if(0===g)break e;g--,b+=d[f++]<<w,w+=8}if(b!==(4294967295&h.total)){c.msg="incorrect length check",h.mode=s;break}b=0,w=0}h.mode=29;case 29:O=1;break e;case s:O=-3;break e;case 31:return-4;default:return o}return c.next_out=m,c.avail_out=v,c.next_in=f,c.avail_in=g,h.hold=b,h.bits=w,(h.wsize||S!==c.avail_out&&h.mode<s&&(h.mode<27||4!==u))&&_(c,c.output,c.next_out,S-c.avail_out),x-=c.avail_in,S-=c.avail_out,c.total_in+=x,c.total_out+=S,h.total+=S,h.wrap&&S&&(c.adler=h.check=h.flags?r(h.check,p,S,c.next_out-S):t(h.check,p,S,c.next_out-S)),c.data_type=h.bits+(h.last?64:0)+(h.mode===a?128:0)+(20===h.mode||15===h.mode?256:0),(0===x&&0===S||4===u)&&0===O&&(O=-5),O},inflate.inflateEnd=function(e){if(!e||!e.state)return o;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflate.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?(r.head=t,t.done=!1,0):o},inflate.inflateSetDictionary=function(e,r){var n,i=r.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?o:11===n.mode&&t(1,r,i,0)!==n.check?-3:_(e,r,i,i)?(n.mode=31,-4):(n.havedict=1,0):o},inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}function requireConstants(){return hasRequiredConstants?constants:(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function requireBinding(){return hasRequiredBinding||(hasRequiredBinding=1,function(e){var t=requireAssert(),r=requireZstream(),n=requireDeflate(),i=requireInflate(),o=requireConstants();for(var a in o)e[a]=o[a];e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7;function s(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}s.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,t(this.init_done,"close before init"),t(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?n.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||i.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},s.prototype.write=function(e,t,r,n,i,o,a){return this._write(!0,e,t,r,n,i,o,a)},s.prototype.writeSync=function(e,t,r,n,i,o,a){return this._write(!1,e,t,r,n,i,o,a)},s.prototype._write=function(r,n,i,o,a,s,l,c){if(t.equal(arguments.length,8),t(this.init_done,"write before init"),t(this.mode!==e.NONE,"already finalized"),t.equal(!1,this.write_in_progress,"write already in progress"),t.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,t.equal(!1,void 0===n,"must provide flush value"),this.write_in_progress=!0,n!==e.Z_NO_FLUSH&&n!==e.Z_PARTIAL_FLUSH&&n!==e.Z_SYNC_FLUSH&&n!==e.Z_FULL_FLUSH&&n!==e.Z_FINISH&&n!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==i&&(i=Buffer.alloc(0),a=0,o=0),this.strm.avail_in=a,this.strm.input=i,this.strm.next_in=o,this.strm.avail_out=c,this.strm.output=s,this.strm.next_out=l,this.flush=n,!r)return this._process(),this._checkError()?this._afterSync():void 0;var u=this;return process$1.nextTick((function(){u._process(),u._after()})),this},s.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},s.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=n.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=i.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=i.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=i.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=i.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},s.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},s.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},s.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},s.prototype.init=function(r,n,i,o,a){t(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),t(r>=8&&r<=15,"invalid windowBits"),t(n>=-1&&n<=9,"invalid compression level"),t(i>=1&&i<=9,"invalid memlevel"),t(o===e.Z_FILTERED||o===e.Z_HUFFMAN_ONLY||o===e.Z_RLE||o===e.Z_FIXED||o===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,r,i,o,a),this._setDictionary()},s.prototype.params=function(){throw new Error("deflateParams Not supported")},s.prototype.reset=function(){this._reset(),this._setDictionary()},s.prototype._init=function(t,o,a,s,l){switch(this.level=t,this.windowBits=o,this.memLevel=a,this.strategy=s,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new r,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=n.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=i.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=l,this.write_in_progress=!1,this.init_done=!0},s.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=n.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},s.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=n.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=i.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=s}(binding)),binding}function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,function(e){var t=requireDist$1().Buffer,r=requireStreamBrowserify().Transform,n=requireBinding(),i=requireUtil$1(),o=requireAssert().ok,a=requireDist$1().kMaxLength,s="Cannot create final Buffer. It would be larger than 0x"+a.toString(16)+" bytes";n.Z_MIN_WINDOWBITS=8,n.Z_MAX_WINDOWBITS=15,n.Z_DEFAULT_WINDOWBITS=15,n.Z_MIN_CHUNK=64,n.Z_MAX_CHUNK=1/0,n.Z_DEFAULT_CHUNK=16384,n.Z_MIN_MEMLEVEL=1,n.Z_MAX_MEMLEVEL=9,n.Z_DEFAULT_MEMLEVEL=8,n.Z_MIN_LEVEL=-1,n.Z_MAX_LEVEL=9,n.Z_DEFAULT_LEVEL=n.Z_DEFAULT_COMPRESSION;for(var l=Object.keys(n),c=0;c<l.length;c++){var u=l[c];u.match(/^Z/)&&Object.defineProperty(e,u,{enumerable:!0,value:n[u],writable:!1})}for(var h={Z_OK:n.Z_OK,Z_STREAM_END:n.Z_STREAM_END,Z_NEED_DICT:n.Z_NEED_DICT,Z_ERRNO:n.Z_ERRNO,Z_STREAM_ERROR:n.Z_STREAM_ERROR,Z_DATA_ERROR:n.Z_DATA_ERROR,Z_MEM_ERROR:n.Z_MEM_ERROR,Z_BUF_ERROR:n.Z_BUF_ERROR,Z_VERSION_ERROR:n.Z_VERSION_ERROR},d=Object.keys(h),p=0;p<d.length;p++){var f=d[p];h[h[f]]=f}function m(e,r,n){var i=[],o=0;function l(){for(var t;null!==(t=e.read());)i.push(t),o+=t.length;e.once("readable",l)}function c(){var r,l=null;o>=a?l=new RangeError(s):r=t.concat(i,o),i=[],e.close(),n(l,r)}e.on("error",(function(t){e.removeListener("end",c),e.removeListener("readable",l),n(t)})),e.on("end",c),e.end(r),l()}function g(e,r){if("string"==typeof r&&(r=t.from(r)),!t.isBuffer(r))throw new TypeError("Not a string or buffer");var n=e._finishFlushFlag;return e._processChunk(r,n)}function y(e){if(!(this instanceof y))return new y(e);T.call(this,e,n.DEFLATE)}function _(e){if(!(this instanceof _))return new _(e);T.call(this,e,n.INFLATE)}function v(e){if(!(this instanceof v))return new v(e);T.call(this,e,n.GZIP)}function b(e){if(!(this instanceof b))return new b(e);T.call(this,e,n.GUNZIP)}function w(e){if(!(this instanceof w))return new w(e);T.call(this,e,n.DEFLATERAW)}function x(e){if(!(this instanceof x))return new x(e);T.call(this,e,n.INFLATERAW)}function S(e){if(!(this instanceof S))return new S(e);T.call(this,e,n.UNZIP)}function E(e){return e===n.Z_NO_FLUSH||e===n.Z_PARTIAL_FLUSH||e===n.Z_SYNC_FLUSH||e===n.Z_FULL_FLUSH||e===n.Z_FINISH||e===n.Z_BLOCK}function T(i,o){var a=this;if(this._opts=i=i||{},this._chunkSize=i.chunkSize||e.Z_DEFAULT_CHUNK,r.call(this,i),i.flush&&!E(i.flush))throw new Error("Invalid flush flag: "+i.flush);if(i.finishFlush&&!E(i.finishFlush))throw new Error("Invalid flush flag: "+i.finishFlush);if(this._flushFlag=i.flush||n.Z_NO_FLUSH,this._finishFlushFlag=void 0!==i.finishFlush?i.finishFlush:n.Z_FINISH,i.chunkSize&&(i.chunkSize<e.Z_MIN_CHUNK||i.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+i.chunkSize);if(i.windowBits&&(i.windowBits<e.Z_MIN_WINDOWBITS||i.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+i.windowBits);if(i.level&&(i.level<e.Z_MIN_LEVEL||i.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+i.level);if(i.memLevel&&(i.memLevel<e.Z_MIN_MEMLEVEL||i.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+i.memLevel);if(i.strategy&&i.strategy!=e.Z_FILTERED&&i.strategy!=e.Z_HUFFMAN_ONLY&&i.strategy!=e.Z_RLE&&i.strategy!=e.Z_FIXED&&i.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+i.strategy);if(i.dictionary&&!t.isBuffer(i.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new n.Zlib(o);var s=this;this._hadError=!1,this._handle.onerror=function(t,r){A(s),s._hadError=!0;var n=new Error(t);n.errno=r,n.code=e.codes[r],s.emit("error",n)};var l=e.Z_DEFAULT_COMPRESSION;"number"==typeof i.level&&(l=i.level);var c=e.Z_DEFAULT_STRATEGY;"number"==typeof i.strategy&&(c=i.strategy),this._handle.init(i.windowBits||e.Z_DEFAULT_WINDOWBITS,l,i.memLevel||e.Z_DEFAULT_MEMLEVEL,c,i.dictionary),this._buffer=t.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=c,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!a._handle},configurable:!0,enumerable:!0})}function A(e,t){t&&process$1.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function C(e){e.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(h),writable:!1}),e.Deflate=y,e.Inflate=_,e.Gzip=v,e.Gunzip=b,e.DeflateRaw=w,e.InflateRaw=x,e.Unzip=S,e.createDeflate=function(e){return new y(e)},e.createInflate=function(e){return new _(e)},e.createDeflateRaw=function(e){return new w(e)},e.createInflateRaw=function(e){return new x(e)},e.createGzip=function(e){return new v(e)},e.createGunzip=function(e){return new b(e)},e.createUnzip=function(e){return new S(e)},e.deflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new y(t),e,r)},e.deflateSync=function(e,t){return g(new y(t),e)},e.gzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new v(t),e,r)},e.gzipSync=function(e,t){return g(new v(t),e)},e.deflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new w(t),e,r)},e.deflateRawSync=function(e,t){return g(new w(t),e)},e.unzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new S(t),e,r)},e.unzipSync=function(e,t){return g(new S(t),e)},e.inflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new _(t),e,r)},e.inflateSync=function(e,t){return g(new _(t),e)},e.gunzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new b(t),e,r)},e.gunzipSync=function(e,t){return g(new b(t),e)},e.inflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),m(new x(t),e,r)},e.inflateRawSync=function(e,t){return g(new x(t),e)},i.inherits(T,r),T.prototype.params=function(t,r,i){if(t<e.Z_MIN_LEVEL||t>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+t);if(r!=e.Z_FILTERED&&r!=e.Z_HUFFMAN_ONLY&&r!=e.Z_RLE&&r!=e.Z_FIXED&&r!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+r);if(this._level!==t||this._strategy!==r){var a=this;this.flush(n.Z_SYNC_FLUSH,(function(){o(a._handle,"zlib binding closed"),a._handle.params(t,r),a._hadError||(a._level=t,a._strategy=r,i&&i())}))}else process$1.nextTick(i)},T.prototype.reset=function(){return o(this._handle,"zlib binding closed"),this._handle.reset()},T.prototype._flush=function(e){this._transform(t.alloc(0),"",e)},T.prototype.flush=function(e,r){var i=this,o=this._writableState;("function"==typeof e||void 0===e&&!r)&&(r=e,e=n.Z_FULL_FLUSH),o.ended?r&&process$1.nextTick(r):o.ending?r&&this.once("end",r):o.needDrain?r&&this.once("drain",(function(){return i.flush(e,r)})):(this._flushFlag=e,this.write(t.alloc(0),"",r))},T.prototype.close=function(e){A(this,e),process$1.nextTick(C,this)},T.prototype._transform=function(e,r,i){var o,a=this._writableState,s=(a.ending||a.ended)&&(!e||a.length===e.length);return null===e||t.isBuffer(e)?this._handle?(s?o=this._finishFlushFlag:(o=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||n.Z_NO_FLUSH)),void this._processChunk(e,o,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},T.prototype._processChunk=function(e,r,n){var i=e&&e.length,l=this._chunkSize-this._offset,c=0,u=this,h="function"==typeof n;if(!h){var d,p=[],f=0;this.on("error",(function(e){d=e})),o(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(r,e,c,i,this._buffer,this._offset,l)}while(!this._hadError&&_(m[0],m[1]));if(this._hadError)throw d;if(f>=a)throw A(this),new RangeError(s);var g=t.concat(p,f);return A(this),g}o(this._handle,"zlib binding closed");var y=this._handle.write(r,e,c,i,this._buffer,this._offset,l);function _(a,s){if(this&&(this.buffer=null,this.callback=null),!u._hadError){var d=l-s;if(o(d>=0,"have should not go down"),d>0){var m=u._buffer.slice(u._offset,u._offset+d);u._offset+=d,h?u.push(m):(p.push(m),f+=m.length)}if((0===s||u._offset>=u._chunkSize)&&(l=u._chunkSize,u._offset=0,u._buffer=t.allocUnsafe(u._chunkSize)),0===s){if(c+=i-a,i=a,!h)return!0;var g=u._handle.write(r,e,c,i,u._buffer,u._offset,u._chunkSize);return g.callback=_,void(g.buffer=e)}if(!h)return!1;n()}}y.buffer=e,y.callback=_},i.inherits(y,T),i.inherits(_,T),i.inherits(v,T),i.inherits(b,T),i.inherits(w,T),i.inherits(x,T),i.inherits(S,T)}(lib$1)),lib$1}function requireMapshaper(){return hasRequiredMapshaper||(hasRequiredMapshaper=1,function(e){var t=require$$8,r=requirePathBrowserify(),n=requireDist$1(),i=requireString_decoder(),o=Object.freeze({__proto__:null,get addThousandsSep(){return Oe},get addslashes(){return W},get arrayToIndex(){return _e},get clamp(){return M},get cleanNumericString(){return vt},get contains(){return oe},get copyElements(){return lt},get countValues(){return me},get createBuffer(){return ot},get default(){return o},get defaults(){return X},get difference(){return re},get endsWith(){return Ae},get every(){return se},get expandoBuffer(){return st},get extend(){return K},get extendBuffer(){return ct},get find(){return le},get findMedian(){return Qe},get findQuantile(){return Je},get findRankByValue(){return Ye},get findStringPrefix(){return ht},get findValueByPct(){return Xe},get findValueByRank(){return Ke},get forEach(){return ve},get forEachProperty(){return be},get format(){return tt},get formatDateISO(){return U},get formatIntlNumber(){return $e},get formatNumber(){return Be},get formatNumberForDisplay(){return ze},get formatVersionedName(){return pt},get formatter(){return nt},get genericSort(){return Ne},get getArrayBounds(){return de},get getGenericComparator(){return We},get getKeyComparator(){return Ge},get getSortedIds(){return je},get getUniqueName(){return C},get groupBy(){return ye},get htmlEscape(){return Y},get indexOf(){return ie},get indexOn(){return ge},get inherit(){return Q},get initializeArray(){return we},get intersection(){return ne},get isArray(){return R},get isArrayLike(){return G},get isBoolean(){return j},get isDate(){return N},get isEven(){return z},get isFiniteNumber(){return L},get isFunction(){return I},get isInteger(){return $},get isNonNegNumber(){return B},get isNumber(){return D},get isObject(){return P},get isOdd(){return F},get isPromise(){return k},get isString(){return q},get isValidNumber(){return O},get lpad(){return Ce},get ltrim(){return Me},get mean(){return et},get merge(){return te},get mergeNames(){return ut},get numToStr(){return Le},get parseIntlNumber(){return yt},get parseNumber(){return gt},get parsePercent(){return dt},get parseString(){return mt},get pluck(){return fe},get pluralSuffix(){return Te},get promisify(){return J},get quicksort(){return He},get quicksortPartition(){return Ze},get range(){return ce},get reduceAsync(){return ee},get regexEscape(){return H},get reorderArray(){return Ve},get repeat(){return ue},get repeatString(){return Se},get replaceArray(){return xe},get rpad(){return Ie},get rtrim(){return De},get shuffle(){return Fe},get some(){return ae},get sortArrayIndex(){return Ue},get sortOn(){return qe},get splitLines(){return Ee},get sum(){return he},get toArray(){return V},get toBuffer(){return at},get trim(){return ke},get trimQuotes(){return wt},get uniq(){return pe},get uniqifyNames(){return ft},get wildcardToRegExp(){return it}}),a={};function s(){this.a=1,this.c=0,this.tx=0,this.b=0,this.d=1,this.ty=0}s.prototype.transformXY=function(e,t,r){return(r=r||{}).x=e*this.a+t*this.c+this.tx,r.y=e*this.b+t*this.d+this.ty,r},s.prototype.translate=function(e,t){this.tx+=e,this.ty+=t},s.prototype.rotate=function(e,t,r){var n=Math.cos(e),i=Math.sin(e);t=t||0,r=r||0,this.a=n,this.c=-i,this.b=i,this.d=n,this.tx+=t-t*n+r*i,this.ty+=r-t*i-r*n},s.prototype.scale=function(e,t,r,n){r=r||0,n=n||0,this.a*=e,this.c*=e,this.b*=t,this.d*=t,this.tx-=r*(e-1),this.ty-=n*(t-1)};var l=void 0!==Buffer?Buffer:requireDist$1().Buffer,c={};function u(e){if(e in c!=!1)return c[e]}var h,d,p,f,m,g=Object.freeze({__proto__:null,clearStash:function(){c={}},getStashedVar:u,stashVar:function(e,t){e in c&&y("Tried to replace a stashed variable:",e),c[e]=t}});function y(){h.apply(null,o.toArray(arguments))}function _(){d.apply(null,T(arguments))}function v(){p.apply(null,T(arguments))}function b(){p(o.toArray(arguments))}function w(){u("VERBOSE")&&v.apply(null,arguments)}function x(){u("DEBUG")}function S(e){var t=new Error(e);return t.name="UserError",t}function E(e,t){var r=e.reduce((function(e,t){return Math.max(e,t.length)}),0)+2,n=Math.floor((t||80)/r)||1;return e.reduce((function(e,t,i){var a=i%n;return i>0&&0===a&&(e+="\n"),a<n-1&&(t=o.rpad(t,r-2," ")),e+"  "+t}),"")}function T(e){var t=o.toArray(e),r=u("current_command");return r&&"help"!=r&&t.unshift("["+r+"]"),t}f=function(){var e=o.toArray(arguments).join(" ");throw new Error(e)},m=function(){throw new S((e=arguments,o.toArray(e).join(" ")));var e},p=function(){},h=f,d=m;var A=0;function C(e){return(e||"__id_")+ ++A}function I(e){return"function"==typeof e}function k(e){return!!e&&I(e.then)}function P(e){return e===Object(e)}function M(e,t,r){return e<t?t:e>r?r:e}function R(e){return Array.isArray(e)}function D(e){return null!=e&&e.constructor==Number}function O(e){return D(e)&&!isNaN(e)}function L(e){return O(e)&&e!==1/0&&e!==-1/0}function B(e){return D(e)&&e>=0}function $(e){return D(e)&&(0|e)===e}function z(e){return e%2==0}function F(e){return e%2==1}function q(e){return null!=e&&e.toString===String.prototype.toString}function N(e){return!!e&&e.getTime===Date.prototype.getTime}function j(e){return!0===e||!1===e}function U(e){return N(e)?e.toISOString().replace(":00.000Z","Z"):""}function V(e){var t;G(e)||y("toArray() requires an array-like object");try{t=Array.prototype.slice.call(e,0)}catch(i){t=[];for(var r=0,n=e.length;r<n;r++)t[r]=e[r]}return t}function G(e){return!!e&&(!!R(e)||!q(e)&&(0===e.length||e.length>0))}function W(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}function H(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var Z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Y(e){return String(e).replace(/[&<>"'/]/g,(function(e){return Z[e]}))}function X(e){for(var t=1,r=arguments.length;t<r;t++){var n=arguments[t]||{};for(var i in n)i in e==!1&&n.hasOwnProperty(i)&&(e[i]=n[i])}return e}function K(e){var t,r,n,i=e||{},o=arguments.length;for(r=1;r<o;r++)for(t in n=arguments[r]||{})n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function Q(e,t){var r=function(){this.__super__==r&&(this.__super__=t.prototype.__super__,t.apply(this,arguments),delete this.__super__)};r.prototype=t.prototype||t,e.prototype=K(new r,e.prototype),e.prototype.constructor=e,e.prototype.__super__=r}function J(e){return function(){var t=V(arguments);return new Promise(((r,n)=>{t.push((function(e,t){e?n(e):r(t)})),e.apply(this,t)}))}}function ee(e,t,r,n){var i="undefined"==typeof setImmediate?setTimeout:setImmediate,o=0;!function t(a,s){if(a)return n(a,null);i((function(){o<e.length==!1?n(null,s):r(s,e[o++],t)}),0)}(null,t)}function te(e,t){R(e)&&R(t)||y("Usage: merge(destArray, srcArray);");for(var r=0,n=t.length;r<n;r++)e.push(t[r]);return e}function re(e,t){var r=_e(t);return e.filter((function(e){return!Object.prototype.hasOwnProperty.call(r,e)}))}function ne(e,t){return e.filter((function(e){return t.includes(e)}))}function ie(e,t){for(var r=t!=t,n=0,i=e.length||0;n<i;n++){if(e[n]===t)return n;if(r&&e[n]!=e[n])return n}return-1}function oe(e,t){return q(e)?-1!=e.indexOf(t):G(e)?-1!=ie(e,t):void y("Expected Array or String argument")}function ae(e,t){return e.reduce((function(e,r){return e||t(r)}),!1)}function se(e,t){return e.reduce((function(e,r){return e&&t(r)}),!0)}function le(e,t,r){var n=e.filter(t,r);return 0===n.length?null:n[0]}function ce(e,t,r){for(var n=[],i=void 0===t?0:t,o=void 0===r?1:r;e--;)n.push(i),i+=o;return n}function ue(e,t){for(var r,n=[],i=0;i<e;i++)void 0!==(r=t(i))&&(n[i]=r);return n.length>0?n:void 0}function he(e,t){G(e)||y("sum() expects an array, received:",e);for(var r,n=0,i=0,o=0,a=e.length;o<a;o++)(r=e[o])?n+=r:isNaN(r)&&i++;return t&&(t.nan=i),n}function de(e){for(var t,r=1/0,n=-1/0,i=0,o=0,a=e.length;o<a;o++)(t=e[o])!=t&&i++,t<r&&(r=t),t>n&&(n=t);return{min:r,max:n,nan:i}}function pe(e){for(var t,r=new Set,n=[],i=0,o=e.length;i<o;i++)t=e[i],r.has(t)||(n.push(t),r.add(t));return n}function fe(e,t){return e.map((function(e){return e[t]}))}function me(e){return e.reduce((function(e,t){return e[t]=t in e?e[t]+1:1,e}),{})}function ge(e,t){return e.reduce((function(e,r){return e[r[t]]=r,e}),{})}function ye(e,t){return e.reduce((function(e,r){var n=r[t];return n in e?e[n].push(r):e[n]=[r],e}),{})}function _e(e,t){var r=arguments.length>1;return e.reduce((function(e,n){return e[n]=!r||t,e}),{})}function ve(e,t,r){if(!G(e))throw new Error("#forEach() takes an array-like argument. "+e);for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n)}function be(e,t,r){Object.keys(e).forEach((function(n){t.call(r,e[n],n)}))}function we(e,t){for(var r=0,n=e.length;r<n;r++)e[r]=t;return e}function xe(e,t){e.splice(0,e.length);for(var r=0,n=t.length;r<n;r++)e.push(t[r])}function Se(e,t){for(var r="",n=0;n<t;n++)r+=e;return r}function Ee(e){return e.split(/\r?\n/)}function Te(e){return 1!=e?"s":""}function Ae(e,t){return-1!==e.indexOf(t,e.length-t.length)}function Ce(e,t,r){return Se(r=r||" ",t-(e=String(e)).length)+e}function Ie(e,t,r){return r=r||" ",(e=String(e))+Se(r,t-e.length)}function ke(e){return Me(De(e))}var Pe=/^\s+/;function Me(e){return e.replace(Pe,"")}var Re=/\s+$/;function De(e){return e.replace(Re,"")}function Oe(e){for(var t="",r="-"==e[0]?1:0,n=e.indexOf("."),i=e.length,o=(-1==n?i:n)-3;o>r;)t=","+e.substring(o,i)+t,i=o,o-=3;return e.substring(0,i)+t}function Le(e,t){return t>=0?e.toFixed(t):String(e)}function Be(e){return e+""}function $e(e){return'"'+Be(e).replace(".",",")+'"'}function ze(e,t,r,n){var i;return isNaN(e)?i=r||"-":(i=Oe(i=Le(e,t)),n&&parseFloat(i)>0&&(i="+"+i)),i}function Fe(e){var t,r,n;for(r=e.length-1;r>0;r--)n=Math.floor(Math.random()*(r+1)),t=e[r],e[r]=e[n],e[n]=t}function qe(e){for(var t=[],r=1;r<arguments.length;r+=2)t.push(Ge(arguments[r],arguments[r+1]));return e.sort((function(e,r){for(var n=0,i=0,o=t.length;i<o&&0===n;)n=t[i](e,r),i++;return n})),e}function Ne(e,t){var r=We(t);return Array.prototype.sort.call(e,r),e}function je(e,t){var r=ce(e.length);return Ue(r,e,t),r}function Ue(e,t,r){var n=We(r);e.sort((function(e,r){var i=n(t[e],t[r]);return i>0||0===i&&e>r?1:-1}))}function Ve(e,t){for(var r=t.length,n=[],i=0;i<r;i++){var o=t[i];(o<0||o>=r)&&y("Out-of-bounds array idx"),n[i]=e[o]}xe(e,n)}function Ge(e,t){var r=We(t);return function(t,n){return r(t[e],n[e])}}function We(e){return e=!1!==e&&"descending"!=e,function(t,r){var n=0;return null==r?n=null==t?0:-1:null==t?n=1:t<r?n=e?-1:1:t>r?n=e?1:-1:t!=t?n=1:r!=r&&(n=-1),n}}function He(e,t){return Ze(e,0,e.length-1),!1===t&&Array.prototype.reverse.call(e),e}function Ze(e,t,r){for(var n,i,o=t,a=r;o<r;){for(n=e[t+r>>1];o<=a;){for(;e[o]<n;)o++;for(;e[a]>n;)a--;o<=a&&(i=e[o],e[o]=e[a],e[a]=i,o++,a--)}t<a&&Ze(e,t,a),t=o,a=r}}function Ye(e,t){if(isNaN(t))return e.length;for(var r=1,n=0,i=e.length;n<i;n++)t>e[n]&&r++;return r}function Xe(e,t){return Ke(e,Math.ceil((1-t)*e.length))}function Ke(e,t){(!e.length||t<1||t>e.length)&&y("[findValueByRank()] invalid input");for(var r,n,i,o,a=(t=M(0|t,1,e.length))-1,s=0,l=e.length-1;s<l;){i=e[a],r=s,n=l;do{for(;e[r]<i;)r++;for(;i<e[n];)n--;r<=n&&(o=e[r],e[r]=e[n],e[n]=o,r++,n--)}while(r<=n);n<a&&(s=r),a<r&&(l=n)}return e[a]}function Qe(e){return Je(e,.5)}function Je(e,t){var r=e.length,n=Math.floor((r-1)*t),i=Math.ceil((r-1)*t);if(n<0||i>=r)return NaN;var o=Ke(e,n+1);return n==i?o:(o*(i/(r-1)-t)+Ke(e,i+1)*(t-n/(r-1)))*(r-1)}function et(e){for(var t,r=0,n=NaN,i=0,o=e.length;i<o;i++)t=e[i],isNaN(t)||(n=1==++r?t:t/r+(r-1)/r*n);return n}function tt(e){return nt(e).apply(null,Array.prototype.slice.call(arguments,1))}function rt(e,t){var r,n,i,o=t[1],a=t[2],s=t[3]?parseInt(t[3].substr(1)):void 0,l=t[4],c="s"==l,u="x"==l||"X"==l,h=!c,d="",p=0,f=!1,m=!1;if(c?r=String(e):u?(r=e.toString(16),"X"==l&&(r=r.toUpperCase())):h&&("-"==(r=Le(e,s))[0]&&(m=!0,r=r.substr(1)),f=0==parseFloat(r),-1==o.indexOf("'")&&-1==o.indexOf(",")||(r=Oe(r)),f||(m?d="":-1!=o.indexOf("+")&&(d="+"))),a){var g=r.length+d.length,y=parseInt(a,10);g<y&&(p=y-g,i=Se(n=-1==o.indexOf("0")?" ":"0",p))}return r=0==p?d+r:"0"==n?d+i+r:i+d+r}function nt(e){for(var t,r=/%([',+0]*)([1-9]?)((?:\.[1-9])?)([sdifxX%])/g,n=[],i=[],o=0,a="",s=r.exec(e);s;)t=e.substring(o,r.lastIndex-s[0].length),"%%"==s[0]?a+=t+"%":(n.push(a+t),a="",i.push(s)),o=r.lastIndex,s=r.exec(e);return n.push(a+e.substr(o)),function(){var t=n[0],r=arguments.length;r!=i.length&&y("[format()] Data does not match format string; format:",e,"data:",arguments);for(var o=0;o<r;o++)t+=rt(arguments[o],i[o])+n[o+1];return t}}function it(e){var t=e.split("*").map((function(e){return H(e)})).join(".*");return new RegExp("^"+t+"$")}function ot(e,t){return $(e)?l.allocUnsafe?l.allocUnsafe(e):new l(e):l.from&&l.allocUnsafe?l.from(e,t):new l(e,t)}function at(e){return e instanceof l?e:e instanceof ArrayBuffer?l.from(e):e instanceof Uint8Array?l.from(e.buffer,e.byteOffset,e.byteLength):void y("Unexpected argument type")}function st(e,t){var r,n=0,i=t>=1?t:1.2;return function(t){return t>n&&(n=Math.ceil(t*i),r=e?new e(n):ot(n)),r}}function lt(e,t,r,n,i,o){var a,s=e==r||e.buffer&&e.buffer==r.buffer,l=1,c=0;if(o&&(s&&y("copy error"),l=-1,c=i-1),s&&n>t)for(a=i-1;a>=0;a--)r[n+a]=e[t+a];else for(a=0;a<i;a++,c+=l)r[a+n]=e[t+c]}function ct(e,t,r){var n=Math.max(e.length,t),i=r||e.length,o=new e.constructor(n);return lt(e,0,o,0,i),o}function ut(e,t){var r;return e&&t&&(r=ht(e,t).replace(/[-_]$/,"")),r||""}function ht(e,t){for(var r=0,n=e.length;r<n&&e[r]===t[r];r++);return e.substr(0,r)}function dt(e){var t,r=String(e);return(t=r.indexOf("%")>0?Number(r.replace("%",""))/100:Number(r))>=0&&t<=1||_(tt("Invalid percentage: %s",r)),t}function pt(e,t){var r=String(t);return/[0-9]$/.test(e)&&(r="-"+r),e+r}function ft(e,t){var r=me(e),n=t||pt,i=[];return e.forEach((function(e){for(var t,o=0,a=e;i.indexOf(a)>-1||a==e&&r[a]>1||a!=e&&r[a]>0;){if(o++,!(t=n(e,o))||t==a)throw new Error("Naming error");a=t}i.push(a)})),i}function mt(e){return e||""}function gt(e){return _t(e,vt)}function yt(e){return _t(e,bt)}function _t(e,t){var r=String(e).trim(),n=r?Number(t(r)):NaN;return isNaN(n)?null:n}function vt(e){return e.indexOf(",")>0?e.replace(/,([0-9]{3})/g,"$1"):e}function bt(e){return(e=e.replace(/[ .]([0-9]{3})/g,"$1")).replace(",",".")}function wt(e){var t,r,n=e.length;return n>=2&&(t=e.charAt(0),r=e.charAt(n-1),('"'==t&&'"'==r&&!e.includes('","')||"'"==t&&"'"==r&&!e.includes("','"))&&(e=(e=e.substr(1,n-2)).replace('"'==t?/\\(?=")/g:/\\(?=')/g,""))),e}function xt(){this.mx=this.my=1,this.bx=this.by=0}function St(){arguments.length>0&&this.setBounds.apply(this,arguments)}xt.prototype.isNull=function(){return!this.mx||!this.my||isNaN(this.bx)||isNaN(this.by)},xt.prototype.invert=function(){var e=new xt;return e.mx=1/this.mx,e.my=1/this.my,e.bx=-this.bx/this.mx,e.by=-this.by/this.my,e},xt.prototype.transform=function(e,t,r){return(r=r||[])[0]=e*this.mx+this.bx,r[1]=t*this.my+this.by,r},xt.prototype.toString=function(){return JSON.stringify(Object.assign({},this))},St.from=function(){var e=new St;return e.setBounds.apply(e,arguments)},St.prototype.toString=function(){return JSON.stringify({xmin:this.xmin,xmax:this.xmax,ymin:this.ymin,ymax:this.ymax})},St.prototype.toArray=function(){return this.hasBounds()?[this.xmin,this.ymin,this.xmax,this.ymax]:[]},St.prototype.hasBounds=function(){return this.xmin<=this.xmax&&this.ymin<=this.ymax},St.prototype.sameBounds=St.prototype.equals=function(e){return e&&this.xmin===e.xmin&&this.xmax===e.xmax&&this.ymin===e.ymin&&this.ymax===e.ymax},St.prototype.width=function(){return this.xmax-this.xmin||0},St.prototype.height=function(){return this.ymax-this.ymin||0},St.prototype.area=function(){return this.width()*this.height()||0},St.prototype.empty=function(){return this.xmin=this.ymin=this.xmax=this.ymax=void 0,this},St.prototype.setBounds=function(e,t,r,n){return 1==arguments.length&&(o.isArrayLike(e)?(t=e[1],r=e[2],n=e[3],e=e[0]):(t=e.ymin,r=e.xmax,n=e.ymax,e=e.xmin)),this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,(e>r||t>n)&&this.update(),this},St.prototype.centerX=function(){return.5*(this.xmin+this.xmax)},St.prototype.centerY=function(){return.5*(this.ymax+this.ymin)},St.prototype.containsPoint=function(e,t){return e>=this.xmin&&e<=this.xmax&&t<=this.ymax&&t>=this.ymin},St.prototype.containsBufferedPoint=St.prototype.containsCircle=function(e,t,r){return e+r>this.xmin&&e-r<this.xmax&&t-r<this.ymax&&t+r>this.ymin},St.prototype.intersects=function(e){return e.xmin<=this.xmax&&e.xmax>=this.xmin&&e.ymax>=this.ymin&&e.ymin<=this.ymax},St.prototype.contains=function(e){return e.xmin>=this.xmin&&e.ymax<=this.ymax&&e.xmax<=this.xmax&&e.ymin>=this.ymin},St.prototype.shift=function(e,t){this.setBounds(this.xmin+e,this.ymin+t,this.xmax+e,this.ymax+t)},St.prototype.padBounds=function(e,t,r,n){this.xmin-=e,this.ymin-=t,this.xmax+=r,this.ymax+=n},St.prototype.scale=function(e,t){var r=.5*(this.xmax-this.xmin),n=.5*(this.ymax-this.ymin),i=e-1,o=void 0===t?i:t-1;return this.xmin-=r*i,this.ymin-=n*o,this.xmax+=r*i,this.ymax+=n*o,this},St.prototype.cloneBounds=St.prototype.clone=function(){return new St(this.xmin,this.ymin,this.xmax,this.ymax)},St.prototype.clearBounds=function(){this.setBounds(new St)},St.prototype.mergePoint=function(e,t){void 0===this.xmin?this.setBounds(e,t,e,t):(e<this.xmin?this.xmin=e:e>this.xmax&&(this.xmax=e),t<this.ymin?this.ymin=t:t>this.ymax&&(this.ymax=t))},St.prototype.fillOut=function(e,t,r){arguments.length<3&&(t=.5,r=.5);var n,i=this.width(),o=this.height(),a=i/o;return isNaN(e)||e<=0||(a<e?(n=o*e-i,this.xmin-=(1-t)*n,this.xmax+=t*n):(n=i/e-o,this.ymin-=(1-r)*n,this.ymax+=r*n)),this},St.prototype.update=function(){var e;this.xmin>this.xmax&&(e=this.xmin,this.xmin=this.xmax,this.xmax=e),this.ymin>this.ymax&&(e=this.ymin,this.ymin=this.ymax,this.ymax=e)},St.prototype.transform=function(e){return this.xmin=this.xmin*e.mx+e.bx,this.xmax=this.xmax*e.mx+e.bx,this.ymin=this.ymin*e.my+e.by,this.ymax=this.ymax*e.my+e.by,this.update(),this},St.prototype.getTransform=function(e,t){var r=new xt;return r.mx=e.width()/this.width()||1,r.bx=e.xmin-r.mx*this.xmin,t?(r.my=-e.height()/this.height()||1,r.by=e.ymax-r.my*this.ymin):(r.my=e.height()/this.height()||1,r.by=e.ymin-r.my*this.ymin),r},St.prototype.mergeCircle=function(e,t,r){r<0&&(r=-r),this.mergeBounds([e-r,t-r,e+r,t+r])},St.prototype.mergeBounds=function(e){var t,r,n,i;return e instanceof St?(t=e.xmin,r=e.ymin,n=e.xmax,i=e.ymax):4==arguments.length?(t=arguments[0],r=arguments[1],n=arguments[2],i=arguments[3]):4==e.length?(t=e[0],r=e[1],n=e[2],i=e[3]):y("Bounds#mergeBounds() invalid argument:",e),void 0===this.xmin?this.setBounds(t,r,n,i):(t<this.xmin&&(this.xmin=t),r<this.ymin&&(this.ymin=r),n>this.xmax&&(this.xmax=n),i>this.ymax&&(this.ymax=i)),this};var Et="function"==typeof commonjsRequire?commonjsRequire:function(){};function Tt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var At,Ct={exports:{}};var It,kt=(At||(At=1,It=Ct,function(){var e=Math.abs,n=Math.floor,i=Math.sin,o=Math.cos,a=Math.tan,s=Math.asin,l=Math.acos,c=Math.atan,u=Math.atan2,h=Math.sqrt,d=Math.pow,p=Math.exp,f=Math.log,m=Math.hypot,g=Math.sinh,y=Math.cosh,_=Math.min,v=Math.max,b=1/0,w=Math.PI,x=57.29577951308232,S=.017453292519943295,E=6378137,T=.0066943799901413165,A=w/4,C=w/2,I=1.5*w,k=2*w,P=2/w,M=-45,R=-47,D=1e-10,O={last_errno:0,debug_level:0,logger:null},L=["no arguments in initialization list","no options found in 'init' file","invalid init= string","projection not named","unknown projection id","effective eccentricity = 1","unknown unit conversion id","invalid boolean param argument","unknown elliptical parameter name","reciprocal flattening (1/f) = 0","|radius reference latitude| > 90","squared eccentricity < 0","major axis or radius = 0 or not given","latitude or longitude exceeded limits","invalid x or y","improperly formed DMS value","non-convergent inverse meridional dist","non-convergent inverse phi2","acos/asin: |arg| >1+1e-14","tolerance condition error","conic lat_1 = -lat_2","lat_1 >= 90","lat_1 = 0","lat_ts >= 90","no distance between control points","projection not selected to be rotated","W <= 0 or M <= 0","lsat not in 1-5 range","path not in range","h <= 0","k <= 0","lat_0 = 0 or 90 or alpha = 90","lat_1=lat_2 or lat_1=0 or lat_2=90","elliptical usage required","invalid UTM zone number","arg(s) out of range for Tcheby eval","failed to find projection to be rotated","failed to load datum shift file","both n & m must be spec'd and > 0","n <= 0, n > 1 or not specified","lat_1 or lat_2 not specified","|lat_1| == |lat_2|","lat_0 is pi/2 from mean lat","unparseable coordinate system definition","geocentric transformation missing z or ellps","unknown prime meridian conversion id","illegal axis orientation combination","point not within available datum shift grids","invalid sweep axis, choose x or y","invalid value for h","point outside of projection domain"];function B(){var e=O.last_errno;e&&(e>0||!function(e){return $.indexOf(e)>-1}(e))&&j(e)}var $=[-14,-15,-17,-18,-19,-20,-27,-48];function z(e){O.last_errno=e}function F(){z(-20)}function q(){z(-20)}function N(e){j(e)}function j(e){z(e),U()}function U(e,t){var r;throw t||(t={}),t.code||(t.code=O.last_errno||0),e||(r=t.code,e=L[~r]||"unknown error"),O.last_errno=0,new V(e,t)}function V(e,t){var r=new Error(e);return r.name="ProjError",Object.keys(t).forEach((function(e){r[e]=t[e]})),r}function G(e){return W(e)*S}function W(e){var t=/(-?[0-9.]+)d?([0-9.]*)'?([0-9.]*)"?([nsew]?)$/i.exec(e),r=NaN;return t&&(r=+(t[1]||"0")+ +(t[2]||"0")/60+ +(t[3]||"0")/3600,/[ws]/i.test(t[4])&&(r=-r)),isNaN(r)&&j(-16),r}function H(e){return Z(e)}function Z(e){return parseFloat(e)}function Y(e,t){var r,n,i=t[0],o=e[t.substr(1)],a=void 0!==o;return"t"==i?r=a:a?(n=o.param,o.used=!0,"i"==i?r=parseInt(n):"d"==i?r=H(n):"r"==i?r=G(n):"s"==i?r=String(n):"b"==i&&("T"==n||"t"==n||!0===n?r=!0:("F"==n||"f"==n||z(-8),r=!1))):r={i:0,b:!1,d:0,r:0,s:""}[i],void 0===r&&U("invalid request to pj_param, fatal"),r}function X(e){for(var t,r=/\+([a-z][a-z0-9_]*(?:=[^\s]*)?)/gi,n={};t=r.exec(e);)K(n,t[1]);return n}function K(e,t){var r,n,i=t.split("=");1==i.length?(r=t,n=!0):(r=i[0],n=t.substr(i[0].length+1)),e[r]={used:!1,param:n}}var Q={};function J(e,t,r,n){Q[t]={init:e,name:r,description:n}}function ee(e){return!e||e.is_latlong}function te(e){var t=!1,r="";return"datum"in e.params?(t=!0,r+=ne(e,"datum")):"R"in e.params?r+=ne(e,"R"):"ellps"in e.params?r+=ne(e,"ellps"):"a"in e.params?(r+=ne(e,"a"),"b"in e.params?r+=ne(e,"b"):"es"in e.params?r+=ne(e,"es"):"f"in e.params?r+=ne(e,"f"):r+=" +es="+e.es):N(-13),t||(r+=ne(e,"towgs84"),r+=ne(e,"nadgrids")),r+=ne(e,"R_A"),r+=ne(e,"R_V"),r+=ne(e,"R_a"),r+=ne(e,"R_lat_a"),r+=ne(e,"R_lat_g"),r+=ne(e,"pm")}function re(e){var t="datum,ellps,a,b,es,rf,f,towgs84,nadgrids,R,R_A,R_V,R_a,R_lat_a,R_lat_g,pm,init,no_defs".split(","),r="";return Object.keys(e.params).forEach((function(n){-1==t.indexOf(n)&&(r+=ne(e,n))})),(r+=te(e)).trim()}function ne(e,t){var r="";return t in e.params&&(r=" +"+t,!0!==e.params[t].param&&(r+="="+Y(e.params,"s"+t))),r}var ie=[["WGS84","towgs84=0,0,0","WGS84","WGS_1984"],["GGRS87","towgs84=-199.87,74.79,246.62","GRS80","Greek_Geodetic_Reference_System_1987"],["NAD83","towgs84=0,0,0","GRS80","North_American_Datum_1983"],["NAD27","nadgrids=@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat","clrk66","North_American_Datum_1927"],["potsdam","towgs84=598.1,73.7,418.2,0.202,0.045,-2.455,6.7","bessel","Potsdam Rauenberg 1950 DHDN"],["carthage","towgs84=-263.0,6.0,431.0","clrk80ign","Carthage 1934 Tunisia"],["hermannskogel","towgs84=577.326,90.129,463.919,5.137,1.474,5.297,2.4232","bessel","Hermannskogel"],["ire65","towgs84=482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15","mod_airy","Ireland 1965"],["nzgd49","towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993","intl","New Zealand Geodetic Datum 1949"],["OSGB36","towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894","airy","OSGB 1936"],[null,null,null,null]],oe=[["greenwich","0dE"],["lisbon","9d07'54.862\"W"],["paris","2d20'14.025\"E"],["bogota","74d04'51.3\"W"],["madrid","3d41'16.58\"W"],["rome","12d27'8.4\"E"],["bern","7d26'22.5\"E"],["jakarta","106d48'27.79\"E"],["ferro","17d40'W"],["brussels","4d22'4.71\"E"],["stockholm","18d3'29.8\"E"],["athens","23d42'58.815\"E"],["oslo","10d43'22.5\"E"],[null,null]];function ae(e){var t=ie.reduce((function(t,r){return r[0]===e?r:t}),null);return t?{id:t[0],defn:t[1],ellipse_id:t[2],name:t[3]}:null}var se=[["MERIT","a=6378137.0","rf=298.257","MERIT 1983"],["SGS85","a=6378136.0","rf=298.257","Soviet Geodetic System 85"],["GRS80","a=6378137.0","rf=298.257222101","GRS 1980(IUGG, 1980)"],["IAU76","a=6378140.0","rf=298.257","IAU 1976"],["airy","a=6377563.396","b=6356256.910","Airy 1830"],["APL4.9","a=6378137.0","rf=298.25","Appl. Physics. 1965"],["NWL9D","a=6378145.0","rf=298.25","Naval Weapons Lab., 1965"],["mod_airy","a=6377340.189","b=6356034.446","Modified Airy"],["andrae","a=6377104.43","rf=300.0","Andrae 1876 (Den., Iclnd.)"],["aust_SA","a=6378160.0","rf=298.25","Australian Natl & S. Amer. 1969"],["GRS67","a=6378160.0","rf=298.2471674270","GRS 67(IUGG 1967)"],["bessel","a=6377397.155","rf=299.1528128","Bessel 1841"],["bess_nam","a=6377483.865","rf=299.1528128","Bessel 1841 (Namibia)"],["clrk66","a=6378206.4","b=6356583.8","Clarke 1866"],["clrk80","a=6378249.145","rf=293.4663","Clarke 1880 mod."],["clrk80ign","a=6378249.2","rf=293.4660212936269","Clarke 1880 (IGN)."],["CPM","a=6375738.7","rf=334.29","Comm. des Poids et Mesures 1799"],["delmbr","a=6376428","rf=311.5","Delambre 1810 (Belgium)"],["engelis","a=6378136.05","rf=298.2566","Engelis 1985"],["evrst30","a=6377276.345","rf=300.8017","Everest 1830"],["evrst48","a=6377304.063","rf=300.8017","Everest 1948"],["evrst56","a=6377301.243","rf=300.8017","Everest 1956"],["evrst69","a=6377295.664","rf=300.8017","Everest 1969"],["evrstSS","a=6377298.556","rf=300.8017","Everest (Sabah & Sarawak)"],["fschr60","a=6378166","rf=298.3","Fischer (Mercury Datum) 1960"],["fschr60m","a=6378155","rf=298.3","Modified Fischer 1960"],["fschr68","a=6378150","rf=298.3","Fischer 1968"],["helmert","a=6378200","rf=298.3","Helmert 1906"],["hough","a=6378270.0","rf=297","Hough"],["intl","a=6378388.0","rf=297","International 1909 (Hayford)"],["krass","a=6378245.0","rf=298.3","Krasovsky 1940"],["kaula","a=6378163","rf=298.24","Kaula 1961"],["lerch","a=6378139","rf=298.257","Lerch 1979"],["mprts","a=6397300","rf=191","Maupertius 1738"],["new_intl","a=6378157.5","b=6356772.2","New International 1967"],["plessis","a=6376523","b=6355863","Plessis 1817 (France)"],["SEasia","a=6378155.0","b=6356773.3205","Southeast Asia"],["walbeck","a=6376896.0","b=6355834.8467","Walbeck"],["WGS60","a=6378165.0","rf=298.3","WGS 60"],["WGS66","a=6378145.0","rf=298.25","WGS 66"],["WGS72","a=6378135.0","rf=298.26","WGS 72"],["WGS84","a=6378137.0","rf=298.257223563","WGS 84"],["sphere","a=6370997.0","b=6370997.0","Normal Sphere (r=6370997)"],[null,null,null,null]];function le(e){var t=se.reduce((function(t,r){return r[0]===e?r:t}),null);return t?{id:t[0],major:t[1],ell:t[2],name:t[3]}:null}var ce=[["km","1000","Kilometer"],["m","1","Meter"],["dm","1/10","Decimeter"],["cm","1/100","Centimeter"],["mm","1/1000","Millimeter"],["kmi","1852.0","International Nautical Mile"],["in","0.0254","International Inch"],["ft","0.3048","International Foot"],["yd","0.9144","International Yard"],["mi","1609.344","International Statute Mile"],["fath","1.8288","International Fathom"],["ch","20.1168","International Chain"],["link","0.201168","International Link"],["us-in","1/39.37","U.S. Surveyor's Inch"],["us-ft","0.304800609601219","U.S. Surveyor's Foot"],["us-yd","0.914401828803658","U.S. Surveyor's Yard"],["us-ch","20.11684023368047","U.S. Surveyor's Chain"],["us-mi","1609.347218694437","U.S. Surveyor's Statute Mile"],["ind-yd","0.91439523","Indian Yard"],["ind-ft","0.30479841","Indian Foot"],["ind-ch","20.11669506","Indian Chain"],[null,null,null]];function ue(e){var t=ce.reduce((function(t,r){return e===r[0]?r:t}),null);return t?{id:t[0],to_meter:t[1],name:t[2]}:null}var he={},de={};function pe(e){return de[e]||null}function fe(e){var n,i,o,a,s,l,c,u,h=e.split(":"),d=h[0],p=h[1];return p&&d||N(-3),(n=pe(d=d.toLowerCase()))||(i=d,a=t,l=(s=r).join(s.dirname(__filename),"../nad"),c=s.join(l,i.toUpperCase()),u=s.join(l,i.toLowerCase()),a.existsSync(c)?o=a.readFileSync(c,"utf8"):a.existsSync(u)?o=a.readFileSync(u,"utf8"):U("unable to read from 'init' file named "+i),n=o,de[d]=n),n?function(e,t){var r,n,i="",o="";return(r=e.indexOf("<"+t+">"))>-1&&((n=e.lastIndexOf("#",r))>-1&&(o=e.substring(n+1,r).trim(),/\n/.test(o)&&(o="")),i=(i=(i=" "+(i=(i=(i=(i=(i=e.substr(r+t.length+2)).substr(0,i.indexOf("<"))).replace(/#.*/g,"")).replace(/[\s]+/g," ")).replace(/\+title=[^+]*[^ +]/g,(function(e){return e.replace(/ /g,"\t")})))).replace(/ (?=[a-z])/gi," +")).replace(/\t/g," ").trim()),i?{opts:i,comment:o}:null}(n,p):null}function me(t){var r,n,o=X(t),a={params:o,is_latlong:!1,is_geocent:!1,is_long_wrap_set:!1,long_wrap_center:0,axis:"enu",gridlist:null,gridlist_count:0,vgridlist_geoid:null,vgridlist_geoid_count:0};return Object.keys(o).length||N(-1),Y(o,"tinit")&&function(e,t){var r=he[t.toLowerCase()]||null;r||function(e,t){he[e.toLowerCase()]=t}(t,r=fe(t)),r||N(-2),ge(e,r.opts)}(o,Y(o,"sinit")),(r=Y(o,"sproj"))||N(-4),(n=Q[r])||N(-5),Y(o,"bno_defs")||function(e){ge(e,"+ellps=WGS84")}(a.params),function(e){var t,r,n,i,o=484813681109536e-20,a=e.datum_params=[0,0,0,0,0,0,0];e.datum_type=0,(t=Y(e.params,"sdatum"))&&((r=ae(t))||N(-9),r.ellipse_id&&K(e.params,"ellps="+r.ellipse_id),r.defn&&K(e.params,r.defn)),(n=Y(e.params,"snadgrids"))&&"@null"!=n&&U("+nadgrids is not implemented"),Y(e.params,"scatalog")&&U("+catalog is not implemented"),(i=Y(e.params,"stowgs84"))&&(i.split(",").forEach((function(e,t){a[t]=H(e)||0})),0!=a[3]||0!=a[4]||0!=a[5]||0!=a[6]?(e.datum_type=2,a[3]*=o,a[4]*=o,a[5]*=o,a[6]=a[6]/1e6+1):e.datum_type=1)}(a),function(t){var r,n,o,a,s,l=.16666666666666666,c=t.params,u=0,d=0;Y(c,"tR")?u=Y(c,"dR"):((r=Y(c,"sellps"))&&((n=le(r))||N(-9),K(c,n.major),K(c,n.ell)),u=Y(c,"da"),Y(c,"tes")?d=Y(c,"des"):Y(c,"te")?d=(o=Y(c,"de"))*o:Y(c,"trf")?((o=Y(c,"drf"))||N(-10),d=(o=1/o)*(2-o)):Y(c,"tf")?d=(o=Y(c,"df"))*(2-o):Y(c,"tb")&&(d=1-(a=Y(c,"db"))*a/(u*u)),a||(a=u*h(1-d)),Y(c,"bR_A")?(u*=1-d*(l+d*(.04722222222222222+.022156084656084655*d)),d=0):Y(c,"bR_V")?u*=1-d*(l+d*(.06944444444444445+.04243827160493827*d)):Y(c,"bR_a")?(u=.5*(u+a),d=0):Y(c,"bR_g")?(u=h(u*a),d=0):Y(c,"bR_h")?(u+a===0&&N(-20),u=2*u*a/(u+a),d=0):(s=Y(c,"tR_lat_a")||Y(c,"tR_lat_g"))&&(o=i(Y(c,s?"rR_lat_a":"rR_lat_g")),e(o)>C&&N(-11),o=1-d*o*o,u*=s?.5*(1-d+o)/(o*h(o)):h(1-d)/o,d=0)),d<0&&N(-12),u<=0&&N(-13),t.es=d,t.a=u}(a),a.a_orig=a.a,a.es_orig=a.es,a.e=h(a.es),a.ra=1/a.a,a.one_es=1-a.es,a.one_es||N(-6),a.rone_es=1/a.one_es,function(e){return 1==e.datum_type&&e.datum_params[0]==e.datum_params[1]==e.datum_params[2]===0&&6378137==e.a&&Math.abs(e.es-.00669437999)<5e-11}(a)&&(a.datum_type=4),a.geoc=!!a.es&&Y(o,"bgeoc"),a.over=Y(o,"bover"),a.has_geoid_vgrids=Y(o,"tgeoidgrids"),a.has_geoid_vgrids&&Y(o,"sgeoidgrids"),a.is_long_wrap_set=Y(o,"tlon_wrap"),a.is_long_wrap_set&&(a.long_wrap_center=Y(o,"rlon_wrap"),e(a.long_wrap_center)<10*k==0&&N(-14)),Y(o,"saxis")&&function(e){var t="ewnsud",r=Y(e.params,"saxis");3!=r.length&&N(R),-1!=t.indexOf(r[0])&&-1!=t.indexOf(r[1])&&-1!=t.indexOf(r[2])||N(R),e.axis=r}(a),a.lam0=Y(o,"rlon_0"),a.phi0=Y(o,"rlat_0"),a.x0=Y(o,"dx_0"),a.y0=Y(o,"dy_0"),Y(o,"tk_0")?a.k0=Y(o,"dk_0"):Y(o,"tk")?a.k0=Y(o,"dk"):a.k0=1,a.k0<=0&&N(-31),function(e){var t,r,n,i=e.params;(t=Y(i,"sunits"))&&((n=ue(t))||N(-7),r=n.to_meter),r||(r=Y(i,"sto_meter"))?(e.to_meter=ye(r),e.fr_meter=1/e.to_meter):e.to_meter=e.fr_meter=1,r=null,(t=Y(i,"svunits"))&&((n=ue(t))||N(-7),r=n.to_meter),r||Y(i,"svto_meter")?(e.vto_meter=ye(r),e.vfr_meter=1/e.vto_meter):(e.vto_meter=e.to_meter,e.vfr_meter=e.fr_meter)}(a),function(e){var t,r,n,i=e.params;(t=Y(i,"spm"))?(r=function(e){var t=oe.reduce((function(t,r){return r[0]===e?r:t}),null);return t?{id:t[0],definition:t[1]}:null}(t),n=G(r?r.definition:t),isNaN(n)&&N(-46),e.from_greenwich=n):e.from_greenwich=0}(a),n.init(a),a}function ge(e,t){var r=X(t),n=["datum","ellps","a","b","rf","f"].reduce((function(t,r){return t||r in e}),!1);Object.keys(r).forEach((function(t){t in e||"ellps"==t&&n||(e[t]=r[t])}))}function ye(e){var t=e.split("/"),r=Z(t[0]);return t.length>1&&(r/=Z(t[1])),r}function _e(e,t){var r=0,n=e*e,i=t*t;return e<=0&&(r|=4),t<=0&&(r|=8),e<t&&(r|=16),r?null:{a:e,b:t,a2:n,b2:i,e2:(n-i)/n,ep2:(n-i)/i}}function ve(e,t,r,n,a){var s,l,c,u,d=0,p=r[t],f=n[t],m=a[t];return f<-C&&f>-1.001*C?f=-C:f>C&&f<1.001*C?f=C:(f<-C||f>C)&&(d|=1),d||(p>w&&(p-=2*w),l=i(f),u=o(f),c=l*l,s=e.a/h(1-e.e2*c),r[t]=(s+m)*u*o(p),n[t]=(s+m)*u*i(p),a[t]=(s*(1-e.e2)+m)*l),d}function be(t,r,n,i,o){var a,s,l,d,p,f,m,g,y,_,v,b,w,x,S,E,T=1e-12,A=n[r],I=i[r],k=o[r];if(d=h(A*A+I*I),p=h(A*A+I*I+k*k),d/t.a<T){if(s=0,p/t.a<T)return n[r]=0,i[r]=C,o[r]=-t.b,0}else s=u(I,A);f=k/p,m=d/p,g=1/h(1-t.e2*(2-t.e2)*m*m),v=m*(1-t.e2)*g,b=f*g,E=0;do{E++,l=d*v+k*b-(y=t.a/h(1-t.e2*b*b))*(1-t.e2*b*b),_=t.e2*y/(y+l),S=(x=f*(g=1/h(1-_*(2-_)*m*m)))*v-(w=m*(1-_)*g)*b,v=w,b=x}while(S*S>1e-24&&E<30);a=c(x/e(w)),n[r]=s,i[r]=a,o[r]=l}function we(e,t,r){var n=r.length>2,i=[r[0]],o=[r[1]],a=[n?r[2]:0];e.is_latlong&&(i[0]*=S,o[0]*=S),O.last_errno=0,xe(e,t,i,o,a),(O.last_errno||i[0]==b)&&U(null,{point:r}),t.is_latlong&&(i[0]*=x,o[0]*=x),r[0]=i[0],r[1]=o[0],n&&(r[2]=a[0])}function xe(e,t,r,n,i){var o,a,s=r.length,l={},c={};if("enu"!=e.axis&&Se(e.axis,!1,r,n,i),1!=e.vto_meter&&i)for(o=0;o<s;o++)i[o]*=e.vto_meter;if(e.is_geocent){if(i||N(M),1!=e.to_meter)for(o=0;o<s;o++)r[o]!=b&&(r[o]*=e.to_meter,n[o]*=e.to_meter);Ee(e.a_orig,e.es_orig,r,n,i)}else if(!e.is_latlong)if(e.inv3d||e.inv||U("source projection not invertible"),e.inv3d)U("inverse 3d transformations not supported");else for(o=0;o<s;o++)c.x=r[o],c.y=n[o],a=Ie(c,e),r[o]=a.lam,n[o]=a.phi,B();if(0!==e.from_greenwich)for(o=0;o<s;o++)r[o]!=b&&(r[o]+=e.from_greenwich);if(e.has_geoid_vgrids&&i&&U("vgrid transformation not supported"),function(e,t,r,n,i){var o,a,s,l,c=r.length;0!=e.datum_type&&0!=t.datum_type&&(function(e,t){return e.datum_type==t.datum_type&&!(e.a_orig!=t.a_orig||Math.abs(e.es_orig-t.es_orig)>5e-11)&&(1==e.datum_type?e.datum_params[0]==t.datum_params[0]&&e.datum_params[1]==t.datum_params[1]&&e.datum_params[2]==t.datum_params[2]:2==e.datum_type?e.datum_params[0]==t.datum_params[0]&&e.datum_params[1]==t.datum_params[1]&&e.datum_params[2]==t.datum_params[2]&&e.datum_params[3]==t.datum_params[3]&&e.datum_params[4]==t.datum_params[4]&&e.datum_params[5]==t.datum_params[5]&&e.datum_params[6]==t.datum_params[6]:3!=e.datum_type||Y(e.params,"snadgrids")==Y(t.params,"snadgrids"))}(e,t)||(o=e.a_orig,a=e.es_orig,s=t.a_orig,l=t.es_orig,i||(i=new Float64Array(c)),3==e.datum_type&&(U("gridshift not implemented"),o=E,a=T),3==t.datum_type&&(s=E,l=T),a==l&&o==s&&1!=e.datum_type&&2!=e.datum_type&&1!=t.datum_type&&2!=t.datum_type||(Te(o,a,r,n,i),1!=e.datum_type&&2!=e.datum_type||function(e,t,r,n){var i,o,a,s,l,c,u,h,d=t.length,p=e.datum_params,f=p[0],m=p[1],g=p[2];if(1==e.datum_type)for(h=0;h<d;h++)t[h]!=b&&(t[h]+=f,r[h]+=m,n[h]+=g);else if(2==e.datum_type)for(s=p[3],l=p[4],c=p[5],u=p[6],h=0;h<d;h++)t[h]!=b&&(i=u*(t[h]-c*r[h]+l*n[h])+f,o=u*(c*t[h]+r[h]-s*n[h])+m,a=u*(-l*t[h]+s*r[h]+n[h])+g,t[h]=i,r[h]=o,n[h]=a)}(e,r,n,i),1!=t.datum_type&&2!=t.datum_type||function(e,t,r,n){var i,o,a,s,l,c,u,h,d=t.length,p=e.datum_params,f=p[0],m=p[1],g=p[2];if(1==e.datum_type)for(h=0;h<d;h++)t[h]!=b&&(t[h]-=f,r[h]-=m,n[h]-=g);else if(2==e.datum_type)for(s=p[3],l=p[4],c=p[5],u=p[6],h=0;h<d;h++)t[h]!=b&&(i=(t[h]-f)/u,o=(r[h]-m)/u,a=(n[h]-g)/u,t[h]=i+c*o-l*a,r[h]=-c*i+o+s*a,n[h]=l*i-s*o+a)}(t,r,n,i),Ee(s,l,r,n,i),3==t.datum_type&&pj_apply_gridshift_2(t,1,r,n,i))))}(e,t,r,n,i),t.has_geoid_vgrids&&i&&U("vgrid transformation not supported"),0!==t.from_greenwich)for(o=0;o<s;o++)r[o]!=b&&(r[o]-=t.from_greenwich);if(t.is_geocent){if(i||N(M),Te(t.a_orig,t.es_orig,r,n,i),1!=t.fr_meter)for(o=0;o<s;o++)r[o]!=b&&(r[o]*=t.fr_meter,n[o]*=t.fr_meter)}else if(t.is_latlong){if(t.is_latlong&&t.is_long_wrap_set)for(o=0;o<s;o++)if(r[o]!=b){for(;r[o]<t.long_wrap_center-w;)r[o]+=k;for(;r[o]>t.long_wrap_center+w;)r[o]-=k}}else if(t.fwd3d)U("3d transformation not supported");else for(o=0;o<s;o++)l.lam=r[o],l.phi=n[o],a=Ce(l,t),r[o]=a.x,n[o]=a.y,B();if(1!=t.vto_meter&&i)for(o=0;o<s;o++)i[o]*=t.vfr_meter;return"enu"!=t.axis&&Se(t.axis,!0,r,n,i),1==s?O.last_errno:0}function Se(e,t,r,n,i){var o,a,s,l,c,u,h=r.length,d=0;if(t){for(s=0;s<h;s++)if(o=r[s],a=n[s],o!=b)for(i&&(d=i[s]),l=0;l<3;l++)if(2!=l||i)switch(u=0==l?r:1==l?n:i,e[l]){case"e":u[s]=o;break;case"w":u[s]=-o;break;case"n":u[s]=a;break;case"s":u[s]=-a;break;case"u":u[s]=d;break;case"d":u[s]=-d;break;default:N(R)}}else for(s=0;s<h;s++)if(o=r[s],a=n[s],o!=b)for(i&&(d=i[s]),l=0;l<3;l++)switch(c=0==l?o:1==l?a:d,e[l]){case"e":r[s]=c;break;case"w":r[s]=-c;break;case"n":n[s]=c;break;case"s":n[s]=-c;break;case"u":i&&(i[s]=c);break;case"d":i&&(i[s]=-c);break;default:N(R)}}function Ee(e,t,r,n,i){var o,a,s=r.length;for((a=_e(e,0==t?e:e*h(1-t)))||N(M),o=0;o<s;o++)r[o]!=b&&be(a,o,r,n,i)}function Te(e,t,r,n,i){var o,a,s=r.length;for((a=_e(e,0===t?e:e*h(1-t)))||N(M),o=0;o<s;o++)r[o]!=b&&ve(a,o,r,n,i)&&(r[o]=n[o]=b)}function Ae(t){var r=6.283185307179586,i=3.141592653589793;return e(t)>3.14159265359&&(t+=i,t-=r*n(t/r),t-=i),t}function Ce(t,r){var n={x:0,y:0},i=e(t.phi)-C;return i<=1e-12&&e(t.lam)<=10?(O.last_errno=0,e(i)<=1e-12?t.phi=t.phi<0?-C:C:r.geoc&&(t.phi=c(r.rone_es*a(t.phi))),t.lam-=r.lam0,r.over||(t.lam=Ae(t.lam)),r.fwd?(r.fwd(t,n),n.x=r.fr_meter*(r.a*n.x+r.x0),n.y=r.fr_meter*(r.a*n.y+r.y0)):n.x=n.y=b):z(-14),!O.last_errno&&isFinite(n.x)&&isFinite(n.y)||(n.x=n.y=b),n}function Ie(t,r){var n={lam:0,phi:0};return t.x<b&&t.y<b?(O.last_errno=0,r.inv?(t.x=(t.x*r.to_meter-r.x0)*r.ra,t.y=(t.y*r.to_meter-r.y0)*r.ra,r.inv(t,n),n.lam+=r.lam0,r.over||(n.lam=Ae(n.lam)),r.geoc&&e(e(n.phi)-C)>1e-12&&(n.phi=c(r.one_es*a(n.phi)))):n.lam=n.phi=b):z(-15),!O.last_errno&&isFinite(n.lam)&&isFinite(n.phi)||(n.lam=n.phi=b),n}function ke(e,t,r,i){var o,a,s;for((e<0||e>=9)&&(e=3),o=1,s=0;s<e;s++)o*=10;return a=3600*o,function(s){var l,c,u,h,d="",p="",f="";return s===b||isNaN(s)?"":(s<0?(s=-s,(u=i||"")||(d="-")):u=r||"",c=(s=n(s*a+.5))/o%60,l=(s=n(s/(60*o)))%60,h=n(s/60)+"d",f=c.toFixed(e),f=(c=parseFloat(f))?(t?f:String(c))+'"':"",(c||l)&&2==(p=String(l)+"'").length&&t&&(p="0"+p),d+h+p+f+u)}}function Pe(e,t,r){var n,i,o,a,s,l;return"string"!=typeof e?Mr:("string"!=typeof t?(i="+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",o=e,n=t):(i=e,o=t,n=r),l=Me(a=me(i),s=me(o)),n?l(n):{forward:l,inverse:Me(s,a)})}function Me(e,t){return function(r){var n=Array.isArray(r);return r=n?r.concat():[r.x,r.y],we(e,t,r),n||(r={x:r[0],y:r[1]}),r}}function Re(e){var t=e.proj in Q?Q[e.proj].name:"",r=re(e),n=Xe(e);return{PROJCS:{NAME:t?n.NAME+" / "+t:"unnamed",GEOGCS:n,PROJECTION:"custom_proj4",PARAMETER:[],UNIT:Ge(e),EXTENSION:["PROJ4",r+" +wktext"]}}}function De(e){var t=e.EXTENSION;return t&&"PROJ4"==t[0]?(t[1]||"").replace(" +wktext",""):null}Pe.WGS84="+proj=longlat +datum=WGS84",Pe.toPoint=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t};var Oe=[],Le=[];function Be(e){return"string"==typeof e}function $e(e){var t=Fe(e,Le);return t||(t=function(e){return De(e)?De:null}(e)),t||Ue("unsupported WKT definition: "+(e.NAME||"[unknown]")),t}function ze(e){var t=Fe(e,Oe);return t||(t=Re),t||Ue("unsupported projection: "+function(e){return qe(e)||"[unknown]"}(e)),t}function Fe(e,t){for(var r=0;r<t.length;r++)if((0,t[r][0])(e))return t[r][1];return null}function qe(e){return Y(e.params,"sproj")}function Ne(e){return e.replace(/[-_ \/]+/g,"_").toLowerCase()}function je(e){var t;return Array.isArray(e)?t=e:e&&e.length>0&&(t=e.split(",")),t}function Ue(e){throw new Error(e)}function Ve(e){return{to_meter:e.UNIT[1]}}function Ge(e){return["Meter",e.to_meter||1]}function We(e,t){var r,n,i,o,a=e.DATUM,s=a.SPHEROID,l=function(e){var t,r={northamerican1983:"NAD83",newzealand1949:"nzgd49"},n=He(e.NAME);if(n in r)return r[n];for(var i=0;i<ie.length&&He((t=ie[i])[3])!=n&&He(t[0])!=n;i++);return t?t[0]:null}(a),c=function(e){var t,r={international1924:"intl"},n=He(e[0]);if(n in r)return r[n];if(/^grs1980/.test(n))return"GRS80";if("sphere"==n)return null;for(var i=0;i<se.length&&He((t=se[i])[3])!=n&&He(t[0])!=n;i++);return t?t[0]:null}(s),u=t&&t.aux_sphere,h=s[1],d=s[2];return i=e.UNIT,o="degree",i&&i[0].toLowerCase()!=o&&Ue("unexpected geographic units: "+geogcs.UNIT[0]),u?r="+a="+s[1]:l?r="+datum="+l:c?r="+ellps="+c:(r="+a="+h,d>0&&(r+=" +rf="+d)),!a.TOWGS84||u||l||(r+=" +towgs84="+a.TOWGS84.join(",")),((n=e.PRIMEM?e.PRIMEM[1]:0)>0||n<0)&&(r+=" +pm="+n),r}function He(e){return(e||"").replace(/^(GCS|D)_/i,"").replace(/[ _]/g,"").toLowerCase()}function Ze(e){return function(){return"+proj="+e}}function Ye(e){return function(t){var r,n;return[e.PROJECTION(t),e.PARAMETER(t),e.GEOGCS?e.GEOGCS(t):We(t.GEOGCS),(r=Ve(t),n="",1!=r.to_meter&&(n="+to_meter="+r.to_meter),n),"+no_defs"].filter((function(e){return!!e})).join(" ")}}function Xe(e){return{NAME:Je(e),DATUM:Ke(e),PRIMEM:["Greenwich",0],UNIT:["degree",.017453292519943295]}}function Ke(e){var t={NAME:tt(e),SPHEROID:Qe(e)},r=Y(e.params,"stowgs84");return/[1-9]/.test(r)&&(t.TOWGS84=r),t}function Qe(e){var t;return t=Y(e.params,"trf")?Y(e.params,"drf"):e.es?1/(1-Math.sqrt(1-e.es)):0,[et(e),e.a,t]}function Je(e){var t;return ee(e)&&(t=at(e)),t||(t=rt(e),t=/^[a-z]+$/.test(t)?t[0].toUpperCase()+t.substr(1):t.toUpperCase()),t||"UNK"}function et(e){var t=le(function(e){var t=rt(e),r=t?ae(t):null;return(r?r.ellipse_id:Y(e.params,"sellps"))||""}(e));return t?t.name:"Unknown ellipsoid"}function tt(e){var t=ae(rt(e));return t&&t.name||"Unknown datum"}function rt(e){return Y(e.params,"sdatum")}function nt(e){return ze(e)(e)}function it(e,t){return ot({PROJECTION:e,PARAMETER:Pt(t)})}function ot(e){return function(t){var r={GEOGCS:e.GEOGCS&&e.GEOGCS(t)||Xe(t),PROJECTION:Be(e.PROJECTION)?e.PROJECTION:e.PROJECTION(t),PARAMETER:e.PARAMETER(t),UNIT:Ge(t)};return r.NAME=e.NAME&&e.NAME(t,r)||function(e,t){var r=at(e);return r||t.GEOGCS.NAME+" / "+t.PROJECTION}(t,r),{PROJCS:r}}}function at(e){var t;return Y(e.params,"tinit")&&(t=fe(Y(e.params,"sinit"))),t?t.comment:""}function st(e,t,r){var n=ct(t),i=function(e,t){return Ye({PROJECTION:Ze(e),PARAMETER:kt(t)})}(e,r);ht(n,i)}function lt(e,t,r){dt(ut(e),it(t,r))}function ct(e){var t=je(e).map(Ne);return function(e){var r=e.PROJECTION[0];return t.indexOf(Ne(r))>-1}}function ut(e){return function(t){var r=qe(t);return r&&r==e}}function ht(e,t){"function"!=typeof e&&Ue("Missing WKT parser test"),"function"!=typeof t&&Ue("Missing WKT parse function"),Le.push([e,t])}function dt(e,t){"function"!=typeof e&&Ue("Missing WKT maker test"),"function"!=typeof t&&Ue("Missing WKT maker function"),Oe.push([e,t])}ht((function(e){return pt.test(Ne(e.NAME))}),(function(e){return Ye({PROJECTION:Ze("utm"),PARAMETER:function(e){var t=pt.exec(Ne(e.NAME)),r="+zone="+t[1];return"s"==t[2].toLowerCase()&&(r+=" +south"),r}})(e)})),ht((function(e){return ft.test(Ne(e.NAME))}),(function(e){return Ye({PROJECTION:Ze("ups"),PARAMETER:function(e){return"south"==ft.exec(Ne(e.NAME))[1].toLowerCase()?"+south":""}})(e)})),dt(ut("utm"),(function(e){return ot({NAME:mt,PROJECTION:function(){return"Transverse_Mercator"},PARAMETER:yt})(e)})),dt(ut("ups"),(function(e){return ot({NAME:gt,PROJECTION:function(){return"Polar_Stereographic"},PARAMETER:_t})(e)}));var pt=/UTM_zone_([0-9]{1,2})(N|S)/i,ft=/UPS_(North|South)/i;function mt(e,t){return t.GEOGCS.NAME+" / UTM zone "+Y(e.params,"szone")+(Y(e.params,"tsouth")?"S":"N")}function gt(e,t){return t.GEOGCS.NAME+" / UPS "+(Y(e.params,"tsouth")?"South":"North")}function yt(e){return[["latitude_of_origin",0],["central_meridian",180*e.lam0/w],["scale_factor",e.k0],["false_easting",e.x0],["false_northing",e.y0]]}function _t(e){return[["latitude_of_origin",-90],["central_meridian",0],["scale_factor",.994],["false_easting",2e6],["false_northing",2e6]]}function vt(e){return Y(e.params,"tlat_ts")&&0!=Y(e.params,"dlat_ts")}function bt(e){return 0===e.es&&6378137==e.a}ht(ct("Mercator_2SP,Mercator_1SP,Mercator,Mercator_Auxiliary_Sphere"),Ye({GEOGCS:function(e){var t=function(e){return/(Web_Mercator|Pseudo_Mercator)/i.test(Ne(e.NAME))}(e)?{aux_sphere:!0}:null;return We(e.GEOGCS,t)},PROJECTION:Ze("merc"),PARAMETER:function(e){return kt(function(e){var t=At(e,"standard_parallel_1");return t&&0!=t[1]}(e)?"lat_ts,lat_0b":"lat_tsb,lat_ts")(e)}})),dt(ut("merc"),ot({GEOGCS:function(e){return bt(e)?Xe(me("+proj=longlat +datum=WGS84")):null},PROJECTION:function(e){return vt(e)?"Mercator_2SP":"Mercator_1SP"},PARAMETER:function(e){return Pt(vt(e)?"lat_ts,lat_0b":"lat_tsb")(e)},NAME:function(e){return bt(e)?"WGS 84 / Pseudo-Mercator":null}}));var wt=[["x_0","false_easting","m"],["y_0","false_northing","m"],["k_0","scale_factor","f"],["lat_0","latitude_of_center"],["lon_0","central_meridian"]],xt={lat_0b:["lat_0","latitude_of_origin"],lat_0c:["lat_0",null],lat_0d:["lat_0","standard_parallel_1"],lat_1:["lat_1","standard_parallel_1"],lat_1b:["lat_1","latitude_of_point_1"],lat_1c:["lat_1","latitude_of_origin"],lat_2:["lat_2","standard_parallel_2"],lat_2b:["lat_2","latitude_of_point_2"],lat_ts:["lat_ts","standard_parallel_1"],lat_tsb:["lat_ts","latitude_of_origin"],lonc:["lonc","central_meridian"],lon_1:["lon_1","longitude_of_point_1"],lon_2:["lon_2","longitude_of_point_2"],alpha:["alpha","azimuth"],gamma:["gamma","rectified_grid_angle"],h:["h","height","f"]},St={longitude_of_center:"central_meridian",latitude_of_origin:"latitude_of_center",latitude_of_center:"latitude_of_origin",longitude_of_1st_point:"longitude_of_point_1",longitude_of_2nd_point:"longitude_of_point_2",latitude_of_1st_point:"latitude_of_point_1",latitude_of_2nd_point:"latitude_of_point_2",k:"k_0"};function Et(e,t,r){for(var n=0;n<r.length;n++)if(r[n][t]===e)return r[n];return null}function Tt(e,t,r){var n=null;return!(n=Et(e=e.toLowerCase(),t,r))&&e in St&&(n=Et(St[e],t,r)),n}function At(e,t){for(var r,n=e.PARAMETER||[],i=0;i<n.length;i++)if(t===(r=n[i][0].toLowerCase())||t===St[r])return n[i];return null}function Ct(e){var t=null;return e&&(t=je(e).reduce((function(e,t){var r=xt[t];return r||Ue("missing parameter rule: "+t),e.push(r),e}),[])),(t||[]).concat(wt)}function kt(e){return function(t){var r=[],n=Ct(e),i=Ve(t);return(t.PARAMETER||[]).forEach((function(e){var t,o=Tt(e[0],1,n);o?(t=function(e,t,r){var n=e[0];if("m"==e[2]&&(t*=r.to_meter),!("x_0,y_0,lat_0,lon_0".indexOf(n)>-1&&0===t||"k_0"==n&&1==t))return"+"+n+"="+t}(o,e[1],i),t&&r.push(t)):e[0]})),r.join(" ")}}function Pt(e){return function(t){var r=[],n=Ct(e);return Object.keys(t.params).forEach((function(e){var i,o=Tt(e,0,n);o&&o[1]&&(i=Y(t.params,"s"+e),r.push(function(e,t,r){var n,i=e[2];return n="m"==i?parseFloat(t)/r:"f"==i?parseFloat(t):W(t),[e[1],n]}(o,i,t.to_meter)))})),r}}function Mt(e){return!("lat_1"in e.params&&"lat_2"in e.params)}function Rt(e){return"omerc"==qe(e)&&("alpha"in e.params||"gamma"in e.params)}function Dt(e){return Rt(e)&&("no_uoff"in e.params||"no_off"in e.params)}function Ot(e){return Y(e.params,"tlat_ts")}function Lt(e){var t=JSON.stringify($t(e));return t=(t=t.replace(/\["([A-Z0-9]+)",/g,"$1[")).replace(/"(EAST|NORTH|SOUTH|WEST)"/g,"$1")}function Bt(e){return"NAME,PROJCS,GEOGCS,GEOCCS,DATUM,SPHEROID,PRIMEM,PROJECTION,PARAMETER,UNIT,AXIS".indexOf(e)+1||999}function $t(e,t){var r,n=[];return t=t||0,function(e){return Object.keys(e).sort((function(e,t){return Bt(e)-Bt(t)}))}(e).forEach((function(i){var o=e[i];!function(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}(o)?"NAME"==i?n.push(Be(o)?o:o[0]):"PARAMETER"==i||"AXIS"==i?o.forEach((function(e){n.push([i].concat(e))})):Be(o)?n.push([i,o]):Array.isArray(o)?n.push([i].concat(o)):((r={})[i]=o,Ue("Incorrectly formatted WKT element: "+JSON.stringify(r))):n.push([i].concat($t(o,t+1)))})),0===t&&1==n.length&&(n=n[0]),n}function zt(e){var t={};return Ft(e).forEach((function(e){Nt(e,t)})),t}function Ft(e){var t;e="["+(e=(e=(e=qt(e)).replace(/([A-Z0-9]+)\[(?![^"]*[^\[,"]")/g,'["$1",')).replace(/, *([a-zA-Z]+) *(?=[,\]])/g,',"$1"'))+"]";try{t=JSON.parse(e)}catch(r){Ue("unparsable WKT format")}return t}function qt(e){var t=0;return e.replace(/"+/g,(function(e){var r=t%2==0;return t+=e.length,'"'==e||'""'==e&&r?e:r?'"'+e.substring(1).replace(/""/g,'\\"'):e.replace(/""/g,'\\"')}))}function Nt(e,t){var r,n=e[0];if("GEOGCS"==n||"GEOCCS"==n||"PROJCS"==n||"DATUM"==n||"VERTCS"==n)for(t[n]={NAME:e[1]},r=2;r<e.length;r++){if(!Array.isArray(e[r]))throw Ue("WKT parse error");Nt(e[r],t[n])}else"AXIS"==n||"PARAMETER"==n?(n in t==0&&(t[n]=[]),t[n].push(e.slice(1))):t[n]=e.slice(1);return t}ht(ct("Lambert_Conformal_Conic,Lambert_Conformal_Conic_1SP,Lambert_Conformal_Conic_2SP"),Ye({PROJECTION:Ze("lcc"),PARAMETER:function(e){return kt(function(e){return!At(e,"standard_parallel_2")}(e)?"lat_1c":"lat_0b,lat_1,lat_2")(e)}})),dt(ut("lcc"),ot({PROJECTION:function(e){return Mt(e)?"Lambert_Conformal_Conic_1SP":"Lambert_Conformal_Conic_2SP"},PARAMETER:function(e){return Pt(Mt(e)?"lat_1c,lat_0c":"lat_0b,lat_1,lat_2")(e)}})),ht(ct("Hotine_Oblique_Mercator,Hotine_Oblique_Mercator_Azimuth_Natural_Origin"),Ye({PROJECTION:Ze("omerc"),PARAMETER:function(e){return kt("alpha,gamma,lonc")(e)+" +no_uoff"}})),dt(Dt,it("Hotine_Oblique_Mercator","alpha,gamma,lonc")),st("omerc","Oblique_Mercator,Hotine_Oblique_Mercator_Azimuth_Center","alpha,gamma,lonc"),dt((function(e){return Rt(e)&&!Dt(e)}),it("Oblique_Mercator","alpha,gamma,lonc")),st("omerc","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","lat_1b,lat_2b,lon_1,lon_2"),dt((function(e){return"omerc"==qe(e)&&"lat_2"in e.params&&"lon_2"in e.params}),it("Hotine_Oblique_Mercator_Two_Point_Natural_Origin","lat_1b,lat_2b,lon_1,lon_2")),ht(ct("Stereographic,Polar_Stereographic,Stereographic_North_Pole,Stereographic_South_Pole"),Ye({PROJECTION:Ze("stere"),PARAMETER:function(e){var t=kt("lat_ts,lat_tsb")(e),r=/lat_ts=([^ ]+)/.exec(t);return r&&-1==t.indexOf("lat_0=")&&(t="+lat_0="+(parseFloat(r[1])<0?-90:90)+" "+t),t}})),dt(ut("stere"),ot({PROJECTION:function(e){return Ot(e)?"Polar_Stereographic":"Stereographic"},PARAMETER:function(e){return Ot(e)?Pt("lat_tsb,lat_0c")(e):Pt("lat_0b")(e)}})),lt("vandg","VanDerGrinten"),ht(ct("VanDerGrinten,Van_der_Grinten_I"),Ye({PROJECTION:Ze("vandg"),PARAMETER:function(e){var t=kt("")(e);return t&&(t+=" "),t+"+R_A"}})),[["aitoff","Aitoff","lat1"],["aea","Albers_Conic_Equal_Area,Albers","lat_1,lat_2"],["aeqd","Azimuthal_Equidistant"],["bonne","Bonne","lat_1"],["cass","Cassini_Soldner,Cassini"],["cea","Cylindrical_Equal_Area","lat_ts"],["eck1","Eckert_I"],["eck2","Eckert_II"],["eck3","Eckert_III"],["eck4","Eckert_IV"],["eck5","Eckert_V"],["eck6","Eckert_VI"],["eqdc","Equidistant_Conic","lat_1,lat_2"],["eqc","Plate_Carree,Equirectangular,Equidistant_Cylindrical","lat_ts"],["gall","Gall_Stereographic"],["gnom","Gnomonic"],["laea","Lambert_Azimuthal_Equal_Area"],["loxim","Loximuthal","lat_1"],["mill","Miller_Cylindrical"],["moll","Mollweide"],["nsper","Vertical_Near_Side_Perspective","h"],["nzmg","New_Zealand_Map_Grid","lat_0b"],["ortho","Orthographic","lat_0b"],["poly","Polyconic"],["robin","Robinson"],["sinu","Sinusoidal"],["sterea","Oblique_Stereographic,Double_Stereographic"],["tmerc","Transverse_Mercator,Gauss_Kruger","lat_0b"],["tpeqd","Two_Point_Equidistant","lat_1b,lat_2b,lon_1,lon_2"],["wag1","Wagner_I"],["wag2","Wagner_II"],["wag3","Wagner_III","lat_ts"],["wag4","Wagner_IV"],["wag5","Wagner_V"],["wag6","Wagner_VI"],["wag7","Wagner_VII"],["wink1","Winkel_I","lat_ts"],["wink2","Winkel_II"],["wintri","Winkel_Tripel","lat_1"]].forEach((function(e){var t=e[2]||null;st(e[0],e[1],t),lt(e[0],e[1].split(",")[0],t)}));var jt,Ut,Vt={};function Gt(e,t,r){var n;return t>=1e-7?r*(e/(1-(n=t*e)*n)-.5/t*f((1-n)/(1+n))):e+e}function Wt(e,t,r){return t/h(1-r*e*e)}function Ht(t,r,n){var a,l,c,d,p,g,y,_,v,w,x,S,E,T;t.fwd=function(e,r){var n,a=e.lam;(n=c-(y?l*Gt(i(e.phi),t.e,t.one_es):p*i(e.phi)))<0&&F(),n=d*h(n),r.x=n*i(a*=l),r.y=g-n*o(a)},t.inv=function(r,n){var h=r.x,_=g-r.y,v=m(h,_);0!=v?(l<0&&(v=-v,h=-h,_=-_),n.phi=v/d,y?(n.phi=(c-n.phi*n.phi)/l,e(a-e(n.phi))>1e-7?(n.phi=function(t,r,n){var a,l,c,u,h,d,p=15,m=1e-7,g=1e-10;if(a=s(.5*t),r<m)return a;d=p;do{a+=h=.5*(u=1-(c=r*(l=i(a)))*c)*u/o(a)*(t/n-l/u+.5/r*f((1-c)/(1+c)))}while(e(h)>g&&--d);return d?a:b}(n.phi,t.e,t.one_es))==b&&q():n.phi=n.phi<0?-C:C):e(n.phi=(c-n.phi*n.phi)/p)<=1?n.phi=s(n.phi):n.phi=n.phi<0?-C:C,n.lam=u(h,_)/l):(n.lam=0,n.phi=l>0?C:-C)},e(r+n)<D&&j(-21),l=v=i(r),_=o(r),w=e(r-n)>=D,(y=t.es>0)?(Zt(t.es),T=Wt(v,_,t.es),E=Gt(v,t.e,t.one_es),w&&(S=Wt(v=i(n),_=o(n),t.es),x=Gt(v,t.e,t.one_es),l=(T*T-S*S)/(x-E)),a=1-.5*t.one_es*f((1-t.e)/(1+t.e))/t.e,g=(d=1/l)*h((c=T*T+l*E)-l*Gt(i(t.phi0),t.e,t.one_es))):(w&&(l=.5*(l+i(n))),g=(d=1/l)*h((c=_*_+(p=l+l)*v)-p*i(t.phi0)))}function Zt(e){var t,r=.046875,n=.01953125,i=.01068115234375,o=[];return o[0]=1-e*(.25+e*(r+e*(n+e*i))),o[1]=e*(.75-e*(r+e*(n+e*i))),o[2]=(t=e*e)*(.46875-e*(.013020833333333334+.007120768229166667*e)),o[3]=(t*=e)*(.3645833333333333-.005696614583333333*e),o[4]=t*e*.3076171875,o}function Yt(e,t,r,n){return r*=t,t*=t,n[0]*e-r*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))}function Xt(t,r,n){var a,s,l,c=1/(1-r);l=t;for(var u=10;u>0;--u)if(s=1-r*(a=i(l))*a,l-=s=(Yt(l,a,o(l),n)-t)*(s*h(s))*c,e(s)<1e-11)return l;return z(O),l}function Kt(t){var r=e(t);return r>=1?(r>1.00000000000001&&z(-19),t<0?-C:C):s(t)}function Qt(t){var r=e(t);return r>=1?(r>1.00000000000001&&z(-19),t<0?w:0):l(t)}function Jt(e){return e<=0?0:h(e)}function er(t,r){return e(t)<1e-50&&e(r)<1e-50?0:u(t,r)}function tr(t){var r=t.opaque||{mode:0};t.inv=function(t,n){var a,s,c,u,h,p,f,m,g,y,_,v,b,x,S,E,T,A=1e-12,I=0;if(e(t.x)<A&&e(t.y)<A)return n.phi=0,void(n.lam=0);n.phi=t.y,n.lam=t.x;do{a=0;do{for(v=i(.5*n.lam),S=o(.5*n.lam),b=i(n.phi),c=1-(s=(x=o(n.phi))*S)*s,u=2*(s=l(s)/d(c,1.5))*c*x*v,h=s*c*b,p=2*(v*S*b*x/c-s*b*v),f=x*x*v*v/c+s*x*S*b*b,m=b*b*S/c+s*v*v*x,g=.5*(b*x*v/c-s*b*x*x*v*S),r.mode&&(u=.5*(u+n.lam*r.cosphi1),h=.5*(h+n.phi),p*=.5,f=.5*(f+r.cosphi1),m=.5*(m+1),g*=.5),u-=t.x,_=((h-=t.y)*p-u*m)/(y=p*g-m*f),y=(u*g-h*f)/y;_>w;)_-=w;for(;_<-w;)_+=w;n.phi-=y,n.lam-=_}while((e(y)>A||e(_)>A)&&a++<10);n.phi>C&&(n.phi-=2*(n.phi-C)),n.phi<-C&&(n.phi-=2*(n.phi+C)),e(e(n.phi)-C)<A&&!r.mode&&(n.lam=0),(s=l(o(n.phi)*o(c=.5*n.lam)))?(E=2*s*o(n.phi)*i(c)*(T=1/i(s)),T*=s*i(n.phi)):E=T=0,r.mode&&(E=.5*(E+n.lam*r.cosphi1),T=.5*(T+n.phi))}while((e(t.x-E)>A||e(t.y-T)>A)&&I++<20)},t.fwd=function(e,t){var n,a;(a=l(o(e.phi)*o(n=.5*e.lam)))?(t.x=2*a*o(e.phi)*i(n)*(t.y=1/i(a)),t.y*=a*i(e.phi)):t.x=t.y=0,r.mode&&(t.x=.5*(t.x+e.lam*r.cosphi1),t.y=.5*(t.y+e.phi))},t.es=0}function rr(t,r,n){t.es=0,t.fwd=function(t,o){var a,s,l=2.4674011002723395;o.y=r?C*i(t.phi):t.phi,(a=e(t.lam))>=1e-10?(n&&a>=C?o.x=h(l-t.phi*t.phi+1e-10)+a-C:(s=.5*(l/a+a),o.x=a-s+h(s*s-o.y*o.y)),t.lam<0&&(o.x=-o.x)):o.x=0}}function nr(e){var t,r=[];return r[0]=.3333333333333333*e,t=e*e,r[0]+=.17222222222222222*t,r[1]=.06388888888888888*t,t*=e,r[0]+=.10257936507936508*t,r[1]+=.0664021164021164*t,r[2]=.01677689594356261*t,r}function ir(e,t){var r=e+e;return e+t[0]*i(r)+t[1]*i(r+r)+t[2]*i(r+r+r)}function or(e,t){e.es=0,e.fwd=function(e,r){r.y=t.C_y*e.phi,r.x=t.C_x*e.lam*(t.A+Jt(1-t.B*e.phi*e.phi))},e.inv=function(e,r){r.phi=e.y/t.C_y,r.lam=e.x/(t.C_x*(t.A+Jt(1-t.B*r.phi*r.phi)))}}function ar(t){var r,n,s,l,d,p,_=[],v=[],w=[],x=[];function S(e,t){for(var r,n=2*o(2*t),a=e.length-1,s=e[a],l=0;--a>=0;)r=n*s-l+e[a],l=s,s=r;return t+r*i(2*t)}function E(e,t,r){for(var n,a,s=i(t),l=o(t),c=g(r),u=y(r),h=2*l*u,d=-2*s*c,p=e.length-1,f=e[p],m=0,_=0,v=0;--p>=0;)n=_,a=m,f=h*(_=f)-n-d*(m=v)+e[p],v=d*_-a+h*m;return[(h=s*u)*f-(d=l*c)*v,h*v+d*f]}t.es<=0&&j(-34),d=l=(s=t.es/(1+h(1-t.es)))/(2-s),_[0]=l*(2+l*(-2/3+l*(l*(116/45+l*(26/45+l*(-2854/675)))-2))),v[0]=l*(l*(2/3+l*(4/3+l*(-82/45+l*(32/45+l*(4642/4725)))))-2),d*=l,_[1]=d*(7/3+l*(l*(-227/45+l*(2704/315+l*(2323/945)))-1.6)),v[1]=d*(5/3+l*(-16/15+l*(-13/9+l*(904/315+l*(-1522/945))))),d*=l,_[2]=d*(56/15+l*(-136/35+l*(-1262/105+l*(73814/2835)))),v[2]=d*(-26/15+l*(34/21+l*(1.6+l*(-12686/2835)))),d*=l,_[3]=d*(4279/630+l*(-332/35+l*(-399572/14175))),v[3]=d*(1237/630+l*(l*(-24832/14175)-2.4)),d*=l,_[4]=d*(4174/315+l*(-144838/6237)),v[4]=d*(-734/315+l*(109598/31185)),d*=l,_[5]=d*(601676/22275),v[5]=d*(444337/155925),d=l*l,r=t.k0/(1+l)*(1+d*(1/4+d*(1/64+d/256))),w[0]=l*(l*(2/3+l*(-37/96+l*(1/360+l*(81/512+l*(-96199/604800)))))-.5),x[0]=l*(.5+l*(-2/3+l*(5/16+l*(41/180+l*(-127/288+l*(7891/37800)))))),w[1]=d*(-1/48+l*(-1/15+l*(437/1440+l*(-46/105+l*(1118711/3870720))))),x[1]=d*(13/48+l*(l*(557/1440+l*(281/630+l*(-1983433/1935360)))-.6)),d*=l,w[2]=d*(-17/480+l*(37/840+l*(209/4480+l*(-5569/90720)))),x[2]=d*(61/240+l*(-103/140+l*(15061/26880+l*(167603/181440)))),d*=l,w[3]=d*(-4397/161280+l*(11/504+l*(830251/7257600))),x[3]=d*(49561/161280+l*(-179/168+l*(6601661/7257600))),d*=l,w[4]=d*(-4583/161280+l*(108847/3991680)),x[4]=d*(34729/80640+l*(-3418889/1995840)),d*=l,w[5]=d*(-20648693/638668800),x[5]=.6650675310896665*d,p=S(v,t.phi0),n=-r*(p+function(e,t){for(var r,n=2*o(t),a=e.length-1,s=e[a],l=0;--a>=0;)r=n*s-l+e[a],l=s,s=r;return i(t)*r}(x,2*p)),t.fwd=function(t,s){var l,c,h,d,p,g,y,_=t.phi,w=t.lam;_=S(v,_),l=i(_),c=o(_),d=i(w),h=o(w),_=u(l,h*c),w=u(d*c,m(l,c*h)),g=a(w),y=function(e){var t=1+e,r=t-1;return 0===r?e:e*f(t)/r}((y=e(g))*(1+y/(m(1,y)+1))),p=E(x,2*_,2*(w=g<0?-y:y)),_+=p[0],w+=p[1],e(w)<=2.623395162778?(s.y=r*_+n,s.x=r*w):s.x=s.y=b},t.inv=function(t,a){var s,l,h,d,p,f=t.y,y=t.x;f=(f-n)/r,e(y/=r)<=2.623395162778?(f+=(p=E(w,2*f,2*y))[0],y+=p[1],y=c(g(y)),s=i(f),l=o(f),d=i(y),h=o(y),y=u(d,h*l),f=u(s*h,m(d,h*l)),a.phi=S(_,f),a.lam=y):a.phi=a.lam=b}}function sr(t){var r;t.es?(r=Zt(t.es),t.fwd=function(e,n){var a,s;n.y=Yt(e.phi,a=i(e.phi),s=o(e.phi),r),n.x=e.lam*s/h(1-t.es*a*a)},t.inv=function(n,a){var s=e(a.phi=Xt(n.y,t.es,r));s<C?(s=i(a.phi),a.lam=n.x*h(1-t.es*s*s)/o(a.phi)):s-D<C?a.lam=0:q()}):lr(t,0,1)}function lr(t,r,n){var a,s;a=(s=h((r+1)/n))/(r+1),t.es=0,t.fwd=function(t,l){var c,u,h;if(r){for(c=n*i(t.phi),h=8;h&&(t.phi-=u=(r*t.phi+i(t.phi)-c)/(r+o(t.phi)),!(e(u)<1e-7));--h);h||F()}else t.phi=1!=n?Kt(n*i(t.phi)):t.phi;l.x=a*t.lam*(r+o(t.phi)),l.y=s*t.phi},t.inv=function(e,t){e.y/=s,t.phi=r?Kt((r*e.y+i(e.y))/n):1!=n?Kt(i(e.y)/n):e.y,t.lam=e.x/(a*(r+o(e.y)))}}function cr(e){hr(e,ur(0,C))}function ur(e,t){var r=i(t),n=t+t,o=h(k*r/(n+i(n)));return{C_x:2*o/w,C_y:o/r,C_p:n+i(n)}}function hr(t,r){t.fwd=function(t,n){var a,s,l;for(a=r.C_p*i(t.phi),l=10;l&&(t.phi-=s=(t.phi+i(t.phi)-a)/(1+o(t.phi)),!(e(s)<1e-7));--l);l?t.phi*=.5:t.phi=t.phi<0?-C:C,n.x=r.C_x*t.lam*o(t.phi),n.y=r.C_y*i(t.phi)},t.inv=function(t,n){n.phi=Kt(t.y/r.C_y),n.lam=t.x/(r.C_x*o(n.phi)),e(n.lam)-w<D?(n.phi+=n.phi,n.phi=Kt((n.phi+i(n.phi))/r.C_p)):n.lam=n.phi=b},t.es=0}function dr(t,r){var o,a,l,c,u,p=[[0,-1],[1,0]],f=[[-1,0],[0,-1]],m=[[0,1],[-1,0]],g=[[[1,0],[0,1]],p,f,m,m,f,p],y=1e-15;function x(t,r){var o=t.lam,a=t.phi,l=s(2/3);if(e(a)<=l)r.x=o,r.y=3*w/8*i(a);else{var c,u=h(3*(1-e(i(a)))),d=n(2*o/w+2);d>=4&&(d=3),c=-3*A+C*d,r.x=c+(o-c)*u,r.y=E(a)*A*(2-u)}}function S(t,r){var i=t.x,o=t.y,a=A;if(e(o)<=a)r.lam=i,r.phi=s(8*o/(3*w));else if(e(o)<C){var l,c,u=n(2*i/w+2);u>=4&&(u=3),l=-3*A+C*u,c=2-4*e(o)/w,r.lam=l+(i-l)/c,r.phi=E(o)*s(1-d(c,2)/3)}else r.lam=-w,r.phi=E(o)*C}function E(e){return e>0?1:e<0?-1:0}function T(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case-1:return 4;case-2:return 5;case-3:return 6}return 0}function I(e,t){return function(e,t,r){var n,i,o,a,s,l=0,c=e.length;for(s=0;s<c;s++)if(t==e[s][0]&&r==e[s][1])return!0;for(n=e[0][0],i=e[0][1],s=1;s<c;s++)o=e[s%c][0],a=e[s%c][1],r>_(i,a)&&r<=v(i,a)&&t<=v(n,o)&&i!=a&&(n==o||t<=(r-i)*(o-n)/(a-i)+n)&&l++,n=o,i=a;return l%2!=0}(u,e,t)}function k(t,r,n){if(n)return ir(r,c);var o=Gt(i(r),t.e,1-t.es)/l;return e(o)>1&&(o=E(o)),s(o)}function P(e,t,r,n){var i,o,a,s,l,c,u=0,h=function(e,t,r,n,i){var o,a={};if(a.x=e,a.y=t,i){if(t>A)a.region="north",a.x=-3*A+r*C,a.y=C,e-=r*C;else{if(!(t<-A))return a.region="equatorial",a.cn=0,a;a.region="south",a.x=-3*A+n*C,a.y=-C,e-=n*C}"north"==a.region?a.cn=t>=-e-A-y&&t<e+5*A-y?(r+1)%4:t>-e-A+y&&t>=e+5*A-y?(r+2)%4:t<=-e-A+y&&t>e+5*A+y?(r+3)%4:r:"south"==a.region&&(a.cn=t<=e+A+y&&t>-e-5*A+y?(n+1)%4:t<e+A-y&&t<=-e-5*A+y?(n+2)%4:t>=e+A-y&&t<-e-5*A-y?(n+3)%4:n)}else{if(t>A)a.region="north",o=C;else{if(!(t<-A))return a.region="equatorial",a.cn=0,a;a.region="south",o=-C}e<-C?(a.cn=0,a.x=-3*A,a.y=o):e>=-C&&e<0?(a.cn=1,a.x=-A,a.y=o):e>=0&&e<C?(a.cn=2,a.x=A,a.y=o):(a.cn=3,a.x=3*A,a.y=o)}return a}(e.x,e.y,t,r,n);if("equatorial"==h.region)return e.x=h.x,void(e.y=h.y);i=[e.x,e.y],o=[h.x,h.y],n?"north"==h.region?(u=t,c=g[T(-1*(h.cn-u))]):(u=r,c=g[T(h.cn-u)]):"north"==h.region?(u=t,c=g[T(h.cn-u)]):(u=r,c=g[T(-1*(h.cn-u))]),s=function(e,t){return[e[0]-t[0],e[1]-t[1]]}(i,o),l=function(e,t){var r,n,i=[0,0];for(r=0;r<2;r++)for(n=0;n<2;n++)i[r]+=e[r][n]*t[n];return i}(c,s),a=function(e,t){return[e[0]+t[0],e[1]+t[1]]}(l,[-3*A+(n?h.cn:0)*C,C]),e.x=a[0],e.y=a[1]}r?(o=Y(t.params,"inorth_square"),a=Y(t.params,"isouth_square"),(o<0||o>3)&&j(-47),(a<0||a>3)&&j(-47),u=[[-w-y,A+y],[o*C-w-y,A+y],[o*C-w-y,3*A+y],[(o+1)*C-w+y,3*A+y],[(o+1)*C-w+y,A+y],[w+y,A+y],[w+y,-A-y],[(a+1)*C-w+y,-A-y],[(a+1)*C-w+y,-3*A-y],[a*C-w-y,-3*A-y],[a*C-w-y,-A-y],[-w-y,-A-y]],0!=t.es?(c=nr(t.es),l=Gt(1,t.e,t.one_es),t.a=t.a*h(.5*l),t.ra=1/t.a,t.fwd=function(e,r){return e.phi=k(t,e.phi,0),x(e,r),P(r,o,a,0)},t.inv=function(e,r){if(!I(e.x,e.y))return r.lam=b,r.phi=b,void z(-15);P(e,o,a,1),S(e,r),r.phi=k(t,r.phi,1)}):(t.fwd=function(e,t){x(e,t),P(t,o,a,0)},t.inv=function(e,t){if(!I(e.x,e.y))return t.lam=b,t.phi=b,void z(-15);P(e,o,a,1),S(e,t)})):(u=[[-w-y,A],[-3*A,C+y],[-C,A+y],[-A,C+y],[0,A+y],[A,C+y],[C,A+y],[3*A,C+y],[w+y,A],[w+y,-A],[3*A,-C-y],[C,-A-y],[A,-C-y],[0,-A-y],[-A,-C-y],[-C,-A-y],[-3*A,-C-y],[-w-y,-A]],0!=t.es?(c=nr(t.es),l=Gt(1,t.e,t.one_es),t.a=t.a*h(.5*l),t.ra=1/t.a,t.fwd=function(e,r){e.phi=k(t,e.phi,0),x(e,r)},t.inv=function(e,r){if(!I(e.x,e.y))return r.lam=b,r.phi=b,void z(-15);S(e,r),r.phi=k(t,r.phi,1)}):(t.fwd=function(e,t){x(e,t)},t.inv=function(e,t){if(!I(e.x,e.y))return t.lam=b,t.phi=b,void z(-15);S(e,t)}))}function pr(e){e.x0=0,e.y0=0,e.is_latlong=!0,e.fwd=function(t,r){r.x=t.lam/e.a,r.y=t.phi/e.a},e.inv=function(t,r){r.lam=t.x*e.a,r.phi=t.y*e.a}}function fr(e,t,r){return t*=r,a(.5*(C-e))/d((1-t)/(1+t),.5*r)}function mr(t,r){var n,o,a=.5*r,s=C-2*c(t),l=15;do{n=r*i(s),s+=o=C-2*c(t*d((1-n)/(1+n),a))-s}while(e(o)>1e-10&&--l);return l<=0&&z(-18),s}function gr(e,t){var r,n,i,o=t.length-1;for(n=t[o][0],i=t[o][1];--o>=0;)r=n,n=t[o][0]+e.r*r-e.i*i,i=t[o][1]+e.r*i+e.i*r;return{r:e.r*n-e.i*i,i:e.r*i+e.i*n}}function yr(e,t,r){var n,i,o,a,s,l=!0,c=t.length-1;for(i=a=t[c][0],n=o=t[c][1];--c>=0;)l?l=!1:(a=i+e.r*(s=a)-e.i*o,o=n+e.r*o+e.i*s),i=t[c][0]+e.r*(s=i)-e.i*n,n=t[c][1]+e.r*n+e.i*s;return r.r=i+e.r*a-e.i*o,r.i=n+e.r*o+e.i*a,{r:e.r*i-e.i*n,i:e.r*n+e.i*i}}function _r(t,r){var n,s,l,h,p=1e-12;0!=t.es?(n=t.e*i(t.phi0),s=2*c(a(.5*(C+t.phi0))*d((1-n)/(1+n),.5*t.e))-C):s=t.phi0,h=i(s),l=o(s),t.inv=function(n,s){var f,g,y,_,v,w,x,S={},E={},T={},A=0,I=0,k=0,P=0;for(S.r=n.x,S.i=n.y,f=20;f&&((g=yr(S,r,E)).r-=n.x,g.i-=n.y,y=E.r*E.r+E.i*E.i,T.r=-(g.r*E.r+g.i*E.i)/y,T.i=-(g.i*E.r-g.r*E.i)/y,S.r+=T.r,S.i+=T.i,!(e(T.r)+e(T.i)<=p));--f);if(f){if(A=m(S.r,S.i),_=2*c(.5*A),I=i(_),k=o(_),s.lam=t.lam0,e(A)<=p)return s.lam=0,void(s.phi=t.phi0);for(P=v=Kt(k*h+S.i*I*l/A),f=20;f&&(w=t.e*i(P),P+=x=2*c(a(.5*(C+v))*d((1+w)/(1-w),.5*t.e))-C-P,!(e(x)<=p));--f);}f?(s.phi=P,s.lam=u(S.r*I,A*l*k-S.i*h*I)):s.lam=s.phi=b},t.fwd=function(e,n){var s,u,p,f,m,g,y,_={};s=i(e.lam),u=o(e.lam),p=t.e*i(e.phi),f=2*c(a(.5*(C+e.phi))*d((1-p)/(1+p),.5*t.e))-C,m=i(f),g=o(f),y=2/(1+h*m+l*g*u),_.r=y*g*s,_.i=y*(l*m-h*g*u),_=gr(_,r),n.x=_.r,n.y=_.i}}function vr(t,r,n,a){var l,c,d,p,f,g,y,_,v,b,w,x,S=!isNaN(n)&&!isNaN(a);r<=0&&j(-30),S&&(v=o(a),b=i(a),x=o(n),w=i(n)),e(e(t.phi0)-C)<D?l=t.phi0<0?1:0:e(t.phi0)<D?l=2:(l=3,c=i(t.phi0),d=o(t.phi0)),g=r/t.a,f=1/(p=1+g),y=(p+1)*(_=1/g),t.fwd=function(e,t){var r,n,a,s,u;switch(a=i(e.phi),n=o(e.phi),r=o(e.lam),l){case 3:t.y=c*a+d*n*r;break;case 2:t.y=n*r;break;case 1:t.y=-a;break;case 0:t.y=a}switch(t.y<f&&F(),t.y=g/(p-t.y),t.x=t.y*n*i(e.lam),l){case 3:t.y*=d*a-c*n*r;break;case 2:t.y*=a;break;case 0:r=-r;case 1:t.y*=n*r}S&&(u=1/((s=t.y*v+t.x*b)*w*_+x),t.x=(t.x*v-t.y*b)*x*u,t.y=s*u)},t.inv=function(r,n){var o,a,f,_,E,T;if(S&&(T=1/(g-r.y*w),_=g*r.x*T,E=g*r.y*x*T,r.x=_*v+E*b,r.y=E*v-_*b),o=m(r.x,r.y),(f=1-o*o*y)<0&&q(),f=(p-h(f))/(g/o+o/g),a=h(1-f*f),e(o)<=D)n.lam=0,n.phi=t.phi0;else{switch(l){case 3:n.phi=s(a*c+r.y*f*d/o),r.y=(a-c*i(n.phi))*o,r.x*=f*d;break;case 2:n.phi=s(r.y*f/o),r.y=a*o,r.x*=f;break;case 0:n.phi=s(a),r.y=-r.y;break;case 1:n.phi=-s(a)}n.lam=u(r.x,r.y)}},t.es=0}function br(e,t){var r=.79788456,n=.1013211836*(t?2:4);e.es=0,e.fwd=function(e,t){t.x=r*e.lam*(1-n*e.phi*e.phi),t.y=r*e.phi},e.inv=function(e,t){t.phi=e.y/r,t.lam=e.x/(r*(1-n*t.phi*t.phi))}}function wr(e,t,r){e.es=0,e.fwd=function(e,n){e.phi=Kt(.883883476*i(e.phi)),n.x=t*e.lam*o(e.phi),n.x/=o(e.phi*=.333333333333333),n.y=r*i(e.phi)},e.inv=function(e,n){n.phi=Kt(e.y/r),n.lam=e.x*o(n.phi)/t,n.phi*=3,n.lam/=o(n.phi),n.phi=Kt(1.13137085*i(n.phi))}}function xr(e,t){var r=t?1.5:2,n=t?.5:1,i=1.01346,o=1.2158542;e.es=0,e.fwd=function(e,t){t.x=i*e.lam*(r-n*h(1+o*e.phi*e.phi)),t.y=i*e.phi},e.inv=function(e,t){t.phi=e.y/i,t.lam=e.x/(i*(r-n*h(1+o*t.phi*t.phi)))}}function Sr(t,r){var n,o,a,s,l,c=1.732050807568877;r?(a=.44329,s=.80404,n=6,o=5.61125,l=3):(a=1.01346,s=.9191,n=4,o=2.147143718212938,l=2),t.es=0,t.fwd=function(t,r){var u,d,p,m;for(u=o*i(t.phi),t.phi*=1.10265779,m=10;m&&(d=h(1+t.phi*t.phi),t.phi-=p=((n-d)*t.phi-f(t.phi+d)-u)/(n-2*d),!(e(p)<1e-10));--m);m||(t.phi=u<0?-c:c),r.x=a*t.lam*(l-h(1+t.phi*t.phi)),r.y=s*t.phi},t.inv=function(e,t){var r;t.phi=e.y/s,r=h(1+t.phi*t.phi),t.lam=e.x/(a*(l-r)),t.phi=Kt(((n-r)*t.phi-f(t.phi+r))/o)}}function Er(t){return function(r){!function(t,r){var n,s,l,d,p,f,g,y,_,v,b=1e-10;switch(Y(t.params,"tlat_1")&&Y(t.params,"tlat_2")?(l=Y(t.params,"rlat_1"),d=Y(t.params,"rlat_2"),y=.5*(d+l),(e(n=.5*(d-l))<b||e(y)<b)&&j(-42)):j(-41),r){case"TISSOT":p=i(y),s=o(n),g=h(((f=p/s+s/p)-2*i(t.phi0))/p);break;case"MURD1":f=i(n)/(n*a(y))+y,g=f-t.phi0,p=i(y);break;case"MURD2":f=(s=h(o(n)))/a(y),g=f+a(y-t.phi0),p=i(y)*s;break;case"MURD3":f=n/(a(y)*a(n))+y,g=f-t.phi0,p=i(y)*i(n)*a(n)/(n*n);break;case"EULER":p=i(y)*i(n)/n,f=(n*=.5)/(a(n)*a(y))+y,g=f-t.phi0;break;case"PCONIC":p=i(y),v=o(n),_=1/a(y),e(n=t.phi0-y)-b>=C&&j(-43),g=v*(_-a(n));break;case"VITK1":p=(s=a(n))*i(y)/n,f=n/(s*a(y))+y,g=f-t.phi0}function w(e,t){var n;switch(r){case"MURD2":n=f+a(y-e.phi);break;case"PCONIC":n=v*(_-a(e.phi-y));break;default:n=f-e.phi}t.x=n*i(e.lam*=p),t.y=g-n*o(e.lam)}function x(e,t){var n;switch(n=m(e.x,e.y=g-e.y),p<0&&(n=-n,e.x=-e.x,e.y=-e.y),t.lam=u(e.x,e.y)/p,r){case"PCONIC":t.phi=c(_-n/v)+y;break;case"MURD2":t.phi=y-c(n-f);break;default:t.phi=f-n}}t.inv=x,t.fwd=w,t.es=0}(r,t)}}function Tr(t,r){var n,l,p,f,g,y,_,v,b=1e-10;if(v=e((l=e(t.phi0))-C)<b?t.phi0<0?0:1:l>b?2:3,r=e(r),t.es){switch(v){case 1:case 0:e(r-C)<b?_=2*t.k0/h(d(1+t.e,1+t.e)*d(1-t.e,1-t.e)):(_=o(r)/fr(r,l=i(r),t.e),l*=t.e,_/=h(1-l*l));break;case 3:case 2:l=i(t.phi0),n=2*c(w(t.phi0,l,t.e))-C,l*=t.e,_=2*t.k0*o(t.phi0)/h(1-l*l),g=i(n),y=o(n)}t.fwd=function(e,r){var n,a,s,l,u,h=0,d=0;switch(n=o(e.lam),a=i(e.lam),u=i(e.phi),(2==v||3==v)&&(h=i(s=2*c(w(e.phi,u,t.e))-C),d=o(s)),v){case 2:l=_/(y*(1+g*h+y*d*n)),r.y=l*(y*h-g*d*n),r.x=l*d;break;case 3:l=_/(1+d*n),r.y=l*h,r.x=l*d;break;case 0:e.phi=-e.phi,n=-n,u=-u;case 1:r.x=_*fr(e.phi,u,t.e),r.y=-r.x*n}r.x=r.x*a},t.inv=function(r,n){n.phi;var l,h,p,f,b=0,w=0,x=0,S=0;switch(p=m(r.x,r.y),v){case 2:case 3:l=o(b=2*u(p*y,_)),h=i(b),w=s(0==p?l*g:l*g+r.y*h*y/p),b=a(.5*(C+w)),r.x*=h,r.y=p*y*l-r.y*g*h,S=C,x=.5*t.e;break;case 1:r.y=-r.y;case 0:w=C-2*c(b=-p/_),S=-C,x=-.5*t.e}for(f=0;f<8;f++,w=n.phi)if(h=t.e*i(w),n.phi=2*c(b*d((1+h)/(1-h),x))-S,e(w-n.phi)<1e-10)return 0==v&&(n.phi=-n.phi),void(n.lam=0==r.x&&0==r.y?0:u(r.x,r.y));q()}}else{switch(v){case 2:p=i(t.phi0),f=o(t.phi0);case 3:_=2*t.k0;break;case 0:case 1:_=e(r-C)>=b?o(r)/a(A-.5*r):2*t.k0}t.fwd=function(t,r){var n=t.phi,s=i(n),l=o(n),c=o(t.lam),u=i(t.lam);switch(v){case 3:case 2:r.y=3==v?1+l*c:1+p*s+f*l*c,r.y<=b&&F(),r.x=(r.y=_/r.y)*l*u,r.y*=3==v?s:f*s-p*l*c;break;case 1:c=-c,n=-n;case 0:e(n-C)<1e-8&&F(),r.x=u*(r.y=_*a(A+.5*n)),r.y*=c}},t.inv=function(r,n){var a,l,h,d;switch(h=i(a=2*c((l=m(r.x,r.y))/_)),d=o(a),n.lam=0,v){case 3:e(l)<=b?n.phi=0:n.phi=s(r.y*h/l),0==d&&0==r.x||(n.lam=u(r.x*h,d*l));break;case 2:e(l)<=b?n.phi=t.phi0:n.phi=s(d*p+r.y*h*f/l),0==(a=d-p*i(n.phi))&&0==r.x||(n.lam=u(r.x*h*f,a*l));break;case 1:r.y=-r.y;case 0:e(l)<=b?n.phi=t.phi0:n.phi=s(0==v?-d:d),n.lam=0==r.x&&0==r.y?0:u(r.x,r.y)}}}function w(e,t,r){return t*=r,a(.5*(C+e))*d((1-t)/(1+t),.5*r)}}function Ar(e,t){return d((1-e)/(1+e),t)}function Cr(e,t,r,n){var s=r/t,l=t,u=1/r;e.inv=function(e,t){var r;e.y/=l,r=o(t.phi=n?c(e.y):Kt(e.y)),t.phi/=u,t.lam=e.x/(s*o(t.phi)),n?t.lam/=r*r:t.lam*=r},e.fwd=function(e,t){var r;t.x=s*e.lam*o(e.phi),t.y=l,e.phi*=u,r=o(e.phi),n?(t.x*=r*r,t.y*=a(e.phi)):(t.x/=r,t.y*=i(e.phi))},e.es=0}function Ir(t){var r,n,a,c=1e-10,d=.5,m=.16666666666666666,g=.08333333333333333,y=.05,_=.03333333333333333,v=.023809523809523808,b=.017857142857142856;t.es?((a=Zt(t.es))||e_error_0(),n=Yt(t.phi0,i(t.phi0),o(t.phi0),a),r=t.es/(1-t.es),t.fwd=function(s,l){var u,d,p,f,w,x;s.lam<-C||s.lam>C?z(-14):(u=i(s.phi),d=o(s.phi),p=e(d)>c?u/d:0,p*=p,f=d*s.lam,w=f*f,f/=h(1-t.es*u*u),x=r*d*d,l.x=t.k0*f*(1+m*w*(1-p+x+y*w*(5+p*(p-18)+x*(14-58*p)+v*w*(61+p*(p*(179-p)-479))))),l.y=t.k0*(Yt(s.phi,u,d,a)-n+u*f*s.lam*.5*(1+g*w*(5-p+x*(9+4*x)+_*w*(61+p*(p-58)+x*(270-330*p)+b*w*(1385+p*(p*(543-p)-3111)))))))},t.inv=function(s,l){var c,u,p,f,w,x,S;l.phi=Xt(n+s.y/t.k0,t.es,a),e(l.phi)>=C?(l.phi=s.y<0?-C:C,l.lam=0):(x=i(l.phi),p=o(l.phi),S=e(p)>1e-10?x/p:0,c=r*p*p,f=s.x*h(u=1-t.es*x*x)/t.k0,u*=S,S*=S,w=f*f,l.phi-=u*w/(1-t.es)*d*(1-w*g*(5+S*(3-9*c)+c*(1-4*c)-w*_*(61+S*(90-252*c+45*S)+46*c-w*b*(1385+S*(3633+S*(4095+1575*S)))))),l.lam=f*(1-w*m*(1+2*S+c-w*y*(5+S*(28+24*S+8*c)+6*c-w*v*(61+S*(662+S*(1320+720*S))))))/p)}):(r=t.k0,n=.5*r,t.fwd=function(a,s){var u,d;a.lam<-C||a.lam>C?z(-14):(d=o(a.phi),u=d*i(a.lam),e(e(u)-1)<=c&&F(),s.x=n*f((1+u)/(1-u)),s.y=d*o(a.lam)/h(1-u*u),(u=e(s.y))>=1?u-1>c?F():s.y=0:s.y=l(s.y),a.phi<0&&(s.y=-s.y),s.y=r*(s.y-t.phi0))},t.inv=function(e,n){var i=p(e.x/r),a=.5*(i-1/i);i=o(t.phi0+e.y/r),n.phi=s(h((1-i*i)/(1+a*a))),e.y<0&&-n.phi+t.phi0<0&&(n.phi=-n.phi),n.lam=a||i?u(a,i):0})}function kr(e,t){var r=.8773826753,n=1.139753528477/t;e.es=0,e.fwd=function(e,a){var s=Kt(t*i(e.phi));a.x=r*e.lam*o(s),a.y=n*s},e.inv=function(e,a){e.y/=n,a.phi=Kt(i(e.y)/t),a.lam=e.x/(r*o(e.y))}}function Pr(t,r){t.fwd=function(t,n){var i,o,a,s;a=e(P*t.phi),s=(s=1-a*a)<0?0:h(s),e(t.lam)<1e-10?(n.x=0,n.y=w*(t.phi<0?-a:a)/(1+s)):(o=.5*e(w/t.lam-t.lam/w),r?(i=a/(1+s),n.x=w*(h(o*o+1-i*i)-o),n.y=w*i):(i=(s*h(1+o*o)-o*s*s)/(1+o*o*a*a),n.x=w*i,n.y=w*h(1-i*(i+2*o)+1e-10)),t.lam<0&&(n.x=-n.x),t.phi<0&&(n.y=-n.y))},t.es=0}Vt.Constants={},Vt.Math={},Vt.Accumulator={},(jt=Vt.Constants).WGS84={a:6378137,f:1/298.257223563},jt.version={major:1,minor:48,patch:0},jt.version_string="1.48",(Ut=Vt.Math).digits=53,Ut.epsilon=Math.pow(.5,Ut.digits-1),Ut.degree=Math.PI/180,Ut.sq=function(e){return e*e},Ut.hypot=function(e,t){var r,n;return e=Math.abs(e),t=Math.abs(t),r=Math.max(e,t),n=Math.min(e,t)/(r||1),r*Math.sqrt(1+n*n)},Ut.cbrt=function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},Ut.log1p=function(e){var t=1+e,r=t-1;return 0===r?e:e*Math.log(t)/r},Ut.atanh=function(e){var t=Math.abs(e);return t=Ut.log1p(2*t/(1-t))/2,e<0?-t:t},Ut.copysign=function(e,t){return Math.abs(e)*(t<0||0===t&&1/t<0?-1:1)},Ut.sum=function(e,t){var r=e+t,n=r-t,i=r-n;return{s:r,t:-((n-=e)+(i-=t))}},Ut.polyval=function(e,t,r,n){for(var i=e<0?0:t[r++];--e>=0;)i=i*n+t[r++];return i},Ut.AngRound=function(e){if(0===e)return e;var t=1/16,r=Math.abs(e);return r=r<t?t-(t-r):r,e<0?-r:r},Ut.AngNormalize=function(e){return(e%=360)<=-180?e+360:e<=180?e:e-360},Ut.LatFix=function(e){return Math.abs(e)>90?Number.NaN:e},Ut.AngDiff=function(e,t){var r=Ut.sum(Ut.AngNormalize(-e),Ut.AngNormalize(t)),n=Ut.AngNormalize(r.s),i=r.t;return Ut.sum(180===n&&i>0?-180:n,i)},Ut.sincosd=function(e){var t,r,n,i,o,a;switch(t=e%360,t-=90*(r=Math.floor(t/90+.5)),t*=this.degree,n=Math.sin(t),i=Math.cos(t),3&r){case 0:o=n,a=i;break;case 1:o=i,a=-n;break;case 2:o=-n,a=-i;break;default:o=-i,a=n}return e&&(o+=0,a+=0),{s:o,c:a}},Ut.atan2d=function(e,t){var r,n,i=0;switch(Math.abs(e)>Math.abs(t)&&(r=t,t=e,e=r,i=2),t<0&&(t=-t,++i),n=Math.atan2(e,t)/this.degree,i){case 1:n=(e>=0?180:-180)-n;break;case 2:n=90-n;break;case 3:n=-90+n}return n},function(e,t){e.Accumulator=function(e){this.Set(e)},e.Accumulator.prototype.Set=function(t){t||(t=0),t.constructor===e.Accumulator?(this._s=t._s,this._t=t._t):(this._s=t,this._t=0)},e.Accumulator.prototype.Add=function(e){var r=t.sum(e,this._t),n=t.sum(r.s,this._s);r=r.t,this._s=n.s,this._t=n.t,0===this._s?this._s=r:this._t+=r},e.Accumulator.prototype.Sum=function(t){var r;return t?((r=new e.Accumulator(this)).Add(t),r._s):this._s},e.Accumulator.prototype.Negate=function(){this._s*=-1,this._t*=-1}}(Vt.Accumulator,Vt.Math),Vt.Geodesic={},Vt.GeodesicLine={},Vt.PolygonArea={},function(e,t,r,n,i){var o,a,s,l,c,u,h,d,p,f,m,g=20+n.digits+10,y=n.epsilon,_=200*y,v=Math.sqrt(y),b=y*_,w=1e3*v;e.tiny_=Math.sqrt(Number.MIN_VALUE),e.nC1_=6,e.nC1p_=6,e.nC2_=6,e.nC3_=6,e.nC4_=6,o=e.nC3_*(e.nC3_-1)/2,a=e.nC4_*(e.nC4_+1)/2,e.CAP_C1=1,e.CAP_C1p=2,e.CAP_C2=4,e.CAP_C3=8,e.CAP_C4=16,e.NONE=0,e.ARC=64,e.LATITUDE=128,e.LONGITUDE=256|e.CAP_C3,e.AZIMUTH=512,e.DISTANCE=1024|e.CAP_C1,e.STANDARD=e.LATITUDE|e.LONGITUDE|e.AZIMUTH|e.DISTANCE,e.DISTANCE_IN=2048|e.CAP_C1|e.CAP_C1p,e.REDUCEDLENGTH=4096|e.CAP_C1|e.CAP_C2,e.GEODESICSCALE=8192|e.CAP_C1|e.CAP_C2,e.AREA=16384|e.CAP_C4,e.ALL=32671,e.LONG_UNROLL=32768,e.OUT_MASK=32640|e.LONG_UNROLL,e.SinCosSeries=function(e,t,r,n){var i=n.length,o=i-(e?1:0),a=2*(r-t)*(r+t),s=1&o?n[--i]:0,l=0;for(o=Math.floor(o/2);o--;)s=a*(l=a*s-l+n[--i])-s+n[--i];return e?2*t*r*s:r*(s-l)},s=function(e,t){var r,i,o,a,s,l,c,u,h,d,p,f,m=n.sq(e),g=n.sq(t),y=(m+g-1)/6;return 0===g&&y<=0?r=0:(l=y,(s=(i=m*g/4)*(i+2*(a=y*(o=n.sq(y)))))>=0?(c=i+a,c+=c<0?-Math.sqrt(s):Math.sqrt(s),l+=(u=n.cbrt(c))+(0!==u?o/u:0)):(h=Math.atan2(Math.sqrt(-s),-(i+a)),l+=2*y*Math.cos(h/3)),d=Math.sqrt(n.sq(l)+g),f=((p=l<0?g/(d-l):l+d)-g)/(2*d),r=p/(Math.sqrt(p+n.sq(f))+f)),r},l=[1,4,64,0,256],e.A1m1f=function(e){var t=Math.floor(3);return(n.polyval(t,l,0,n.sq(e))/l[t+1]+e)/(1-e)},c=[-1,6,-16,32,-9,64,-128,2048,9,-16,768,3,-5,512,-7,1280,-7,2048],e.C1f=function(t,r){var i,o,a=n.sq(t),s=t,l=0;for(i=1;i<=e.nC1_;++i)o=Math.floor((e.nC1_-i)/2),r[i]=s*n.polyval(o,c,l,a)/c[l+o+1],l+=o+2,s*=t},u=[205,-432,768,1536,4005,-4736,3840,12288,-225,116,384,-7173,2695,7680,3467,7680,38081,61440],e.C1pf=function(t,r){var i,o,a=n.sq(t),s=t,l=0;for(i=1;i<=e.nC1p_;++i)o=Math.floor((e.nC1p_-i)/2),r[i]=s*n.polyval(o,u,l,a)/u[l+o+1],l+=o+2,s*=t},h=[-11,-28,-192,0,256],e.A2m1f=function(e){var t=Math.floor(3);return(n.polyval(t,h,0,n.sq(e))/h[t+1]-e)/(1+e)},d=[1,2,16,32,35,64,384,2048,15,80,768,7,35,512,63,1280,77,2048],e.C2f=function(t,r){var i,o,a=n.sq(t),s=t,l=0;for(i=1;i<=e.nC2_;++i)o=Math.floor((e.nC2_-i)/2),r[i]=s*n.polyval(o,d,l,a)/d[l+o+1],l+=o+2,s*=t},e.Geodesic=function(e,t){if(this.a=e,this.f=t,this._f1=1-this.f,this._e2=this.f*(2-this.f),this._ep2=this._e2/n.sq(this._f1),this._n=this.f/(2-this.f),this._b=this.a*this._f1,this._c2=(n.sq(this.a)+n.sq(this._b)*(0===this._e2?1:(this._e2>0?n.atanh(Math.sqrt(this._e2)):Math.atan(Math.sqrt(-this._e2)))/Math.sqrt(Math.abs(this._e2))))/2,this._etol2=.1*v/Math.sqrt(Math.max(.001,Math.abs(this.f))*Math.min(1,1-this.f/2)/2),!(isFinite(this.a)&&this.a>0))throw new Error("Equatorial radius is not positive");if(!(isFinite(this._b)&&this._b>0))throw new Error("Polar semi-axis is not positive");this._A3x=new Array(6),this._C3x=new Array(o),this._C4x=new Array(a),this.A3coeff(),this.C3coeff(),this.C4coeff()},p=[-3,128,-2,-3,64,-1,-3,-1,16,3,-1,-2,8,1,-1,2,1,1],e.Geodesic.prototype.A3coeff=function(){var e,t,r=0,i=0;for(e=5;e>=0;--e)t=Math.min(6-e-1,e),this._A3x[i++]=n.polyval(t,p,r,this._n)/p[r+t+1],r+=t+2},f=[3,128,2,5,128,-1,3,3,64,-1,0,1,8,-1,1,4,5,256,1,3,128,-3,-2,3,64,1,-3,2,32,7,512,-10,9,384,5,-9,5,192,7,512,-14,7,512,21,2560],e.Geodesic.prototype.C3coeff=function(){var t,r,i,o=0,a=0;for(t=1;t<e.nC3_;++t)for(r=e.nC3_-1;r>=t;--r)i=Math.min(e.nC3_-r-1,r),this._C3x[a++]=n.polyval(i,f,o,this._n)/f[o+i+1],o+=i+2},m=[97,15015,1088,156,45045,-224,-4784,1573,45045,-10656,14144,-4576,-858,45045,64,624,-4576,6864,-3003,15015,100,208,572,3432,-12012,30030,45045,1,9009,-2944,468,135135,5792,1040,-1287,135135,5952,-11648,9152,-2574,135135,-64,-624,4576,-6864,3003,135135,8,10725,1856,-936,225225,-8448,4992,-1144,225225,-1440,4160,-4576,1716,225225,-136,63063,1024,-208,105105,3584,-3328,1144,315315,-128,135135,-2560,832,405405,128,99099],e.Geodesic.prototype.C4coeff=function(){var t,r,i,o=0,a=0;for(t=0;t<e.nC4_;++t)for(r=e.nC4_-1;r>=t;--r)i=e.nC4_-r-1,this._C4x[a++]=n.polyval(i,m,o,this._n)/m[o+i+1],o+=i+2},e.Geodesic.prototype.A3f=function(e){return n.polyval(5,this._A3x,0,e)},e.Geodesic.prototype.C3f=function(t,r){var i,o,a=1,s=0;for(i=1;i<e.nC3_;++i)o=e.nC3_-i-1,a*=t,r[i]=a*n.polyval(o,this._C3x,s,t),s+=o+1},e.Geodesic.prototype.C4f=function(t,r){var i,o,a=1,s=0;for(i=0;i<e.nC4_;++i)o=e.nC4_-i-1,r[i]=a*n.polyval(o,this._C4x,s,t),s+=o+1,a*=t},e.Geodesic.prototype.Lengths=function(t,r,n,i,o,a,s,l,c,u,h,d,p){var f,m,g,y,_={},v=0,b=0,w=0,x=0;if((h&=e.OUT_MASK)&(e.DISTANCE|e.REDUCEDLENGTH|e.GEODESICSCALE)&&(w=e.A1m1f(t),e.C1f(t,d),h&(e.REDUCEDLENGTH|e.GEODESICSCALE)&&(x=e.A2m1f(t),e.C2f(t,p),v=w-x,x=1+x),w=1+w),h&e.DISTANCE)f=e.SinCosSeries(!0,a,s,d)-e.SinCosSeries(!0,n,i,d),_.s12b=w*(r+f),h&(e.REDUCEDLENGTH|e.GEODESICSCALE)&&(b=v*r+(w*f-x*(e.SinCosSeries(!0,a,s,p)-e.SinCosSeries(!0,n,i,p))));else if(h&(e.REDUCEDLENGTH|e.GEODESICSCALE)){for(m=1;m<=e.nC2_;++m)p[m]=w*d[m]-x*p[m];b=v*r+(e.SinCosSeries(!0,a,s,p)-e.SinCosSeries(!0,n,i,p))}return h&e.REDUCEDLENGTH&&(_.m0=v,_.m12b=l*(i*a)-o*(n*s)-i*s*b),h&e.GEODESICSCALE&&(g=i*s+n*a,y=this._ep2*(c-u)*(c+u)/(o+l),_.M12=g+(y*a-s*b)*n/o,_.M21=g-(y*n-i*b)*a/l),_},e.Geodesic.prototype.InverseStart=function(t,r,i,o,a,l,c,u,h,d,p){var f,m,g,y,v,b,x,S,E,T,A,C,I,k,P,M,R,D,O,L,B={},$=o*r-a*t,z=a*r+o*t;return B.sig12=-1,f=o*r,f+=a*t,(m=z>=0&&$<.5&&a*c<.5)?(y=n.sq(t+o),y/=y+n.sq(r+a),B.dnm=Math.sqrt(1+this._ep2*y),g=c/(this._f1*B.dnm),v=Math.sin(g),b=Math.cos(g)):(v=u,b=h),B.salp1=a*v,B.calp1=b>=0?$+a*t*n.sq(v)/(1+b):f-a*t*n.sq(v)/(1-b),S=n.hypot(B.salp1,B.calp1),E=t*o+r*a*b,m&&S<this._etol2?(B.salp2=r*v,B.calp2=$-r*o*(b>=0?n.sq(v)/(1+b):1-b),x=n.hypot(B.salp2,B.calp2),B.salp2/=x,B.calp2/=x,B.sig12=Math.atan2(S,E)):Math.abs(this._n)>.1||E>=0||S>=6*Math.abs(this._n)*Math.PI*n.sq(r)||(L=Math.atan2(-u,-h),this.f>=0?(k=(I=n.sq(t)*this._ep2)/(2*(1+Math.sqrt(1+I))+I),T=L/(C=this.f*r*this.A3f(k)*Math.PI),A=f/(C*r)):(P=a*r-o*t,M=Math.atan2(f,P),A=c/(C=((T=(R=this.Lengths(this._n,Math.PI+M,t,-r,i,o,a,l,r,a,e.REDUCEDLENGTH,d,p)).m12b/(r*a*R.m0*Math.PI)-1)<-.01?f/T:-this.f*n.sq(r)*Math.PI)/r)),A>-_&&T>-1-w?this.f>=0?(B.salp1=Math.min(1,-T),B.calp1=-Math.sqrt(1-n.sq(B.salp1))):(B.calp1=Math.max(T>-_?0:-1,T),B.salp1=Math.sqrt(1-n.sq(B.calp1))):(D=s(T,A),O=C*(this.f>=0?-T*D/(1+D):-A*(1+D)/D),v=Math.sin(O),b=-Math.cos(O),B.salp1=a*v,B.calp1=f-a*t*n.sq(v)/(1-b))),B.salp1<=0?(B.salp1=1,B.calp1=0):(x=n.hypot(B.salp1,B.calp1),B.salp1/=x,B.calp1/=x),B},e.Geodesic.prototype.Lambda12=function(t,r,i,o,a,s,l,c,u,h,d,p,f,m){var g,y,_,v,b,w,x,S,E,T,A,C,I,k={};return 0===t&&0===c&&(c=-e.tiny_),y=l*r,_=n.hypot(c,l*t),k.ssig1=t,v=y*t,k.csig1=b=c*r,g=n.hypot(k.ssig1,k.csig1),k.ssig1/=g,k.csig1/=g,k.salp2=a!==r?y/a:l,k.calp2=a!==r||Math.abs(o)!==-t?Math.sqrt(n.sq(c*r)+(r<-t?(a-r)*(r+a):(t-o)*(t+o)))/a:Math.abs(c),k.ssig2=o,w=y*o,k.csig2=x=k.calp2*a,g=n.hypot(k.ssig2,k.csig2),k.ssig2/=g,k.csig2/=g,k.sig12=Math.atan2(Math.max(0,k.csig1*k.ssig2-k.ssig1*k.csig2),k.csig1*k.csig2+k.ssig1*k.ssig2),S=Math.max(0,b*w-v*x),E=b*x+v*w,A=Math.atan2(S*h-E*u,E*h+S*u),C=n.sq(_)*this._ep2,k.eps=C/(2*(1+Math.sqrt(1+C))+C),this.C3f(k.eps,m),T=e.SinCosSeries(!0,k.ssig2,k.csig2,m)-e.SinCosSeries(!0,k.ssig1,k.csig1,m),k.domg12=-this.f*this.A3f(k.eps)*y*(k.sig12+T),k.lam12=A+k.domg12,d&&(0===k.calp2?k.dlam12=-2*this._f1*i/t:(I=this.Lengths(k.eps,k.sig12,k.ssig1,k.csig1,i,k.ssig2,k.csig2,s,r,a,e.REDUCEDLENGTH,p,f),k.dlam12=I.m12b,k.dlam12*=this._f1/(k.calp2*a))),k},e.Geodesic.prototype.Inverse=function(t,r,i,o,a){var s,l;return a||(a=e.STANDARD),a===e.LONG_UNROLL&&(a|=e.STANDARD),a&=e.OUT_MASK,l=(s=this.InverseInt(t,r,i,o,a)).vals,a&e.AZIMUTH&&(l.azi1=n.atan2d(s.salp1,s.calp1),l.azi2=n.atan2d(s.salp2,s.calp2)),l},e.Geodesic.prototype.InverseInt=function(t,r,i,o,a){var s,l,c,u,h,d,p,f,m,_,v,w,x,S,E,T,A,C,I,k,P,M,R,D,O,L,B,$,z,F,q,N,j,U,V,G,W,H,Z,Y,X,K,Q,J,ee,te,re,ne,ie,oe,ae,se,le,ce,ue,he,de,pe,fe,me,ge,ye,_e,ve,be,we={};if(we.lat1=t=n.LatFix(t),we.lat2=i=n.LatFix(i),t=n.AngRound(t),i=n.AngRound(i),l=(s=n.AngDiff(r,o)).t,s=s.s,a&e.LONG_UNROLL?(we.lon1=r,we.lon2=r+s+l):(we.lon1=n.AngNormalize(r),we.lon2=n.AngNormalize(o)),s=(c=s>=0?1:-1)*n.AngRound(s),l=n.AngRound(180-s-c*l),E=s*n.degree,T=(u=n.sincosd(s>90?l:s)).s,A=(s>90?-1:1)*u.c,(h=Math.abs(t)<Math.abs(i)?-1:1)<0&&(c*=-1,u=t,t=i,i=u),t*=d=t<0?1:-1,i*=d,u=n.sincosd(t),p=this._f1*u.s,f=u.c,p/=u=n.hypot(p,f),f/=u,f=Math.max(e.tiny_,f),u=n.sincosd(i),m=this._f1*u.s,_=u.c,m/=u=n.hypot(m,_),_/=u,_=Math.max(e.tiny_,_),f<-p?_===f&&(m=m<0?p:-p):Math.abs(m)===-p&&(_=f),x=Math.sqrt(1+this._ep2*n.sq(p)),S=Math.sqrt(1+this._ep2*n.sq(m)),R=new Array(e.nC1_+1),D=new Array(e.nC2_+1),O=new Array(e.nC3_),(L=-90===t||0===T)&&(k=T,M=0,$=p,z=(I=A)*f,F=m,q=(P=1)*_,C=Math.atan2(Math.max(0,z*F-$*q),z*q+$*F),v=(B=this.Lengths(this._n,C,$,z,x,F,q,S,f,_,a|e.DISTANCE|e.REDUCEDLENGTH,R,D)).s12b,w=B.m12b,a&e.GEODESICSCALE&&(we.M12=B.M12,we.M21=B.M21),C<1||w>=0?(C<3*e.tiny_&&(C=w=v=0),w*=this._b,v*=this._b,we.a12=C/n.degree):L=!1),de=2,!L&&0===p&&(this.f<=0||l>=180*this.f))I=P=0,k=M=1,v=this.a*E,C=j=E/this._f1,w=this._b*Math.sin(C),a&e.GEODESICSCALE&&(we.M12=we.M21=Math.cos(C)),we.a12=s/this._f1;else if(!L)if(C=(B=this.InverseStart(p,f,x,m,_,S,E,T,A,R,D)).sig12,k=B.salp1,I=B.calp1,C>=0)M=B.salp2,P=B.calp2,U=B.dnm,v=C*this._b*U,w=n.sq(U)*this._b*Math.sin(C/U),a&e.GEODESICSCALE&&(we.M12=we.M21=Math.cos(C/U)),we.a12=C/n.degree,j=E/(this._f1*U);else{for(V=0,G=e.tiny_,W=1,H=e.tiny_,Z=-1,Y=!1,X=!1;V<g&&(K=(B=this.Lambda12(p,f,x,m,_,S,k,I,T,A,V<20,R,D,O)).lam12,M=B.salp2,P=B.calp2,C=B.sig12,$=B.ssig1,z=B.csig1,F=B.ssig2,q=B.csig2,N=B.eps,fe=B.domg12,Q=B.dlam12,!X&&Math.abs(K)>=(Y?8:1)*y);++V)K>0&&(V<20||I/k>Z/H)?(H=k,Z=I):K<0&&(V<20||I/k<W/G)&&(G=k,W=I),V<20&&Q>0&&(J=-K/Q,ee=Math.sin(J),(re=k*(te=Math.cos(J))+I*ee)>0&&Math.abs(J)<Math.PI)?(I=I*te-k*ee,k=re,k/=u=n.hypot(k,I),I/=u,Y=Math.abs(K)<=16*y):(k=(G+H)/2,I=(W+Z)/2,k/=u=n.hypot(k,I),I/=u,Y=!1,X=Math.abs(G-k)+(W-I)<b||Math.abs(k-H)+(I-Z)<b);ne=a|(a&(e.REDUCEDLENGTH|e.GEODESICSCALE)?e.DISTANCE:e.NONE),v=(B=this.Lengths(N,C,$,z,x,F,q,S,f,_,ne,R,D)).s12b,w=B.m12b,a&e.GEODESICSCALE&&(we.M12=B.M12,we.M21=B.M21),w*=this._b,v*=this._b,we.a12=C/n.degree,a&e.AREA&&(ve=Math.sin(fe),de=T*(be=Math.cos(fe))-A*ve,pe=A*be+T*ve)}return a&e.DISTANCE&&(we.s12=0+v),a&e.REDUCEDLENGTH&&(we.m12=0+w),a&e.AREA&&(ie=k*f,0!==(oe=n.hypot(I,k*p))&&0!==ie?($=p,z=I*f,F=m,q=P*_,N=(se=n.sq(oe)*this._ep2)/(2*(1+Math.sqrt(1+se))+se),le=n.sq(this.a)*oe*ie*this._e2,$/=u=n.hypot($,z),z/=u,F/=u=n.hypot(F,q),q/=u,ce=new Array(e.nC4_),this.C4f(N,ce),ue=e.SinCosSeries(!1,$,z,ce),he=e.SinCosSeries(!1,F,q,ce),we.S12=le*(he-ue)):we.S12=0,!L&&de>1&&(de=Math.sin(j),pe=Math.cos(j)),!L&&pe>-.7071&&m-p<1.75?(fe=1+pe,me=1+f,ge=1+_,ae=2*Math.atan2(de*(p*ge+m*me),fe*(p*m+me*ge))):(_e=P*I+M*k,0==(ye=M*I-P*k)&&_e<0&&(ye=e.tiny_*I,_e=-1),ae=Math.atan2(ye,_e)),we.S12+=this._c2*ae,we.S12*=h*c*d,we.S12+=0),h<0&&(u=k,k=M,M=u,u=I,I=P,P=u,a&e.GEODESICSCALE&&(u=we.M12,we.M12=we.M21,we.M21=u)),{vals:we,salp1:k*=h*c,calp1:I*=h*d,salp2:M*=h*c,calp2:P*=h*d}},e.Geodesic.prototype.GenDirect=function(r,n,i,o,a,s){return s?s===e.LONG_UNROLL&&(s|=e.STANDARD):s=e.STANDARD,o||(s|=e.DISTANCE_IN),new t.GeodesicLine(this,r,n,i,s).GenPosition(o,a,s)},e.Geodesic.prototype.Direct=function(e,t,r,n,i){return this.GenDirect(e,t,r,!1,n,i)},e.Geodesic.prototype.ArcDirect=function(e,t,r,n,i){return this.GenDirect(e,t,r,!0,n,i)},e.Geodesic.prototype.Line=function(e,r,n,i){return new t.GeodesicLine(this,e,r,n,i)},e.Geodesic.prototype.DirectLine=function(e,t,r,n,i){return this.GenDirectLine(e,t,r,!1,n,i)},e.Geodesic.prototype.ArcDirectLine=function(e,t,r,n,i){return this.GenDirectLine(e,t,r,!0,n,i)},e.Geodesic.prototype.GenDirectLine=function(r,n,i,o,a,s){var l;return s||(s=e.STANDARD|e.DISTANCE_IN),o||(s|=e.DISTANCE_IN),(l=new t.GeodesicLine(this,r,n,i,s)).GenSetDistance(o,a),l},e.Geodesic.prototype.InverseLine=function(r,i,o,a,s){var l,c,u;return s||(s=e.STANDARD|e.DISTANCE_IN),l=this.InverseInt(r,i,o,a,e.ARC),u=n.atan2d(l.salp1,l.calp1),s&e.OUT_MASK&e.DISTANCE_IN&&(s|=e.DISTANCE),(c=new t.GeodesicLine(this,r,i,u,s,l.salp1,l.calp1)).SetArc(l.vals.a12),c},e.Geodesic.prototype.Polygon=function(e){return new r.PolygonArea(this,e)},e.WGS84=new e.Geodesic(i.WGS84.a,i.WGS84.f)}(Vt.Geodesic,Vt.GeodesicLine,Vt.PolygonArea,Vt.Math,Vt.Constants),function(e,t,r){t.GeodesicLine=function(t,n,i,o,a,s,l){var c,u,h,d,p,f;a||(a=e.STANDARD|e.DISTANCE_IN),this.a=t.a,this.f=t.f,this._b=t._b,this._c2=t._c2,this._f1=t._f1,this.caps=a|e.LATITUDE|e.AZIMUTH|e.LONG_UNROLL,this.lat1=r.LatFix(n),this.lon1=i,void 0===s||void 0===l?(this.azi1=r.AngNormalize(o),c=r.sincosd(r.AngRound(this.azi1)),this.salp1=c.s,this.calp1=c.c):(this.azi1=o,this.salp1=s,this.calp1=l),c=r.sincosd(r.AngRound(this.lat1)),h=this._f1*c.s,u=c.c,h/=c=r.hypot(h,u),u/=c,u=Math.max(e.tiny_,u),this._dn1=Math.sqrt(1+t._ep2*r.sq(h)),this._salp0=this.salp1*u,this._calp0=r.hypot(this.calp1,this.salp1*h),this._ssig1=h,this._somg1=this._salp0*h,this._csig1=this._comg1=0!==h||0!==this.calp1?u*this.calp1:1,c=r.hypot(this._ssig1,this._csig1),this._ssig1/=c,this._csig1/=c,this._k2=r.sq(this._calp0)*t._ep2,d=this._k2/(2*(1+Math.sqrt(1+this._k2))+this._k2),this.caps&e.CAP_C1&&(this._A1m1=e.A1m1f(d),this._C1a=new Array(e.nC1_+1),e.C1f(d,this._C1a),this._B11=e.SinCosSeries(!0,this._ssig1,this._csig1,this._C1a),p=Math.sin(this._B11),f=Math.cos(this._B11),this._stau1=this._ssig1*f+this._csig1*p,this._ctau1=this._csig1*f-this._ssig1*p),this.caps&e.CAP_C1p&&(this._C1pa=new Array(e.nC1p_+1),e.C1pf(d,this._C1pa)),this.caps&e.CAP_C2&&(this._A2m1=e.A2m1f(d),this._C2a=new Array(e.nC2_+1),e.C2f(d,this._C2a),this._B21=e.SinCosSeries(!0,this._ssig1,this._csig1,this._C2a)),this.caps&e.CAP_C3&&(this._C3a=new Array(e.nC3_),t.C3f(d,this._C3a),this._A3c=-this.f*this._salp0*t.A3f(d),this._B31=e.SinCosSeries(!0,this._ssig1,this._csig1,this._C3a)),this.caps&e.CAP_C4&&(this._C4a=new Array(e.nC4_),t.C4f(d,this._C4a),this._A4=r.sq(this.a)*this._calp0*this._salp0*t._e2,this._B41=e.SinCosSeries(!1,this._ssig1,this._csig1,this._C4a)),this.a13=this.s13=Number.NaN},t.GeodesicLine.prototype.GenPosition=function(t,n,i){var o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C,I,k,P,M={};return i?i===e.LONG_UNROLL&&(i|=e.STANDARD):i=e.STANDARD,i&=this.caps&e.OUT_MASK,M.lat1=this.lat1,M.azi1=this.azi1,M.lon1=i&e.LONG_UNROLL?this.lon1:r.AngNormalize(this.lon1),t?M.a12=n:M.s12=n,t||this.caps&e.DISTANCE_IN&e.OUT_MASK?(l=0,c=0,t?(o=n*r.degree,a=(C=r.sincosd(n)).s,s=C.c):(d=n/(this._b*(1+this._A1m1)),p=Math.sin(d),f=Math.cos(d),o=d-((l=-e.SinCosSeries(!0,this._stau1*f+this._ctau1*p,this._ctau1*f-this._stau1*p,this._C1pa))-this._B11),a=Math.sin(o),s=Math.cos(o),Math.abs(this.f)>.01&&(u=this._ssig1*s+this._csig1*a,h=this._csig1*s-this._ssig1*a,l=e.SinCosSeries(!0,u,h,this._C1a),o-=((1+this._A1m1)*(o+(l-this._B11))-n/this._b)/Math.sqrt(1+this._k2*r.sq(u)),a=Math.sin(o),s=Math.cos(o))),u=this._ssig1*s+this._csig1*a,h=this._csig1*s-this._ssig1*a,S=Math.sqrt(1+this._k2*r.sq(u)),i&(e.DISTANCE|e.REDUCEDLENGTH|e.GEODESICSCALE)&&((t||Math.abs(this.f)>.01)&&(l=e.SinCosSeries(!0,u,h,this._C1a)),c=(1+this._A1m1)*(l-this._B11)),y=this._calp0*u,0===(_=r.hypot(this._salp0,this._calp0*h))&&(_=h=e.tiny_),w=this._salp0,x=this._calp0*h,t&&i&e.DISTANCE&&(M.s12=this._b*((1+this._A1m1)*o+c)),i&e.LONGITUDE&&(v=this._salp0*u,b=h,g=r.copysign(1,this._salp0),m=((i&e.LONG_UNROLL?g*(o-(Math.atan2(u,h)-Math.atan2(this._ssig1,this._csig1))+(Math.atan2(g*v,b)-Math.atan2(g*this._somg1,this._comg1))):Math.atan2(v*this._comg1-b*this._somg1,b*this._comg1+v*this._somg1))+this._A3c*(o+(e.SinCosSeries(!0,u,h,this._C3a)-this._B31)))/r.degree,M.lon2=i&e.LONG_UNROLL?this.lon1+m:r.AngNormalize(r.AngNormalize(this.lon1)+r.AngNormalize(m))),i&e.LATITUDE&&(M.lat2=r.atan2d(y,this._f1*_)),i&e.AZIMUTH&&(M.azi2=r.atan2d(w,x)),i&(e.REDUCEDLENGTH|e.GEODESICSCALE)&&(E=e.SinCosSeries(!0,u,h,this._C2a),T=(1+this._A2m1)*(E-this._B21),A=(this._A1m1-this._A2m1)*o+(c-T),i&e.REDUCEDLENGTH&&(M.m12=this._b*(S*(this._csig1*u)-this._dn1*(this._ssig1*h)-this._csig1*h*A)),i&e.GEODESICSCALE&&(C=this._k2*(u-this._ssig1)*(u+this._ssig1)/(this._dn1+S),M.M12=s+(C*u-h*A)*this._ssig1/this._dn1,M.M21=s-(C*this._ssig1-this._csig1*A)*u/S)),i&e.AREA&&(I=e.SinCosSeries(!1,u,h,this._C4a),0===this._calp0||0===this._salp0?(k=w*this.calp1-x*this.salp1,P=x*this.calp1+w*this.salp1):(k=this._calp0*this._salp0*(s<=0?this._csig1*(1-s)+a*this._ssig1:a*(this._csig1*a/(1+s)+this._ssig1)),P=r.sq(this._salp0)+r.sq(this._calp0)*this._csig1*h),M.S12=this._c2*Math.atan2(k,P)+this._A4*(I-this._B41)),t||(M.a12=o/r.degree),M):(M.a12=Number.NaN,M)},t.GeodesicLine.prototype.Position=function(e,t){return this.GenPosition(!1,e,t)},t.GeodesicLine.prototype.ArcPosition=function(e,t){return this.GenPosition(!0,e,t)},t.GeodesicLine.prototype.GenSetDistance=function(e,t){e?this.SetArc(t):this.SetDistance(t)},t.GeodesicLine.prototype.SetDistance=function(t){var r;this.s13=t,r=this.GenPosition(!1,this.s13,e.ARC),this.a13=0+r.a12},t.GeodesicLine.prototype.SetArc=function(t){var r;this.a13=t,r=this.GenPosition(!0,this.a13,e.DISTANCE),this.s13=0+r.s12}}(Vt.Geodesic,Vt.GeodesicLine,Vt.Math),function(e,t,r,n){var i,o;i=function(e,t){var n;return e=r.AngNormalize(e),t=r.AngNormalize(t),n=r.AngDiff(e,t).s,e<=0&&t>0&&n>0?1:t<=0&&e>0&&n<0?-1:0},o=function(e,t){return((t%=720)>=0&&t<360||t<-360?0:1)-((e%=720)>=0&&e<360||e<-360?0:1)},e.PolygonArea=function(e,r){this._geod=e,this.a=this._geod.a,this.f=this._geod.f,this._area0=4*Math.PI*e._c2,this.polyline=r||!1,this._mask=t.LATITUDE|t.LONGITUDE|t.DISTANCE|(this.polyline?t.NONE:t.AREA|t.LONG_UNROLL),this.polyline||(this._areasum=new n.Accumulator(0)),this._perimetersum=new n.Accumulator(0),this.Clear()},e.PolygonArea.prototype.Clear=function(){this.num=0,this._crossings=0,this.polyline||this._areasum.Set(0),this._perimetersum.Set(0),this._lat0=this._lon0=this.lat=this.lon=Number.NaN},e.PolygonArea.prototype.AddPoint=function(e,t){var r;0===this.num?(this._lat0=this.lat=e,this._lon0=this.lon=t):(r=this._geod.Inverse(this.lat,this.lon,e,t,this._mask),this._perimetersum.Add(r.s12),this.polyline||(this._areasum.Add(r.S12),this._crossings+=i(this.lon,t)),this.lat=e,this.lon=t),++this.num},e.PolygonArea.prototype.AddEdge=function(e,t){var r;this.num&&(r=this._geod.Direct(this.lat,this.lon,e,t,this._mask),this._perimetersum.Add(t),this.polyline||(this._areasum.Add(r.S12),this._crossings+=o(this.lon,r.lon2)),this.lat=r.lat2,this.lon=r.lon2),++this.num},e.PolygonArea.prototype.Compute=function(e,t){var r,o,a={number:this.num};return this.num<2?(a.perimeter=0,this.polyline||(a.area=0),a):this.polyline?(a.perimeter=this._perimetersum.Sum(),a):(r=this._geod.Inverse(this.lat,this.lon,this._lat0,this._lon0,this._mask),a.perimeter=this._perimetersum.Sum(r.s12),(o=new n.Accumulator(this._areasum)).Add(r.S12),1&this._crossings+i(this.lon,this._lon0)&&o.Add((o.Sum()<0?1:-1)*this._area0/2),e||o.Negate(),t?o.Sum()>this._area0/2?o.Add(-this._area0):o.Sum()<=-this._area0/2&&o.Add(+this._area0):(o.Sum()>=this._area0||o<0)&&o.Add(-this._area0),a.area=o.Sum(),a)},e.PolygonArea.prototype.TestPoint=function(e,t,r,n){var o,a,s,l,c={number:this.num+1};if(0===this.num)return c.perimeter=0,this.polyline||(c.area=0),c;for(c.perimeter=this._perimetersum.Sum(),a=this.polyline?0:this._areasum.Sum(),s=this._crossings,l=0;l<(this.polyline?1:2);++l)o=this._geod.Inverse(0===l?this.lat:e,0===l?this.lon:t,0!==l?this._lat0:e,0!==l?this._lon0:t,this._mask),c.perimeter+=o.s12,this.polyline||(a+=o.S12,s+=i(0===l?this.lon:t,0!==l?this._lon0:t));return this.polyline||(1&s&&(a+=(a<0?1:-1)*this._area0/2),r||(a*=-1),n?a>this._area0/2?a-=this._area0:a<=-this._area0/2&&(a+=this._area0):a>=this._area0?a-=this._area0:a<0&&(a+=this._area0),c.area=a),c},e.PolygonArea.prototype.TestEdge=function(e,t,r,n){var a,s,l,c={number:this.num?this.num+1:0};return 0===this.num||(c.perimeter=this._perimetersum.Sum()+t,this.polyline||(s=this._areasum.Sum(),l=this._crossings,s+=(a=this._geod.Direct(this.lat,this.lon,e,t,this._mask)).S12,l+=o(this.lon,a.lon2),a=this._geod.Inverse(a.lat2,a.lon2,this._lat0,this._lon0,this._mask),c.perimeter+=a.s12,s+=a.S12,1&(l+=i(a.lon2,this._lon0))&&(s+=(s<0?1:-1)*this._area0/2),r||(s*=-1),n?s>this._area0/2?s-=this._area0:s<=-this._area0/2&&(s+=this._area0):s>=this._area0?s-=this._area0:s<0&&(s+=this._area0),c.area=s)),c}}(Vt.PolygonArea,Vt.Geodesic,Vt.Math,Vt.Accumulator),J((function(e){var t=Y(e.params,"rlat_1"),r=Y(e.params,"rlat_2");Ht(e,t,r)}),"aea","Albers Equal Area","Conic Sph&Ell\nlat_1= lat_2="),J((function(e){var t=Y(e.params,"rlat_1"),r=Y(e.params,"bsouth")?-C:C;Ht(e,t,r)}),"leac","Lambert Equal Area Conic","Conic, Sph&Ell\nlat_1= south"),J((function(t){var r,n,s,c,d,p,f,g=1e-10;if(t.phi0=Y(t.params,"rlat_0"),e(e(t.phi0)-C)<g?(d=t.phi0<0?1:0,r=t.phi0<0?-1:1,n=0):e(t.phi0)<g?(d=2,r=0,n=1):(d=3,r=i(t.phi0),n=o(t.phi0)),t.es)if(f=new Vt.Geodesic.Geodesic(t.a,t.es/(1+h(t.one_es))),p=Zt(t.es),Y(t.params,"bguam"))s=Yt(t.phi0,r,n,p),t.inv=function(e,r){var n,l,c;for(n=.5*e.x*e.x,r.phi=t.phi0,c=0;c<3;++c)l=t.e*i(r.phi),r.phi=Xt(s+e.y-n*a(r.phi)*(l=h(1-l*l)),t.es,p);r.lam=e.x*l/o(r.phi)},t.fwd=function(e,r){var n,a,l;n=o(e.phi),a=i(e.phi),l=1/h(1-t.es*a*a),r.x=e.lam*n*l,r.y=Yt(e.phi,a,n,p)-s+.5*e.lam*e.lam*n*a*l};else{switch(d){case 0:c=Yt(C,1,0,p);break;case 1:c=Yt(-C,-1,0,p);break;case 2:case 3:t.inv=_,t.fwd=y,h(1-t.es*r*r),t.e,h(t.one_es)}t.inv=_,t.fwd=y}else t.inv=function(e,a){var s,l,c,h=e.x,p=e.y;if((l=m(h,p))>w)l-g>w&&q(),l=w;else if(l<g)return a.phi=t.phi0,void(a.lam=0);3==d||2==d?(c=i(l),s=o(l),2==d?(a.phi=Kt(p*c/l),h*=c,p=s*l):(a.phi=Kt(s*r+p*c*n/l),p=(s-r*i(a.phi))*l,h*=c*n),a.lam=0==p?0:u(h,p)):0==d?(a.phi=C-l,a.lam=u(h,-p)):(a.phi=l-C,a.lam=u(h,p))},t.fwd=function(t,a){var s,c,u;switch(u=i(t.phi),c=o(t.phi),s=o(t.lam),d){case 2:case 3:a.y=2==d?c*s:r*u+n*c*s,e(e(a.y)-1)<1e-14?a.y<0?F():a.x=a.y=0:(a.y=l(a.y),a.y/=i(a.y),a.x=a.y*c*i(t.lam),a.y*=2==d?u:n*u-r*c*s);break;case 0:t.phi=-t.phi,s=-s;case 1:e(t.phi-C)<g&&F(),a.x=(a.y=C+t.phi)*i(t.lam),a.y*=s}};function y(r,n){var a,s,l,u,h,m,y,_,v,b,w;switch(a=o(r.lam),s=o(r.phi),l=i(r.phi),d){case 0:a=-a;case 1:n.x=(u=e(c-Yt(r.phi,l,s,p)))*i(r.lam),n.y=u*a;break;case 2:case 3:if(e(r.lam)<g&&e(r.phi-t.phi0)<g){n.x=n.y=0;break}_=t.phi0/S,y=t.lam0/S,b=r.phi/S,v=(r.lam+t.lam0)/S,h=(w=f.Inverse(_,y,b,v,f.AZIMUTH)).azi1*S,m=w.s12,n.x=m*i(h)/t.a,n.y=m*o(h)/t.a}}function _(e,r){var n,i,o,a,s,l,y,_;if((n=m(e.x,e.y))<g)return r.phi=t.phi0,r.lam=0,r;3==d||2==d?(a=e.x*t.a,s=e.y*t.a,l=t.phi0/S,y=t.lam0/S,i=u(a,s)/S,o=h(a*a+s*s),_=f.Direct(l,y,i,o,f.STANDARD),r.phi=_.lat2*S,r.lam=_.lon2*S,r.lam-=t.lam0):(r.phi=Xt(0==d?c-n:c+n,t.es,p),r.lam=u(e.x,0==d?-e.y:e.y))}}),"aeqd","Azimuthal Equidistant","Azi, Sph&Ell\nlat_0 guam"),J((function(t){var r,n,s,l,c,u,h=1e-10;t.es=0,t.fwd=function(t,u){var d,p,m,g,y,_,v,b;switch(d=i(t.lam),p=o(t.lam),l){case 2:case 3:g=i(t.phi),b=(m=o(t.phi))*p,3==l&&(b=r*g+n*b),!c&&b<-h&&F(),v=e(_=1-b)>h?-f(y=.5*(1+b))/_-s/y:.5-s,u.x=v*m*d,u.y=3==l?v*(n*g-r*m*p):v*g;break;case 1:case 0:t.phi=e(p_halfpi-t.phi),!c&&t.phi-h>C&&F(),(t.phi*=.5)>h?(y=a(t.phi),v=-2*(f(o(t.phi))/y+y*s),u.x=v*d,u.y=v*p,0==l&&(u.y=-u.y)):u.x=u.y=0}},c=Y(t.params,"bno_cut"),u=.5*(C-Y(t.params,"rlat_b")),e(u)<h?s=-.5:(s=1/a(u),s*=s*f(o(u))),e(e(t.phi0)-C)<h?t.phi0<0?(p_halfpi=-C,l=1):(p_halfpi=C,l=0):e(t.phi0)<h?l=2:(l=3,r=i(t.phi0),n=o(t.phi0))}),"airy","Airy","Misc Sph, no inv.\nno_cut lat_b="),J((function(e){var t=e.opaque={mode:1};Y(e.params,"tlat_1")?0===(t.cosphi1=o(Y(e.params,"rlat_1")))&&j(-22):t.cosphi1=.6366197723675814,tr(e)}),"wintri","Winkel Tripel","Misc Sph\nlat_1"),J(tr,"aitoff","Aitoff","Misc Sph"),J((function(e){e.fwd=function(e,t){var r,n,s,l,c,u,d,p=4/3,f=e.lam;r=a(.5*e.phi),s=1+(n=h(1-r*r))*o(f*=.5),l=i(f)*n/s,u=r/s,t.x=p*l*(3+(c=l*l)-3*(d=u*u)),t.y=p*u*(3+3*c-d)},e.es=0}),"august","August Epicycloidal","Misc Sph, no inv."),J((function(e){rr(e,!1,!1)}),"apian","Apian Globular I","Misc Sph, no inv."),J((function(e){rr(e,!1,!0)}),"ortel","Ortelius Oval","Misc Sph, no inv."),J((function(e){rr(e,!0,!1)}),"bacon","Bacon Globular","Misc Sph, no inv."),J((function(e){var t,r,n,a;e.es=0,e.fwd=function(e,l){var c,d,p,f,m,g;return e.lam+=-16.5*S,d=o(e.phi),p=o(e.lam)*d,f=i(e.lam)*d,g=(m=i(e.phi))*t+p*r,e.lam=u(f*n-g*a,p*t-m*r),g=g*n+f*a,e.phi=s(g),e.lam=Ae(e.lam),e.lam+e.phi<-1.4&&(c=(e.lam-e.phi+1.6)*(e.lam+e.phi+1.4)/8,e.lam+=c,e.phi-=.8*c*i(e.phi+w/2)),d=o(e.phi),c=h(2/(1+d*o(e.lam/2))),l.x=1.68*c*d*i(e.lam/2),l.y=c*i(e.phi),c=(1-o(e.lam*e.phi))/12,l.y<0&&(l.x*=1+c),l.y>0&&(l.y*=1+c/1.5*l.x*l.x),l},e.lam0=0,e.phi0=-42*S,t=o(e.phi0),r=i(e.phi0),n=1,a=0}),"bertin1953","Bertin 1953","Misc., Sph., NoInv."),J((function(t){var r=h(2);t.fwd=function(t,n){var a,s,l,c;if(a=t.phi,e(e(t.phi)-C)<1e-7)n.x=0;else{for(l=i(a)*w,c=20;c&&(a-=s=(a+i(a)-l)/(1+o(a)),!(e(s)<1e-7));--c);a*=.5,n.x=2.00276*t.lam/(1/o(t.phi)+1.11072/o(a))}n.y=.49931*(t.phi+r*i(a))},t.es=0}),"boggs","Boggs Eumorphic","PCyl., no inv., Sph."),J((function(t){var r,n,s,l,c,d,p=1e-10;r=Y(t.params,"rlat_1"),e(r)<p&&j(-23),t.es?(c=Zt(t.es),l=Yt(r,s=i(r),d=o(r),c),s=d/(h(1-t.es*s*s)*s),t.inv=function(r,n){var a,d;d=m(r.x,r.y=s-r.y),n.phi=Xt(s+l-d,t.es,c),(a=e(n.phi))<C?(a=i(n.phi),n.lam=d*u(r.x,r.y)*h(1-t.es*a*a)/o(n.phi)):e(a-C)<=p?n.lam=0:q()},t.fwd=function(e,r){var n,a,u;n=s+l-Yt(e.phi,a=i(e.phi),u=o(e.phi),c),a=u*e.lam/(n*h(1-t.es*a*a)),r.x=n*i(a),r.y=s-n*o(a)}):(n=e(r)+p>=C?0:1/a(r),t.inv=function(t,i){var a=m(t.x,t.y=n-t.y);i.phi=n+r-a,e(i.phi)>C&&q(),e(e(i.phi)-C)<=p?i.lam=0:i.lam=a*u(t.x,t.y)/o(i.phi)},t.fwd=function(t,a){var s,l;l=n+r-t.phi,e(l)>p?(a.x=l*i(s=t.lam*o(t.phi)/l),a.y=n-l*o(s)):a.x=a.y=0})}),"bonne","Bonne (Werner lat_1=90)","Conic Sph&Ell\nlat_1="),J((function(e){var t,r,n=.16666666666666666,l=.008333333333333333,c=.041666666666666664,d=.06666666666666667;e.es?(r=Zt(e.es),t=Yt(e.phi0,i(e.phi0),o(e.phi0),r),e.fwd=function(s,u){var d,p,f,m,g,y;u.y=Yt(s.phi,d=i(s.phi),m=o(s.phi),r),d=1/h(1-e.es*d*d),y=a(s.phi),p=y*y,f=s.lam*m,m*=e.es*m/(1-e.es),g=f*f,u.x=d*f*(1-g*p*(n-(8-p+8*m)*g*l)),u.y-=t-d*y*g*(.5+(5-p+6*m)*g*c)},e.inv=function(n,s){var l,u,p,f,m,g,y;y=Xt(t+n.y,e.es,r),g=a(y),u=g*g,l=i(y),p=1/(1-e.es*l*l),l=h(p),p*=(1-e.es)*l,f=n.x/l,m=f*f,s.phi=y-l*g/p*m*(.5-(1+3*u)*m*c),s.lam=f*(1+u*m*((1+3*u)*m*d-.3333333333333333))/o(y)}):(e.fwd=function(t,r){r.x=s(o(t.phi)*i(t.lam)),r.y=u(a(t.phi),o(t.lam))-e.phi0},e.inv=function(t,r){var n=t.y+e.phi0;r.phi=s(i(n)*o(t.x)),r.lam=u(a(t.x),o(n))})}),"cass","Cassini","Cyl, Sph&Ell"),J((function(t){var r,n,a=0;Y(t.params,"tlat_ts")&&(t.k0=o(a=Y(t.params,"rlat_ts")),t.k0<0&&j(-24)),t.es?(a=i(a),t.k0/=h(1-t.es*a*a),t.e=h(t.es),(n=nr(t.es))||e_error_0(),r=Gt(1,t.e,t.one_es),t.fwd=function(e,r){r.x=t.k0*e.lam,r.y=.5*Gt(i(e.phi),t.e,t.one_es)/t.k0},t.inv=function(e,i){i.phi=ir(s(2*e.y*t.k0/r),n),i.lam=e.x/t.k0}):(t.fwd=function(e,r){r.x=t.k0*e.lam,r.y=i(e.phi)/t.k0},t.inv=function(r,n){var i,o=r.x,a=r.y;(i=e(a*=t.k0))-D<=1?(n.phi=i>=1?a<0?-C:C:s(a),n.lam=o/t.k0):q()})}),"cea","Equal Area Cylindrical","Cyl, Sph&Ell\nlat_ts="),J((function(t){var r,n,a,s,l,c,d,p=1/3,f=[];for(c=0;c<3;++c)f[c]={p:{}},f[c].phi=Y(t.params,"rlat_"+(c+1)),f[c].lam=Y(t.params,"rlon_"+(c+1)),f[c].lam=Ae(f[c].lam-t.lam0),f[c].cosphi=o(f[c].phi),f[c].sinphi=i(f[c].phi);for(c=0;c<3;++c)d=2==c?0:c+1,f[c].v=m(f[d].phi-f[c].phi,f[c].cosphi,f[c].sinphi,f[d].cosphi,f[d].sinphi,f[d].lam-f[c].lam),f[c].v.r||j(-25);function m(t,r,n,a,s,l){var c,d,p,f={};return c=o(l),e(t)>1||e(l)>1?f.r=Qt(cs1*s+r*a*c):(d=i(.5*t),p=i(.5*l),f.r=2*Kt(h(d*d+r*a*p*p))),e(f.r)>1e-9?f.Az=u(a*i(l),r*s-n*a*c):f.r=f.Az=0,f}function g(e,t,r){return Qt(.5*(e*e+t*t-r*r)/(e*t))}a=g(f[0].v.r,f[2].v.r,f[1].v.r),s=g(f[0].v.r,f[1].v.r,f[2].v.r),l=w-a,n=2*(f[0].p.y=f[1].p.y=f[2].v.r*i(a)),f[2].p.y=0,f[0].p.x=-(f[1].p.x=.5*f[0].v.r),r=f[2].p.x=f[0].p.x+f[2].v.r*o(a),t.es=0,t.fwd=function(e,t){var a,c,u,h,d,y,_,v=[];for(a=i(e.phi),c=o(e.phi),h=0;h<3&&(v[h]=m(e.phi-f[h].phi,f[h].cosphi,f[h].sinphi,c,a,e.lam-f[h].lam),v[h].r);++h)v[h].Az=Ae(v[h].Az-f[h].v.Az);if(h<3)y=f[h].p.x,_=f[h].p.y;else{for(y=r,_=n,h=0;h<3;++h)d=2==h?0:h+1,u=g(f[h].v.r,v[h].r,v[d].r),v[h].Az<0&&(u=-u),h?1==h?(u=s-u,y-=v[h].r*o(u),_-=v[h].r*i(u)):(u=l-u,y+=v[h].r*o(u),_+=v[h].r*i(u)):(y+=v[h].r*o(u),_-=v[h].r*i(u));y*=p,_*=p}t.x=y,t.y=_}}),"chamb","Chamberlin Trimetric","Misc Sph, no inv.\nlat_1= lon_1= lat_2= lon_2= lat_3= lon_3="),J((function(e){var t=1/3;e.inv=function(e,r){r.phi=3*s(.32573500793527993*e.y),r.lam=1.0233267079464885*e.x/(2*o((r.phi+r.phi)*t)-1)},e.fwd=function(e,r){e.phi*=t,r.x=.9772050238058398*e.lam*(2*o(e.phi+e.phi)-1),r.y=3.0699801238394655*i(e.phi)},e.es=0}),"crast","Craster Parabolic (Putnins P4)","PCyl., Sph."),J((function(e){var t=.5253,r=.7264,n=1/Math.sqrt(t*r),a=.9701,l=p(22*S),c=f(0),u=i(l),d=o(l);function p(e){return s(r*i(e)+.4188*h(t*r))}function f(e){return t*e}Y(e.params,"tlon_0")||(e.lam0=11.023*S),e.es=0,e.fwd=function(e,t){var r=p(e.phi),s=f(e.lam),m=i(r),g=o(r),y=i(s-c),_=o(s-c),v=h(2/(1+i(l)*m+d*g*_));t.x=n*v*g*y*a,t.y=n*v*(d*m-u*g*_)/a}}),"cupola","Cupola","PCyl., Sph., NoInv."),J((function(t){t.fwd=function(t,r){var n=e(t.lam);r.y=t.phi,r.x=t.lam,r.x*=o((.95+n*(n*n*.0016666666666666666-.08333333333333333))*(t.phi*(.9+.03*t.phi*t.phi*t.phi*t.phi)))},t.es=0}),"denoy","Denoyer Semi-Elliptical","PCyl, Sph., no inv."),J((function(t){var r=.9213177319235613,n=.3183098861837907;t.es=0,t.fwd=function(t,i){i.x=r*t.lam*(1-n*e(t.phi)),i.y=r*t.phi},t.inv=function(t,i){i.phi=t.y/r,i.lam=t.x/(r*(1-n*e(i.phi)))}}),"eck1","Eckert I","PCyl Sph"),J((function(t){var r=.46065886596178063,n=1.4472025091165353;t.es=0,t.fwd=function(t,o){o.x=r*t.lam*(o.y=h(4-3*i(e(t.phi)))),o.y=n*(2-o.y),t.phi<0&&(o.y=-o.y)},t.inv=function(t,i){i.lam=t.x/(r*(i.phi=2-e(t.y)/n)),i.phi=.3333333333333333*(4-i.phi*i.phi),e(i.phi)>=1?e(i.phi)>1.0000001?q():i.phi=i.phi<0?-C:C:i.phi=s(i.phi),t.y<0&&(i.phi=-i.phi)}}),"eck2","Eckert II","PCyl Sph"),J((function(e){or(e,{C_x:.4222382003157712,C_y:.8444764006315424,A:1,B:.4052847345693511})}),"eck3","Eckert III","PCyl Sph"),J((function(e){or(e,{C_x:.94745,C_y:.94745,A:0,B:.3039635509270133})}),"wag6","Wagner VI","PCyl Sph"),J((function(e){or(e,{C_x:.8660254037844,C_y:1,A:0,B:.3039635509270133})}),"kav7","Kavraisky VII","PCyl Sph"),J((function(e){or(e,{C_x:1.8949,C_y:.94745,A:-.5,B:.3039635509270133})}),"putp1","Putnins P1","PCyl Sph"),J((function(t){var r=.4222382003157712,n=1.3265004281770023,a=3.5707963267948966;t.es=0,t.fwd=function(t,s){var l,c,u,h,d;for(l=a*i(t.phi),c=t.phi*t.phi,t.phi*=.895168+c*(.0218849+.00826809*c),d=6;d&&(h=o(t.phi),u=i(t.phi),t.phi-=c=(t.phi+u*(h+2)-l)/(1+h*(h+2)-u*u),!(e(c)<1e-7));--d);d?(s.x=r*t.lam*(1+o(t.phi)),s.y=n*i(t.phi)):(s.x=r*t.lam,s.y=t.phi<0?-n:n)},t.inv=function(e,t){var s;t.phi=Kt(e.y/n),t.lam=e.x/(r*(1+(s=o(t.phi)))),t.phi=Kt((t.phi+i(t.phi)*(s+2))/a)}}),"eck4","Eckert IV","PCyl Sph"),J((function(e){e.es=0,e.fwd=function(e,t){t.x=.4410127717245515*(1+o(e.phi))*e.lam,t.y=.882025543449103*e.phi},e.inv=function(e,t){t.lam=2.267508027238226*e.x/(1+o(t.phi=1.133754013619113*e.y))}}),"eck5","Eckert V","PCyl Sph"),J((function(e){var t=o(Y(e.params,"rlat_ts"));t<=0&&j(-24),e.es=0,e.fwd=function(r,n){n.x=t*r.lam,n.y=r.phi-e.phi0},e.inv=function(r,n){n.lam=r.x/t,n.phi=r.y+e.phi0}}),"eqc","Equidistant Cylindrical (Plate Caree)","Cyl, Sph\nlat_ts=[, lat_0=0]"),J((function(t){var r,n,a,s,l,c,h,d,p,f,g,y,_;r=Y(t.params,"rlat_1"),n=Y(t.params,"rlat_2"),e(r+n)<D&&j(-21),(h=Zt(t.es))||e_error_0(),a=f=i(r),p=o(r),g=e(r-n)>=D,(d=t.es>0)?(_=Wt(f,p,t.es),y=Yt(r,f,p,h),g&&(f=i(n),p=o(n),a=(_-Wt(f,p,t.es))/(Yt(n,f,p,h)-y)),l=(c=y+_/a)-Yt(t.phi0,i(t.phi0),o(t.phi0),h)):(g&&(a=(p-o(n))/(n-r)),c=r+o(r)/a,l=c-t.phi0),t.fwd=function(e,t){s=c-(d?Yt(e.phi,i(e.phi),o(e.phi),h):e.phi),t.x=s*i(e.lam*=a),t.y=l-s*o(e.lam)},t.inv=function(e,r){0!=(s=m(e.x,e.y=l-e.y))?(a<0&&(s=-s,e.x=-e.x,e.y=-e.y),r.phi=c-s,d&&(r.phi=Xt(r.phi,t.es,h)),r.lam=u(e.x,e.y)/a):(r.lam=0,r.phi=a>0?C:-C)}}),"eqdc","Equidistant Conic","Conic, Sph&Ell\nlat_1= lat_2="),J((function(e){var t=1.340264,r=-.081106,n=893e-6,i=.003796,o=Math.sqrt(3)/2;e.es=0,e.fwd=function(e,a){var s=Math.asin(o*Math.sin(e.phi)),l=s*s,c=l*l*l;a.x=e.lam*Math.cos(s)/(o*(t+3*r*l+c*(7*n+9*i*l))),a.y=s*(t+r*l+c*(n+i*l))},e.inv=function(e,a){var s,l,c,u,h=e.y;for(u=0;u<12&&(h-=c=(h*(t+r*(s=h*h)+(l=s*s*s)*(n+i*s))-e.y)/(t+3*r*s+l*(7*n+9*i*s)),!(Math.abs(c)<1e-9));++u);l=(s=h*h)*s*s,a.lam=o*e.x*(t+3*r*s+l*(7*n+9*i*s))/Math.cos(h),a.phi=Math.asin(Math.sin(h)/o)}}),"eqearth","Equal Earth","PCyl., Sph."),J(ar,"etmerc","Extended Transverse Mercator","Cyl, Sph\nlat_ts=(0)\nlat_0=(0)"),J((function(e){e.fwd=function(e,t){t.x=.7071067811865476*e.lam,t.y=1.7071067811865475*a(.5*e.phi)},e.inv=function(e,t){t.lam=1.4142135623730951*e.x,t.phi=2*c(.585786437626905*e.y)},e.es=0}),"gall","Gall (Gall Stereographic)","Cyl, Sph"),J((function(e){e.is_geocent=!0,e.x0=0,e.y0=0,e.fwd=function(e,t){t.x=e.lam,t.y=e.phi},e.inv=function(e,t){t.phi=e.y,t.lam=e.x}}),"geocent","Geocentric",""),J((function(e){var t,r,n,s,l,d,p,f=Y(e.params,"dh"),g=Y(e.params,"ssweep");g?"x"==g?p=1:"y"==g?p=0:j(-49):p=0,((l=f/e.a)<=0||l>1e10)&&j(-50),d=(s=1+l)*s-1,0!=e.es?(t=h(e.one_es),r=e.one_es,n=e.rone_es,e.inv=function(e,r){var i,f,g,y,_,v;i=-1,p?(g=a(e.y/l),f=a(e.x/l)*m(1,g)):(f=a(e.x/l),g=a(e.y/l)*m(1,f));var b=(_=2*s*i)*_-4*(y=f*f+(y=g/t)*y+i*i)*d;b<0&&j(-51),v=(-_-h(b))/(2*y),i=s+v*i,f*=v,g*=v,r.lam=u(f,i),r.phi=c(g*o(r.lam)/i),r.phi=c(n*a(r.phi))},e.fwd=function(e,u){var h,d,f,g,y;e.phi=c(r*a(e.phi)),h=t/m(t*o(e.phi),i(e.phi)),d=h*o(e.lam)*o(e.phi),f=h*i(e.lam)*o(e.phi),g=h*i(e.phi),(s-d)*d-f*f-g*g*n<0&&j(-51),y=s-d,p?(u.x=l*c(f/m(g,y)),u.y=l*c(g/y)):(u.x=l*c(f/y),u.y=l*c(g/m(f,y)))}):(t=r=n=1,e.inv=function(e,t){var r,n,i,f,m,g;r=-1,p?(i=a(e.y/l),n=a(e.x/l)*h(1+i*i)):(n=a(e.x/l),i=a(e.y/l)*h(1+n*n));var y=(m=2*s*r)*m-4*(f=n*n+i*i+r*r)*d;y<0&&j(-51),g=(-m-h(y))/(2*f),r=s+g*r,n*=g,i*=g,t.lam=u(n,r),t.phi=c(i*o(t.lam)/r)},e.fwd=function(e,t){var r=o(e.phi),n=o(e.lam)*r,a=i(e.lam)*r,u=i(e.phi);r=s-n,p?(t.x=l*c(a/m(u,r)),t.y=l*c(u/r)):(t.x=l*c(a/r),t.y=l*c(u/m(a,r)))})}),"geos","Geostationary Satellite View","Azi, Sph&Ell"),J((function(e){var t=s(Y(e.params,"tlat_1")?Y(e.params,"rlat_1"):0),r=i(t),n=o(t);function s(e){return Kt(a(.5*e))}e.fwd=function(e,t){var a=.5*e.lam,l=s(e.phi),c=i(l),u=o(l),h=o(a);r*c+n*u*h>=0?(t.x=u*i(a),t.y=n*c-r*u*h):F()},e.es=0}),"gilbert","Gilbert Two World Perspective","PCyl., Sph., NoInv.\nlat_1="),J((function(e){e.fwd=function(e,t){var r=e.phi*e.phi;t.y=e.phi*(1+.08333333333333333*r),t.x=e.lam*(1-.162388*r),r=e.lam*e.lam,t.x*=.87-952426e-9*r*r},e.es=0}),"gins8","Ginsburg VIII (TsNIIGAiK)","PCyl, Sph., no inv."),J((function(e){Y(e.params,"tn"),Y(e.params,"tm")?lr(e,Y(e.params,"dm"),Y(e.params,"dn")):j(-99)}),"gn_sinu","General Sinusoidal Series","PCyl, Sph.\nm= n="),J(sr,"sinu","Sinusoidal (Sanson-Flamsteed)","PCyl, Sph&Ell"),J((function(e){lr(e,1,2.5707963267948966)}),"eck6","Eckert VI","PCyl, Sph.\nm= n="),J((function(e){lr(e,.5,1.7853981633974483)}),"mbtfps","McBryde-Thomas Flat-Polar Sinusoidal","PCyl, Sph."),J((function(t){var r,n,a=1e-10;e(e(t.phi0)-C)<a?n=t.phi0<0?1:0:e(t.phi0)<a?n=2:(n=3,sinph0=i(t.phi0),r=o(t.phi0)),t.inv=function(o,l){var d,p,f,g=o.x,y=o.y;if(d=m(g,y),f=i(l.phi=c(d)),p=h(1-f*f),e(d)<=a)l.phi=t.phi0,l.lam=0;else{switch(n){case 3:l.phi=p*sinph0+y*f*r/d,e(l.phi)>=1?l.phi=l.phi>0?C:-C:l.phi=s(l.phi),y=(p-sinph0*i(l.phi))*d,g*=f*r;break;case 2:l.phi=y*f/d,e(l.phi)>=1?l.phi=l.phi>0?C:-C:l.phi=s(l.phi),y=p*d,g*=f;break;case 1:l.phi-=C;break;case 0:l.phi=C-l.phi,y=-y}l.lam=u(g,y)}},t.fwd=function(e,t){var s,l,c;switch(c=i(e.phi),l=o(e.phi),s=o(e.lam),n){case 2:t.y=l*s;break;case 3:t.y=sinph0*c+r*l*s;break;case 1:t.y=-c;break;case 0:t.y=c}switch(t.y<=a&&F(),t.x=(t.y=1/t.y)*l*i(e.lam),n){case 2:t.y*=c;break;case 3:t.y*=r*c-sinph0*l*s;break;case 0:s=-s;case 1:t.y*=l*s}},t.es=0}),"gnom","Gnomonic","Azi, Sph."),J(cr,"moll","Mollweide","PCyl Sph"),J((function(e){hr(e,ur(0,w/3))}),"wag4","Wagner IV","PCyl Sph"),J((function(e){hr(e,{C_x:.90977,C_y:1.65014,C_p:3.00896})}),"wag5","Wagner V","PCyl Sph"),J((function(t){var r,n,i,o,a=.0528,s=.7109307819790236;t.es=0,sr(t),r=t.fwd,n=t.inv,cr(t),i=t.fwd,o=t.inv,t.fwd=function(t,n){e(t.phi)<s?r(t,n):(i(t,n),n.y-=t.phi>0?a:-a)},t.inv=function(t,r){e(t.y)<=s?n(t,r):(t.y+=t.y>0?a:-a,o(t,r))}}),"goode","Goode Homolosine","PCyl, Sph."),J((function(t){var r,n,a;t.inv=function(t,n){var i=h(1-.25*r*r*t.x*t.x-.25*t.y*t.y);e(2*i*i-1)<1e-10?(n.lam=b,n.phi=b,pj_errno=-14):(n.lam=er(r*t.x*i,2*i*i-1)/r,n.phi=Kt(i*t.y))},t.fwd=function(e,t){var s,l;l=h(2/(1+(s=o(e.phi))*o(e.lam*=r))),t.x=n*l*s*i(e.lam),t.y=a*l*i(e.phi)},t.es=0,Y(t.params,"tW")?(r=e(Y(t.params,"dW")))<=0&&j(-27):r=.5,Y(t.params,"tM")?(n=e(Y(t.params,"dM")))<=0&&j(-27):n=1,a=1/n,n/=r}),"hammer","Hammer & Eckert-Greifendorff","Misc Sph,\nW= M="),J((function(t){var r=1.000001;t.inv=function(t,n){var a=t.y*(t.y<0?.5179951515653813:.5686373742600607);e(a)>1?e(a)>r?q():a=a>0?C:-C:a=s(a),n.lam=1.1764705882352942*t.x/o(a),a+=a,n.phi=(a+i(a))*(t.y<0?.4102345310814193:.3736990601468637),e(n.phi)>1?e(n.phi)>r?q():n.phi=n.phi>0?C:-C:n.phi=s(n.phi)},t.fwd=function(t,r){var n,a,s;for(a=i(t.phi)*(t.phi<0?2.43763:2.67595),s=20;s&&(t.phi-=n=(t.phi+i(t.phi)-a)/(1+o(t.phi)),!(e(n)<1e-7));--s);r.x=.85*t.lam*o(t.phi*=.5),r.y=i(t.phi)*(t.phi<0?1.93052:1.75859)},t.es=0}),"hatano","Hatano Asymmetrical Equal Area","PCyl., Sph."),J(dr,"healpix","HEALPix","Sph., Ellps."),J((function(e){dr(e,!0)}),"rhealpix","rHEALPix","Sph., Ellps.\nnorth_square= south_square="),J((function(t){var r,n=i(.5),a=s(n),c=2*h(w/(r=w+4*a*2)),d=.5*c*(2+h(3));t.es=0,t.fwd=function(t,n){var s,l,p=1-i(t.phi);if(p&&p<2){var f,m,g,y,_,v=C-t.phi,b=25;do{m=i(v),g=o(v),_=a+u(m,2-g),v-=f=(v-1*a-2*m+(y=5-4*g)*_-.5*p*r)/(4*m*_)}while(e(f)>1e-12&&--b>0);s=c*h(y),l=t.lam*_/w}else s=c*(1+p),l=t.lam*a/w;n.x=s*i(l),n.y=d-s*o(l)},t.inv=function(e,t){var n=e.x,o=e.y,p=n*n+(o-=d)*o,f=(5-p/(c*c))/4,m=l(f),g=i(m),y=a+u(g,2-f);t.lam=s(n/h(p))*w/y,t.phi=s(1-2*(m-1*a-2*g+(5-4*f)*y)/r)}}),"hill","Hill Eucyclic","PCyl., Sph."),J((function(t){var r,n,l,p,f,m,g,y,_,v=.785398163397448,b=1.37008346281555;t.a=6377397.155,t.e=h(t.es=.006674372230614),Y(t.params,"tlat_0")||(t.phi0=.863937979737193),Y(t.params,"tlon_0")||(t.lam0=.4334234309119251),Y(t.params,"tk")||(t.k0=.9999),_=1,Y(t.params,"tczech")||(_=-1),p=h(1+t.es*d(o(t.phi0),4)/(1-t.es)),r=s(i(t.phi0)/p),l=d((1+t.e*i(t.phi0))/(1-t.e*i(t.phi0)),p*t.e/2),f=a(r/2+v)/d(a(t.phi0/2+v),p)*l,n=h(1-t.es)/(1-t.es*d(i(t.phi0),2)),m=i(b),g=t.k0*n/a(b),y=.5286277629901559,t.inv=function(r,n){var l,w,x,S,E,T,A,C;A=r.x,r.x=r.y,r.y=A,r.x*=_,r.y*=_,E=h(r.x*r.x+r.y*r.y),S=u(r.y,r.x)/i(b),x=2*(c(d(g/E,1/m)*a(b/2+v))-v),l=s(o(y)*i(x)-i(y)*o(x)*o(S)),w=s(o(x)*i(S)/o(l)),n.lam=t.lam0-w/p,T=l,C=0;do{n.phi=2*(c(d(f,-1/p)*d(a(l/2+v),1/p)*d((1+t.e*i(T))/(1-t.e*i(T)),t.e/2))-v),e(T-n.phi)<1e-15&&(C=1),T=n.phi}while(0===C);n.lam-=t.lam0},t.fwd=function(e,r){var n,l,u,h,w,x,S;n=d((1+t.e*i(e.phi))/(1-t.e*i(e.phi)),p*t.e/2),l=2*(c(f*d(a(e.phi/2+v),p)/n)-v),u=-e.lam*p,h=s(o(y)*i(l)+i(y)*o(l)*o(u)),w=s(o(l)*i(u)/o(h)),x=m*w,S=g*d(a(b/2+v),m)/d(a(h/2+v),m),r.y=S*o(x),r.x=S*i(x),r.y*=_,r.x*=_}}),"krovak","Krovak","PCyl., Ellps."),J((function(t){var r,n,a,l,c,d,p,f,g,y,_,v=1e-10;if(y=e(t.phi0),g=e(y-C)<v?t.phi0<0?1:0:e(y)<v?2:3,t.es){switch(t.e=h(t.es),c=Gt(1,t.e,t.one_es),t.es,f=nr(t.es),g){case 0:case 1:d=1;break;case 2:d=1/(p=h(.5*c)),a=1,l=.5*c;break;case 3:p=h(.5*c),_=i(t.phi0),r=Gt(_,t.e,t.one_es)/c,n=h(1-r*r),d=o(t.phi0)/(h(1-t.es*_*_)*p*n),l=(a=p)/d,a*=d}t.inv=function(e,a){var l,h,y,_,b=0;switch(g){case 2:case 3:if(e.x/=d,e.y*=d,(_=m(e.x,e.y))<v)return a.lam=0,a.phi=t.phi0,a;h=2*s(.5*_/p),l=o(h),h=i(h),e.x*=h,3==g?(b=l*r+e.y*h*n/_,e.y=_*n*l-e.y*r*h):(b=e.y*h/_,e.y=_*l);break;case 0:e.y=-e.y;case 1:if(!(y=e.x*e.x+e.y*e.y))return a.lam=0,a.phi=t.phi0,a;b=1-y/c,1==g&&(b=-b)}return a.lam=u(e.x,e.y),a.phi=ir(s(b),f),a},t.fwd=function(s,u){var d,p,f,m,y=0,_=0,b=0;switch(d=o(s.lam),p=i(s.lam),f=i(s.phi),m=Gt(f,t.e,t.one_es),(3==g||2==g)&&(_=h(1-(y=m/c)*y)),g){case 3:b=1+r*y+n*_*d;break;case 2:b=1+_*d;break;case 0:b=C+s.phi,m=c-m;break;case 1:b=s.phi-C,m=c+m}switch(e(b)<v&&F(),g){case 3:case 2:3==g?(b=h(2/b),u.y=l*b*(n*y-r*_*d)):(b=h(2/(1+_*d)),u.y=b*y*l),u.x=a*b*_*p;break;case 0:case 1:m>=0?(b=h(m),u.x=b*p,u.y=d*(1==g?b:-b)):u.x=u.y=0}}}else 3==g&&(r=i(t.phi0),n=o(t.phi0)),t.inv=function(a,l){var c,h=0,d=0;switch(c=m(a.x,a.y),(l.phi=.5*c)>1&&q(),l.phi=2*s(l.phi),(3==g||2==g)&&(d=i(l.phi),h=o(l.phi)),g){case 2:l.phi=e(c)<=v?0:s(a.y*d/c),a.x*=d,a.y=h*c;break;case 3:l.phi=e(c)<=v?t.phi0:s(h*r+a.y*d*n/c),a.x*=d*n,a.y=(h-i(l.phi)*r)*c;break;case 0:a.y=-a.y,l.phi=C-l.phi;break;case 1:l.phi-=C}l.lam=0!=a.y||2!=g&&3!=g?u(a.x,a.y):0},t.fwd=function(a,s){var l,c,u;switch(u=i(a.phi),c=o(a.phi),l=o(a.lam),g){case 2:case 3:s.y=2==g?1+c*l:1+r*u+n*c*l,s.y<=v&&F(),s.y=h(2/s.y),s.x=s.y*c*i(a.lam),s.y*=2==g?u:n*u-r*c*l;break;case 0:l=-l;case 1:e(a.phi+t.phi0)<v&&F(),s.y=A-.5*a.phi,s.y=2*(1==g?o(s.y):i(s.y)),s.x=s.y*i(a.lam),s.y*=l}}}),"laea","Lambert Azimuthal Equal Area","Azi, Sph&Ell"),J(pr,"lonlat","Lat/long (Geodetic)",""),J(pr,"longlat","Lat/long (Geodetic alias)",""),J(pr,"latlon","Lat/long (Geodetic alias)",""),J(pr,"latlong","Lat/long (Geodetic alias)",""),J((function(t){var r,n,s,l,p,g,y,_,v,w,x,S=1e-10;t.inv=function(e,r){var n,i=e.x,o=e.y;i/=t.k0,o/=t.k0,0!=(n=m(i,o=y-o))?(g<0&&(n=-n,i=-i,o=-o),v?(r.phi=mr(d(n/_,1/g),t.e),r.phi==b&&q()):r.phi=2*c(d(_/n,1/g))-C,r.lam=u(i,o)/g):(r.lam=0,r.phi=g>0?C:-C)},t.fwd=function(r,n){var s,l=r.lam;e(e(r.phi)-C)<S?(r.phi*g<=0&&F(),s=0):s=_*(v?d(fr(r.phi,i(r.phi),t.e),g):d(a(A+.5*r.phi),-g)),l*=g,n.x=t.k0*(s*i(l)),n.y=t.k0*(y-s*o(l))},l=Y(t.params,"rlat_1"),Y(t.params,"tlat_2")?p=Y(t.params,"rlat_2"):(p=l,Y(t.params,"tlat_0")||(t.phi0=l)),e(l+p)<S&&j(-21),g=n=i(l),r=o(l),s=e(l-p)>=S,(v=0!=t.es)?(t.e=h(t.es),x=Wt(n,r,t.es),w=fr(l,n,t.e),s&&(n=i(p),g=f(x/Wt(n,o(p),t.es)),g/=f(w/fr(p,n,t.e))),_=y=x*d(w,-g)/g,y*=e(e(t.phi0)-C)<S?0:d(fr(t.phi0,i(t.phi0),t.e),g)):(s&&(g=f(r/o(p))/f(a(A+.5*p)/a(A+.5*l))),_=r*d(a(A+.5*l),g)/g,y=e(e(t.phi0)-C)<S?0:_*d(a(A+.5*t.phi0),-g))}),"lcc","Lambert Conformal Conic","Conic, Sph&Ell\nlat_1= and lat_2= or lat_0="),J((function(t){var r,n,i,s=1e-8;r=Y(t.params,"rlat_1"),n=o(r),i=a(A+.5*r),n<s&&j(-22),t.fwd=function(t,o){o.y=t.phi-r,e(o.y)<s?o.x=t.lam*n:(o.x=A+.5*t.phi,e(o.x)<s||e(e(o.x)-C)<s?o.x=0:o.x=t.lam*o.y/f(a(o.x)/i))},t.inv=function(t,o){o.phi=t.y+r,e(t.y)<s?o.lam=t.x/n:(o.lam=A+.5*o.phi,e(o.lam)<s||e(e(o.lam)-C)<s?o.lam=0:o.lam=t.x*f(a(o.lam)/i)/t.y)},t.es=0}),"loxim","Loximuthal","PCyl Sph"),J((function(t){var r=.9525793444156804,n=.9258200997725514,a=3.401680257083045,l=2/3,c=1/3,u=1.0000001;t.fwd=function(e,t){e.phi=s(r*i(e.phi)),t.x=n*e.lam*(2*o(l*e.phi)-1),t.y=a*i(c*e.phi)},t.inv=function(t,c){c.phi=t.y/a,e(c.phi)>=1?e(c.phi)>u?q():c.phi=c.phi<0?-C:C:c.phi=s(c.phi),c.lam=t.x/(n*(2*o(l*(c.phi*=3))-1)),e(c.phi=i(c.phi)/r)>=1?e(c.phi)>u?q():c.phi=c.phi<0?-C:C:c.phi=s(c.phi)},t.es=0}),"mbt_fpp","McBride-Thomas Flat-Polar Parabolic","Cyl., Sph."),J((function(t){var r=1.000001;t.fwd=function(t,r){var n,a,s;for(a=1.7071067811865475*i(t.phi),s=20;s&&(t.phi-=n=(i(.5*t.phi)+i(t.phi)-a)/(.5*o(.5*t.phi)+o(t.phi)),!(e(n)<1e-7));--s);r.x=.3124597141037825*t.lam*(1+2*o(t.phi)/o(.5*t.phi)),r.y=1.874758284622695*i(.5*t.phi)},t.inv=function(t,n){var a;n.phi=.533402096794177*t.y,e(n.phi)>1?e(n.phi)>r?q():n.phi<0?(a=-1,n.phi=-w):(a=1,n.phi=w):n.phi=2*s(a=n.phi),n.lam=3.2004125807650623*t.x/(1+2*o(n.phi)/o(.5*n.phi)),n.phi=.585786437626905*(a+i(n.phi)),e(n.phi)>1?e(n.phi)>r?q():n.phi=n.phi<0?-C:C:n.phi=s(n.phi)},t.es=0}),"mbt_fpq","McBryde-Thomas Flat-Polar Quartic","Cyl., Sph."),J((function(t){var r=.45503,n=1.36509,a=1.41546,s=.22248,l=1.44492,c=1/3;t.fwd=function(t,u){var h,d,p,f;for(h=a*i(t.phi),f=10;f&&(p=t.phi/n,t.phi-=d=(r*i(p)+i(t.phi)-h)/(c*o(p)+o(t.phi)),!(e(d)<1e-7));--f);p=t.phi/n,u.x=s*t.lam*(1+3*o(t.phi)/o(p)),u.y=l*i(p)},t.inv=function(e,t){var c;t.phi=n*(c=Kt(e.y/l)),t.lam=e.x/(s*(1+3*o(t.phi)/o(c))),t.phi=Kt((r*i(c)+i(t.phi))/a)},t.es=0}),"mbt_fps","McBryde-Thomas Flat-Pole Sine (No. 2)","Cyl., Sph."),J((function(t){var r=1e-10,n=0,s=Y(t.params,"tlat_ts");s&&(n=Y(t.params,"rlat_ts"))>=C&&j(-24),t.es?(s&&(t.k0=Wt(i(n),o(n),t.es)),t.inv=function(e,r){r.phi=mr(p(-e.y/t.k0),t.e),r.phi===b&&q(),r.lam=e.x/t.k0},t.fwd=function(n,o){e(e(n.phi)-C)<=r&&F(),o.x=t.k0*n.lam,o.y=-t.k0*f(fr(n.phi,i(n.phi),t.e))}):(t.inv=function(e,r){r.phi=C-2*c(p(-e.y/t.k0)),r.lam=e.x/t.k0},t.fwd=function(n,i){e(e(n.phi)-C)<=r&&F(),i.x=t.k0*n.lam,i.y=t.k0*f(a(A+.5*n.phi))})}),"merc","Mercator","Cyl, Sph&Ell\nlat_ts="),J((function(t){t.k0=1,t.inv=function(e,r){r.phi=C-2*c(p(-e.y/t.k0)),r.lam=e.x/t.k0},t.fwd=function(r,n){e(e(r.phi)-C)<=D&&F(),n.x=t.k0*r.lam,n.y=t.k0*f(a(A+.5*r.phi))}}),"webmerc","Web Mercator / Pseudo Mercator","Cyl, Ell"),J((function(e){e.fwd=function(e,t){t.x=e.lam,t.y=1.25*f(a(A+.4*e.phi))},e.inv=function(e,t){t.lam=e.x,t.phi=2.5*(c(p(.8*e.y))-A)},e.es=0}),"mill","Miller Cylindrical","Cyl, Sph"),J((function(e){e.lam0=20*S,e.phi0=18*S,e.es=0,_r(e,[[.9245,0],[0,0],[.01943,0]])}),"mil_os","Miller Oblated Stereographic","Azi(mod)"),J((function(e){e.lam0=-165*S,e.phi0=-10*S,e.es=0,_r(e,[[.721316,0],[0,0],[-.0088162,-.00617325]])}),"lee_os","Lee Oblated Stereographic","Azi(mod)"),J((function(e){e.lam0=-96*S,e.phi0=39*S,e.es=0,e.a=6370997,_r(e,[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]])}),"gs48","Mod Stereographic of 48 U.S.","Azi(mod)"),J((function(e){var t;e.lam0=-152*S,e.phi0=64*S,0!=e.es?(t=[[.9945303,0],[.0052083,-.0027404],[.0072721,.0048181],[-.0151089,-.1932526],[.0642675,-.1381226],[.3582802,-.2884586]],e.a=6378206.4,e.e=h(e.es=.00676866)):(t=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],e.a=6370997),_r(e,t)}),"alsk","Mod Stereographic of Alaska","Azi(mod)"),J((function(e){var t;e.lam0=-120*S,e.phi0=45*S,0!=e.es?(t=[[.9827497,0],[.0210669,.0053804],[-.1031415,-.0571664],[-.0323337,-.0322847],[.0502303,.1211983],[.0251805,.0895678],[-.0012315,-.1416121],[.0072202,-.1317091],[-.0194029,.0759677],[-.0210072,.0834037]],e.a=6378206.4,e.e=h(e.es=.00676866)):(t=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],e.a=6370997),_r(e,t)}),"gs50","Mod Stereographic of 50 U.S.","Azi(mod)"),J((function(t){var r=.8707,n=-.131979,i=-.013791,o=.003971,a=-.001529,s=1.007226,l=.015085,c=-.044475,u=.028874,h=-.005916,d=s,p=3*l,f=7*c,m=9*u,g=11*h,y=.8707*.52*w;t.es=0,t.fwd=function(e,t){var d,p;p=(d=e.phi*e.phi)*d,t.x=e.lam*(r+d*(n+d*(i+p*d*(o+d*a)))),t.y=e.phi*(s+d*(l+p*(c+u*d+h*p)))},t.inv=function(t,_){var v,b,w,x,S=t.x,E=t.y;for(E>y?E=y:E<-y&&(E=-y),v=E;v-=b=(v*(s+(w=v*v)*(l+(x=w*w)*(c+u*w+h*x)))-E)/(d+w*(p+x*(f+m*w+g*x))),!(e(b)<1e-11););_.phi=v,w=v*v,_.lam=S/(r+w*(n+w*(i+w*w*w*(o+w*a))))}}),"natearth","Natural Earth","PCyl., Sph."),J((function(t){var r=.84719,n=-.13063,i=-.04515,o=.05494,a=-.02326,s=.00331,l=1.01183,c=-.02625,u=.01926,h=-.00396,d=l,p=9*c,f=.45334622460635143*w;t.es=0,t.fwd=function(e,t){var d,p,f;f=(d=e.phi*e.phi)*(p=d*d),t.x=e.lam*(r+n*d+f*f*(i+o*d+a*p+s*f)),t.y=e.phi*(l+p*p*(c+u*d+h*p))},t.inv=function(t,m){var g,y,_,v,b,w=t.x,x=t.y;for(x>f?x=f:x<-f&&(x=-f),g=x;g-=y=(g*(l+(v=(_=g*g)*_)*v*(c+u*_+h*v))-x)/(d+v*v*(p+.21186*_+-.05148*v)),!(e(y)<1e-11););m.phi=g,b=(_=g*g)*(v=_*_),m.lam=w/(r+n*_+b*b*(i+o*_+a*v+s*b))}}),"natearth2","Natural Earth 2","PCyl., Sph."),J((function(t){t.inv=function(e,t){t.lam=2*e.x/(1+o(e.y)),t.phi=Kt(.5*(e.y+i(e.y)))},t.fwd=function(t,r){var n,a,s;for(n=2*i(t.phi),a=t.phi*t.phi,t.phi*=1.00371+a*(-.011412*a-.0935382),s=10;s&&(t.phi-=a=(t.phi+i(t.phi)-n)/(1+o(t.phi)),!(e(a)<1e-7));--s);r.x=.5*t.lam*(1+o(t.phi)),r.y=t.phi},t.es=0}),"nell","Nell","PCyl., Sph."),J((function(t){t.es=0,t.fwd=function(e,t){t.x=.5*e.lam*(1+o(e.phi)),t.y=2*(e.phi-a(.5*e.phi))},t.inv=function(t,r){var n,i,s,l;for(s=.5*t.y,l=9;l>0&&(i=o(.5*r.phi),r.phi-=n=(r.phi-a(r.phi/2)-s)/(1-.5/(i*i)),!(e(n)<1e-7));--l);l?r.lam=2*t.x/(1+o(r.phi)):(r.phi=s<0?-C:C,r.lam=2*t.x)}}),"nell_h","Nell-Hammer","PCyl., Sph."),J((function(t){t.es=0,t.fwd=function(t,r){var n=1e-10;if(e(t.lam)<n)r.x=0,r.y=t.phi;else if(e(t.phi)<n)r.x=t.lam,r.y=0;else if(e(e(t.lam)-C)<n)r.x=t.lam*o(t.phi),r.y=C*i(t.phi);else if(e(e(t.phi)-C)<n)r.x=0,r.y=t.phi;else{var a=C/t.lam-t.lam/C,s=t.phi/C,l=i(t.phi),c=(1-s*s)/(l-s),u=a/c,d=(a*l/c-.5*a)/(1+(u*=u)),p=(l/u+.5*c)/(1+1/u);r.x=o(t.phi),r.x=h(d*d+r.x*r.x/(1+u)),r.x=C*(d+(t.lam<0?-r.x:r.x)),r.y=h(p*p-(l*l/u+c*l-1)/(1+1/u)),r.y=C*(p+(t.phi<0?r.y:-r.y))}}}),"nicol","Nicolosi Globular","Misc Sph, no inv"),J((function(e){vr(e,Y(e.params,"dh"))}),"nsper","Near-sided perspective","Azi, Sph\nh="),J((function(e){var t=Y(e.params,"dtilt")*S,r=Y(e.params,"dazi")*S,n=Y(e.params,"dh");vr(e,n,t,r)}),"tpers","Tilted perspective","Azi, Sph\ntilt= azi= h="),J((function(t){var r=[[.7557853228,0],[.249204646,.003371507],[-.001541739,.04105856],[-.10162907,.01727609],[-.26623489,-.36249218],[-.6870983,-1.1651967]],n=[1.5627014243,.5185406398,-.03333098,-.1052906,-.0368594,.007317,.0122,.00394,-.0013],i=[.6399175073,-.1358797613,.063294409,-.02526853,.0117879,-.0055161,.0026906,-.001333,67e-5,-34e-5];t.ra=1/(t.a=6378388),t.lam0=173*S,t.phi0=-41*S,t.x0=251e4,t.y0=6023150,t.inv=function(i,o){var a,s,l,c,u,h,d={r:i.y,i:i.x},p={};for(a=20;a>0&&((u=yr(d,r,p)).r-=i.y,u.i-=i.x,h=p.r*p.r+p.i*p.i,d.r+=l=-(u.r*p.r+u.i*p.i)/h,d.i+=c=-(u.i*p.r-u.r*p.i)/h,!(e(l)+e(c)<=1e-10));--a);if(a>0){for(o.lam=d.i,s=n.length-1,o.phi=n[s],--s;s>=0;--s)o.phi=n[s]+d.r*o.phi;o.phi=t.phi0+d.r*o.phi*.484813681109536}else o.lam=o.phi=b},t.fwd=function(e,n){var o=i.length-1,a={r:i[o]},s=2.0626480624709638*(e.phi-t.phi0);for(--o;o>=0;--o)a.r=i[o]+s*a.r;a.r*=s,a.i=e.lam,a=gr(a,r),n.x=a.i,n.y=a.r}}),"nzmg","New Zealand Map Grid","fixed Earth"),J((function(t){var r,n,s,l,h,d,p,f,m,g,y,_,v,w,E,T=1e-10;r=Y(t.params,"so_proj"),n=Q[r],r||j(-26),n&&"ob_tran"!=r||j(-37),t.es=0,s={},Object.keys(t).forEach((function(e){s[e]=t[e]})),n.init(s),s.is_latlong&&1==t.to_meter&&(t.to_meter=S,t.fr_meter=x),Y(t.params,"to_alpha")?(f=Y(t.params,"ro_lon_c"),m=Y(t.params,"ro_lat_c"),g=Y(t.params,"ro_alpha"),e(e(m)-C)<=T&&j(-32),l=f+er(-o(g),-i(g)*i(m)),p=Kt(o(m)*i(g))):Y(t.params,"to_lat_p")?(l=Y(t.params,"ro_lon_p"),p=Y(t.params,"ro_lat_p")):(y=Y(t.params,"ro_lon_1"),v=Y(t.params,"ro_lat_1"),_=Y(t.params,"ro_lon_2"),w=Y(t.params,"ro_lat_2"),(e(v-w)<=T||(E=e(v))<=T||e(E-C)<=T||e(e(w)-C)<=T)&&j(-33),l=u(o(v)*i(w)*o(y)-i(v)*o(w)*o(_),i(v)*o(w)*i(_)-o(v)*i(w)*i(y)),p=c(-o(l-y)/a(v))),e(p)>T?(h=o(p),d=i(p),t.fwd=function(e,t){var r,n,a;r=o(e.lam),n=i(e.phi),a=o(e.phi),e.lam=Ae(er(a*i(e.lam),d*a*r+h*n)+l),e.phi=Kt(d*n-h*a*r),s.fwd(e,t)},t.inv=s.inv?function(e,t){var r,n,a;s.inv(e,t),t.lam!=b&&(r=o(t.lam-=l),n=i(t.phi),a=o(t.phi),t.phi=Kt(d*n+h*a*r),t.lam=er(a*i(t.lam),d*a*r-h*n))}:null):(t.fwd=function(e,t){var r,n;r=o(e.phi),n=o(e.lam),e.lam=Ae(er(r*i(e.lam),i(e.phi))+l),e.phi=Kt(-r*n),s.fwd(e,t)},t.inv=s.inv?function(e,t){var r,n;s.inv(e,t),t.lam!=b&&(r=o(t.phi),n=t.lam-l,t.lam=er(r*i(n),-i(t.phi)),t.phi=Kt(r*o(n)))}:null)}),"ob_tran","General Oblique Transformation","Misc Sph\no_proj= plus parameters for projection\no_lat_p= o_lon_p= (new pole) or\no_alpha= o_lon_c= o_lat_c= or\no_lon_1= o_lat_1= o_lon_2= o_lat_2="),J((function(e){var t,r,n,l,d,p,f,m,g,y,_;f=1/e.k0,m=e.k0,Y(e.params,"talpha")?(p=Y(e.params,"ralpha"),d=Y(e.params,"rlonc"),_=c(-o(p)/(-i(0)*i(p)))+d,g=s(o(0)*i(p))):(t=Y(e.params,"rlat_1"),r=Y(e.params,"rlat_2"),n=Y(e.params,"rlon_1"),l=Y(e.params,"rlon_2"),_=u(o(t)*i(r)*o(n)-i(t)*o(r)*o(l),i(t)*o(r)*i(l)-o(t)*i(r)*i(n)),n==-C&&(_=-_),g=c(-o(_-n)/a(t))),e.lam0=_+C,y=o(g),g=i(g),_=i(_),e.es=0,e.fwd=function(e,t){var r;t.y=i(e.lam),r=o(e.lam),t.x=c((a(e.phi)*y+g*t.y)/r),r<0&&(t.x+=w),t.x*=m,t.y=f*(g*i(e.phi)-y*o(e.phi)*t.y)},e.inv=function(e,t){var r,n;e.y/=f,e.x/=m,r=h(1-e.y*e.y),t.phi=s(e.y*g+r*y*(n=i(e.x))),t.lam=u(r*g*n-e.y*y,r*o(e.x))}}),"ocea","Oblique Cylindrical Equal Area","Cyl, Sph lonc= alpha= or\nlat_1= lat_2= lon_1= lon_2="),J((function(t){var r,n,l,m,g,y,_,v,x,S,E,T,I,P,M,R,O,L,B,$,z,N,U,V,G,W,H,Z=1e-7,X=0,K=0,Q=0,J=0,ee=0,te=0,re=0,ne=0;H=Y(t.params,"tno_rot"),0!=(T=Y(t.params,"talpha"))&&(re=Y(t.params,"ralpha")),0!=(I=Y(t.params,"tgamma"))&&(X=Y(t.params,"rgamma")),T||I?(K=Y(t.params,"rlonc"),(ne=Y(t.params,"tno_off")||Y(t.params,"tno_uoff"))&&(Y(t.params,"sno_uoff"),Y(t.params,"sno_off"))):(Q=Y(t.params,"rlon_1"),ee=Y(t.params,"rlat_1"),J=Y(t.params,"rlon_2"),te=Y(t.params,"rlat_2"),(e(ee-te)<=Z||(r=e(ee))<=Z||e(r-C)<=Z||e(e(t.phi0)-C)<=Z||e(e(te)-C)<=Z)&&j(-33)),n=h(t.one_es),e(t.phi0)>D?(v=i(t.phi0),l=o(t.phi0),r=1-t.es*v*v,M=l*l,M=h(1+t.es*M*M/t.one_es),P=M*t.k0*n/r,(g=(m=M*n/(l*h(r)))*m-1)<=0?g=0:(g=h(g),t.phi0<0&&(g=-g)),R=g+=m,R*=d(fr(t.phi0,v,t.e),M)):(M=1/n,P=t.k0,R=m=g=1),T||I?(T?(E=s(i(re)/m),I||(X=re)):re=s(m*i(E=X)),t.lam0=K-s(.5*(g-1/g)*a(E))/M):(y=d(fr(ee,i(ee),t.e),M),_=d(fr(te,i(te),t.e),M),g=R/y,x=(_-y)/(_+y),S=((S=R*R)-_*y)/(S+_*y),(r=Q-J)<-w?J-=k:r>w&&(J+=k),t.lam0=Ae(.5*(Q+J)-c(S*a(.5*M*(Q-J))/x)/M),E=c(2*i(M*Ae(Q-t.lam0))/(g-1/g)),X=re=s(m*i(E))),$=i(E),z=o(E),N=i(X),U=o(X),L=1/(O=P*(B=1/M)),ne?W=0:(W=e(O*c(h(m*m-1)/o(re))),t.phi0<0&&(W=-W)),V=O*f(a(A-(g=.5*E))),G=O*f(a(A+g)),t.fwd=function(r,n){var a,s,l,c,h,p,m,g;e(e(r.phi)-C)>D?(a=.5*((h=R/d(fr(r.phi,i(r.phi),t.e),M))-(p=1/h)),s=.5*(h+p),c=i(M*r.lam),e(e(l=(a*$-c*z)/s)-1)<D&&F(),g=.5*O*f((1-l)/(1+l)),p=o(M*r.lam),m=e(p)<Z?P*r.lam:O*u(a*z+c*$,p)):(g=r.phi>0?V:G,m=O*r.phi),H?(n.x=m,n.y=g):(m-=W,n.x=g*U+m*N,n.y=m*U-g*N)},t.inv=function(r,n){var a,s,l,c,f,m,g;H?(s=r.y,a=r.x):(s=r.x*U-r.y*N,a=r.y*U+r.x*N+W),c=.5*((l=p(-L*s))-1/l),f=.5*(l+1/l),m=i(L*a),e(e(g=(m*z+c*$)/f)-1)<D?(n.lam=0,n.phi=g<0?-C:C):(n.phi=R/h((1+g)/(1-g)),(n.phi=mr(d(n.phi,1/M),t.e))==b&&q(),n.lam=-B*u(c*z-m*$,o(L*a)))}}),"omerc","Oblique Mercator","Cyl, Sph&Ell no_rot\nalpha= [gamma=] [no_off] lonc= or\nlon_1= lat_1= lon_2= lat_2="),J((function(t){var r=1e-10,n={};e(e(t.phi0)-C)<=r?n.mode=t.phi0<0?1:0:e(t.phi0)>r?(n.mode=3,n.sinph0=i(t.phi0),n.cosph0=o(t.phi0)):n.mode=2,t.fwd=function(a,s){var l,c,u;switch(c=o(a.phi),l=o(a.lam),n.mode){case 2:c*l<-1e-10&&F(),s.y=i(a.phi);break;case 3:n.sinph0*(u=i(a.phi))+n.cosph0*c*l<-1e-10&&F(),s.y=n.cosph0*u-n.sinph0*c*l;break;case 0:l=-l;case 1:e(a.phi-t.phi0)-r>C&&F(),s.y=c*l}s.x=c*i(a.lam)},t.inv=function(i,o){var a,c,d;if((d=a=m(i.x,i.y))>1&&(d-1>r&&q(),d=1),c=h(1-d*d),e(a)<=r)o.phi=t.phi0,o.lam=0;else{switch(n.mode){case 0:i.y=-i.y,o.phi=l(d);break;case 1:o.phi=-l(d);break;case 2:case 3:2==n.mode?(o.phi=i.y*d/a,i.x*=d,i.y=c*a):(o.phi=c*n.sinph0+i.y*d*n.cosph0/a,i.y=(c-n.sinph0*o.phi)*a,i.x*=d*n.cosph0),e(o.phi)>=1?o.phi=o.phi<0?-C:C:o.phi=s(o.phi)}o.lam=0!=i.y||3!=n.mode&&2!=n.mode?u(i.x,i.y):0==i.x?0:i.x<0?-C:C}},t.es=0}),"ortho","Orthographic","Azi, Sph."),J((function(t){var r=1.0148,n=.23185,i=-.14499,o=.02406,a=r,s=5*n,l=7*i,c=908571831.7;t.es=0,t.fwd=function(e,t){var a=e.phi*e.phi;t.x=e.lam,t.y=e.phi*(r+a*a*(n+a*(i+o*a)))},t.inv=function(t,u){var h,d,p,f;for(h=t.y,t.y>c?t.y=c:t.y<-c&&(t.y=-c),f=100;f&&(h-=d=(h*(r+(p=h*h)*p*(n+p*(i+o*p)))-t.y)/(a+p*p*(s+p*(l+.21654*p))),!(e(d)<1e-11));--f);u.phi=h,u.lam=t.x}}),"patterson","Patterson Cylindrical","Cyl., Sph."),J((function(t){var r,n,l=1e-10,c=1e-12;t.es?(n=Zt(t.es),r=Yt(t.phi0,i(t.phi0),o(t.phi0),n),t.fwd=function(a,s){var c,u,h;e(a.phi)<=l?(s.x=a.lam,s.y=-r):(u=i(a.phi),c=e(h=o(a.phi))>l?Wt(u,h,t.es)/u:0,s.x=c*i(a.lam*=u),s.y=Yt(a.phi,u,h,n)-r+c*(1-o(a.lam)))},t.inv=function(u,d){var p,f,m,g,y,_,v,b,w,x,S=u.x,E=u.y;if(e(E+=r)<=l)d.lam=S,d.phi=0;else{for(p=E*E+S*S,d.phi=E,x=20;x>0&&(y=(m=i(d.phi))*(g=o(d.phi)),e(g)<c&&q(),f=m*(b=h(1-t.es*m*m))/g,v=(_=Yt(d.phi,m,g,n))*_+p,b=t.one_es/(b*b*b),d.phi+=w=(_+_+f*v-2*E*(f*_+1))/(t.es*y*(v-2*E*_)/f+2*(E-_)*(f*b-1/y)-b-b),!(e(w)<=c));--x);x||q(),f=i(d.phi),d.lam=s(S*a(d.phi)*h(1-t.es*f*f))/i(d.phi)}}):(r=-t.phi0,t.fwd=function(n,s){var c,u;e(n.phi)<=l?(s.x=n.lam,s.y=r):(c=1/a(n.phi),s.x=i(u=n.lam*i(n.phi))*c,s.y=n.phi-t.phi0+c*(1-o(u)))},t.inv=function(r,n){var o,c,u,h;if(e(r.y=t.phi0+r.y)<=l)n.lam=r.x,n.phi=0;else{n.phi=r.y,o=r.x*r.x+r.y*r.y,h=10;do{u=a(n.phi),n.phi-=c=(r.y*(n.phi*u+1)-n.phi-.5*(n.phi*n.phi+o)*u)/((n.phi-r.y)/u-1)}while(e(c)>1e-10&&--h);h||q(),n.lam=s(r.x*a(n.phi))/i(n.phi)}})}),"poly","Polyconic (American)","Conic, Sph&Ell"),J((function(t){var r=1.8949,n=1.71848,a=.6141848493043784,s=1.0471975511965976;t.es=0,t.fwd=function(t,l){var c,u,h,d,p;for(c=a*i(t.phi),h=t.phi*t.phi,t.phi*=.615709+h*(.00909953+.0046292*h),p=10;p&&(u=o(t.phi),h=i(t.phi),t.phi-=d=(t.phi+h*(u-1)-c)/(1+u*(u-1)-h*h),!(e(d)<1e-10));--p);p||(t.phi=t.phi<0?-s:s),l.x=r*t.lam*(o(t.phi)-.5),l.y=n*i(t.phi)},t.inv=function(e,t){var s;t.phi=Kt(e.y/n),t.lam=e.x/(r*((s=o(t.phi))-.5)),t.phi=Kt((t.phi+i(t.phi)*(s-1))/a)}}),"putp2","Putnins P2","PCyl., Sph."),J(br,"putp3","Putnins P3","PCyl., Sph."),J((function(e){br(e,!0)}),"putp3p","Putnins P3'","PCyl., Sph."),J((function(e){wr(e,.874038744,3.883251825)}),"putp4p","Putnins P4'","PCyl., Sph."),J((function(e){wr(e,1,4.442882938)}),"weren","Werenskiold I","PCyl., Sph."),J(xr,"putp5","Putnins P5","PCyl., Sph."),J((function(e){xr(e,!0)}),"putp5p","Putnins P5'","PCyl., Sph."),J(Sr,"putp6","Putnins P6","PCyl., Sph."),J((function(e){Sr(e,!0)}),"putp6p","Putnins P6'","PCyl., Sph."),J((function(t){var r,n,s,d;function p(t,r,n){var i,o;return t<1e-10?(i=0,o=0):(o=u(r,n),e(o)<=A?i=0:o>A&&o<=C+A?(i=1,o-=C):o>C+A||o<=-(C+A)?(i=2,o=o>=0?o-w:o+w):(i=3,o+=C)),{area:i,theta:o}}function f(e,t){var r=e+t;return r<-w?r+=k:r>+w&&(r-=k),r}r=t.phi0>=C-A/2?4:t.phi0<=-(C-A/2)?5:e(t.lam0)<=A?0:e(t.lam0)<=C+A?t.lam0>0?1:3:2,0!==t.es&&(t.a,t.a,n=t.a*h(1-t.es),s=1-(t.a-n)/t.a,d=s*s),t.fwd=function(e,n){var s,u,m,g,y,_,v,b,x,S,E,T,k,P;s=0!==t.es?c(d*a(e.phi)):e.phi,u=e.lam,4==r?(g=C-s,u>=A&&u<=C+A?(v=0,m=u-C):u>C+A||u<=-(C+A)?(v=1,m=u>0?u-w:u+w):u>-(C+A)&&u<=-A?(v=2,m=u+C):(v=3,m=u)):5==r?(g=C+s,u>=A&&u<=C+A?(v=0,m=-u+C):u<A&&u>=-A?(v=1,m=-u):u<-A&&u>=-(C+A)?(v=2,m=-u-C):(v=3,m=u>0?-u+w:-u-w)):(1==r?u=f(u,+C):2==r?u=f(u,+w):3==r&&(u=f(u,-C)),E=i(s),T=o(s),k=i(u),b=T*o(u),x=T*k,S=E,0==r?P=p(g=l(b),S,x):1==r?P=p(g=l(x),S,-b):2==r?P=p(g=l(-b),S,-x):3==r?P=p(g=l(-x),S,b):(g=0,P={area:0,theta:0}),m=P.theta,v=P.area),_=c(12/w*(m+l(i(m)*o(A))-C)),y=h((1-o(g))/(o(_)*o(_))/(1-o(c(1/o(m))))),1==v?_+=C:2==v?_+=w:3==v&&(_+=I),n.x=y*o(_),n.y=y*i(_)},t.inv=function(p,m){var g,y,_,v,b,x,S,E,T,A,I,k,P;if(y=c(h(p.x*p.x+p.y*p.y)),g=u(p.y,p.x),p.x>=0&&p.x>=e(p.y)?A=0:p.y>=0&&p.y>=e(p.x)?(A=1,g-=C):p.x<0&&-p.x>=e(p.y)?(A=2,g=g<0?g+w:g-w):(A=3,g+=C),T=w/12*a(g),b=i(T)/(o(T)-1/h(2)),x=c(b),(S=1-(_=o(g))*_*(v=a(y))*v*(1-o(c(1/o(x)))))<-1?S=-1:S>1&&(S=1),4==r)E=l(S),m.phi=C-E,m.lam=0==A?x+C:1==A?x<0?x+w:x-w:2==A?x-C:x;else if(5==r)E=l(S),m.phi=E-C,m.lam=0==A?-x+C:1==A?-x:2==A?-x-C:x<0?-x-w:-x+w;else{var M,R,D;T=(M=S)*M,R=(T+=(D=T>=1?0:h(1-T)*i(x))*D)>=1?0:h(1-T),1==A?(T=R,R=-D,D=T):2==A?(R=-R,D=-D):3==A&&(T=R,R=D,D=-T),1==r?(T=M,M=-R,R=T):2==r?(M=-M,R=-R):3==r&&(T=M,M=R,R=-T),m.phi=l(-D)-C,m.lam=u(R,M),1==r?m.lam=f(m.lam,-C):2==r?m.lam=f(m.lam,-w):3==r&&(m.lam=f(m.lam,+C))}0!==t.es&&(I=m.phi<0?1:0,k=a(m.phi),P=n/h(k*k+d),m.phi=c(h(t.a*t.a-P*P)/(s*P)),I&&(m.phi=-m.phi))}}),"qsc","Quadrilateralized Spherical Cube","Azi, Sph."),J((function(t){var r=l([[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]]),i=l([[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]]),o=.8487,a=1.3523;function s(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))}function l(e){return e.map((function(e){return new Float32Array(e)}))}t.es=0,t.fwd=function(t,l){var c,u;(c=n(11.459155902616464*(u=e(t.phi))))<0&&F(),c>=18&&(c=17),u=x*(u-.08726646259971647*c),l.x=s(r[c],u)*o*t.lam,l.y=s(i[c],u)*a,t.phi<0&&(l.y=-l.y)},t.inv=function(t,l){var c,u,h,d,p,f;if(l.lam=t.x/o,l.phi=e(t.y/a),l.phi>=1)l.phi>1.000001?q():(l.phi=t.y<0?-C:C,l.lam/=r[18][0]);else{if((d=n(18*l.phi))<0||d>=18)return q();for(;;)if(i[d][0]>l.phi)--d;else{if(!(i[d+1][0]<=l.phi))break;++d}for(h=new Float32Array(i[d]),c=5*(l.phi-h[0])/(i[d+1][0]-h[0]),h[0]-=l.phi;c-=u=s(h,c)/(f=c,(p=h)[1]+f*(p[2]+p[2]+3*f*p[3])),!(e(u)<1e-8););l.phi=(5*d+c)*S,t.y<0&&(l.phi=-l.phi),l.lam/=s(r[d],c)}}}),"robin","Robinson","PCyl., Sph."),J(Er("EULER"),"euler","Euler","Conic, Sph\nlat_1= and lat_2="),J(Er("MURD1"),"murd1","Murdoch I","Conic, Sph\nlat_1= and lat_2="),J(Er("MURD2"),"murd2","Murdoch II","Conic, Sph\nlat_1= and lat_2="),J(Er("MURD3"),"murd3","Murdoch III","Conic, Sph\nlat_1= and lat_2="),J(Er("PCONIC"),"pconic","Perspective Conic","Conic, Sph\nlat_1= and lat_2="),J(Er("TISSOT"),"tissot","Tissot","Conic, Sph\nlat_1= and lat_2="),J(Er("VITK1"),"vitk1","Vitkovsky I","Conic, Sph\nlat_1= and lat_2="),J((function(t){var r,n,s,l,u,d,m,g,y;s=.5*t.e,m=o(t.phi0),m*=m,n=h(1+t.es*m*m*t.rone_es),y=i(t.phi0),u=o(g=Kt(d=y/n)),y*=t.e,r=f(a(A+.5*g))-n*(f(a(A+.5*t.phi0))-s*f((1+y)/(1-y))),l=t.k0*h(t.one_es)/(1-y*y),t.inv=function(h,m){var g,y,_,v,b,w,x,S,E;for(_=2*(c(p(h.y/l))-A),v=h.x/l,b=o(_),g=Kt(u*i(_)+d*b*o(v)),y=Kt(b*i(v)/o(g)),x=(r-f(a(A+.5*g)))/n,E=6;E&&(w=t.e*i(g),g-=S=(x+f(a(A+.5*g))-s*f((1+w)/(1-w)))*(1-w*w)*o(g)*t.rone_es,!(e(S)<1e-10));--E);E?(m.phi=g,m.lam=y/n):q()},t.fwd=function(e,h){var m,g,y,_,v,b;v=t.e*i(e.phi),m=2*c(p(n*(f(a(A+.5*e.phi))-s*f((1+v)/(1-v)))+r))-C,g=n*e.lam,b=o(m),y=Kt(u*i(m)-d*b*o(g)),_=Kt(b*i(g)/o(y)),h.x=l*_,h.y=l*f(a(A+.5*y))}}),"somerc","Swiss. Obl. Mercator","Cyl, Ell\nFor CH1903"),J((function(e){var t=Y(e.params,"tlat_ts")?Y(e.params,"rlat_ts"):C;Tr(e,t)}),"stere","Stereographic","Azi, Sph&Ell\nlat_ts="),J((function(e){e.phi0=Y(e.params,"bsouth")?-C:C,e.k0=.994,e.x0=2e6,e.y0=2e6,e.lam0=0,e.es||j(-34),Tr(e,C)}),"ups","Universal Polar Stereographic","Azi, Sph&Ell\nsouth"),J((function(t){var r,n,l,p,f,g,y,_,v,b=(r=t.e,n=t.phi0,l=r*r,p=i(n),f=o(n),g=h(1-l)/(1-l*p*p),y=h(1+l*f*f*f*f/(1-l)),_=s(p/y),v=.5*y*r,{e:r,K:a(.5*_+A)/(d(a(.5*n+A),y)*Ar(r*p,v)),C:y,chi:_,ratexp:v,rc:g}),w=b.chi,x=2*b.rc,S=i(w),E=o(w);t.fwd=function(e,r){var n,s,l,u;e=function(e,t){return{phi:2*c(t.K*d(a(.5*e.phi+A),t.C)*Ar(t.e*i(e.phi),t.ratexp))-C,lam:t.C*e.lam}}(e,b),s=i(e.phi),n=o(e.phi),l=o(e.lam),u=t.k0*x/(1+S*s+E*n*l),r.x=u*n*i(e.lam),r.y=u*(E*s-S*n*l)},t.inv=function(r,n){var l,h,p,f,g=r.x/t.k0,y=r.y/t.k0;(l=m(g,y))?(h=2*u(l,x),p=i(h),f=o(h),n.phi=s(f*S+y*p*E/l),n.lam=u(g*p,l*E*f-y*S*p)):(n.phi=w,n.lam=0),function(t,r){t.phi;var n,o,s=d(a(.5*t.phi+A)/r.K,1/r.C);for(t.lam/=r.C,n=20;n>0&&(o=2*c(s*Ar(r.e*i(t.phi),-.5*r.e))-C,!(e(o-t.phi)<1e-14));--n)t.phi=o;n||z(-17)}(n,b)}}),"sterea","Oblique Stereographic Alternative","Azimuthal, Sph&Ell"),J((function(e){Cr(e,1.50488,1.35439,!1)}),"kav5","Kavraisky V","PCyl., Sph."),J((function(e){Cr(e,2,2,!1)}),"qua_aut","Quartic Authalic","PCyl., Sph."),J((function(e){Cr(e,2,2,!0)}),"fouc","Foucaut","PCyl., Sph."),J((function(e){Cr(e,1.48875,1.36509,!1)}),"mbt_s","McBryde-Thomas Flat-Polar Sine (No. 1)","PCyl., Sph."),J((function(e){e.es=0,e.fwd=function(t,r){r.x=o(t.phi)*i(t.lam)/e.k0,r.y=e.k0*(u(a(t.phi),o(t.lam))-e.phi0)},e.inv=function(t,r){var n;t.y=t.y/e.k0+e.phi0,t.x*=e.k0,n=h(1-t.x*t.x),r.phi=s(n*i(t.y)),r.lam=u(t.x,n*o(t.y))}}),"tcea","Transverse Cylindrical Equal Area","Cyl, Sph"),J((function(e){e.es=0,e.fwd=function(e,t){var r=a(e.phi/2),n=i(A*r);t.x=e.lam*(.74482-.34588*n*n),t.y=1.70711*r},e.inv=function(e,t){var r=e.y/1.70711,n=i(A*r);t.lam=e.x/(.74482-.34588*n*n),t.phi=2*c(r)}}),"times","Times","Cyl, Sph"),J((function(t){Y(t.params,"bapprox")?Ir(t):function(t){if(0===t.es)return Ir(t);ar(t);var r=t.fwd,n=t.inv;Ir(t);var i=t.fwd,o=t.inv;t.fwd=function(t,n){e(t.lam)>3*S?r(t,n):i(t,n)},t.inv=function(t,r){e(t.x)>.053-.022*t.y*t.y?n(t,r):o(t,r)}}(t)}),"tmerc","Transverse Mercator","Cyl, Sph&Ell"),J((function(e){var t;e.es||j(-34),e.y0=Y(e.params,"bsouth")?1e7:0,e.x0=5e5,Y(e.params,"tzone")?(t=Y(e.params,"izone"))>0&&t<=60?--t:j(-35):(t=n(30*(Ae(e.lam0)+w)/w))<0?t=0:t>=60&&(t=59),e.lam0=(t+.5)*w/30-w,e.k0=.9996,e.phi0=0,ar(e)}),"utm","Universal Transverse Mercator (UTM)","Cyl, Sph\nzone= south"),J((function(e){var t,r,n,s,l,c,h,d,p,f,g,y,_,v,b,w,x,S,E,T,A,I,k;T=Y(e.params,"rlat_1"),S=Y(e.params,"rlon_1"),A=Y(e.params,"rlat_2"),E=Y(e.params,"rlon_2"),T==A&&S==E&&j(-25),e.lam0=Ae(.5*(S+E)),f=Ae(E-S),t=o(T),n=o(A),r=i(T),s=i(A),c=t*s,h=r*n,l=t*n*i(f),p=Qt(r*s+t*n*o(f)),g=.5*p,I=u(n*i(f),t*s-r*n*o(f)),v=o(k=Kt(t*i(I))),b=i(k),w=Ae(u(t*o(I),r)-g),f*=.5,x=C-u(i(I)*r,o(I))-f,y=a(g),_=.5/i(g),d=.5/p,p*=p,e.fwd=function(e,a){var u,m,g,y,_,v,b;v=i(e.phi),b=o(e.phi),m=Qt(r*v+t*b*o(y=e.lam+f)),g=Qt(s*v+n*b*o(_=e.lam-f)),m*=m,g*=g,a.x=d*(u=m-g),u=p-u,a.y=d*Jt(4*p*g-u*u),l*v-b*(c*i(y)-h*i(_))<0&&(a.y=-a.y)},e.inv=function(e,t){var r,n,a,s,l,c;a=(r=o(m(e.y,e.x+g)))+(n=o(m(e.y,e.x-g))),s=r-n,t.lam=-u(s,a*y),t.phi=Qt(m(y*a,s)*_),e.y<0&&(t.phi=-t.phi),c=i(t.phi),l=o(t.phi),t.phi=Kt(b*c+v*l*(a=o(t.lam-=w))),t.lam=u(l*i(t.lam),b*l*a-v*c)+x},e.es=0}),"tpeqd","Two Point Equidistant","Misc Sph\nlat_1= lon_1= lat_2= lon_2="),J((function(e){var t,r,n,a,s,l;(a=Y(e.params,"dn"))>0&&a<=1==0&&j(-40),n=Y(e.params,"dq")/3,s=Y(e.params,"ralpha"),l=a*i(s),t=o(s)/h(1-l*l),r=1/(t*a),e.fwd=function(e,s){var l=e.phi=Kt(a*i(e.phi));s.x=t*e.lam*o(e.phi),l*=l,s.y=e.phi*(1+l*n)*r},e.es=0}),"urm5","Urmaev V","PCyl., Sph., no inv.\nn= q= alpha="),J((function(e){var t=Y(e.params,"dn");(t<=0||t>1)&&j(-40),kr(e,t)}),"urmfps","Urmaev Flat-Polar Sinusoidal","PCyl, Sph.\nn="),J((function(e){kr(e,.8660254037844386)}),"wag1","Wagner I (Kavraisky VI)","PCyl, Sph."),J((function(t){var r=1e-10,n=.3333333333333333,i=9.869604401089358,c=19.739208802178716,u=4.934802200544679;t.fwd=function(t,n){var i,o,l,c,u;(u=e(t.phi/C))-r>1&&F(),u>1&&(u=1),e(t.phi)<=r?(n.x=t.lam,n.y=0):e(t.lam)<=r||e(u-1)<r?(n.x=0,n.y=w*a(.5*s(u)),t.phi<0&&(n.y=-n.y)):(o=(i=.5*e(w/t.lam-t.lam/w))*i,l=h(1-u*u),c=(l/=u+l-1)*l,u=l*(2/u-1),u*=u,n.x=l-u,l=u+o,n.x=w*(i*n.x+h(o*n.x*n.x-l*(c-u)))/l,t.lam<0&&(n.x=-n.x),n.y=e(n.x/w),n.y=1-n.y*(n.y+2*i),n.y<-r&&F(),n.y<0?n.y=0:n.y=h(n.y)*(t.phi<0?-w:w))},t.inv=function(t,a){var s,d,p,f,m,g,y,_,v,b,x,S,E;if(S=t.x*t.x,(x=e(t.y))<r)return a.phi=0,s=S*S+c*(S+u),a.lam=e(t.x)<=r?0:.5*(S-i+h(s))/t.x,a;E=t.y*t.y,f=(p=-w*x*((_=S+E)+i))+i*(_-3*E),d=w*x,v=2*h(-n*(g=p/(m=(y=_*_)+k*(x*_+w*(E+w*(x+C))))-n*(f/=m)*f)),(s=e(b=3*(b=.07407407407407407*f*f*f+(d*d-n*f*p)/m)/(g*v)))-r<=1?(b=s>1?b>0?0:w:l(b),a.phi=w*(v*o(b*n+4.188790204786391)-n*f),t.y<0&&(a.phi=-a.phi),s=y+c*(S-E+u),a.lam=e(t.x)<=r?0:.5*(_-i+(s<=0?0:h(s)))/t.x):q()}}),"vandg","van der Grinten (I)","Misc Sph"),J((function(e){Pr(e,!1)}),"vandg2","van der Grinten II","Misc Sph, no inv."),J((function(e){Pr(e,!0)}),"vandg3","van der Grinten III","Misc Sph, no inv."),J((function(t){t.es=0,t.fwd=function(t,r){var n,i,o,a,s,l,c,u,d=1e-10;e(t.phi)<d?(r.x=t.lam,r.y=0):e(t.lam)<d||e(e(t.phi)-C)<d?(r.x=0,r.y=t.phi):(l=(a=.5*((o=e(P*t.phi))*(8-o*(2+(s=o*o)))-5)/(s*(o-1)))*a,c=P*t.lam,c=h((c+=1/c)*c-4),e(t.lam)-C<0&&(c=-c),n=o+a,n=(c*((n*=n)+l-1)+2*h(n*(s+l*(u=c*c)-1)+(1-s)*(s*((i=o+3*a)*i+4*l)+l*(12*o*a+4*l))))/(4*n+u),r.x=C*n,r.y=C*h(1+c*e(n)-n*n),t.lam<0&&(r.x=-r.x),t.phi<0&&(r.y=-r.y))}}),"vandg4","van der Grinten IV","Misc Sph, no inv."),J((function(e){var t=.92483,r=1.38725,n=.88022,a=.8855;e.fwd=function(e,s){e.phi=Kt(n*i(a*e.phi)),s.x=t*e.lam*o(e.phi),s.y=r*e.phi},e.inv=function(e,s){s.phi=e.y/r,s.lam=e.x/(t*o(s.phi)),s.phi=Kt(i(s.phi)/n)/a}}),"wag2","Wagner II","PCyl., Sph."),J((function(e){var t=.6666666666666666,r=Y(e.params,"rlat_ts"),n=o(r)/o(2*r/3);e.es=0,e.fwd=function(e,r){r.x=n*e.lam*o(t*e.phi),r.y=e.phi},e.inv=function(e,r){r.phi=e.y,r.lam=e.x/(n*o(t*r.phi))}}),"wag3","Wagner III","PCyl., Sph.\nlat_ts="),J((function(e){e.es=0,e.fwd=function(e,t){var r,n,a;r=s(t.y=.9063077870366499*i(e.phi)),t.x=2.66723*(n=o(r))*i(e.lam/=3),t.y*=1.24104*(a=1/h(.5*(1+n*o(e.lam)))),t.x*=a}}),"wag7","Wagner VII","Misc Sph, no inv."),J((function(e){var t=o(Y(e.params,"rlat_ts"));e.fwd=function(e,r){r.x=.5*e.lam*(t+o(e.phi)),r.y=e.phi},e.inv=function(e,r){r.phi=e.y,r.lam=2*e.x/(t+o(r.phi))},e.es=0}),"wink1","Winkel I","PCyl., Sph.\nlat_ts="),J((function(t){var r=o(Y(t.params,"rlat_1"));t.fwd=function(t,n){var a,s,l,c=t.phi;for(n.y=c*P,a=w*i(c),c*=1.8,l=10;l&&(c-=s=(c+i(c)-a)/(1+o(c)),!(e(s)<1e-7));--l);l?c*=.5:c=c<0?-C:C,n.x=.5*t.lam*(o(c)+r),n.y=A*(i(c)+n.y)},t.inv=null,t.es=0}),"wink2","Winkel II","PCyl., Sph., no inv.\nlat_1=");var Mr=Pe;Mr.pj_init=me,Mr.pj_fwd=Ce,Mr.pj_inv=Ie,Mr.pj_transform=xe,Mr.pj_add=J,Mr.pj_fwd_deg=function(e,t){return Ce({lam:e.lam*S,phi:e.phi*S},t)},Mr.pj_inv_deg=function(e,t){var r=Ie(e,t);return{lam:r.lam*x,phi:r.phi*x}},Mr.pj_transform_point=we,Mr.internal={dmstod:W,dmstor:G,get_rtodms:function(e,t,r,n){var i=ke(e,t,r,n);return function(e){return i(e*x)}},get_dtodms:ke,get_proj_defn:re,pj_latlong_from_proj:function(e){return me("+proj=latlong"+te(e))},pj_get_params:X,pj_datums:ie,pj_list:Q,pj_ellps:se,pj_units:ce,pj_read_init_opts:fe,find_datum:ae,DEG_TO_RAD:S,RAD_TO_DEG:x,wkt_parse:zt,wkt_unpack:Ft,convert_wkt_quotes:qt,wkt_to_proj4:function(e){var t,r,n=zt(e);return n.PROJCS?t=$e(r=n.PROJCS)(r):n.GEOGCS?t="+proj=longlat "+We(n.GEOGCS):n.GEOCCS?Ue("geocentric coordinates are not supported"):Ue("missing a supported WKT CS type"),t},wkt_from_proj4:function(e){return e.length&&(e=me(e)),Lt(ee(e)?{GEOGCS:Xe(e)}:nt(e))},wkt_make_projcs:nt,wkt_get_geogcs_name:Je,wkt_stringify:Lt,mproj_insert_libcache:function(e,t){de[e]=t},mproj_search_libcache:pe,GeographicLib:Vt},It.exports=Mr}()),Ct.exports),Pt=Tt(kt);function Mt(e,t){var r=l(e),n=r.crs,i=[r],a=function(e){e.internal.pj_list.mixed||e.pj_add((function(e){e.a=1}),"mixed","Mapshaper Mixed Projection");return e.pj_init("+proj=mixed")}(Pt);function l(e){return{bounds:new St((t=e.bbox,r=Math.PI/180,t.map((function(e){return e*r})))),crs:Pt.pj_init(e.proj)};var t,r}return n.__mixed_crs=a,n.addFrame=function(e){var r,n,a,c=function(e,t){var r=t[e.name];return o.defaults(e,{scale:1,dx:0,dy:0,rotation:0}),r?(Object.keys(r).forEach((function(t){var n=r[t];t in e?e[t]=r[t]:e.proj=function(e,t,r){var n="+"+t+"=";return e.split(" ").map((function(e){return 0===e.indexOf(n)&&(e=e.substr(0,n.length)+r),e})).join(" ")}(e.proj,t,n)})),e):e}(e,t),u=l(c),h=new s,d=c.origin?(r=c.origin,n=u.crs,[(a=Pt.pj_fwd_deg({lam:r[0],phi:r[1]},n)).x,a.y]):[0,0],p=c.placement||[0,0],f=p[0]-d[0]+(+c.dx||0),m=p[1]-d[1]+(+c.dy||0);return c.rotation&&h.rotate(c.rotation*Math.PI/180,d[0],d[1]),c.scale&&h.scale(c.scale,c.scale,d[0],d[1]),h.translate(f,m),u.matrix=h,i.push(u),this},a.fwd=function(e,t){for(var r,n,o=0,a=i.length;o<a;o++)if((r=i[o]).bounds.containsPoint(e.lam,e.phi)){n=Pt.pj_fwd(e,r.crs),r.matrix&&r.matrix.transformXY(n.x,n.y,n);break}t.x=n?n.x:1/0,t.y=n?n.y:1/0},n}function Rt(e){var t=e.trim().split(/ +/),r=[],n=t.filter((function(e){return!/^\+/.test(e)||(r.push(e.substr(1)),!1)})),i=n[0],a=function(e){var t={};return e.forEach((function(e){!function(e,t){var r=e.split("="),n=r[0].split("."),i=n.pop(),a=n.reduce((function(e,t){if(t in e==!1)e[t]={};else if(!o.isObject(e[t]))return{};return e[t]}),t);r.length>1?a[i]=function(e){var t;if(e.indexOf(",")>0)return t=e.split(",").map(parseFloat);t=o.parseNumber(e),null===t&&(t=e);return t}(r[1]):i in a!=!1||n.length||(a[i]={})}(e,t)})),t}(r);return 1!=n.length?null:function(e,t){if("albersusa"==e)return new Dt(t);return null}(i,a)}function Dt(e){var t=e||{},r=new Mt({proj:"+proj=aea +lon_0=-96 +lat_0=37.5 +lat_1=29.5 +lat_2=45.5",bbox:[-129,23,-62,52]},t).addFrame({name:"AK",proj:"+proj=aea +lat_1=55 +lat_2=70 +lat_0=65 +lon_0=-148 +x_0=0 +y_0=0",bbox:[-172.26,50.89,-127,73.21],origin:[-152,63],placement:[-1882782,-969242],scale:.37}).addFrame({name:"HI",proj:"+proj=aea +lat_1=19 +lat_2=24 +lat_0=20.9 +lon_0=-156.5 +x_0=0 +y_0=0",bbox:[-160.5,18.72,-154.57,22.58],origin:[-157,21],placement:[-1050326,-1055362]});return t.PR&&r.addFrame({name:"PR",proj:"+proj=aea +lat_1=18 +lat_2=18.43 +lat_0=17.83 +lon_0=-66.43 +x_0=0 +y_0=0",bbox:[-68.092,17.824,-65.151,18.787],origin:[-66.431,18.228],placement:[1993101,-1254517]}),t.VI&&r.addFrame({name:"VI",proj:"+proj=aea +lat_1=18 +lat_2=18.43 +lat_0=17.83 +lon_0=-66.43 +x_0=0 +y_0=0",bbox:[-65.104,17.665,-64.454,18.505],origin:[-66.431,18.228],placement:[1993101,-1254517]}),r}var Ot=6378137,Lt=Ot,Bt=Math.PI/180,$t=180/Math.PI;function zt(e,t,r,n,i,o){var a=e-n,s=t-i,l=r-o;return Math.sqrt(a*a+s*s+l*l)}function Ft(e,t,r,n){var i=e-r,o=t-n;return i*i+o*o}function qt(e,t,r,n){var i=e-r,o=t-n;return Math.sqrt(i*i+o*o)}function Nt(e,t,r,n,i,o){var a=e-n,s=t-i,l=r-o;return a*a+s*s+l*l}function jt(e){for(var t=2*Math.PI;e<0;)e+=t;for(;e>=t;)e-=t;return e}function Ut(e,t,r,n){var i=Math.PI/180;e*=i,r*=i,t*=i,n*=i;var o=Math.sin(r-e)*Math.cos(n),a=Math.cos(t)*Math.sin(n)-Math.sin(t)*Math.cos(n)*Math.cos(r-e);return Math.atan2(o,a)}function Vt(e,t,r){var n;e*=Bt,t*=Bt,n=Math.cos(t),r[0]=Math.cos(e)*n*Lt,r[1]=Math.sin(e)*n*Lt,r[2]=Math.sin(t)*Lt}function Gt(e,t,r,n){var i=r-e,o=n-t,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t)*Math.cos(n)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Wt(e,t,r,n){var i=Math.PI/180;return Gt(e*i,t*i,r*i,n*i)*Lt}function Ht(e,t,r,n,i,o){var a=e*n-e*o+r*o-r*t+i*t-i*n;return a*a}function Zt(e,t,r){var n;if(0===r)n=e;else if(e>=t+r)n=t;else if(t>=e+r)n=e;else{var i=e+r-t;n=e-i*i/r*.25}return n<0&&(n=0),n}function Yt(e,t,r,n,i,o){var a=Ft(r,n,i,o),s=((e-r)*(i-r)+(t-n)*(o-n))/a;return 0===a?Ft(e,t,r,n):(s<0&&(s=0),s>1&&(s=1),Ft(e,t,r+s*(i-r),n+s*(o-n)))}var Xt,Kt=Object.freeze({__proto__:null,D2R:Bt,R:Lt,R2D:$t,bearing:Ut,bearing2D:function(e,t,r,n){var i=Math.PI/2-Math.atan2(n-t,r-e);return i>Math.PI?i-2*Math.PI:i},containsBounds:function(e,t){return e[0]<=t[0]&&e[2]>=t[2]&&e[1]<=t[1]&&e[3]>=t[3]},convLngLatToSph:function(e,t,r,n,i){for(var o=[],a=0,s=e.length;a<s;a++)Vt(e[a],t[a],o),r[a]=o[0],n[a]=o[1],i[a]=o[2]},cosine:function(e,t,r,n,i,o){var a=qt(e,t,r,n)*qt(r,n,i,o),s=0;return a>0&&((s=((e-r)*(i-r)+(t-n)*(o-n))/a)>1?s=1:s<-1&&(s=-1)),s},cosine3D:function(e,t,r,n,i,o,a,s,l){var c=zt(e,t,r,n,i,o)*zt(n,i,o,a,s,l),u=0;return c>0&&((u=((e-n)*(a-n)+(t-i)*(s-i)+(r-o)*(l-o))/c)>1?u=1:u<-1&&(u=-1)),u},degreesToMeters:function(e){return e*Bt*Lt},distance2D:qt,distance3D:zt,distanceSq:Ft,distanceSq3D:Nt,greatCircleDistance:Wt,innerAngle:function(e,t,r,n,i,o){var a,s=qt(e,t,r,n),l=qt(r,n,i,o);return 0===s||0===l||(a=((e-r)*(i-r)+(t-n)*(o-n))/(s*l))>=1-1e-14?0:a<=1e-14-1?Math.PI:Math.acos(a)},innerAngle2:function(e,t,r,n,i,o){var a=Math.atan2(t-n,e-r),s=Math.atan2(o-n,i-r),l=Math.abs(a-s);return l>Math.PI&&(l=2*Math.PI-l),l},innerAngle3D:function(e,t,r,n,i,o,a,s,l){var c,u=zt(e,t,r,n,i,o),h=zt(n,i,o,a,s,l);return 0===u||0===h||(c=((e-n)*(a-n)+(t-i)*(s-i)+(r-o)*(l-o))/(u*h))>=1?0:c<=-1?Math.PI:Math.acos(c)},lngLatToXYZ:Vt,pointSegDistSq:function(e,t,r,n,i,o){return Zt(Ft(e,t,r,n),Ft(e,t,i,o),Ft(r,n,i,o))},pointSegDistSq2:Yt,pointSegDistSq3D:function(e,t,r,n,i,o,a,s,l){return Zt(Nt(e,t,r,n,i,o),Nt(e,t,r,a,s,l),Nt(n,i,o,a,s,l))},signedAngle:function(e,t,r,n,i,o){if(e==r&&t==n||r==i&&n==o)return NaN;var a=e-r,s=t-n,l=i-r,c=o-n,u=a*l+s*c,h=a*c-s*l;return jt(Math.atan2(h,u))},signedAngleSph:function(e,t,r,n,i,o){if(e==r&&t==n||r==i&&n==o)return NaN;var a=Ut(r,n,e,t),s=Ut(r,n,i,o);return jt(2*Math.PI+a-s)},sphericalDistance:Gt,standardAngle:jt,triangleArea:function(e,t,r,n,i,o){return Math.abs(((t-o)*(r-i)+(n-o)*(i-e))/2)},triangleArea3D:function(e,t,r,n,i,o,a,s,l){return.5*Math.sqrt(Ht(e,t,n,i,a,s)+Ht(e,r,n,o,a,l)+Ht(t,r,i,o,s,l))},xyzToLngLat:function(e,t,r,n){var i=zt(0,0,0,e,t,r),o=Math.asin(r/i)/Bt,a=Math.atan2(t/i,e/i)/Bt;n[0]=a,n[1]=o}});function Qt(e,t,r,n){var i,o,a,s,l,c,u,h,d,p,f=n.getShapeIter(r),m=1/0;for(f.hasNext()&&(o=c=h=f.x,a=u=d=f.y);f.hasNext();)(p=Yt(e,t,o,a,s=f.x,l=f.y))<m&&(m=p,i=f._ids[f._i],c=o,u=a,h=s,d=l),o=s,a=l;return m==1/0?{distance:1/0}:{segment:[[c,u],[h,d]],distance:Math.sqrt(m),arcId:i}}function Jt(e,t,r,n){return(r||[]).reduce((function(r,i){var o=Qt(e,t,i,n);return!r||o.distance<r.distance?o:r}),null)||{distance:1/0,arcId:-1,segment:null}}function er(e,t){var r=t.getShapeIter(e);if(!r.hasNext())return null;for(var n=r.x,i=r.y,o=0,a=0,s=0;r.hasNext();)o++,a+=r.x,s+=r.y;return 0!==o&&r.x===n&&r.y===i||(a+=n,s+=i,o++),{x:a/o,y:s/o}}function tr(e,t){var r=0;return(e||[]).reduce((function(e,n){var i=t.getSimpleShapeBounds(n).area();return i>r&&(r=i,e=n),e}),null)}Xt=function(){var e,t;function r(r,n,i,o){e+=t(i[r],o[r],i[n],o[n])}return function(n,i,o){o&&i.isPlanar()&&y("Expected lat-long coordinates"),t=o?Wt:qt,e=0;for(var a=0,s=n.length;a<s;a++)i.forEachArcSegment(n[a],r);return e}}();var rr=Object.freeze({__proto__:null,get calcPathLen(){return Xt},countVerticesInPath:function(e,t){for(var r=t.getShapeIter(e),n=0;r.hasNext();)n++;return n},getAvgPathXY:er,getMaxPath:tr,getPathBounds:function(e){for(var t=new St,r=0,n=e.length;r<n;r++)t.mergePoint(e[r][0],e[r][1]);return t},getPointToPathDistance:function(e,t,r,n){return Qt(e,t,r,n).distance},getPointToPathInfo:Qt,getPointToShapeDistance:function(e,t,r,n){var i=Jt(e,t,r,n);return i?i.distance:1/0},getPointToShapeInfo:Jt,pathIsClosed:function(e,t){var r=e[0],n=e[e.length-1],i=t.getVertex(r,0),o=t.getVertex(n,-1);return i.x===o.x&&i.y===o.y}});function nr(e,t){var r,n,i,o,a,s,l,c,u=t.getShapeIter(e),h=0,d=0,p=0;if(!u.hasNext())return null;for(i=0,o=0,r=-u.x,n=-u.y;u.hasNext();)a=i,s=o,i=u.x+r,h+=l=a*(o=u.y+n)-s*i,d+=l*(a+i),p+=l*(s+o);return 0===(c=h/2)?er(e,t):{x:d/(6*c)-r,y:p/(6*c)-n}}var ir=Object.freeze({__proto__:null,getPathCentroid:nr,getShapeCentroid:function(e,t){var r=tr(e,t);return r?nr(r,t):null}});function or(e){return e>=0?e:~e}function ar(e,t){for(var r,n=0,i=t.length-1;n<i;)e<t[r=Math.ceil((n+i)/2)]?i=r-1:n=r;return n}function sr(e,t){for(var r=0,n=0,i=e.length;n<i;n++)e[n]>=t&&r++;return r}function lr(e){var t=0,r=e.forEachSegment((function(e,r,n,i){var o=n[e]-n[r],a=i[e]-i[r];t+=Math.sqrt(o*o+a*a)}));return t/r||0}function cr(e){var t=0,r=0,n=e.forEachSegment((function(e,n,i,o){t+=Math.abs(i[e]-i[n]),r+=Math.abs(o[e]-o[n])}));return[t/n||0,r/n||0]}function ur(e,t){var r=new Uint8Array(t.size());return hr(e,r),function(e){return e<0&&(e=~e),r[e]>0}}function hr(e,t){vr(e,null,(function(e){for(var r,n=e.arcs,i=0;i<n.length;i++)(r=n[i])<0&&(r=~r),t[r]++}))}function dr(e,t){var r=new St;return gr(e,(function(e){t.mergeArcBounds(e,r)})),r}function pr(e){e.reverse();for(var t=0,r=e.length;t<r;t++)e[t]=~e[t];return e}function fr(e,t){return t<=0?e=1/0:t>=1&&(e=0),e}function mr(e,t,r,n){var i,o,a=0,s=-1;r>n&&(i=r,r=n,n=i);for(var l=r+1;l<n;l++)(o=e[l])<t&&o>a&&(s=l,a=o);return s}function gr(e,t){for(var r,n=0;n<e.length;n++)if(r=e[n],Array.isArray(r))gr(r,t);else if(o.isInteger(r)){var i=t(r);void 0!==i&&(e[n]=i)}else r&&y("Non-integer arc id in:",e)}function yr(e,t,r){for(var n=0,i=e?e.length:0;n<i;n++)_r(e[n],t,r)}function _r(e,t,r){for(var n=0,i=e.length;n<i;n++)t.forEachArcSegment(e[n],r)}function vr(e,t,r,n){var i=0;e.forEach((function(e,o){if(e&&0!==e.length){var a,s;n&&n(o);for(var l=0,c=e.length;l<c;l++)if(a=e[l],r&&r({i:l,shapeId:o,shape:e,arcs:a}),t)for(var u=0,h=a.length;u<h;u++,i++)s=a[u],t({i:u,shapeId:o,partId:l,arcId:s,segId:i})}}))}function br(e,t){var r,n,i=t.getArcIter(e);if(i.hasNext())for(r=i.x,n=i.y;i.hasNext();)if(i.x!=r||i.y!=n)return!0;return!1}function wr(e,t){if(!e)return null;var r=[];return e.forEach((function(e){for(var n=[],i=0;i<e.length;i++)br(e[i],t)&&n.push(e[i]);n.length>0&&r.push(n)})),r.length>0?r:null}function xr(e,t,r){for(var n,i=[],o=0,a=e&&e.length;o<a;o++)n=e[o],i.push({ids:n,area:"polygon"==r?Qr.getPlanarPathArea(n,t):0,bounds:t.getSimpleShapeBounds(n)});return i}var Sr=Object.freeze({__proto__:null,clampIntervalByPct:fr,countArcsInShapes:hr,filterEmptyArcs:wr,findNextRemovableVertex:mr,findShapesByArcId:function(e,t,r){var n=r?new Uint8Array(r):[],i=[];return t.forEach((function(e){n[or(e)]=1})),e.forEach((function(e,t){var r=!1;gr(e||[],(function(e){r=r||1==n[or(e)]})),r&&i.push(t)})),i},forEachArcId:gr,forEachSegmentInPath:_r,forEachSegmentInShape:yr,getArcPresenceTest:ur,getAvgSegment:lr,getAvgSegment2:cr,getDirectedArcPresenceTest:function(e,t){var r=new Uint8Array(t);return gr(e,(function(e){var n=or(e);n<t==!1&&y("index error"),r[n]|=e<0?2:1})),function(e){var t=or(e);return e<0?!(2&~r[t]):!(1&~r[t])}},getPathBounds:dr,getPathMetadata:xr,quantizeArcs:function(e,t){var r=e.getBounds(),n=new St(0,0,t-1,t-1),i=r.getTransform(n),o=i.invert();e.transformPoints((function(e,t){var r=i.transform(e,t);return o.transform(Math.round(r[0]),Math.round(r[1]))}))},reversePath:pr,traversePaths:vr});function Er(e,t,r){if(!t||!Tr(e.xmin,e.ymin,t,r))return!1;var n=!0;return t.forEach((function(t){_r(t,r,(function(t,r,i,o){n=n&&!function(e,t,r){return!!r.containsPoint(e[0],e[1])||!!(Qr.segmentIntersection(e[0],e[1],t[0],t[1],r.xmin,r.ymin,r.xmin,r.ymax)||Qr.segmentIntersection(e[0],e[1],t[0],t[1],r.xmin,r.ymax,r.xmax,r.ymax)||Qr.segmentIntersection(e[0],e[1],t[0],t[1],r.xmax,r.ymax,r.xmax,r.ymin)||Qr.segmentIntersection(e[0],e[1],t[0],t[1],r.xmax,r.ymin,r.xmin,r.ymin))}([i[t],o[t]],[i[r],o[r]],e)}))})),n}function Tr(e,t,r,n){var i=!1,o=!1;return!!r&&(r.forEach((function(r){var a=Ar(e,t,r,n);1==a?i=!i:-1==a&&(o=!0)})),o||i)}function Ar(e,t,r,n){var i=!1,o=!1;return _r(r,n,(function(r,n,a,s){var l=Cr(e,t,a[r],s[r],a[n],s[n]);1==l?i=!i:isNaN(l)&&(o=!0)})),o?-1:i?1:0}function Cr(e,t,r,n,i,o){var a=Ir(e,t,r,n,i,o);return a!=a?NaN:a==-1/0?0:1}function Ir(e,t,r,n,i,o){var a,s=-1/0;return e<r&&e<i||e>r&&e>i||t>n&&t>o||(e===r||e===i?e===r&&e===i?t!=n&&t!=o&&t>n==t>o||(s=NaN):e===r?t===n?s=NaN:i<r&&t<n&&(s=n):t===o?s=NaN:r<i&&t<o&&(s=o):(a=function(e,t,r,n,i){return r+(e-t)*(i-r)/(n-t)}(e,r,n,i,o),a>t?s=a:a==t&&(s=NaN))),s}function kr(e,t){return(t.isPlanar()?Rr:Pr)(e,t)}function Pr(e,t,r){return Mr(t.getShapeIter(e),r)}function Mr(e,t){var r,n,i,o,a=0,s=!1,l=Math.PI/180;for(t=t||Ot;e.hasNext();)r=e.x*l,n=Math.sin(e.y*l),s?a+=(r-i)*(2+n+o):s=!0,i=r,o=n;return a/2*t*t}function Rr(e,t){var r,n,i,o,a,s,l=t.getShapeIter(e),c=0;if(l.hasNext())for(r=0,n=0,a=-l.x,s=-l.y;l.hasNext();)i=r,o=n,c+=(r=l.x+a)*o-i*(n=l.y+s);return c/2}function Dr(e,t){return(t.isPlanar()?Or:Lr)(e,t)}function Or(e,t){return Xt(e,t,!1)}function Lr(e,t){return Xt(e,t,!0)}var Br=Object.freeze({__proto__:null,calcPolsbyPopperCompactness:function(e,t){return t<=0?0:Math.abs(e)*Math.PI*4/(t*t)},calcSchwartzbergCompactness:function(e,t){return t<=0?0:2*Math.PI*Math.sqrt(Math.abs(e)/Math.PI)/t},getPathArea:kr,getPathPerimeter:Dr,getPathWinding:function(e,t){var r=kr(e,t);return(r>0?1:r<0&&-1)||0},getPlanarPathArea:Rr,getPlanarPathArea2:function(e){for(var t,r,n,i,o,a,s,l=0,c=0,u=e.length;c<u;c++)s=e[c],0===c?(t=0,r=0,o=-s[0],a=-s[1]):l+=(t=s[0]+o)*i-n*(r=s[1]+a),n=t,i=r;return l/2},getPlanarPathPerimeter:Or,getPlanarShapeArea:function(e,t){return(e||[]).reduce((function(e,r){return e+Rr(r,t)}),0)},getRayIntersection:Ir,getShapeArea:function(e,t){return(e||[]).reduce((function(e,r){return e+kr(r,t)}),0)},getShapePerimeter:function(e,t){return(e||[]).reduce((function(e,r){return e+Dr(r,t)}),0)},getSphericalPathArea:Pr,getSphericalPathArea2:Mr,getSphericalPathPerimeter:Lr,getSphericalShapeArea:function(e,t,r){return t.isPlanar()&&y("[getSphericalShapeArea()] Function requires decimal degree coordinates"),(e||[]).reduce((function(e,n){return e+Pr(n,t,r)}),0)},getSphericalShapePerimeter:function(e,t){return t.isPlanar()&&y("[getSphericalShapePerimeter()] Function requires decimal degree coordinates"),(e||[]).reduce((function(e,r){return e+Lr(r,t)}),0)},testBoundsInPolygon:Er,testPointInPolygon:Tr,testPointInRing:Ar,testRayIntersection:Cr});function $r(e){return 1e-14*Math.max.apply(null,e.map(Math.abs))}function zr(e,t){var r=lr(e),n=.0025*r;t>0&&(n=t,v(o.format("Applying snapping threshold of %s -- %.6f times avg. segment length",t,t/r)));var i=Fr(e,n);i>0&&e.dedupCoords(),v(o.format("Snapped %s point%s",i,o.pluralSuffix(i)))}function Fr(e,t){return t>0==!1?0:qr(Nr(e),e,t)}function qr(e,t,r){var n=0,i=e.length,o=t.getVertexData();Ur(o.xx,e,0,i-1);for(var a=0;a<i;a++)n+=s(a,r,e,o.xx,o.yy);return n;function s(e,t,r,n,i){for(var o,a,s,l=e,c=r.length,u=n[r[e]],h=i[r[e]],d=0;++l<c&&!((a=n[o=r[l]]-u)>t);)s=i[o]-h,0===a&&0===s||a*a+s*s>t*t||(n[o]=u,i[o]=h,d++);return d}}function Nr(e){for(var t=e.getVertexData().xx.length,r=new Uint32Array(t),n=0;n<t;n++)r[n]=n;return r}function jr(e){var t=0,r=[];return e.getVertexData().nn.forEach((function(e){e>0!=!1&&(r.push(t,t+e-1),t+=e)})),r}function Ur(e,t,r,n){if(n-r>24){for(var i,o=e[t[r+n>>1]],a=r,s=n;a<=s;){for(;e[t[a]]<o;)a++;for(;e[t[s]]>o;)s--;a<=s&&(i=t[a],t[a]=t[s],t[s]=i,a++,s--)}s>r&&Ur(e,t,r,s),a<n&&Ur(e,t,a,n)}else!function(e,t,r,n){var i,o,a;for(a=r+1;a<=n;a++){for(i=t[a],o=a-1;o>=r&&e[i]<e[t[o]];o--)t[o+1]=t[o];t[o+1]=i}}(e,t,r,n)}var Vr=Object.freeze({__proto__:null,getCoordinateIds:Nr,getEndpointIds:jr,getHighPrecisionSnapInterval:$r,snapCoords:zr,snapCoordsByInterval:Fr,snapEndpointsByInterval:function(e,t){return t>0==!1?0:qr(jr(e),e,t)}});function Gr(e,t,r,n,i,o,a,s){if(!(Yt(r,n,i,o,a,s)>t)){var l=Ft(i,o,r,n),c=Ft(a,s,r,n);l<=t||c<=t||e.push(r,n)}}function Wr(e,t,r,n,i,o){var a=qt(r,n,i,o);return a<t&&(t=a,e[0]=i,e[1]=o),t}function Hr(e,t,r){var n;return function(e,t,r){return t<r?e<t||e>r:t>r?e>t||e<r:e!=t}(e,t,r)&&(n=Math.abs(e-t)<Math.abs(e-r)?t:r,Math.abs(e-n)>1e-15&&x(),e=n),e}function Zr(e,t,r,n){return e*n-t*r}function Yr(e,t,r,n,i,o){return Zr(e-i,t-o,r-i,n-o)}function Xr(e,t,r,n,i,o,a,s){return Yr(e,t,r,n,i,o)*Yr(e,t,r,n,a,s)<=0&&Yr(i,o,a,s,e,t)*Yr(i,o,a,s,r,n)<=0}var Kr=Object.freeze({__proto__:null,findClosestPointOnSeg:function(e,t,r,n,i,o,a){var s=i-r,l=o-n,c=s*s+l*l,u=0===c?-1:((e-r)*s+(t-n)*l)/c,h=a>=0?a:.1;return u<=h?[r,n]:u>=1-h?[i,o]:[r+u*s,n+u*l]},orient2D:Yr,segmentHit:Xr,segmentIntersection:function(e,t,r,n,i,o,a,s,l){var c,u,h=l>=0?l:$r([e,t,r,n,i,o,a,s]),d=h*h;return!(c=function(e,t,r,n,i,o,a,s,l){var c=[];if(Gr(c,e,t,r,o,a,s,l),Gr(c,e,n,i,o,a,s,l),Gr(c,e,o,a,t,r,n,i),Gr(c,e,s,l,t,r,n,i),0===c.length)return null;c.length>4&&x();return c}(d,e,t,r,n,i,o,a,s))&&function(e,t,r,n,i,o,a,s,l){return Ft(t,r,o,a)<=e||Ft(t,r,s,l)<=e||Ft(n,i,o,a)<=e||Ft(n,i,s,l)<=e}(d,e,t,r,n,i,o,a,s)?null:(u=function(e,t,r,n,i,o,a,s,l){if(!Xr(e,t,r,n,i,o,a,s))return null;var c=Zr(r-e,n-t,a-i,s-o),u=Yr(i,o,a,s,e,t)/c,h=[e+u*(r-e),t+u*(n-t)];if(Math.abs(c)<1e-18)return null;l>0&&function(e,t,r,n,i,o,a,s,l,c){var u=e[0],h=e[1],d=c;d=Wr(e,d,u,h,t,r),d=Wr(e,d,u,h,n,i),d=Wr(e,d,u,h,o,a),d=Wr(e,d,u,h,s,l)}(h,e,t,r,n,i,o,a,s,l);return function(e,t,r,n,i,o,a,s,l){var c=e[0],u=e[1];c=Hr(c,t,n),c=Hr(c,o,s),u=Hr(u,r,i),u=Hr(u,a,l),e[0]=c,e[1]=u}(h,e,t,r,n,i,o,a,s),h}(e,t,r,n,i,o,a,s,h),c||u||null)},segmentTurn:function(e,t,r,n){var i=e[0],o=e[1],a=t[0],s=t[1],l=a-r[0],c=s-r[1],u=Yr(i,o,a,s,n[0]+l,n[1]+c);return u?u<0?1:-1:0}}),Qr=Object.assign({},Kt,Br,rr,Kr,ir);function Jr(e){return[-180+(e=o.isFiniteNumber(e)?e:1e-10),-90+e,180-e,90-e]}function en(e){var t=Jr(-1),r=e instanceof St?e.toArray():e;return Qr.containsBounds(t,r)}function tn(e){var t=e instanceof St?e.toArray():e;return(new St).setBounds(Math.max(t[0],-180),Math.max(t[1],-90),Math.min(t[2],180),Math.min(t[3],90))}function rn(e){for(var t=e-180;t<=-180;)t+=360;return t}var nn=Object.freeze({__proto__:null,clampToWorldBounds:tn,getAntimeridian:rn,getWorldBounds:Jr,probablyDecimalDegreeBounds:en});function on(e){var t=new St;return ln(e,(function(e){t.mergePoint(e[0],e[1])})),t}function an(e,t){var r,n=e?e.length:0;t||(t=new St);for(var i=0;i<n;i++)r=e[i],t.mergePoint(r[0],r[1]);return t}function sn(e){var t=[];return ln(e.shapes,(function(e){t.push(e)})),t}function ln(e,t){var r,n,i,o,a;for(r=0,n=e.length;r<n;r++)for(i=0,o=(a=e[r])?a.length:0;i<o;i++)t(a[i],r)}var cn=Object.freeze({__proto__:null,countPointsInLayer:function(e){var t=0;return Wi(e)&&ln(e.shapes,(function(){t++})),t},forEachPoint:ln,getPointBounds:on,getPointFeatureBounds:an,getPointsInLayer:sn});function un(e){return e?e.map((function(e){return e.concat()})):null}function hn(e){return o.isArray(e)?e.map(un):null}function dn(e,t){fn(e,t)}function pn(e,t){for(var r=0,n=e.length;r<n;r++)e[r]=fn(e[r],t)}function fn(e,t){if(!e)return null;o.isArray(e)||y("Expected an array, received:",e);for(var r,n=0,i=e.length,a=0;a<i;a++)null===(r=t(e[a],a,e))?(n++,e[a]=null):o.isArray(r)&&(e[a]=r);return n==i?null:n>0?e.filter((function(e){return!!e})):e}function mn(e){for(var t,r=0,n=0,i=e.length;n<i;n++)(t=e[n])&&t.length>r&&(r=t.length);return r}var gn,yn,_n=Object.freeze({__proto__:null,cloneShape:un,cloneShapes:hn,editShapeParts:fn,editShapes:pn,findMaxPartCount:mn,forEachShapePart:dn}),vn={exports:{}};function bn(){if(yn)return gn;yn=1;var e,t=n,r=t.Buffer,i={};for(e in t)t.hasOwnProperty(e)&&"SlowBuffer"!==e&&"Buffer"!==e&&(i[e]=t[e]);var o=i.Buffer={};for(e in r)r.hasOwnProperty(e)&&"allocUnsafe"!==e&&"allocUnsafeSlow"!==e&&(o[e]=r[e]);if(i.Buffer.prototype=r.prototype,o.from&&o.from!==Uint8Array.from||(o.from=function(e,t,n){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return r(e,t,n)}),o.alloc||(o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var i=r(e);return t&&0!==t.length?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i}),!i.kStringMaxLength)try{i.kStringMaxLength=process$1.binding("buffer").kStringMaxLength}catch(a){}return i.constants||(i.constants={MAX_LENGTH:i.kMaxLength},i.kStringMaxLength&&(i.constants.MAX_STRING_LENGTH=i.kStringMaxLength)),gn=i}var wn,xn,Sn,En={};function Tn(){if(Sn)return xn;Sn=1;var e=void 0===Object.hasOwn?Function.call.bind(Object.prototype.hasOwnProperty):Object.hasOwn;return xn=function(t,r){for(var n in r)e(r,n)&&(t[n]=r[n])},xn}var An,Cn,In={};function kn(){if(Cn)return An;Cn=1;var e=bn().Buffer;function t(t,r){this.enc=t.encodingName,this.bomAware=t.bomAware,"base64"===this.enc?this.encoder=a:"utf8"===this.enc?this.encoder=c:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=s,""!==e.from("eda0bdedb2a9","hex").toString()&&(this.decoder=l,this.defaultCharUnicode=r.defaultCharUnicode))}An={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:t},t.prototype.encoder=o,t.prototype.decoder=n;var r=i.StringDecoder;function n(e,t){this.decoder=new r(t.enc)}function o(e,t){this.enc=t.enc}function a(e,t){this.prevStr=""}function s(e,t){}function l(e,t){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=t.defaultCharUnicode}function c(e,t){this.highSurrogate=""}return n.prototype.write=function(t){return e.isBuffer(t)||(t=e.from(t)),this.decoder.write(t)},n.prototype.end=function(){return this.decoder.end()},o.prototype.write=function(t){return e.from(t,this.enc)},o.prototype.end=function(){},a.prototype.write=function(t){var r=(t=this.prevStr+t).length-t.length%4;return this.prevStr=t.slice(r),t=t.slice(0,r),e.from(t,"base64")},a.prototype.end=function(){return e.from(this.prevStr,"base64")},s.prototype.write=function(t){for(var r=e.alloc(3*t.length),n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r[n++]=o:o<2048?(r[n++]=192+(o>>>6),r[n++]=128+(63&o)):(r[n++]=224+(o>>>12),r[n++]=128+(o>>>6&63),r[n++]=128+(63&o))}return r.slice(0,n)},s.prototype.end=function(){},l.prototype.write=function(e){for(var t=this.acc,r=this.contBytes,n=this.accBytes,i="",o=0;o<e.length;o++){var a=e[o];128!=(192&a)?(r>0&&(i+=this.defaultCharUnicode,r=0),a<128?i+=String.fromCharCode(a):a<224?(t=31&a,r=1,n=1):a<240?(t=15&a,r=2,n=1):i+=this.defaultCharUnicode):r>0?(t=t<<6|63&a,n++,0===--r&&(i+=2===n&&t<128&&t>0||3===n&&t<2048?this.defaultCharUnicode:String.fromCharCode(t))):i+=this.defaultCharUnicode}return this.acc=t,this.contBytes=r,this.accBytes=n,i},l.prototype.end=function(){var e=0;return this.contBytes>0&&(e+=this.defaultCharUnicode),e},c.prototype.write=function(t){if(this.highSurrogate&&(t=this.highSurrogate+t,this.highSurrogate=""),t.length>0){var r=t.charCodeAt(t.length-1);r>=55296&&r<56320&&(this.highSurrogate=t[t.length-1],t=t.slice(0,t.length-1))}return e.from(t,this.enc)},c.prototype.end=function(){if(this.highSurrogate){var t=this.highSurrogate;return this.highSurrogate="",e.from(t,this.enc)}},An}var Pn,Mn={};function Rn(){if(Pn)return Mn;Pn=1;var e=bn().Buffer;function t(e,t){this.iconv=t,this.bomAware=!0,this.isLE=e.isLE}function r(e,t){this.isLE=t.isLE,this.highSurrogate=0}function n(e,t){this.isLE=t.isLE,this.badChar=t.iconv.defaultCharUnicode.charCodeAt(0),this.overflow=[]}function i(e,t,r,n){if((r<0||r>1114111)&&(r=n),r>=65536){var i=55296|(r-=65536)>>10;e[t++]=255&i,e[t++]=i>>8;r=56320|1023&r}return e[t++]=255&r,e[t++]=r>>8,t}function o(e,t){this.iconv=t}function a(e,t){void 0===(e=e||{}).addBOM&&(e.addBOM=!0),this.encoder=t.iconv.getEncoder(e.defaultEncoding||"utf-32le",e)}function s(e,t){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=e||{},this.iconv=t.iconv}function l(e,t){var r=[],n=0,i=0,o=0,a=0,s=0;e:for(var l=0;l<e.length;l++)for(var c=e[l],u=0;u<c.length;u++)if(r.push(c[u]),4===r.length){if(0===n){if(255===r[0]&&254===r[1]&&0===r[2]&&0===r[3])return"utf-32le";if(0===r[0]&&0===r[1]&&254===r[2]&&255===r[3])return"utf-32be"}if((0!==r[0]||r[1]>16)&&o++,(0!==r[3]||r[2]>16)&&i++,0!==r[0]||0!==r[1]||0===r[2]&&0===r[3]||s++,0===r[0]&&0===r[1]||0!==r[2]||0!==r[3]||a++,r.length=0,++n>=100)break e}return s-o>a-i?"utf-32be":s-o<a-i?"utf-32le":t||"utf-32le"}return Mn._utf32=t,Mn.utf32le={type:"_utf32",isLE:!0},Mn.utf32be={type:"_utf32",isLE:!1},Mn.ucs4le="utf32le",Mn.ucs4be="utf32be",t.prototype.encoder=r,t.prototype.decoder=n,r.prototype.write=function(t){for(var r=e.from(t,"ucs2"),n=e.alloc(2*r.length),i=this.isLE?n.writeUInt32LE:n.writeUInt32BE,o=0,a=0;a<r.length;a+=2){var s=r.readUInt16LE(a),l=s>=55296&&s<56320,c=s>=56320&&s<57344;if(this.highSurrogate){if(!l&&c){var u=65536+(this.highSurrogate-55296<<10|s-56320);i.call(n,u,o),o+=4,this.highSurrogate=0;continue}i.call(n,this.highSurrogate,o),o+=4}l?this.highSurrogate=s:(i.call(n,s,o),o+=4,this.highSurrogate=0)}return o<n.length&&(n=n.slice(0,o)),n},r.prototype.end=function(){if(this.highSurrogate){var t=e.alloc(4);return this.isLE?t.writeUInt32LE(this.highSurrogate,0):t.writeUInt32BE(this.highSurrogate,0),this.highSurrogate=0,t}},n.prototype.write=function(t){if(0===t.length)return"";var r=0,n=0,o=e.alloc(t.length+4),a=0,s=this.isLE,l=this.overflow,c=this.badChar;if(l.length>0){for(;r<t.length&&l.length<4;r++)l.push(t[r]);4===l.length&&(n=s?l[r]|l[r+1]<<8|l[r+2]<<16|l[r+3]<<24:l[r+3]|l[r+2]<<8|l[r+1]<<16|l[r]<<24,l.length=0,a=i(o,a,n,c))}for(;r<t.length-3;r+=4)a=i(o,a,n=s?t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24:t[r+3]|t[r+2]<<8|t[r+1]<<16|t[r]<<24,c);for(;r<t.length;r++)l.push(t[r]);return o.slice(0,a).toString("ucs2")},n.prototype.end=function(){this.overflow.length=0},Mn.utf32=o,Mn.ucs4="utf32",o.prototype.encoder=a,o.prototype.decoder=s,a.prototype.write=function(e){return this.encoder.write(e)},a.prototype.end=function(){return this.encoder.end()},s.prototype.write=function(e){if(!this.decoder){if(this.initialBufs.push(e),this.initialBufsLen+=e.length,this.initialBufsLen<32)return"";var t=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options);for(var r="",n=0;n<this.initialBufs.length;n++)r+=this.decoder.write(this.initialBufs[n]);return this.initialBufs.length=this.initialBufsLen=0,r}return this.decoder.write(e)},s.prototype.end=function(){if(!this.decoder){var e=l(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);for(var t="",r=0;r<this.initialBufs.length;r++)t+=this.decoder.write(this.initialBufs[r]);var n=this.decoder.end();return n&&(t+=n),this.initialBufs.length=this.initialBufsLen=0,t}return this.decoder.end()},Mn}var Dn,On={};function Ln(){if(Dn)return On;Dn=1;var e=bn().Buffer;function t(){}function r(){}function n(){this.overflowByte=-1}function i(e,t){this.iconv=t}function o(e,t){void 0===(e=e||{}).addBOM&&(e.addBOM=!0),this.encoder=t.iconv.getEncoder("utf-16le",e)}function a(e,t){this.decoder=null,this.initialBufs=[],this.initialBufsLen=0,this.options=e||{},this.iconv=t.iconv}function s(e,t){var r=[],n=0,i=0,o=0;e:for(var a=0;a<e.length;a++)for(var s=e[a],l=0;l<s.length;l++)if(r.push(s[l]),2===r.length){if(0===n){if(255===r[0]&&254===r[1])return"utf-16le";if(254===r[0]&&255===r[1])return"utf-16be"}if(0===r[0]&&0!==r[1]&&o++,0!==r[0]&&0===r[1]&&i++,r.length=0,++n>=100)break e}return o>i?"utf-16be":o<i?"utf-16le":t||"utf-16le"}return On.utf16be=t,t.prototype.encoder=r,t.prototype.decoder=n,t.prototype.bomAware=!0,r.prototype.write=function(t){for(var r=e.from(t,"ucs2"),n=0;n<r.length;n+=2){var i=r[n];r[n]=r[n+1],r[n+1]=i}return r},r.prototype.end=function(){},n.prototype.write=function(t){if(0==t.length)return"";var r=e.alloc(t.length+1),n=0,i=0;for(-1!==this.overflowByte&&(r[0]=t[0],r[1]=this.overflowByte,n=1,i=2);n<t.length-1;n+=2,i+=2)r[i]=t[n+1],r[i+1]=t[n];return this.overflowByte=n==t.length-1?t[t.length-1]:-1,r.slice(0,i).toString("ucs2")},n.prototype.end=function(){this.overflowByte=-1},On.utf16=i,i.prototype.encoder=o,i.prototype.decoder=a,o.prototype.write=function(e){return this.encoder.write(e)},o.prototype.end=function(){return this.encoder.end()},a.prototype.write=function(e){if(!this.decoder){if(this.initialBufs.push(e),this.initialBufsLen+=e.length,this.initialBufsLen<16)return"";var t=s(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(t,this.options);for(var r="",n=0;n<this.initialBufs.length;n++)r+=this.decoder.write(this.initialBufs[n]);return this.initialBufs.length=this.initialBufsLen=0,r}return this.decoder.write(e)},a.prototype.end=function(){if(!this.decoder){var e=s(this.initialBufs,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(e,this.options);for(var t="",r=0;r<this.initialBufs.length;r++)t+=this.decoder.write(this.initialBufs[r]);var n=this.decoder.end();return n&&(t+=n),this.initialBufs.length=this.initialBufsLen=0,t}return this.decoder.end()},On}var Bn,$n={};function zn(){if(Bn)return $n;Bn=1;var e=bn().Buffer;function t(e,t){this.iconv=t}$n.utf7=t,$n.unicode11utf7="utf7",t.prototype.encoder=n,t.prototype.decoder=i,t.prototype.bomAware=!0;var r=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function n(e,t){this.iconv=t.iconv}function i(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}n.prototype.write=function(t){return e.from(t.replace(r,function(e){return"+"+("+"===e?"":this.iconv.encode(e,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},n.prototype.end=function(){};for(var o=/[A-Za-z0-9\/+]/,a=[],s=0;s<256;s++)a[s]=o.test(String.fromCharCode(s));var l="+".charCodeAt(0),c="-".charCodeAt(0),u="&".charCodeAt(0);function h(e,t){this.iconv=t}function d(t,r){this.iconv=r.iconv,this.inBase64=!1,this.base64Accum=e.alloc(6),this.base64AccumIdx=0}function p(e,t){this.iconv=t.iconv,this.inBase64=!1,this.base64Accum=""}i.prototype.write=function(t){for(var r="",n=0,i=this.inBase64,o=this.base64Accum,s=0;s<t.length;s++)if(i){if(!a[t[s]]){if(s==n&&t[s]==c)r+="+";else{var u=o+this.iconv.decode(t.slice(n,s),"ascii");r+=this.iconv.decode(e.from(u,"base64"),"utf16-be")}t[s]!=c&&s--,n=s+1,i=!1,o=""}}else t[s]==l&&(r+=this.iconv.decode(t.slice(n,s),"ascii"),n=s+1,i=!0);if(i){var h=(u=o+this.iconv.decode(t.slice(n),"ascii")).length-u.length%8;o=u.slice(h),u=u.slice(0,h),r+=this.iconv.decode(e.from(u,"base64"),"utf16-be")}else r+=this.iconv.decode(t.slice(n),"ascii");return this.inBase64=i,this.base64Accum=o,r},i.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},$n.utf7imap=h,h.prototype.encoder=d,h.prototype.decoder=p,h.prototype.bomAware=!0,d.prototype.write=function(t){for(var r=this.inBase64,n=this.base64Accum,i=this.base64AccumIdx,o=e.alloc(5*t.length+10),a=0,s=0;s<t.length;s++){var l=t.charCodeAt(s);l>=32&&l<=126?(r&&(i>0&&(a+=o.write(n.slice(0,i).toString("base64").replace(/\//g,",").replace(/=+$/,""),a),i=0),o[a++]=c,r=!1),r||(o[a++]=l,l===u&&(o[a++]=c))):(r||(o[a++]=u,r=!0),r&&(n[i++]=l>>8,n[i++]=255&l,i==n.length&&(a+=o.write(n.toString("base64").replace(/\//g,","),a),i=0)))}return this.inBase64=r,this.base64AccumIdx=i,o.slice(0,a)},d.prototype.end=function(){var t=e.alloc(10),r=0;return this.inBase64&&(this.base64AccumIdx>0&&(r+=t.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),r),this.base64AccumIdx=0),t[r++]=c,this.inBase64=!1),t.slice(0,r)};var f=a.slice();return f[",".charCodeAt(0)]=!0,p.prototype.write=function(t){for(var r="",n=0,i=this.inBase64,o=this.base64Accum,a=0;a<t.length;a++)if(i){if(!f[t[a]]){if(a==n&&t[a]==c)r+="&";else{var s=o+this.iconv.decode(t.slice(n,a),"ascii").replace(/,/g,"/");r+=this.iconv.decode(e.from(s,"base64"),"utf16-be")}t[a]!=c&&a--,n=a+1,i=!1,o=""}}else t[a]==u&&(r+=this.iconv.decode(t.slice(n,a),"ascii"),n=a+1,i=!0);if(i){var l=(s=o+this.iconv.decode(t.slice(n),"ascii").replace(/,/g,"/")).length-s.length%8;o=s.slice(l),s=s.slice(0,l),r+=this.iconv.decode(e.from(s,"base64"),"utf16-be")}else r+=this.iconv.decode(t.slice(n),"ascii");return this.inBase64=i,this.base64Accum=o,r},p.prototype.end=function(){var t="";return this.inBase64&&this.base64Accum.length>0&&(t=this.iconv.decode(e.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",t},$n}var Fn,qn,Nn,jn,Un,Vn={};function Gn(){if(Fn)return Vn;Fn=1;var e=bn().Buffer;function t(t,r){if(!t)throw new Error("SBCS codec is called without the data.");if(!t.chars||128!==t.chars.length&&256!==t.chars.length)throw new Error("Encoding '"+t.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===t.chars.length){for(var n="",i=0;i<128;i++)n+=String.fromCharCode(i);t.chars=n+t.chars}this.decodeBuf=e.from(t.chars,"ucs2");var o=e.alloc(65536,r.defaultCharSingleByte.charCodeAt(0));for(i=0;i<t.chars.length;i++)o[t.chars.charCodeAt(i)]=i;this.encodeBuf=o}function r(e,t){this.encodeBuf=t.encodeBuf}function n(e,t){this.decodeBuf=t.decodeBuf}return Vn._sbcs=t,t.prototype.encoder=r,t.prototype.decoder=n,r.prototype.write=function(t){for(var r=e.alloc(t.length),n=0;n<t.length;n++)r[n]=this.encodeBuf[t.charCodeAt(n)];return r},r.prototype.end=function(){},n.prototype.write=function(t){for(var r=this.decodeBuf,n=e.alloc(2*t.length),i=0,o=0,a=0;a<t.length;a++)i=2*t[a],n[o=2*a]=r[i],n[o+1]=r[i+1];return n.toString("ucs2")},n.prototype.end=function(){},Vn}var Wn,Hn={};function Zn(){if(Wn)return Hn;Wn=1;var e=bn().Buffer;Hn._dbcs=s;for(var t=-1,r=-2,n=-10,i=-1e3,o=new Array(256),a=0;a<256;a++)o[a]=t;function s(e,n){if(this.encodingName=e.encodingName,!e)throw new Error("DBCS codec is called without the data.");if(!e.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var a=e.table();this.decodeTables=[],this.decodeTables[0]=o.slice(0),this.decodeTableSeq=[];for(var s=0;s<a.length;s++)this._addDecodeChunk(a[s]);if("function"==typeof e.gb18030){this.gb18030=e.gb18030();var l=this.decodeTables.length;this.decodeTables.push(o.slice(0));var c=this.decodeTables.length;this.decodeTables.push(o.slice(0));var u=this.decodeTables[0];for(s=129;s<=254;s++)for(var h=this.decodeTables[i-u[s]],d=48;d<=57;d++){if(h[d]===t)h[d]=i-l;else if(h[d]>i)throw new Error("gb18030 decode tables conflict at byte 2");for(var p=this.decodeTables[i-h[d]],f=129;f<=254;f++){if(p[f]===t)p[f]=i-c;else{if(p[f]===i-c)continue;if(p[f]>i)throw new Error("gb18030 decode tables conflict at byte 3")}for(var m=this.decodeTables[i-p[f]],g=48;g<=57;g++)m[g]===t&&(m[g]=r)}}}this.defaultCharUnicode=n.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var y={};if(e.encodeSkipVals)for(s=0;s<e.encodeSkipVals.length;s++){var _=e.encodeSkipVals[s];if("number"==typeof _)y[_]=!0;else for(d=_.from;d<=_.to;d++)y[d]=!0}if(this._fillEncodeTable(0,0,y),e.encodeAdd)for(var v in e.encodeAdd)Object.prototype.hasOwnProperty.call(e.encodeAdd,v)&&this._setEncodeChar(v.charCodeAt(0),e.encodeAdd[v]);this.defCharSB=this.encodeTable[0][n.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===t&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===t&&(this.defCharSB="?".charCodeAt(0))}function l(e,t){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=t.encodeTable,this.encodeTableSeq=t.encodeTableSeq,this.defaultCharSingleByte=t.defCharSB,this.gb18030=t.gb18030}function c(e,t){this.nodeIdx=0,this.prevBytes=[],this.decodeTables=t.decodeTables,this.decodeTableSeq=t.decodeTableSeq,this.defaultCharUnicode=t.defaultCharUnicode,this.gb18030=t.gb18030}function u(e,t){if(e[0]>t)return-1;for(var r=0,n=e.length;r<n-1;){var i=r+(n-r+1>>1);e[i]<=t?r=i:n=i}return r}return s.prototype.encoder=l,s.prototype.decoder=c,s.prototype._getDecodeTrieNode=function(e){for(var r=[];e>0;e>>>=8)r.push(255&e);0==r.length&&r.push(0);for(var n=this.decodeTables[0],a=r.length-1;a>0;a--){var s=n[r[a]];if(s==t)n[r[a]]=i-this.decodeTables.length,this.decodeTables.push(n=o.slice(0));else{if(!(s<=i))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+e.toString(16));n=this.decodeTables[i-s]}}return n},s.prototype._addDecodeChunk=function(e){var t=parseInt(e[0],16),r=this._getDecodeTrieNode(t);t&=255;for(var i=1;i<e.length;i++){var o=e[i];if("string"==typeof o)for(var a=0;a<o.length;){var s=o.charCodeAt(a++);if(s>=55296&&s<56320){var l=o.charCodeAt(a++);if(!(l>=56320&&l<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+e[0]);r[t++]=65536+1024*(s-55296)+(l-56320)}else if(s>4080&&s<=4095){for(var c=4095-s+2,u=[],h=0;h<c;h++)u.push(o.charCodeAt(a++));r[t++]=n-this.decodeTableSeq.length,this.decodeTableSeq.push(u)}else r[t++]=s}else{if("number"!=typeof o)throw new Error("Incorrect type '"+typeof o+"' given in "+this.encodingName+" at chunk "+e[0]);var d=r[t-1]+1;for(a=0;a<o;a++)r[t++]=d++}}if(t>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+e[0]+": too long"+t)},s.prototype._getEncodeBucket=function(e){var t=e>>8;return void 0===this.encodeTable[t]&&(this.encodeTable[t]=o.slice(0)),this.encodeTable[t]},s.prototype._setEncodeChar=function(e,r){var i=this._getEncodeBucket(e),o=255&e;i[o]<=n?this.encodeTableSeq[n-i[o]][-1]=r:i[o]==t&&(i[o]=r)},s.prototype._setEncodeSequence=function(e,r){var i,o=e[0],a=this._getEncodeBucket(o),s=255&o;a[s]<=n?i=this.encodeTableSeq[n-a[s]]:(i={},a[s]!==t&&(i[-1]=a[s]),a[s]=n-this.encodeTableSeq.length,this.encodeTableSeq.push(i));for(var l=1;l<e.length-1;l++){var c=i[o];"object"==typeof c?i=c:(i=i[o]={},void 0!==c&&(i[-1]=c))}i[o=e[e.length-1]]=r},s.prototype._fillEncodeTable=function(e,t,r){for(var o=this.decodeTables[e],a=!1,s={},l=0;l<256;l++){var c=o[l],u=t+l;if(!r[u])if(c>=0)this._setEncodeChar(c,u),a=!0;else if(c<=i){var h=i-c;if(!s[h]){var d=u<<8>>>0;this._fillEncodeTable(h,d,r)?a=!0:s[h]=!0}}else c<=n&&(this._setEncodeSequence(this.decodeTableSeq[n-c],u),a=!0)}return a},l.prototype.write=function(r){for(var i=e.alloc(r.length*(this.gb18030?4:3)),o=this.leadSurrogate,a=this.seqObj,s=-1,l=0,c=0;;){if(-1===s){if(l==r.length)break;var h=r.charCodeAt(l++)}else{h=s;s=-1}if(h>=55296&&h<57344)if(h<56320){if(-1===o){o=h;continue}o=h,h=t}else-1!==o?(h=65536+1024*(o-55296)+(h-56320),o=-1):h=t;else-1!==o&&(s=h,h=t,o=-1);var d=t;if(void 0!==a&&h!=t){var p=a[h];if("object"==typeof p){a=p;continue}"number"==typeof p?d=p:null==p&&void 0!==(p=a[-1])&&(d=p,s=h),a=void 0}else if(h>=0){var f=this.encodeTable[h>>8];if(void 0!==f&&(d=f[255&h]),d<=n){a=this.encodeTableSeq[n-d];continue}if(d==t&&this.gb18030){var m=u(this.gb18030.uChars,h);if(-1!=m){d=this.gb18030.gbChars[m]+(h-this.gb18030.uChars[m]);i[c++]=129+Math.floor(d/12600),d%=12600,i[c++]=48+Math.floor(d/1260),d%=1260,i[c++]=129+Math.floor(d/10),d%=10,i[c++]=48+d;continue}}}d===t&&(d=this.defaultCharSingleByte),d<256?i[c++]=d:d<65536?(i[c++]=d>>8,i[c++]=255&d):d<16777216?(i[c++]=d>>16,i[c++]=d>>8&255,i[c++]=255&d):(i[c++]=d>>>24,i[c++]=d>>>16&255,i[c++]=d>>>8&255,i[c++]=255&d)}return this.seqObj=a,this.leadSurrogate=o,i.slice(0,c)},l.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var t=e.alloc(10),r=0;if(this.seqObj){var n=this.seqObj[-1];void 0!==n&&(n<256?t[r++]=n:(t[r++]=n>>8,t[r++]=255&n)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(t[r++]=this.defaultCharSingleByte,this.leadSurrogate=-1),t.slice(0,r)}},l.prototype.findIdx=u,c.prototype.write=function(o){for(var a=e.alloc(2*o.length),s=this.nodeIdx,l=this.prevBytes,c=this.prevBytes.length,h=-this.prevBytes.length,d=0,p=0;d<o.length;d++){var f,m=d>=0?o[d]:l[d+c];if((f=this.decodeTables[s][m])>=0);else if(f===t)f=this.defaultCharUnicode.charCodeAt(0),d=h;else if(f===r){if(d>=3)var g=12600*(o[d-3]-129)+1260*(o[d-2]-48)+10*(o[d-1]-129)+(m-48);else g=12600*(l[d-3+c]-129)+1260*((d-2>=0?o[d-2]:l[d-2+c])-48)+10*((d-1>=0?o[d-1]:l[d-1+c])-129)+(m-48);var y=u(this.gb18030.gbChars,g);f=this.gb18030.uChars[y]+g-this.gb18030.gbChars[y]}else{if(f<=i){s=i-f;continue}if(!(f<=n))throw new Error("iconv-lite internal error: invalid decoding table value "+f+" at "+s+"/"+m);for(var _=this.decodeTableSeq[n-f],v=0;v<_.length-1;v++)f=_[v],a[p++]=255&f,a[p++]=f>>8;f=_[_.length-1]}if(f>=65536){var b=55296|(f-=65536)>>10;a[p++]=255&b,a[p++]=b>>8,f=56320|1023&f}a[p++]=255&f,a[p++]=f>>8,s=0,h=d+1}return this.nodeIdx=s,this.prevBytes=h>=0?Array.prototype.slice.call(o,h):l.slice(h+c).concat(Array.prototype.slice.call(o)),a.slice(0,p).toString("ucs2")},c.prototype.end=function(){for(var e="";this.prevBytes.length>0;){e+=this.defaultCharUnicode;var t=this.prevBytes.slice(1);this.prevBytes=[],this.nodeIdx=0,t.length>0&&(e+=this.write(t))}return this.prevBytes=[],this.nodeIdx=0,e},Hn}var Yn,Xn,Kn,Qn,Jn,ei,ti=[["0","\0",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]],ri=[["0","\0",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]],ni=[["0","\0",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]],ii=[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93],["8135f437",""]],oi={uChars:[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],gbChars:[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189e3]},ai=[["0","\0",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]],si=[["0","\0",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]],li=[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]];var ci=(ei||(ei=1,function(e){var t,r=bn().Buffer,n=function(){if(wn)return En;function e(e,t){this.encoder=e,this.addBOM=!0}function t(e,t){this.decoder=e,this.pass=!1,this.options=t||{}}return wn=1,En.PrependBOM=e,e.prototype.write=function(e){return this.addBOM&&(e="\ufeff"+e,this.addBOM=!1),this.encoder.write(e)},e.prototype.end=function(){return this.encoder.end()},En.StripBOM=t,t.prototype.write=function(e){var t=this.decoder.write(e);return this.pass||!t||("\ufeff"===t[0]&&(t=t.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0),t},t.prototype.end=function(){return this.decoder.end()},En}(),i=Tn(),o=e.exports;o.encodings=null,o.defaultCharUnicode="",o.defaultCharSingleByte="?",o.encode=function(e,t,n){e=""+(e||"");var i=o.getEncoder(t,n),a=i.write(e),s=i.end();return s&&s.length>0?r.concat([a,s]):a},o.decode=function(e,t,n){"string"==typeof e&&(o.skipDecodeWarning||(o.skipDecodeWarning=!0),e=r.from(""+(e||""),"binary"));var i=o.getDecoder(t,n),a=i.write(e),s=i.end();return s?a+s:a},o.encodingExists=function(e){try{return o.getCodec(e),!0}catch(t){return!1}},o.toEncoding=o.encode,o.fromEncoding=o.decode,o._codecDataCache={__proto__:null},o.getCodec=function(e){if(!o.encodings){var t=(Kn||(Kn=1,function(e){for(var t=Tn(),r=[kn(),Rn(),Ln(),zn(),Gn(),Nn?qn:(Nn=1,qn={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},cp720:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}),Un?jn:(Un=1,jn={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}),Zn(),Xn?Yn:(Xn=1,Yn={shiftjis:{type:"_dbcs",table:function(){return ti},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return ri},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return ni}},gbk:{type:"_dbcs",table:function(){return ni.concat(ii)}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return ni.concat(ii)},gb18030:function(){return oi},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return ai}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return si}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return si.concat(li)},encodeSkipVals:[36457,36463,36478,36523,36532,36557,36560,36695,36713,36718,36811,36862,36973,36986,37060,37084,37105,37311,37551,37552,37553,37554,37585,37959,38090,38361,38652,39285,39798,39800,39803,39878,39902,39916,39926,40002,40019,40034,40040,40043,40055,40124,40125,40144,40279,40282,40388,40431,40443,40617,40687,40701,40800,40907,41079,41180,41183,36812,37576,38468,38637,41636,41637,41639,41638,41676,41678]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"})],n=0;n<r.length;n++)t(e,r[n])}(In)),In);o.encodings={__proto__:null},i(o.encodings,t)}for(var r=o._canonicalizeEncoding(e),n={};;){var a=o._codecDataCache[r];if(a)return a;var s=o.encodings[r];switch(typeof s){case"string":r=s;break;case"object":for(var l in s)n[l]=s[l];n.encodingName||(n.encodingName=r),r=s.type;break;case"function":return n.encodingName||(n.encodingName=r),a=new s(n,o),o._codecDataCache[n.encodingName]=a,a;default:throw new Error("Encoding not recognized: '"+e+"' (searched as: '"+r+"')")}}},o._canonicalizeEncoding=function(e){return(""+e).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},o.getEncoder=function(e,t){var r=o.getCodec(e),i=new r.encoder(t,r);return r.bomAware&&t&&t.addBOM&&(i=new n.PrependBOM(i,t)),i},o.getDecoder=function(e,t){var r=o.getCodec(e),i=new r.decoder(t,r);return!r.bomAware||t&&!1===t.stripBOM||(i=new n.StripBOM(i,t)),i},o.enableStreamingAPI=function(e){if(!o.supportsStreams){var t=function(){if(Jn)return Qn;Jn=1;var e=bn().Buffer;return Qn=function(t){var r=t.Transform;function n(e,t){this.conv=e,(t=t||{}).decodeStrings=!1,r.call(this,t)}function i(e,t){this.conv=e,(t=t||{}).encoding=this.encoding="utf8",r.call(this,t)}return n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype._transform=function(e,t,r){if("string"!=typeof e)return r(new Error("Iconv encoding stream needs strings as its input."));try{var n=this.conv.write(e);n&&n.length&&this.push(n),r()}catch(i){r(i)}},n.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t),e()}catch(r){e(r)}},n.prototype.collect=function(t){var r=[];return this.on("error",t),this.on("data",(function(e){r.push(e)})),this.on("end",(function(){t(null,e.concat(r))})),this},i.prototype=Object.create(r.prototype,{constructor:{value:i}}),i.prototype._transform=function(t,r,n){if(!(e.isBuffer(t)||t instanceof Uint8Array))return n(new Error("Iconv decoding stream needs buffers as its input."));try{var i=this.conv.write(t);i&&i.length&&this.push(i,this.encoding),n()}catch(o){n(o)}},i.prototype._flush=function(e){try{var t=this.conv.end();t&&t.length&&this.push(t,this.encoding),e()}catch(r){e(r)}},i.prototype.collect=function(e){var t="";return this.on("error",e),this.on("data",(function(e){t+=e})),this.on("end",(function(){e(null,t)})),this},{IconvLiteEncoderStream:n,IconvLiteDecoderStream:i}}}()(e);o.IconvLiteEncoderStream=t.IconvLiteEncoderStream,o.IconvLiteDecoderStream=t.IconvLiteDecoderStream,o.encodeStream=function(e,t){return new o.IconvLiteEncoderStream(o.getEncoder(e,t),t)},o.decodeStream=function(e,t){return new o.IconvLiteDecoderStream(o.getDecoder(e,t),t)},o.supportsStreams=!0}};try{t=requireStreamBrowserify()}catch(a){}t&&t.Transform?o.enableStreamingAPI(t):o.encodeStream=o.decodeStream=function(){throw new Error("iconv-lite Streaming API is not enabled. Use iconv.enableStreamingAPI(require('stream')); to enable it.")}}(vn)),vn.exports),ui=Tt(ci),hi=function(e){var t=null;if("utf8"!=(e=yi(e)))return null;"undefined"!=typeof TextEncoder&&(t=new TextEncoder(e));return function(r){return t?l.from(t.encode(r).buffer):o.createBuffer(r,e)}}("utf8"),di=function(e){var t=null;if("utf8"!=(e=yi(e)))return null;"undefined"!=typeof TextDecoder&&(t=new TextDecoder(e));return function(r){return t?t.decode(r):r.toString(e)}}("utf8");function pi(){return ui.encodingExists("ascii"),Object.keys(ui.encodings)}function fi(e){for(var t=0,r=e.length;t<r;t++)if(e.charCodeAt(t)>=128)return!1;return!0}function mi(e){return!e||/^utf-?8$/i.test(String(e))}function gi(e){return!(e=yi(e))||/^(win|latin|utf8|ascii|iso88|gb)/.test(e)}function yi(e){return(e||"").toLowerCase().replace(/[_-]/g,"")}function _i(e,t,r,n){return r>=0&&(e=e.slice(r,n)),bi(e,t)}function vi(e,t){return mi(t)?hi(e):ui.encode(e,t)}function bi(e,t){return mi(t)?di(e):ui.decode(e,t)}function wi(e){var t=yi(e);return pi().includes(t)}function xi(e){return 65279==e.charCodeAt(0)&&(e=e.substr(1)),e}var Si=Object.freeze({__proto__:null,bufferToString:_i,decodeString:bi,encodeString:vi,encodingIsAsciiCompat:gi,encodingIsSupported:wi,encodingIsUtf8:mi,getEncodings:pi,printEncodings:function(){var e=pi().filter((function(e){return!/^(_|cs|internal|ibm|isoir|singlebyte|table|[0-9]|l[0-9]|windows)/.test(e)}));e.sort(),b("Supported encodings:\n"+E(e))},standardizeEncodingName:yi,stringIsAscii:fi,stringsAreAscii:function(e){return fi(e.join(""))},trimBOM:xi,validateEncoding:function(e){return wi(e)||_("Unknown encoding:",e,"\nRun the -encodings command see a list of supported encodings"),e}});function Ei(e){var t,r,n={};if(!e)return null;for(t in e)e.hasOwnProperty(t)&&((r=e[t])==e&&delete(r=o.extend({},r))[t],n[t]=r&&r.constructor===Object?Ei(r):r);return n}function Ti(e){var t=null;return o.isString(e)?t="string":o.isNumber(e)?t="number":o.isBoolean(e)?t="boolean":o.isDate(e)?t="date":o.isObject(e)&&(t="object"),t}function Ai(e){var t=function(e){var t,r,n,i={};for(t=0;t<e.length;t++)for(n=Object.keys(e[t]||{}),r=0;r<n.length;r++)i[n[r]]=1+(0|i[n[r]]);return Object.keys(i).filter((function(t){return i[t]<e.length}))}(e);!function(e,t){var r,n,i,o;for(n=0;n<e.length;n++)for(r=e[n]||(e[n]={}),i=0;i<t.length;i++)(o=t[i])in r==!1&&(r[o]=void 0)}(e,t)}function Ci(e,t){for(var r,n=null,i=0,o=t.length;i<o&&!(n=(r=t[i])?Ti(r[e]):null);i++);return n}function Ii(e,t){e.getFields().forEach((function(r){t(r)&&e.deleteField(r)}))}function ki(e){return/^\s*$/.test(e)}function Pi(e,t,r){var n={};return e.map((function(i){var a,s=0;do{a=r&&"ascii"!=r?Ri(i,t,s,r):Mi(i,t,s),s++}while(a in n||i!=a&&o.contains(e,a));return n[a]=!0,a}))}function Mi(e,t,r){var n,i;return t=t||256,r?(1==(i=String(r)).length&&(i="_"+i),n=e.substr(0,t-i.length)+i):n=e.substr(0,t),n}function Ri(e,t,r,n){var i=e+(r?String(r):"");return vi(i,n).length>(t||256)?Ri(e=e.substr(0,e.length-1),t,r,n):i}function Di(e,t){return"ascending"==t&&e.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1})),e}function Oi(e){for(var t=0,r=e?e.length:0;t<r;t++)if(e[t])return e[t];return null}function Li(e,t){var r=Oi(e);return Di(r?Object.keys(r):[],t)}function Bi(e){return $i[e||"multiple"]}var $i={date:function(e){var t=new Date(e);return isNaN(+t)?null:t},string:function(e){return e},number:function(e){var t=Number(e);return"NaN"==e?t=NaN:isNaN(t)&&(t=null),t},object:function(e){var t=null;try{t=JSON.parse(e)}catch(r){}return t},boolean:function(e){var t=null;return"true"==e?t=!0:"false"==e&&(t=!1),t},multiple:function(e){var t=Number(e);return isNaN(t)?e:t}},zi=Object.freeze({__proto__:null,applyFieldOrder:Di,copyRecord:Ei,deleteFields:Ii,fieldListContainsAll:function(e,t){return e.indexOf("*")>-1||0===o.difference(t,e).length},findFieldNames:Li,fixInconsistentFields:Ai,getColumnType:Ci,getFieldValues:function(e,t){return e.map((function(e){return e?e[t]:void 0}))},getFirstNonEmptyRecord:Oi,getInputParser:Bi,getUniqFieldNames:Pi,getUniqFieldValues:function(e,t){var r={},n=[];return e.forEach((function(e){var i=e[t];i in r==!1&&(r[i]=!0,n.push(i))})),n},getValueType:Ti,isInvalidFieldName:ki,parseUnknownType:function(e){var t=Bi("number")(e);return null!==t||null!==(t=Bi("object")(e))?t:e}});function Fi(e){var t;if(o.isArray(e))t=e;else if(t=[],o.isInteger(e))for(var r=0;r<e;r++)t.push({});else e&&y("Invalid DataTable constructor argument:",e);this.getRecords=function(){return t},this.getReadOnlyRecordAt=function(e){return Ei(t[e])}}function qi(e,t){for(var r=t.getSimpleShapeBounds(e).toArray(),n=t.getShapeIter(e),i=0;n.hasNext();){if(n.x!=r[0]&&n.x!=r[2]||n.y!=r[1]&&n.y!=r[3])return!1;i++}return!(i<5)&&(r[2]>r[0]!=!1&&r[3]>r[1]!=!1)}function Ni(e){return[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]]}Fi.prototype={fieldExists:function(e){return o.contains(this.getFields(),e)},toString:function(){return JSON.stringify(this)},toJSON:function(){return this.getRecords()},addField:function(e,t){var r=o.isFunction(t);o.isNumber(t)||o.isString(t)||r||y("DataTable#addField() requires a string, number or function for initialization"),this.fieldExists(e)&&y("DataTable#addField() tried to add a field that already exists:",e),this.getRecords().forEach((function(n,i){n[e]=r?t(n,i):t}))},getRecordAt:function(e){return this.getRecords()[e]},addIdField:function(){this.addField("FID",(function(e,t){return t}))},deleteField:function(e){this.getRecords().forEach((function(t){delete t[e]}))},getFields:function(){return Li(this.getRecords())},isEmpty:function(){return 0===this.getFields().length||0===this.size()},update:function(e){for(var t=this.getRecords(),r=0,n=t.length;r<n;r++)t[r]=e(t[r],r)},clone:function(){return new Fi(this.getRecords().map(Ei))},size:function(){return this.getRecords().length}};var ji=Object.freeze({__proto__:null,bboxToCoords:Ni,pathIsRectangle:qi});function Ui(e){var t=e.data;return t||(t=e.data=new Fi(e.shapes?e.shapes.length:0)),t}function Vi(e){return Gi(e)||Wi(e)}function Gi(e){return("polygon"==e.geometry_type||"polyline"==e.geometry_type)&&Yi(e)}function Wi(e){return"point"==e.geometry_type&&Yi(e)}function Hi(e,t){return Zi(e,t)&&1==e.shapes.length}function Zi(e,t){return!!Gi(e)&&(!(ho(e)>0)&&e.shapes.every((function(e){return!e||qi(e[0],t)})))}function Yi(e){return o.some(e.shapes||[],(function(e){return!!e}))}function Xi(e,t){Wi(e)&&ln(e.shapes,(function(e){var r=t(e[0],e[1]);e[0]=r[0],e[1]=r[1]}))}function Ki(e){var t=0;return e.data?t=e.data.size():e.shapes&&(t=e.shapes.length),t}function Qi(e){return 0==Ki(e)}function Ji(e,t,r){var n=e.fieldExists?e:e.data;t||_("Missing a field parameter"),n&&n.fieldExists(t)||_(r||"Missing a field named:",t)}function eo(e,t,r){var n;return r&&o.isString(r)?n=r:(n=t+", ",e&&e.geometry_type?n+="received a "+e.geometry_type+" layer":n+="received a layer with no geometry"),n}function to(e,t){e&&"point"===e.geometry_type||_(eo(e,"Expected a point layer",t))}function ro(e,t){to(e),ho(e)>0&&_(t||"This command requires single points; layer contains multi-point features.")}function no(e,t){e&&"polyline"===e.geometry_type||_(eo(e,"Expected a polyline layer",t))}function io(e,t){e&&"polygon"===e.geometry_type||_(eo(e,"Expected a polygon layer",t))}function oo(e,t){var r=t.info&&t.info.input_files;return r&&r[0]||""}function ao(e,t,r){return o.uniq(r).map((function(n){for(var i,o=[],a=[],s=0,l=0,c=e.length;l<c;l++)r[l]==n&&(n&&a.push(e[l]),i=t[l],o.push(i),i||s++);return{geometry_type:n,shapes:a,data:s<o.length?new Fi(o):null}}))}function so(e,t){return t&&t.no_replace?{geometry_type:e.geometry_type}:e}function lo(e,t,r,n){(n=n||{}).name?e.name=n.name:n.no_replace?e.name=r||void 0:e.name=t&&t.name||r||void 0}function co(e){var t=uo(e);return t.data&&(t.data=t.data.clone()),t}function uo(e){var t=o.extend({},e);return e.shapes&&(t.shapes=hn(e.shapes)),t}function ho(e){for(var t=0,r=0,n=e.length;r<n;r++)e[r]&&e[r].length>1&&t++;return t}function po(e,t){var r=fo(e,t);return function(e){return r[or(e)]>0}}function fo(e,t){var r=new Uint32Array(t.size());return e.filter(Gi).forEach((function(e){hr(e.shapes,r)})),r}function mo(e,t){var r=null;return"point"==e.geometry_type?r=on(e.shapes):"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type||(r=dr(e.shapes,t)),r}function go(e){e.data=new Fi(Ki(e))}var yo=Object.freeze({__proto__:null,copyLayer:co,copyLayerShapes:uo,countArcsInLayers:fo,countMultiPartFeatures:ho,deleteFeatureById:function(e,t){e.shapes&&e.shapes.splice(t,1),e.data&&e.data.getRecords().splice(t,1)},divideFeaturesByType:ao,filterPathLayerByArcIds:function(e,t){var r=t.reduce((function(e,t){return e[t]=!0,e}),{}),n=hn(e.shapes);return pn(n,(function(e){for(var t=0;t<e.length;t++)if(or(e[t])in r)return null;return e})),o.defaults({shapes:n},e)},getArcPresenceTest2:po,getFeatureCount:Ki,getLayerBounds:mo,getLayerDataTable:Ui,getLayerSourceFile:oo,getOutputLayer:so,initDataTable:go,insertFieldValues:function(e,t,r){for(var n,i,o=Ki(e)||r.length,a=(e.data=e.data||new Fi(o)).getRecords(),s=0,l=a.length;s<l;s++)n=a[s],i=r[s],n||(n=a[s]={}),n[t]=void 0===i?null:i},isolateLayer:function(e,t){return o.defaults({layers:t.layers.filter((function(t){return t==e}))},t)},layerHasAttributeData:function(e){return e.data&&e.data.getFields().length>0},layerHasGeometry:Vi,layerHasNonNullData:function(e){return!(!e.data||!Oi(e.data.getRecords()))},layerHasNonNullShapes:Yi,layerHasPaths:Gi,layerHasPoints:Wi,layerIsEmpty:Qi,layerIsGeometric:function(e){return!!e.geometry_type},layerIsRectangle:Hi,layerOnlyHasRectangles:Zi,layerTypeMessage:eo,requireDataField:Ji,requireDataFields:function(e,t){if(t&&t.length){e||_("Missing attribute data");var r=e.getFields(),n=o.difference(t,r);n.length>0&&_("Table is missing one or more fields:\n",n,"\nExisting fields:","\n"+E(r))}},requirePathLayer:function(e,t){e&&Gi(e)||_(eo(e,"Expected a polygon or polyline layer",t))},requirePointLayer:to,requirePolygonLayer:io,requirePolylineLayer:no,requireSinglePointLayer:ro,setOutputLayerName:lo,transformPointsInLayer:Xi});function _o(e){var t=new ArrayBuffer(16),r=new Float64Array(t),n=new Uint32Array(t),i=0|e;if(i>0==!1)throw new Error("Invalid size param: "+e);return function(e,t){var o,a=n;return r[0]=e,r[1]=t,(2147483647&(o=(o=a[0]^a[1])<<5^o>>7^a[2]^a[3]))%i}}function vo(e){var t=Math.floor(.25*e+1),r=_o(t),n=new Int32Array(t),i=[],a=[],s=0;function l(e,t,o,s,l){for(var c,u,h,d=l(o),p=r(e[o],t[o]),f=n[p];-1!=f;){if(c=a[f][0],u=a[f][1],h=c.length,c[0]===e[s]&&c[h-1]===e[o]&&c[h-2]===e[d]&&u[0]===t[s]&&u[h-1]===t[o]&&u[h-2]===t[d])return f;f=i[f]}return null}o.initializeArray(n,-1),this.addArc=function(e,t){var o=e.length-1,l=r(e[o],t[o]),c=n[l],u=a.length;return n[l]=u,a.push([e,t]),s+=e.length,i.push(c),u},this.findDuplicateArc=function(e,t,r,n,i,o){var a=l(e,t,r,n,i);return a=null===a?l(e,t,n,r,o):~a},this.getVertexData=function(){for(var e,t,r=new Float64Array(s),n=new Float64Array(s),i=new Uint32Array(a.length),l=0,c=0,u=a.length;c<u;c++)t=(e=a[c])[0].length,o.copyElements(e[0],0,r,l,t),o.copyElements(e[1],0,n,l,t),i[c]=t,l+=t;return{xx:r,yy:n,nn:i}}}function bo(e,t){for(var r,n,i,o,a=function(e,t){var r,n,i,o,a,s=e.length,l=Math.floor(1.3*s)||1,c=_o(l),u=new Int32Array(l),h=new Int32Array(s);for(i=0;i<s;i++)o=e[i],a=t[i],o!=o||a!=a?n=-1:(n=u[r=c(o,a)]-1,u[r]=i+1),h[i]=n>=0?n:i;return h}(e,t),s=e.length-1;s>=0;s--)if(!((n=a[s])>=s)){i=s,o=-1;do{n=a[r=n],t[r]==t[s]&&e[r]==e[s]?(a[r]=i,i=r):(o>-1&&(a[o]=r),o=r)}while(n<r);o>-1&&(a[o]=o),a[s]=i}return a}function wo(e){if(e.arcs){var t=e.arcs.getVertexData(),r=xo(t.nn,t.xx,t.yy);e.arcs.updateVertexData(r.nn,r.xx,r.yy),e.layers.forEach((function(e){"polyline"!=e.geometry_type&&"polygon"!=e.geometry_type||(e.shapes=function(e,t){return e.map((function(e){return r(e,t)}));function r(e,t){return e?e.map((function(e){return n(e,t)})):null}function n(e,t){return e.reduce((function(e,r){var n=or(r),i=t[n];if(i){r<0&&pr(i=i.concat());for(var o=0,a=i.length;o<a;o++)e.push(i[o])}return e}),[])}}(e.shapes,r.paths))}))}}function xo(e,t,r){var n,i,o=t.length,a=bo(t,r),s=function(e,t){for(var r=new Int32Array(e),n=0,i=0,o=t.length;i<o;i++)for(var a=0,s=t[i];a<s;a++,n++)r[n]=i;return r}(o,e),l=new vo(o),c=u()?t.subarray:Array.prototype.slice;return n=function(e){for(var t,r=[],n=0,i=0,o=e.length;i<o;i++)t=e[i],r.push(t<2?null:f(n,n+t-1)),n+=t;return r}(e),(i=l.getVertexData()).paths=n,i;function u(){return!(!t.subarray||!r.subarray)}function h(t){var r=s[t],n=t+1;if(n<o&&s[n]===r)return t+1;var i=e[r];return p(t,t-i+1)?t-i+2:-1}function d(t){var r=s[t],n=t-1;if(n>=0&&s[n]===r)return t-1;var i=e[r];return p(t,t+i-1)?t+i-2:-1}function p(e,n){return t[e]==t[n]&&r[e]==r[n]}function f(n,i){for(var o,c=[],u=-1,p=n;p<i;p++)m(p)&&(u>-1?c.push(v(o,p)):u=p,o=p);return-1==u?c.push(function(n,i){var o,c=a[n],u=s[n];for(;c!=n&&!(s[c]<u);)c=a[c];if(c==n)return v(n,i);for(var p=n;p<i;p++)if(null!==(o=l.findDuplicateArc(t,r,p,p,h,d)))return o;y("Unmatched ring; id:",u,"len:",e[u])}(n,i)):u==n?(m(i)||y("Topology error"),c.push(v(o,p))):c.push(function(e,n,i,o){var a=l.findDuplicateArc(t,r,e,o,h,d);null===a&&(a=l.addArc(_(t,e,n,i,o),_(r,e,n,i,o)));return a}(o,i,n+1,u)),c}function m(e){var t,r,n=a[e],i=d(e),o=h(e);if(-1==i||-1==o)return!0;for(;e!=n;){if(t=d(n),r=h(n),-1==t||-1==r||g(i,o,t,r))return!0;n=a[n]}return!1}function g(e,n,i,o){var a=t[e],s=t[n],l=t[i],c=t[o],u=r[e],h=r[n],d=r[i],p=r[o];return!(a==c&&s==l&&u==p&&h==d||a==l&&s==c&&u==d&&h==p)}function _(e,t,r,n,i){var o,a=r-t+i-n+2,s=new(u()?Float64Array:Array)(a),l=0;for(o=t;o<=r;o++)s[l++]=e[o];for(o=n;o<=i;o++)s[l++]=e[o];return s}function v(e,n){var i=l.findDuplicateArc(t,r,e,n,h,d);return null===i&&(i=l.addArc(c.call(t,e,n+1),c.call(r,e,n+1))),i}}var So=Object.freeze({__proto__:null,buildPathTopology:xo,buildTopology:wo});function Eo(e,t){var r=new Uint8Array(t.size());function n(e){dn(e,i)}function i(e){o(~e[0]),o(e[e.length-1])}function o(e){var t=or(e),n=t==e;r[t]|=n?1:2}return e.forEach((function(e){Gi(e)&&e.shapes.forEach(n)})),function(e){var t=or(e),n=t==e,i=r[t];return n?!(1&~i):!(2&~i)}}var To=Object.freeze({__proto__:null,getPathEndpointTest:Eo});function Ao(e){var t=e.length,r=0,n={x:0,y:0,hasNext:function(){return!(r>=t)&&(n.x=e[r][0],n.y=e[r][1],r++,!0)}};return n}function Co(e,t){this._i=0,this._n=0,this._inc=1,this._xx=e,this._yy=t,this.i=0,this.x=0,this.y=0}function Io(e,t,r){var n=0,i=0,o=1,a=0;this.init=function(e,t,r,s){return n=s||0,r?(i=e,o=1,a=e+t):(i=e+t-1,o=-1,a=e-1),this},this.hasNext=function(){var s=r,l=i,c=l,u=n,h=a,d=o;if(l==h)return!1;do{c+=d}while(c!=h&&s[c]<u);return i=c,this.x=e[l],this.y=t[l],this.i=l,!0}}function ko(e){this._arcs=e,this._i=0,this._n=0,this.x=0,this.y=0}Co.prototype.init=function(e,t,r){return r?(this._i=e,this._inc=1):(this._i=e+t-1,this._inc=-1),this._n=t,this},Co.prototype.hasNext=function(){var e=this._i;return this._n>0&&(this._i=e+this._inc,this.x=this._xx[e],this.y=this._yy[e],this.i=e,this._n--,!0)},ko.prototype.hasNext=function(){var e=this._arc;return this._i<this._n!=!1&&(e.hasNext()?(this.x=e.x,this.y=e.y,!0):(this.nextArc(),this.hasNext()))},ko.prototype.init=function(e){return this._ids=e,this._n=e.length,this.reset(),this},ko.prototype.nextArc=function(){var e=this._i+1;e<this._n&&(this._arc=this._arcs.getArcIter(this._ids[e]),e>0&&this._arc.hasNext()),this._i=e},ko.prototype.reset=function(){this._i=-1,this.nextArc()};var Po=Object.freeze({__proto__:null,ArcIter:Co,FilteredArcIter:Io,MultiShapeIter:function(e){},PointIter:Ao,ShapeIter:ko});function Mo(e,t){return 0===t||e>=1?0:e<=0?t+1:Math.floor((1-e)*(t+2))}function Ro(e,t,r){var n=t.getRemovableThresholds(r),i=Mo(e,n.length);return i<1?0:i>n.length?1/0:o.findValueByRank(n,i)}var Do=Object.freeze({__proto__:null,getThresholdByPct:Ro,getThresholdFunction:function(e){var t=e.getPointCount(),r=Math.ceil(t/5e5),n=e.getRemovableThresholds(r);return o.quicksort(n,!0),function(e){var t=n.length,r=Mo(e,n.length);return r<1?0:r>t?1/0:n[r-1]}}});function Oo(){var e,t,r,n,i,a,s,l,c,u=0;function h(e){var t=[],r=[];d(e.map((function(e){for(var n=e?e.length:0,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return n})),t,r)}function d(o,a,s){var h=o.length;o instanceof Array&&(o=new Uint32Array(o)),a instanceof Array&&(a=new Float64Array(a)),s instanceof Array&&(s=new Float64Array(s)),e=a,t=s,n=o,i=null,u=0,c=null,r=new Uint32Array(h);for(var d=0,p=0;p<h;p++)r[p]=d,d+=o[p];return d==e.length&&e.length==t.length||y("ArcCollection#initXYData() Counting error"),f(),l=new Co(e,t),this}function p(r){r?(r.length!=e.length&&y("ArcCollection#initZData() mismatched arrays"),r instanceof Array&&(r=new Float64Array(r)),c=new Io(e,t,i=r)):(i=null,u=0,c=null)}function f(){var e=n.length;a=new Float64Array(4*e),s=new St;for(var t=0;t<e;t++)m(t)}function m(i){var o=n[i],l=r[i],c=4*i,u=function(e,t,r,n){var i,o,a,s,l,c,u=0|r,h=isNaN(n)?e.length-u:n+u;for(h>0&&(a=l=e[u],s=c=t[u]),u++;u<h;u++)(i=e[u])<a&&(a=i),i>l&&(l=i),(o=t[u])<s&&(s=o),o>c&&(c=o);return[a,s,l,c]}(e,t,l,o);a[c++]=u[0],a[c++]=u[1],a[c++]=u[2],a[c]=u[3],s.mergeBounds(u)}function g(){return{xx:e,yy:t,zz:i,bb:a,nn:n,ii:r}}function _(){return function(e,t){e.zz||y("Expected simplification data");for(var r,n=e.xx,i=e.yy,o=e.zz,a=sr(o,t),s=e.nn.length,l=new Float64Array(a),c=new Float64Array(a),u=new Float64Array(a),h=new Int32Array(s),d=0,p=0,f=0;f<s;f++){r=0;for(var m=d+e.nn[f];d<m;d++)o[d]>=t&&(l[p]=n[d],c[p]=i[d],u[p]=o[d],p++,r++);1==r&&y("Collapsed arc"),h[f]=r}return{xx:l,yy:c,zz:u,nn:h}}(g(),u)}1==arguments.length?h(arguments[0]):3==arguments.length?d.apply(this,arguments):0===arguments.length?h([]):y("ArcCollection() Invalid arguments"),this.updateArcBounds=function(e){m(e)},this.updateVertexData=function(e,t,r,n){d(e,t,r),p(n||null)},this.getCopy=function(){var r=new Oo(new Int32Array(n),new Float64Array(e),new Float64Array(t));return i&&(r.setThresholds(new Float64Array(i)),r.setRetainedInterval(u)),r},this.getVertexData=g,this.getFilteredCopy=function(){if(!i||0===u)return this.getCopy();var e=_(),t=new Oo(e.nn,e.xx,e.yy);return t.setThresholds(e.zz),t},this.toArray=function(){var e=[];return this.forEach((function(t){for(var r=[];t.hasNext();)r.push([t.x,t.y]);e.push(r)})),e},this.toJSON=function(){return this.toArray()},this.forEachArcSegment=function(o,a){for(var s=o>=0,l=s?o:~o,c=this.getRetainedInterval(),u=n[l],h=s?1:-1,d=s?r[l]:r[l]+u-1,p=d,f=e,m=t,g=i,y=0,_=1;_<u;_++)p+=h,(0===c||g[p]>=c)&&(a(d,p,f,m),d=p,y++);return y},this.forEachSegment=function(e){for(var t=0,r=0,n=this.size();r<n;r++)t+=this.forEachArcSegment(r,e);return t},this.transformPoints=function(r){for(var i,o=e,a=t,s=-1,l=0,c=0,u=o.length;c<u;c++,l--){for(;0===l;)l=n[++s];(i=r(o[c],a[c],s))&&(o[c]=i[0],a[c]=i[1])}f()},this.forEach=function(e){for(var t=0,r=this.size();t<r;t++)e(this.getArcIter(t),t)},this.forEach2=function(o){for(var a=0,s=this.size();a<s;a++)o(r[a],n[a],e,t,i,a)},this.forEach3=function(o){for(var a,s,l,c,u,h=0,d=this.size();h<d;h++)s=(a=r[h])+n[h],l=e.subarray(a,s),c=t.subarray(a,s),i&&(u=i.subarray(a,s)),o(l,c,u,h)},this.filter=function(e){var t=function(t){return e(this.getArcIter(t),t)}.bind(this);return this.deleteArcs(t)},this.deleteArcs=function(a){for(var s=this.size(),l=new Int32Array(s),c=0,u=0;u<s;u++)a(u)?(l[u]=c++,n[u]):l[u]=-1;return c<s&&function(a){for(var s,l,c=0,u=0,h=o.copyElements,f=0,m=a.length;f<m;f++)s=a[f],l=n[f],s>-1&&(h(e,r[f],e,c,l),h(t,r[f],t,c,l),i&&h(i,r[f],i,c,l),n[s]=l,c+=l,u++);d(n.subarray(0,u),e.subarray(0,c),t.subarray(0,c)),i&&p(i.subarray(0,c))}(l),l},this.dedupCoords=function(){for(var r,o,a=0,s=0,l=0,c=this.size(),u=i;a<c;)o=Lo(s,l,r=n[a],e,t,u),n[a]=o,s+=r,l+=o,a++;return s>l&&(d(n,e.subarray(0,l),t.subarray(0,l)),u&&p(u.subarray(0,l))),s-l},this.getVertex=function(r,n){var i=this.indexOfVertex(r,n);return{x:e[i],y:t[i]}},this.getVertex2=function(r){return[e[r],t[r]]},this.indexOfVertex=function(e,t){var i=e<0?~e:e,o=n[i];return t<0&&(t=o+t),i!=e&&(t=o-t-1),(t<0||t>=o)&&y("[ArcCollection] out-of-range vertex id"),r[i]+t},this.arcIsClosed=function(r){var n=this.indexOfVertex(r,0),i=this.indexOfVertex(r,-1);return n!=i&&e[n]==e[i]&&t[n]==t[i]},this.arcIsLollipop=function(r){var n,i;return!(this.getArcLength(r)<=2||!this.arcIsClosed(r))&&(n=this.indexOfVertex(r,1),i=this.indexOfVertex(r,-2),e[n]==e[i]&&t[n]==t[i])},this.arcIsDegenerate=function(e){for(var t,r,n=this.getArcIter(e),i=0;n.hasNext();){if(i>0&&(t!=n.x||r!=n.y))return!1;t=n.x,r=n.y,i++}return!0},this.getArcLength=function(e){return n[or(e)]},this.getArcIter=function(e){var t=e>=0,o=t?e:~e,a=i&&u?c:l;return o>=n.length&&y("#getArcId() out-of-range arc id:",e),a.init(r[o],n[o],t,u)},this.getShapeIter=function(e){return new ko(this).init(e)},this.setThresholds=function(e){var t=this.getPointCount(),r=null;return e&&(e.length==t?r=e:e.length==this.size()?r=function(e,t){var r=new Float64Array(t),n=0;e.forEach((function(e){for(var t=0,i=e.length;t<i;n++,t++)r[n]=e[t]})),n!=t&&y("Mismatched thresholds");return r}(e,t):y("Invalid threshold data")),p(r),this},this.flatten=function(){if(u>0){var e=_();this.updateVertexData(e.nn,e.xx,e.yy),u=0}else i=null},this.isFlat=function(){return!i},this.getRetainedInterval=function(){return u},this.setRetainedInterval=function(e){return u=e,this},this.getRetainedPct=function(){return this.getPctByThreshold(u)},this.setRetainedPct=function(e){return u=e>=1?0:fr(u=this.getThresholdByPct(e),e),this},this.getRemovableThresholds=function(e){i||y("[arcs] Missing simplification data.");for(var t,r=1|e,n=new Float64Array(Math.ceil(i.length/r)),o=0,a=0,s=this.getPointCount();o<s;o+=r)(t=i[o])!=1/0&&(n[a++]=t);return n.subarray(0,a)},this.getArcThresholds=function(e){e>=0&&e<this.size()||y("[arcs] Invalid arc id:",e);var t=r[e],o=t+n[e];return i.subarray(t,o)},this.getPctByThreshold=function(e,t){var r,n,i;return e>0?(r=this.getRemovableThresholds(t),n=o.findRankByValue(r,e),i=r.length>0?1-(n-1)/r.length:1):i=1,i},this.getThresholdByPct=function(e,t){return Ro(e,this,t)},this.arcIntersectsBBox=function(e,t){var r=a,n=4*e;return r[n]<=t[2]&&r[n+2]>=t[0]&&r[n+3]>=t[1]&&r[n+1]<=t[3]},this.arcIsContained=function(e,t){var r=a,n=4*e;return r[n]>=t[0]&&r[n+2]<=t[2]&&r[n+1]>=t[1]&&r[n+3]<=t[3]},this.arcIsSmaller=function(e,t){var r=a,n=4*e;return r[n+2]-r[n]<t&&r[n+3]-r[n+1]<t},this.isPlanar=function(){return!en(this.getBounds())},this.size=function(){return r&&r.length||0},this.getPointCount=function(){return e&&e.length||0},this.getFilteredPointCount=function(){return i&&u?sr(i,u):this.getPointCount()},this.getBounds=function(){return s.clone()},this.getSimpleShapeBounds=function(e,t){t=t||new St;for(var r=0,n=e.length;r<n;r++)this.mergeArcBounds(e[r],t);return t},this.getSimpleShapeBbox=function(e,t){var r,n=t||[],i=a;n[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var o=0,s=e.length;o<s;o++)i[r=4*or(e[o])]<n[0]&&(n[0]=i[r]),i[++r]<n[1]&&(n[1]=i[r]),i[++r]>n[2]&&(n[2]=i[r]),i[++r]>n[3]&&(n[3]=i[r]);return n[0]==1/0?[]:n},this.getMultiShapeBounds=function(e,t){if(t=t||new St,e)for(var r=0,n=e.length;r<n;r++)this.getSimpleShapeBounds(e[r],t);return t},this.mergeArcBounds=function(e,t){e<0&&(e=~e);var r=4*e;n[e]>0&&t.mergeBounds(a[r],a[r+1],a[r+2],a[r+3])}}function Lo(e,t,r,n,i,o){for(var a,s,l,c,u,h=0,d=0;h<r;)a=n[c=e+h],s=i[c],(u=a==a&&s==s&&(0===d||a!=n[c-1]||s!=i[c-1]))&&(n[l=t+d]=a,i[l]=s,d++),o&&d>0&&(u||o[c]>o[l])&&(o[l]=o[c]),h++;return d>1?d:0}function Bo(e,t){Array.isArray(e)&&(e=new Oo(e));var r,n,i=e.getVertexData(),a=i.nn,s=i.xx,l=i.yy;function c(e){return u(e)?null:[r.xx[e],r.yy[e]]}function u(e){return isNaN(r.xx[e])}function h(e){var t=p(e),n=f(),i=n[t],o=function(e){var t=f(),r=e,n=t[e];for(;n!=e;)r=n,(n=t[n])==r&&y("Node indexing error");return r}(t);r.xx[t]=NaN,r.yy[t]=NaN,n[t]=t,n[o]=i}function d(e){var t=e>>1;return!0&e?t:~t}function p(e){return e>=0?2*e+1:2*~e}function f(){return r||(r=function(e,t){var r=2*e.size(),n=new Float64Array(r),i=new Float64Array(r),o=new Int32Array(r);e.forEach2((function(e,r,a,s,l,c){var u=e,h=e+r-1,d=2*c,p=d+1,f=a[u],m=s[u],g=a[h],y=s[h];t&&!t(c)&&(f=m=g=y=NaN),n[d]=f,i[d]=m,o[d]=c,n[p]=g,i[p]=y,o[p]=c}));var a=bo(n,i);return{xx:n,yy:i,ids:o,chains:a}}(e,t),2*a.length!=r.chains.length&&y("[NodeCollection] count error")),r.chains}function m(e,t){var r=t>=0?t:~t,n=a[e>=0?e:~e];return!(n<2)&&(n==a[r]&&!!(g(e,t,-1)&&g(e,t,1)&&g(e,t,-2)))}function g(t,r,n){var i=e.indexOfVertex(t,n),o=e.indexOfVertex(r,n);return s[i]==s[o]&&l[i]==l[o]}function _(e){var t=p(e),r=f(),n=r[t];return n>=0&&n<r.length||y("out-of-range chain id"),d(n)}Object.defineProperty(this,"arcs",{value:e}),this.setArcFilter=function(e){n=e},this.toArray=function(){var e=f(),t=new Uint8Array(e.length),r=[];return o.forEach(e,(function(n,i){var o,a;if(1!=t[i]&&(a=c(i)))for(o={coordinates:a,arcs:[]},r.push(o);1!=t[i];)o.arcs.push(d(i)),t[i]=1,i=e[i]})),r},this.size=function(){return this.toArray().length},this.findDanglingEndpoints=function(){for(var e,t=f(),r=[],n=0,i=t.length;n<i;n++)t[n]==n&&(e=c(n))&&r.push({point:e,arc:d(n)});return r},this.detachAcyclicArcs=function(){for(var e,t,r=f(),n=0,i=0,o=r.length;i<o;i+=2)e=i==r[i],t=i+1==r[i+1],!e&&!t||u(i)||(this.detachArc(d(i)),n++);return n>0&&(n+=this.detachAcyclicArcs()),n},this.detachArc=function(e){h(e),h(~e)},this.forEachConnectedArc=function(e,t){for(var r=_(e),n=0;r!=e;)t(r,n++),r=_(r)},this.getConnectedArcs=function(e,t){var r=[],i=_(e);if(n&&!n(e))return[];for(;i!=e;)t&&!t(i)||n&&!n(i)||r.push(i),i=_(i);return r},this.findDuplicateArc=function(e){for(var t=_(e),r=e;t!=e;)m(e,t)&&or(t)<or(r)&&(r=t),t=_(t);return r},this.internal={testArcMatch:m,testVertexMatch:g}}function $o(e){var t=e.arcs,r=e.layers.filter(Gi);if(t&&r.length){var n=function(e,t){var r,n,i=new Bo(t,po(e,t)),o=e.filter((function(e){return"polyline"==e.geometry_type})),a=Eo(o,t);return function(e,t){return e==t||e==~t?(w("Unexpected arc sequence:",e,t),!1):(r=0,i.forEachConnectedArc(e,s),1==r&&n==~t&&!a(e)&&!a(~t))};function s(e,t){r++,n=e}}(r,t),i=[],a=0,s=new Int32Array(t.size()),l=new Uint8Array(t.size());r.forEach((function(e){e.shapes=e.shapes.map((function(e){return fn(e&&e.concat(),c)}))})),e.arcs=function(e,t,r){var n=new Uint32Array(t.length),i=new Float64Array(r),a=new Float64Array(r),s=e.getVertexData(),l=s.zz?new Float64Array(r):null,c=e.getRetainedInterval(),u=0;return t.forEach((function(e,t){e.forEach((function(e,r){h(e,t)}))})),new Oo(n,i,a).setThresholds(l).setRetainedInterval(c);function h(e,t){var r=or(e),c=e<0,h=s.nn[r],d=s.ii[r],p=n[t];h>0&&(p>0&&(h--,c||d++),o.copyElements(s.xx,d,i,u,h,c),o.copyElements(s.yy,d,a,u,h,c),l&&o.copyElements(s.zz,d,l,u,h,c),n[t]+=h,u+=h)}}(t,i,a)}else e.arcs=null;function c(e){for(var r,o,c,u,h,d,p=0,f=[],m=0,g=e.length;m<g;m++)h=(o=e[m])===(c=or(o)),t.arcIsDegenerate(o)||(0!==l[c]?r=null:(u=t.getArcLength(o),r&&n(e[m-1],o)?(u>0&&u--,r.push(o),l[c]=1):(r=[o],s[c]=i.length,i.push(r),l[c]=h?2:3),p+=u)),l[c]>1&&(d=s[c],(h&&3==l[c]||!h&&2==l[c])&&(d=~d),f.push(d));return a+=p,f}}function zo(e){return e.layers.map((function(t){var r={arcs:e.arcs,layers:[t],info:o.extend({},e.info)};return $o(r),r}))}function Fo(e){var t=o.extend({},e);return t.layers=t.layers.map(co),t.arcs&&(t.arcs=t.arcs.getFilteredCopy()),t}function qo(e){var t=o.extend({},e);return t.layers=t.layers.map(uo),t.arcs&&(t.arcs=t.arcs.getFilteredCopy()),t}function No(e){return o.defaults({layers:e.layers.map((function(e){return o.extend({},e)}))},e)}function jo(e){var t=new St;return e.layers.forEach((function(r){var n=mo(r,e.arcs);n&&t.mergeBounds(n)})),t}function Uo(e){return e.layers.every((function(e){return Qi(e)}))}function Vo(e){return o.some(e.layers,(function(e){return Vi(e)}))}function Go(e){return o.some(e.layers,(function(e){return Gi(e)}))}function Wo(e){if(e.arcs&&!o.some(e.layers,Gi))return e.arcs=null,!0}function Ho(e,t,r){var n=e.layers.concat();o.repeat(Math.max(t.length,r.length),(function(e){var i=t[e],o=r[e],a=i?n.indexOf(i):n.length;i&&n.splice(a,1),o&&n.splice(a,0,o)})),e.layers=n}function Zo(e,t,r,n){r&&1==r.layers.length||y("Invalid source dataset"),!1===t.layers.includes(e)&&y("Invalid target layer");var i=va(t,[r])[0];return!i.data&&e.data&&Ki(i)==e.data.size()&&(i.data=n.no_replace?e.data.clone():e.data),n.no_replace||(i=Object.assign(e,{data:null,shapes:null},i),Gi(e)&&$o(t)),i.name=n.name||i.name,i}function Yo(e,t){e.arcs&&e.arcs.transformPoints(t),e.layers.forEach((function(e){Wi(e)&&Xi(e,t)}))}var Xo=Object.freeze({__proto__:null,cleanupArcs:Wo,copyDataset:Fo,copyDatasetForExport:qo,copyDatasetForRenaming:No,copyDatasetInfo:function(e){var t=Object.assign({},e);return Array.isArray(e.input_files)&&(t.input_files=e.input_files.concat()),t},datasetHasGeometry:Vo,datasetHasPaths:Go,datasetIsEmpty:Uo,getDatasetBounds:jo,mergeDatasetInfo:function(e,t){var r=t.info||{},n=e.info||(e.info={});n.input_files=o.uniq((n.input_files||[]).concat(r.input_files||[])),n.input_formats=o.uniq((n.input_formats||[]).concat(r.input_formats||[])),o.defaults(n,r)},mergeOutputLayerIntoDataset:Zo,pruneArcs:function(e){Wo(e),e.arcs&&$o(e)},replaceLayerContents:function(e,t,r){Gi(Zo(e,t,r,{}))&&wo(t)},replaceLayers:Ho,splitApartLayers:function(e,t){var r=[];return e.layers=e.layers.filter((function(n){if(!t.includes(n))return!0;var i={arcs:e.arcs,layers:[n],info:o.extend({},e.info)};return $o(i),r.push(i),!1})),e.layers.length&&($o(e),r.push(e)),r},splitDataset:zo,transformPoints:Yo}),Ko=null,Qo={robinson:"+proj=robin +datum=WGS84",webmercator:"+proj=merc +a=6378137 +b=6378137",wgs84:"+proj=longlat +datum=WGS84",albersusa:Dt};function Jo(e,t){var r=[0],n=[0],i=e.is_latlong?Pt.internal.DEG_TO_RAD:1,o=t.is_latlong?Pt.internal.RAD_TO_DEG:1,a=ma(e);return function(s,l){var c;a&&(s<-180?s=-180:s>180&&(s=180)),r[0]=s*i,n[0]=l*i;try{t=t.__mixed_crs||t,Pt.pj_transform(e,t,r,n),c=r[0]==1/0}catch(u){c=!0}return c?null:[r[0]*o,n[0]*o]}}function ea(e,t,r){return ia(t,r)?e.concat():Jo(t,r)(e[0],e[1])}function ta(e){var t,r;try{(t=da(e))&&(r=ra(t))}catch(n){}return r||"[unknown]"}function ra(e){return Pt.internal.get_proj_defn(e)}function na(e){var t;try{t=Pt.internal.wkt_from_proj4(e)}catch(r){}return t}function ia(e,t){var r=ra(e);return!!r&&r==ra(t)}function oa(e){return e in Qo}function aa(e){var t;return sa(e=e.replace(/(^| )([\w]+)($| )/,(function(e,t,r,n){return r in Pt.internal.pj_list?t+"+proj="+r+n:e})))?t=e:oa(e)?(t=Qo[e],o.isFunction(t)&&(t=t())):t=function(e){return/^(esri|epsg|nad83|nad27):[0-9]+$/i.test(String(e))}(e)?"+init="+e.toLowerCase():e in(u("defs")||{})?u("defs")[e]:Rt(e),t||_("Unknown projection definition:",e),t}function sa(e){return/^(\+[^ ]+ *)+$/.test(e)}function la(e){return{crs_string:e,crs:ca(e)}}function ca(e){var t,r=aa(e);if(o.isString(r))try{t=Pt.pj_init(r)}catch(n){_("Unable to use projection",r,"("+n.message+")")}else t=r;return t||null}function ua(e,t){return t=t||{},e.info=e.info||{},e.info.crs=t.crs,e.info.prj=t.prj,e.info.crs_string=t.crs_string,e}function ha(e){var t=e.info||{},r=t.crs,n=t.crs_string;return!r&&t.prj&&(r=ca(ga(t.prj))),r||en(jo(e))&&(r=ca(n="wgs84")),{crs:r||null,crs_string:n,prj:t.prj}}function da(e){return ha(e).crs}function pa(e,t){e.reduce((function(e,r){var n=da(r);return e&&n&&ma(e)!=ma(n)&&_(t||"Unable to combine projected and unprojected datasets"),n||e}),null)}function fa(e){return!ma(e)}function ma(e){return e&&e.is_latlong||!1}function ga(e){var t;try{t=Pt.internal.wkt_to_proj4(e)}catch(r){_("Unusable .prj file ("+r.message+")")}return t}function ya(e){return ca(ga(e))}var _a=Object.freeze({__proto__:null,crsAreEqual:ia,crsToPrj:na,crsToProj4:ra,findProjLibs:function(e){var t=e.match(/\b(esri|epsg|nad83|nad27)(?=:[0-9]+\b)/gi)||[];return o.uniq(t.map((function(e){return e.toLowerCase()})))},getCrsInfo:la,getDatasetCRS:da,getDatasetCrsInfo:ha,getProjDefn:aa,getProjInfo:ta,getProjTransform:function(e,t){var r=ma(e);return t=t.__mixed_crs||t,function(n,i){var o;return r&&(n<-180?n=-180:n>180&&(n=180)),o=[n,i],Pt.pj_transform_point(e,t,o),o}},getProjTransform2:Jo,getScaleFactorAtXY:function(e,t,r){var n=1/r.to_meter,i=Pt.pj_inv_deg({x:e,y:t},r),o=Pt.pj_inv_deg({x:e+n,y:t},r);return 1/Qr.greatCircleDistance(i.lam,i.phi,o.lam,o.phi)},initProjLibrary:async function(e){Ko&&await Ko(e)},isInvertibleCRS:function(e){return!(!e||!e.inv)},isLatLngCRS:ma,isLatLngDataset:function(e){return ma(da(e))},isProjAlias:oa,isProjectedCRS:fa,isWGS84:function(e){return!!ma(e)&&ra(e).toLowerCase().includes("84")},isWebMercator:function(e){if(!e)return!1;var t=ra(e);return t.includes("+proj=merc")&&t.includes("+a=6378137")&&t.includes("+b=6378137")},looksLikeProj4String:sa,parseCrsString:ca,parsePrj:ya,printProjections:function(){var e=Pt.internal.pj_list,t="Proj4 projections\n";Object.keys(e).sort().forEach((function(r){t+="  "+o.rpad(r,7," ")+"  "+e[r].name+"\n"})),t+="\nAliases",Object.keys(Qo).sort().forEach((function(e){t+="\n  "+e})),b(t)},projectPoint:ea,requireDatasetsHaveCompatibleCRS:pa,requireProjectedDataset:function(e){ma(da(e))&&_("Command requires a target with projected coordinates (not lat-long)")},setDatasetCrsInfo:ua,setProjectionLoader:function(e){Ko=e},toLngLat:function(e,t){return ea(e,t,ca("wgs84"))},translatePrj:ga});function va(e,t){var r=wa([e].concat(t)),n=t.reduce((function(e,t){return e.concat(t.layers)}),[]);return e.arcs=r.arcs,n}function ba(e){return wa(e.map((function(e){return o.defaults({layers:e.layers.map(uo)},e)})))}function wa(e){var t=[],r=0,n={info:{},layers:[]};return pa(e),e.forEach((function(e){var i=e.arcs?e.arcs.size():0;i>0&&t.push(e.arcs),xa(n,e),e.layers.forEach((function(e){"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type||gr(e.shapes,(function(e){return e<0?e-r:e+r})),n.layers.push(e)})),r+=i})),t.length>0&&(n.arcs=Sa(t),n.arcs.size()!=r&&y("[mergeDatasets()] Arc indexing error")),n}function xa(e,t){var r=t.info||{},n=e.info||(e.info={});n.input_files=o.uniq((n.input_files||[]).concat(r.input_files||[])),n.input_formats=o.uniq((n.input_formats||[]).concat(r.input_formats||[])),o.defaults(n,r)}function Sa(e){var t=e.map((function(e){return e.getRetainedInterval()>0&&(w("Baking-in simplification setting."),e.flatten()),e.getVertexData()})),r=Ea(o.pluck(t,"xx"),Float64Array),n=Ea(o.pluck(t,"yy"),Float64Array);return new Oo(Ea(o.pluck(t,"nn"),Int32Array),r,n)}function Ea(e,t){var r=function(e){return e.reduce((function(e,t){return e+(t.length||0)}),0)}(e),n=new(t||Array)(r),i=0;return e.forEach((function(e){for(var t=e.length,r=0;r<t;r++)n[r+i]=e[r];i+=t})),n}var Ta,Aa=Object.freeze({__proto__:null,mergeArcs:Sa,mergeCommandTargets:function(e,t){var r,n=[],i=[],o=0;return e.forEach((function(e){n=n.concat(e.layers),i=i.concat(e.dataset),e.dataset.arcs&&e.dataset.arcs.size()>0&&o++})),r=wa(i),o>1&&wo(r),i.forEach(t.removeDataset),t.addDataset(r),t.setDefaultTarget(n,r),[{layers:n,dataset:r}]},mergeDatasetInfo:xa,mergeDatasets:wa,mergeDatasetsForExport:ba,mergeDatasetsIntoDataset:va});function Ca(e,t){!function(e,t){function r(e,r){var n=t[e];t[e]=t[r],t[r]=n}for(var n=0,i=t.length;n<i;n+=2)e[t[n]]>e[t[n+1]]&&r(n,n+1)}(e,t),ka(e,t,0,t.length-2)}function Ia(e,t,r,n){for(var i,o,a=r+2;a<=n;a+=2){i=t[a],o=t[a+1];for(var s=a-2;s>=r&&e[i]<e[t[s]];s-=2)t[s+2]=t[s],t[s+3]=t[s+1];t[s+2]=i,t[s+3]=o}}function ka(e,t,r,n){for(var i,o,a=r,s=n;a<n;){for(i=e[t[r+n>>2<<1]];a<=s;){for(;e[t[a]]<i;)a+=2;for(;e[t[s]]>i;)s-=2;a<=s&&(o=t[a],t[a]=t[s],t[s]=o,o=t[a+1],t[a+1]=t[s+1],t[s+1]=o,a+=2,s-=2)}if(s-r<40?Ia(e,t,r,s):ka(e,t,r,s),n-a<40)return void Ia(e,t,a,n);r=a,s=n}}function Pa(e){var t=new Uint8Array(e);this.setId=function(e){t[e]=1},this.hasId=function(e){return 1===t[e]}}function Ma(e){var t=new Uint8Array(e),r=[];this.setId=function(e){this.hasId(e)||r.push(e),e<0?t[~e]|=2:t[e]|=1},this.clear=function(){var e=this;r.forEach((function(t){e.clearId(t)})),r=[]},this.hasId=function(e){return e<0?!(2&~t[~e]):!(1&~t[e])},this.clearId=function(e){e<0?t[~e]&=1:t[e]&=2},this.getIds=function(){return r},this.setIds=function(e){for(var t=0;t<e.length;t++)this.setId(e[t])}}function Ra(e,t){var r=o.extend({},t),n=e.getBounds();!e.isPlanar()&&Qr.containsBounds(Jr(),n.toArray());var i,a,s=n.ymin,l=n.ymax-s,c=r.stripes||$a(e),u=new Uint32Array(c),h=c>1&&l>0?function(e){return Math.floor((c-1)*(e-s)/l)}:function(e){return 0};r.tolerance>=0==!1&&(r.tolerance=$r(n.toArray())),e.forEachSegment((function(e,t,r,n){for(var i=h(n[e]),o=h(n[t]);u[i]=u[i]+2,i!=o;)i+=o>i?1:-1}));var d,p,f=(d=o.sum(u),p=4*d,(!Ta||Ta.byteLength<p)&&(Ta=new ArrayBuffer(p)),new Uint32Array(Ta,0,d)),m=0,g=[];o.forEach(u,(function(e){var t=m;m+=e,g.push(f.subarray(t,m))})),o.initializeArray(u,0),e.forEachSegment((function(e,t,r,n){for(var i,o,a=h(n[e]),s=h(n[t]);i=u[a],u[a]=i+2,(o=g[a])[i]=e,o[i+1]=t,a!=s;)a+=s>a?1:-1}));var y,_=e.getVertexData(),v=[];for(i=0;i<c;i++)for(y=za(g[i],_.xx,_.yy,r),a=0;a<y.length;a++)v.push(y[a]);return Da(v,r.unique?La:null)}function Da(e,t){var r={},n=t||Oa;return e.filter((function(e){var t=n(e);return!(t in r)&&(r[t]=!0,!0)}))}function Oa(e){return e.a.join(",")+";"+e.b.join(",")}function La(e){return e.x+","+e.y}function Ba(e){var t=e.getFilteredPointCount()-e.size(),r=2*Math.pow(t,.4);return Math.ceil(r)||1}function $a(e){var t=e.getFilteredPointCount()-e.size(),r=Math.ceil(Math.pow(10*t,.6)/40);return r>0?r:1}function za(e,t,r,n){var i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w=e.length-2,x=[],S=(n||{}).tolerance;for(Ca(t,e),v=0;v<w;){for(i=e[v],o=e[v+1],l=t[i],c=t[o],d=r[i],p=r[o],b=v;b<w&&!(c<(u=t[a=e[b+=2]]));){if(f=r[a],h=t[s=e[b+1]],m=r[s],d>=f){if(d>m&&p>f&&p>m)continue}else if(d<m&&p<f&&p<m)continue;i!=a&&i!=s&&o!=a&&o!=s&&(g=Qr.segmentIntersection(l,d,c,p,u,f,h,m,S))&&(y=[i,o],_=[a,s],x.push(Fa(g,y,_,t,r)),4==g.length&&x.push(Fa(g.slice(2),y,_,t,r)))}v+=2}return x}function Fa(e,t,r,n,i){var o,a=e[0],s=e[1];return t=qa(a,s,t[0],t[1],n,i),r=qa(a,s,r[0],r[1],n,i),{x:a,y:s,a:o=t[0]<r[0]?t:r,b:o==t?r:t}}function qa(e,t,r,n,i,o){return i[r]==e&&o[r]==t?[r,r]:i[n]==e&&o[n]==t?[n,n]:r<n?[r,n]:[n,r]}var Na=Object.freeze({__proto__:null,calcSegmentIntersectionStripeCount:$a,calcSegmentIntersectionStripeCount2:Ba,dedupIntersections:Da,findSegmentIntersections:Ra,formatIntersectingSegment:qa,formatIntersection:Fa,getIntersectionLayer:function(e,t,r){var n=r.getVertexData().ii,i=new Pa(r.size());gr(t.shapes,(e=>{i.setId(or(e))}));var o=[];return e.forEach((e=>{var t=ar(e.a[0],n),r=ar(e.b[0],n);i.hasId(t)&&i.hasId(r)&&o.push([e.x,e.y])})),{geometry_type:"point",shapes:[o]}},getIntersectionPoints:function(e){return e.map((function(e){return[e.x,e.y]}))},intersectSegments:za,sortIntersections:function(e){e.sort((function(e,t){return e.x-t.x||e.y-t.y}))}});function ja(e,t,r){for(var n=r.getVertexData(),i=n.xx,o=n.yy,a=[],s=0,l=i.length;s<l;s++)i[s]==e&&o[s]==t&&a.push(s);return a}function Ua(e,t){var r=t.getVertexData();return[r.xx[e],r.yy[e]]}function Va(e,t){for(var r=t.getVertexData(),n=r.ii,i=r.nn,o=0,a=n.length;o<a;o++)if(e===n[o]+i[o]-1)return!0;return!1}function Ga(e,t){return Wa(e,t)||Va(e,t)}function Wa(e,t){for(var r=t.getVertexData().ii,n=0,i=r.length;n<i;n++)if(e===r[n])return!0;return!1}function Ha(e,t){if(e<0)return Ha(~e,t).reverse();var r=t.getVertexData(),n=r.ii[e],i=r.nn[e];return[[r.xx[n],r.yy[n]],[r.xx[n+i-1],r.yy[n+i-1]]]}function Za(e,t,r,n){var i=n.getVertexData();i.xx[r]=e,i.yy[r]=t}function Ya(e,t,r,n,i){for(var o,a,s,l,c=i?Qr.greatCircleDistance:Qr.distance2D,u=1/0,h=0;h<r.length;h++)for(l=n.getShapeIter(r[h]);l.hasNext();)(s=c(e,t,l.x,l.y))<u&&(u=s,o=l.x,a=l.y);return u<1/0?{x:o,y:a}:null}var Xa=Object.freeze({__proto__:null,findNearestVertex:Ya,findNearestVertices:function(e,t,r){var n=Ya(e[0],e[1],t,r);return ja(n.x,n.y,r)},findVertexIds:ja,getArcEndCoords:function(e,t){return Ha(e,t)[1]},getArcEndpointCoords:Ha,getArcStartCoords:function(e,t){return Ha(e,t)[0]},getVertexCoords:Ua,setVertexCoords:Za,snapPointToArcEndpoint:function(e,t,r){var n,i,o;t.forEach((function(e){Wa(e,r)?n=Ua(e+1,r):Va(e,r)&&(n=Ua(e-1,r))})),n&&(i=n[0]-e[0],o=n[1]-e[1],Math.abs(i)>Math.abs(o)?e[1]=n[1]:e[0]=n[0])},snapVerticesToPoint:function(e,t,r){var n=r.getVertexData();e.forEach((function(e){Za(t[0],t[1],e,r),r.updateArcBounds(ar(e,n.ii))}))},vertexIsArcEnd:Va,vertexIsArcEndpoint:Ga,vertexIsArcStart:Wa});function Ka(e){var t=e.getCopy();return function(e){!function(e,t){var r=Ra(t);if(r.length>0)return void v("Original layer contains intersections -- unable to repair.");for(var n=Ra(e),i=10,o=n.length,a=0;a<i&&n.length>0;a++)Qa(n,e,t),n=Ra(e);var s=n.length;s>0?v("Unable to remove",s,"intersection"+(s>1?"s":"")):o>0&&v("Fix-geometry removed",o,"intersection"+(o>1?"s":""))}(e,t)}}function Qa(e,t,r){e.forEach((function(e){Ja(e.a[0],t,r),Ja(e.a[1],t,r),Ja(e.b[0],t,r),Ja(e.b[1],t,r)}))}function Ja(e,t,r){var n=t.getVertexData(),i=r.getVertexData(),o=[e];Ga(e,t)&&(o=o.concat(function(e,t){for(var r,n,i=t.ii,o=t.nn,a=t.xx,s=t.yy,l=a[e],c=s[e],u=[],h=0;h<i.length;h++)n=(r=i[h])+o[h]-1,r!=e&&a[r]==l&&s[r]==c&&u.push(r),n!=e&&a[n]==l&&s[n]==c&&u.push(n);return u}(e,n))),o.forEach((function(e){n.xx[e]=i.xx[e],n.yy[e]=i.yy[e]}))}function es(e,t){return+e.toPrecision(t)}function ts(e,t){var r=1;if(!e&&0!==e)return e;for(t|=0;t-- >0;)r*=10;return Math.round(e*r)/r}function rs(e){return Math.round(10*e)/10}function ns(e){o.isNumber(e)&&0!==e||y("Rounding increment must be a non-zero number.");var t=1/e;return t>1&&(t=Math.round(t)),function(e){return Math.round(e*t)/t}}function is(e){for(var t=Math.abs(e[2]-e[0]),r=Math.abs(e[3]-e[1]),n=Math.max(t,r)+1e-8,i=0;n<2e3&&i<1;)n*=10,i++;return i}function os(e,t){return e.map((function(e){return e.toFixed(t)})).join(",")}const as=(ss=new Float32Array(1),function(e){return ss[0]=e,ss[0]});var ss;const ls=Math.fround||as;function cs(e,t,r){var n=ns(t),i=e.arcs&&r?Ka(e.arcs):null;return Yo(e,(function(e,t){return[n(e),n(t)]})),i&&i(e.arcs),e}var us=Object.freeze({__proto__:null,fround:ls,fround2:as,getBinaryRoundingFunction:function(e){!1==(e>=1&&e<=32)&&y("Invalid bits argument:",e);var t="LE"==requireBrowser().endianness(),r=new Float64Array(1),n=new Uint32Array(r.buffer,t?0:4,1),i=2**32-2**e;return function(e){return r[0]=e,n[0]=n[0]&i,r[0]}},getBoundsPrecisionForDisplay:is,getRoundedCoordString:os,getRoundedCoords:function(e,t){return os(e,t).split(",").map(parseFloat)},getRoundingFunction:ns,roundPoints:function(e,t){ln(e.shapes,(function(e){e[0]=t(e[0]),e[1]=t(e[1])}))},roundToDigits:function(e,t){return+e.toFixed(t)},roundToDigits2:ts,roundToSignificantDigits:es,roundToTenths:rs,setCoordinatePrecision:cs});function hs(e,t){var r=t?function(e){if(e in ds)return ds[e];var t=e;t=t.replace("[-]","(?<prefix>-)?"),t=t.replace(/\[[NSEW, +-]{2,}\]/,"(?<prefix>$&)"),t=t.replace(/D+(\.D+)?/,((e,t)=>{var r="[0-9]+";return t&&(r+="\\.[0-9]+"),`(?<d>${r})`})),t=t.replace(/(MM?)(\.M+)?/,((e,t,r)=>{var n=1==t.length?"[0-9]+":"[0-9][0-9]";return r&&(n+="\\.[0-9]+"),`(?<m>${n})`})),t=t.replace(/(SS?)(\.S+)?/,((e,t,r)=>{var n=1==t.length?"[0-9]+":"[0-9][0-9]";return r&&(n+="\\.[0-9]+"),`(?<s>${n})`})),t="^"+t+"$";try{ds[e]=new RegExp(t)}catch(r){_("Invalid DMS format string:",e)}return ds[e]}(t):/^(?<prefix>[nsew+-]?)(?<d>[0-9.]+)[d]? ?(?<m>[0-9.]*)[m']? ?(?<s>[0-9.]*)["]? ?(?<suffix>[nsew]?)$/i,n=r.exec(e.trim()),i=NaN;return n&&(i=+(n.groups.d||"0")+ +(n.groups.m||"0")/60+ +(n.groups.s||"0")/3600,(/[sw-]/i.test(n.groups.prefix||"")||/[sw]/i.test(n.groups.suffix||""))&&(i=-i)),i}var ds={};function ps(e,t){t||(t="[-]DM'S.SSS");var r,n,i,o=t,a=/(D+)[^M]*(M+)?[^S[\]]*(S+)?/.exec(t),s=a&&!!a[3],l=a&&!!a[2];(!a||s&&!l)&&_("Invalid DMS format string:",t);var c=s&&a[3].length||l&&a[2].length||a[1].length,u=s&&/S\.(S+)/||l&&/M\.(M+)/||/D\.(D+)/,h=u.test(t)?u.exec(t)[1].length:0;if(l){var d=Math.pow(10,h),p=s?3600*d:60*d,f=Math.floor(Math.abs(e)*p+.5),m=function(e,t,r){var n=e.toFixed(r),i=n.split(".");return i.length>0&&(i[0]=i[0].padStart(t,"0"),n=i.join(".")),n}(f/d%60,c,h);s?(f=Math.floor(f/(60*d)),i=m,n=String(f%60).padStart(a[2].length,"0")):(f=Math.floor(f/d),n=m),r=String(Math.floor(f/60)).padStart(a[1].length,"0")}else r=Math.abs(e).toFixed(h);return o=(o=(o=(o=(o=o.replace(/\[-\]/,(t=>e<0?"-":""))).replace(/\[[+-]+\]/,(t=>e<0?"-":"+"))).replace(/\[[NS, ]+\]/,(t=>e<0?"S":"N"))).replace(/\[[EW, ]+\]/,(t=>e<0?"W":"E"))).replace(/D+(\.D+)?/,r),l&&(o=o.replace(/M+(\.M+)?/,n)),s&&(o=o.replace(/S+(\.S+)?/,i)),o}function fs(e,t){!0!==e&&!1!==e&&_(t||"Filter expression must return true or false")}function ms(e,t){if(!e||!t||e.length!=t.length-1)return null;for(var r,n,i,a=o.sum(e),s=Math.floor(a/2),l=0,c=1;c<t.length;c++){if(n=t[c-1],i=t[c],s<=(r=l+e[c-1]))return n+(s-l)/(r-l)*(i-n);l=r}return null}function gs(e,t){Object.keys(t).forEach((function(r){var n=t[r],i="function"==typeof n?{get:n}:{value:n,writable:!1};Object.defineProperty(e,r,i)}))}function ys(e,t,r){if(!e||!r)return null;var n=[],i=[],o=[],a=[];return e.forEach((function(e){for(var s=_s(e,t,r,n,i);s<4&&s>0;)n.pop(),i.pop(),s--;s>0&&(a.push([o.length]),o.push(s))})),{shape:a.length>0?a:null,arcs:new Oo(o,n,i)}}function _s(e,t,r,n,i){for(var o,a,s,l,c=t.getShapeIter(e),u=0;c.hasNext();)s=c.x,l=c.y,(0===u||Qr.distance2D(s,l,o,a)>r)&&(n.push(s),i.push(l),o=s,a=l,u++);return s==o&&l==a||(n.push(s),i.push(l),u++),u}var vs=Object.freeze({__proto__:null,simplifyArcsFast:function(e,t){for(var r,n=[],i=[],o=[],a=0,s=e.size();a<s;a++)1==(r=_s([a],e,t,n,i))&&(r=0,n.pop(),i.pop()),o.push(r);return new Oo(o,n,i)},simplifyPolygonFast:ys});function bs(e,t){var r,n=e&&Qr.getMaxPath(e,t),i=n&&t.getSimpleShapeBounds(n);return i&&i.hasBounds()&&0!==i.area()&&(r=ys(e,t,.01*Math.sqrt(i.area()))).shape?function(e,t){var r,n,i,o,a,s,l,c=Qr.getMaxPath(e,t),u=t.getSimpleShapeBounds(c),h=Qr.getPathCentroid(c,t),d=function(e,t){var r=Math.max(t.width(),t.height())/2;return function(t,n){var i=Qr.distance2D(e.x,e.y,t,n);return 1-Math.min(.6*i/r,.25)}}(h,u),p=Qr.getPlanarPathArea(c,t);1==e.length&&1.2*p>u.area()?(o=5,i=.2):1==e.length&&1.7*p>u.area()?(o=7,i=.4):(o=11,i=.5);r=u.width()*i,n=h.x-r/2,a=r/o,s=xs(e,t,n,n+r,o,d),s?(l=xs(e,t,s.x-a/2,s.x+a/2,2,d)).distance>s.distance&&(s=l):(w("[points inner] failed, falling back to centroid"),s=h);return s}(r.shape,r.arcs):null}function ws(e,t,r){var n=t.getBounds().ymin-1;return r.reduce((function(r,i){var a=function(e,t,r,n){var i,a,s,l=function(e,t,r,n){return r?r.reduce((function(r,i){var o=function(e,t,r,n){var i=[];_r(r,n,(function(r,n,o,a){var s=Qr.getRayIntersection(e,t,o[r],a[r],o[n],a[n]);s>-1/0&&i.push(s)})),i.length%2==1&&(i=[]);return i}(e,t,i,n);return r.concat(o)}),[]):[]}(e,t,r,n),c=[];o.genericSort(l);for(var u=0;u<l.length;u+=2)i=l[u],(s=((a=l[u+1])-i)/2)>0&&c.push({y:(i+a)/2,x:e,interval:s});return c}(i,n,e,t);return r.concat(a)}),[])}function xs(e,t,r,n,i,o){var a,s,l,c=function(e,t,r){for(var n=(t-e)/(r+1),i=[],o=1;o<=r;o++)i.push(e+n*o);return i}(r,n,i),u=(n-r)/i,h=ws(e,t,c);h.forEach((function(e){e.interval*=o(e.x,e.y)})),h.sort((function(e,t){return t.interval-e.interval}));for(var d=0;d<h.length&&(l=h[d],!(a&&a.distance>l.interval));d++)s=Ss(l.x,l.y,e,t,u,o),(!a||s.distance>a.distance)&&(a=s);return a}function Ss(e,t,r,n,i,o){var a={x:e,y:t,distance:Qr.getPointToShapeDistance(e,t,r,n)*o(e,t)};return Es(a,r,n,i,o),Es(a,r,n,-i,o),a}function Es(e,t,r,n,i){for(var o,a=e.x,s=e.y,l=e.distance;s+=n,(o=Qr.getPointToShapeDistance(a,s,t,r)*i(a,s))>.9*l&&Qr.testPointInPolygon(a,s,t,r);)o>l&&(e.distance=l=o,e.y=s)}function Ts(e,t){var r=new Uint8Array(e.size());gr(t,(function(e){e<0?r[~e]|=2:r[e]|=1})),this.isInnerArc=function(e){var t=or(e);return 3==r[t]}}function As(e){return e.reduce((function(e,t){return t.layers.forEach((function(r){e.push({layer:r,dataset:t.dataset})})),e}),[])}function Cs(e,t,r){var n=ks(e,t,!0);return r&&(n=n.filter((function(e){return e.layer.geometry_type==r}))),e.forEach((function(e){e.layer.target_id=-1})),n.forEach((function(e,t){e.layer.target_id=t})),Is(n)}function Is(e){var t=[],r=[];return e.forEach((function(e){var n=t.indexOf(e.dataset);-1==n?(t.push(e.dataset),r.push({layers:[e.layer],dataset:e.dataset})):r[n].layers.push(e.layer)})),r}function ks(e,t,r){var n=[],i=[],a={};return t.split(",").forEach((function(t,r){var o=Ps(t),s=!1;e.forEach((function(e,t){t in a?s=!0:o(e.layer,t+1)&&(n.push(e),a[t]=!0,s=!0)})),0==s&&i.push(t)})),r&&i.length&&_(o.format("Missing layer%s: %s",1==i.length?"":"s",i.join(","))),n}function Ps(e){var t=o.isInteger(Number(e)),r=t?null:o.wildcardToRegExp(e);return function(n,i){return t?String(i)==e:r.test(n.name||"")}}var Ms=Object.freeze({__proto__:null,countTargetLayers:function(e){return e.reduce((function(e,t){return e+t.layers.length}),0)},expandCommandTargets:As,findCommandTargets:Cs,findMatchingLayers:ks,getLayerMatch:Ps,getLayerTargetId:function(e,t){var r,n=0;return t.name,e.getLayers().forEach((function(e,i){t.name&&e.layer.name==t.name&&n++,t==e.layer&&(r=String(i+1))})),r||y("Layer not found"),1==n?t.name:r},groupLayersByDataset:Is});function Rs(e,t,r){var n;return gs(e,{layer_name:t.name||"",layer:function(){return n||(n=function(e,t){var r={},n=e.data?e.data.getRecords():null;return gs(r,{name:e.name,data:n,type:e.geometry_type,size:Ki(e),empty:0===Ki(e),bbox:Ds(r,e,t)}),r.field_exists=function(t){return!(!e.data||!e.data.fieldExists(t))},r.field_type=function(t){return e.data&&Ci(t,e.data.getRecords())||null},r.field_includes=function(t,r){return!!e.data&&e.data.getRecords().some((function(e){return e&&e[t]===r}))},r}(t,r)),n}}),e}function Ds(e,t,r){var n;return function(){return n||(n=function(e,t){var r=mo(e,t);if(!r)return null;var n=r.toArray();return Object.assign(n,{cx:r.centerX(),cy:r.centerY(),height:r.height(),width:r.width(),left:r.xmin,bottom:r.ymin,top:r.ymax,right:r.xmax}),n}(t,r)),n}}function Os(e,t,r){var n,i,a,s,l,c,u,h=r||{},d=Wi(e),p=t&&Gi(e),f=e.data?e.data.getRecords():null,m=p&&t.isPlanar(),g={};function y(){var t=e.shapes[u];l||(l=t&&t[0]||null)}function v(){return a=a||Qr.getShapeCentroid(c,t)}function b(){return s=s||bs(c,t)}function w(){return i||(i=p?t.getMultiShapeBounds(c):d?an(e.shapes[u]):new St)}return gs(g,{id:function(){return u}}),Rs(g,e,t),h.geojson_editor&&(Object.defineProperty(g,"geojson",{set:function(e){h.geojson_editor.set(e,u)},get:function(){return h.geojson_editor.get(u)}}),Object.defineProperty(g,"feature",{set:function(e){h.geojson_editor.set(e,u)},get:function(){return h.geojson_editor.get(u)}}),Object.defineProperty(g,"geometry",{set:function(e){h.geojson_editor.setGeometry(e,u)},get:function(){return h.geojson_editor.getGeometry(u)}})),f&&Object.defineProperty(g,"properties",{set:function(e){o.isObject(e)?f[u]=e:_("Can't assign non-object to $.properties")},get:function(){var e=f[u];return e||(e=f[u]={}),e}}),(p||d)&&gs(g,{partCount:function(){var t=e.shapes[u];return t?t.length:0},isNull:function(){return 0===g.partCount},bounds:function(){return w().toArray()},bbox:function(){return w().toArray()},height:function(){return w().height()},width:function(){return w().width()}}),p?(g.bboxContainsPoint=function(e,r){return t.getMultiShapeBounds(c).containsPoint(e,r)},g.bboxIntersectsRectangle=function(e,r,n,i){var o=t.getMultiShapeBounds(c);return St.from(e,r,n,i).intersects(o)},g.bboxContainsRectangle=function(e,r,n,i){var o=t.getMultiShapeBounds(c),a=St.from(e,r,n,i);return o.contains(a)},g.bboxContainedByRectangle=function(e,r,n,i){var o=t.getMultiShapeBounds(c);return St.from(e,r,n,i).contains(o)},"polyline"==e.geometry_type&&gs(g,{length:function(){return Qr.getShapePerimeter(c,t)}}),"polygon"==e.geometry_type&&gs(g,{area:function(){return m?g.planarArea:Qr.getSphericalShapeArea(c,t)},perimeter:function(){return Qr.getShapePerimeter(c,t)},compactness:function(){return Qr.calcPolsbyPopperCompactness(g.area,g.perimeter)},planarArea:function(){return Qr.getPlanarShapeArea(c,t)},innerPct:function(){return n||(n=function(e,t){var r,n,i,o=e.isPlanar()?Qr.distance2D:Qr.greatCircleDistance,a=new Ts(e,t);return function(e){return r=0,n=0,e&&e.forEach(s),n>0?n/(n+r):0};function s(e){e.forEach(l)}function l(t){i=0,e.forEachArcSegment(t,c),a.isInnerArc(t)?n+=i:r+=i}function c(e,t,r,n){i+=o(r[e],n[e],r[t],n[t])}}(t,e.shapes)),n(c)},originalArea:function(){var e,r=t.getRetainedInterval();return t.setRetainedInterval(0),e=g.area,t.setRetainedInterval(r),e},centroidX:function(){var e=v();return e?e.x:null},centroidY:function(){var e=v();return e?e.y:null},innerX:function(){var e=b();return e?e.x:null},innerY:function(){var e=b();return e?e.y:null}})):d&&(Object.defineProperty(g,"coordinates",{set:function(t){!t||o.isArray(t)?e.shapes[u]=t||null:_("Can't assign non-array to $.coordinates")},get:function(){return e.shapes[u]||null}}),Object.defineProperty(g,"x",{get:function(){return y(),l?l[0]:null},set:function(e){y(),l&&(l[0]=Number(e))}}),Object.defineProperty(g,"y",{get:function(){return y(),l?l[1]:null},set:function(e){y(),l&&(l[1]=Number(e))}})),function(t){return u=t,i=null,p&&(a=null,s=null,c=e.shapes[t]),d&&(l=null),g}}function Ls(e,t,r){var n=r||{},i=t||zs(),o=Bs(e,n),a=$s(e),s=!n.no_assign&&a.length>0;return n.no_assign&&Fs(a,i),i._=i,function(t){var r,n=i.$||null;s&&Fs(a,t);try{r=o.call(n,t,i)}catch(l){_(l.name,"in expression ["+e+"]:",l.message)}return r}}function Bs(e,t){var r;e=function(e){return e.replace(/\\\n/g," ")}(e),r="with($$env){with($$record){ "+(r=t.no_return?e:"var $$retn = "+e+"; return $$retn;")+"}}";try{return new Function("$$record,$$env",r)}catch(n){_(n.name,"in expression ["+e+"]")}}function $s(e,t){var r=e.match(/[a-z_$][.a-z0-9_$]*(?= *=[^>=])/gi)||[];return o.uniq(r.filter((function(e){var r=e.indexOf(".");return t?r>-1:-1==r})))}function zs(e){return(e=e||{}).globalThis=void 0,function(){for(var t in this)e[t]=void 0}(),e.console=console,e}function Fs(e,t){for(var r=0;r<e.length;r++)e[r]in t==!1&&(t[e[r]]=null)}var qs=Object.freeze({__proto__:null,compileExpressionToFunction:Bs,getAssignedVars:$s,getBaseContext:zs,getExpressionFunction:Ls,nullifyUnsetProperties:Fs});function Ns(e,t,r,n){var i=n||{};$s(e).length>0&&!t.data&&go(t);var o=t.data?t.data.getRecords():[],a=Os(t,r,i),s=Rs({},t,r),l=Vs(t,i.context||{},i),c=Ls(e,l,i);return function(e,t){var r=t||o[e]||(o[e]={});return l.$=e>=0?a(e):s,l.d=r,c(r)}}function js(e,t,r){var n=Us(e,t,r);return function(e,t){var r=n(e,t);return fs(r,'"where" expression must return true or false'),r}}function Us(e,t,r){var n=Vs({}),i=s(t,r),o=s(t,r),a=Ls(e,n,{});function s(e,t){var r=e.data?e.data.getRecords():[],n=Os(e,t);function i(){}return function(e){var t;return-1==e?null:(i.prototype=r[e]||{},(t=new i).$=n(e),t)}}return function(e,t,r){return n.A=i(e),n.B=o(t),a(r||{})}}function Vs(e,t,r){var n=u("defs"),i=zs(),a={},s=e.data?e.data.getFields():[];return r=r||{},function(e){Object.assign(e,{round:ts,int_median:ms,sprintf:o.format,format_dms:ps,parse_dms:hs})}(i),s.length>0&&Fs(s,i),t=o.defaults(t||{},n),i.global=n,Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);r.get?Object.defineProperty(a,e,{get:r.get}):Object.defineProperty(a,e,{value:t[e]})})),Object.keys(i).reduce((function(e,t){return t in e?r.no_warn||("function"==typeof e[t]&&s.indexOf(t)>-1?v("Warning: "+t+"() function is hiding a data field with the same name"):v('Warning: "'+t+'" has multiple definitions')):Object.defineProperty(e,t,{value:i[t]}),e}),a)}var Gs=Object.freeze({__proto__:null,compileFeatureExpression:Ns,compileFeaturePairExpression:Us,compileFeaturePairFilterExpression:js}),Ws={m:"meters",meter:"meters",meters:"meters",mi:"miles",mile:"miles",miles:"miles",km:"kilometers",ft:"feet",feet:"feet"},Hs={meters:1,kilometers:1e3,feet:.3048,miles:1609.344};function Zs(e){var t=String(e),r=parseFloat(t),n=(/px|pix/.test(t)?"px":/pt|point/.test(t)&&"pt")||/in/.test(t)&&"in"||/cm/.test(t)&&"cm"||!isNaN(+t)&&"px"||null,i="in"==n&&72*r||"cm"==n&&Math.round(28.3465*r)||r;return i>=0!=!1&&n||_("Invalid size:",t),i}function Ys(e,t){var r,n=0,i=0;return t&&(t.is_latlong?i=1:t.to_meter>0?i=t.to_meter:y("Invalid CRS")),e&&((n=Hs[e])||y("Unknown units:",e)),n&&i?r=n/i:n||i?n&&!i?_("Unable to convert",e,"to unknown coordinates"):!n&&i&&(r=1/i):r=1,r}function Xs(e){var t=Ks(e);return isNaN(t.value)&&_("Invalid parameter:",e),t}function Ks(e){var t=o.isString(e)?e:"",r=/(sq|)([a-z]+)(2|)$/i.exec(t),n={};return o.isNumber(e)?n.value=e:""===t?n.value=NaN:r?(n.units=Ws[r[2].toLowerCase()],n.areal=!(!r[1]&&!r[3]),n.value=Number(t.substring(0,t.length-r[0].length)),n.units||isNaN(n.value)||_("Unknown units: "+r[0])):n.value=Number(t),n}function Qs(e,t){var r=Xs(e),n=Ys(r.units,t);return r.value*n*n}function Js(e,t){var r=Xs(e),n=Ys(r.units,t);return r.areal&&_("Expected a distance, received an area:",e),r.value*n}function el(e,t){var r=Xs(e),n=Ys(r.units,t);return r.units&&t&&t.is_latlong&&_("Parameter does not support distance units with latlong datasets"),r.areal&&_("Expected a distance, received an area:",e),r.value*n}function tl(e,t){var r,n;return Array.isArray(e)&&2==e.length||_("Expected two distance parameters, received",e),r=Xs(e[0]),n=Xs(e[1]),(r.units&&!n.units||n.units&&!r.units)&&_("Both parameters should have units:",e),[el(e[0],t),el(e[1],t)]}function rl(e,t,r){var n=e.includes(",")?e.split(","):e.split(" ");return 1==n.length?n=[n[0],n[0],n[0],n[0]]:4!=n.length&&_("Expected a distance parameter or a list of four params"),n.map((function(e,n){return e.indexOf("%")>0?(parseFloat(e)/100||0)*(1==n||3==n?r.height():r.width()):el(e,t)}))}function nl(e,t){var r=t&&t.to_meter?e*t.to_meter*t.to_meter:e,n=r/1e6;return n<.01?Math.round(r)+" sqm":n+" sqkm"}var il=Object.freeze({__proto__:null,convertAreaParam:Qs,convertDistanceParam:Js,convertFourSides:rl,convertIntervalPair:tl,convertIntervalParam:el,getAreaLabel:nl,getIntervalConversionFactor:Ys,parseMeasure:Xs,parseMeasure2:Ks,parseSizeParam:Zs}),ol={};function al(e){var t=sl(e);return!!t&&t in ol}function sl(e){var t=e.data&&e.data.getReadOnlyRecordAt(0);return t&&t.type||null}function ll(e,t){var r,n,i,a,s,l,c=function(e){return o.find(e.layers,(function(t){return function(e,t){return"frame"==sl(e)&&Hi(e,t)}(t,e.arcs)}))}(e);return c?(n=c,i=e.arcs,a=mo(n,i),s=n.data.getReadOnlyRecordAt(0).width||800,l=Math.round(s*a.height()/a.width()),r={type:"frame",width:s,height:l,bbox:a.toArray()}):r=ul(e,t),r.invert_y=!!t.invert_y,r.crs=da(e),r}function cl(e,t){var r=new St(t.bbox),n=t.bbox2?new St(t.bbox2):new St(0,0,t.width,t.height);r.fillOut(n.width()/n.height());var i=r.getTransform(n,t.invert_y);Yo(e,(function(e,t){return i.transform(e,t)}))}function ul(e,t){var r,n;return t.svg_bbox?(r=new St(t.svg_bbox),t=Object.assign({margin:0},t)):r=jo(e),n=function(e,t){var r,n,i,a,s,l=0,c=0,u=0,h=0,d=e.width(),p=e.height(),f=function(e){var t=(o.isNumber(e)?String(e):e||"").trim().split(/[, ] */);1==t.length&&t.push(t[0]);2==t.length&&t.push(t[0],t[1]);3==t.length&&t.push(t[2]);return t.map((function(e){var t=parseFloat(e);return isNaN(t)?0:t}))}(t.margin),m=f[0]+f[2],g=f[1]+f[3],_=.5,v=.5;t.fit_bbox?(u=t.fit_bbox[0],h=t.fit_bbox[1],r=t.fit_bbox[2]-u,n=t.fit_bbox[3]-h,m=g=0):t.svg_scale>0?(r=d/t.svg_scale+m,n=0):+t.pixels?(i=function(e,t){var r,n,i=e.width()/e.height();n=t.pixels?Math.sqrt(+t.pixels*i):+t.width;return r=n/i,[Math.round(n),Math.round(r)]}(e,t),r=i[0],n=i[1]):(n=t.height||0,r=t.width||(n>0?0:800));n>0&&(s=(p||d||1)/(n-g));r>0&&(a=(d||p||1)/(r-m));r?n||(s=a,n=p>0?g+p/s:r,t.max_height>0&&n>t.max_height&&(s=a*n/t.max_height,n=t.max_height)):(a=s,r=d>0?m+d/a:n);a>s?c=(s=a)*(n-g)-p:s>a&&(l=(a=s)*(r-m)-d);e.padBounds(f[0]*a+l*_,f[1]*s+c*v,f[2]*a+l*(1-_),f[3]*s+c*(1-v)),r>0&&n>0||y("Missing valid height and width parameters");a===s&&a>0||y("Missing valid margin parameters");return new St(u,h,r+u,n+h)}(r,t),{bbox:r.toArray(),bbox2:n.toArray(),width:Math.round(n.width()),height:Math.round(n.height())||1,type:"frame"}}a.affine=function(e,t,r){var n,i,a,s=r.rotate||0,l=r.scale||1,c=r.shift?tl(r.shift,da(t)):[0,0],u=t.arcs,h=[],d=[],p=[];t.layers.filter(Vi).forEach((function(n){var i,o=[],a=[];-1==e.indexOf(n)?a=n.shapes:r.where?(i=Ns(r.where,n,t.arcs),n.shapes.forEach((function(e,t){(i(t)?o:a).push(e)}))):o=n.shapes,"point"==n.geometry_type?p=p.concat(o):(h=h.concat(o),d=d.concat(a))}));var f,m,g,y,_,v,b=function(e,t){var r,n;r=t.anchor?t.anchor:[(n=jo(e)).centerX(),n.centerY()];return r}({arcs:t.arcs,layers:[{geometry_type:"point",shapes:p},{geometry_type:"polyline",shapes:h}]},r);f=l,m=c,g=b,y=s*Math.PI/180,_=f*Math.cos(y),v=-f*Math.sin(y),a=function(e,t){return[_*(e-g[0])-v*(t-g[1])+m[0]+g[0],v*(e-g[0])+_*(t-g[1])+m[1]+g[1]]},r.fit_bbox&&(a=function(e,t,r,n){var i={arcs:n,layers:[]};t&&t.length&&i.layers.push({geometry_type:"point",shapes:t});r&&r.length&&i.layers.push({geometry_type:"polyline",shapes:r});var o=ul(i,{fit_bbox:e}),a=new St(o.bbox),s=new St(o.bbox2),l=a.getTransform(s,!1);return function(e,t){return l.transform(e,t)}}(r.fit_bbox,p,h,u)),h.length>0&&(n=new Uint8Array(u.size()),i=new Uint8Array(u.size()),hr(h,n),d.length>0&&(hr(d,i),function(e,t){for(var r=0,n=e.length;r<n;r++)0===t[r]&&(e[r]=0)}(i,n),t.arcs=function(e,t,r){for(var n,i=0,a=0,s=t.getVertexData(),l=[],c=[],u=[],h=[],d=0,p=r.length;d<p;d++)r[d]>0&&(h[d]=t.size()+i,n=s.nn[d],o.copyElements(s.xx,s.ii[d],l,a,n),o.copyElements(s.yy,s.ii[d],c,a,n),u.push(n),a+=n,i++);return gr(e,(function(e){var t=or(e);if(r[t]>0)return e<0?~h[t]:h[t]})),Sa([t,new Oo(u,l,c)])}(d,u,i)),t.arcs.transformPoints((function(e,t,r){if(r<n.length&&n[r]>0)return a(e,t)}))),ln(p,(function(e){var t=a(e[0],e[1]);e[0]=t[0],e[1]=t[1]}))};var hl=ns(.01);function dl(e){return" "+hl(e[0])+" "+hl(e[1])}function pl(e){return e.length>2&&"C"==e[2]}function fl(e){for(var t=[],r=0;r<e.length;r++)t.push(ml(e[r])+" Z");return t.length>0?t.join(" "):""}function ml(e){if(0===e.length)return"";var t,r,n,i="M",o=!1;for(r=0,n=e.length;r<n;r++)pl(t=e[r])?(i+=" C"+dl(t)+dl(e[++r])+dl(e[++r]),o=!0):o?(i+=" L"+dl(t),o=!1):i+=dl(t);return i}var gl=Object.freeze({__proto__:null,stringifyLineStringCoords:ml,stringifyPolygonCoords:fl}),yl={ID_FIELD:"FID",typeLookup:{LineString:"polyline",MultiLineString:"polyline",Polygon:"polygon",MultiPolygon:"polygon",Point:"point",MultiPoint:"point"},translateGeoJSONType:function(e){return yl.typeLookup[e]||null},pathIsRing:function(e){var t=e[0],r=e[e.length-1];return e.length>=4&&t[0]==r[0]&&t[1]==r[1]},toFeature:function(e,t){var r=e?e.type:null;return"Feature"==r?e:r in yl.typeLookup?{type:"Feature",geometry:e,properties:t||null}:{type:"Feature",geometry:null,properties:t||null}}};class _l{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let r=this.length++;for(;r>0;){const e=r-1>>1,n=this.values[e];if(t>=n)break;this.ids[r]=this.ids[e],this.values[r]=n,r=e}this.ids[r]=e,this.values[r]=t}pop(){if(0===this.length)return;const e=this.ids,t=this.values,r=e[0],n=--this.length;if(n>0){const r=e[n],i=t[n];let o=0;const a=n>>1;for(;o<a;){const r=1+(o<<1),a=r+1,s=r+(+(a<n)&+(t[a]<t[r]));if(t[s]>=i)break;e[o]=e[s],t[o]=t[s],o=s}e[o]=r,t[o]=i}return r}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}const vl=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bl{static from(e,t=0){if(t%8!=0)throw new Error("byteOffset must be 8-byte aligned.");if(!e||void 0===e.byteLength||e.buffer)throw new Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");const[r,n]=new Uint8Array(e,t+0,2);if(251!==r)throw new Error("Data does not appear to be in a Flatbush format.");const i=n>>4;if(3!==i)throw new Error(`Got v${i} data when expected v3.`);const o=vl[15&n];if(!o)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,t+2,1),[s]=new Uint32Array(e,t+4,1);return new bl(s,a,o,void 0,e,t)}constructor(e,t=16,r=Float64Array,n=ArrayBuffer,i,o=0){if(void 0===e)throw new Error("Missing required argument: numItems.");if(isNaN(e)||e<=0)throw new Error(`Unexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.byteOffset=o;let a=e,s=a;this._levelBounds=[4*a];do{a=Math.ceil(a/this.nodeSize),s+=a,this._levelBounds.push(4*s)}while(1!==a);this.ArrayType=r,this.IndexArrayType=s<16384?Uint16Array:Uint32Array;const l=vl.indexOf(r),c=4*s*r.BYTES_PER_ELEMENT;if(l<0)throw new Error(`Unexpected typed array class: ${r}.`);if(i)this.data=i,this._boxes=new r(i,o+8,4*s),this._indices=new this.IndexArrayType(i,o+8+c,s),this._pos=4*s,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{const i=this.data=new n(8+c+s*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new r(i,8,4*s),this._indices=new this.IndexArrayType(i,8+c,s),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(i,0,2).set([251,48+l]),new Uint16Array(i,2,1)[0]=t,new Uint32Array(i,4,1)[0]=e}this._queue=new _l}add(e,t,r=e,n=t){const i=this._pos>>2,o=this._boxes;return this._indices[i]=i,o[this._pos++]=e,o[this._pos++]=t,o[this._pos++]=r,o[this._pos++]=n,e<this.minX&&(this.minX=e),t<this.minY&&(this.minY=t),r>this.maxX&&(this.maxX=r),n>this.maxY&&(this.maxY=n),i}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const e=this._boxes;if(this.numItems<=this.nodeSize)return e[this._pos++]=this.minX,e[this._pos++]=this.minY,e[this._pos++]=this.maxX,void(e[this._pos++]=this.maxY);const t=this.maxX-this.minX||1,r=this.maxY-this.minY||1,n=new Uint32Array(this.numItems);for(let i=0,o=0;i<this.numItems;i++){const a=e[o++],s=e[o++],l=e[o++],c=e[o++],u=Math.floor(65535*((a+l)/2-this.minX)/t),h=Math.floor(65535*((s+c)/2-this.minY)/r);n[i]=El(u,h)}xl(n,e,this._indices,0,this.numItems-1,this.nodeSize);for(let i=0,o=0;i<this._levelBounds.length-1;i++){const t=this._levelBounds[i];for(;o<t;){const r=o;let n=e[o++],i=e[o++],a=e[o++],s=e[o++];for(let l=1;l<this.nodeSize&&o<t;l++)n=Math.min(n,e[o++]),i=Math.min(i,e[o++]),a=Math.max(a,e[o++]),s=Math.max(s,e[o++]);this._indices[this._pos>>2]=r,e[this._pos++]=n,e[this._pos++]=i,e[this._pos++]=a,e[this._pos++]=s}}}search(e,t,r,n,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const a=[],s=[];for(;void 0!==o;){const l=Math.min(o+4*this.nodeSize,wl(o,this._levelBounds));for(let c=o;c<l;c+=4){const l=this._boxes[c];if(r<l)continue;const u=this._boxes[c+1];if(n<u)continue;const h=this._boxes[c+2];if(e>h)continue;const d=this._boxes[c+3];if(t>d)continue;const p=0|this._indices[c>>2];o>=4*this.numItems?a.push(p):(void 0===i||i(p,l,u,h,d))&&s.push(p)}o=a.pop()}return s}neighbors(e,t,r=1/0,n=1/0,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const a=this._queue,s=[],l=n*n;e:for(;void 0!==o;){const n=Math.min(o+4*this.nodeSize,wl(o,this._levelBounds));for(let r=o;r<n;r+=4){const n=0|this._indices[r>>2],s=this._boxes[r],c=this._boxes[r+1],u=this._boxes[r+2],h=this._boxes[r+3],d=e<s?s-e:e>u?e-u:0,p=t<c?c-t:t>h?t-h:0,f=d*d+p*p;f>l||(o>=4*this.numItems?a.push(n<<1,f):(void 0===i||i(n))&&a.push(1+(n<<1),f))}for(;a.length&&1&a.peek();){if(a.peekValue()>l)break e;if(s.push(a.pop()>>1),s.length===r)break e}o=a.length?a.pop()>>1:void 0}return a.clear(),s}}function wl(e,t){let r=0,n=t.length-1;for(;r<n;){const i=r+n>>1;t[i]>e?n=i:r=i+1}return t[r]}function xl(e,t,r,n,i,o){if(Math.floor(n/o)>=Math.floor(i/o))return;const a=e[n],s=e[n+i>>1],l=e[i];let c=l;const u=Math.max(a,s);l>u?c=u:u===a?c=Math.max(s,l):u===s&&(c=Math.max(a,l));let h=n-1,d=i+1;for(;;){do{h++}while(e[h]<c);do{d--}while(e[d]>c);if(h>=d)break;Sl(e,t,r,h,d)}xl(e,t,r,n,d,o),xl(e,t,r,d+1,i,o)}function Sl(e,t,r,n,i){const o=e[n];e[n]=e[i],e[i]=o;const a=4*n,s=4*i,l=t[a],c=t[a+1],u=t[a+2],h=t[a+3];t[a]=t[s],t[a+1]=t[s+1],t[a+2]=t[s+2],t[a+3]=t[s+3],t[s]=l,t[s+1]=c,t[s+2]=u,t[s+3]=h;const d=r[n];r[n]=r[i],r[i]=d}function El(e,t){let r=e^t,n=65535^r,i=65535^(e|t),o=e&(65535^t),a=r|n>>1,s=r>>1^r,l=i>>1^n&o>>1^i,c=r&i>>1^o>>1^o;r=a,n=s,i=l,o=c,a=r&r>>2^n&n>>2,s=r&n>>2^n&(r^n)>>2,l^=r&i>>2^n&o>>2,c^=n&i>>2^(r^n)&o>>2,r=a,n=s,i=l,o=c,a=r&r>>4^n&n>>4,s=r&n>>4^n&(r^n)>>4,l^=r&i>>4^n&o>>4,c^=n&i>>4^(r^n)&o>>4,r=a,n=s,i=l,o=c,l^=r&i>>8^n&o>>8,c^=n&i>>8^(r^n)&o>>8,r=l^l>>1,n=c^c>>1;let u=e^t,h=n|65535^(u|r);return u=16711935&(u|u<<8),u=252645135&(u|u<<4),u=858993459&(u|u<<2),u=1431655765&(u|u<<1),h=16711935&(h|h<<8),h=252645135&(h|h<<4),h=858993459&(h|h<<2),h=1431655765&(h|h<<1),(h<<1|u)>>>0}function Tl(e){var t;if(!e.length)return function(){return[]};function r(t){return e[t]}return t=new bl(e.length),e.forEach((function(e){var r=e.bounds;t.add(r.xmin,r.ymin,r.xmax,r.ymax)})),t.finish(),function(e,n,i,o){return t.search(e,n,i,o).map(r)}}function Al(e,t,r){var n,i,o,a,s,l,c=t.getVertexData(),u=t.getMultiShapeBounds(e);function h(e,t,r){var n,l,u,h=s[r],d=0,p=c.xx,f=c.yy;n=r==a?i.length-h:s[r+1]-h;for(var m=0;m<n;m++)l=i[m+h],u=o[m+h],d+=Qr.testRayIntersection(e,t,p[l],f[l],p[u],f[u]);return d}function d(e){var t=Math.floor((e-n)/l);return t<0&&(t=0),t>=a&&(t=a-1),t}!function(){var r,u,h,p,f,m,g,_,v,b,w=c.xx,x=0,S=0,E=-1;yr(e,t,(function(){x++})),u=new Uint32Array(2*x),g=0,yr(e,t,(function(e,t,r,n){u[g++]=e,u[g++]=t})),Ca(w,u),i=new Uint32Array(x),o=new Uint32Array(x),a=function(e){var t=Math.pow(e,.75)/10;return Math.ceil(t)}(x),s=new Uint32Array(a+1),n=w[u[0]],l=(w[u[u.length-2]]-n)/a,h=0,p=x-1;for(;S<x;){for(f=u[_=2*S],m=u[_+1],v=w[f],b=w[m],r=E,E=d(v);E>r;)r++,s[r]=h;b-v>=0==!1&&y("Invalid segment"),d(b)-E>1?(i[p]=f,o[p]=m,p--):(i[h]=f,o[h]=m,h++),S++}s[a]=h,h!=p+1&&y("Segment indexing error")}(),this.pointInPolygon=function(e,t){if(!u.containsPoint(e,t))return!1;var r=d(e),n=h(e,t,r);return r>0&&(n+=h(e,t,r-1)),n+=h(e,t,a),isNaN(n)?-1:n%2==1?1:0}}function Cl(e,t){var r=Tl(function(e,t){var r=[];return e.forEach((function(e,n){for(var i=e?e.length:0,o=0;o<i;o++)r.push({ids:e[o],id:n,bounds:t.getSimpleShapeBounds(e[o])})})),r}(e,t)),n=dr(e,t).area();function i(e,r){return!!r.bounds.containsPoint(e[0],e[1])&&(!r.index&&r.bounds.area()>.01*n&&(r.index=new Al([r.ids],t)),r.index?r.index.pointInPolygon(e[0],e[1]):Qr.testPointInRing(e[0],e[1],r.ids,t))}function a(e,t){var r=!1,n=!1;return t.forEach((function(t){var o=i(e,t);-1==o?r=!0:1==o&&(n=!n)})),r||n}function s(e){var t,r,n=[];if(e.length>0){e.sort((function(e,t){return e.id-t.id}));for(var i=0;i<e.length;i++)r=e[i],0!==i&&r.id==e[i-1].id||n.push(t=[]),t.push(r)}return n}function l(e,t){var n=t>0?t:0;return e[0],e[1],r(e[0]-n,e[1]-n,e[0]+n,e[1]+n)}function c(e){var r=e[0],n=t.getVertex(r,0),i=t.getVertex(r,1);return[(n.x+i.x)/2,(n.y+i.y)/2]}this.findEnclosingShapes=function(e){var t=[];return s(l(e)).forEach((function(r){a(e,r)&&t.push(r[0].id)})),t},this.findEnclosingShape=function(e){var t=-1;return s(l(e)).forEach((function(r){a(e,r)&&(t=r[0].id)})),t},this.findShapesEnclosingArc=function(e){var t=c([e]);return this.findEnclosingShapes(t)},this.findPointEnclosureCandidates=function(e,t){var r=l(e,t);return o.pluck(r,"id")},this.pointIsEnclosed=function(e){return a(e,l(e))},this.findSmallestEnclosingPolygon=function(e){var r,n=t.getSimpleShapeBounds(e),o=c(e);return l(o).forEach((function(e){!e.bounds.contains(n)||e.bounds.sameBounds(n)||r&&r.bounds.area()<e.bounds.area()||i(o,e)&&(r=e)})),r?r.id:-1},this.arcIsEnclosed=function(e){return this.pointIsEnclosed(c([e]))},this.pathIsEnclosed=function(e){return this.pointIsEnclosed(c(e))},this.findEnclosedPaths=function(e){var n,i=t.getSimpleShapeBounds(e),o=r(i.xmin,i.ymin,i.xmax,i.ymax),a=[];return o.length>6&&(n=new Al([e],t)),o.forEach((function(r){var o=c(r.ids);i.containsPoint(o[0],o[1])&&i.contains(r.bounds)&&(n?n.pointInPolygon(o[0],o[1]):Qr.testPointInRing(o[0],o[1],e,t))&&a.push(r.ids)})),a.length>0?a:null},this.findPathsInsideShape=function(e){var t=[];return e.forEach((function(e){var r=this.findEnclosedPaths(e);r&&(t=function(e,t){var r,n=[];for(r=0;r<e.length;r++)-1==t.indexOf(e[r])&&n.push(e[r]);for(r=0;r<t.length;r++)-1==e.indexOf(t[r])&&n.push(t[r]);return n}(t,r))}),this),t.length>0?t:null}}function Il(e,t){e.shapes=e.shapes.map((function(e){return e?function(e,t){var r=xr(e,t,"polygon");return r.sort((function(e,t){return Math.abs(t.area)-Math.abs(e.area)})),r.forEach((function(e,n){for(var i,o,a,s=!0,l=n;--l>=0;)if(kl(e,i=r[l],t)){s=!(i.area>0);break}a=s,(o=e).area>0!=a&&(o.area=-o.area,pr(o.ids))})),r.map((function(e){return e.ids}))}(e,t):null}))}function kl(e,t,r){if(!1===t.bounds.contains(e.bounds))return!1;var n=function(e,t){var r=t.getVertex(e,0),n=t.getVertex(e,1);return{x:(r.x+n.x)/2,y:(r.y+n.y)/2}}(e.ids[0],r);return 1==Qr.testPointInRing(n.x,n.y,t.ids,r)}function Pl(e,t,r){var n,i=[],o=[],a=r?-1:1;return(e||[]).forEach((function(e){e.area*a>0?o.push([e]):e.area*a<0&&i.push(e)})),0===i.length||(n=Tl(o.map((function(e,t){return{bounds:e[0].bounds,idx:t}}))),i.forEach((function(e){for(var r,i,s,l,c=-1,u=0,h=e.area*-a,d=e.bounds,p=n(d.xmin,d.ymin,d.xmax,d.ymax),f=0,m=p.length;f<m;f++)i=p[f].idx,s=(r=o[i][0]).area*a,(l=r.bounds.contains(e.bounds)&&s>h)&&p.length>1&&!kl(e,r,t)||l&&(0===u||s<u)&&(u=s,c=i);-1==c?x():o[c].push(e)}))),o}function Ml(e){var t;return e&&0!==e.length?{bounds:(t={points:e,pointCount:e.length,bounds:Qr.getPathBounds(e)}).bounds,pathData:[t],partCount:1,pointCount:t.pointCount}:{partCount:0,pointCount:0}}function Rl(e,t,r){if("point"==r)return Ml(e);var n=0,i=new St,o=[];return!e||"polyline"!=r&&"polygon"!=r||e.forEach((function(e,a){var s=function(e){var t,r,n,i,o=[],a=0;for(;e.hasNext();)t=e.x,r=e.y,0!==a&&n==t&&i==r||(o.push([t,r]),a++),n=t,i=r;return{points:o,pointCount:o.length}}(t.getShapeIter(e)),l=!0;s.ids=e,"polygon"==r?(s.area=Qr.getPlanarPathArea2(s.points),l=s.pointCount>3&&0!==s.area):"polyline"==r&&(l=s.pointCount>1),l?(n+=s.pointCount,s.bounds=Qr.getPathBounds(s.points),i.mergeBounds(s.bounds),o.push(s)):w("Skipping a collapsed",r,"path")})),{pointCount:n,pathData:o,pathCount:o.length,bounds:i}}var Dl=Object.freeze({__proto__:null,exportPathData:Rl,exportPointData:Ml});function Ol(e){return JSON.stringify(e).replace(/\n/g,"\n").replace(/\r/g,"\r")}function Ll(e){var t=o.arrayToIndex(e),r="",n=new RegExp('"|"',"g");function i(e,n){if(e in t&&o.isArray(n)){var i=JSON.stringify(n);if(i.indexOf(!1))return r+i.replace(/,/g,", ")+r}return n}return function(e){return JSON.stringify(e,i,"  ").replace(n,"")}}var Bl=Object.freeze({__proto__:null,getFormattedStringify:Ll,stringifyAsNDJSON:Ol});function $l(e,t){return t.getArcLength(e)>1}function zl(e,t,r){var n=t.arcs,i=n.getVertexData(),o=i.xx,a=i.yy,s=t.getConnectedArcs(e),l=e;if(r&&(s=s.filter(r)),!$l(e,n)||0===s.length)return e;var c,u,h,d,p=n.indexOfVertex(e,-1),f=o[p],m=a[p],g=n.indexOfVertex(e,-2),_=o[g],v=a[g];for(d=0;d<s.length;d++)$l(u=s[d],n)&&(h=n.indexOfVertex(u,-2),l!=e?2==Fl(_,v,f,m,o[c],a[c],o[h],a[h])&&(c=h,l=u):(c=h,l=u));return l==e&&y("Pathfinder error"),l}function Fl(e,t,r,n,i,o,a,s){var l,c=Qr.signedAngle(e,t,r,n,i,o),u=Qr.signedAngle(e,t,r,n,a,s);return c<=0||u<=0?(x(),c<=0&&x(Qr.orient2D(e,t,r,n,i,o)),u<=0&&x(Qr.orient2D(e,t,r,n,a,s)),l=c>0?1:u>0?2:0):c<u?l=1:u<c?l=2:isNaN(c)||isNaN(u)?y("Invalid node geometry"):(l=ql(i-r,o-n,a-r,s-n),x()),l}function ql(e,t,r,n){var i=Qr.orient2D(e,t,0,0,r,n);return i>0?2:i<0?1:0}var Nl=Object.freeze({__proto__:null,chooseRighthandVector:ql,getRightmostArc:zl});function jl(e,t,r){return e&~r|t&r}function Ul(e,t,r){var n,i=or(t);i==t?n=-4:(n=-49,e<<=4),r[i]&=e|n}function Vl(e,t){var r=or(e),n=t[r];return r!=e&&(n>>=4),7&n}function Gl(e,t){gr(e,(function(e){e<0?t[~e]|=128:t[e]|=8}))}function Wl(e,t,r,n,i,o,a){gr(e,(function(e){var s=e<0,l=s?~e:e,c=r[l],u=s?i:n,h=s?n:i,d=c;t.arcIsLollipop(e)?(x(),d=0):(u&&(d|=3),h&&(d|=48),a>0&&(d|=a),!o||34&~d||(d&=-18)),r[l]=d}))}function Hl(e,t,r,n,i,o){gr(e,(function(e){var t=e<0,a=t?~e:e,s=r[a],l=255;(t?i:n)&&(o&&(l&=-2),l^=2),(t?n:i)&&(o&&(l&=-17),l^=32),r[a]=s&l}))}function Zl(e,t,r){var n=null;return r&&(n=function(e){return r(~e)}),function(r){var i,o,a=[],s=r;if(o=r,e.arcs.getArcLength(o)>1==0)return null;do{if(!t(s))return null;if(a.push(s),(s=~zl(i=s,e,n))==~i)return x(),null}while(s!=r);return 0===a.length?null:a}}function Yl(e,t){var r=e.arcs,n=Zl(e,(function(e){var r=Vl(e,t),n=!1;3==r&&(n=!0,Ul(1,e,t));return n}),(function(e){return!(1&~Vl(e,t))}));return t=t||new Uint8Array(r.size()),function(e,i){var o,a="dissolve"==i,s=!0,l="flatten"==i;return e.length>0?(o=[],Wl(e,r,t,s,l,a),dn(e,(function(e){for(var t,r=0,i=e.length;r<i;r++)(t=n(e[r]))&&o.push(t)})),Hl(e,0,t,s,l,!0)):o=e,o}}var Xl=Object.freeze({__proto__:null,andBits:function(e,t,r){return e&(~r|t)},closeArcRoutes:Hl,getPathFinder:Zl,getRingIntersector:Yl,getRouteBits:Vl,markPathsAsUsed:Gl,openArcRoutes:Wl,setBits:jl,setRouteBits:Ul});function Kl(e,t,r){var n=r.min_gap_area||r.min_area||r.gap_fill_area;if(0==+n)return{filter:function(){return!1},threshold:0};var i=r.sliver_control>=0?r.sliver_control:0,o=da(t),a=n&&"auto"!=n?Qs(n,o):ec(e,t.arcs),s=i>0?Ql(t.arcs,a,i):function(e,t){var r=t.arcs.isPlanar()?Qr.getPlanarPathArea:Qr.getSphericalPathArea;return function(n){var i=r(n,t.arcs);return Math.abs(i)<e}}(a,t);return{threshold:a,filter:s,label:function(e,t){t&&(e=e.replace(" ","+ ")+" variable");return e+" threshold"}(nl(a,o),i>0)}}function Ql(e,t,r){r>=0==!1&&(r=1),(r>1||t>=0==!1)&&y("Invalid parameter");var n=Jl(e,r);return function(e){return Math.abs(n(e))<t}}function Jl(e,t){var r=Math.sqrt(t);return function(t){var n=Qr.getPathArea(t,e),i=Qr.getPathPerimeter(t,e),o=Qr.calcPolsbyPopperCompactness(n,i);return n*(r*o+1-r)}}function ec(e,t){var r=0,n=t.isPlanar()?Qr.distance2D:Qr.greatCircleDistance,i=0,o=0,a=function(e,t,r,a){var s=n(r[e],a[e],r[t],a[t]);o++,i+=(s-i)/o};pn(e.shapes,(function(e){r++,_r(e,t,a)}));var s=o/r||0,l=Math.pow(s,.75),c=i*i/50*l;return c=es(c,2)}var tc=Object.freeze({__proto__:null,calcMaxSliverArea:function(e){var t=e.getBounds().width()/2,r=e.getBounds().height()/2,n=0,i=0;return e.forEachSegment((function(e,o,a,s){var l=Math.abs(a[e]-a[o]),c=Math.abs(s[e]-s[o]);l<t&&c<r&&(i+=(Math.sqrt(l*l+c*c)-i)/++n)})),i*i},getDefaultSliverThreshold:ec,getSliverAreaFunction:Jl,getSliverFilter:Kl,getSliverTest:Ql});function rc(e){return nc(e).modes[0]}function nc(e,t){var r=function(e){var t,r,n=[],i={},o=[];for(t=0;t<e.length;t++)(r=e[t])in i==0?(i[r]=n.length,n.push(r),o.push(1)):o[i[r]]++;return{values:n,counts:o}}(e),n=function(e){var t,r,n=e.counts,i=e.values,o=n.length>0?function(e){var t,r=-1/0;for(t=0;t<e.length;t++)e[t]>r&&(r=e[t]);return r}(n):0,a=0,s=[];for(t=0;t<n.length;t++)(r=n[t])===o?s.push(i[t]):r>a&&(a=r);return{modes:s,margin:s.length>1?0:o-a,count:o}}(r);return t&&(n.counts=r.counts,n.values=r.values),n}var ic=Object.freeze({__proto__:null,getMode:rc,getModeData:nc});function oc(e,t,r){var n=o.extend({},e),i={expression:r.where,invert:!!r.invert,verbose:!1,no_replace:r.no_replace};return a.filterFeatures(n,t,i)}function ac(e,t,r){var n,i,o,a=r.expression;return r.where&&(e=oc(e,t,r),a+=" where "+r.where),i=u("defs"),n=sc(e,t,r.expression)(null,i),r.to_layer||v(a+":  "+n),o={expression:r.expression,value:n},r.where&&(o.where=r.where),e.name&&(o.layer_name=e.name),o}function sc(e,t,r){var n,i,a,s=0,l=0,c=-1,u=[],h={count:b,sum:v,sums:w,average:v,mean:v,median:v,quantile:v,iqr:v,quartile1:v,quartile2:v,quartile3:v,min:v,max:v,mode:w,collect:w,collectIds:function(){w(c)},first:function(e){0===s&&(u[l]=e);return l++,e},every:function(e){e=!!e,u[l]=(0===s||u[l])&&e,l++},some:function(e){e=!!e,u[l]=u[l]||e,l++},last:b},d={count:m((function(){return s}),0),sum:m(o.sum,0),sums:m((function(e){var t=e&&e.length?e[0].length:0,r=o.initializeArray(Array(t),0);return e.forEach((function(e){if(e&&e.length)for(var n=0;n<t;n++)r[n]+=+e[n]||0})),r})),median:m(o.findMedian),quantile:(a=o.findQuantile,function(e,t){var r=l++;return s>0?a(u[r],t):null}),iqr:m((function(e){return o.findQuantile(e,.75)-o.findQuantile(e,.25)})),quartile1:m((function(e){return o.findQuantile(e,.25)})),quartile2:m(o.findMedian),quartile3:m((function(e){return o.findQuantile(e,.75)})),min:m((function(e){return o.getArrayBounds(e).min})),max:m((function(e){return o.getArrayBounds(e).max})),average:m(o.mean),mean:m(o.mean),mode:m(rc),collect:m(f),collectIds:m(f),first:m(f),every:m(f,!1),some:m(f,!1),last:m(f)},p=Ki(e);return e.geometry_type&&(h.width=h.height=function(){},d.width=function(){return mo(e,t).width()},d.height=function(){return mo(e,t).height()}),n=Ns(r,e,t,{context:h,no_assign:!0,no_warn:!0,no_return:!0}),i=Ns(r,e,t,{context:d,no_warn:!0}),function(e,t){var r;return e?function(e){e.forEach(g)}(e):function(){for(var e=0;e<p;e++)g(e)}(),r=i(void 0,t),c=-1,s=0,l=0,u=[],r};function f(e){return e}function m(e,t){var r=arguments.length>1?t:null;return function(){var t=l++;return s>0?e(u[t]):r}}function g(e){(e<0||e>=p)&&y("Invalid record index"),c=e,n(e),s++,l=0}function v(e){return isNaN(e)&&e&&_("Expected a number, received:",e),w(e)}function b(e){return u[l++]=e,e}function w(e){var t;return 0===s&&(u[l]=[]),(t=u[l]).length!=s&&_("Evaluation failed"),t.push(e),l++,e}}a.calc=function(e,t,r){var n=e.map((e=>ac(e,t,r)));return r.to_layer?{info:{},layers:[{name:r.name||"info",data:new Fi(n)}]}:null};var lc=Object.freeze({__proto__:null,applyCalcExpression:ac,compileCalcExpression:sc,evalCalcExpression:function(e,t,r){return sc(e,t,r)()}});function cc(e,t){var r=sc({data:e},null,t);return function(e,t){e||(e=[]),r(e,t)}}var uc=Object.freeze({__proto__:null,getJoinCalc:cc});function hc(e,t){if(!e||0===e.length)return function(){return 0};e.forEach((function(e){Ji(t,e)}));var r={},n=0,i=t.getRecords(),o=dc(e);return function(e){var t=o(i[e]);return t in r==!1&&(r[t]=n++),r[t]}}function dc(e){return e.reduce((function(e,t){var r=function(e){return String(e[t])};return e?function(t){return e(t)+"~~"+r(t)}:r}),null)}function pc(e,t,r){return fc(e,function(e,t){for(var r,n=[],i=0;i<t;i++)(r=e(i))in n?n[r].push(i):n[r]=[i];return n}(t,e.length),r)}function fc(e,t,r){var n,i=r.sum_fields||[],o=r.copy_fields||[];function a(t,r){for(var n,i=0,o=0;o<r.length;o++)i+=(n=e[r[o]])&&n[t]||0;return i}return r.fields&&(o=o.concat(r.fields)),r.calc&&(n=cc(new Fi(e),r.calc)),t.map((function(t){var r,s,l={};for(s=e[(t=t||[])[0]],r=0;r<i.length;r++)l[i[r]]=a(i[r],t);for(r=0;r<o.length;r++)l[o[r]]=s?s[o[r]]:null;return n&&n(t,l),l}))}var mc=Object.freeze({__proto__:null,aggregateDataRecords:pc,getCategoryClassifier:hc,getMultiFieldKeyFunction:dc,recombineDataRecords:function(e,t,r,n){for(var i=[],o=0;o<r;o++)i.push(t(o));return fc(e,i,n)}});function gc(e,t,r,n){var i=function(e,t){var r=[];return vr(e,(function(e){var n=t(e.shapeId);n in r==!1&&(r[n]=[]),r[n].push(e.arcId)})),r}(e.shapes,t),o=function(e){var t=new Uint8Array(e.size()),r=function(e){return t[or(e)]>0},n=function(e){t[or(e)]=0},i=new Bo(e);return function(e){e.forEach((function(e){t[or(e)]=1}));var o=function(e,t,r){var n=[];return e.forEach((function(e){0===t.getConnectedArcs(e,r).length&&n.push(~e),0===t.getConnectedArcs(~e,r).length&&n.push(e)})),n}(e,i,r),a=yc(o,i,r,n),s=yc(e,i,r,n),l=a.concat(s);return e.forEach((function(e){t[or(e)]=0})),l}}(r);return i.map(o)}function yc(e,t,r,n){var i=[];return e.forEach((function(e){for(var o,a=[],s=e;r(s)&&(a.push(s),o=r(s)?t.getConnectedArcs(s,r):[],n(s),o.length>0);)s=~o[0];a.length>0&&i.push(a)})),i}function _c(e,t){var r=function(e,t){var r=[],n=[],i=[],a=e.map((function(e,r){return t(r)}));return vr(e,s),n.forEach(m),i;function s(e){var t=e.arcId,o=t<0?~t:t,a=i.length,s=r[o];s||(s=[],r[o]=s),s.push(a),e.group=s,i.push(e),3==s.length&&n.push(s)}function l(e,t){for(var r,n,o=0;o<e.length-1;o++){r=i[e[o]];for(var a=o+1;a<e.length;a++)if(t(r,n=i[e[a]]))return[r.segId,n.segId]}return null}function c(t,r){return vc(t,i,e).arcId===~vc(r,i,e).arcId}function u(t,r){return bc(t,i,e).arcId===~bc(r,i,e).arcId}function h(e,t){return p(e,t)&&c(e,t)&&u(e,t)}function d(e,t){return p(e,t)&&(c(e,t)||u(e,t))}function p(e,t){return e.arcId===~t.arcId&&a[e.shapeId]===a[t.shapeId]}function f(e){e.forEach((function(t){i[t].group=e}))}function m(e){var t=l(e,h)||l(e,d)||l(e,p);t&&(f(e=e.filter((function(e){return!o.contains(t,e)}))),f(t),e.length>2&&m(e))}}(e,t);return function(e,t,r){var n=[];return e.forEach(i),n;function i(e){e.used||(c(e)||s(e))}function a(e,t){t in n==!1&&(n[t]=[]),n[t].push(e)}function s(e){var t=[e.arcId],n=l(e);for(e.used=!0;n&&n!=e;)t.push(n.arcId),n.used=!0,(n=l(n))&&n!=e&&n.used&&y("buildRing() topology error");n||y("buildRing() traversal error"),e.used=!0,a(t,r(e.shapeId))}function l(r,n){var i,o=vc(r,e,t);return n=n||0,o!=r&&(i=c(o))&&(n>100&&y("deep recursion -- unhandled topology problem"),o=1==t[i.shapeId][i.partId].length?l(o,n+1):l(i,n+1)),o}function c(t){var n,i=r(t.shapeId);return null===(n=o.find(t.group,(function(n){var o=t,a=e[n];return o!=a&&!a.used&&r(a.shapeId)===i&&o.arcId==~a.arcId})))?null:e[n]}}(r,e,t)}function vc(e,t,r){return wc(e,t,r,1)}function bc(e,t,r){return wc(e,t,r,-1)}function wc(e,t,r,n){var i,o=r[e.shapeId][e.partId].length,a=(e.i+n)%o;return a<0&&(a+=o),(i=t[e.segId-e.i+a])&&i.shapeId==e.shapeId||y("index error"),i}var xc=Object.freeze({__proto__:null,dissolvePolygonGeometry:_c});function Sc(e,t,r,n){var i,a=null;if(e.data)for(var s=0,l=(a=pc(e.data.getRecords(),r,n)).length;s<l;s++)t&&!t[s]&&(t[s]=null);return i={name:n.no_replace?null:e.name,shapes:t,data:a?new Fi(a):null,geometry_type:e.geometry_type},n.silent||function(e,t){var r=Ki(e),n=Ki(t),i=o.format("Dissolved %,d feature%s into %,d feature%s",r,o.pluralSuffix(r),n,o.pluralSuffix(n));v(i)}(e,i),i}function Ec(e,t){var r=new Int32Array(e.length);o.initializeArray(r,-1);var n=[],i=[];function a(e,o,a){var l=r[o];if(-1!=l&&t.flat){if(!(a&&a(e)>a(l)))return;s(o,l),r[o]=l,l=-1}-1==l?r[o]=e:-2==l?n[o].push(e):(n[o]=[l,e],r[o]=-2),i[e].push(o)}function s(e,t){for(var r=i[t],n=0;n<r.length;n++)if(r[n]===e){r[n]=-1;break}}this.getTileIdsByShapeId=function(e){var t=i[e];return t?t.filter((function(e){return e>=0})):[]},this.getShapeIdByTileId=function(e){var t=r[e];return t>=0?t:-1},this.getShapeIdsByTileId=function(e){var t=r[e];return t>=0?[t]:-1==t?[]:n[e]},this.indexTileIdsByShapeId=function(e,t,r){i[e]=[];for(var n=0;n<t.length;n++)a(e,t[n],r)},this.flatten=function(){n.forEach((function(e,t){!function(e){var t,i=n[e],o=i[0];r[e]=o;for(var a=0;a<i.length;a++)(t=i[a])!=o&&s(e,t)}(t)})),n=[]},this.getUnusedTileIds=function(){for(var e=[],t=0,n=r.length;t<n;t++)-1==r[t]&&e.push(t);return e},this.addTileToShape=function(e,t){e in i!=!1&&-1==r[t]||y("Internal error"),r[t]=e,i[e].push(t)}}function Tc(e,t,r){for(var n=0,i=e.length;n<i;n++)e[n]=Ac(e[n],t,r)}function Ac(e,t,r){return fn(e,(function(e){var n=function(e,t){for(var r=0,n=0,i=e.length;n<i;n++)t.arcIsDegenerate(e[n])&&(r++,e[n]=null);return r>0?e.filter((function(e){return null!==e})):e}(e,t);return"polygon"==r&&n&&(Cc(n),0===Qr.getPlanarPathArea(n,t)&&(n=null)),n}))}function Cc(e){var t=e.length;if(t>=2){if(e[0]==~e[t-1])e.pop(),e.shift();else for(var r=1;r<t;r++)if(e[r-1]==~e[r]){e.splice(r-1,2);break}e.length<t&&Cc(e)}}function Ic(e){var t=new Ma(e.arcs.size()),r=function(e){return t.hasId(~e)};return function(e){t.setIds(e);var r=n(e);return t.clear(),r};function n(e){for(var t=null,r=0,n=e.length;r<n-1;r++)if(null!==(t=i(e,e[r])))return t;return Cc(e),e.length>0?[e]:[]}function i(n,i){var s,l,c,u=e.getConnectedArcs(i,r);if(u.length<2)return null;s=[];for(var h=0;h<u.length;h++)(c=a(n,l=~u[h]))>-1&&(t.clearId(l),s.push(c));return s.length<2?null:kc(n,s).reduce(o,null)}function o(e,t){var r=n(t);return null===e?r:(e.push.apply(e,r),e)}function a(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}}function kc(e,t){var r=[];o.genericSort(t,!0),t[0]>0&&r.push(e.slice(0,t[0]));for(var n=0,i=t.length;n<i;n++)n<i-1?r.push(e.slice(t[n],t[n+1])):r.push(e.slice(t[n]));return r.length>t.length&&o.merge(r[0],r.pop()),r}a.dissolve=function(e,t,r){var n,i;return(r=o.extend({},r)).where?function(e,t,r,n){n&&n.where||y('Missing required "where" parameter');var i=e(oc(t,r,n),r,o.defaults({where:null},n)),s=oc(t,r,o.defaults({invert:!0},n));return a.mergeLayers([s,i],{verbose:!1,force:!0})[0]}(a.dissolve,e,t,r):(r.field&&(r.fields=[r.field]),i=hc(r.fields,e.data),r.multipart||r.group_points?n=function(e,t){e.shapes&&e.geometry_type||_("Layer is missing geometry");hn(e.shapes);var r=[];return e.shapes.forEach((function(e,n){var i=t(n);e&&(r[i]?r[i].push.apply(r[i],e):r[i]=e)})),r}(e,i):"polygon"==e.geometry_type?n=_c(e.shapes,i):"polyline"==e.geometry_type?n=gc(e,i,t):"point"==e.geometry_type&&(n=function(e,t,r){var n=!r.planar&&en(mo(e)),i=r.weight?Ns(r.weight,e,null):null,o=[];return 0!==ho(e.shapes)&&_("Dissolving multi-part points is not supported"),e.shapes.forEach((function(e,r){var a,s=t(r),l=i?i(r):1,c=e&&e[0];c&&(n&&(a=[],Qr.lngLatToXYZ(c[0],c[1],a),c=a),o[s]=function(e,t,r){var n,i,o=t[0],a=t[1];return o==o&&a==a&&r>0&&(e?(n=e.sum+r,i=e.sum/n,e.centroid[0]=i*e.centroid[0]+r*o/n,e.centroid[1]=i*e.centroid[1]+r*a/n,3==t.length&&(e.centroid[2]=i*e.centroid[2]+r*t[2]/n),e.sum=n):e={sum:r,centroid:t.concat()}),e}(o[s],c,l))})),o.map((function(e){var t,r;return e?(n?(t=e.centroid,r=[],Qr.xyzToLngLat(t[0],t[1],t[2],r)):r=e.centroid,e?[r]:null):null}))}(e,i,r)),Sc(e,n,i,r))};var Pc=Object.freeze({__proto__:null,cleanShapes:Tc,getSelfIntersectionSplitter:Ic,removeSpikesInPath:Cc,splitPathByIds:kc});function Mc(e,t){var r=Ic(e);return function(n,i,o){var a=t?Qr.getSphericalPathArea:Qr.getPlanarPathArea;dn(n,(function(t){var n=r(t);0===n.length&&x(),n.forEach((function(t,r){var n=a(t,e.arcs);n>0?i.push(t):n<0&&o.push(t)}))}))}}var Rc=Object.freeze({__proto__:null,deleteHoles:function(e,t){pn(e.shapes,(function(e){if(Qr.getPathArea(e,t)<=0)return null}))},getHoleDivider:Mc});function Dc(e){var t,r=new Bo(e.arcs),n=function(e){for(var t,r=new Int32Array(e.arcs.size()),n=0,i=0,o=e.arcs.size();i<o;i++)t=e.findDuplicateArc(i),r[i]=t,i!=t&&n++;return n>0?r:null}(r);return n&&Oc(e,n),t=function(e){var t=po(e.layers,e.arcs),r=e.arcs.size(),n=e.arcs.deleteArcs(t),i=e.arcs.size(),o=r-i;o>0&&Oc(e,n);return o}(e),t>0&&(r=new Bo(e.arcs)),r}function Oc(e,t){var r=function(e){for(var r,n,i,o=0;o<e.length;o++)n=or(r=e[o]),i=t[n],e[o]=r==n?i:~i;return e};e.layers.forEach((function(e){Gi(e)&&pn(e.shapes,r)}))}function Lc(e,t){var r,n=t||{},i=e.arcs,o=i&&i.getBounds();if(!o||!o.hasBounds())return new Bo([]);r=n.snap_interval?el(n.snap_interval,da(e)):!n.no_snap&&o.hasBounds()?$r(o.toArray()):0,x(),i.flatten();var a=function(e,t){var r,n,i,o=e.arcs,a=t>0?{}:{tolerance:0},s=!1;r=Fr(o,t),n=o.dedupCoords(),i=$c(e,a),(i>0||r>0||n>0)&&(s=!0);i>0&&(i=0,r=Fr(o,t),o.dedupCoords(),r>0&&(i=$c(e,a)),i>0&&(o.dedupCoords(),x()));return s}(e,r);return(a||n.rebuild_topology)&&wo(e),e.layers.forEach((function(e){Gi(e)&&Tc(e.shapes,i,e.geometry_type)})),Dc(e)}function Bc(e,t){return Fc(Uc(e,t),e)}function $c(e,t){var r=e.arcs.getPointCount(),n=Bc(e.arcs,t),i=e.arcs.getPointCount();return zc(e,n),i-r}function zc(e,t){var r=function(e,t){return function(e){for(var t=[],n=0;n<e.length;n++)r(e[n],t);return t};function r(r,n){var i,o=r<0,a=o?~r:r,s=e[a],l=(a>=e.length-1?t:e[a+1])-1;do{o?(i=~l,l--):(i=s,s++),n.push(i)}while(l-s>=0)}}(t,e.arcs.size());e.layers.forEach((function(e){Gi(e)&&pn(e.shapes,r)}))}function Fc(e,t){var r,n,i,o,a=t.getVertexData(),s=a.xx,l=a.yy,c=a.nn,u=0,h=0,d=[],p=t.size(),f=new Uint32Array(p),m=jc(Nc(e,s,l),t),g=t.getPointCount()+2*m.length,_=new Float64Array(g),v=new Float64Array(g);m.reverse(),o=m.pop();for(var b=0,w=0;b<p;b++){for(i=c[b],f[b]=w,r=0,n=0;r<i;){for(_[h]=s[u],v[h]=l[u],h++,n++;o&&o.i==u;)_[h]=o.x,v[h]=o.y,h++,n++,d[w++]=n,n=0,_[h]=o.x,v[h]=o.y,h++,n++,o=m.pop();r++,u++}d[w++]=n}return h!=g&&y("[insertCutPoints()] Counting error"),t.updateVertexData(d,_,v,null),f}function qc(e,t,r,n,i,o){return(n<r||n>r+1)&&y("Out-of-sequence arc ids:",r,n),{x:e,y:t,i:r}}function Nc(e,t,r){return e.sort((function(e,n){return e.i!=n.i?e.i-n.i:Qr.distanceSq(t[e.i],r[e.i],e.x,e.y)-Qr.distanceSq(t[n.i],r[n.i],n.x,n.y)})),e}function jc(e,t){var r=[],n=0;return t.forEach2((function(t,i,o,a){for(var s,l,c=t+i-1,u=o[t],h=a[t],d=o[c],p=a[c];n<e.length&&e[n].i<=c;)s=e[n],l=r[r.length-1],s.x==u&&s.y==h||s.x==d&&s.y==p||l&&l.x==s.x&&l.y==s.y&&l.i==s.i||r.push(s),n++})),r}function Uc(e,t){var r=Ra(e,t),n=e.getVertexData();return function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;o++)r=qc((t=e[o]).x,t.y,t.a[0],t.a[1]),n=qc(t.x,t.y,t.b[0],t.b[1]),r&&i.push(r),n&&i.push(n);return i}(r,n.xx,n.yy)}var Vc=Object.freeze({__proto__:null,addIntersectionCuts:Lc,cutPathsAtIntersections:$c,divideArcs:Bc,filterSortedCutPoints:jc,findClippingPoints:Uc,getCutPoint:qc,insertCutPoints:Fc,remapDividedArcs:zc,sortCutPoints:Nc});function Gc(e){e.detachAcyclicArcs();var t=function(e){for(var t=e.arcs,r=[],n=[],i=[],o=[],a=new Uint8Array(t.size()),s=Zl(e,h),l=0,c=a.length;l<c;l++)u(l),u(~l);return{cw:r,ccw:n,empty:i,lostArcs:o};function u(e){var a,l;if(d(e)){if(!(a=s(e)))return o.push(e),void x();(l=Qr.getPlanarPathArea(a,t))>0?r.push(a):l<0?n.push(a):i.push(a)}}function h(e){return d(e,!0)}function d(e,t){var r=or(e),n=r==e?1:2,i=!(a[r]&n);return t&&i&&(a[r]|=n),i}}(e),r=t.cw.map((function(e){return[e]}));x();var n=[],i=new Cl(r,e.arcs);return t.ccw.forEach((function(e){var t=i.findSmallestEnclosingPolygon(e);t>-1?r[t].push(e):(pr(e),n.push([e]))})),x(o.format("Detect holes (holes: %d, enclosures: %d)",t.ccw.length-n.length,n.length)),{mosaic:r,enclosures:n,lostArcs:t.lostArcs}}var Wc=Object.freeze({__proto__:null,buildPolygonMosaic:Gc,mosaic:function(e,t){var r,n,i,o,a,s,l,c,u=[];return e.arcs||_("Dataset is missing path data"),n=Gc(r=Lc(e,t)),u.push({name:"mosaic",shapes:n.mosaic,geometry_type:"polygon"}),t.debug&&(u.push({geometry_type:"polygon",name:"mosaic-enclosure",shapes:n.enclosures}),n.lostArcs.length>0&&(u=u.concat((i=n.lostArcs,o=r.arcs,a={geometry_type:"polyline",name:"lost-arcs",shapes:[]},s={geometry_type:"point",name:"lost-arc-endpoints",shapes:[]},l=[],c=[],i.forEach((function(e){var t=o.getVertex(e,0),r=o.getVertex(e,-1);l.push({ARCID:e}),a.shapes.push([[e]]),c.push({ARCID:e},{ARCID:e}),s.shapes.push([[t.x,t.y]],[[r.x,r.y]])})),a.data=new Fi(l),s.data=new Fi(c),[a,s])))),u}});function Hc(e){var t=new Int32Array(e),r=new Int32Array(e);o.initializeArray(t,-1),o.initializeArray(r,-1),this.setId=function(e,n){e<0?r[~e]=n:t[e]=n},this.hasId=function(e){return this.getId(e)>-1},this.getId=function(n){var i=n<0?~n:n;return i>=e?-1:n<0?r[i]:t[i]}}function Zc(e){var t=[],r=new Hc(e),n=r.setId;return r.setId=function(e,i){r.hasId(e)||t.push(e),n(e,i)},r.clear=function(){t.forEach((function(e){n(e,-1)})),t=[]},this.clearId=function(e){r.hasId(e)||y("Tried to clear an unset id"),n(e,-1)},r}function Yc(e,t,r,n){var i,o,a,s=r.arcs,l=new Ma(e.length),c=Mc(r),u=new Ma(s.size()),h=new Ma(s.size());function d(e){i=i?i.concat(e):e}function p(t){o=s.getSimpleShapeBbox(t),u.setIds(t),function(t){var r,n=t.concat();for(;n.length>0;)(r=m(n.pop()))>=0&&f(n,e[r])}(t),u.clear(),l.clear()}function f(e,t){for(var r,n,i,o,a=0,s=t.length;a<s;a++)for(var l=0,c=(n=t[a]).length;l<c;l++)r=n[l],o=void 0,o=~(i=r),!(u.hasId(i)||u.hasId(o)||h.hasId(i)||h.hasId(o))&&e.push(~r)}function m(e){var r=t.getShapeIdByArcId(e);return-1==r||l.hasId(r)?-1:!1===s.arcIsContained(or(e),o)?(x(),-1):(l.setId(r),a.push(r),r)}this.getTilesInShape=function(e,t){var r,o=[],s=[];return a=[],i=[],n.no_holes?c(e,o,s):(c(e,o,s),s.forEach(d),h.setIds(i)),o.forEach(p),r=a,a=null,h.clear(),i=null,r}}var Xc=Object.freeze({__proto__:null,PolygonTiler:Yc});function Kc(e,t,r){var n=r||{},i=e.shapes;Mc(t);var o=Gc(t).mosaic,a=new Qc(o,t.arcs),s=new Ma(o.length),l=new Ec(o,n),c=new Yc(o,a,t,n),u=null;function h(e,t,r){var n=[],i=r?-1:1;return function(r){var o;return r in n?o=n[r]:(o=i*Math.abs(Qr.getShapeArea(e[r],t)),n[r]=o),o}}function d(e,t){return o[e]}function p(e){for(var r,n,i,s,c=o[e][0],u=t.arcs,h=-1,d=0,p=0;p<c.length;p++)r=c[p],(i=a.getShapeIdByArcId(~r))<0||(n=l.getShapeIdByTileId(i))<0||(s=Qr.getPathPerimeter([r],u))>d&&(h=n,d=s);h>-1&&l.addTileToShape(h,e)}!n.simple&&n.flat&&(u=function(e,t,r){var n;r&&"max-area"!=r?"min-area"==r?n=h(e,t,!0):"max-id"==r?n=function(e){return e}:"min-id"==r?n=function(e){return-e}:_("Unknown overlap rule:",r):n=h(e,t,!1);return n}(e.shapes,t.arcs,n.overlap_rule)),this.mosaic=o,this.nodes=t,this.getSourceIdsByTileId=l.getShapeIdsByTileId,this.getTileIdsByShapeId=l.getTileIdsByShapeId,i.forEach((function(e,t){var r=c.getTilesInShape(e,t);l.indexTileIdsByShapeId(t,r,u)})),n.flat&&l.flatten(),this.removeGaps=function(e){n.flat||y("MosaicIndex#removeGaps() should only be called with a flat mosaic");var t=l.getUnusedTileIds(),r=t.filter((function(t){var r=o[t];return e(r[0])}));return r.forEach(p),{removed:r.length,remaining:t.length-r.length}},this.getUnusedTiles=function(){return l.getUnusedTileIds().map(d)},this.getTilesByShapeIds=function(e){return function(e){var t,r,n,i,o=[];for(n=0;n<e.length;n++)for(r=l.getTileIdsByShapeId(e[n]),i=0;i<r.length;i++)t=r[i],s.hasId(t)||(s.setId(t),o.push(t));return s.clear(),o}(e).map(d)}}function Qc(e,t){var r,n=new Hc(t.size());function i(e){for(var t,i=0,o=e.length;i<o;i++)t=e[i],n.setId(t,r)}e.forEach((function(e,t){r=t,e.forEach(i)})),this.getShapeIdByArcId=function(e){return n.getId(e)}}var Jc=Object.freeze({__proto__:null,MosaicIndex:Kc,ShapeArcIndex:Qc});function eu(e,t,r){(r=o.extend({},r)).field&&(r.fields=[r.field]);var n=hc(r.fields,e.data),i=function(e,t){return e.shapes.reduce((function(e,r,n){var i=t(n);return i in e==!1&&(e[i]=[]),e[i].push(n),e}),[])}(e,n);return Sc(e,tu(i,e,t,r),n,r)}function tu(e,t,r,n){var i,a,s=ur(t.shapes,r.arcs),l=new Kc(t,new Bo(r.arcs,s),{flat:!n.allow_overlaps,simple:1==e.length,overlap_rule:n.overlap_rule}),c=!n.allow_overlaps&&(n.sliver_control||n.gap_fill_area);c&&(a=Kl(t,r,o.extend({sliver_control:1},n)),i=l.removeGaps(a.filter));var u,h,d,p,f=Yl(l.nodes),m=e.map((function(e){var t=l.getTilesByShapeIds(e);return n.tiles?t.reduce((function(e,t){return e.concat(t)}),[]):function(e,t){for(var r,n,i=[],o=[],a=0,s=e.length;a<s;a++)n=e[a],i.push(n[0]),n.length>1&&(o=o.concat(n.slice(1)));r=t(i.concat(o),"dissolve"),r.length;return r.length>0?r:null}(t,f)}));if(m=function(e,t){var r=function(e,r){pr(r);var n=t([r],"flatten");return n.length>1?(n.forEach(pr),e=e.concat(n)):e.push(pr(r)),e};return e.map((function(e){return e?e.reduce(r,[]):null}))}(m,f),c&&!n.quiet){var g=(u=i.removed,h=i.remaining,d=a.label,p=u+h,u>0==0?"":o.format("Removed %,d of %,d sliver%s using %s",u,p,o.pluralSuffix(p),d));g&&v(g)}return m}var ru=Object.freeze({__proto__:null,composeMosaicLayer:function(e,t){var r=t.map((function(e,t){return{tile_id:t}}));return o.defaults({shapes:t,data:new Fi(r)},e)},dissolvePolygonGroups2:tu,dissolvePolygonLayer2:eu});function nu(e,t,r){var n=t.arcs,i=new Bo(n,ur(e.shapes,n)),o=new Zc(n.size());e.shapes=e.shapes.map((function(e,t){return e?(e=function(e,t){var r=[];return dn(e,n),r;function n(e){for(var n,i=e.length,o=[],a=0;a<i;a++)n=e[a],o.push(n),a<i-1&&t.getConnectedArcs(n).length>1&&(r.push(o),o=[]);o.length>0&&r.push(o)}}(e,i),o.clear(),e=function(e,t){var r=e.reduce((function(e,r){return function(e,t,r){for(var n,i=[],o=0;o<t.length;o++)n=t[o],r.hasId(n)?i.length>0&&(e.push(i),i=[]):i.push(n),r.setId(n,o),r.setId(~n,o);i.length>0&&e.push(i)}(e,r,t),e}),[]);return r.length>0?r:null}(e,o),o.clear(),e=function(e,t,r){return!e||e.length<2?e:(e.forEach((function(e,t){var i=~e[0],o=e[e.length-1];(r.hasId(i)||r.hasId(o))&&y("Indexing error"),r.setId(i,t),r.setId(o,t),n(i,t),n(o,t)})),e.filter((function(e){return!!e})));function n(n,i){var o,a=0,s=-1,l=r.getId(n);if(t.forEachConnectedArc(n,(function(e){r.hasId(e)&&(s=r.getId(e),o=e),a++})),1==a&&s>-1&&s<i){!function(e,t,r,n,i){var o,a,s=e[t],l=e[n];~r==s[0]?o=!0:r==s[s.length-1]?o=!1:y("Index error");~i==l[0]?a=!0:i==l[l.length-1]?a=!1:y("Index error 2");a||(l=pr(l.concat()));o?function(e,t){t=pr(t.concat());var r=[0,0].concat(t);e.splice.apply(e,r)}(s,l):(u=l,(c=s).push.apply(c,u));var c,u}(e,s,o,l,n),r.setId(n,s);var c=function(e,t){var r=~e[0],n=e[e.length-1];if(t==r)return n;if(t==n)return r;y("Indexing error")}(e[l],n);r.setId(c,s),l!=s&&(e[l]=null)}}}(e,i,o),e):null}))}function iu(e,t,r){var n,i=r||{},s=!i.only_arcs,l=o.some(e,Gi);i.debug?Lc(t,i):(e.forEach((function(e){Vi(e)&&("polygon"==e.geometry_type&&i.rewind&&Il(e,t.arcs),s&&(n||(n=Lc(t,i)),"polygon"==e.geometry_type?function(e,t,r){r=Object.assign({gap_fill_area:"auto"},r);var n=e.shapes.map((function(e,t){return[t]}));e.shapes=tu(n,e,t,r)}(e,t,i):"polyline"==e.geometry_type?nu(e,t):"point"==e.geometry_type&&function(e){var t,r;function n(e){var n=e.join("~");n in t||(t[n]=!0,r.push(e))}e.shapes=e.shapes.map((function(e,i){return e&&e.length>0!=!1?1==e.length?e:(t={},r=[],e.forEach(n),0===r.length?null:r):null}))}(e)),i.allow_empty||a.filterFeatures(e,t.arcs,{remove_empty:!0,verbose:i.verbose}))})),!i.no_arc_dissolve&&l&&t.arcs&&$o(t))}function ou(e){return e.reduce((function(e,t){return null===e?e=t.name||null:e&&t.name&&(e=o.mergeNames(e,t.name)),e}),null)||""}function au(e){var t={filename:"",directory:"",basename:"",extension:""},r=function(e){return-1==e.indexOf("/")&&-1!=e.indexOf("\\")?"\\":"/"}(e),n=e.split(r),i=n.pop(),o=/\.([a-z][a-z0-9]*)$/i,a=o.test(i)?o.exec(i)[0]:"";return a||i.includes("*")?(t.filename=i,t.extension=a?a.slice(1):"",t.basename=i.slice(0,i.length-a.length),t.directory=n.join(r)):t.directory=i?e:n.join(r),t}function su(e){return au(e).basename}function lu(e){return au(e).extension}function cu(e){var t=au(e);return t.extension?e.slice(0,e.length-t.extension.length-1):e}function uu(e,t){var r=cu(e);return t?r+"."+t:r}function hu(e){var t=lu(e);return t?cu(e)+"."+t.toLowerCase():e}function du(e){return e.reduce((function(e,t,r){return e=0===r?su(t):o.mergeNames(e,t)}),"")}function pu(e){var t=e.info&&e.info.input_files;return t&&du(t)||"output"}a.cleanLayers=iu,a.mergeAndFlattenLayers=function(e,t,r){if(!r.flatten)return a.mergeLayers(e,r);e.forEach((function(e){io(e,"the flatten option requires polygon layers")}));var n=a.mergeLayers(e,r);return Ho(t,e,n),iu(n,t,{overlap_rule:"max-id"}),Ho(t,n,e),n},a.mergeLayers=function(e,t){var r=e.filter(Ki),n={};return t=t||{},r.length?1==r.length?(v("Use the target= option to specify multiple layers for merging"),r.concat()):(n.data=function(e,t){var r=o.uniq(e.reduce((function(e,t){return e.concat(t.data?t.data.getFields():[])}),[]));if(0===r.length)return null;var n=e.reduce((function(e,t){var r=t.data?t.data.getRecords():new Fi(Ki(t)).getRecords();return e.concat(r)}),[]),i=function(e,t){var r=o.uniq(t.reduce((function(t,r){return t.concat(o.difference(e,r.data?r.data.getFields():[]))}),[]));return r}(r,e);(function(e,t){var r;e.length>0&&(r="["+e.join(", ")+"]",r=(1==e.length?"Field "+r+" is missing":"Fields "+r+" are missing")+" from one or more layers",t.force?!1!==t.verbose&&v("Warning: "+r):_(r))})(i,t),function(e,t){e.forEach((function(e){var r=function(e,t){return t.reduce((function(t,r){var n=r.data?Ci(e,r.data.getRecords()):null;return n&&-1==t.indexOf(n)&&t.push(n),t}),[])}(e,t);r.length>1&&_('Inconsistent data types in "'+e+'" field:',r.join(", "))}))}(r,e),i.length>0&&Ai(n);return new Fi(n)}(r,t),n.name=ou(r),n.geometry_type=function(e){var t=o.uniq(o.pluck(e,"geometry_type")).filter((function(e){return!!e}));t.length>1&&_("Incompatible geometry types:",t.join(", "));return t[0]||null}(r),n.geometry_type&&(n.shapes=function(e){return e.reduce((function(e,t){for(var r=t.shapes||[],n=Ki(t),i=-1;++i<n;)e.push(r[i]||null);return e}),[])}(r)),n.shapes&&n.data&&n.shapes.length!=n.data.size()&&y("Mismatch between geometry and attribute data"),[n]):null};var fu=Object.freeze({__proto__:null,getCommonFileBase:du,getFileBase:su,getFileExtension:lu,getOutputFileBase:pu,getPathBase:cu,parseLocalPath:au,replaceFileExtension:uu,toLowerCaseExtension:hu});function mu(e,t){(t=o.extend({},t)).rfc7946=!t.gj2008;var r=t.extension||"json";return t.rfc7946&&yu(e),t.file&&(r=lu(t.file)),(t.combine_layers?[e.layers]:e.layers.map((function(e){return[e]}))).map((function(n){var i=ou(n)||"output";return{content:vu(o.defaults({layers:n},e),t,"buffer"),filename:i+"."+r}}))}function gu(e,t,r,n,i){var o,a=Eu(e.data,r),s=e.shapes,l=Au(e.data,r);return o=r.ndjson?Ol:r.prettify?Ll(["bbox","coordinates"]):JSON.stringify,a&&s&&a.length!==s.length&&y("Mismatch between number of properties and number of shapes"),(s||a||[]).reduce((function(c,u,h){var d=s?s[h]:null,p=yl.exporters[e.geometry_type],f=d?p(d,t.arcs,r):null,m=null;if(n)m=function(e,t,r){var n=yl.toFeature(e,t);Array.isArray(r.hoist)&&t&&(n.properties=Object.assign({},t),r.hoist.forEach((e=>{t.hasOwnProperty(e)&&(n[e]=t[e],delete n.properties[e])})));return n}(f,a?a[h]:null,r),l&&(m.id=l[h]),r.no_null_props&&!m.properties&&(m.properties={});else{if(!f)return c;m=f}return i&&(m=o(m),"buffer"==i&&(m=vi(m,"utf8"))),c.push(m),c}),[])}function yu(e){var t=da(e);if(!(t&&ma(t)||Uo(e))){var r="RFC 7946 warning: non-WGS84 GeoJSON output.";t&&(r+=' Tip: use "-proj wgs84" to convert.'),v(r)}}function _u(e,t){var r,n,i,o,a=da(e),s=t&&a&&ma(a),l=new St,c=new St;return e.layers.forEach((function(t){Gi(t)?vr(t.shapes,null,(function(t){var r=e.arcs.getSimpleShapeBounds(t.arcs);(r.centerX()<0?l:c).mergeBounds(r)})):Wi(t)&&ln(t.shapes,(function(e){(e[0]<0?l:c).mergePoint(e[0],e[1])}))})),(r=(new St).mergeBounds(c).mergeBounds(l)).hasBounds()&&(o=r.toArray()),s&&c.hasBounds()&&l.hasBounds()&&(n=c.xmin-l.xmax,i=360+l.xmin-c.xmax,n>0&&n>i&&(o[0]=c.xmin,o[2]=l.xmax)),o||null}function vu(e,t,r){var n,i,o={},a=e.layers,s=xu(a,t);return o.type=s?"FeatureCollection":"GeometryCollection",t.gj2008&&wu(e,o),t.bbox&&(i=_u(e,t.rfc7946))&&(o.bbox=i),n=a.reduce((function(n,i,o){var a=gu(i,e,t,s,r);return n.length>0?n.concat(a):a}),[]),"Feature"==t.geojson_type&&1==n.length?n[0]:t.ndjson?yl.formatCollectionAsNDJSON(n):r?yl.formatCollection(o,n):(o[bu(o.type)]=n,o)}function bu(e){return"FeatureCollection"==e?"features":"GeometryCollection"==e?"geometries":void y("Invalid collection type:",e)}function wu(e,t){var r=e.info||{};!r.crs&&"input_geojson_crs"in r&&(t.crs=r.input_geojson_crs)}function xu(e,t){var r=t.geojson_type||"";return"Feature"==r||"FeatureCollection"==r||"GeometryCollection"!=r&&(r&&_("Unsupported GeoJSON type:",t.geojson_type),o.some(e,(function(e){var r=e.data?e.data.getFields():[],n=Su(r,t),i=!!Tu(r,t);return n||i})))}function Su(e,t){return!(t.drop_table||t.cut_table||0===e.length||1==e.length&&e[0]==yl.ID_FIELD)}function Eu(e,t){var r,n=e?e.getFields():[],i=Tu(n,t);return Su(n,t)?(r=e.getRecords(),i==yl.ID_FIELD?r.map((function(e){return delete(e=o.extend({},e))[i],e})):r):null}function Tu(e,t){var r=[],n=t.id_field;return o.isString(n)?r.push(n):o.isArray(n)&&(r=n),r.push(yl.ID_FIELD),o.find(r,(function(t){return o.contains(e,t)}))}function Au(e,t){var r=Tu(e?e.getFields():[],t);return r?e.getRecords().map((function(e){return r in e?e[r]:null})):null}yl.formatCollectionAsNDJSON=function(e){var t=o.createBuffer("\n","utf8"),r=e.reduce((function(e,r,n){return n>0&&e.push(t),e.push(r),e}),[]);return l.concat(r)},yl.formatCollection=function(e,t){var r=JSON.stringify(e).replace(/\}$/,', "'+bu(e.type)+'": [\n');return o.isString(t[0])?r+t.join(",\n")+"\n]}":yl.joinOutputBuffers(r,"\n]}",t)},yl.joinOutputBuffers=function(e,t,r){var n=o.createBuffer(",\n","utf8"),i=r.reduce((function(e,t,r){return r>0&&e.push(n),e.push(t),e}),[o.createBuffer(e,"utf8")]);return i.push(o.createBuffer(t,"utf8")),l.concat(i)},yl.exportPointGeom=function(e,t){var r=null;return 1==e.length?r={type:"Point",coordinates:e[0]}:e.length>1&&(r={type:"MultiPoint",coordinates:e}),r},yl.exportLineGeom=function(e,t){var r=Rl(e,t,"polyline");if(0===r.pointCount)return null;var n=r.pathData.map((function(e){return e.points}));return 1==n.length?{type:"LineString",coordinates:n[0]}:{type:"MultiLineString",coordinates:n}},yl.exportPolygonGeom=function(e,t,r){var n=Rl(e,t,"polygon");if(0===n.pointCount)return null;var i=Pl(n.pathData,t,r.invert_y),o=r.rfc7946&&!r.invert_y,a=i.map((function(e){return e.map((function(e){return o&&e.points.reverse(),e.points}))}));return 1==a.length?{type:"Polygon",coordinates:a[0]}:{type:"MultiPolygon",coordinates:a}},yl.exporters={polygon:yl.exportPolygonGeom,polyline:yl.exportLineGeom,point:yl.exportPointGeom};var Cu=Object.freeze({__proto__:null,default:yl,exportDatasetAsGeoJSON:vu,exportGeoJSON:mu,exportIds:Au,exportLayerAsGeoJSON:gu,exportProperties:Eu,getDatasetBbox:_u,getIdField:Tu,preserveOriginalCRS:wu,useFeatureCollection:xu,warnIfNotWgs84:yu});function Iu(e){var t,r;return e&&e.tag?(t="<"+e.tag,e.properties&&(t+=Ru(e.properties)),e.children||e.value?(t+=">"+(r="text"==e.tag||"tspan"==e.tag?"":"\n"),e.value&&(t+=Mu(e.value)),e.children&&(t+=e.children.map(Iu).join(r)),t+=r+"</"+e.tag+">"):t+="/>",t):""}var ku=/[&<>"']/g,Pu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};function Mu(e){return String(e).replace(ku,(function(t,r){var n=Pu[t];return"&"==t&&e.substr(r,n.length)==n?"&":n}))}function Ru(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return n||0===n?("href"==r&&(r="xlink:href"),"css"==r&&(r="style"),t+" "+r+'="'+Mu(o.isString(n)?n:JSON.stringify(n))+'"'):t}),"")}var Du=Object.freeze({__proto__:null,stringEscape:Mu,stringify:Iu,stringifyProperties:Ru});function Ou(e){if(!e)return null;var t=function(e){var t=/[, ]+(?![^(]*\))/;return String(e).trim().split(t)}(e),r=t[0]||"",n=null;return r.startsWith("dot")?(t[0]="dots",n=zu(t)):r.startsWith("square")?(t[0]="squares",n=zu(t)):r.startsWith("hatch")?(t[0]="hatches",n=Bu(t)):r.startsWith("dash")?n=Lu(t):isNaN(parseFloat(r))||(t.unshift("hatches"),n=Bu(t)),n||v("Invalid pattern, ignoring:",e),n}function Lu(e){e.shift();for(var t,r=[],n=e.pop(),i=Fu(e.pop());e.length>0;){if($u(t=e.pop())){e.push(t);break}r.push(t)}var a=Fu(e.pop()),s=[Fu(e.pop()),Fu(e.pop())].reverse(),l=45;return e.length>0&&(l=Fu(e.pop())),e.length>0||a>0==!1?null:{type:"dashes",tileSize:[r.length*(a+i),o.sum(s)],colors:r,width:a,dashes:s,spacing:i,background:n,rotation:l}}function Bu(e){e.shift();for(var t=e.length%2==1?Fu(e.shift()):45,r=[],n=[],i=0;i<e.length;i+=2)n.push(Fu(e[i])),r.push(e[i+1]);return Math.min.apply(null,n)>0==!1?null:{tileSize:[o.sum(n),10],type:"hatches",colors:r,widths:n,rotation:t}}function $u(e){return Fu(e)>0}function zu(e){var t=[],r=e.shift(),n=0;$u(e[1])&&(n=Fu(e.shift()));for(var i=Fu(e.shift()),o=e.pop(),a=Fu(e.pop());e.length>0;)t.push(e.shift());if(i>0==!1||a>=0==!1)return null;if(0===t.length)return null;var s=t.length*(i+a);return{type:r,tileSize:[s,s],colors:t,size:i,spacing:a,background:o,rotation:n}}function Fu(e){return parseFloat(e)||0}function qu(e,t){var r=e["fill-pattern"],n=("hash_"+r).replace(/[()# ,_]+/g,"_"),i=o.find(t,(function(e){return e.id==n}));if(delete e["fill-pattern"],!i){if(i=function(e,t){var r,n=Ou(e);if(!n)return null;"hatches"==n.type?r=function(e){for(var t=e.tileSize[1],r="",n=0,i=0;n<e.widths.length;n++)r+=`<rect x="${i}" y="0" width="${e.widths[n]}" height="${t}" fill="${e.colors[n]}"></rect>`,i+=e.widths[n];return r}(n):"dots"==n.type||"squares"==n.type?r=function(e){for(var t=e.size,r=e.colors.length,n=t+e.spacing,i=r*r,o="squares"==e.type?Uu:ju,a="",s=0,l=0,c=0;s<i;s++)a+=o(l,c,t,e.colors[(s+Math.floor(s/r))%r]),0===(l=(s+1)%r*n)&&(c+=n);return a}(n):"dashes"==n.type&&(r=function(e){for(var t="",r=0,n=0;r<e.colors.length;r++)t+=`<rect x="${n}" y="0" width="${e.width}" height="${e.dashes[0]}" fill="${e.colors[r]}"></rect>`,n+=e.width+e.spacing;return t}(n));return{svg:Nu(n,t,r),id:t,href:`url(#${t})`}}(r,n),!i)return;t.push(i)}e.fill=i.href}function Nu(e,t,r){var n=e.tileSize[0],i=e.tileSize[1],o=`<pattern id="${t}" patternUnits="userSpaceOnUse" width="${n}" height="${i}" patternTransform="rotate(${e.rotation})">`;return e.background&&(o+=`<rect x="0" y="0" width="${n}" height="${i}" fill="${e.background}"></rect>`),o+r+"</pattern>"}function ju(e,t,r,n){const i=r/2;return`<circle cx="${e+i}" cy="${t+i}" r="${i}" fill="${n}"></circle>`}function Uu(e,t,r,n){return`<rect x="${e}" y="${t}" width="${r}" height="${r}" fill="${n}"></rect>`}var Vu=Object.freeze({__proto__:null,convertFillPattern:qu,parseDashes:Lu,parseDots:zu,parseHatches:Bu,parsePattern:Ou});function Gu(){return{cx:.5,cy:.5,r:.57,fx:.35,fy:.35,stops:[{offset:.3,opacity:0},{offset:.6,opacity:.1},{offset:.78,opacity:.25},{offset:.87,opacity:.45},{offset:.95,opacity:1}]}}function Wu(e,t){if("sphere"==e["fill-effect"]){var r="mapshaper_sphere_effect",n=`url(#${r})`,i={cx:.5,cy:.5,r:.57,fx:.35,fy:.35,stops:[{offset:.3,opacity:0},{offset:.6,opacity:.1},{offset:.78,opacity:.25},{offset:.87,opacity:.45},{offset:.95,opacity:1}]},a=i.stops.map((function(e){return`<stop offset="${e.offset}" stop-opacity="${e.opacity}"/>`})),s=`<radialGradient id="${r}" cx="${i.cx}" cy="${i.cy}" r="${i.r}" fx="${i.fx}" fy="${i.fy}">${a.join("")}</radialGradient>`;o.find(t,(function(e){return e.id==r}))||t.push({svg:s,id:r,href:n}),e.fill=n,"opacity"in e==!1&&"fill-opacity"in e==!1&&(e["fill-opacity"]=.35)}}var Hu=Object.freeze({__proto__:null,convertFillEffect:Wu,getSphereEffectParams:Gu}),Zu={};function Yu(e,t){!function e(r){"path"==r.tag&&r.properties["fill-pattern"]&&qu(r.properties,t);"path"==r.tag&&r.properties["fill-effect"]&&Wu(r.properties,t);"image"==r.tag?/\.svg/.test(r.properties.href||"")&&function(e,t){var r=e.properties.href,n=o.find(t,(function(e){return e.href==r}));n||((n={href:r,id:Xu(r)}).svg=function(e,t){var r="";try{r=function(e,t){return e=e.replace(/[^]*<svg/,"<svg"),e.replace(/^<svg[^>]*>/,(function(e){return e=(e=e.replace(/ id="[^"]*"/,"")).replace(/<svg/,'<svg id="'+t+'"')}))}(function(e){var t;0===e.indexOf("http")?t=function(e){if(e in Zu)return Zu[e];var t=Et("sync-request")("GET",e,{timeout:2e3}).getBody().toString();return Zu[e]=t,t}(e):_("Invalid SVG location:",e);return t}(e),t)+"\n",r="\x3c!-- "+e+"--\x3e\n"+r}catch(n){}return r}(r,n.id),t.push(n));n.svg&&(e.tag="use",e.properties.href="#"+n.id)}(r,t):r.children&&r.children.forEach(e)}(e)}function Xu(e){return function(e){for(var t,r,n,i,o,a,s,l=0,c=0,u=[],h=[t=1732584193,r=4023233417,~t,~r,3285377520],d=[],p=unescape(encodeURI(e)),f=p.length;c<=f;)d[c>>2]|=(p.charCodeAt(c)||128)<<8*(3-c++%4);for(d[s=f+8>>2|15]=f<<3;l<=s;l+=16){for(t=h,c=0;c<80;t=[0|[(a=((p=t[0])<<5|p>>>27)+t[4]+(u[c]=c<16?~~d[l+c]:a<<1|a>>>31)+1518500249)+((r=t[1])&(n=t[2])|~r&(i=t[3])),o=a+(r^n^i)+341275144,a+(r&n|r&i|n&i)+882459459,o+1535694389][0|c++/20],p,r<<30|r>>>2,n,i])a=u[c-3]^u[c-8]^u[c-14]^u[c-16];for(c=5;c;)h[--c]=h[c]+t[c]|0}for(e="";c<40;)e+=(h[c>>3]>>4*(7-c++%8)&15).toString(16);return e}(e).substr(0,12)}function Ku(e,t){var r,n,i='xmlns="http://www.w3.org/2000/svg"',a=[],s="";t.crisp_paths&&(s="\n<style>\n  path {shape-rendering: crispEdges;}\n</style>"),t.final?e.arcs&&e.arcs.flatten():e=Fo(e),t=Object.assign({invert_y:!0,margin:"1"},t),r=ll(e,t),cl(e,r),cs(e,t.precision||1e-4),t.svg_data&&eh(e.layers,t.svg_data),n=e.layers.map((function(n){var i;return Yu(i=al(n)?Qu(n,r,t):Ju(n,e,t),a),Iu(i)})).join("\n"),a.length>0&&(n="<defs>\n"+o.pluck(a,"svg").join("")+"</defs>\n"+n),n.includes("xlink:")&&(i+=' xmlns:xlink="http://www.w3.org/1999/xlink"');var l=`stroke-linecap="${t.default_linecap||"round"}" stroke-linejoin="round"`;n.includes('stroke-linejoin="miter"')&&(l+=' stroke-miterlimit="2"');var c=`<?xml version="1.0"?>\n<svg ${i} version="1.2" baseProfile="tiny" width="%d" height="%d" viewBox="%s %s %s %s" ${l}>${s}\n${n}\n</svg>`;return[{content:n=o.format(c,r.width,r.height,0,0,r.width,r.height),filename:t.file||pu(e)+".svg"}]}function Qu(e,t,r){var n=rh(e,r);return n.children=function(e,t){var r=function(e){return e.data&&e.data.getReadOnlyRecordAt(0)}(e),n=ol[r.type];return n||_("Missing renderer for",r.type,"element"),t.crs||_(`Unable to render ${r.type} (unknown map projection)`),fa(t.crs)||_(`Unable to render ${r.type} (map is unprojected)`),n(r,t)||[]}(e,t),n}function Ju(e,t,r){var n=rh(e,r);return Hi(e,t.arcs)&&function(e){var t=Ui(e).getRecords()[0];t.fill||t.stroke||(t.fill="none")}(e=co(e)),n.children=function(e,t,r){var n=o.defaults({layers:[e]},t),i=vu(n,r),a=Oh(i.features||i.geometries||(i.type?[i]:[]),r);r.svg_data&&e.data&&function(e,t,r){var n=t.getFields(),i=r.indexOf("*")>-1?n.concat():r,a=o.difference(i,n);a.length>0&&(i=o.difference(i,a));var s=th(t.getRecords(),i);e.length!=s.length&&y("Mismatch between number of SVG symbols and data attributes");e.forEach((function(e,t){o.extend(e.properties||{},s[t])}))}(a,e.data,r.svg_data);return a}(e,t,r),n}function eh(e,t){var r=t.reduce((function(t,r){return function(e,t){return o.some(e,(function(e){return e.data&&e.data.fieldExists(t)||!1}))}(e,r)||t.push(r),t}),[]);r.length&&-1==r.indexOf("*")&&_("Missing data field(s):",r.join(", "))}function th(e,t){var r=/^[a-z_][a-z0-9_-]*$/i,n=/^xml/,i=t.filter((function(e){return r.test(e)&&!n.test(e)})),a=o.difference(t,i);return a.length>0&&(v("Unable to add data-* attributes for field(s):",a.join(", ")),v("data-* names should match pattern [a-z_][a-z0-9_-]*")),e.map((function(e){for(var t,r={},n=0;n<i.length;n++)r["data-"+i[n].toLowerCase()]=(t=e[i[n]],String(t));return r}))}function rh(e,t){var r={tag:"g",properties:{id:(t.id_prefix||"")+(e.name||o.getUniqueName("layer"))},children:[]};return("polyline"==e.geometry_type||oh(e))&&(r.properties.fill="none"),"polyline"==e.geometry_type&&(r.properties.stroke="black",r.properties["stroke-width"]=1),(ah(e)||oh(e)||al(e))&&(r.properties["font-family"]="sans-serif",r.properties["font-size"]="12",r.properties["text-anchor"]="middle"),r}function nh(e){return!(!e||!e["svg-symbol"]&&!e.r)}function ih(e){var t=e&&e["label-text"];return t||0===t}function oh(e){return"point"==e.geometry_type&&e.data&&e.data.fieldExists("svg-symbol")}function ah(e){return"point"==e.geometry_type&&e.data&&e.data.fieldExists("label-text")}var sh=Object.freeze({__proto__:null,exportDataAttributesForSVG:th,exportFurnitureLayerForSVG:Qu,exportLayerForSVG:Ju,exportSVG:Ku,featureHasLabel:ih,featureHasSvgSymbol:nh,getEmptyLayerForSVG:rh,layerHasLabels:ah,layerHasSvgSymbols:oh,validateSvgDataFields:eh}),lh={css:"inlinecss",class:"classname",dx:"measure",dy:"measure",fill:"color","fill-pattern":"pattern","fill-effect":null,"font-family":null,"font-size":null,"font-style":null,"font-stretch":null,"font-weight":null,"label-text":null,"letter-spacing":"measure","line-height":"measure",opacity:"number",r:"number",stroke:"color","stroke-dasharray":"dasharray","stroke-width":"number","stroke-opacity":"number","stroke-miterlimit":"number","fill-opacity":"number","vector-effect":null,"text-anchor":null},ch=o.extend({type:null,length:"number",rotation:"number",radius:"number",radii:null,flipped:"boolean",rotated:"boolean",direction:"number",sides:"number",points:"number",anchor:null,"head-angle":"number","head-width":"number","head-length":"number","stem-width":"number","stem-curve":"number","stem-taper":"number","stem-length":"number","min-stem-ratio":"number","arrow-scaling":"number",effect:null},lh),uh="css,class,opacity,stroke,stroke-width,stroke-dasharray,stroke-opacity,fill-opacity,vector-effect".split(","),hh={polygon:o.arrayToIndex(uh.concat("fill","fill-pattern","fill-effect")),polyline:o.arrayToIndex(uh.concat("stroke-linecap","stroke-linejoin","stroke-miterlimit")),point:o.arrayToIndex(uh.concat("fill","r")),label:o.arrayToIndex(uh.concat("fill,font-family,font-size,text-anchor,font-weight,font-style,font-stretch,letter-spacing,dominant-baseline".split(",")))};function dh(e,t,r,n){for(var i=fh(Object.keys(r||{}),t),o=0,a=i.length;o<a;o++)n&&!n(i[o])||ph(e,i[o],r[i[o]]);"polygon"!=t&&"circle"!=t||!r.stroke||r.fill||ph(e,"fill","none")}function ph(e,t,r){e.properties||(e.properties={}),e.properties[t]=r,"stroke-dasharray"==t&&r&&(e.properties["stroke-linecap"]="butt")}function fh(e,t){var r=hh[t]||{};return e.filter((function(e){return e in r}))}function mh(e,t){return(t=t||[]).indexOf(e.trim())>-1||/[(){}./*?:&|=[+-]/.test(e)}function gh(e,t,r){var n,i=String(e).trim(),o=ch[t],a=r.data?r.data.getFields():[],s=null;return o&&-1===a.indexOf(i)&&(s=function(e,t){var r=null;"number"==t?r=_h(e)?Number(e):null:"color"==t?r=xh(e)?e:null:"classname"==t?r=yh(e)?e:null:"measure"==t?r=bh(e)?wh(e):null:"dasharray"==t?r=/^[0-9]+( [0-9]+)*$/.test(e)?e:null:"pattern"==t?r=function(e){return!!Ou(e)}(e)?e:null:"boolean"==t?r=vh(e):"inlinecss"==t&&(r=e);return r}(i,o)),null===s&&mh(i,a)&&(n=function(e,t){var r;try{(r=Ns(e,t,null,{no_warn:!0}))(0)}catch(n){r=null}return r}(i,r)),n||null!==s||o||(s=i),n||(null!==s?function(e){return s}:void _("Unexpected value for",t+":",i))}function yh(e){return/^( ?[_a-z][-_a-z0-9]*\b)+$/i.test(e)}function _h(e){return o.isFiniteNumber(e)||o.isString(e)&&/^-?[.0-9]+$/.test(e)}function vh(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&null}function bh(e){return o.isFiniteNumber(e)||o.isString(e)&&/^-?[.0-9]+[a-z]*$/.test(e)}function wh(e){return o.isString(e)&&/[a-z]/.test(e)?e:Number(e)}function xh(e){return/^[a-z]+$/i.test(e)||/^#[0-9a-f]+$/i.test(e)||/^rgba?\([0-9,. ]+\)$/.test(e)}var Sh=Object.freeze({__proto__:null,applyStyleAttributes:dh,findPropertiesBySymbolGeom:fh,getSymbolDataAccessor:function(e,t){var r={},n=[];return!e.data||e.data.getFields(),Object.keys(t).forEach((function(i){var o=i.replace(/_/g,"-");if(o in ch){var a=t[i];r[o]=gh(a,o,e),n.push(o)}})),function(e){for(var t,i={},o=0;o<n.length;o++)i[t=n[o]]=r[t](e);return i}},getSymbolPropertyAccessor:gh,isSupportedSvgStyleProperty:function(e){return e in lh},isSvgClassName:yh,isSvgColor:xh,isSvgMeasure:bh,isSvgNumber:_h,mightBeExpression:mh,parseBoolean:vh,parseSvgMeasure:wh});function Eh(e){var t=Th(e);return dh(t,"label",e),t}function Th(e){var t,r,n,i=(t=e["label-text"])||0===t||!1===t?String(t):"",o=/\n|\\n|<br>/i,a=e.dx||0,s={y:e.dy||0,x:a};return o.test(i)&&(r=i.split(o),i=r.shift()),n={tag:"text",value:i,properties:s},r&&(n.children=[],r.forEach((function(t){var r={tag:"tspan",value:t,properties:{x:a,dy:e["line-height"]||"1.1em"}};n.children.push(r)}))),n}var Ah=Object.freeze({__proto__:null,renderLabel:Th,renderStyledLabel:Eh});function Ch(e,t){var r="translate("+rs(e[0])+" "+rs(e[1])+")";return t&&1!=t&&(r+=" scale("+t+")"),r}var Ih={line:function(e,t,r){var n,i;return n=[[t,r],[t+(e.dx||0),r+(e.dy||0)]],dh(i=zh(n),"polyline",e),i},polygon:function(e){var t=jh(e.coordinates||[]);return dh(t,"polygon",e),t},polyline:function(e){var t=Fh(e.coordinates||[]);return dh(t,"polyline",e),t},circle:Mh,square:function(e,t,r){var n=e.r||0,i={tag:"rect",properties:{x:t-n,y:r-n,width:2*n,height:2*n}};return dh(i,"point",e),i},image:function(e,t,r){var n=e.width||20,i=e.height||20,o={tag:"image",properties:{width:n,height:i,x:(t||0)-n/2,y:(r||0)-i/2,href:e.href||""}};e.fill&&(o.properties.fill=e.fill);return o},group:function(e,t,r){var n={tag:"g",children:[]},i=n.children;return(e.parts||[]).forEach((function(e){var n=Ph(e,t,r);i.push(n),"line"==e.type&&(t+=e.dx||0,r+=e.dy||0),"offset"==e.type&&(i=n.children,t=r=0)})),1!=n.children.length||n.properties?n:n.children[0]},label:function(e,t,r){var n=Eh(e);(t||r)&&(n.properties.transform=Ch([t,r]));return n},offset:function(e,t,r){var n=(t||0)+(e.dx||0),i=(r||0)+(e.dy||0);return{tag:"g",properties:{transform:Ch([n,i])},children:[]}}};function kh(e){var t=[];nh(e)&&t.push(function(e){if(e["svg-symbol"])return Ph(e["svg-symbol"]);if(e.r>0)return Mh(e);return{tag:"g",properties:{},children:[]}}(e)),ih(e)&&t.push(Eh(e));var r=t.length>1?{tag:"g",children:t}:t[0];return r?(r.properties=r.properties||{},r):null}function Ph(e,t,r){if(o.isString(e)&&(e=JSON.parse(e)),e.tag)return e;var n=Ih[e.type];if(!n)return v(e.type?"Unknown symbol type: "+e.type:"Symbol is missing a type property"),{tag:"g",properties:{},children:[]};var i=n(e,t||0,r||0);return e.opacity&&(i.properties.opacity=e.opacity),i}function Mh(e,t,r){var n={tag:"circle",properties:{cx:t||0,cy:r||0}};return dh(n,"point",e),n}var Rh=Object.freeze({__proto__:null,getTransform:Ch,renderPoint:kh,symbolRenderers:Ih}),Dh={Point:Lh,Polygon:jh,LineString:zh,MultiPoint:function(e,t){for(var r,n=[],i=0;i<e.length;i++)(r=Lh(e[i],t))&&("g"==r.tag&&r.children?n=n.concat(r.children):n.push(r));return n.length>0?{tag:"g",children:n}:null},MultiLineString:Fh,MultiPolygon:qh};function Oh(e,t){return t=t||{},e.map((function(e){var r="Feature"==e.type?e.geometry:e,n=r&&r.type,i=yl.translateGeoJSONType(n),o=e.properties||{},a=null;return n&&r.coordinates&&(a=Dh[n](r.coordinates,o)),a?("polyline"==i||"polygon"==i?dh(a,i,o):"point"==i&&$h(o)&&dh(a,i,o,Bh),"id"in e&&(a.properties||(a.properties={}),a.properties.id=(t.id_prefix||"")+e.id),a):{tag:"g"}}))}function Lh(e,t){if($h(t=t||{}))return{tag:"circle",properties:{cx:e[0],cy:e[1],r:t.r}};var r=kh(t);return r&&(r.properties.transform=Ch(e)),r}function Bh(e){return"r"!=e}function $h(e){return e&&e.r>0&&!e["svg-symbol"]&&!e["label-text"]}function zh(e){return{tag:"path",properties:{d:ml(e)}}}function Fh(e){return{tag:"path",properties:{d:e.map(ml).join(" ")}}}function qh(e){return jh(Nh(e))}function Nh(e){return e.reduce((function(e,t){return e.concat(t)}),[])}function jh(e){if(0===e.length)return null;var t={tag:"path",properties:{d:fl(e)}};return e.length>1&&(t.properties["fill-rule"]="evenodd"),t}var Uh=Object.freeze({__proto__:null,flattenMultiPolygonCoords:Nh,importGeoJSONFeatures:Oh,importLineString:zh,importMultiLineString:Fh,importMultiPolygon:qh,importPoint:Lh,importPolygon:jh});function Vh(e,t){o.isNumber(e)?e=new ArrayBuffer(e):e instanceof ArrayBuffer||("function"==typeof l&&e instanceof l||e instanceof Uint8Array?e=e.buffer&&e.buffer.byteLength==e.length?e.buffer:Vh.copyToArrayBuffer(e):y("BinArray constructor takes an integer, ArrayBuffer or Buffer argument")),this._buffer=e,this._bytes=new Uint8Array(e),this._view=new DataView(e),this._idx=0,this._le=!1!==t}Vh.bufferToUintArray=function(e,t){return 4==t?new Uint32Array(e):2==t?new Uint16Array(e):1==t?new Uint8Array(e):void y("BinArray.bufferToUintArray() invalid word length:",t)},Vh.uintSize=function(e){return 1&e||2&e||4},Vh.bufferCopy=function(e,t,r,n,i){n=n||0,i=i||r.byteLength-n,e.byteLength-t<i&&y("Buffer overflow; tried to write:",i);for(var o=Math.min(Vh.uintSize(i),Vh.uintSize(n),Vh.uintSize(e.byteLength),Vh.uintSize(t),Vh.uintSize(r.byteLength)),a=Vh.bufferToUintArray(r,o),s=Vh.bufferToUintArray(e,o),l=i/o,c=n/o,u=t/o;l--;)s[u++]=a[c++];return i},Vh.copyToArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),i=0;i<t;i++)n[i]=e[i];return r},Vh.bufferSize=function(e){return e instanceof ArrayBuffer?e.byteLength:0|e.length},Vh.prototype={size:function(){return this._buffer.byteLength},littleEndian:function(){return this._le=!0,this},bigEndian:function(){return this._le=!1,this},buffer:function(){return this._buffer},bytesLeft:function(){return this._buffer.byteLength-this._idx},skipBytes:function(e){return this._idx+=e+0,this},readUint8:function(){return this._bytes[this._idx++]},writeUint8:function(e){return this._bytes[this._idx++]=e,this},readInt8:function(){return this._view.getInt8(this._idx++)},writeInt8:function(e){return this._view.setInt8(this._idx++,e),this},readUint16:function(){var e=this._view.getUint16(this._idx,this._le);return this._idx+=2,e},writeUint16:function(e){return this._view.setUint16(this._idx,e,this._le),this._idx+=2,this},readUint32:function(){var e=this._view.getUint32(this._idx,this._le);return this._idx+=4,e},writeUint32:function(e){return this._view.setUint32(this._idx,e,this._le),this._idx+=4,this},readInt32:function(){var e=this._view.getInt32(this._idx,this._le);return this._idx+=4,e},writeInt32:function(e){return this._view.setInt32(this._idx,e,this._le),this._idx+=4,this},readFloat64:function(){var e=this._view.getFloat64(this._idx,this._le);return this._idx+=8,e},writeFloat64:function(e){return this._view.setFloat64(this._idx,e,this._le),this._idx+=8,this},readFloat64Array:function(e){var t,r=8*e,n=this._idx,i=this._buffer;if(n%8==0)t=new Float64Array(i,n,e);else if(i.slice)t=new Float64Array(i.slice(n,n+r));else{var o=new ArrayBuffer(r);Vh.bufferCopy(o,0,i,n,r),t=new Float64Array(o)}return this._idx+=r,t},readUint32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.readUint32());return t},peek:function(e){return this._view.getUint8(e>=0?e:this._idx)},position:function(e){return null!=e?(this._idx=e,this):this._idx},readCString:function(e,t){for(var r="",n=e>=0?e:this.bytesLeft();n>0;){var i=this.readUint8();if(n--,0==i)break;if(i>127&&t){r=null;break}r+=String.fromCharCode(i)}return e>0&&n>0&&this.skipBytes(n),r},writeString:function(e,t){var r,n=0,i=e.length;t&&(i=Math.min(i,t));for(var o=0;o<i;o++)(r=e.charCodeAt(o))>127&&(r="?".charCodeAt(0)),this.writeUint8(r),n++;return n},writeCString:function(e,t){var r=t?t-1:null,n=this.writeString(e,r);if(this.writeUint8(0),n++,t)for(;n<t;)this.writeUint8(0),n++;return this},writeBuffer:function(e,t,r){return this._idx+=Vh.bufferCopy(this._buffer,this._idx,e,r,t),this}};var Gh={},Wh=254;Gh.MAX_STRING_LEN=Wh,Gh.convertValueToString=Zh,Gh.convertFieldNames=Xh,Gh.discoverFieldType=Jh,Gh.getDecimalFormatter=ed,Gh.getNumericFieldInfo=td,Gh.truncateEncodedString=nd,Gh.getFieldInfo=Qh,Gh.exportRecords=function(e,t,r){var n=e.length,i=Li(e,r),a=t||"utf8",s=fi(i.join(""))?"ascii":a,l=function(e,t){return e.map((function(e){for(var r=vi(e,t),n=r.length,i=o.createBuffer(11),a=0;a<11;a++)i[a]=a<10&&n>=a-1?r[a]:0;return i}))}(Xh(i,s),s),c=i.map((function(t,r){var n=Qh(e,t,a);return n.warning&&v("["+t+"] "+n.warning),n})),u=(_=c.length,33+32*_),h=(g=o.pluck(c,"size"),o.sum(g)+1),d=u+n*h+1,p=new ArrayBuffer(d),f=new Vh(p).littleEndian(),m=new Date;var g;var _;f.writeUint8(3),f.writeUint8(m.getFullYear()-1900),f.writeUint8(m.getMonth()+1),f.writeUint8(m.getDate()),f.writeUint32(n),f.writeUint16(u),f.writeUint16(h),f.skipBytes(17),f.writeUint8(0),f.skipBytes(2),c.reduce((function(e,t,r){return f.writeBuffer(l[r],11,0),f.writeUint8(t.type.charCodeAt(0)),f.writeUint32(e),f.writeUint8(t.size),f.writeUint8(t.decimals),f.skipBytes(14),e+t.size}),1),f.writeUint8(13),f.position()!=u&&y("Dbf#exportRecords() header size mismatch; expected:",u,"written:",f.position());e.forEach((function(e,t){var r=f.position();f.writeUint8(32);for(var n=0,i=c.length;n<i;n++)c[n].write(t,f);f.position()-r!=h&&y("#exportRecords() Error exporting record:",e)})),f.writeUint8(26),f.position()!=d&&y("Dbf#exportRecords() file size mismatch; expected:",d,"written:",f.position());return p};var Hh=new function(){var e,t;function r(){e=new Uint8Array(5e3),t=0}return r(),{reserve:function(n){return t+n>5e3&&r(),t+=n,e.subarray(t-n,t)},putBack:function(e){t-=e}}};function Zh(e){return null==e?"":String(e)}function Yh(e,t,r,n){var i="ascii"==n?rd:function(e){return function(t){var r=rd(t,!0);return null===r&&(r=vi(String(t),e)),r}}(n),o=1,a=0,s=t.map((function(e){var t=Zh(e[r]),s=i(t);return s.length>Wh&&(s="ascii"==n?s.subarray(0,Wh):nd(s,n,Wh),a++),o=Math.max(o,s.length),s}));e.size=o,e.write=function(e,t){var r,n=s[e],i=Math.min(o,n.length),a=t._bytes,l=t.position();for(r=0;r<i;r++)a[r+l]=n[r];t.position(l+o)},a>0&&(e.warning="Truncated "+a+" string"+(1==a?"":"s")+" to fit the 254-byte limit")}function Xh(e,t){var r=Pi(e.map(Kh),10,t);return r.forEach((function(t,r){e[r]!=t&&v('Changed field name from "'+e[r]+'" to "'+t+'"')})),r}function Kh(e){return e.replace(/[-\s]+/g,"_")}function Qh(e,t,r){var n=Jh(e,t),i={type:n,decimals:0};return"N"==n?function(e,t,r){var n,i;n=td(t,r),e.decimals=n.decimals,(i=Math.max(n.max.toFixed(e.decimals).length,n.min.toFixed(e.decimals).length))>18&&(i=18,e.decimals-=i-18,e.decimals<0&&y("Dbf#getFieldInfo() Out-of-range error.")),e.size=i;var a=ed(i,e.decimals);e.write=function(e,n){var s=t[e],l=a(s[r]);l.length<i&&(l=o.lpad(l,i," ")),n.writeString(l,i)}}(i,e,t):"C"==n?Yh(i,e,t,r):"L"==n?function(e,t,r){e.size=1,e.write=function(e,n){var i,o=t[e][r];i=!0===o?"T":!1===o?"F":"?",n.writeString(i)}}(i,e,t):"D"==n?function(e,t,r){e.size=8,e.write=function(e,n){var i,a=t[e][r];i=a instanceof Date==0?"00000000":o.lpad(a.getUTCFullYear(),4,"0")+o.lpad(a.getUTCMonth()+1,2,"0")+o.lpad(a.getUTCDate(),2,"0"),n.writeString(i)}}(i,e,t):(i.size=0,i.type="N",n&&(i.warning="Unable to export "+n+"-type data, writing null values"),i.write=function(){}),i}function Jh(e,t){for(var r,n=0,i=e.length;n<i;n++){if(r=e[n][t],o.isString(r))return"C";if(o.isNumber(r))return"N";if(o.isBoolean(r))return"L";if(r instanceof Date)return"D";if(r)return typeof r}return null}function ed(e,t){return function(r){var n=o.isFiniteNumber(r)?r.toFixed(t):String(" ");return o.lpad(n,e," ")}}function td(e,t){for(var r,n=0,i=0,a=1,s=1,l=0,c=1e-15,u=0,h=e.length;u<h;u++)if(r=e[u][t],o.isFiniteNumber(r)){if(r<n||r>i)for(r<n&&(n=r),r>i&&(i=r);Math.abs(r)>=s;)s*=10,c*=10;for(;Math.abs(Math.round(r*a)-r*a)>c&&15!=l;)l++,c*=10,a*=10}return{decimals:l,min:n,max:i}}function rd(e,t){var r,n,i=String(e),o=i.length,a=Hh.reserve(o);for(r=0;r<o;r++){if((n=i.charCodeAt(r))>127){if(t){a=null,r=0;break}n="?".charCodeAt(0)}a[r]=n}return Hh.putBack(o-r),a?a.subarray(0,r):null}function nd(e,t,r){for(var n,i,o=e.slice(0,r),a=r;a>0&&a>=r-3;){if(""!=(i=bi(n=a==r?o:e.slice(0,a),t)).charAt(i.length-1)){o=n;break}a--}return o}function id(e){var t=e.length;return t>=2&&254==e[0]&&255==e[1]?"utf16be":t>=2&&255==e[0]&&254==e[1]?"utf16le":t>=3&&239==e[0]&&187==e[1]&&191==e[2]?"utf8":""}function od(e){var t=[{encoding:"latin1",confidence:0},{encoding:"win1252",confidence:sd(e)},{encoding:"utf8",confidence:ld(e)},{encoding:"gb18030",confidence:cd(e)}];return o.sortOn(t,"confidence","descending"),t[0]}function ad(e,t){return t.map((function(t){return bi(t,e).trim()}))}function sd(e){var t=ad("win1252",e).join(""),r=dd(t,"abcdefghijklmnopqrstuvwxyz0123456789.()'\"?+-\n,:;/|_$% "),n=dd(t,"")+r;return ud(n>.98&&r>=.8,n>.97&&r>=.6)}function ld(e){var t=hd(ad("utf8",e).join(""));return ud(0==t,t<.03)}function cd(e){var t=ad("gb18030",e).join(""),r=t.replace(/[^\u4e00-\u9fa5]/g,""),n=r.length/t.length,i=function(e){return e.replace(/[^a-zA-Z0-9.()'"?+\n,:;/|_$% -]/g,"")}(t),o=i.length/t.length,a=dd(r,""),s=hd(t);return ud(n>.5&&n+o>.9&&0===s&&a>.25,n>.3&&n+o>.8&&a>.15)}function ud(e,t){return(e?2:t&&1)||0}function hd(e){return(e.match(/\ufffd/g)||[]).length/e.length}function dd(e,t){var r={},n=0;e=e.toLowerCase();for(var i=0,o=t.length;i<o;i++)r[t[i]]=1;for(i=0,o=e.length;i<o;i++)n+=r[e[i]]||0;return n/e.length||0}var pd=Object.freeze({__proto__:null,decodeSamples:ad,detectEncoding:od,detectEncodingFromBOM:id});function fd(){return"undefined"!=typeof window&&void 0!==window.document}var md={};function gd(e,t){return _i(e.readSync(0,Math.min(t||1e3,e.size())))}function yd(e){var t=0;this.position=function(){return t},this.remaining=function(){return Math.max(e.size()-t,0)},this.advance=function(e){t+=e},this.readSync=function(){return e.readSync(t)},this.expandBuffer=function(){e.expandBuffer()}}function _d(e){var t,r,n=e.byteLength||e.length;function i(){return r||(r=o.toBuffer(e)),r}this.readToBinArray=function(r,i){return n<r+i&&y("Out-of-range error"),t||(t=new Vh(e)),t.position(r),t},this.toString=function(e){return _i(i(),e)},this.readSync=function(e,t){return i().slice(e,t?e+t:n)},this.findString=vd.prototype.findString,this.expandBuffer=function(){return this},this.size=function(){return n},this.close=function(){}}function vd(e,t){var r,n,i,a,s=Et("fs"),l=s.statSync(e).size,c=t&&t.cacheSize||16777216,h=t&&t.bufferSize||262144;function d(t,a){var u,h,d=l-t;return(d<a||d<0)&&y("Tried to read past end-of-file"),!(i&&t>=n&&n+i.length>=t+a)&&(d<(h=Math.max(c,a))&&(h=d),i&&h==i.length||(i=o.createBuffer(h)),r||(r=s.openSync(e,"r")),u=s.readSync(r,i,0,h,t),n=t,u!=h&&y("Error reading file"),!0)}(u("input_files")||[]).push(e),this.expandBuffer=function(){return 2*(h*=2)>c&&(c=2*h),this},this.readToBinArray=function(e,t){return d(e,t)&&(a=new Vh(i)),a.position(e-n),a},this.readSync=function(e,t){return t>0==!1&&(t=h),e+t>l&&(t=l-e),0===t?o.createBuffer(0):(d(e,t),i.slice(e-n,e-n+t))},this.size=function(){return l},this.toString=function(t){return md.readFile(e,t||"utf8")},this.close=function(){r&&(s.closeSync(r),r=null,i=null)}}md.isFile=function(e,t){if(t&&e in t)return!0;if(fd())return!1;var r=md.statSync(e);return r&&r.isFile()||!1},md.isDirectory=function(e){if(fd())return!1;var t=md.statSync(e);return t&&t.isDirectory()||!1},md.readFile=function(e,t,r){var n;return r&&e in r?(n=r[e],delete r[e]):((u("input_files")||[]).push(e),n=Et("fs").readFileSync(e)),t&&l.isBuffer(n)&&(n=xi(bi(n,t))),n},md.createDirIfNeeded=function(e){var t=au(e).directory;if(t&&!md.isDirectory(t)&&"/dev/stdout"!=e)try{Et("fs").mkdirSync(t,{recursive:!0}),v("Created output directory:",t)}catch(r){_("Unable to create output directory:",t)}},md.writeFileSync=function(e,t){md.createDirIfNeeded(e),o.isString(t)?Et("fs").writeFileSync(e,t):md.writeFileInChunks(e,t,1e7)},md.writeFileInChunks=function(e,t,r){var n,i,o=Et("fs"),a=o.openSync(e,"w"),s=0,l=t.length;do{i=Math.min(r,l-s),s+=n=o.writeSync(a,t,s,i)}while(n>0&&s<l);o.closeSync(a)},md.convertArrayBuffer=function(e){for(var t=new Uint8Array(e),r=o.createBuffer(t.length),n=0,i=t.length;n<i;n++)r[n]=t[n];return r},md.expandDirectoryName=function(e){var t=au(e);if(!t.filename.includes("*"))return[e];var r=o.wildcardToRegExp(t.filename),n=[];return Et("fs").readdirSync(t.directory||".").forEach((function(e){var i=t.directory?Et("path").join(t.directory,e):e;r.test(e)&&md.isDirectory(i)&&n.push(i)})),n},md.expandFileName=function(e){var t=au(e),r=o.wildcardToRegExp(t.filename),n=md.expandDirectoryName(t.directory||"."),i=[];try{n.forEach((function(e){Et("fs").readdirSync(e).forEach((function(t){var n=Et("path").join(e,t);r.test(t)&&md.isFile(n)&&i.push(n)}))}))}catch(a){}return 0===i.length&&_("No files matched ("+e+")"),i},md.expandInputFiles=function(e){return e.reduce((function(e,t){return t.indexOf("*")>-1?e=e.concat(md.expandFileName(t)):e.push(t),e}),[])},md.validateOutputDir=function(e){md.isDirectory(e)||fd()||y("Output directory not found:",e)},md.checkFileExists=function(e,t){md.isFile(e,t)||"/dev/stdin"==e||_("File not found ("+e+")")},md.statSync=function(e){var t=null;try{t=Et("fs").statSync(e)}catch(r){}return t},vd.prototype.findString=function(e,t){var r,n=Math.min(this.size(),t||this.size()),i=this.readSync(0,n),o=e.length,a=i.length-o,s=e.charCodeAt(0);for(r=0;r<a;r++)if(i[r]==s&&i.toString("utf8",r,r+o)==e)return{offset:r+o,text:i.toString("utf8",0,r)};return null};var bd=Object.freeze({__proto__:null,BufferReader:_d,FileReader:vd,Reader2:yd,readFirstChars:gd}),wd=[1,"437",2,"850",3,"1252",8,"865",9,"437",10,"850",11,"437",13,"437",14,"850",15,"437",16,"850",17,"437",18,"850",19,"932",20,"850",21,"437",22,"850",23,"865",24,"437",25,"437",26,"850",27,"437",28,"863",29,"850",31,"852",34,"852",35,"852",36,"860",37,"850",38,"866",55,"850",64,"852",77,"936",78,"949",79,"950",80,"874",87,"1252",88,"1252",89,"1252",100,"852",101,"866",102,"865",103,"861",106,"737",107,"857",108,"863",120,"950",121,"949",122,"936",123,"932",124,"874",134,"737",135,"852",136,"857",200,"1250",201,"1251",202,"1254",203,"1253",204,"1257"],xd={932:"Japanese",936:"Simplified Chinese",950:"Traditional Chinese",1252:"Western European",949:"Korean",874:"Thai",1250:"Eastern European",1251:"Russian",1254:"Turkish",1253:"Greek",1257:"Baltic"},Sd='To set the text encoding, re-import using the "encoding=" option.\nTo list the supported encodings, run the "encodings" command.';function Ed(e,t,r){for(var n,i=e.position(),o=0,a=0;a<t&&0!==(n=e.readUint8());a++)(o>0||32!=n)&&(r[o++]=n);for(;o>0&&32==r[o-1];)o--;return e.position(i+t),o}function Td(e){var t=e||"ascii",r=yi(t),n=o.createBuffer(256);return"utf8"==r||"ascii"==r?function(e,t){var i=Ed(e,t,n);return n.toString(r,0,i)}:function(e,r){var i,o,a=Ed(e,r,n),s="";for(i=0;i<a;i++){if((o=n[i])>127)return _i(n,t,0,a);s+=String.fromCharCode(o)}return s}}function Ad(e,t){for(var r=0;r<t;r++)if(e[r]>=128)return!0;return!1}function Cd(e,t){return e.readInt32()}function Id(e,t){var r=e.readCString(t),n=null;return/[ty]/i.test(r)?n=!0:/[fn]/i.test(r)&&(n=!1),n}function kd(e,t){var r=e.readCString(t),n=r.substr(0,4),i=r.substr(4,2),o=r.substr(6,2);return new Date(Date.UTC(+n,+i-1,+o))}function Pd(e,t){var r,n,i=o.isString(e)?new vd(e,{cacheSize:33554432,bufferSize:4194304}):new _d(e),a=function(e){var t=e.readToBinArray(0,Math.min(8193,e.size()));t.position(0).littleEndian();var r,n={version:t.readInt8(),updateYear:t.readUint8(),updateMonth:t.readUint8(),updateDay:t.readUint8(),recordCount:t.readUint32(),dataOffset:t.readUint16(),recordSize:t.readUint16(),incompleteTransaction:t.skipBytes(2).readUint8(),encrypted:t.readUint8(),mdx:t.skipBytes(12).readUint8(),ldid:t.readUint8()},i=1;t.skipBytes(2),n.fields=[];for(;13!=t.peek()&&10!=t.peek()&&t.position()<n.dataOffset-1;)(r=l(t)).columnOffset=i,n.fields.push(r),i+=r.size;i!=n.recordSize&&y("Record length mismatch; header:",n.recordSize,"detected:",i);13!=t.peek()&&v("Found a non-standard DBF header terminator ("+t.peek()+"). DBF file may be corrupted.");return n}(i);function s(){if(!r){var e="ascii";h(),m().length>0&&(e=d()),r=a.fields.map((function(t){var r=o.extend({},t);return r.name=bi(t.namebuf,e),r})),Pi(o.pluck(r,"name")).forEach((function(e,t){r[t].name=e}))}}function l(e){var t=o.createBuffer(11),r=Ed(e,11,t);return{namebuf:o.createBuffer(t.slice(0,r)),type:String.fromCharCode(e.readUint8()),address:e.readUint32(),size:e.readUint8(),decimals:e.readUint8(),id:e.skipBytes(2).readUint8(),position:e.skipBytes(2).readUint8(),indexFlag:e.skipBytes(7).readUint8()}}function c(){return s(),o.pluck(r,"name")}function u(e){return a.dataOffset+a.recordSize*e}function h(){n||(n=t||function(){var e,t=a.ldid,r=(l=t,c=wd.indexOf(l),-1==c?null:wd[c+1]),n=function(){var e,t,r,n,s,l,c=[],h=a.fields.filter((function(e){return"C"==e.type})),d=h.length,p=Math.min(a.recordCount,1e4),f=50,g=o.createBuffer(256),y={};c=m();for(var _=0;_<p;_++){l=(s=i.readToBinArray(u(_),a.recordSize)).position();for(var v=0;v<d&&!(c.length>=f);v++)e=h[v],s.position(l+e.columnOffset),(t=Ed(s,e.size,g))>0&&Ad(g,t)&&(n=(r=o.createBuffer(g.slice(0,t))).toString("hex"))in y==!1&&(y[n]=!0,c.push(r))}return c}(),s=0===n.length;var l,c;r&&87!=t?e=r:s&&(e="ascii");if(!e){var h,d=od(n);e=d.encoding,d.confidence<2&&(h="Warning: Unable to auto-detect the DBF file text encoding"+(1==d.confidence?" with high confidence":"")+".",h+=" Defaulting to "+e+(e in xd?" ("+xd[e]+").":"."),h+="\n\nSample of how non-ascii text was imported:\n",fd()?h+="<pre>"+E(ad(e,n),50)+"</pre>":h+=E(ad(e,n)),v(h+="\n\n"+Sd+"\n"))}return e}())}function d(){return h(),n}function p(){s();var e,t=r.map(f),n=(e=c().map((function(e,t){return JSON.stringify(e)+": arguments["+t+"]"})),new Function("return {"+e.join(",")+"};")),o=[];return function(e){var s,l,c=i.readToBinArray(u(e),a.recordSize),h=c.position();(c.bytesLeft()<a.recordSize||c.bytesLeft()==a.recordSize&&26==c.peek(c.size()-1))&&_("Invalid DBF file: encountered end-of-file while reading data");for(var d=0,p=r.length;d<p;d++)s=h+(l=r[d]).columnOffset,c.position(s),o[d]=t[d](c,l.size);return n.apply(null,o)}}function f(e){var t,r=e.type,n=null;return"I"==r?n=Cd:"F"==r||"N"==r?(t=Td("ascii"),n=function(e,r){var n,i=t(e,r);return i.indexOf(",")>=0&&(i=i.replace(",",".")),n=parseFloat(i),isNaN(n)?null:n}):"L"==r?n=Id:"D"==r?n=kd:"C"==r?n=Td(d()):(v('Field "'+e.name+'" has an unsupported type ('+e.type+") -- converting to null values"),n=function(){return null}),n}function m(){var e=[];return a.fields.forEach((function(t){Ad(t.namebuf,t.namebuf.length)&&e.push(t.namebuf)})),e}this.size=function(){return a.recordCount},this.readRow=function(e){return p()(e)},this.getFields=c,this.getBuffer=function(){return i.readSync(0,i.size())},this.deleteField=function(e){s(),r=r.filter((function(t){return t.name!=e}))},this.readRows=function(){for(var e=p(),t=[],r=0,n=this.size();r<n;r++)t.push(e(r));return t}}var Md={};Md.metricSq3D=Qr.pointSegDistSq3D,Md.metricSq=Qr.pointSegDistSq,Md.calcArcData=function(e,t,r,n){var i=e.length,o=!!n;e[0]=e[i-1]=1/0,i>2&&function i(a,s,l,c){var u,h,d=t[a],p=r[a],f=t[s],m=r[s];o&&(u=n[a],h=n[s]);for(var g,y=0,_=0,v=0,b=0,w=a+1;w<s;w++)(g=o?Md.metricSq3D(t[w],r[w],n[w],d,p,u,f,m,h):Md.metricSq(t[w],r[w],d,p,f,m))>=y&&(y=g,_=w);c<y&&(y=c);_-a>1&&(v=i(a,_,l+1,y));s-_>1&&(b=i(_,s,l+1,y));1==l&&d==f&&p==m&&(y=Math.max(v,b));return e[_]=Math.sqrt(y),y}(0,i-1,1,Number.MAX_VALUE)};var Rd={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULIPOINTM:28,MULTIPATCH:31,isPolygonType:function(e){return 5==e||15==e||25==e},isPolylineType:function(e){return 3==e||13==e||23==e},isMultiPartType:function(e){return Rd.isPolygonType(e)||Rd.isPolylineType(e)},isMultiPointType:function(e){return 8==e||18==e||28==e},isZType:function(e){return[11,13,15,18].includes(e)},isMType:function(e){return Rd.isZType(e)||[21,23,25,28].includes(e)},hasBounds:function(e){return Rd.isMultiPartType(e)||Rd.isMultiPointType(e)}},Dd={};function Od(e){var t,r,n,i=o.expandoBuffer(Int32Array),a=o.expandoBuffer(Int32Array),s="max"==e?function(e,n){var i=r[e],o=r[n];return t[i]<t[o]}:function(e,n){var i=r[e],o=r[n],a=t[i],s=t[o];return a>s||a===s&&i>o},l=0;function c(e){for(var t=d(e);t>e;)u(e,t),t=d(e=t)}function u(e,t){var n=r[e];h(e,r[t]),h(t,n)}function h(e,t){n[t]=e,r[e]=t}function d(e){var t=2*e+1,r=t+1,n=l;return t<n&&s(e,t)&&(e=t),r<n&&s(e,r)&&(e=r),e}this.init=function(e){var o;for(t=e,l=e.length,r=i(l),n=a(l),o=0;o<l;o++)h(o,o);for(o=l-2>>1;o>=0;o--)c(o)},this.size=function(){return l},this.updateValue=function(e,r){var i=n[e];t[e]=r,i>=0&&i<l||y("Out-of-range heap index."),c(function(e){var t;for(;e>0&&!s(e,t=e-1>>1);)u(e,t),e=t;return e}(i))},this.popValue=function(){return t[this.pop()]},this.getValue=function(e){return t[e]},this.peek=function(){return r[0]},this.peekValue=function(){return t[r[0]]},this.pop=function(){var e;return l<=0&&y("Tried to pop from an empty heap."),e=r[0],h(0,r[--l]),c(0),e}}Dd.forEachShapePart=function(e,t){var r={GeometryCollection:function(e){e.geometries.forEach(n)},LineString:function(e){var r=t(e.arcs);r&&(e.arcs=r)},MultiLineString:function(e){i(e.arcs)},Polygon:function(e){i(e.arcs)},MultiPolygon:function(e){e.arcs.forEach(i)}};function n(e){e.type in r&&r[e.type](e)}function i(e){for(var r,n=0;n<e.length;n++)(r=t(e[n]))&&(e[n]=r)}n(e)},Dd.forEachArc=function(e,t){Dd.forEachShapePart(e,(function(e){for(var r,n=0;n<e.length;n++)r=t(e[n]),o.isInteger(r)&&(e[n]=r)}))};var Ld={};function Bd(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function $d(e,t,r){var n=r[0],i=r[2];return e>i[0]?(t>i[1]?4:t>=n[1]&&5)||6:e>=n[0]?(t>i[1]?3:t>=n[1]&&8)||7:(t>i[1]?2:t>=n[1]&&1)||0}function zd(e){return 0==e||2==e||4==e||6==e}function Fd(e,t){return t<8&&t>=0?(t+8-2*e)%8:t}function qd(e,t,r){e.push(function(e,t){if(zd(e))return t[e/2].concat();y("Invalid corner sector:",e)}(t,r))}function Nd(e,t,r,n){var i,o=t?$d(t[0],t[1],n):-1,a=$d(r[0],r[1],n);8==o&&8==a?e.push(r):o==a||(-1==o?8==a?e.push(r):zd(a)&&qd(e,a,n):8==o?(Ud(e,t,r,n),zd(a)&&qd(e,a,n)):8==a?(Ud(e,t,r,n),e.push(r)):(i=function(e){return e>1&&e<8?Math.floor(e/2):0}(o),n=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3];return 0===e?t=[r,n,i,o]:1==e?t=[n,i,o,r]:2==e?t=[i,o,r,n]:3==e?t=[o,r,n,i]:y("Invalid rotation number"),t}(i,n),o=Fd(i,o),a=Fd(i,a),0==o?0===a||1===a||7===a||(2==a||6==a?qd(e,a,n):3==a?Ud(e,t,r,n)||qd(e,2,n):4==a?(Ud(e,t,r,n)||(Qr.orient2D(t[0],t[1],r[0],r[1],n[0][0],n[0][1])>1?qd(e,6,n):qd(e,2,n)),qd(e,a,n)):5==a&&(Ud(e,t,r,n)||qd(e,6,n))):1==o?2==a||0===a?qd(e,a,n):3==a?Ud(e,t,r,n)||qd(e,2,n):4==a?(Ud(e,t,r,n)||qd(e,2,n),qd(e,4,n)):5==a?Ud(e,t,r,n):6==a?(Ud(e,t,r,n)||qd(e,0,n),qd(e,6,n)):7==a&&(Ud(e,t,r,n)||qd(e,0,n)):y("Sector error")))}function jd(e,t,r,n,i){var o=Qr.segmentIntersection(t[0],t[1],r[0],r[1],n[0],n[1],i[0],i[1]);o&&e.push(o)}function Ud(e,t,r,n){var i=[];return jd(i,t,r,n[0],n[1]),jd(i,t,r,n[0],n[3]),jd(i,t,r,n[1],n[2]),jd(i,t,r,n[2],n[3]),i.length>0&&(e.push.apply(e,i),!0)}function Vd(e,t){var r,n=[],i=[],o=[],a=0;return e.forEach((function(e,l){!function(e,t){var l,c,u,h,d=!0,p=0;r=0;for(;e.hasNext();){if(!1===t(s,l=e.x,c=e.y,u,h,p++)){d=!1;break}u=l,h=c}d&&1==r&&(v("An invalid arc was created"),d=!1);if(d)n.push(r);else{for(;r-- >0;)i.pop(),o.pop();n.push(0),a++}}(e,t)})),e.updateVertexData(n,i,o),a;function s(e){e&&(i.push(e[0]),o.push(e[1]),r++)}}function Gd(e){var t,r,n=Rd.hasBounds(e),i=Rd.isMultiPartType(e),o=Rd.isZType(e),a=Rd.isMType(e),s=!n,l=s?0:16;t=function(t,r){var n=t.position();if(this.id=t.bigEndian().readUint32(),this.type=t.littleEndian().skipBytes(4).readUint32(),0===this.type||0===e)return{id:this.id,isNull:!0,pointCount:0,partCount:0,byteLength:12};(r>0!=!0||this.type!=e&&0!==this.type)&&y("Unable to read a shape -- .shp file may be corrupted"),this.byteLength=r,s?(this.pointCount=1,this.partCount=1):(t.skipBytes(32),this.partCount=i?t.readUint32():1,this.pointCount=t.readUint32()),this._data=function(){return t.position(n)}};var c={_xypos:function(){var e=12;return s||(e+=4),n&&(e+=32),i&&(e+=4*this.partCount+4),e},readCoords:function(){if(0===this.pointCount)return null;var e=this.readPartSizes(),t=this._data().skipBytes(this._xypos());return e.map((function(e){return t.readFloat64Array(2*e)}))},readXY:function(){return 0===this.pointCount?new Float64Array(0):this._data().skipBytes(this._xypos()).readFloat64Array(2*this.pointCount)},readPoints:function(){for(var e,t=this.readXY(),r=o?this.readZ():null,n=a&&this.hasM()?this.readM():null,i=[],s=0,l=t.length/2;s<l;s++)e=[t[2*s],t[2*s+1]],r&&e.push(r[s]),n&&e.push(n[s]),i.push(e);return i},readPartSizes:function(){var e,t,r,n=[];if(0===this.pointCount);else if(1==this.partCount)n.push(this.pointCount);else{t=0,r=this._data().skipBytes(56);for(var i=0,o=this.partCount;i<o;i++)(e=(i<o-1?r.readUint32():this.pointCount)-t)>0&&(n.push(e),t+=e)}return n}},u={read:function(){var e=2;return o&&e++,this.hasM()&&e++,this._data().skipBytes(12).readFloat64Array(e)},stream:function(e){var t=this._data().skipBytes(12);e.addPoint(t.readFloat64(),t.readFloat64()),e.endPath()}},h={readBounds:function(){return this._data().skipBytes(12).readFloat64Array(4)},stream:function(e){for(var t,r=this.readPartSizes(),n=this.readXY(),i=0,o=0;i<r.length;){for(t=r[i];t-- >0;)e.addPoint(n[o++],n[o++]);e.endPath(),i++}n.length!=o&&y("Counting error")},stream2:function(e){for(var t,r=this.readPartSizes(),n=this._data().skipBytes(this._xypos()),i=0;i<r.length;){for(t=r[i];t-- >0;)e.addPoint(n.readFloat64(),n.readFloat64());e.endPath(),i++}},read:function(){for(var e=[],t=this.readPartSizes(),r=this.readPoints(),n=0,i=t.length-1;n<i;n++)e.push(r.splice(0,t[n]));return e.push(r),e}},d={_mpos:function(){var e=this._xypos()+16*this.pointCount;return o&&(e+=8*this.pointCount+l),e},readMBounds:function(){return this.hasM()?this._data().skipBytes(this._mpos()).readFloat64Array(2):null},readM:function(){return this.hasM()?this._data().skipBytes(this._mpos()+l).readFloat64Array(this.pointCount):null},hasM:function(){var e=this._mpos(),t=e+8*this.pointCount+l;return this.byteLength!=e&&(this.byteLength==t||void y("#hasM() Counting error"))}},p={_zpos:function(){return this._xypos()+16*this.pointCount},readZBounds:function(){return this._data().skipBytes(this._zpos()).readFloat64Array(2)},readZ:function(){return this._data().skipBytes(this._zpos()+l).readFloat64Array(this.pointCount)}};return r=0===e?{}:s?Object.assign(c,u):Object.assign(c,h),o&&Object.assign(r,p),a&&Object.assign(r,d),t.prototype=r,r.constructor=t,t}function Wd(e){return[Rd.POLYGON,Rd.POLYGONM,Rd.POLYGONZ].includes(e)?"polygon":[Rd.POLYLINE,Rd.POLYLINEM,Rd.POLYLINEZ].includes(e)?"polyline":[Rd.POINT,Rd.POINTM,Rd.POINTZ,Rd.MULTIPOINT,Rd.MULTIPOINTM,Rd.MULTIPOINTZ].includes(e)?"point":null}function Hd(e){return[0,1,3,5,8,11,13,15,18,21,23,25,28].includes(e)}Ld.getArcCalculator=function(e,t){var r=new Od,n=o.expandoBuffer(Int32Array),i=o.expandoBuffer(Int32Array),a=t?function(t,r,n,i,o,a){return e(i[t],o[t],a[t],i[r],o[r],a[r],i[n],o[n],a[n])}:function(t,r,n,i,o){return e(i[t],o[t],i[r],o[r],i[n],o[n])};return function(e,o,s,l){var c,u,h,d,p=e.length,f=n(p),m=i(p),g=-1/0;for(l&&!t?y("[visvalingam] Received z-axis data for 2D simplification"):!l&&t?y("[visvalingam] Missing z-axis data for 3D simplification"):e.length>o.length&&y("[visvalingam] Incompatible data arrays:",e.length,o.length),h=0;h<p;h++)d=h+1,c=(u=h-1)<0||d>=p?1/0:a(u,h,d,o,s,l),e[h]=c,m[h]=d,f[h]=u;for(r.init(e);r.size()>0&&(c=e[h=r.pop()])!==1/0;)c<g?e[h]=g:g=c,u=f[h],d=m[h],u>0&&(c=a(f[u],u,d,o,s,l),r.updateValue(u,c)),d<p-1&&(c=a(u,d,m[d],o,s,l),r.updateValue(d,c)),m[u]=d,f[d]=u}},Ld.standardMetric=Qr.triangleArea,Ld.standardMetric3D=Qr.triangleArea3D,Ld.getWeightedMetric=function(e){var t=Ld.getWeightFunction(e);return function(e,r,n,i,o,a){var s=Qr.triangleArea(e,r,n,i,o,a),l=Qr.cosine(e,r,n,i,o,a);return t(l)*s}},Ld.getWeightedMetric3D=function(e){var t=Ld.getWeightFunction(e);return function(e,r,n,i,o,a,s,l,c){var u=Qr.triangleArea3D(e,r,n,i,o,a,s,l,c),h=Qr.cosine3D(e,r,n,i,o,a,s,l,c);return t(h)*u}},Ld.getWeightCoefficient=function(e){return e&&o.isNumber(e&&e.weighting)?e.weighting:.7},Ld.getWeightFunction=function(e){var t=Ld.getWeightCoefficient(e);return function(e){return-e*t+1}},Ld.weight=function(e){return.7*-e+1},Ld.getEffectiveAreaSimplifier=function(e){var t=e?Ld.standardMetric3D:Ld.standardMetric;return Ld.getPathSimplifier(t,e)},Ld.getWeightedSimplifier=function(e,t){var r=t?Ld.getWeightedMetric3D(e):Ld.getWeightedMetric(e);return Ld.getPathSimplifier(r,t)},Ld.getPathSimplifier=function(e,t){return Ld.scaledSimplify(Ld.getArcCalculator(e,t))},Ld.scaledSimplify=function(e){return function(t,r,n,i){e(t,r,n,i);for(var o=1,a=t.length-1;o<a;o++)t[o]=.65*Math.sqrt(t[o])}};var Zd=Object.freeze({__proto__:null,isSupportedShapefileType:Hd,translateShapefileType:Wd});function Yd(e,t){if(this instanceof Yd==!1)return new Yd(e,t);var r,n,i=o.isString(e)?new vd(e):new _d(e),a=function(e){var t={signature:e.bigEndian().readUint32(),byteLength:2*e.skipBytes(20).readUint32(),version:e.littleEndian().readUint32(),type:e.readUint32(),bounds:e.readFloat64Array(4),zbounds:e.readFloat64Array(2),mbounds:e.readFloat64Array(2)};9994!=t.signature&&y("Not a valid .shp file");Hd(t.type)||y("Unsupported .shp type:",t.type);t.byteLength!=i.size()&&y("File size of .shp doesn't match size in header");return t}(i.readToBinArray(0,100)),s=a.type,l=100,c=0,u=0,h=new Gd(s);function d(e,t){var r=e.size();if(t+12>r)return null;var n=e.readToBinArray(t,12);n.bigEndian().readUint32();var i=2*n.readUint32()+8,o=n.littleEndian().readUint32();return t+i<=r&&i>=12&&(0===o||o==s)?(n=e.readToBinArray(t,i),new h(n,i)):null}t&&(n=o.isString(t)?new vd(t):new _d(t),r=n.readToBinArray(0,n.size()).bigEndian()),this.header=function(){return a},this.forEachShape=function(e){for(var t=this.nextShape();t;)e(t),t=this.nextShape()},this.nextShape=function(){var e,t;return i||y("Tried to read from a used ShpReader"),t=c,e=r?function(e,t,r){if(t.size()<=100+8*r)return null;t.position(100+8*r);var n=r+1,i=2*t.readUint32();t.readUint32();var o=d(e,i);return o||_("Index of Shapefile record",n,"in the .shx file is invalid."),o.id!=n&&(u++,w(`Warning: A feature has a different record number in .shx (${n}) and .shp (${o.id}).`)),o}(i,r,t):function(e,t,r){for(var n,i,o,a=r+1,c=t,u=e.size(),h=null;c+12<=u;)if(i=(n=e.readToBinArray(c,12)).bigEndian().readUint32(),(o=n.littleEndian().skipBytes(4).readUint32())!=s&&0!==o||i!=a&&0===o)c+=4;else{if(!(h=d(e,c)))break;if(l=c+h.byteLength,i==a)break;i<a?(v("Found a Shapefile record with the same id as a previous record ("+h.id+") -- skipping."),c+=h.byteLength):_("Shapefile contains an out-of-sequence record. Possible data corruption -- bailing.")}return h&&c>t&&w("Skipped over "+(c-t)+" non-data bytes in the .shp file."),h}(i,l,t),e?(c++,e):(i.close(),i=n=r=null,u>0&&v(`Warning: ${u}/${c} features have non-standard record numbers in the .shp file.`),null)}}Yd.prototype.type=function(){return this.header().type};var Xd,Kd=123,Qd=93,Jd=34,ep=44,tp=4096,rp=1e7;function np(e,t){var r=xp(e,0),n=function(e){var t=e.getChar(),r=0;for(;t!=Xd&&r<tp;){if(r++,t==Kd)return e.back(),!0;t=e.getChar()}return!1}(r);n||_("File is not GeoJSON");var i=mp(r,t);if("FeatureCollection"==i.type||"GeometryCollection"==i.type)return i;for(i.type||_("Invalid GeoJSON"),t(i),sp(r);r.peek()==Kd;)t(mp(r,t)),sp(r);return null}function ip(e,t){t>=0&&(e+=" at position "+t),_(e)}function op(e,t){if(e==Xd)return ip("Unexpected end of JSON input");ip(e==Jd?"Unexpected string in JSON":e<33||e>126?"Unexpected token in JSON":"Unexpected token "+String.fromCharCode(e)+" in JSON",t)}function ap(e,t){t==Xd&&ip("Unterminated string in JSON",e),ip("Too-long string in JSON",e)}function sp(e){for(;32==(t=e.peek())||10==t||13==t||9==t;)e.advance();var t}function lp(e,t){var r;for(hp(e,91),r=dp(e,Qd);r!=Qd;)e.refresh(),t(cp(e)),r=fp(e,ep,Qd)}function cp(e){var t,r,n,i,o=e.index();if(91==e.getChar()&&bp(e.peek())&&(t=wp(e),n=e.getChar(),sp(e),n==ep&&bp(e.peek()))){if(r=wp(e),(i=e.getChar())==Qd)return[t,r];if(i==ep)return function(e,t){sp(e);do{e.refresh(),t.push(pp(e))}while(fp(e,ep,Qd)==ep);return t}(e,[t,r])}return e.index(o),pp(e)}function up(e,t){for(var r=0;r<t.length;r++)hp(e,t.charCodeAt(r));return!0}function hp(e,t){var r=e.getChar();r!=t&&op(r,e.index()-1)}function dp(e,t){return sp(e),e.peek()===t?(e.advance(),sp(e),t):null}function pp(e){var t,r=e.peek();return bp(r)?t=wp(e):91==r?t=function(e){var t,r=[];for(hp(e,91),t=dp(e,Qd);t!=Qd;)e.refresh(),r.push(cp(e)),t=fp(e,ep,Qd);return r}(e):r==Jd?t=yp(e):r==Kd?t=mp(e):110==r?t=function(e){return up(e,"null"),null}(e):116==r?t=function(e){return up(e,"true"),!0}(e):102==r?t=function(e){return up(e,"false"),!1}(e):op(r,e.index()),t}function fp(e,t,r){sp(e);var n=e.getChar();return n!=t&&n!=r&&op(n,e.index()-1),sp(e),n}function mp(e,t){var r,n,i={};for(hp(e,Kd),n=dp(e,125);125!=n;)e.refresh(),r=gp(e),sp(e),hp(e,58),sp(e),"features"!=r&&"geometries"!=r||91!=e.peek()||!t?"type"==r&&e.peek()==Jd?i[r]=gp(e):i[r]=pp(e):(lp(e,t),i[r]=null),n=fp(e,ep,125);return i}function gp(e){var t=e.index(),r=e.cache,n=!1,i=0;hp(e,Jd);for(var o=e.getChar();o!=Jd||!0===n;)++i>2e3&&ap(t,o),n?n=!1:92==o&&(n=!0),r[o]||(r[o]=[]),r=r[o],o=e.getChar();return r[0]||(e.index(t),r[0]=yp(e)),r[0]}function yp(e){var t=e.index();hp(e,Jd);for(var r=0,n="",i=e.getChar();i!=Jd;){if(++r>256||92==i||i<32||i>126)return e.index(t),_p(e);n+=String.fromCharCode(i),i=e.getChar()}return n}function _p(e){e.refresh();var t=tp-2,r=e.index(),n=0,i=!1;hp(e,Jd);for(var o,a=e.getChar();a!=Jd||!0===i;){if(++n>t)return a!=Xd&&(tp*=2)<=5e6||ap(r,a),e.index(r),_p(e);i?i=!1:92==a&&(i=!0),a=e.getChar()}return o=JSON.parse(e.toString(r,n+2)),e.refresh(),o}function vp(e){return e>=48&&e<=57}function bp(e){return e>=48&&e<=57||45==e}function wp(e){var t,r,n=e.index(),i=0,o=1,a=1,s=!1,l=!1,c=e.getChar();for(45===c&&(a=-1,c=e.getChar()),t=c;vp(c);)i=10*i+(r=c-48),c=e.getChar();if(i>0&&48===t&&(l=!0),46==c){for(;vp(c=e.getChar());)o*=10,i=10*i+(r=c-48);1!=o&&46!=t||(l=!0)}return 0===i&&48!=t&&(l=!0),l&&ip("Invalid number in JSON",n),o>1e22&&(s=!0),i>=9007199254740992&&(!(i>=0x40000000000000)&&1&~r||(s=!0)),s||69==c||101==c?(e.index(n),function(e){for(var t,r=e.index(),n=0;(t=e.getChar())>=48&&t<=57||45==t||46==t||43==t||69==t||101==t;)n++;e.back();var i=e.toString(r,n),o=Number(i);return isNaN(o)&&ip("Invalid number in JSON",r),o}(e)):(e.back(),a*i/o)}function xp(e,t){var r=e.size(),n=t,i=e.readSync(n,rp),o=0,a={peek:function(){return i[o]},getChar:function(){return i[o++]},advance:function(){o++},back:function(){o--},toString:function(e,t){var r=e-n;return i.toString("utf8",r,r+t)},index:function(e){if(e>=0==!1)return o+n;o=e-n},refresh:s,cache:[]};return s(),a;function s(){i.length-o>=tp||n+i.length>=r||(n+=o,o=0,i=e.readSync(n,rp))}}var Sp=Object.freeze({__proto__:null,Catalog:function(){var e=[],t=[];function r(e,t){return{layer:e,dataset:t}}function n(e,t){var r=-1;return t.forEach((function(t,n){t.layer==e&&(r=n)})),r}this.forEachLayer=function(t){var r=0;e.forEach((function(e){e.layers.forEach((function(n){t(n,e,r++)}))}))},this.deleteLayer=function(e,r){this.getActiveLayer().layer==e&&(t=[]),r.layers.splice(r.layers.indexOf(e),1),0===r.layers.length&&this.removeDataset(r),t=t.filter((function(t){var r=t.layers.indexOf(e);return-1==r||(t.layers.splice(r,1),t.layers.length>0)}))},this.findLayer=function(e){var t="function"==typeof e?e:null,n=null;return this.forEachLayer((function(i,o){(t?t(i,o):i==e)&&(n=r(i,o))})),n},this.findCommandTargets=function(e,t){return e?Cs(this.getLayers(),e,t):this.getDefaultTargets()||[]},this.findSingleLayer=function(e){var t=ks(this.getLayers(),e);return t.length>1&&_("Ambiguous pattern (multiple layers were matched):",e),t[0]||null},this.clear=function(){e=[],t=[]},this.removeDataset=function(r){t=t.filter((function(e){return e.dataset!=r})),e=e.filter((function(e){return e!=r}))},this.getDatasets=function(){return e},this.getLayers=function(){var e=[];return this.forEachLayer((function(t,n){e.push(r(t,n))})),e},this.addDataset=function(e){return this.setDefaultTarget(e.layers,e),this},this.addDatasets=function(e){e.forEach((function(e){this.addDataset(e)}),this)},this.findNextLayer=function(e){var t=this.getLayers(),r=n(e,t);return r>-1?t[(r+1)%t.length]:null},this.findPrevLayer=function(e){var t=this.getLayers(),r=n(e,t);return r>-1?t[(r-1+t.length)%t.length]:null},this.isEmpty=function(){return 0===e.length},this.getDefaultTargets=function(){return 0!==t.length||this.isEmpty()||(t=[{dataset:e[0],layers:e[0].layers.slice(0,1)}]),t},this.setDefaultTarget=function(e,t){this.setDefaultTargets([{layers:e.concat(),dataset:t}])},this.setDefaultTargets=function(r){r.forEach((function(t){-1==e.indexOf(t.dataset)&&e.push(t.dataset)})),t=r},this.getActiveLayer=function(){var e=(this.getDefaultTargets()||[])[0],t=e?.layers[e.layers.length-1];return e?{layer:t,dataset:e.dataset}:null}},getFormattedLayerList:function(e){var t=[];return e.forEachLayer((function(e,r,n){t.push("  ["+(n+1)+"]  "+(e.name||"[unnamed]"))})),t.length>0?t.join("\n"):"[none]"}});function Ep(e,t,r,n){var i=new Cl(t,r.arcs);return e.map((function(e){return function(e){var t=null;e&&(t=e.reduce(o,[]));return t&&t.length>0?t:null}(e)}));function o(e,t){for(var r,o,a=null,s=0;s<t.length;s++)r=t[s],(o=i.arcIsEnclosed(r))&&"clip"==n||!o&&"erase"==n?(a||e.push(a=[]),a.push(r)):a=null;return e}}a.filterSlivers=function(e,t,r){return"polygon"!=e.geometry_type?0:function(e,t,r){var n=o.extend({sliver_control:1},r),i=Kl(e,t,n),s=i.filter,l=0,c=function(e,t,r){if(s(e))return l++,null};pn(e.shapes,c),v(o.format("Removed %'d sliver%s using %s",l,o.pluralSuffix(l),i.label)),n.remove_empty&&a.filterFeatures(e,t.arcs,{remove_empty:!0,verbose:!1});return l}(e,t,r)};var Tp=Object.freeze({__proto__:null,clipPolylines:Ep});function Ap(e,t){t=t&&!e.arcs.isPlanar();var r=new Uint8Array(e.arcs.size()),n=Mc(e,t),i=Yl(e,r);return function(t){if(!t)return null;var r=[],o=[];n(t,r,o),r=i(r,"flatten"),o.forEach(pr),(o=i(o,"flatten")).forEach(pr);var a=function(e,t){for(var r=0,n=t.length;r<n;r++)e.push(t[r]);return e}(r,o),s=i(a,"dissolve");return s.length>1&&(s=function(e,t){if(e.length<=1)return e;var r=xr(e,t,"polygon"),n=new Cl(e.map((function(e){return[e]})),t);return e.filter((function(e,t){var i,o=n.findSmallestEnclosingPolygon(e),a=!0;return o>-1&&(i=r[t].area>0,r[o].area>0==i&&(a=!1)),a}))}(s,e.arcs)),s.length>0?s:null}}function Cp(e,t,r,n,i){var o=r.arcs,a=i||{},s=new Uint8Array(o.size()),l=new Uint8Array(o.size()),c=0,u=0,h=[],d=Zl(r,(function(e){var t,r,i=e>=0,o=i?e:~e,a=l[o],c=s[o];i?(t=a,r=c):(t=a>>4,r=c>>4);r&=3;var d=!1;3==(t&=3)?1==r||2==r&&"erase"==n||(d=!0):0===t&&3==r&&(h.push(e),d=!0);d&&(3==r&&u++,a=i?jl(a,1,3):jl(a,16,48));return a|=i?4:64,l[o]=a,d}),(function(e){var t=e>=0,r=t?e:~e,n=t?1:16,i=l[r],o=s[r];o>0&&c++;return(i&n)>0||(o&n)>0})),p=Ap(r);a.bbox2||(e=e.map(p)),Wl(t,o,s,"clip"==n,"erase"==n,!0,17);var f=new Cl(t,o),m=e.map((function(e,t){return e?function(e,t,r){var n=[],i="clip"==t,a="erase"==t;Wl(e,o,l,!0,!1,!1),dn(e,(function(e){for(var t,o=0,s=e.length;o<s;o++)if(c=0,u=0,t=d(e[o]))if(0===c||0===u){var l=r.pathIsEnclosed(t);(i&&l||a&&!l)&&n.push(t)}else n.push(t)})),Hl(e,0,l,!0,!0,!0),h.length>0&&(Hl(h,0,l,!0,!0,!0),h=[]);return 0===n.length?null:n}(e,n,f):null}));Gl(m,l);var g=t.map((function(e){var t=[];return dn(e,(function(e){for(var r,n,i,o=!0,a=!1,c=0;c<e.length;c++){if(r=e[c],n=l,i=void 0,i=or(r),136&n[i]){o=!1;break}!a&&y(e[c],s)&&(a=!0)}o&&a&&t.push(e)})),t.length>0?t:null}));return Hl(t,0,l,!0,!0),f=new Cl(g,o),e.forEach((function(e,t){var r=e?function(e,t,r){var n=r.findPathsInsideShape(e),i=[];if(!n)return null;"erase"==t&&n.forEach(pr);n.length<=1?i=n:(Wl(n,o,l,!0,!1,!0),n.forEach((function(e){for(var t,r=0;r<e.length;r++)(t=d(e[r]))&&i.push(t)})));return i.length>0?i:null}(e,n,f):null;r&&(m[t]=(m[t]||[]).concat(r))})),m;function y(e,t){return(17&t[or(e)])>0}}function Ip(e,t,r,n){var i=new Cl(t,r);return e.reduce((function(e,t){for(var r,o=t?t.length:0,a=[],s=0;s<o;s++)r=i.findEnclosingShape(t[s])>-1,("clip"==n&&r||"erase"==n&&!r)&&a.push(t[s].concat());return e.push(a.length>0?a:null),e}),[])}var kp=Object.freeze({__proto__:null,clipPoints:Ip});function Pp(e,t,r,n){o.some(e,Gi);var i,a,s,l=n.bbox||n.bbox2;return r&&r.geometry_type&&(r={dataset:t,layer:r,disposable:!0}),l?(a=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=[[t,r],[t,i],[n,i],[n,r],[t,r]];i>r&&n>t||_("Invalid bbox (should be [xmin, ymin, xmax, ymax]):",e);return{arcs:new Oo([o]),layers:[{shapes:[[[0]]],geometry_type:"polygon"}]}}(l),s=a.layers[0]):r?r.layer&&r.dataset?(s=r.layer,a=o.defaults({layers:[s]},r.dataset)):r.layers&&1==r.layers.length&&(s=r.layers[0],a=r):_("Command requires a source file, layer id or bbox"),t.arcs!=a.arcs?(r&&!r.disposable&&(a.layers[0]=uo(a.layers[0])),wo(i=wa([t,a]))):((i=o.extend({},t)).layers=t.layers.filter((function(e){return e!=s})),i.layers.push(s)),i}var Mp=Object.freeze({__proto__:null,mergeLayersForOverlay:Pp});function Rp(e,t){var r=e.arcs,n=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=[],s=[],l=[],c=[];return e.forEachSegment((function(e,t,h,d){var p,f=h[e],m=d[e],g=h[t],y=d[t];Dp(f,m,g,y,r,n,i,o)||Op(f,m,g,y,r,n,i,o)||((p=Qr.segmentIntersection(r,o,i,o,f,m,g,y))&&u(a,p,e,t,h,d),(p=Qr.segmentIntersection(r,n,i,n,f,m,g,y))&&u(l,p,e,t,h,d),(p=Qr.segmentIntersection(r,n,r,o,f,m,g,y))&&u(c,p,e,t,h,d),(p=Qr.segmentIntersection(i,n,i,o,f,m,g,y))&&u(s,p,e,t,h,d))})),{cutPoints:c.concat(l,s,a),bboxPoints:Lp(t,c,a,s,l)};function u(e,t,r,n,i,o){t&&(e.push(h(t[0],t[1],r,n,i,o)),4==t.length&&e.push(h(t[2],t[3],r,n,i,o)))}function h(e,t,r,n,i,o){var a=qa(e,t,r,n,i,o);return qc(e,t,a[0],a[1])}}(r,t),i=Fc(n.cutPoints,r);r.dedupCoords(),zc(e,i);var o=function(e){for(var t,r,n=[],i=[],o={geometry_type:"polygon",shapes:[[i]]},a=0,s=e.length-1;a<s;a++)t=e[a],r=e[a+1],n.push([[t.x,t.y],[r.x,r.y]]),i.push(a);return{arcs:new Oo(n),layers:[o]}}(n.bboxPoints),a=wa([e,o]),s=a.layers.pop();return e.arcs=a.arcs,e.layers=a.layers,s}function Dp(e,t,r,n,i,o,a,s){return e<i&&r<i||e>a&&r>a||t<o&&n<o||t>s&&n>s}function Op(e,t,r,n,i,o,a,s){return e>i&&r>i&&e<a&&r<a&&t>o&&n>o&&t<s&&n<s}function Lp(e,t,r,n,i){var a={x:e[0],y:e[1]},s={x:e[0],y:e[3]},l={x:e[2],y:e[3]},c={x:e[2],y:e[1]};return t=o.sortOn(t.concat([a,s]),"y",!0),r=o.sortOn(r.concat([s,l]),"x",!0),n=o.sortOn(n.concat([l,c]),"y",!1),i=o.sortOn(i.concat([c,a]),"x",!1),t.concat(r,n,i).reduce((function(e,t){var r=e.length>0?e[e.length-1]:null;return null!==r&&r.x==t.x&&r.y==t.y||e.push(t),e}),[])}function Bp(e,t,r,n,i){var o=$p(e,t,r,n,i);e.forEach((function(e,t){var r=o[t];e.shapes=r.shapes,e.data=r.data})),$o(r)}function $p(e,t,r,n,i){var a,s,l,c=o.some(e,Gi);return(i=i||{no_cleanup:!0}).bbox2&&c?zp(e,r,i):(s=(a=Pp(e,r,t,i)).layers[a.layers.length-1],c?(l=Lc(a,i),r.arcs=a.arcs,s=eu(s=o.defaults({data:null},s),a,{quiet:!0,silent:!0})):l=new Bo(a.arcs),Fp(e,s,l,n,i))}function zp(e,t,r){return Fp(e,Rp(t,r.bbox2),new Bo(t.arcs),"clip",r)}function Fp(e,t,r,n,i){return io(t,"Requires a polygon clipping layer"),e.reduce((function(e,o){return"slice"==n?e=e.concat(function(e,t,r,n){var i=a.splitLayer(t,n.id_field,{no_replace:!0});return i.map((function(t,i){var o=qp(e,t,r,"clip",n);return o.name=function(e,t,r){var n=t?e.data.getRecords()[0][t]:r+1;return"slice-"+n}(t,n.id_field,i),o}))}(o,t,r,i)):e.push(qp(o,t,r,n,i)),e}),[])}function qp(e,t,r,n,i){var o,s,l,c=r.arcs,u=e.shapes?e.shapes.length:0,h=0;return 0===u?e:(e===t&&_("Can't clip a layer with itself"),"point"==e.geometry_type?s=Ip(e.shapes,t.shapes,c,n):"polygon"==e.geometry_type?s=Cp(e.shapes,t.shapes,r,n,i):"polyline"==e.geometry_type?s=Ep(e.shapes,t.shapes,r,n):_("Invalid target layer:",e.name),l={name:e.name,geometry_type:e.geometry_type,shapes:s,data:e.data},i.remove_slivers&&"polygon"==l.geometry_type&&(h=function(e,t,r){var n=Ql(r,ec(e,r),1),i=new Uint8Array(r.size()),o=0;return hr(t.shapes,i),pn(e.shapes,(function(e){for(var t=0,r=0,a=0,s=e&&e.length||0;a<s;a++)i[or(e[a])]>0?r++:t++;if(r>0&&t>0&&n(e))return o++,null})),o}(l,t,c)),a.filterFeatures(l,c,{remove_empty:!0,verbose:!1}),l.data&&(l.data=l.data.clone()),(o=u-l.shapes.length)&&h&&v(Np(o,h)),l)}function Np(e,t){var r=e?o.format("%,d null feature%s",e,o.pluralSuffix(e)):"",n=t?o.format("%,d sliver%s",t,o.pluralSuffix(t)):"";return r||n?o.format("Removed %s%s%s",r,r&&n?" and ":"",n):""}a.clipLayers=function(e,t,r,n){return $p(e,t,r,"clip",n)},a.eraseLayers=function(e,t,r,n){return $p(e,t,r,"erase",n)},a.clipLayer=function(e,t,r,n){return a.clipLayers([e],t,r,n)[0]},a.eraseLayer=function(e,t,r,n){return a.eraseLayers([e],t,r,n)[0]},a.sliceLayers=function(e,t,r,n){return $p(e,t,r,"slice",n)},a.sliceLayer=function(e,t,r,n){return a.sliceLayers([e],t,r,n)};var jp=Object.freeze({__proto__:null,clipLayers:$p,clipLayersByBBox:zp,clipLayersByLayer:Fp,clipLayersInPlace:Bp,getClipMessage:Np});function Up(e,t){return new Vp(e,(t||{}).encoding)}function Vp(e,t){var r,n=new Pd(e,t),i=!1;function o(){return r||(r=new Fi(n.readRows()),n=null,e=null),r}this.exportAsDbf=function(e){if(!(!n||i||e.field_order||e.encoding))try{return n.getBuffer()}catch(t){}return Gh.exportRecords(o().getRecords(),e.encoding,e.field_order)},this.getReadOnlyRecordAt=function(e){return n?n.readRow(e):r.getReadOnlyRecordAt(e)},this.deleteField=function(e){r?r.deleteField(e):(i=!0,n.deleteField(e))},this.getRecords=function(){return o().getRecords()},this.getFields=function(){return n?n.getFields():r.getFields()},this.isEmpty=function(){return n?0===this.size():r.isEmpty()},this.size=function(){return n?n.size():r.size()}}Object.assign(Vp.prototype,Fi.prototype);var Gp=Object.freeze({__proto__:null,ShapefileTable:Vp,importDbfTable:Up});function Wp(e,t,r){var n,i,o=[],a=e.length,s=t.length;for(o.push(e),n=0;n<s;n++)i=Hp(t[n][e],r),a=Math.max(a,i.length),o.push(i);for(n=0;n<o.length;n++)o[n]=o[n].padEnd(a," ");return o}function Hp(e,t){return null==e?"":o.isString(e)?e:o.isNumber(e)?t.decimal_comma?o.formatIntlNumber(e):o.formatNumber(e):o.isObject(e)?JSON.stringify(e):e+""}function Zp(e){var t=function(e){var t=o.splitLines(e);t.length>2&&t.pop();for(var r,n,i,a,s=function(e){for(var t=0,r=0;r<e.length;r++)t=Math.max(t,e[r].length);return t}(t),l=t[0],c=[],u=0,h=!1,d=!1,p=0;p<=s;p++){if(n=Kp(l,p),r=!Qp(t,p),(i=n&&!d)&&h)return null;(p==s||p>0&&i)&&(a=p==s?void 0:p-1,c.push({name:Yp(l,u,a),end:a,start:u}),u=p),h=r,d=n}return c.length>0?c:null}(e.substring(0,2e3));if(!t)return[];var r=o.splitLines(e);""===r[r.length-1]&&r.pop();for(var n=[],i=1;i<r.length;i++)n.push(Xp(r[i],t));return n}function Yp(e,t,r){return e.substring(t,r).trim()}function Xp(e,t){for(var r,n={},i=0;i<t.length;i++)n[(r=t[i]).name]=Yp(e,r.start,r.end);return n}function Kp(e,t){return t<e.length&&" "!==e[t]}function Qp(e,t){for(var r=0;r<e.length;r++)if(Kp(e[r],t))return!1;return!0}function Jp(e,t){var r=function(e,t){var r=",",n=t.file?lu(t.file):"";t.delimiter?r=t.delimiter:"tsv"==n?r="\t":"csv"==n?r=",":e.input_delimiter&&(r=e.input_delimiter);return r}(e.info,t),n=function(e,t){var r="txt";t.file?r=lu(t.file):"\t"==e?r="tsv":","==e&&(r="csv");return r}(r,t);return e.layers.reduce((function(e,i){return i.data&&e.push({content:ef(i,r,t),filename:(i.name||"output")+"."+n}),e}),[])}function ef(e,t,r){var n=r||{},i=n.encoding||"utf8",o=e.data.getRecords(),a=Li(o,n.field_order);if(" "==t)return function(e,t,r){for(var n,i=[],o=0;o<e.length;o++)if(n=Wp(e[o],t,r),0===o)i=n;else for(var a=0;a<i.length;a++)i[a]+=" "+n[a];return i.join("\n")}(a,o,n);var s=function(e,t,r){var n=rf(t,r);return function(r){return e.map((function(e){return n(r[e])})).join(t)}}(a,t,n);return mi(i)&&!n.to_buffer&&(o.length<1e4||n.to_string)?function(e,t,r){var n=tf(e,r);return t.length?n+"\n"+t.map(r).join("\n"):n}(a,o,s):function(e,t,r,n){var i=tf(e,r),o=[vi(i,n)],a=[],s=t.length,c=0;for(;c<s;)a.push(r(t[c])),++c%1e3!=0&&c!=s||(i="\n"+a.join("\n"),a=[],o.push(vi(i,n)));return l.concat(o)}(a,o,s,i)}function tf(e,t){return t(e.reduce((function(e,t){return e[t]=t,e}),{}))}function rf(e,t){var r=new RegExp('["\n\r'+e+"]"),n=t&&t.decimal_comma||!1;function i(e){return r.test(e)&&(e='"'+e.replace(/"/g,'""')+'"'),e}return function(e){return null==e?"":o.isString(e)?i(e):o.isNumber(e)?n?o.formatIntlNumber(e):o.formatNumber(e):o.isObject(e)?i(JSON.stringify(e)):e+""}}var nf=Object.freeze({__proto__:null,exportDelim:Jp,exportLayerAsDSV:ef,getDelimValueFormatter:rf});function of(e,t,r){var n=r||{};if(" "==t)return function(e,t){return Zp(e.toString(t.encoding||"ascii"))}(e,n);var i,o,a=new yd(e),s=cf(hf(a,function(e){var t=e.csv_skip_lines||0;e.csv_field_names||t++;return t}(n),n.encoding),t,n),l=lf(s.import_fields),c=n.batch_size||1e3,u=[];if(0===s.import_fields.length)return[];for(;i=hf(a,c,n.encoding);)if(o=df(i,t,l,s.column_filter||!1,s.row_filter||!1),u.push.apply(u,o),n.csv_lines&&u.length>=n.csv_lines)return u.slice(0,n.csv_lines);return u}function af(e,t,r){if(" "==t)return Zp(e);var n=cf(e,t,r);if(0===n.import_fields.length||!n.remainder)return[];var i=lf(n.import_fields),o=df(n.remainder,t,i,n.column_filter,n.row_filter);return r.csv_lines>0&&(o=o.slice(0,r.csv_lines)),o}function sf(e,t){var r=/\r\n|[\r\n]|.$/g,n=1;if(1===t)return 0;if(t>1==!1)return-1;for(;r.exec(e);)if(++n<t==!1)return r.lastIndex;return-1}function lf(e){return new Function("arr","return {"+e.map((function(e,t){return JSON.stringify(e)+": arr["+t+'] || ""'})).join(",")+"}")}function cf(e,t,r){var n,i,a,s={headers:[],import_fields:[]},l={};if(e=e||"",r.csv_skip_lines>0){if(-1===(n=sf(e,r.csv_skip_lines+1)))return s;e=e.substr(n)}if(r.csv_field_names)l.headers=r.csv_field_names;else{if(-1===(n=sf(e,2)))return s;l.headers=df(e.slice(0,n),t)[0],e=e.substr(n)}return r.csv_dedup_fields&&(l.headers=o.uniqifyNames(l.headers)),r.csv_filter&&(l.row_filter=(i=r.csv_filter,a=Ls(i),function(e){var t=a(e);return fs(t),t})),r.csv_fields?(l.column_filter=uf(l.headers,r.csv_fields),l.import_fields=l.headers.filter((function(e,t){return l.column_filter(t)}))):l.import_fields=l.headers,l.remainder=e,l}function uf(e,t){var r=o.arrayToIndex(t),n=e.map((function(e){return e in r})),i=o.difference(t,e);if(i.length>0){var a=[""].concat(e).join("\n  "),s=[""].concat(i).join("\n  ");_("csv-fields option has",1==i.length?"a name":i.length+" names","not found in the file\nFields:",a,"\nMissing:",s)}return function(e){return n[e]}}function hf(e,t,r){var n,i=e.readSync(),o=function(e,t){var r,n,i=13,o=10,a=34,s=!1,l=0,c=e.length;for(l++,r=0;r<c&&l<=t;r++)(n=e[r])==a?s=!s:n!=i&&n!=o||s||(n==i&&r+1<c&&e[r+1]==o&&r++,l++);return{bytesRead:r,buffer:e.slice(0,r)}}(i,t);return o.bytesRead==i.length&&o.bytesRead<e.remaining()?(e.expandBuffer(),hf(e,t,r)):(n=o.bytesRead>0?bi(o.buffer,r):"",0===e.position()&&(n=xi(n)),e.advance(o.bytesRead),n)}function df(e,t,r,n,i){var o,a,s,l,c,u=t.charCodeAt(0),h=!1,d=!1,p=-1,f=[];function m(){var e=r?r(c):c;i&&!i(e)||f.push(e),p=-1}function g(e){o=e,0===++p&&(c=[]),n&&!n(p)||(d=!0)}function y(t,r){var n;d&&(d=!1,n=t===r?"":34==e.charCodeAt(t)?e.slice(t+1,r-1).replace(/""/g,'"'):e.slice(t,r),c.push(n))}for(r||(r=function(e){return e}),g(0),a=0,l=e.length;a<l;a++)34==(s=e.charCodeAt(a))?h=!h:h||(s==u?(y(o,a),g(a+1)):13!=s&&10!=s||(y(o,a),m(),13==s&&10==e.charCodeAt(a+1)&&a++,a+1<l&&g(a+1)));return p>-1&&(d&&y(o,a),m()),f}var pf=Object.freeze({__proto__:null,getDelimFieldFilter:uf,getRowConverter:lf,indexOfLine:sf,parseDelimHeaderSection:cf,parseDelimText:df,readDelimRecords:of,readDelimRecordsFromString:af,readLinesAsString:hf});function ff(e,t){var r,n,i,a,s,c=!e.content&&""!==e.content,u=e.content;return t=t||{},c?r=new vd(e.filename):u instanceof ArrayBuffer||u instanceof l||u instanceof Uint8Array?(r=new _d(u),u=null):o.isString(u)||y("Unexpected object type"),r&&("utf16be"==(s=id(r.readSync(0,Math.min(r.size(),3))))||"utf16le"==s?(u=xi(r.toString(s)),r=null):t.encoding&&!gi(t.encoding)&&(u=r.toString(t.encoding),r=null)),0===(n=r?of(r,i=gf(gd(r,2e3)),t):af(u,i=gf(u),t)).length&&v("Unable to read any data records"),_f(n,t),Ii(a=new Fi(n),ki),{layers:[{data:a}],info:{input_delimiter:i}}}var mf=["|","\t",",",";"," "];function gf(e){return o.find(mf,(function(t){var r=function(e){var t="^[^\\n\\r]+"+o.regexEscape(e);return new RegExp(t)}(t);return r.test(e)}))||","}function yf(e){var t={};return(e=e||{}).string_fields&&e.string_fields.forEach((function(e){t[e]="string"})),e.field_types&&e.field_types.forEach((function(e){var r,n,i;-1!=e.indexOf(":")?(n=(r=e.split(":"))[0],i=function(e){var t=e.toLowerCase(),r=null;"n"==t[0]?r="number":"s"==t[0]&&(r="string");return r}(r[1])):"+"===e[0]&&(n=e.substr(1),i="number"),i?t[n]=i:v("Invalid type hint (expected :str or :num) ["+e+"]")})),t}function _f(e,t){var r=t||{},n=yf(r),i=n["*"],a=Object.keys(e[0]||[]),s=[],l=r.decimal_comma?o.parseIntlNumber:o.parseNumber,c={};a.forEach((function(t){var r=n[t],o=null;"number"==r||"number"==i?o=function(e,t,r){for(var n=[],i=0,o=t.length;i<o;i++)n.push(r(t[i][e]));return n}(t,e,l):"string"==r||"string"==i?o=null:(o=function(e,t,r){for(var n,i,o,a=[],s=0,l=0,c=t.length;l<c;l++){if(null===(o=r(n=t[l][e]))){if((i=n?n.trim():"").length>0&&"NA"!=i&&"NaN"!=i)return null}else s++;a.push(o)}return s>0?a:null}(t,e,l),o&&s.push(t)),o&&(c[t]=o)})),Object.keys(c).length>0&&function(e,t,r){var n="return {"+e.map((function(e){var t=JSON.stringify(e);return t+": "+(r[e]?"replacements["+t+"][i]":"rec["+t+"]")})).join(", ")+"}",i=new Function("rec","replacements","i",n);t.forEach((function(e,n){t[n]=i(e,r,n)}))}(a,e,c),s.length>0&&v(o.format("Auto-detected number field%s: %s",1==s.length?"":"s",s.join(", ")))}var vf=Object.freeze({__proto__:null,adjustRecordTypes:_f,getFieldTypeHints:yf,guessDelimiter:gf,importDelim:function(e,t){return ff({content:e},t)},importDelim2:ff,isSupportedDelimiter:function(e){return o.contains(mf,e)}});function bf(e,t,r){return Pl(xr(e,t,"polygon"),t,r).map((function(e){return e.map((function(e){return e.ids}))}))}a.explodeFeatures=function(e,t,r){var n,i,a,s=e.data?e.data.getRecords():null,l=s?[]:null,c=[],u=o.extend({},e);return e.shapes.forEach((function(n,i){var a,u;if(n?(a="polygon"==e.geometry_type&&n.length>1?r&&r.naive?function(e,t){var r=xr(e,t,"polygon");return r.map((function(e){return e.area<0&&pr(e.ids),[e.ids]}))}(n,t):bf(n,t):function(e){return e.map((function(e){return[e.concat()]}))}(n),o.merge(c,a)):c.push(null),null!==l)for(var h=0,d=a?a.length:1;h<d;h++)l.push((u=s[i],Object.assign({},u)))})),u.shapes=c,null!==l&&(u.data=new Fi(l)),n=u,i=Ki(e),a=Ki(n),v(o.format("Exploded %,d feature%s into %,d feature%s",i,o.pluralSuffix(i),a,o.pluralSuffix(a))),u};var wf=Object.freeze({__proto__:null,explodePolygon:bf});function xf(e,t,r){var n,i=e.data;return(!i||r.cut_table||r.drop_table)&&(i=new Fi(e.shapes?e.shapes.length:0)),i.isEmpty()&&i.addIdField(),n=i.exportAsDbf?i.exportAsDbf(r):Gh.exportRecords(i.getRecords(),r.encoding,r.field_order),o.isInteger(r.ldid)&&(new Uint8Array(n)[29]=r.ldid),[{content:n,filename:e.name+".dbf"}]}function Sf(e,t){return e.layers.reduce((function(r,n){var i=function(e,t){var r=t.info||{},n=r.prj;if(!n)try{n=na(da(t))}catch(i){}n||v("Unable to generate .prj file for",e.name+".shp");return n?{content:n,filename:e.name+".prj"}:null}(n,e);return r=r.concat(function(e,t){var r,n=e.shapes||o.initializeArray(new Array(Ki(e)),null),i=new St,a=function(e){var t,r=e.geometry_type;t="point"==r?mn(e.shapes||[])<=1?Rd.POINT:Rd.MULTIPOINT:"polygon"==r?Rd.POLYGON:"polyline"==r?Rd.POLYLINE:Rd.NULL;return t}(e),s=100,l=100+8*n.length,c=new Vh(l).bigEndian().position(100),u=n.map((function(r,n){var o=function(e,t,r){var n=Rd.isMultiPartType(r),i=!n&&!Rd.isMultiPointType(r),o=e.pointCount>0==!1,a=o?null:e.bounds,s=null;if(o)s=new Vh(12,!1).writeInt32(t).writeInt32(2).littleEndian().writeInt32(0);else if(i)s=new Vh(28,!1).writeInt32(t).writeInt32(10).littleEndian().writeInt32(r).writeFloat64(e.pathData[0].points[0][0]).writeFloat64(e.pathData[0].points[0][1]);else{var l=52,c=n?l+4*e.pathCount:48,u=c+16*e.pointCount,h=0;s=new Vh(u,!1).writeInt32(t).writeInt32((u-8)/2).littleEndian().writeInt32(r).writeFloat64(a.xmin).writeFloat64(a.ymin).writeFloat64(a.xmax).writeFloat64(a.ymax),n&&s.writeInt32(e.pathCount),s.writeInt32(e.pointCount),e.pathData.forEach((function(e,t){n&&s.position(l+4*t).writeInt32(h),s.position(c+16*h);for(var r=0,i=e.points.length;r<i;r++)s.writeFloat64(e.points[r][0]),s.writeFloat64(e.points[r][1]);h+=r})),e.pointCount!=h&&y("Shp record point count mismatch; pointCount:",h,"data.pointCount:",e.pointCount)}return{bounds:a,buffer:s.buffer()}}(Rl(r,t.arcs,e.geometry_type),n+1,a),l=o.buffer.byteLength;return c.writeInt32(s/2),c.writeInt32(l/2-4),s+=l,o.bounds&&i.mergeBounds(o.bounds),o.buffer}));r=new Vh(s,!1).writeInt32(9994).skipBytes(20).writeInt32(s/2).littleEndian().writeInt32(1e3).writeInt32(a),i.hasBounds()?r.writeFloat64(i.xmin||0).writeFloat64(i.ymin||0).writeFloat64(i.xmax||0).writeFloat64(i.ymax||0):r.skipBytes(32);return r.skipBytes(32),u.forEach((function(e){r.writeBuffer(e)})),c.position(0).writeBuffer(r.buffer(),100).position(24).writeInt32(l/2),[{content:r.buffer(),filename:e.name+".shp"},{content:c.buffer(),filename:e.name+".shx"}]}(n,e)),r=r.concat(xf(n,0,t)),i&&r.push(i),r}),[])}var Ef=Object.freeze({__proto__:null,exportShapefile:Sf});function Tf(e){var t=1e4/e;return function(e){return e===1/0?0:Math.ceil(e*t)}}function Af(e,t){var r="."+(t.extension||"json"),n=!t.final||Go(e)&&e.arcs.getRetainedInterval()>0,i=JSON.stringify;return n&&(e=qo(e)),t.prettify&&(i=Ll("coordinates,arcs,bbox,translate,scale".split(","))),t.width>0||t.height>0?cl(e,ll(e,t=o.defaults({invert_y:!0},t))):t.fit_bbox&&cl(e,ll(e,{fit_bbox:t.fit_bbox})),t.precision&&t.no_quantization?cs(e,t.precision,!!t.fix_geometry):t.precision&&v(`Ignoring precision=${t.precision} -- this option only works with no-quantization.`),t.singles?zo(e).map((function(e){return{content:i(Dd.exportTopology(e,t)),filename:(e.layers[0].name||"output")+r}})):[{filename:t.file||pu(e)+r,content:i(Dd.exportTopology(e,t))}]}function Cf(e,t){var r=cr(e);return[r[0]*t,r[1]*t]}function If(e,t,r){var n;return n=r.topojson_precision>0?Cf(t,r.topojson_precision):r.quantization>0?[e.width()/(r.quantization-1),e.height()/(r.quantization-1)]:r.precision>0?[r.precision,r.precision]:Cf(t,.02),new St(0,0,Math.ceil(e.width()/n[0])||0,Math.ceil(e.height()/n[1])||0)}Dd.getPresimplifyFunction=Tf,Dd.exportTopology=function(e,t){var r={type:"Topology",arcs:[]},n=Go(e),i=jo(e);return t.bbox&&i.hasBounds()&&(r.bbox=i.toArray()),n&&t.presimplify&&!e.arcs.getVertexData().zz&&a.simplify(e,t),t.no_quantization||!t.quantization&&!n||(r.transform=function(e,t,r){var n,i=If(t,e.arcs,r),o=t.getTransform(i),a=o.invert();function s(e,t){var r=o.transform(e,t);return[Math.round(r[0]),Math.round(r[1])]}function l(e,t){return o.transform(e,t)}e.arcs&&r.fix_geometry?(e.arcs.transformPoints(l),n=Ka(e.arcs),e.arcs.transformPoints((function(e,t){return[Math.round(e),Math.round(t)]})),n(e.arcs)):e.arcs&&e.arcs.transformPoints(s);r.no_point_quantization||e.layers.filter(Wi).forEach((function(e){Xi(e,s)}));return{scale:[a.mx,a.my],translate:[a.bx,a.by]}}(e,i,t)),n&&($o(e),r.arcs=function(e,t,r){var n=null,i=[];r.presimplify&&(n=Tf(t.width()));return e.forEach2((function(e,t,r,o,a){for(var s,l=[],c=e+t;e<c;e++)s=[r[e],o[e]],n&&s.push(n(a[e])),l.push(s);i.push(l.length>1?l:null)})),i}(e.arcs,i,t),r.transform&&r.arcs.forEach((function(e){for(var t,r,n,i,o,a=0,s=e.length;a<s;a++)n=(o=e[a])[0],i=o[1],a>0&&(o[0]=n-t,o[1]=i-r),t=n,r=i}))),r.objects=e.layers.reduce((function(r,n,i){return r[n.name||"layer"+(i+1)]=Dd.exportLayer(n,e.arcs,t),r}),{}),t.metadata&&(r.metadata=function(e){var t=da(e),r=null;return t&&(r=ra(t)),{proj4:r}}(e)),r},Dd.exportProperties=function(e,t,r){var n=Eu(t,r),i=Au(t,r);e.forEach((function(e,t){n&&(e.properties=n[t]),i&&(e.id=i[t])}))},Dd.exportLayer=function(e,t,r){for(var n,i=Ki(e),o=[],a=Dd.exporters[e.geometry_type]||null,s=0;s<i;s++)n=a&&e.shapes[s],o[s]=n?a(n,t,r):{type:null};return e.data&&Dd.exportProperties(o,e.data,r),{type:"GeometryCollection",geometries:o}},Dd.exportPolygonGeom=function(e,t,r){var n={};return(e=wr(e,t))&&0!==e.length?e.length>1?(n.arcs=bf(e,t,r.invert_y),1==n.arcs.length?(n.arcs=n.arcs[0],n.type="Polygon"):n.type="MultiPolygon"):(n.arcs=e,n.type="Polygon"):n.type=null,n},Dd.exportLineGeom=function(e,t){var r={};return(e=wr(e,t))&&0!==e.length?1==e.length?(r.type="LineString",r.arcs=e[0]):(r.type="MultiLineString",r.arcs=e):r.type=null,r},Dd.exporters={polygon:Dd.exportPolygonGeom,polyline:Dd.exportLineGeom,point:yl.exportPointGeom};var kf=Object.freeze({__proto__:null,calcExportBounds:If,exportTopoJSON:Af});function Pf(e){return Ai(e),{layers:[{data:new Fi(e)}],info:{}}}function Mf(e,t){return e.layers.reduce((function(e,r){return r.data&&e.push({content:Rf(r,t),filename:(r.name||"output")+".json"}),e}),[])}function Rf(e,t){t=t||{};var r=e.data.getRecords();return t.ndjson?r.map(Ol).join("\n"):t.prettify?Ll([])(r):JSON.stringify(r)}var Df=Object.freeze({__proto__:null,exportJSON:Mf,exportJSONTable:Rf,importJSONTable:Pf});function Of(e){var t=lu(e||"").toLowerCase(),r=null;return"dbf"==t||"shp"==t||"kml"==t||Lf(t)?r=t:/json$/.test(t)?r="json":"csv"!=t&&"tsv"!=t&&"txt"!=t&&"tab"!=t||(r="text"),r}function Lf(e){return"prj"==e||"shx"==e||"cpg"==e}function Bf(e){var t=null;return o.isString(e)?t=(zf(e)?"json":Ff(e)&&"kml")||"text":(o.isObject(e)&&e.type||o.isArray(e))&&(t="json"),t}function $f(e,t){return Of(e)||Bf(t)}function zf(e){return/^\s*[{[]/.test(String(e))}function Ff(e){return(e=String(e)).includes("<kml ")&&e.includes('xmlns="http://www.opengis.net/kml/')}function qf(e){var t=lu(e).toLowerCase();return/csv|tsv|txt$/.test(t)}function Nf(e){var t=Of(e);return!!t&&"gz"!=t&&"zip"!=t}function jf(e){return/\.zip$/i.test(e)}function Uf(e){return/\.kmz$/i.test(e)}function Vf(e){return/\.gz$/i.test(e)}function Gf(e){var t=lu(e).toLowerCase();return"shp"==t||"shx"==t||"dbf"==t}function Wf(e){var t=Of(e);return Gf(e)||jf(e)||Vf(e)||Uf(e)||"json"==t||"text"==t}var Hf=Object.freeze({__proto__:null,couldBeDsvFile:qf,filenameIsUnsupportedOutputType:function(e){return/\.(shx|prj|xls|xlsx|gdb|sbn|sbx|xml)$/i.test(e)},getFormatName:function(e){return{geojson:"GeoJSON",topojson:"TopoJSON",json:"JSON records",dsv:"CSV",dbf:"DBF",kml:"KML",kmz:"KMZ",shapefile:"Shapefile",svg:"SVG"}[e]||""},guessInputContentType:Bf,guessInputFileType:Of,guessInputType:$f,isAuxiliaryInputFileType:Lf,isGzipFile:Vf,isImportableAsBinary:Wf,isKmzFile:Uf,isSupportedBinaryInputType:Gf,isSupportedOutputFormat:function(e){return["geojson","topojson","json","dsv","dbf","shapefile","svg","kml"].indexOf(e)>-1},isZipFile:jf,looksLikeContentFile:Nf,looksLikeImportableFile:function(e){return!!Of(e)||Wf(e)},stringLooksLikeJSON:zf,stringLooksLikeKML:Ff});function Zf(e,t){var r=t.file||null,n=e.info&&e.info.input_formats&&e.info.input_formats[0],i=null;return t.format?t.format:(r?i=Yf(r,n):n&&(i=n),"json"==i&&Vo(e)&&(i="geojson"),i||null)}function Yf(e,t){var r=lu(e).toLowerCase(),n=null;return"gz"==r?Yf(uu(e,""),t):("shp"==r?n="shapefile":"dbf"==r?n="dbf":"svg"==r?n="svg":"kml"==r||"kmz"==r?n="kml":/json$/.test(r)?(n="geojson","topojson"==r||"topojson"==t&&"geojson"!=r?n="topojson":"json"==r&&"json"==t&&(n="json")):qf(e)?n="dsv":t&&(n=t),n)}var Xf=Object.freeze({__proto__:null,getOutputFormat:Zf,inferOutputFormat:Yf}),Kf={},Qf=Uint8Array,Jf=Uint16Array,em=Int32Array,tm=new Qf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rm=new Qf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nm=new Qf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),im=function(e,t){for(var r=new Jf(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new em(r[30]);for(n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},om=im(tm,2),am=om.b,sm=om.r;am[28]=258,sm[258]=28;for(var lm=im(rm,0),cm=lm.b,um=lm.r,hm=new Jf(32768),dm=0;dm<32768;++dm){var pm=(43690&dm)>>1|(21845&dm)<<1;pm=(61680&(pm=(52428&pm)>>2|(13107&pm)<<2))>>4|(3855&pm)<<4,hm[dm]=((65280&pm)>>8|(255&pm)<<8)>>1}var fm=function(e,t,r){for(var n=e.length,i=0,o=new Jf(t);i<n;++i)e[i]&&++o[e[i]-1];var a,s=new Jf(t);for(i=1;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;if(r){a=new Jf(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=s[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[hm[h]>>l]=c}else for(a=new Jf(n),i=0;i<n;++i)e[i]&&(a[i]=hm[s[e[i]-1]++]>>15-e[i]);return a},mm=new Qf(288);for(dm=0;dm<144;++dm)mm[dm]=8;for(dm=144;dm<256;++dm)mm[dm]=9;for(dm=256;dm<280;++dm)mm[dm]=7;for(dm=280;dm<288;++dm)mm[dm]=8;var gm=new Qf(32);for(dm=0;dm<32;++dm)gm[dm]=5;var ym=fm(mm,9,0),_m=fm(mm,9,1),vm=fm(gm,5,0),bm=fm(gm,5,1),wm=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},xm=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},Sm=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},Em=function(e){return(e+7)/8|0},Tm=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new Qf(e.subarray(t,r))},Am=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Cm=function(e,t,r){var n=new Error(t||Am[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Cm),!r)throw n;return n},Im=function(e,t,r,n){var i=e.length,o=n?n.length:0;if(!i||t.f&&!t.l)return r||new Qf(0);var a=!r,s=a||2!=t.i,l=t.i;a&&(r=new Qf(3*i));var c=function(e){var t=r.length;if(e>t){var n=new Qf(Math.max(2*t,e));n.set(r),r=n}},u=t.f||0,h=t.p||0,d=t.b||0,p=t.l,f=t.d,m=t.m,g=t.n,y=8*i;do{if(!p){u=xm(e,h,1);var _=xm(e,h+1,3);if(h+=3,!_){var v=e[(P=Em(h)+4)-4]|e[P-3]<<8,b=P+v;if(b>i){l&&Cm(0);break}s&&c(d+v),r.set(e.subarray(P,b),d),t.b=d+=v,t.p=h=8*b,t.f=u;continue}if(1==_)p=_m,f=bm,m=9,g=5;else if(2==_){var w=xm(e,h,31)+257,x=xm(e,h+10,15)+4,S=w+xm(e,h+5,31)+1;h+=14;for(var E=new Qf(S),T=new Qf(19),A=0;A<x;++A)T[nm[A]]=xm(e,h+3*A,7);h+=3*x;var C=wm(T),I=(1<<C)-1,k=fm(T,C,1);for(A=0;A<S;){var P,M=k[xm(e,h,I)];if(h+=15&M,(P=M>>4)<16)E[A++]=P;else{var R=0,D=0;for(16==P?(D=3+xm(e,h,3),h+=2,R=E[A-1]):17==P?(D=3+xm(e,h,7),h+=3):18==P&&(D=11+xm(e,h,127),h+=7);D--;)E[A++]=R}}var O=E.subarray(0,w),L=E.subarray(w);m=wm(O),g=wm(L),p=fm(O,m,1),f=fm(L,g,1)}else Cm(1);if(h>y){l&&Cm(0);break}}s&&c(d+131072);for(var B=(1<<m)-1,$=(1<<g)-1,z=h;;z=h){var F=(R=p[Sm(e,h)&B])>>4;if((h+=15&R)>y){l&&Cm(0);break}if(R||Cm(2),F<256)r[d++]=F;else{if(256==F){z=h,p=null;break}var q=F-254;if(F>264){var N=tm[A=F-257];q=xm(e,h,(1<<N)-1)+am[A],h+=N}var j=f[Sm(e,h)&$],U=j>>4;j||Cm(3),h+=15&j;L=cm[U];if(U>3){N=rm[U];L+=Sm(e,h)&(1<<N)-1,h+=N}if(h>y){l&&Cm(0);break}s&&c(d+131072);var V=d+q;if(d<L){var G=o-L,W=Math.min(L,V);for(G+d<0&&Cm(3);d<W;++d)r[d]=n[G+d]}for(;d<V;++d)r[d]=r[d-L]}}t.l=p,t.p=z,t.b=d,t.f=u,p&&(u=1,t.m=m,t.d=f,t.n=g)}while(!u);return d!=r.length&&a?Tm(r,0,d):r.subarray(0,d)},km=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Pm=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Mm=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,o=r.slice();if(!i)return{t:zm,l:0};if(1==i){var a=new Qf(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var s=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:s.f+l.f,l:s,r:l};var d=o[0].s;for(n=1;n<i;++n)o[n].s>d&&(d=o[n].s);var p=new Jf(d+1),f=Rm(r[u-1],p,0);if(f>t){n=0;var m=0,g=f-t,y=1<<g;for(o.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));n<i;++n){var _=o[n].s;if(!(p[_]>t))break;m+=y-(1<<f-p[_]),p[_]=t}for(m>>=g;m>0;){var v=o[n].s;p[v]<t?m-=1<<t-p[v]++-1:++n}for(;n>=0&&m;--n){var b=o[n].s;p[b]==t&&(--p[b],++m)}f=t}return{t:new Qf(p),l:f}},Rm=function(e,t,r){return-1==e.s?Math.max(Rm(e.l,t,r+1),Rm(e.r,t,r+1)):t[e.s]=r},Dm=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Jf(++t),n=0,i=e[0],o=1,a=function(e){r[n++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return{c:r.subarray(0,n),n:t}},Om=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Lm=function(e,t,r){var n=r.length,i=Em(t+2);e[i]=255&n,e[i+1]=n>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<n;++o)e[i+o+4]=r[o];return 8*(i+4+n)},Bm=function(e,t,r,n,i,o,a,s,l,c,u){km(t,u++,r),++i[256];for(var h=Mm(i,15),d=h.t,p=h.l,f=Mm(o,15),m=f.t,g=f.l,y=Dm(d),_=y.c,v=y.n,b=Dm(m),w=b.c,x=b.n,S=new Jf(19),E=0;E<_.length;++E)++S[31&_[E]];for(E=0;E<w.length;++E)++S[31&w[E]];for(var T=Mm(S,7),A=T.t,C=T.l,I=19;I>4&&!A[nm[I-1]];--I);var k,P,M,R,D=c+5<<3,O=Om(i,mm)+Om(o,gm)+a,L=Om(i,d)+Om(o,m)+a+14+3*I+Om(S,A)+2*S[16]+3*S[17]+7*S[18];if(l>=0&&D<=O&&D<=L)return Lm(t,u,e.subarray(l,l+c));if(km(t,u,1+(L<O)),u+=2,L<O){k=fm(d,p,0),P=d,M=fm(m,g,0),R=m;var B=fm(A,C,0);km(t,u,v-257),km(t,u+5,x-1),km(t,u+10,I-4),u+=14;for(E=0;E<I;++E)km(t,u+3*E,A[nm[E]]);u+=3*I;for(var $=[_,w],z=0;z<2;++z){var F=$[z];for(E=0;E<F.length;++E){var q=31&F[E];km(t,u,B[q]),u+=A[q],q>15&&(km(t,u,F[E]>>5&127),u+=F[E]>>12)}}}else k=ym,P=mm,M=vm,R=gm;for(E=0;E<s;++E){var N=n[E];if(N>255){Pm(t,u,k[(q=N>>18&31)+257]),u+=P[q+257],q>7&&(km(t,u,N>>23&31),u+=tm[q]);var j=31&N;Pm(t,u,M[j]),u+=R[j],j>3&&(Pm(t,u,N>>5&8191),u+=rm[j])}else Pm(t,u,k[N]),u+=P[N]}return Pm(t,u,k[256]),u+P[256]},$m=new em([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),zm=new Qf(0),Fm=function(e,t,r,n,i,o){var a=o.z||e.length,s=new Qf(n+a+5*(1+Math.ceil(a/7e3))+i),l=s.subarray(n,s.length-i),c=o.l,u=7&(o.r||0);if(t){u&&(l[0]=o.r>>3);for(var h=$m[t-1],d=h>>13,p=8191&h,f=(1<<r)-1,m=o.p||new Jf(32768),g=o.h||new Jf(f+1),y=Math.ceil(r/3),_=2*y,v=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<_)&f},b=new em(25e3),w=new Jf(288),x=new Jf(32),S=0,E=0,T=o.i||0,A=0,C=o.w||0,I=0;T+2<a;++T){var k=v(T),P=32767&T,M=g[k];if(m[P]=M,g[k]=P,C<=T){var R=a-T;if((S>7e3||A>24576)&&(R>423||!c)){u=Bm(e,l,0,b,w,x,E,A,I,T-I,u),A=S=E=0,I=T;for(var D=0;D<286;++D)w[D]=0;for(D=0;D<30;++D)x[D]=0}var O=2,L=0,B=p,$=P-M&32767;if(R>2&&k==v(T-$))for(var z=Math.min(d,R)-1,F=Math.min(32767,T),q=Math.min(258,R);$<=F&&--B&&P!=M;){if(e[T+O]==e[T+O-$]){for(var N=0;N<q&&e[T+N]==e[T+N-$];++N);if(N>O){if(O=N,L=$,N>z)break;var j=Math.min($,N-2),U=0;for(D=0;D<j;++D){var V=T-$+D&32767,G=V-m[V]&32767;G>U&&(U=G,M=V)}}}$+=(P=M)-(M=m[P])&32767}if(L){b[A++]=268435456|sm[O]<<18|um[L];var W=31&sm[O],H=31&um[L];E+=tm[W]+rm[H],++w[257+W],++x[H],C=T+O,++S}else b[A++]=e[T],++w[e[T]]}}for(T=Math.max(T,C);T<a;++T)b[A++]=e[T],++w[e[T]];u=Bm(e,l,c,b,w,x,E,A,I,T-I,u),c||(o.r=7&u|l[u/8|0]<<3,u-=7,o.h=g,o.p=m,o.i=T,o.w=C)}else{for(T=o.w||0;T<a+c;T+=65535){var Z=T+65535;Z>=a&&(l[u/8|0]=c,Z=a),u=Lm(l,u+1,e.subarray(T,Z))}o.i=a}return Tm(s,0,n+Em(u)+i)},qm=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,n=9;--n;)r=(1&r&&-306674912)^r>>>1;e[t]=r}return e}(),Nm=function(){var e=-1;return{p:function(t){for(var r=e,n=0;n<t.length;++n)r=qm[255&r^t[n]]^r>>>8;e=r},d:function(){return~e}}},jm=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),a=new Qf(o.length+e.length);a.set(o),a.set(e,o.length),e=a,i.w=o.length}return Fm(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,n,i)},Um=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Vm=function(e,t,r){for(var n=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<n.length;++a){var s=n[a],l=o[a];if("function"==typeof s){t+=";"+l+"=";var c=s.toString();if(s.prototype)if(-1!=c.indexOf("[native code]")){var u=c.indexOf(" ",8)+1;t+=c.slice(u,c.indexOf("(",u))}else for(var h in t+=c,s.prototype)t+=";"+l+".prototype."+h+"="+s.prototype[h].toString();else t+=c}else r[l]=s}return t},Gm=[],Wm=function(e,t,r,n){if(!Gm[r]){for(var i="",o={},a=e.length-1,s=0;s<a;++s)i=Vm(e[s],i,o);Gm[r]={c:Vm(e[a],i,o),e:o}}var l=Um({},Gm[r].e);return function(e,t,r,n,i){var o=new Worker(Kf[t]||(Kf[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var n=new Error(r[0]);n.code=r[1],n.stack=r[2],i(n,null)}else i(null,t)},o.postMessage(r,n),o}(Gm[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,l,function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(l),n)},Hm=function(){return[Qf,Jf,em,tm,rm,nm,am,cm,_m,bm,hm,Am,fm,wm,xm,Sm,Em,Tm,Cm,Im,cg,Km,Qm]},Zm=function(){return[Qf,Jf,em,tm,rm,nm,sm,um,ym,mm,vm,gm,hm,$m,zm,fm,km,Pm,Mm,Rm,Dm,Om,Lm,Bm,Em,Tm,Fm,jm,lg,Km]},Ym=function(){return[ig,sg,ng,Nm,qm]},Xm=function(){return[og,ag]},Km=function(e){return postMessage(e,[e.buffer])},Qm=function(e){return e&&{out:e.size&&new Qf(e.size),dictionary:e.dictionary}},Jm=function(e,t,r,n,i,o){var a=Wm(r,n,i,(function(e,t){a.terminate(),o(e,t)}));return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},eg=function(e,t){return e[t]|e[t+1]<<8},tg=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},rg=function(e,t){return tg(e,t)+4294967296*tg(e,t+4)},ng=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},ig=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&ng(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var n=0;n<=r.length;++n)e[n+10]=r.charCodeAt(n)}},og=function(e){31==e[0]&&139==e[1]&&8==e[2]||Cm(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=2+(e[10]|e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},ag=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},sg=function(e){return 10+(e.filename?e.filename.length+1:0)};function lg(e,t){return jm(e,t||{},0,0)}function cg(e,t){return Im(e,{i:2},t&&t.out,t&&t.dictionary)}function ug(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&Cm(7),Jm(e,t,[Zm,Ym,function(){return[hg]}],(function(e){return Km(hg(e.data[0],e.data[1]))}),2,r)}function hg(e,t){t||(t={});var r=Nm(),n=e.length;r.p(e);var i=jm(e,t,sg(t),8),o=i.length;return ig(i,t),ng(i,o-8,r.d()),ng(i,o-4,n),i}function dg(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&Cm(7),Jm(e,t,[Hm,Xm,function(){return[pg]}],(function(e){return Km(pg(e.data[0],e.data[1]))}),3,r)}function pg(e,t){var r=og(e);return r+8>e.length&&Cm(6,"invalid gzip data"),Im(e.subarray(r,-8),{i:2},t&&t.out||new Qf(ag(e)),t&&t.dictionary)}var fg=function(e,t,r,n){for(var i in e){var o=e[i],a=t+i,s=n;Array.isArray(o)&&(s=Um(n,o[1]),o=o[0]),o instanceof Qf?r[a]=[o,s]:(r[a+="/"]=[new Qf(0),s],fg(o,a,r,n))}},mg="undefined"!=typeof TextEncoder&&new TextEncoder,gg="undefined"!=typeof TextDecoder&&new TextDecoder;try{gg.decode(zm,{stream:!0})}catch(qw){}function yg(e,t){if(mg)return mg.encode(e);for(var r=e.length,n=new Qf(e.length+(e.length>>1)),i=0,o=function(e){n[i++]=e},a=0;a<r;++a){if(i+5>n.length){var s=new Qf(i+8+(r-a<<1));s.set(n),n=s}var l=e.charCodeAt(a);l<128||t?o(l):l<2048?(o(192|l>>6),o(128|63&l)):l>55295&&l<57344?(o(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++a))>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|63&l)):(o(224|l>>12),o(128|l>>6&63),o(128|63&l))}return Tm(n,0,i)}function _g(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if(gg)return gg.decode(e);var i=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return{s:t,r:Tm(e,r-1)};i?3==i?(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|n>>10,56320|1023&n)):t+=1&i?String.fromCharCode((31&n)<<6|63&e[r++]):String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}}(e),o=i.s;return(r=i.r).length&&Cm(8),o}var vg=function(e,t){return t+30+eg(e,t+26)+eg(e,t+28)},bg=function(e,t,r){var n=eg(e,t+28),i=_g(e.subarray(t+46,t+46+n),!(2048&eg(e,t+8))),o=t+46+n,a=tg(e,t+20),s=r&&4294967295==a?wg(e,o):[a,tg(e,t+24),tg(e,t+42)],l=s[0],c=s[1],u=s[2];return[eg(e,t+10),l,c,i,o+eg(e,t+30)+eg(e,t+32),u]},wg=function(e,t){for(;1!=eg(e,t);t+=4+eg(e,t+2));return[rg(e,t+12),rg(e,t+4),rg(e,t+20)]},xg=function(e){var t=0;if(e)for(var r in e){var n=e[r].length;n>65535&&Cm(9),t+=n+4}return t},Sg=function(e,t,r,n,i,o,a,s){var l=n.length,c=r.extra,u=s&&s.length,h=xg(c);ng(e,t,null!=a?33639248:67324752),t+=4,null!=a&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(o<0&&8),e[t++]=i&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var d=new Date(null==r.mtime?Date.now():r.mtime),p=d.getFullYear()-1980;if((p<0||p>119)&&Cm(10),ng(e,t,p<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),t+=4,-1!=o&&(ng(e,t,r.crc),ng(e,t+4,o<0?-o-2:o),ng(e,t+8,r.size)),ng(e,t+12,l),ng(e,t+14,h),t+=16,null!=a&&(ng(e,t,u),ng(e,t+6,r.attrs),ng(e,t+10,a),t+=14),e.set(n,t),t+=l,h)for(var f in c){var m=c[f],g=m.length;ng(e,t,+f),ng(e,t+2,g),e.set(m,t+4),t+=4+g}return u&&(e.set(s,t),t+=u),t},Eg=function(e,t,r,n,i){ng(e,t,101010256),ng(e,t+8,r),ng(e,t+10,r),ng(e,t+12,n),ng(e,t+16,i)};function Tg(e,t,r){r||(r=t,t={}),"function"!=typeof r&&Cm(7);var n={};fg(e,"",n,t);var i=Object.keys(n),o=i.length,a=0,s=0,l=o,c=new Array(o),u=[],h=function(){for(var e=0;e<u.length;++e)u[e]()},d=function(e,t){Ag((function(){r(e,t)}))};Ag((function(){d=r}));var p=function(){var e=new Qf(s+22),t=a,r=s-a;s=0;for(var n=0;n<l;++n){var i=c[n];try{var o=i.c.length;Sg(e,s,i,i.f,i.u,o);var u=30+i.f.length+xg(i.extra),h=s+u;e.set(i.c,h),Sg(e,a,i,i.f,i.u,o,s,i.m),a+=16+u+(i.m?i.m.length:0),s=h+o}catch(qw){return d(qw,null)}}Eg(e,a,c.length,r,t),d(null,e)};o||p();for(var f=function(e){var t=i[e],r=n[t],l=r[0],f=r[1],m=Nm(),g=l.length;m.p(l);var y=yg(t),_=y.length,v=f.comment,b=v&&yg(v),w=b&&b.length,x=xg(f.extra),S=0==f.level?0:8,E=function(r,n){if(r)h(),d(r,null);else{var i=n.length;c[e]=Um(f,{size:g,crc:m.d(),c:n,f:y,m:b,u:_!=t.length||b&&v.length!=w,compression:S}),a+=30+_+x+i,s+=76+2*(_+x)+(w||0)+i,--o||p()}};if(_>65535&&E(Cm(11,0,1),null),S)if(g<16e4)try{E(null,lg(l,f))}catch(qw){E(qw,null)}else u.push(function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&Cm(7),Jm(e,t,[Zm],(function(e){return Km(lg(e.data[0],e.data[1]))}),0,r)}(l,f,E));else E(null,l)},m=0;m<l;++m)f(m);return h}var Ag="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()};function Cg(e,t,r){r||(r=t,t={}),"function"!=typeof r&&Cm(7);var n=[],i=function(){for(var e=0;e<n.length;++e)n[e]()},o={},a=function(e,t){Ag((function(){r(e,t)}))};Ag((function(){a=r}));for(var s=e.length-22;101010256!=tg(e,s);--s)if(!s||e.length-s>65558)return a(Cm(13,0,1),null),i;var l=eg(e,s+8);if(l){var c=l,u=tg(e,s+16),h=4294967295==u||65535==c;if(h){var d=tg(e,s-12);(h=101075792==tg(e,d))&&(c=l=tg(e,d+32),u=tg(e,d+48))}for(var p=t&&t.filter,f=function(t){var r=bg(e,u,h),s=r[0],c=r[1],d=r[2],f=r[3],m=r[4],g=r[5],y=vg(e,g);u=m;var _=function(e,t){e?(i(),a(e,null)):(t&&(o[f]=t),--l||a(null,o))};if(!p||p({name:f,size:c,originalSize:d,compression:s}))if(s)if(8==s){var v=e.subarray(y,y+c);if(d<524288||c>.8*d)try{_(null,cg(v,{out:new Qf(d)}))}catch(b){_(b,null)}else n.push(function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&Cm(7),Jm(e,t,[Hm],(function(e){return Km(cg(e.data[0],Qm(e.data[1])))}),1,r)}(v,{size:d},_))}else _(Cm(14,"unknown compression type "+s,1),null);else _(null,Tm(e,y,y+c));else _(null,null)},m=0;m<c;++m)f()}else a(null,{});return i}function Ig(e,t){return"string"==typeof e&&(e=yg(e)),fd()?hg(e,t):requireLib$1().gzipSync(e,t)}function kg(e,t){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r=pg(e);return t&&!Wf(t)&&(r=_g(r)),r}var Pg=Object.freeze({__proto__:null,gunzipAsync:async function(e,t){e instanceof ArrayBuffer&&(e=new Uint8Array(e)),t=t||{};var r=fd()?o.promisify(dg):o.promisify(requireLib$1().gunzip),n=await r(e,t);return t.filename&&!Wf(t.filename)&&(n=_g(n)),n},gunzipSync:kg,gzipAsync:async function(e,t){return"string"==typeof e&&(e=yg(e)),(fd()?o.promisify(ug):o.promisify(requireLib$1().gzip))(e,t)},gzipSync:Ig,isGzipped:function(e){return e.length>2&&e.buffer instanceof ArrayBuffer&&31==e[0]&&139==e[1]}});function Mg(e,t){var r,n,i=t.format=Zf(e,t),a=Rg[i],s=[];return i?a||y("Unknown output format:",i):y("Missing output format"),e=o.defaults({layers:e.layers.map((function(e){return o.extend({},e)}))},e),t.file&&"topojson"!=i&&"svg"!=i&&"kml"!=i&&e.layers.forEach((function(e){e.name=su(t.file)})),Dg(e.layers),t.precision&&"svg"!=i&&"topojson"!=i&&cs(e=qo(e),t.precision,!!t.fix_geometry),t.cut_table&&(s=(r=e.layers,n=[],r.forEach((function(e){e.data&&n.push({content:JSON.stringify(e.data),filename:(e.name?e.name+"-":"")+"table.json"})})),n).concat(s)),t.extension&&(t.extension=t.extension.replace(/^\.+/,"")),function(e){e.forEach((function(e){e.geometry_type?(o.contains(["polygon","polyline","point"],e.geometry_type)||y("A layer has an invalid geometry type:",e.geometry_type),e.shapes||y("A layer is missing shape data")):e.shapes&&o.some(e.shapes,(function(e){return!!e}))&&y("A layer contains shape records and a null geometry type")}))}(e.layers),function(e){var t={};e.forEach((function(e,r){var n=e.filename;n||y("Missing a filename for file"+r),n in t&&y("Duplicate filename",n),t[n]=!0}))}(s=a(e,t).concat(s)),s}var Rg={geojson:mu,topojson:Af,shapefile:Sf,dsv:Jp,dbf:function(e,t){return e.layers.reduce((function(r,n){return n.data&&(r=r.concat(xf(n,e,t))),r}),[])},json:Mf,svg:Ku,kml:function(e,t){return[{content:(0,requireTokml().toKML)(vu(e,Object.assign({combine_layers:!0,geojson_type:"FeatureCollection"},t))),filename:t.file||pu(e)+".kml"}]}};function Dg(e){var t=e.map((function(e){return e.name||"layer"})),r=o.uniqifyNames(t);e.forEach((function(e,t){e.name=r[t]}))}function Og(e){var t=e.map((function(e){return e.filename})),r=o.uniqifyNames(t,Lg);e.forEach((function(e,t){e.filename=r[t]}))}function Lg(e,t){var r,n,i=e.split(".");return i.length<2?o.formatVersionedName(e,t):(r=i.pop(),n=i.join("."),o.formatVersionedName(n,t)+"."+r)}var Bg=Object.freeze({__proto__:null,assignUniqueFileNames:Og,assignUniqueLayerNames:Dg,exportFileContent:Mg,exportTargetLayers:async function(e,t,r){if(r.fit_extent){var n=e.findSingleLayer(r.fit_extent),i=mo(n.layer,n.dataset.arcs);r=Object.assign({svg_bbox:i.toArray()},r)}return async function(e,t){var r,n=Zf(e[0],t);"kml"==n||"svg"==n||"topojson"==n||"geojson"==n&&t.combine_layers?e.length>1&&(e=[ba(e)],"topojson"==n&&wo(e[0]),t=o.defaults({final:!0},t)):function(e){var t=e.reduce((function(e,t){return e.concat(t.layers)}),[]);Dg(t)}(e=e.map(No));r=e.reduce((function(e,r){return fd()?o.sortOn(r.layers,"menu_order",!0):o.sortOn(r.layers,"target_id",!0),e.concat(Mg(r,t))}),[]),t.bbox_index&&r.push(function(e){var t=[];return e.forEach((function(e){e.layers.forEach((function(r){var n=mo(r,e.arcs);t.push({bbox:n.toArray(),name:r.name})}))})),{content:JSON.stringify(t),filename:"bbox-index.json"}}(e));Og(r),t.gzip&&r.forEach((function(e){e.filename+=".gz",e.content=Ig(e.content)}));return r}(t.map((function(e){return o.defaults({layers:e.layers},e.dataset)})),r)},formatVersionedFileName:Lg});function $g(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),fd()?Ng(function(e,t){for(var r={},n=e.length-22;101010256!=tg(e,n);--n)(!n||e.length-n>65558)&&Cm(13);var i=eg(e,n+8);if(!i)return{};var o=tg(e,n+16),a=4294967295==o||65535==i;if(a){var s=tg(e,n-12);(a=101075792==tg(e,s))&&(i=tg(e,s+32),o=tg(e,s+48))}for(var l=t&&t.filter,c=0;c<i;++c){var u=bg(e,o,a),h=u[0],d=u[1],p=u[2],f=u[3],m=u[4],g=u[5],y=vg(e,g);o=m,l&&!l({name:f,size:d,originalSize:p,compression:h})||(h?8==h?r[f]=cg(e.subarray(y,y+d),{out:new Qf(p)}):Cm(14,"unknown compression type "+h):r[f]=Tm(e,y,y+d))}return r}(e,{filter:qg})):function(e){var t=new commonjsRequire("adm-zip")(e),r={};return t.getEntries().forEach((function(e){var t=hu(e.name);jg(t)&&(r[t]=e.getData())})),r}(e)}function zg(e){return fd()?function(e,t){t||(t={});var r={},n=[];fg(e,"",r,t);var i=0,o=0;for(var a in r){var s=r[a],l=s[0],c=s[1],u=0==c.level?0:8,h=(S=yg(a)).length,d=c.comment,p=d&&yg(d),f=p&&p.length,m=xg(c.extra);h>65535&&Cm(11);var g=u?lg(l,c):l,y=g.length,_=Nm();_.p(l),n.push(Um(c,{size:l.length,crc:_.d(),c:g,f:S,m:p,u:h!=a.length||p&&d.length!=f,o:i,compression:u})),i+=30+h+m+y,o+=76+2*(h+m)+(f||0)+y}for(var v=new Qf(o+22),b=i,w=o-i,x=0;x<n.length;++x){var S=n[x];Sg(v,S.o,S,S.f,S.u,S.c.length);var E=30+S.f.length+xg(S.extra);v.set(S.c,S.o+E),Sg(v,i,S,S.f,S.u,S.c.length,S.o,S.m),i+=16+E+(S.m?S.m.length:0)}return Eg(v,i,n.length,w,b),v}(Ug(e)):function(e){var t=new commonjsRequire("adm-zip")();return e.forEach((function(e){var r=e.content;r instanceof ArrayBuffer?r=new Uint8Array(r):r instanceof Buffer||r instanceof Uint8Array||(r=Buffer.from(e.content)),t.addFile(e.filename,r)})),t.toBuffer()}(e)}function Fg(e,t){Tg(Ug(e),{},t)}function qg(e){return jg(e.name)}function Ng(e){return Object.keys(e).reduce((function(t,r){var n=au(r).filename,i=e[r];return Wf(n)||(i=_g(i)),t[n]=i,t}),{})}function jg(e){var t=au(e);return Nf(e)&&!/^__MACOSX/.test(e)&&"."!=t.filename[0]}function Ug(e){var t={};return e.forEach((function(e){"string"==typeof e.content?e.content=yg(e.content):e.content instanceof ArrayBuffer&&(e.content=new Uint8Array(e.content)),t[e.filename]=e.content})),t}var Vg=Object.freeze({__proto__:null,isImportableZipPath:jg,unzipAsync:function(e,t){fd()||y("Async unzipping only supported in the browser"),e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Cg(e,{filter:qg},(function(e,r){e&&t(e),t(null,Ng(r))}))},unzipSync:$g,zipAsync:Fg,zipSync:zg});async function Gg(e,t){return Wg(e,t)}var Wg=function(e,t){if(e.length>0==!1)v("No files to save");else if(t.dry_run);else if(t.stdout)Et("rw").writeFile("/dev/stdout",e[0].content,(function(){}));else{t.zip&&(e=[{filename:t.zipfile||"output.zip",content:zg(e)}]);var r=Hg(o.pluck(e,"filename"),t),n=u("input_files");e.forEach((function(e,i){var o=r[i];e.content instanceof ArrayBuffer&&(e.content=md.convertArrayBuffer(e.content)),t.output?t.output.push({filename:o,content:e.content}):(!t.force&&n.indexOf(o)>-1&&_('Need to use the "-o force" option to overwrite input files.'),md.writeFileSync(o,e.content),v("Wrote "+o))}))}};function Hg(e,t){var r=t.directory;return r&&(e=e.map((function(e){return Et("path").join(r,e)}))),e}var Zg=Object.freeze({__proto__:null,getOutputPaths:Hg,replaceWriteFiles:function(e){Wg=e},writeFiles:Gg});function Yg(e,t){var r,n=e.arcs;(t.snap||t.auto_snap||t.snap_interval)&&(t.snap_interval&&(r=el(t.snap_interval,da(e))),n&&zr(n,r)),e.layers.forEach((function(e){Gi(e)&&Tc(e.shapes,n,e.geometry_type)}))}function Xg(e){return e[0]>-1e38&&e[1]>-1e38}function Kg(e){var t=1e4,r=new Float64Array(t),n=new Float64Array(t),i=0;this.endPath=function(){e(r,n,i),i=0},this.addPoint=function(e,a){i>=t&&(t=Math.ceil(1.3*t),r=o.extendBuffer(r,t),n=o.extendBuffer(n,t)),r[i]=e,n[i]=a,i++}}function Qg(e){var t=e.reserved_points>0?e.reserved_points:2e4,r=new Float64Array(t),n=new Float64Array(t),i=[],a=[],s=[],l=[],c=e.type||null,u=null,h=-1,d=-1,p=0,f=0,m=0;function g(e){var t=d<l.length?l[d]:null;t?t!=e&&_("Unable to import mixed-geometry features"):(l[d]=e,c?e!=c&&(c="mixed"):c=e)}function y(e){if(e>r.length){var t=Math.max(e,Math.ceil(1.5*r.length));r=o.extendBuffer(r,t,p),n=o.extendBuffer(n,t,p)}}function b(e){(i[d]||(i[d]=[])).push(e)}e.precision&&(u=ns(e.precision)),o.extend(this,new Kg((function(e,t,i){var o,a,l,d,g=0;y(p+i);for(var _=0;_<i;_++)o=e[_],a=t[_],u&&(o=u(o),a=u(a)),_>0&&o==l&&a==d?f++:(r[p]=o,n[p]=a,p++,g++),d=a,l=o;"polygon"==c&&g>0&&(e[0]==e[i-1]&&t[0]==t[i-1]||(y(p+1),r[p]=e[0],n[p]=t[0],m++,p++,g++));!function(e){h++,s[h]=e,b([h])}(g)}))),this.startShape=function(e){i[++d]=null,e&&(a[d]=e)},this.importLine=function(e){e.length<2?w("Skipping a defective line"):(g("polyline"),this.importPath(e))},this.importPoints=function(e){g("point"),e=e.filter(Xg),u&&e.forEach((function(e){e[0]=u(e[0]),e[1]=u(e[1])})),e.forEach(b)},this.importRing=function(e,t){var r=Qr.getPlanarPathArea2(e);!r||e.length<4?w("Skipping a defective ring"):(g("polygon"),(!0===t&&r>0||!1===t&&r<0)&&e.reverse(),this.importPath(e))},this.importPath=function(e){for(var t,r=0,n=e.length;r<n;r++)t=e[r],this.addPoint(t[0],t[1]);this.endPath()},this.done=function(){var e,t,u={name:""};return f>0&&w(o.format("Removed %,d duplicate point%s",f,o.pluralSuffix(f))),m>0&&v(o.format("Closed %,d open polygon ring%s",m,o.pluralSuffix(m))),p>0&&(p<r.length&&(r=r.subarray(0,p),n=n.subarray(0,p)),e=new Oo(s,r,n)),"mixed"==c?t=ao(i,a,l):(u={geometry_type:c},c&&(u.shapes=i),a.length>0&&(u.data=new Fi(a)),t=[u]),t.forEach((function(e){e.data&&Ai(e.data.getRecords())})),{arcs:e||null,info:{},layers:t}}}var Jg=Object.freeze({__proto__:null,PathImporter:Qg,cleanPathsAfterImport:Yg,pointHasValidCoords:Xg});function ey(e,t,r){var n=new Yd(e,t),i=n.type(),a=Wd(i),s=new Qg(o.defaults({type:a,reserved_points:Math.round(n.header().byteLength/16)},r));return Hd(i)||_("Unsupported Shapefile type:",i),Rd.isZType(i)?w("Warning: Shapefile Z data will be lost."):Rd.isMType(i)&&w("Warning: Shapefile M data will be lost."),n.forEachShape((function(e){s.startShape(),e.isNull||("point"==a?s.importPoints(e.readPoints()):e.stream(s))})),s.done()}var ty=Object.freeze({__proto__:null,importShp:ey});function ry(e,t){var r,n,i=t||{},a=Object.keys(yl.pathImporters),s=o.isString(e)?JSON.parse(e):e,l=new ny(i);return((r="Feature"==s.type?{type:"FeatureCollection",features:[s]}:a.includes(s.type)?{type:"GeometryCollection",geometries:[s]}:s).features||r.geometries||[]).forEach(l.parseObject),oy(n=l.done(),s),n}function ny(e){var t=e.id_field||yl.ID_FIELD,r=new Qg(e);this.parseObject=function(n){var i,o;n&&n.type?"Feature"==n.type?(i=n.geometry,o=n.properties||{},"id"in n&&(o[t]=n.id)):i=n:i=null,i&&"GeometryCollection"==i.type?yl.importComplexFeature(r,i,o,e):e.single_part&&function(e){return e&&e.type&&0===e.type.indexOf("Multi")}(i)?yl.importMultiAsSingles(r,i,o,e):yl.importSimpleFeature(r,i,o,e)},this.done=function(){return r.done()}}function iy(e,t){return t=t||{},e.forEach((function(e){if(e){var r=yl.translateGeoJSONType(e.type);r?(r in t==!1&&(t[r]=[]),t[r].push(e)):"GeometryCollection"==e.type&&iy(e.geometries||[],t)}})),Object.values(t)}function oy(e,t){"crs"in t&&(e.info.input_geojson_crs=t.crs)}yl.importComplexFeature=function(e,t,r,n){var i=iy(t.geometries||[]);0!==i.length?i.forEach((function(t,i){e.startShape(Ei(r)),t.forEach((function(t){yl.importSimpleGeometry(e,t,n)}))})):e.startShape(r)},yl.importSimpleFeature=function(e,t,r,n){e.startShape(r),yl.importSimpleGeometry(e,t,n)},yl.importMultiAsSingles=function(e,t,r,n){t.coordinates.forEach((function(i,o){var a={type:t.type.substr(5),coordinates:i},s=0===o?r:Ei(r);yl.importSimpleFeature(e,a,s,n)}))},yl.importSimpleGeometry=function(e,t,r){var n=t?t.type:null;if(null===n);else if(n in yl.pathImporters){if(r.geometry_type&&r.geometry_type!=yl.translateGeoJSONType(n))return;yl.pathImporters[n](t.coordinates,e)}else w("Unsupported geometry type:",t.type)},yl.pathImporters={LineString:function(e,t){t.importLine(e)},MultiLineString:function(e,t){for(var r=0;r<e.length;r++)yl.pathImporters.LineString(e[r],t)},Polygon:function(e,t){for(var r=0;r<e.length;r++)t.importRing(e[r],r>0)},MultiPolygon:function(e,t){for(var r=0;r<e.length;r++)yl.pathImporters.Polygon(e[r],t)},Point:function(e,t){t.importPoints([e])},MultiPoint:function(e,t){t.importPoints(e)}};var ay=Object.freeze({__proto__:null,GeoJSONParser:ny,importCRS:oy,importGeoJSON:ry});function sy(e,t){var r,n,i;return o.isString(e)&&(e=JSON.parse(e)),e.arcs&&e.arcs.length>0&&(e.transform&&function(e,t){var r=t.scale[0],n=t.scale[1],i=t.translate[0],o=t.translate[1];e.forEach((function(e){for(var t,a,s,l=0,c=0,u=0,h=e.length;u<h;u++)a=(t=e[u])[0]+l,s=t[1]+c,t[0]=a*r+i,t[1]=s*n+o,l=a,c=s}))}(e.arcs,e.transform),t&&t.precision&&function(e,t){var r,n=ns(t);e.forEach((function(e){for(var t=0,i=e.length;t<i;t++)(r=e[t])[0]=n(r[0]),r[1]=n(r[1])}))}(e.arcs,t.precision),n=new Oo(e.arcs)),(i=Object.keys(e.objects).reduce((function(r,i){for(var o,a=Dd.importObject(e.objects[i],n,t),s=0,l=a.length;s<l;s++)(o=a[s]).name=i,r.push(o);return r}),[])).forEach((function(t){var r,i;Gi(t)&&Tc(t.shapes,n,t.geometry_type),"point"==t.geometry_type&&e.transform&&(r=t.shapes,i=e.transform,ln(r,(function(e){e[0]=e[0]*i.scale[0]+i.translate[0],e[1]=e[1]*i.scale[1]+i.translate[1]}))),t.data&&Ai(t.data.getRecords())})),oy(r={layers:i,arcs:n,info:{}},e),e.metadata&&function(e,t){t.proj4&&ua(e,la(t.proj4))}(r,e.metadata),r}Dd.importObject=function(e,t,r){var n=new Dd.GeometryImporter(t,r);return("GeometryCollection"==e.type?e.geometries:[e]).forEach(n.addGeometryObject,n),n.done()},Dd.GeometryImporter=function(e,t){var r,n=t&&t.id_field||yl.ID_FIELD,i=[],o=[],a=[],s=0,l=null;this.addGeometryObject=function(e){var t=e.properties||null;r=o.length,o[r]=null,"id"in e&&((t=t||{})[n]=e.id),i[r]=t,t||s++,e.type&&this.addShape(e)},this.addShape=function(t){var n,i=o[r],a=yl.translateGeoJSONType(t.type);"GeometryCollection"==t.type?t.geometries.forEach(this.addShape,this):a?(this.setGeometryType(a),(n=Dd.shapeImporters[t.type](t,e))&&n.length&&(Array.isArray(n[0])?o[r]=i?i.concat(n):n:_("Invalid TopoJSON",t.type,"geometry"))):t.type&&_("Invalid TopoJSON geometry type:",t.type)},this.setGeometryType=function(e){var t=r<a.length?a[r]:null;t?t!=e&&_("Unable to import mixed-type TopoJSON geometries"):(a[r]=e,this.updateCollectionType(e))},this.updateCollectionType=function(e){l?e&&l!=e&&(l="mixed"):l=e},this.done=function(){return"mixed"==l?ao(o,i,a):[{geometry_type:l,shapes:l?o:null,data:s<o.length?new Fi(i):null}]}},Dd.importPolygonArcs=function(e,t){var r,n=e[0],i=null;if(t||_("Invalid TopoJSON file: missing arc data."),!(r=n?Qr.getPlanarPathArea(n,t):null))return null;r<0&&pr(n),i=[n];for(var o=1;o<e.length;o++)n=e[o],(r=Qr.getPlanarPathArea(n,t))&&(r>0&&pr(n),i.push(n));return i},Dd.shapeImporters={Point:function(e){return[e.coordinates]},MultiPoint:function(e){return e.coordinates},LineString:function(e){return[e.arcs]},MultiLineString:function(e){return e.arcs},Polygon:function(e,t){return Dd.importPolygonArcs(e.arcs,t)},MultiPolygon:function(e,t){return e.arcs.reduce((function(e,r){var n=Dd.importPolygonArcs(r,t);return n&&(e=e?e.concat(n):n),e}),null)}};var ly=Object.freeze({__proto__:null,importTopoJSON:sy});function cy(e,t){var r=null;return e.length>1e3&&(e=e.substr(0,1e3)),e=e.replace(/\s/g,""),t&&t.json_path||/^\[[{\]]/.test(e)?r="json":/"arcs":\[|"objects":\{|"transform":\{/.test(e)?r="topojson":/^\{"/.test(e)&&(r="geojson"),r}function uy(e){var t=null;return e&&("Topology"==e.type?t="topojson":e.type?t="geojson":o.isArray(e)&&(t="json")),t}function hy(e,t){var r=new ny(t);return np(e,r.parseObject),r.done()}function dy(e,t){var r,n,i=e.content,a=e.filename,s={filename:a};if(i?(i instanceof ArrayBuffer||i instanceof l||i instanceof Uint8Array)&&((i.byteLength||i.length)<1e7?i=_i(o.createBuffer(i)):(r=new _d(i),i=null)):r=new vd(a),r&&(e=function(e,t){var r;return r="geojson"==cy(gd(e,1e3),t)?{dataset:hy(e,t),format:"geojson"}:{content:e.toString("utf8")},e.close(),r}(r,t),e.dataset?(s.dataset=e.dataset,s.format=e.format):i=e.content),i){if(o.isString(i))try{i=JSON.parse(i)}catch(qw){_("JSON parsing error:",qw.message)}t.json_path?(n=uy(i=function(e,t){var r,n,i,o=/(.*)\[([0-9]+)\]$/,a=t.indexOf("/")>0?"/":".",s=t.split(a);for(;s.length>0;)if(r=s.shift(),!(e=(i=o.exec(r))?(n=e[i[1]])&&n[+i[2]]||null:e[r]))return null;return e}(i,t.json_path)))||_("Unexpected object type at JSON path:",t.json_path):n=uy(i),"topojson"==n?s.dataset=sy(i,t):"geojson"==n?s.dataset=ry(i,t):"json"==n?s.dataset=Pf(i):_("Unknown JSON format"),s.format=n}return s}var py=Object.freeze({__proto__:null,identifyJSONObject:uy,identifyJSONString:cy,importGeoJSONFile:hy,importJSON:dy});function fy(e,t){return Array.from(e.getElementsByTagName(t))}function my(e){return"#"===e[0]?e:`#${e}`}function gy(e){return e?.normalize(),e?.textContent||""}function yy(e,t,r){const n=e.getElementsByTagName(t);return n.length?n[0]:null}function _y(e,t,r){const n={};if(!e)return n;const i=e.getElementsByTagName(t),o=i.length?i[0]:null;return o&&r?r(o,n):n}function vy(e,t,r){const n=gy(yy(e,t));return n&&r&&r(n)||{}}function by(e,t,r){const n=Number.parseFloat(gy(yy(e,t)));if(!Number.isNaN(n))return r&&r(n),n}function wy(e,t){const r={};for(const n of t)vy(e,n,(e=>{r[n]=e}));return r}function xy(e){return 1===e?.nodeType}function Sy(e,t){const r={},n="stroke"===t||"fill"===t?t:`${t}-color`;return"#"===e[0]&&(e=e.substring(1)),6===e.length||3===e.length?r[n]=`#${e}`:8===e.length&&(r[`${t}-opacity`]=Number.parseInt(e.substring(0,2),16)/255,r[n]=`#${e.substring(6,8)}${e.substring(4,6)}${e.substring(2,4)}`),r}function Ey(e,t,r){const n={};return by(e,t,(e=>{n[r]=e})),n}function Ty(e,t){return _y(e,"color",(e=>Sy(gy(e),t)))}function Ay(e){return _y(e,"Icon",((e,t)=>(vy(e,"href",(e=>{t.icon=e})),t)))}function Cy(e){return Object.assign({},function(e){return _y(e,"PolyStyle",((e,t)=>Object.assign(t,_y(e,"color",(e=>Sy(gy(e),"fill"))),vy(e,"fill",(e=>{if("0"===e)return{"fill-opacity":0}})),vy(e,"outline",(e=>{if("0"===e)return{"stroke-opacity":0}})))))}(e),function(e){return _y(e,"LineStyle",(e=>Object.assign(Ty(e,"stroke"),Ey(e,"width","stroke-width"))))}(e),function(e){return _y(e,"LabelStyle",(e=>Object.assign(Ty(e,"label"),Ey(e,"scale","label-scale"))))}(e),function(e){return _y(e,"IconStyle",(e=>Object.assign(Ty(e,"icon"),Ey(e,"scale","icon-scale"),Ey(e,"heading","icon-heading"),_y(e,"hotSpot",(e=>{const t=Number.parseFloat(e.getAttribute("x")||""),r=Number.parseFloat(e.getAttribute("y")||""),n=e.getAttribute("xunits")||"",i=e.getAttribute("yunits")||"";return Number.isNaN(t)||Number.isNaN(r)?{}:{"icon-offset":[t,r],"icon-offset-units":[n,i]}})),Ay(e))))}(e))}const Iy=/\s*/g,ky=/^\s*|\s*$/g,Py=/\s+/;function My(e){return e.replace(Iy,"").split(",").map(Number.parseFloat).filter((e=>!Number.isNaN(e))).slice(0,3)}function Ry(e){return e.replace(ky,"").split(Py).map(My).filter((e=>e.length>=2))}function Dy(e){let t=fy(e,"coord");var r,n,i;0===t.length&&(r=e,n="coord",i="*",t=Array.from(r.getElementsByTagNameNS(i,n)));const o=t.map((e=>gy(e).split(" ").map(Number.parseFloat)));return 0===o.length?null:{geometry:o.length>2?{type:"LineString",coordinates:o}:{type:"Point",coordinates:o[0]},times:fy(e,"when").map((e=>gy(e)))}}function Oy(e){if(0===e.length)return e;const t=e[0],r=e[e.length-1];let n=!0;for(let i=0;i<Math.max(t.length,r.length);i++)if(t[i]!==r[i]){n=!1;break}return n?e:e.concat([e[0]])}function Ly(e){return gy(yy(e,"coordinates"))}function By(e){let t=[],r=[];for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes.item(n);if(xy(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const e=By(i);t=t.concat(e.geometries),r=r.concat(e.coordTimes);break}case"Point":{const e=My(Ly(i));e.length>=2&&t.push({type:"Point",coordinates:e});break}case"LinearRing":case"LineString":{const e=Ry(Ly(i));e.length>=2&&t.push({type:"LineString",coordinates:e});break}case"Polygon":{const e=[];for(const t of fy(i,"LinearRing")){const r=Oy(Ry(Ly(t)));r.length>=4&&e.push(r)}e.length&&t.push({type:"Polygon",coordinates:e});break}case"Track":case"gx:Track":{const e=Dy(i);if(!e)break;const{times:n,geometry:o}=e;t.push(o),n.length&&r.push(n);break}}}return{geometries:t,coordTimes:r}}const $y=e=>Number(e),zy={string:e=>e,int:$y,uint:$y,short:$y,ushort:$y,float:$y,double:$y,bool:e=>Boolean(e)};function Fy(e,t){return _y(e,"ExtendedData",((e,r)=>{for(const t of fy(e,"Data"))r[t.getAttribute("name")||""]=gy(yy(t,"value"));for(const n of fy(e,"SimpleData")){const e=n.getAttribute("name")||"",i=t[e]||zy.string;r[e]=i(gy(n))}return r}))}function qy(e){const t=yy(e,"description");for(const r of Array.from(t?.childNodes||[]))if(4===r.nodeType)return{description:{"@type":"html",value:gy(r)}};return{}}function Ny(e){return _y(e,"TimeSpan",(e=>({timespan:{begin:gy(yy(e,"begin")),end:gy(yy(e,"end"))}})))}function jy(e){return _y(e,"TimeStamp",(e=>({timestamp:gy(yy(e,"when"))})))}function Uy(e,t){return vy(e,"styleUrl",(e=>(e=my(e),t[e]?Object.assign({styleUrl:e},t[e]):{styleUrl:e})))}var Vy,Gy;function Wy(e){if(yy(e,"gx:LatLonQuad")){return{geometry:{type:"Polygon",coordinates:[Oy(Ry(Ly(e)))]}}}return function(e){const t=yy(e,"LatLonBox");if(t){const e=by(t,"north"),r=by(t,"west"),n=by(t,"east"),i=by(t,"south"),o=by(t,"rotation");if("number"==typeof e&&"number"==typeof i&&"number"==typeof r&&"number"==typeof n){const t=[r,i,n,e];let a=[[[r,e],[n,e],[n,i],[r,i],[r,e]]];return"number"==typeof o&&(a=function(e,t,r){const n=[(e[0]+e[2])/2,(e[1]+e[3])/2];return[t[0].map((e=>{const t=e[1]-n[1],i=e[0]-n[0],o=Math.sqrt(t**2+i**2),a=Math.atan2(t,i)+r*Hy;return[n[0]+Math.cos(a)*o,n[1]+Math.sin(a)*o]}))]}(t,a,o)),{bbox:t,geometry:{type:"Polygon",coordinates:a}}}}return null}(e)}(Gy=Vy||(Vy={})).ABSOLUTE="absolute",Gy.RELATIVE_TO_GROUND="relativeToGround",Gy.CLAMP_TO_GROUND="clampToGround",Gy.CLAMP_TO_SEAFLOOR="clampToSeaFloor",Gy.RELATIVE_TO_SEAFLOOR="relativeToSeaFloor";const Hy=Math.PI/180;function Zy(e,t,r,n){const i=Wy(e),o=i?.geometry||null;if(!o&&n.skipNullGeometry)return null;const a={type:"Feature",geometry:o,properties:Object.assign({"@geometry-type":"groundoverlay"},wy(e,["name","address","visibility","open","phoneNumber","description"]),qy(e),Uy(e,t),Cy(e),Ay(e),Fy(e,r),Ny(e),jy(e))};i?.bbox&&(a.bbox=i.bbox),void 0!==a.properties?.visibility&&(a.properties.visibility="0"!==a.properties.visibility);const s=e.getAttribute("id");return null!==s&&""!==s&&(a.id=s),a}function Yy(e){const t=yy(e,"Lod");return t?[by(t,"minLodPixels")??-1,by(t,"maxLodPixels")??-1,by(t,"minFadeExtent")??null,by(t,"maxFadeExtent")??null]:null}function Xy(e){const t=yy(e,"LatLonAltBox");if(t){const e=by(t,"north"),r=by(t,"west"),n=by(t,"east"),i=by(t,"south");(function(e){switch(e?.textContent){case Vy.ABSOLUTE:return Vy.ABSOLUTE;case Vy.CLAMP_TO_GROUND:return Vy.CLAMP_TO_GROUND;case Vy.CLAMP_TO_SEAFLOOR:return Vy.CLAMP_TO_SEAFLOOR;case Vy.RELATIVE_TO_GROUND:return Vy.RELATIVE_TO_GROUND;case Vy.RELATIVE_TO_SEAFLOOR:return Vy.RELATIVE_TO_SEAFLOOR}})(yy(t,"altitudeMode")||yy(t,"gx:altitudeMode"));if("number"==typeof e&&"number"==typeof i&&"number"==typeof r&&"number"==typeof n){return{bbox:[r,i,n,e],geometry:{type:"Polygon",coordinates:[[[r,e],[n,e],[n,i],[r,i],[r,e]]]}}}}return null}function Ky(e){const t=yy(e,"Link");return t?wy(t,["href","refreshMode","refreshInterval","viewRefreshMode","viewRefreshTime","viewBoundScale","viewFormat","httpQuery"]):{}}function Qy(e,t,r,n){const i=function(e){const t=yy(e,"Region");return t?{coordinateBox:Xy(t),lod:Yy(e)}:null}(e),o=i?.coordinateBox?.geometry||null;if(!o&&n.skipNullGeometry)return null;const a={type:"Feature",geometry:o,properties:Object.assign({"@geometry-type":"networklink"},wy(e,["name","address","visibility","open","phoneNumber","styleUrl","refreshVisibility","flyToView","description"]),qy(e),Uy(e,t),Cy(e),Ay(e),Fy(e,r),Ny(e),jy(e),Ky(e),i?.lod?{lod:i.lod}:{})};i?.coordinateBox?.bbox&&(a.bbox=i.coordinateBox.bbox),void 0!==a.properties?.visibility&&(a.properties.visibility="0"!==a.properties.visibility);const s=e.getAttribute("id");return null!==s&&""!==s&&(a.id=s),a}function Jy(e,t,r,n){const{coordTimes:i,geometries:o}=By(e),a=function(e){return 0===e.length?null:1===e.length?e[0]:{type:"GeometryCollection",geometries:e}}(o);if(!a&&n.skipNullGeometry)return null;const s={type:"Feature",geometry:a,properties:Object.assign(wy(e,["name","address","visibility","open","phoneNumber","description"]),qy(e),Uy(e,t),Cy(e),Fy(e,r),Ny(e),jy(e),i.length?{coordinateProperties:{times:1===i.length?i[0]:i}}:{})};void 0!==s.properties?.visibility&&(s.properties.visibility="0"!==s.properties.visibility);const l=e.getAttribute("id");return null!==l&&""!==l&&(s.id=l),s}function e_(e){let t=e.getAttribute("id");const r=e.parentNode;return!t&&xy(r)&&"CascadingStyle"===r.localName&&(t=r.getAttribute("kml:id")||r.getAttribute("id")),my(t||"")}function*t_(e,t={skipNullGeometry:!1}){const r=e,n=function(e){const t={};for(const r of fy(e,"Style"))t[e_(r)]=Cy(r);for(const r of fy(e,"StyleMap")){const e=my(r.getAttribute("id")||"");vy(r,"styleUrl",(r=>{r=my(r),t[r]&&(t[e]=t[r])}))}return t}(r),i=function(e){const t={};for(const r of fy(e,"SimpleField"))t[r.getAttribute("name")||""]=zy[r.getAttribute("type")||""]||zy.string;return t}(r);for(const o of fy(r,"Placemark")){const e=Jy(o,n,i,t);e&&(yield e)}for(const o of fy(r,"GroundOverlay")){const e=Zy(o,n,i,t);e&&(yield e)}for(const o of fy(r,"NetworkLink")){const e=Qy(o,n,i,t);e&&(yield e)}}function r_(e,t){return ry(function(e,t={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(t_(e,t))}}((new("undefined"==typeof DOMParser?Et("@xmldom/xmldom").DOMParser:DOMParser)).parseFromString(e,"text/xml")),t||{})}function n_(e,t){var r,n,i;return t=t||{},e.json?(n=(i=dy(e.json,t)).format,Yg(r=i.dataset,t)):e.text?(n="dsv",r=ff(i=e.text,t)):e.shp?(n="shapefile",i=e.shp,r=function(e,t){var r,n=e.shp.content||e.shp.filename,i=e.shx?e.shx.content||e.shx.filename:null,a=ey(n,i,t),s=a.layers[0];e.dbf&&(r=i_(e,t),o.extend(a.info,r.info),s.data=r.layers[0].data,s.shapes&&s.data.size()!=s.shapes.length&&v("Mismatched .dbf and .shp record count -- possible data loss."));e.prj&&(a.info.prj=e.prj.content);e.cpg&&(a.info.cpg=e.cpg.content,"string"!=typeof a.info.cpg&&y("Invalid encoding argument, expected a string"));return a}(e,t),Yg(r,t)):e.dbf?(n="dbf",i=e.dbf,r=i_(e,t)):e.prj?(n="prj",r={layers:[],info:{prj:(i=e.prj).content}}):e.kml&&(n="kml",r=r_((i=e.kml).content,t)),r||_("Missing an expected input type"),r.arcs&&!t.no_topology&&"topojson"!=n&&wo(r),"topojson"!=n&&r.layers.forEach((function(e){e.name||(e.name=function(e){var t="layer1",r=au(e);r.basename&&r.extension&&(t=r.basename);return t}(i.filename||""))})),i.filename&&(r.info.input_files=[i.filename]),r.info.input_formats=[n],r}function i_(e,t){return t=o.extend({},t),e.cpg&&!t.encoding&&(t.encoding=e.cpg.content),{info:{},layers:[{data:Up(e.dbf.content||e.dbf.filename,t)}]}}var o_=Object.freeze({__proto__:null,importContent:n_,importFileContent:function(e,t,r){var n={};return n[$f(t,e)]={filename:t,content:e},n_(n,r)}});function a_(e,t){var r;e in t?r=t[e]:(r=e,md.checkFileExists(e));var n=$g(r);return Object.assign(t,n),function(e){return Object.keys(e).filter((function(t){var r=Of(t);return("dbf"!=r||!(uu(t,"shp")in e))&&(r&&!Lf(r))}))}(n)}function s_(e,t){return l_(e,t)}a.importFiles=async function(e,t){var r,n=t.files||[];return t.stdin?(r=s_("/dev/stdin",t),e.addDataset(r),r):(n.length>0==!1&&_("Missing input file(s)"),w("Importing: "+n.join(" ")),(t=Object.assign({},t)).input=Object.assign({},t.input),function(e,t){var r=e.map((e=>zf(e)?"layer.json":null)).filter(Boolean);if(0===r.length)return;r.length>1&&(r=o.uniqifyNames(r,Lg));e.forEach(((n,i)=>{if(zf(n)){var o=r.shift();t[o]=n,e[i]=o}}))}(n,t.input),0===(n=function(e,t){var r=[];return e.forEach((function(e){var n;n=jf(e)?a_(e,t):Uf(e)?function(e,t){var r=a_(e,t),n=uu(au(e).filename,"kml");"doc.kml"==r[0]&&(r[0]=n,t[n]=t["doc.kml"]);return r}(e,t):[e],r=r.concat(n)})),r}(n,t.input)).length&&_("Missing importable files"),r=1==n.length?s_(n[0],t):c_(n,t),t.merge_files&&n.length>1&&(r.layers=a.mergeLayers(r.layers)),e.addDataset(r),r)};var l_=function(e,t){var r,n=Of(e),i={},a=t&&t.encoding||null,s=t&&t.input||null,l=s&&e in s;if(md.checkFileExists(e,s),"shp"!=n&&"json"!=n&&"text"!=n&&"dbf"!=n||l)if(n&&Gf(e))r=md.readFile(e,null,s),o.isString(r)&&_("Expected binary content, received a string");else if(n)r=md.readFile(e,a||"utf-8",s);else if("gz"==lu(e)){var c=e;(n=Of(e=c.replace(/\.gz$/,"")))||_("Unrecognized file type:",e),r=kg(md.readFile(c,null,s),e)}else"text"==(n=Bf(r=md.readFile(e,a||"utf-8",s)))&&r.indexOf("")>-1&&(n=null);else r=null;return n||_(function(e){var t=lu(e),r="Unable to import "+e;"zip"==t.toLowerCase()?r+=" (ZIP files must be unpacked before running mapshaper)":r+=" (unknown file type)";return r}(e)),i[n]={filename:e,content:r},r=null,"shp"!=n&&"dbf"!=n||function(e,t,r){var n=uu(e,"dbf"),i=uu(e,"shx"),o=uu(e,"cpg"),a=uu(e,"prj");md.isFile(a,r)&&(t.prj={filename:a,content:md.readFile(a,"utf-8",r)});md.isFile(i,r)&&(t.shx={filename:i,content:md.readFile(i,null,r)});!t.dbf&&md.isFile(n,r)&&(t.dbf={filename:n,content:r&&n in r?md.readFile(n,null,r):null});t.dbf&&md.isFile(o,r)&&(t.cpg={filename:o,content:md.readFile(o,"utf-8",r).trim()})}(e,i,s),"shp"!=n||i.dbf||v(o.format("[%s] .dbf file is missing - shapes imported without attribute data.",e)),n_(i,t)};function c_(e,t){var r=!1,n=wa(e.map((function(e){var n=s_(e,o.defaults({no_topology:!0,snap:!1,snap_interval:null,files:[e]},t));return n.arcs&&n.arcs.size()>0&&"topojson"!=n.info.input_formats[0]&&(r=!0),n})));return r&&!t.no_topology&&(Yg(n,t),wo(n)),n}var u_=Object.freeze({__proto__:null,importFile:s_,importFilesTogether:c_,replaceImportFile:function(e){l_=e}});function h_(e,t,r){var n=new St(e),i="point"==t.geometry_type?function(e){return function(t){return e.containsPoint(t[0],t[1])?t:null}}(n):function(e,t){var r=e.toArray(),n=r[0],i=r[1],o=r[2],a=r[3];return function(r){if(!e.intersects(t.getSimpleShapeBounds(r)))return null;var s,l,c,u,h=!1,d=t.getShapeIter(r);for(d.hasNext()&&(s=d.x,l=d.y);d.hasNext();)if(c=s,u=l,!Dp(s=d.x,l=d.y,c,u,n,i,o,a)){if(Op(s,l,c,u,n,i,o,a)){h=!0;break}if(Qr.segmentIntersection(n,a,o,a,s,l,c,u)||Qr.segmentIntersection(n,i,o,i,s,l,c,u)||Qr.segmentIntersection(n,i,n,a,s,l,c,u)||Qr.segmentIntersection(o,i,o,a,s,l,c,u)){h=!0;break}}return!h&&Qr.testPointInRing(n,i,r,t)&&(h=!0),h?r:null}}(n,r);return i}function d_(e,t,r){var n=h_(e,t,r);return function(e){var r=t.shapes[e];if(!r)return!1;for(var i=0;i<r.length;i++)if(n(r[i]))return!0;return!1}}a.filterGeom=function(e,t,r){Vi(e)||_("Layer is missing geometry"),r.bbox&&function(e,t,r){var n=h_(r.bbox,e,t);pn(e.shapes,n)}(e,t,r),a.filterFeatures(e,t,{remove_empty:!0,verbose:!1})};var p_=Object.freeze({__proto__:null,findShapesIntersectingBBox:function(e,t,r){for(var n=d_(e,t,r),i=[],o=0;o<t.shapes.length;o++)n(o)&&i.push(o);return i},getBBoxIntersectionTest:d_});function f_(e){ma(e)||y("Expected an unprojected CRS");var t=e.es/(1+Math.sqrt(e.one_es));return new Pt.internal.GeographicLib.Geodesic.Geodesic(e.a,t)}function m_(e,t,r,n,i){var o=1-i;return[e*o+r*i,t*o+n*i]}function g_(e,t,r,n){var i=r/180*Math.PI;return[e+Math.sin(i)*n,t+Math.cos(i)*n]}function y_(e,t,r,n){var i=Math.PI/180,o=Math.cos(t*i),a=2*o*o-1,s=2*o*a-o,l=2*o*s-a,c=1e3*(111.41513*o-.09455*s+12e-5*(2*o*l-s)),u=1e3*(111.13209-.56605*a+.0012*l),h=r*i,d=t+Math.cos(h)*n/u;return[e+Math.sin(h)*n/c,d]}function __(e){if(!ma(e))return g_;var t=f_(e);return function(e,r,n,i){var o=t.Direct(r,e,n,i);return[o.lon2,o.lat2]}}function v_(e,t,r,n){return 180*Qr.bearing(e,t,r,n)/Math.PI}function b_(e,t,r,n){return 180*Qr.bearing2D(e,t,r,n)/Math.PI}var w_=Object.freeze({__proto__:null,bearingDegrees:v_,bearingDegrees2D:b_,getBearingFunction:function(e){return ma(da(e))?v_:b_},getFastGeodeticSegmentFunction:function(e){return ma(e)?y_:g_},getGeodeticSegmentFunction:__,getInterpolationFunction:function(e){if(!(e&&ma(e)))return m_;var t=f_(e);return function(e,r,n,i,o){var a=t.Inverse(r,e,i,n),s=a.s12*o,l=t.Direct(r,e,a.azi1,s);return[l.lon2,l.lat2]}},getPlanarSegmentEndpoint:g_,interpolatePoint2D:m_});function x_(e,t){var r=Ki(e),n={layer_name:e.name,geometry_type:e.geometry_type,feature_count:r,null_shape_count:0,null_data_count:e.data?C_(e.data.getRecords()):r};return e.shapes&&e.shapes.length>0&&(n.null_shape_count=function(e){for(var t=0,r=0;r<e.length;r++)e[r]&&0!==e[r].length||t++;return t}(e.shapes),n.bbox=mo(e,t.arcs).toArray(),n.proj4=ta(t)),n.source_file=oo(0,t)||null,n.attribute_data=S_(e),n}function S_(e,t){if(!e.data||0===e.data.size()||0===e.data.getFields().length)return null;var r=Di(e.data.getFields(),"ascending"),n=void 0===t?"first_value":"value";return r.map((function(r){return{field:r,[n]:e.data.getReadOnlyRecordAt(t||0)[r]}}))}function E_(e){if(!e)return"Attribute data: [none]\n";var t="first_value"in e[0]?"first_value":"value",r=[],n=[];e.forEach((function(e){n.push(e.field),r.push(e[t])}));var i=r.reduce((function(e,t){return o.isNumber(t)&&(e=Math.max(e,k_(t))),e}),0),a=["Field"].concat(n),s=r.reduce((function(e,t){return e.push(P_(t,i)),e}),["first_value"==t?"First value":"Value"]),l=I_(a),c=I_(s),u=(o.rpad("",l+2,"-")+"+"+o.rpad("",c+2,"-")).substr(0,50)+"\n",h="";return a.forEach((function(e,t){var r=T_(e);h+=" "+e+o.rpad("",l-r," ")+" | "+s[t]+"\n",0===t&&(h+=u)})),"\nAttribute data\n"+u+h+u}function T_(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=A_(e.charCodeAt(r));return t}function A_(e){return e>=4352&&(e<=4447||9001==e||9002==e||e>=11904&&e<=42191&&12351!=e||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65135||e>=65280&&e<=65376||e>=65504&&e<=65510||e>=131072&&e<=196605||e>=196608&&e<=262141)?2:1}function C_(e){for(var t=0,r=0;r<e.length;r++)e[r]||t++;return t}function I_(e){return e.reduce((function(e,t){var r=T_(t);return r>e?r:e}),0)}function k_(e){return o.isNumber(e)?(o.formatNumber(e)+".").indexOf("."):0}function P_(e,t){var r;return"string"!=typeof(r=o.isNumber(e)?o.lpad("",t-k_(e)," ")+o.formatNumber(e):o.isString(e)?function(e){var t={"\n":"\\n","\r":"\\r","\t":"\\t"};return"'"+(e=e.replace(/[\r\t\n]/g,(function(e){return e in t?t[e]:""})))+"'"}(e):o.isDate(e)?o.formatDateISO(e)+" (Date)":o.isObject(e)?JSON.stringify(e):String(e))&&(r="["+typeof e+"]"),r}a.info=function(e,t){var r=As(e).map((function(e){return x_(e.layer,e.dataset)}));t.save_to&&Gg([{filename:t.save_to+(t.save_to.endsWith(".json")?"":".json"),content:JSON.stringify(r,null,2)}],t);if(t.to_layer)return{info:{},layers:[{name:t.name||"info",data:new Fi(r)}]};v(function(e){var t="";return e.forEach((function(e,r){var n="Layer:    "+(e.layer_name||"[unnamed layer]"),i=E_(e.attribute_data),a=function(e){return Math.max.apply(null,e.split("\n").map((function(e){return T_(e)})))}(i),s=Math.min(Math.max(n.length,a),50);t+="\n",t+=o.lpad("",s,"=")+"\n",t+=n+"\n",t+=o.lpad("",s,"-")+"\n",t+=function(e){var t="";t+="Type:     "+(e.geometry_type||"tabular data")+"\n",t+=o.format("Records:  %,d\n",e.feature_count),e.null_shape_count>0&&(t+=o.format("Nulls:     %'d",e.null_shape_count)+"\n");e.geometry_type&&e.feature_count>e.null_shape_count&&(t+="Bounds:   "+e.bbox.join(",")+"\n",t+="CRS:      "+e.proj4+"\n");return t+="Source:   "+(e.source_file||"n/a")+"\n",t}(e),t+=i})),t}(r))},a.printInfo=a.info;var M_=Object.freeze({__proto__:null,formatAttributeTableInfo:E_,formatTableValue:P_,getAttributeTableInfo:S_,getLayerInfo:x_});function R_(e,t){var r=function(e,t){var r,n,i,o={isMax:function(e){return e===n.max},isMin:function(e){return e===n.min},isMode:function(e){return n.modes.indexOf(e)>-1}};return Object.defineProperty(o,"target",{get:function(){return i},enumerable:!0}),r=Ns(e,{data:t},null,{context:o}),function(e,t,o){return n=o,i=t,r(e)}}(t,e),n=null;return function(e){return o.some(["isMax","isMin","isMode"],(function(t){return e.indexOf(t)>-1}))}(t)&&(n=function(e,t){var r,n,i,o;function a(){n=-1/0,i=1/0,r=null}return o=Ns(e,{data:t},null,{context:{isMax:function(e){e>n&&(n=e)},isMin:function(e){e<i&&(i=e)},isMode:function(e){r||(r=[]),r.push(e)}},no_return:!0}),function(e){var t;a();for(var s=0;s<e.length;s++)o(e[s]);return t=r?nc(r):null,{max:n,min:i,modes:t?t.modes:null,margin:t?t.margin:null}}}(t,e)),function(e,t){var i,o,a=n?n(e):null,s=[];for(o=0;o<e.length;o++)fs(i=r(e[o],t,a),'"where" expression must return true or false'),!0===i&&s.push(e[o]);return s}}var D_=Object.freeze({__proto__:null,getJoinFilter:R_});function O_(e,t,r,n){var i=e.data;t==i&&(t=t.clone());var a,s,l,c,u,h,d,p,f,m,g,y,b,w=!!n.duplication,x=t.getRecords(),S=i.getRecords(),E=n.prefix||"",T=[],A=q_(i.getFields(),t.getFields(),n),C=n.sum_fields||[],I=o.difference(A,C),k=new Uint32Array(x.length),P=0,M=0,R=[],D=0,O={};for(w&&(n.calc&&_("duplication and calc options cannot be used together"),y=i.clone().getRecords(),b=e.shapes||[]),n.where&&(h=R_(t,n.where)),n.calc&&(d=cc(t,n.calc)),m=S.length,p=0;p<m;p++){for(l=S[p],(c=r(p))&&h&&(D+=c.length,D-=(c=h(c,l)).length),f=0,u=0,g=c?c.length:0;f<g;f++)a=x[s=c[f]],u>0&&w&&(l=Ei(y[p]),S.push(l),b.push(un(b[p]))),0===u||w?I.length>0&&$_(l,a,I,E):1==u&&(I.length>0&&!E&&F_(l,a,I,R),M++),C.length>0&&z_(l,a,C,E),k[s]++,u++;d&&d(c,l),u>0?P++:l&&(n.unmatched&&T.push(o.extend({},l)),B_(l,I,C,E))}return function(e,t,r,n,i,a,s){var l=t-e;if(e>0==!1)return void v("No records could be joined");v(o.format("Joined data from %'d source record%s to %'d target record%s",r,o.pluralSuffix(r),e,o.pluralSuffix(e))),l>0&&v(o.format("%d target record%s received no data",l,o.pluralSuffix(l)));r<n&&v(o.format("%d/%d source records could not be joined",n-r,n));i>0&&v(o.format("%d/%d source records were skipped",i,n));a>0&&(v(o.format("%d/%d target records were matched by multiple source records (many-to-one relationship)",a,t)),s.length>0&&v(o.format("Inconsistent values were found in field%s [%s] during many-to-one join. Values in the first joining record were used.",o.pluralSuffix(s.length),s.join(","))))}(P,m,function(e){for(var t=0,r=0,n=e.length;r<n;r++)e[r]>0&&t++;return t}(k),x.length,D,M,R),n.unjoined&&(O.unjoined={name:"unjoined",data:new Fi(x.filter((function(e,t){return 0===k[t]})))}),n.unmatched&&(O.unmatched={name:"unmatched",data:new Fi(T)}),O}function L_(e){e.forEach((function(e){/:(str|num)/.test(e)&&_("Unsupported use of type hints. Use string-fields= or field-types= options instead")}))}function B_(e,t,r,n){$_(e,{},t,n),z_(e,{},r,n)}function $_(e,t,r,n){var i,o;n=n||"";for(var a=0,s=r.length;a<s;a++)o=n+(i=r[a]),Object.prototype.hasOwnProperty.call(t,i)?e[o]=t[i]:Object.prototype.hasOwnProperty.call(e,o)||(e[o]=null)}function z_(e,t,r,n){var i,o;n=n||"";for(var a=0;a<r.length;a++)e[o=n+(i=r[a])]=(e[o]||0)+(t[i]||0)}function F_(e,t,r,n){for(var i,o=0,a=r.length;o<a;o++)e[i=r[o]]!==t[i]&&-1===n.indexOf(i)&&n.push(i)}function q_(e,t,r){var n;if(r.fields?r.fields.indexOf("*")>-1?n=t:L_(n=r.fields):r.calc?n=[]:(n=t,r.keys&&(n=o.difference(n,[r.keys[1]]))),!r.force&&!r.prefix){var i=o.intersection(n,e);i.length>0&&(v('Same-named fields not joined without the "force" flag:',i),n=o.difference(n,i))}return n}var N_=Object.freeze({__proto__:null,findCollisionFields:F_,getFieldsToJoin:q_,joinTableToLayer:O_,joinTables:function(e,t,r,n){return O_({data:e},t,r,n)},updateUnmatchedRecord:B_,validateFieldNames:L_});function j_(e,t,r,n){var i=G_(e,t,r,n);return V_(e,r),O_(e,r.data,i,n)}function U_(e,t,r,n){var i=W_(e,t,r);return V_(e,t),O_(e,t.data,i,n)}function V_(e,t){e.data||(e.data=new Fi(e.shapes.length)),t.data||_("Can't join a layer that is missing attribute data")}function G_(e,t,r,n){var i=W_(r,e,t),o=[],a=!!n.first_match;return r.shapes.forEach((function(e,t){for(var r,n=i(t),s=n?n.length:0,l=0;l<s&&((r=n[l])in o?o[r].push(t):o[r]=[t],!a);l++);})),function(e){return o[e]||null}}function W_(e,t,r,n){var i=new Cl(t.shapes,r),o=e.shapes;return function(e){var t=o[e],r=t?i.findEnclosingShapes(t[0]):[];return r.length>0?r:null}}var H_=Object.freeze({__proto__:null,getPolygonToPointsFunction:G_,joinPointsToPolygons:j_,joinPolygonsToPoints:U_,prepJoinLayers:V_});function Z_(e,t,r,n){var i=Pp([e],t,r,n),a=Lc(i,n),s=i.layers.pop();t.arcs=i.arcs,V_(e,s);var l=new Kc({shapes:e.shapes.concat(s.shapes)},a,{flat:!1}),c=o.extend({},n),u=function(e,t,r,n){var i,a=(s=e.shapes.length,l=t.shapes.length,function(e){for(var t,r=[],n=0;n<e.length;n++)(t=e[n]-s)>=0&&t<l&&r.push(t);return r});var s,l;n.largest_overlap&&(i=function(e,t,r){var n=r.nodes.arcs,i=e.shapes.length;function a(e){for(var t=0,i=0;i<e.length;i++)t+=Qr.getShapeArea(r.mosaic[e[i]],n);return t}return function(e,t){var n=r.getTileIdsByShapeId(e),s=0,l=-1;return t.forEach((function(e,t){var c=r.getTileIdsByShapeId(e+i),u=a(o.intersection(n,c));u>=s&&(l=e,s=u)})),-1==l&&y("Geometry error"),[l]}}(e,0,r));return function(e){for(var t,s=r.getTileIdsByShapeId(e),l=[],c=0;c<s.length;c++)t=r.getSourceIdsByTileId(s[c]),t=a(t),l=l.length>0?l.concat(t):t;return(l=o.uniq(l)).length>1&&n.largest_overlap&&(l=i(e,l)),l}}(e,s,l,n),h=O_(e,s.data,u,c);return n.interpolate&&(n.duplication&&_("duplication and interpolate options cannot be used together"),function(e,t,r,n){var i=function(e,t,r,n){var i=n.planar?Qr.getPlanarShapeArea:Qr.getShapeArea,o=e.shapes.length,a=r.mosaic,s=r.nodes.arcs,l=a.map((function(e,t){return{area:i(e,s),weights:null,sourceIds:null}}));return t.shapes.forEach((function(e,t){for(var n,a,c=r.getTileIdsByShapeId(t+o),u=i(e,s),h=0;h<c.length;h++)a=(n=l[c[h]]).area/u,n.weights||(n.weights=[],n.sourceIds=[]),n.weights.push(a),n.sourceIds.push(t)})),l}(e,t,r,n),o=n.interpolate,a=t.data.getRecords();e.data.getRecords().forEach((function(e,t){var n,s,l=r.getTileIdsByShapeId(t),c=[];for(n=0;n<l.length;n++)c.push(i[l[n]]);for(n=0;n<o.length;n++)e[s=o[n]]=Y_(s,c,a)}))}(e,s,l,n)),h}function Y_(e,t,r){for(var n,i,o=0,a=0;a<t.length;a++)if((n=t[a]).sourceIds)for(var s=0;s<n.sourceIds.length;s++)i=r[n.sourceIds[s]],o+=n.weights[s]*i[e];return o}function X_(e,t,r){if(!e)return null;var n=e.map((function(e){return function(e,t){var r,n=Xt(e,t,!1)/2,i=0;_r(e,t,(function(e,t,o,a){var s=o[e],l=a[e],c=o[t],u=a[t];if(!r){if(n>0==!1)return[s,l];var h,d=qt(s,l,c,u);i+d>=n&&(r=[(1-(h=(n-i)/d))*s+h*c,(1-h)*l+h*u]),i+=d}})),r||y("Geometry error");return r}(e,t)}));return n}function K_(e,t,r){var n=!t.isPlanar(),i=e?1==e.length?e[0]:function(e,t,r){var n=0,i=null;return e.forEach((function(e){var o=Qr.calcPathLen(e,t,r);o>n&&(n=o,i=e)})),i}(e,t,n):null;if(!i)return null;var o=t.getSimpleShapeBounds(i);return Ya(o.centerX(),o.centerY(),[i],t,n)}function Q_(e,t,r){var n=r.inner?bs:Qr.getShapeCentroid;return e.shapes.map((function(e){var r=n(e,t);return r?[[r.x,r.y]]:null}))}function J_(e){var t;if(o.isFiniteNumber(e))return e;if(o.isString(e)&&""!==e){if(t=+e,o.isFiniteNumber(t))return t;if(t=hs(e),o.isFiniteNumber(t))return t}return NaN}function ev(e){var t=/^(lng|long?|longitude|x)$/i;return o.find(e,(function(e){return t.test(e)}))}function tv(e){var t=/^(lat|latitude|y)$/i;return o.find(e,(function(e){return t.test(e)}))}function rv(e,t){return e||_("Layer is missing a data table"),t.x&&t.y&&e.fieldExists(t.x)&&e.fieldExists(t.y)||_("Missing x,y data fields"),e.getRecords().map((function(e){var r=J_(e[t.x]),n=J_(e[t.y]);return isNaN(r)||isNaN(n)?null:[[r,n]]}))}a.createPointLayer=function(e,t,r){var n=so(e,r),i=t.arcs;r.intersections?(!function(e){e.getFilteredPointCount(),e.size();var t=Ba(e),r=Math.ceil(t/10),n=10*t,i=$a(e);[r,t,n,i].forEach((function(t){Ra(e,{stripes:t})}))}(i),n=e):r.interpolated?n.shapes=function(e,t,r){var n,i=el(r.interval,da(t));i>0==!1&&_("Invalid interpolation interval:",r.interval);"polyline"!=e.geometry_type&&_("Expected a polyline layer");return e.shapes.map((function(e,t){return n=[],e&&e.forEach(o),n.length>0?n:null}));function o(e){var r=function(e,t,r){var n,i,o,a,s,l=t.getShapeIter(e),c=t.isPlanar()?Qr.distance2D:Qr.greatCircleDistance,u=[],h=0;l.hasNext()&&(u.push([l.x,l.y]),n=l.x,i=l.y);for(;l.hasNext();){for(o=c(n,i,l.x,l.y);h+o>=r;)a=(r-h)/o,s=m_(n,i,l.x,l.y,a),h=0,u.push(s),o=c(n=s[0],i=s[1],l.x,l.y);h+=o,n=l.x,i=l.y}h>0&&u.push([n,i]);return u}(e,t.arcs,i);n=n.concat(r)}}(e,t,r):r.vertices?n.shapes=function(e,t){var r,n;"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&_("Expected a polygon or polyline layer");return e.shapes.map((function(e,t){return r=[],n={},(e||[]).forEach(o),r.length>0?r:null}));function i(e){var t=e.x+"~"+e.y;t in n==!1&&(n[t]=!0,r.push([e.x,e.y]))}function o(e){for(var r=t.getShapeIter(e);r.hasNext();)i(r)}}(e,i):r.vertices2?n.shapes=function(e,t){var r;"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&_("Expected a polygon or polyline layer");return e.shapes.map((function(e,t){return r=[],(e||[]).forEach(n),r.length>0?r:null}));function n(e){for(var n=t.getShapeIter(e);n.hasNext();)r.push([n.x,n.y])}}(e,i):r.endpoints?n.shapes=function(e,t){var r,n;"polygon"!=e.geometry_type&&"polyline"!=e.geometry_type&&_("Expected a polygon or polyline layer");return e.shapes.map((function(e,t){return r=[],n={},(e||[]).forEach(o),r.length>0?r:null}));function i(e){var t=e.x+"~"+e.y;t in n==!1&&(n[t]=!0,r.push([e.x,e.y]))}function o(e){for(var r=0;r<e.length;r++)i(t.getVertex(e[r],0)),i(t.getVertex(e[r],-1))}}(e,i):r.x||r.y?n.shapes=rv(e.data,r):"polygon"==e.geometry_type?n.shapes=Q_(e,i,r):r.midpoints?(no(e),n.shapes=function(e,t){return e.shapes.map((function(e){return X_(e,t)}))}(e,i)):"polyline"==e.geometry_type?n.shapes=function(e,t){return e.shapes.map((function(e){var r=K_(e,t);return r?[[r.x,r.y]]:null}))}(e,i):e.geometry_type?_("Expected a polygon or polyline layer"):n.shapes=function(e){var t=e?e.getFields():[],r={x:ev(t),y:tv(t)};return rv(e,r)}(e.data),n.geometry_type="point";var a=n.shapes.reduce((function(e,t){return t||e++,e}),0);return a>0&&v(o.format("%,d of %,d points are null",a,n.shapes.length)),e.data&&(n.data=r.no_replace?e.data.clone():e.data),n};var nv=Object.freeze({__proto__:null,coordinateFromValue:J_,findXField:ev,findYField:tv,pointsFromPolygons:Q_});function iv(e,t){return{geometry_type:"point",shapes:Q_(e,t.arcs,{inner:!0}),data:e.data}}function ov(e,t,r,n){return n.point_method?function(e,t,r,n){var i,o,a=r.layer,s=r.dataset;return e.shapes.length>a.shapes.length?(o=U_(i=iv(e,t),a,s.arcs,n),e.data=i.data):(i=iv(a,s),o=j_(e,t.arcs,i,n)),o}(e,t,r,n):Z_(e,t,r,n)}function av(e,t){return{geometry_type:"point",shapes:e.shapes.map((function(e){return X_(e,t.arcs)})),data:e.data}}function sv(e){e.point_method||_('The "point-method" flag is required for polyline-polygon joins')}class lv{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const o=n+1;if(o<this.length&&r(t[o],t[n])<0&&(n=o),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}}var cv=Math.PI/180;function uv(e,t,r,n){var i=n.minLng,o=n.maxLng,a=n.minLat,s=n.maxLat;if(e>=i&&e<=o)return t<a?dv((t-a)*cv):t>s?dv((t-s)*cv):0;var l=Math.min(dv((e-i)*cv),dv((e-o)*cv)),c=function(e,t){var r=1-2*t;return r<=0?e>0?90:-90:Math.atan(Math.tan(e*cv)/r)/cv}(t,l);return c>a&&c<s?pv(l,r,t,c):Math.min(pv(l,r,t,a),pv(l,r,t,s))}function hv(e,t){return e.dist-t.dist}function dv(e){var t=Math.sin(e/2);return t*t}function pv(e,t,r,n){return t*Math.cos(n*cv)*e+dv((r-n)*cv)}function fv(e,t,r,n,i){return pv(dv((e-r)*cv),i,t,n)}function mv(e,t,r){ro(e);var n=sn(e),i=r.max_distance?Js(r.max_distance,t):.001,o=function(e,t,r){var n=!!t&&ma(t),i=t&&t.to_meter||1;if(n)return function(t){return function(e,t,r,n,i){var o=1,a=[];void 0===n&&(n=1/0),void 0!==i&&(o=dv(i/6371));for(var s,l,c,u=new lv([],hv),h={left:0,right:e.ids.length-1,axis:0,minLng:-180,minLat:-90,maxLng:180,maxLat:90},d=Math.cos(r*cv);h;){if((s=h.right)-(l=h.left)<=e.nodeSize)for(var p=l;p<=s;p++)c=e.points[e.ids[p]],u.push({i:e.ids[p],item:c,dist:fv(t,r,e.coords[2*p],e.coords[2*p+1],d)});else{var f=l+s>>1,m=e.coords[2*f],g=e.coords[2*f+1];c=e.points[e.ids[f]],u.push({i:e.ids[f],item:c,dist:fv(t,r,m,g,d)});var y=(h.axis+1)%2,_={left:l,right:f-1,axis:y,minLng:h.minLng,minLat:h.minLat,maxLng:0===h.axis?m:h.maxLng,maxLat:1===h.axis?g:h.maxLat,dist:0},v={left:f+1,right:s,axis:y,minLng:0===h.axis?m:h.minLng,minLat:1===h.axis?g:h.minLat,maxLng:h.maxLng,maxLat:h.maxLat,dist:0};_.dist=uv(t,r,d,_),v.dist=uv(t,r,d,v),u.push(_),u.push(v)}for(;u.length&&u.peek().item;){var b=u.pop();if(b.dist>o)return a;if(a.push(b.i),a.length===n)return a}h=u.pop()}return a}(e,t[0],t[1],1/0,r/1e3)};return function(t){return e.within(t[0],t[1],r/i)}}(new(Et("kdbush"))(n),t,i),a=new Ma(n.length);this.lookupByMultiPoint=function(e){var t,r,n,i,s=[];for(r=0,i=e?e.length:0;r<i;r++)for(t=e[r],s=o(t),n=0;n<s.length;n++)a.setId(s[n]);return s=a.getIds(),a.clear(),s}}function gv(e,t,r,n){var i=function(e,t,r,n){var i=e.shapes,o=new mv(t,r,n);return function(e){var t=o.lookupByMultiPoint(i[e]);return t.length>0?t:null}}(e,t,r,n);return V_(e,t),O_(e,t.data,i,n)}function yv(e,t,r){var n=r.keys,i=n[0],o=n[1],a=function(e,t,r,n){e||_("Target layer is missing an attribute table");r||_("Source layer is missing an attribute table");var i,o,a=e.getRecords(),s=r.getRecords(),l=function(e,t){for(var r,n={},i=0,o=e.length;i<o;i++)(r=e[i][t])in n==!1?n[r]=i:Array.isArray(n[r])?n[r].push(i):n[r]=[n[r],i];return n}(s,n);if(0==s.length)return function(e){return[]};Ji(r,n,"External table is missing a field named:"),Ji(e,t,"Target layer is missing key field:"),i=Ci(n,r.getRecords()),o=Ci(t,a),_v(n,i),_v(t,o),i!=o&&_("Join keys have mismatched data types:",o,"and",i);return function(e){var r=a[e],n=r?r[t]:null,i=null;return r&&n in l&&(i=l[n],Array.isArray(i)||(i=[i])),i}}(e.data,i,t,o);return L_(n),O_(e,t,a,r)}function _v(e,t){t&&"object"!=t||_("["+e+"] field has an unsupported data type. Expected string or number.")}a.join=function(e,t,r,n){var i,a,s;r&&r.dataset||_("Missing a joinable data source"),n.keys?(2!=n.keys.length&&_("Expected two key fields: a target field and a source field"),r.layer.data||_("Source layer is missing attribute data"),s=yv(e,r.layer.data,n)):(r.layer.data||go(r.layer),pa([t,r.dataset]),i=r.layer.geometry_type,a=e.geometry_type,"point"==i&&"polygon"==a?s=j_(e,t.arcs,r.layer,n):"polygon"==i&&"point"==a?s=U_(e,r.layer,r.dataset.arcs,n):"point"==i&&"point"==a?s=gv(e,r.layer,da(t),n):"polygon"==i&&"polygon"==a?s=ov(e,t,r,n):"polyline"==i&&"polygon"==a?s=function(e,t,r,n){sv(n);var i=av(r.layer,r.dataset);return j_(e,t.arcs,i,n)}(e,t,r,n):"polygon"==i&&"polyline"==a?s=function(e,t,r,n){sv(n);var i=av(e,t),o=U_(i,r.layer,r.dataset.arcs,n);return e.data=i.data,o}(e,t,r,n):_(o.format("Unable to join %s geometry to %s geometry",i||"null",a||"null"))),s.unmatched&&t.layers.push(s.unmatched),s.unjoined&&t.layers.push(s.unjoined)};var vv=Object.freeze({__proto__:null,joinAttributesToFeatures:yv});function bv(e,t){t.forEach((function(t){"polygon"==t.geometry_type&&function(e,t){t.forEach((function(t){wv(e,t)}))}(e,t.shapes)}))}function wv(e,t){for(var r,n,i=0,o=t?t.length:0,a=0;a<o;a++)(n=e.getSimpleShapeBounds(t[a]).area())>i&&(r=t[a],i=n);r&&0!==r.length?function(e,t){var r,n=e.getRetainedInterval(),i=1e-10;e.setRetainedInterval(1/0),r=Qr.getPlanarPathArea(t,e);for(;r<=i;){if(0===xv(e,t)){w("[protectMultiRing()] Failed on ring:",t);break}r=Qr.getPlanarPathArea(t,e)}e.setRetainedInterval(n)}(e,r):w("[protectShape()] Invalid shape:",t)}function xv(e,t){for(var r,n,i,o,a,s,l=0,c=e.getVertexData(),u=0;u<t.length;u++)(n=t[u])<0&&(n=~n),s=(a=c.ii[n])+c.nn[n]-1,-1!=(i=mr(c.zz,1/0,a,s))&&(o=c.zz[i])>l&&(l=o,r=n);return l>0?(s=(a=c.ii[r])+c.nn[r]-1,Sv(c.zz,l,1/0,a,s)):0}function Sv(e,t,r,n,i){for(var o=0,a=n;a<=i;a++)e[a]===t&&(e[a]=r,o++);return o}var Ev=Object.freeze({__proto__:null,keepEveryPolygon:bv,protectShape:wv,replaceInArray:Sv});function Tv(e,t,r){var n,i=r||{},a=!i.reusable,s=t.size(),l=new Int32Array(s),c=new Int32Array(s);return i.where&&(n=js(i.where,e,t)),o.initializeArray(l,-1),o.initializeArray(c,-1),vr(e.shapes,(function(e){var t=or(e.arcId),r=e.shapeId,n=l[t];-1==n?l[t]=r:r<n?(c[t]=n,l[t]=r):c[t]=r})),function(e){return function(t){return function(e,t){var r,i=or(e),o=l[i],s=c[i];return-1==o||null===(r=t(o,s))||!1===r?null:(a&&(l[i]=-1,c[i]=-1),n&&!n(o,s)?null:r)}(t,e)}}}function Av(e,t){for(var r=t.arcs,n=ur(e.shapes,r),i=[],o=[],a=0,s=r.size();a<s;a++)n(a)&&(i.push({arcid:a}),o.push([[a]]));return{geometry_type:"polyline",data:new Fi(i),shapes:o}}function Cv(e,t){for(var r,n=t.arcs,i={type:"FeatureCollection",features:[]},o=ur(e.shapes,n),a=0,s=n.size();a<s;a++)o(r=a)&&n.forEachArcSegment(r,l);function l(e,t,n,o){var a=n[e],s=o[e],l=n[t],c=o[t];i.features.push({type:"Feature",properties:{arc:r,i1:e,i2:t,x1:a,y1:s,x2:l,y2:c},geometry:{type:"LineString",coordinates:[[a,s],[l,c]]}})}var c=wa([t,ry(i,{})]);return t.arcs=c.arcs,c.layers.pop()}function Iv(e){var t=[];return ln(e,(function(e){t.push(e.concat())})),{type:"LineString",coordinates:t}}function kv(e,t,r){var n,i=(r=r||{}).each?function(e,t,r){var n,i=Tv(t,r)(a),o=Us(e,t,r);function a(e,t){o(e,t,n)}return function(e,t){return n=e,i(t[0][0]),e}}(r.each,e,t):null,a=Tv(e,t,{where:r.where}),s=o.isArray(r.fields)?r.fields:[],l=0,c=[],u=[];return s.length>0&&!e.data&&_("Missing a data table"),h(function(e,t){return Rv(e,t((function(e,t){return-1==t?String(e):null})))}(e.shapes,a),"outer"),s.forEach((function(t){var r=e.data.getRecords();Ji(e,t),h(Rv(e.shapes,a((function(e,n){var i=r[e],o=r[n];return i&&o&&i[t]!==o[t]?e+"-"+n:null}))),t)})),h(Mv(e.shapes,a),"inner"),lo(n=Pv(c,u),e,null,r),n;function h(e,t){var r=e.map((function(e,r){var n={RANK:l,TYPE:t};return i&&i(n,e),n}));c=o.merge(e,c),u=o.merge(r,u),l++}}function Pv(e,t){return{geometry_type:"polyline",shapes:e,data:t?new Fi(t):null}}function Mv(e,t){return Rv(e,t((function(e,t){return t>-1?e+"-"+t:null})))}function Rv(e,t){var r,n=[],i={},o=null,a=null;return vr(e,(function(e){var s,l,c=e.arcId,u=t(c);u&&(l=u in i?i[u]:null,s=u==a&&e.shapeId==o.shapeId&&e.partId==o.partId,l?s?l[l.length-1].push(c):l.push([c]):(l=[[c]],i[u]=l,n.push(l)),e.i==r.arcs.length-1&&l.length>1&&l[0][0]==r.arcs[0]&&(l[0]=l.pop().concat(l[0])));o=e,a=u}),(function(e){r=e})),n}a.lines=function(e,t,r){return(r=r||{}).callouts?(to(e),function(e,t,r){var n=e.data?e.data.getRecords():null,i=mo(e).width()/50,o=function(e){return[e,[e[0]+i,e[1]]]},a={type:"FeatureCollection",features:e.shapes.map((function(e,t){return{type:"Feature",properties:n?n[t]:null,geometry:{type:"MultiLineString",coordinates:e.map(o)}}}))},s=ry(a),l=va(t,[s]);return lo(l[0],e.name,null,r),l}(e,t,r)):"point"==e.geometry_type?function(e,t,r){var n=r.groupby?function(e,t,r){var n=[],i=hc([t],e.data),a=o.defaults({fields:[t]},r),s=pc(e.data.getRecords(),i,a);return e.shapes.forEach((function(e,t){var r=i(t);r in n==!1&&(n[r]=[]),n[r].push(e)})),{type:"FeatureCollection",features:n.map((function(e,t){return{type:"Feature",properties:s[t],geometry:e.length>1?Iv(e):null}}))}}(e,r.groupby,r):Iv(e.shapes),i=ry(n),a=va(t,[i]);return lo(a[0],e,null,r),a}(e,t,r):r.segments?[Cv(e,t)]:r.arcs?[Av(e,t)]:"polygon"==e.geometry_type?kv(e,t.arcs,r):void io(e,"Command requires a polygon or point layer")};var Dv=Object.freeze({__proto__:null,createLineLayer:Pv,extractInnerLines:Mv,polygonsToLines:kv});function Ov(e,t,r,n,i,o,a,s){return e<i&&e<a&&r<i&&r<a||e>i&&e>a&&r>i&&r>a||t<o&&t<s&&n<o&&n<s||t>o&&t>s&&n>o&&n>s?null:Qr.segmentIntersection(e,t,r,n,i,o,a,s)}var Lv=Object.freeze({__proto__:null,addBufferVertex:function(e,t,r){for(var n,i,o,a,s=0,l=e.length-3;s<r&&l>=0;s++,l--)if(o=e[e.length-1],n=e[l],i=e[l+1],a=Ov(n[0],n[1],i[0],i[1],o[0],o[1],t[0],t[1])){for(a.length;e.length>l+1;)e.pop();e.push(a)}e.push(t)},bufferIntersection:Ov,getPolylineBufferMaker:function(e,t,r,n){var i=function(e,t,r,n){var i=n.backtrack>=0?n.backtrack:50,o=new ko(e),a=n.cap_style||"round";function s(e,r,n,o,a,s){for(var l=10,c=o+a,u=o+l;u<c;)f(e,t(r,n,u,s),i),u+=l}function l(e,t,r,n,i){return Qr.distance2D(e,t,r,n)<i}function c(e,t,r){var n=e[e.length-1];return l(n[0],n[1],t,r,1e-6)}function u(e,t){var r=e[e.length-1];l(r[0],r[1],t[0],t[1],1e-10)||e.push(t)}function h(e,t,r,n){return"flat"==a?[[e,t]]:d(e,t,r,n)}function d(e,r,n,i){for(var o=[],a=10,s=n-90,l=a;l<180;)o.push(t(e,r,s+l,i)),l+=a;return o}function p(e,t){var r=t-e;return r>180&&(r-=360),r<-180&&(r+=360),r}function f(e,t,r){for(var n,i,o,a,s=0,l=e.length-3;s<r&&l>=0;s++,l--)if(o=e[e.length-1],n=e[l],i=e[l+1],a=Ov(n[0],n[1],i[0],i[1],o[0],o[1],t[0],t[1])){for(;e.length>l+1;)e.pop();u(e,a)}u(e,t)}return function(e,n){var a,l,u,d,m,g,y,_,v,b,w,x,S=[],E=0;for(o.init(e);o.hasNext();)o.x===m&&o.y===g||(u=m,d=g,m=o.x,g=o.y,E>=1&&(b=v,v=r(u,d,m,g),y=t(u,d,v-90,n),_=t(m,g,v-90,n)),1==E&&(w=v,a=u,l=d,S.push(y,_)),E>1&&(x=p(b,v),c(S,y[0],y[1])?f(S,_,i):x>0?(s(S,u,d,b-90,x,n),f(S,y,i),f(S,_,i)):(f(S,y,i),f(S,_,i))),E++);return m==a&&g==l?(x=p(v,w))>0&&s(S,m,g,v-90,x,n):S.push.apply(S,h(m,g,v,n)),S}}(e,t,r,n),o=n.geometry_type,a="polyline"==n.output_geometry?"polyline":"polygon";function s(e,t){var r,n=i(e,t);return"polyline"==o&&(r=pr(e.concat()),n=n.concat(i(r,t))),n.push(n[0]),"polyline"==a?n:[n]}return function(e,t){for(var r={type:"polyline"==a?"MultiLineString":"MultiPolygon",coordinates:[]},n=0;n<e.length;n++)r.coordinates.push(s(e[n],t));return 0==r.coordinates.length?null:r}}});var Bv=Object.freeze({__proto__:null,findPairsOfNeighbors:function(e,t){var r=Tv(e,t)((function(e,t){return t>-1&&e>-1?[e,t]:null})),n=[],i={};return gr(e.shapes,(function(e){var t,o=r(e);o&&(t=o.join("~"))in i==!1&&(n.push(o),i[t]=!0)})),n},getNeighborLookupFunction:function(e,t){var r,n,i,o=Tv(e,t,{reusable:!0})((function(e,t){return-1==t?-1:e==r?t:e}));function a(e){var t=o(e);-1!=t&&(i?i(t,e):-1==n.indexOf(t)&&n.push(t))}return function(t,o){if(r=t,!o)return n=[],gr(e.shapes[t],a),n;i=o,gr(e.shapes[t],a),i=null}}});function $v(e,t){var r=Ic(t);e.shapes=e.shapes.map((function(e,n){return function(e){var n=[];return dn(e,(function(e){var i=r(e);if(0===i.length)y("[cleanPolygon()] Defective path:",e);else if(1==i.length)n.push(i[0]);else{var o,a=Qr.getPlanarPathArea(e,t.arcs)>0?1:-1;i.reduce((function(e,r,n){var i=Qr.getPlanarPathArea(r,t.arcs)*a;return i>e&&(o=r,e=i),e}),0),o&&n.push(o)}})),n.length>0?n:null}(e)}))}var zv=Object.freeze({__proto__:null,repairPolygonGeometry:function(e,t,r){var n=Lc(t);return e.forEach((function(e){$v(e,n)})),e},repairSelfIntersections:$v});function Fv(e){var t,r=Ra(e),n=qv(e,r),i=r.length,a=n.length,s=i>a?i-a:0;i>0&&(t=o.format("Repaired %'i intersection%s",s,o.pluralSuffix(s)),a>0&&(t+=o.format("; %'i intersection%s could not be repaired",a,o.pluralSuffix(a))),v(t))}function qv(e,t){for(;Nv(e,t)>0;)t=Ra(e);return t}function Nv(e,t){var r,n,i,a,s=e.getVertexData(),l=e.getRetainedInterval(),c=0,u=0;for(n=jv(t,l,s.zz),o.sortOn(n,"z",!0);n.length>0;)for(1==(r=Gv(i=n.pop(),l,s.xx,s.yy,s.zz)).length&&(r=Vv(r[0],l,s.zz),c++),a=0;a<r.length;a++)Uv(n,r[a]);return++u>5e5?(w("Caught an infinite loop at intersection:",i),0):c}function jv(e,t,r){return e.reduce((function(e,n){var i=function(e,t,r){var n,i=mr(r,t,e.a[0],e.a[1]),o=mr(r,t,e.b[0],e.b[1]);n=-1==i&&-1==o?null:-1==o||-1!=i&&r[i]>r[o]?{a:e.a,b:e.b,z:r[i]}:{a:e.b,b:e.a,z:r[o]};return n}(n,t,r);return null!==i&&e.push(i),e}),[])}function Uv(e,t){for(var r=e.length;r>0&&!(e[r-1].z<=t.z);)e[r]=e[r-1],r--;e[r]=t}function Vv(e,t,r){for(var n=[],i=e.a[0],o=e.a[1],a=e.z,s=i+1;s<=o;s++)r[s]!=a&&s!=o||(n.push({a:[i,s],b:e.b,z:a}),s!=o&&(r[s]=t),i=s);return n.length<2&&y("Error in unwindIntersection()"),n}function Gv(e,t,r,n,i){var o=function(e,t,r,n,i){var o=Wv(e.a,t,r,n,i);return o=o.concat(Wv(e.b,t,r,n,i)),o}(e,t,r,n,i);return jv(za(o,r,n),t,i)}function Wv(e,t,r,n,i){var o,a,s,l=[];e[0]<=e[1]?(o=e[0],a=e[1]):(o=e[1],a=e[0]),s=o;for(var c=o+1;c<=a;c++)i[c]>=t&&(r[s]<r[c]?l.push(s,c):l.push(c,s),s=c);return l}var Hv=Object.freeze({__proto__:null,postSimplifyRepair:Fv,repairIntersections:qv});function Zv(e){var t=[],r=[];function n(e,t){for(var n=0;n<t.length;n++)e.push([r.length]),r.push(t[n])}function i(t){for(var r=[],n=e.arcs.getShapeIter(t);n.hasNext();)r.push([n.x,n.y]);return r}this.done=function(){e.layers=t,r.length&&(e.arcs=new Oo(r),wo(e))},this.editLayer=function(r,o){var a=r.geometry_type;if(e.layers.indexOf(r)!=t.length&&y("Layer was edited out-of-order"),a){var s=r.shapes.map((function(e,t){for(var r,s,l=[],c=0,u=e?e.length:0;c<u;c++)s="point"==a?e[c]:i(e[c]),r=o(s,c,e),Array.isArray(r)&&("point"==a?l.push(r):"polygon"!=a&&"polyline"!=a||n(l,r||[]));return l.length>0?l:null}));t.push(Object.assign(r,{shapes:s}))}else t.push(r)}}function Yv(e,t,r){if(function(e){for(var t,r,n,i=0,o=1,a=e.length;o<a;o++)r=e[o-1],n=e[o],(t=Qr.distanceSq(r[0],r[1],n[0],n[1]))>i&&(i=t);return Math.sqrt(i)}(e)<t)return e;r||(r=Xv(t));for(var n,i,o=[e[0]],a=1,s=e.length;a<s;a++)n=e[a-1],i=e[a],Qr.distance2D(n[0],n[1],i[0],i[1])>t+1e-4&&Kv(o,r(n,i)),o.push(i);return o}function Xv(e){return function(t,r){for(var n=[],i=Qr.distance2D(t[0],t[1],r[0],r[1]),o=Math.round(i/e)-1,a=(r[0]-t[0])/(o+1),s=(r[1]-t[1])/(o+1),l=1;l<=o;l++)n.push([t[0]+a*l,t[1]+s*l]);return n}}function Kv(e,t){for(var r=0;r<t.length;r++)e.push(t[r])}function Qv(e,t){var r,n=function(e,t){var r=cr(e),n=e.getBounds(),i=function(e,t,r){for(var n=[.1,.2,.3,.4,.5,.6,.7,.8,.9],i=[],a=0;a<n.length;a++)for(var s=0;s<n.length;s++)i.push([n[a],n[s]]);var l=i.map((function(n){var i=e.xmin+e.width()*n[0],o=e.ymin+e.height()*n[1],a=r(i,o),s=r(i+t[0],o+t[1]);return a&&s?Qr.distance2D(a[0],a[1],s[0],s[1]):1/0})).filter((function(e){return e<1/0}));return l.length>0?o.findMedian(l):1/0}(n,r,t),a=function(e,t){var r=t(e.centerX(),e.centerY()),n=t(e.centerX(),e.ymin),i=t(e.xmax,e.centerY()),o=r&&n&&i?(Qr.distance2D(r[0],r[1],n[0],n[1])+Qr.distance2D(r[0],r[1],i[0],i[1]))/5e3:1/0;return o}(n,t),s=Math.min(i,a);s==1/0&&y("Densification error");return s}(e,t),i=n*n*25;return Vd(e,(function(e,o,a,s,l,c){var u=r;if(!(r=t(o,a)))return!1;c>0&&Qr.distanceSq(r[0],r[1],u[0],u[1])>i&&Jv(s,l,u[0],u[1],o,a,r[0],r[1],t,n).forEach(e);e(r)}))}function Jv(e,t,r,n,i,o,a,s,l,c,u){var h=(e+i)/2,d=(t+o)/2,p=l(h,d);if(p)return u=u||[],Qr.pointSegDistSq2(p[0],p[1],r,n,a,s)>c*c*.25&&Qr.distance2D(e,t,i,o)>.01&&(Jv(e,t,r,n,h,d,p[0],p[1],l,c,u),u.push(p),Jv(h,d,p[0],p[1],i,o,a,s,l,c,u)),u}function eb(e){return!(!e||4!=e.length)&&(!e.some(isNaN)&&(e[0]<=e[2]!=0&&e[1]<=e[3]!=0))}function tb(e,t){if(t.width){e.data||go(e);var r=e.data.getRecords()[0]||{};r.width=Zs(t.width),r.type="frame"}}function rb(e,t,r){var n=en(e);return r.offset&&(e=function(e,t,r){var n=rl(e,r,t);return t.padBounds(n[0],n[1],n[2],n[3]),t}(r.offset,e,t)),e.area()>0==!1?null:(r.aspect_ratio&&(e=nb(r.aspect_ratio,e)),n&&(e=tn(e)),e)}function nb(e,t){var r,n,i=String(e).split(",").map(parseFloat),o=t.width()/t.height();return 1==i.length?i.push(i[0]):i[0]>i[1]&&i.reverse(),r=i[0],n=i[1],r||n?(r||(r=-1/0),n||(n=1/0),o<r?t.fillOut(r):o>n&&t.fillOut(n),t):t}function ib(e,t){var r=t||{},n=Ni(e);return r.interval>0&&(n=Yv(n,r.interval)),{type:"Polygon",coordinates:[n]}}a.rectangles=function(e,t,r){var n,i=ha(t),a=e.data?e.data.getRecords():null;r.bbox?n=function(e,t,r){for(var n,i=Ns(e,t,r.arcs,{}),o=Ki(t),a=[],s=0;s<o;s++)eb(n=i(s))||_("Invalid bbox value (expected a GeoJSON-type bbox):",n),a.push(ib(n));return a}(r.bbox,e,t):(Vi(e)||_("Layer is missing geometric shapes"),n=function(e,t,r){var n=ha(t);return e.shapes.map((function(i){var o="point"==e.geometry_type?an(i):t.arcs.getMultiShapeBounds(i);return(o=rb(o,n.crs,r))?ib(o.toArray(),r):null}))}(e,t,r));var s=ry({type:"FeatureCollection",features:n.map((function(e,t){var n=a&&a[t]||null;return n&&r.no_replace&&(n=o.extend({},n)),{type:"Feature",properties:n,geometry:e}}))},{});ua(s,i);var l=va(t,[s]);return lo(l[0],e,null,r),l},a.rectangle2=function(e,t){if(1!=e.layers.length||!t.width||!Hi(e.layers[0],e.dataset.arcs)){var r=e.layers.map((function(r){var n=a.rectangle({layer:r,dataset:e.dataset},t);return lo(n.layers[0],r,null,t),t.no_replace||(n.layers[0].name=r.name||n.layers[0].name),n}));return va(e.dataset,r)}tb(e.layers[0],t)},a.rectangle=function(e,t){var r,n;t.bbox?(r=new St(t.bbox),n=e&&ha(e.dataset)||en(r)&&la("wgs84")||{}):e&&(r=mo(e.layer,e.dataset.arcs),n=ha(e.dataset)),(r=r&&rb(r,n.crs,t))&&r.hasBounds()||_("Missing rectangle extent");var i=ry({type:"Feature",properties:{},geometry:ib(r.toArray(),t)},{});return tb(i.layers[0],t),i.layers[0].name=t.name||"rectangle",ua(i,n),i};var ob=Object.freeze({__proto__:null,applyAspectRatio:nb,bboxToPolygon:ib});function ab(e,t){return t*Math.PI/180*function(e){return e.a*Math.sqrt(1-(e.es||0))}(e)}function sb(e){return e.params.proj.param}function lb(e){return function(e){if(cb(e,"cassini,gnom,bertin1953,chamb,ob_tran,tpeqd,healpix,rhealpix,ocea,omerc,tmerc,etmerc,nicol"))return!1;if(function(e){return cb(e,"aeqd,gnom,laea,mil_os,lee_os,gs48,alsk,gs50,nsper,tpers,ortho,qsc,stere,ups,sterea")}(e))return!1;return!0}(e)&&0!==e.lam0}function cb(e,t){return t.split(",").includes(sb(e))}var ub=1e-10,hb=90-ub,db=-180+ub,pb=-90+ub,fb=180-ub;function mb(e){return e[e.length-1]}function gb(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function yb(e){return gb(e[0],mb(e))}function _b(e){e[0]<=db&&(e[0]=-180),e[0]>=fb&&(e[0]=180),e[1]<=pb&&(e[1]=-90),e[1]>=hb&&(e[1]=90)}function vb(e){return e[1]>=hb||e[1]<=pb}function bb(e,t){return vb(e)||vb(t)||e[0]<=db&&t[0]<=db||e[0]>=fb&&t[0]>=fb}function wb(e){return e[1]<=pb||e[1]>=hb||e[0]<=db||e[0]>=fb}function xb(e){if(!function(e){for(var t=0,r=e.length;t<r;t++)if(wb(e[t]))return!0;return!1}(e))return e;var t,r,n,i=[],o=!1;e.pop(),t=e[e.length-1],r=e[0];for(var a=1,s=e.length;a<=s;a++)(n=a==s?i[0]:e[a])&&((o||bb(t,r))&&bb(r,n)?o=!0:(!0===o&&(o=!1),i.push(r),t=r),r=n);return i.length>0&&i.push(i[0].concat()),i}function Sb(e){return Ib(e)}function Eb(e){return-180==e[0]||180==e[0]}function Tb(e){for(var t,r=[],n=[],i=0;i<e.length;i++)yb(t=e[i])||y("Received an open path"),0===Cb(t)?r.push(t):n=n.concat(Ib(t));return n.length>0&&(r=r.concat(function(e){var t=function(e){var t=e.map((function(e){return e[0][1]}));return o.genericSort(t,!0)}(e),r=[],n=[];return e.forEach((function(e,t){if(!n[t]){(function(e){var t=mb(e)[0],r=e[0][0];return!(180!=t&&-180!=t||180!=r&&-180!=r)})(e)||y("Geometry error");var o=i(e,[]);o&&(yb(o)||y("Generated an open ring"),r.push(o))}})),r;function i(r,o){var a=mb(r),s=e.indexOf(r);if(n[s])return x(),null;n[s]=!0,o=o.concat(r);var l=function(e,t,r){var n,i=t[0],o=t[1],a=r.indexOf(o),s=-180==i?180:-180,l=180==i?a-1:a+1;if(180!=i&&-180!=i)return x(),null;if(-1==a)return x(),null;n=l<0||l>=r.length?[s,o]:[i,r[l]];return n}(0,a,t);if(!l)return null;if(a[0]!=l[0]){var c=180==a[0]?-90:90;o.push([a[0],c],[0,c],[l[0],c])}var u=function(e,t){for(var r=0;r<e.length;r++)if(gb(e[r][0],t))return e[r];return null}(e,l);return u?gb(o[0],u[0])?(o.push(o[0]),o):i(u,o):null}}(n))),r}function Ab(e,t){t.length>1&&e.push(t)}function Cb(e){for(var t,r,n=0,i=0,o=e.length;i<o;i++)r=e[i],i>0&&Math.abs(t[0]-r[0])>180&&n++,t=r;return n}function Ib(e){for(var t,r,n,i=[],o=[],a=e[0],s=gb(a,mb(e)),l=0,c=e.length;l<c;l++)t=e[l],l>0&&kb(r,t)&&(Pb(o,r,n=Mb(r,t)),Ab(i,o),Pb(o=[],t,n)),o.push(t),r=t;return Ab(i,o),s&&i.length>1&&!Eb(a)&&((o=i.pop()).pop(),i[0]=o.concat(i[0])),i}function kb(e,t){return Math.abs(e[0]-t[0])>180}function Pb(e,t,r){var n=t[0]<0?-180:180;Eb(t)||e.push([n,r])}function Mb(e,t){var r,n;return t[0]-e[0]>0?(r=e[0]+180,n=180-t[0]):(r=180-e[0],n=t[0]+180),0===r?e[1]:0===n?t[1]:(n*e[1]+r*t[1])/(r+n)}function Rb(e){return Mr(new Ao(e))}function Db(e,t,r,n){var i=__(ca("wgs84"));return n.inset&&(t-=n.inset),"polyline"==n.geometry_type?function(e,t,r,n){var i,o=[];if(!e||!e.length)return null;for(var a=0;a<e.length;a++)for(i=Sb(i=Ob(e[a],t,r,n));i.length>0;)o.push(i.pop());return 1==o.length?{type:"LineString",coordinates:o[0]}:{type:"MultiLineString",coordinates:o}}([e],t,360,i):function(e,t,r,n){var i,o,a=[];if(!e||!e.length)return null;for(var s=0;s<e.length;s++)if(Cb(i=Ob(e[s],t,r,n))>0)for(o=Tb([i]);o.length>0;)a.push([o.pop()]);else Rb(i)<0?a.push([[[180,90],[180,-90],[0,-90],[-180,-90],[-180,90],[0,90],[180,90]],i]):a.push([i]);return{type:"MultiPolygon",coordinates:a}}([e],t,360,i)}function Ob(e,t,r,n){for(var i,o=[],a=360/r,s=0;s<r;s++)i=(s+.5)*a%360,o.push(n(e[0],e[1],i,t));return o.push(o[0].concat()),o}function Lb(e,t,r,n){return 0!=t&&$b(e,t),0===r&&0===n||zb(e,r,n,!1),e}function Bb(e,t,r,n){return 0===r&&0===n||zb(e,r,n,!0),0!=t&&$b(e,-t),e}function $b(e,t){var r=e[0]+t;r>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),e[0]=r}function zb(e,t,r,n){var i,o=Math.cos(t),a=Math.sin(t),s=Math.cos(r),l=Math.sin(r),c=Math.cos(e[1]),u=Math.cos(e[0])*c,h=Math.sin(e[0])*c,d=Math.sin(e[1]);n?(i=d*s-h*l,e[0]=Math.atan2(h*s+d*l,u*o+i*a),e[1]=Math.asin(i*o-u*a)):(i=d*o+u*a,e[0]=Math.atan2(h*s-i*l,u*o-d*a),e[1]=Math.asin(i*s+h*l))}function Fb(e,t){ma(da(e))||_("Command requires a lat-long dataset."),Array.isArray(t.rotation)&&t.rotation.length||_("Invalid rotation parameter");var r,n,i,o,a,s=(r=t.rotation,n=t.invert,i=(r[0]||0)*Bt,o=(r[1]||0)*Bt,a=(r[2]||0)*Bt,function(e){return e[0]*=Bt,e[1]*=Bt,(n?Bb:Lb)(e,i,o,a),e[0]*=$t,e[1]*=$t,e}),l=new Zv(e);e.arcs&&e.arcs.flatten(),e.layers.forEach((function(e){var r=e.geometry_type;l.editLayer(e,function(e,t,r){var n;if("point"==e)return function(e){return e.forEach(t),e};if("polyline"==e)return function(e){return(e=Yv(e,.5)).forEach(t),Sb(e)};if("polygon"==e)return function(e,i,o){var a,s;if(!function(e){for(var t=0,r=e.length;t<r;t++)if(!wb(e[t]))return!1;return!0}(e)?(e.forEach(_b),e=Yv(e=xb(e),.5,(s=Xv(a=.5),function(e,t){var r;return r=vb(e)||vb(t)?[]:bb(e,t)?function(e,t,r){var n,i,o=[],a=e[1]<t[1];e[0]!=t[0]&&y("Expected an edge segment"),a?(n=e[1],i=t[1]):(n=t[1],i=e[1]);for(var s=Math.floor(n/r)*r+r;s<i;)o.push([e[0],s]),s+=r;return a||o.reverse(),o}(e,t,a):kb(e,t)?[]:s(e,t),r})),e.forEach(t)):e=Yv(e,.5),0===i&&(n=[]),!(e.length<4))return gb(e[0],mb(e))||y("Open polygon ring"),n.push(e),i==o.length-1?r.debug?n:Tb(n):void 0;x()};return null}(r,s,t))})),l.done(),t.debug||(wo(e),Yb(e))}function qb(e,t,r){return function(e,t,r){var n;i=t,cb(i,"stere,sterea,ups,ortho,gnom,laea,nsper,tpers,geos,nicol")||r.clip_angle||t.clip_angle?n=function(e,t,r){var n=r.clip_angle||t.clip_angle||function(e){var t=sb(e);if("nsper"==t||"geos"==t)return function(e){var t=parseFloat(e.params.h.param);if(!t||t<0)return 0;var r=180*Math.acos(e.a/(e.a+t))/Math.PI;return r*=.995}(e);if("tpers"==t)return v("Automatic clipping is not supported for the Tilted Perspective projection"),0;return{gnom:60,laea:179,ortho:89.85,nicol:89.85,stere:142,sterea:142,ups:10.5}[t]||0}(t);if(!n)return null;w(`Using clip angle of ${+n.toFixed(2)} degrees`);var i=function(e,t){return ab(e,t)}(e,n),o=function(e){var t=180/Math.PI;return[e.lam0*t,e.phi0*t]}(t);t.clip_angle=n;var a=Db(o,i,0,r);return ry(a)}(e,t,r):(function(e){return cb(e,"merc,bertin1953")}(t)||r.clip_bbox)&&(n=function(e,t){var r=t.clip_bbox||Nb(e),n=function(e){var t=sb(e);if("bertin1953"==t)return[-16.5,-42];if(("tmerc"==t||"utm"==t||"etmerc"==t)&&0!==e.lam0)return[180*e.lam0/Math.PI];return null}(e);r||y("Missing expected clip bbox.");t=Object.assign({interval:.5},t);var i=ry(ib(r,t));n&&Fb(i,{rotation:n,invert:!0});return i}(t,r));var i;return n||null}(e,t,r)}function Nb(e){var t=.001,r=[-179,-90,179,90];return{tmerc:r,utm:r,etmerc:r,merc:[-180,-89,180,89],lcc:[-180,-89,180,89],bertin1953:[-180+t,-90+t,180-t,90-t]}[sb(e)]}function jb(e,t,r,n){if(!ma(t)||n.no_clip)return!1;var i,a,s,l=function(e,t,r){var n=rn(180*r.lam0/Math.PI);if(e.arcs&&lb(r)&&function(e,t){var r=0;return e.arcs.forEachSegment((function(e,n,i,o){var a=i[e],s=i[n];(a<=t&&s>=t||a>=t&&s<=t)&&r++})),r>0}(e,n))return function(e,t){var r=e.layers.filter(Gi);if(0===r.length)return;var n=1e-8,i=ry(ib([t-n,-91,t+n,91],{interval:.5}));Bp(r,i,e,"erase")}(e,n),$o(e),!0;return!1}(e,0,r),c=!1,u=(cb(a=r,"merc,lcc")&&(s=Nb(a)),s);return u?function(e,t){Yo(e,(function(e,r){return[o.clamp(e,t[0],t[2]),o.clamp(r,t[1],t[3])]}))}(e,u):i=qb(t,r,n),i&&(c=function(e,t){var r=e.layers.filter((function(r){return Vi(r)&&!function(e,t,r){var n=mo(e,t.arcs),i=!1;return r.layers[0].shapes.forEach((function(e,t){i=i||Er(n,e,r.arcs)})),i}(r,e,t)}));if(r.length>0)return Bp(r,t,e,"clip"),!0;return!1}(e,i)),l||c}function Ub(e,t){var r,n,i,o,a;return e in Pt.internal.pj_list==!1?e:(i=["lcc","aea"].includes(e),o=["tmerc","etmerc"].includes(e),r="+proj="+e,(i||o)&&(n=function(e){ma(da(e))||_("Expected unprojected data");return jo(e).toArray()}(t),a=is(n),v(`Converted "${e}" to "${r+=" "+(o?Gb(n,a):Vb(n,a))}"`)),r)}function Vb(e,t){var r=(e[0]+e[2])/2,n=e[3]-e[1],i=e[1]+1/6*n,o=e[1]+5/6*n;return`+lon_0=${r.toFixed(t)} +lat_1=${i.toFixed(t)} +lat_2=${o.toFixed(t)}`}function Gb(e,t){var r=(e[0]+e[2])/2,n=(e[1]+e[3])/2;return`+lon_0=${r.toFixed(t)} +lat_0=${n.toFixed(t)}`}a.rotate=Fb;var Wb=Object.freeze({__proto__:null,expandProjDefn:Ub,getCenterParams:Gb,getConicParams:Vb});function Hb(e,t){var r,n,i={};return/\.prj$/i.test(e)?((r=s_(e,{}))&&(i.prj=r.info.prj,i.crs=ya(i.prj)),i):t&&(n=t.findSingleLayer(e))?ha(r=n.dataset):la(e)}function Zb(e,t,r,n){var i=Jo(t,r),o=0,a=0,s=jb(e,t,r,n);e.layers.forEach((function(e){Wi(e)&&(a+=Xb(e,i))})),e.arcs&&(o=n.densify?Qv(e.arcs,i):Kb(e.arcs,i)),s&&Yb(e),o>0&&!n.quiet&&v(`Removed ${o} ${1==o?"path":"paths"} containing unprojectable vertices.`),a>0&&!n.quiet&&v(`Removed ${a} unprojectable ${1==a?"point":"points"}.`),e.info.crs=r}function Yb(e){iu(e.layers.filter((e=>"polygon"==e.geometry_type)),e,{allow_overlaps:!0,rebuild_topology:!0,no_arc_dissolve:!0,quiet:!0,verbose:!1}),$o(e)}function Xb(e,t){var r=0;return pn(e.shapes,(function(e){var n=t(e[0],e[1]);return n||r++,n})),r}function Kb(e,t){return Vd(e,(function(e,r,n,i,o,a){var s=t(r,n);if(!s)return!1;e(s)}))}a.proj=function(e,t,r){var n,i;r.init&&((n=Hb(r.init,t)).crs||_("Unknown projection source:",r.init),ua(e,n)),r.match?i=Hb(r.match,t):r.crs&&(i=la(Ub(r.crs,e))),i&&function(e,t,r){var n=fd(),i=[],a={info:e.info||{}};t.crs||_("Missing projection data");if(!Vo(e))return void ua(e,t);var s=ha(e);s.crs||_("Unable to project -- source coordinate system is unknown");if(ia(s.crs,t.crs))return void v("Source and destination CRS are the same");e.arcs&&(e.arcs.flatten(),a.arcs=n?e.arcs.getCopy():e.arcs);a.layers=e.layers.map((function(e){return n&&(i.push(e),e=uo(e)),e})),Zb(a,s.crs,t.crs,r||{}),ua(a,t),e.arcs=a.arcs,i.forEach((function(e,t){o.extend(e,a.layers[t])}))}(e,i,r)};var Qb=Object.freeze({__proto__:null,cleanProjectedPathLayers:Yb,fetchCrsInfo:Hb,projectArcs:function(e,t){for(var r,n=e.getVertexData(),i=n.xx,o=n.yy,a=n.zz,s=e.getRetainedInterval(),l=0,c=i.length;l<c;l++)(r=t(i[l],o[l]))||y("Unprojectable point:",i[l],o[l]),i[l]=r[0],o[l]=r[1];e.updateVertexData(n.nn,i,o,a),e.setRetainedInterval(s)},projectArcs2:Kb,projectDataset:Zb,projectPointLayer:Xb});function Jb(e){var t=2*e.size(),r=new Bo(e).size();return e.getPointCount()-t+r}function ew(e,t){var r=ow(t),n={dp:"Ramer-Douglas-Peucker",visvalingam:"Visvalingam",weighted_visvalingam:"Weighted Visvalingam"}[r]||"Unknown",i=nw(e,t),a=function(e,t){var r,n=t?function(e,t,r,n,i,o){var a=[],s=[],l=[];return Qr.convLngLatToSph([e,r,i],[t,n,o],a,s,l),Qr.pointSegDistSq3D(a[0],s[0],l[0],a[1],s[1],l[1],a[2],s[2],l[2])}:Qr.pointSegDistSq,i=t?Qr.signedAngleSph:Qr.signedAngle,a=0,s=0,l=0,c=0,u=0,h=-1,d=-1,p=[],f=[],m=e.getVertexData().zz;return e.forEachSegment((function(e,t,r,o){var g,y,_,v,b,w,x,S,E;if(g=r[e],y=o[e],_=r[t],v=o[t],e==d&&((S=i(r[h],o[h],g,y,_,v))>Math.PI&&(S=2*Math.PI-S),isNaN(S)||f.push(180*S/Math.PI)),h=e,d=t,m[e]<1/0&&s++,!((x=t-e-1)<1))if(a+=x,g==_&&y==v)l++;else{for(b=0;++e<t;)E=n(r[e],o[e],g,y,_,v),b=Math.max(b,E);w=Math.sqrt(b),u+=w,p.push(w),c=Math.max(c,w)}})),r={angleMean:0,displacementMean:0,displacementMax:c,collapsedRings:l,removed:a,retained:s,uniqueCount:Jb(e),removableCount:a+s},f.length>0&&(r.angleMean=o.sum(f)/f.length,r.angleQuartiles=[o.findValueByPct(f,.75),o.findValueByPct(f,.5),o.findValueByPct(f,.25)]),p.length>0&&(r.displacementMean=u/p.length,r.displacementQuartiles=[o.findValueByPct(p,.75),o.findValueByPct(p,.5),o.findValueByPct(p,.25)]),r}(e,i),s=(a.removed+a.collapsedRings)/a.uniqueCount||0,l=a.removed/a.removableCount||0,c=a.angleQuartiles,u=a.displacementQuartiles,h=["Simplification statistics"];h.push(o.format("Method: %s (%s) %s",n,i?"spherical":"planar","weighted_visvalingam"==r?"(weighting="+Ld.getWeightCoefficient(t)+")":"")),h.push(o.format("Removed vertices: %,d",a.removed+a.collapsedRings)),h.push(o.format("   %.1f% of %,d unique coordinate locations",100*s,a.uniqueCount)),h.push(o.format("   %.1f% of %,d filterable coordinate locations",100*l,a.removableCount)),h.push(o.format("Simplification threshold: %.4f %s",e.getRetainedInterval(),i?"meters":"")),h.push(o.format("Collapsed rings: %,d",a.collapsedRings)),h.push("Displacement statistics"),h.push(o.format("   Mean displacement: %.4f",a.displacementMean)),h.push(o.format("   Max displacement: %.4f",a.displacementMax)),u&&h.push(o.format("   Quartiles: %.2f, %.2f, %.2f",u[0],u[1],u[2])),h.push("Vertex angle statistics"),h.push(o.format("   Mean angle: %.2f degrees",a.angleMean)),c&&h.push(o.format("   Quartiles: %.2f, %.2f, %.2f",c[0],c[1],c[2])),v(h.join("\n   "))}function tw(e,t){var r=e.arcs;t.keep_shapes&&bv(r,e.layers),!t.no_repair&&r.getRetainedInterval()>0&&Fv(r),t.stats&&ew(r,t),e.info=o.defaults({simplify:t},e.info)}function rw(e,t){return t=t||{},o.defaults({method:ow(t),spherical:nw(e.arcs,t)},t)}function nw(e,t){return!t.planar&&!e.isPlanar()}function iw(e,t){var r=function(e){var t;"dp"==e.method?t=Md.calcArcData:"visvalingam"==e.method?t=Ld.getEffectiveAreaSimplifier(e.spherical):"weighted_visvalingam"==e.method?t=Ld.getWeightedSimplifier(e,e.spherical):_("Unsupported simplify method:",e.method);return t}(t);e.setThresholds(new Float64Array(e.getPointCount())),t.spherical?(!function(e,t){var r=o.expandoBuffer(Float64Array),n=o.expandoBuffer(Float64Array),i=o.expandoBuffer(Float64Array);e.forEach3((function(e,o,a,s){var l=e.length,c=r(l),u=n(l),h=i(l);Qr.convLngLatToSph(e,o,c,u,h),t(a,c,u,h)}))}(e,r),sw(e)):function(e,t){e.forEach3((function(e,r,n,i){t(n,e,r)}))}(e,r),t.lock_box&&function(e){var t=e.getBounds();t.padBounds(-1e-14,-1e-14,-1e-14,-1e-14),aw(e,t.toArray(),!0)}(e)}function ow(e){var t=e.method;return(!t||"weighted"==t||"visvalingam"==t&&e.weighting)&&(t="weighted_visvalingam"),t}function aw(e,t,r){var n=e.getBounds().toArray();!0!==Qr.containsBounds(t,n)&&e.forEach3((function(e,n,i){for(var o,a,s=r?1/0:0,l=0,c=i.length;l<c;l++)o=e[l],a=n[l],(o>=t[2]||o<=t[0]||a<=t[1]||a>=t[3])&&(0===s&&(s=lw(i)),i[l]!==1/0&&(i[l]=s))}))}function sw(e){aw(e,Jr(1e-12),!1)}function lw(e){for(var t,r=0,n=0,i=e.length;n<i;n++)(t=e[n])>r&&t<1/0&&(r=t);return r}function cw(e){var t,r,n;return o.isNumber(e)?(r=e,n=e):o.isString(e)&&(t=e.split(/[x ,]/),r=Number(t[0])||0,n=2==t.length?Number(t[1])||0:r),r>=0&&n>=0&&r+n>0||_("Invalid simplify resolution:",e),[r,n]}function uw(e,t,r,n){return 0!==e&&r/n>e/t||0===t?r/e:n/t}function hw(e,t,r){return uw(e,t,Qr.degreesToMeters(r.width())*Math.cos(r.centerY()*Qr.D2R),Qr.degreesToMeters(r.height()))}function dw(e,t,r){var n=da(t);return nw(t.arcs,r)?Js(e,n):el(e,n)}function pw(e,t,r){var n,i=cw(e),o=t.getBounds();return n=nw(t,r)?hw(i[0],i[1],o):uw(i[0],i[1],o.width(),o.height()),n*=.5}a.simplify=function(e,t){var r=e.arcs;if(r&&0!==r.size()){if(iw(r,t=rw(e,t)),t.percentage||0===t.percentage)r.setRetainedPct(o.parsePercent(t.percentage));else if(t.interval||0===t.interval)r.setRetainedInterval(dw(t.interval,e,t));else if(t.resolution)r.setRetainedInterval(pw(t.resolution,r,t));else{if(t.presimplify)return;_("Missing a simplification amount")}tw(e,t)}};var fw=Object.freeze({__proto__:null,calcPlanarInterval:uw,calcSphericalInterval:hw,convertSimplifyInterval:dw,convertSimplifyResolution:pw,finalizeSimplification:tw,getSimplifyMethod:ow,getStandardSimplifyOpts:rw,parseSimplifyResolution:cw,protectWorldEdges:sw,simplifyPaths:iw,useSphericalSimplify:nw});function mw(e,t){var r={target:t.name||""},n="with($$ctx) { return `"+e+"`; }";try{e=new Function("$$ctx",n)(r)}catch(qw){_("Unable to interpolate ["+e+"]")}return e}var gw=Object.freeze({__proto__:null,convertInterpolatedName:mw,convertSourceName:function(e,t){return function(e){return/[$][{]/.test(e)}(e)?((t.length>1||1!=t[0].layers.length)&&_("Interpolated names are not compatible with multiple targets."),mw(e,t[0].layers[0])):e},findCommandSource:function(e,t,r){var n,i=t.findSingleLayer(e);return i||((n=s_(e,o.defaults({no_topology:!0},r)))?n.layers.length>1&&_("Multiple-layer sources are not supported"):_(o.format("Unable to find source [%s]",e)),i={dataset:n,layer:n.layers[0],disposable:!0}),i}});function yw(e,t){var r;return t?e.data&&e.data.fieldExists(t)?function(r){var n=e.data.getRecords()[r];return n?_w(n[t]):""}:(e={name:e.name,data:e.data},r=Ns(t,e,null),function(e){return _w(r(e))}):function(t){return(e&&e.name||"split")+"-"+(t+1)}}function _w(e){return String(e)}a.splitLayer=function(e,t,r){var n,i,a,s=r||{},l=s.no_replace?co(e):e,c=l.data?l.data.getRecords():null,u=l.shapes,h={},d=[],p=Ki(l);return s.ids?(i=s.ids,a=new Set(i),n=function(e){return a.has(e)?"1":"2"}):n=yw(l,t),0===p?[l]:(o.repeat(p,(function(e){var t,r=n(e);r in h==!1?(h[r]=d.length,t={geometry_type:l.geometry_type,name:r,data:c?new Fi:null,shapes:u?[]:null},d.push(t)):t=d[h[r]],u&&t.shapes.push(u[e]),c&&t.data.getRecords().push(c[e])})),d)};var vw=Object.freeze({__proto__:null,getSplitNameFunction:yw}),bw={};function ww(e){return new Promise((t=>setTimeout(t,e)))}async function xw(e,t){var r=new FileReader;r.addEventListener("loadend",(function(e){r.result?t(null,r.result):t(new Error)})),bw.isImportableAsBinary(e.name)?r.readAsArrayBuffer(e):r.readAsText(e,"UTF-8")}async function Sw(e){try{return{content:await o.promisify(xw)(e),name:e.name}}catch(qw){throw Error(`Browser was unable to load the file ${e.name}`)}}async function Ew(e){var t=e.name.replace(/\.gz$/,"");return await ww(35),[{name:t,content:bw.gunzipSync(e.content,t)}]}async function Tw(e){var t=await o.promisify(bw.unzipAsync)(e.content);return Object.keys(t).reduce((function(e,r){return/\.txt$/i.test(r)||e.push({name:r,content:t[r]}),e}),[])}async function Aw(e){var t=await Tw(e);return"doc.kml"==(t[0]&&t[0].name)&&(t[0].name=bw.replaceFileExtension(e.name,"kml")),t}function Cw(e){return bw.guessInputType(e.name,e.content)}function Iw(e,t){return e+"."+t}function kw(e){return bw.getFileBase(e.name).toLowerCase()}function Pw(e,t){var r=t.name?[t.name]:null;function n(t){var r=Iw(t,"shp");return e.some((e=>function(e){return Iw(kw(e),Cw(e))}(e)==r))}e.forEach((e=>{var t,r=kw(e),i=Cw(e);"shp"!=i&&(t=e.name,/\.(shp|shx|dbf|prj|cpg)$/i.test(t))?n(r)?e.group=Iw(r,"shp"):"dbf"==i?(e.filename=e.name,e.group=Iw(r,"dbf")):e.group=null:(e.group=Iw(r,i),e.filename=e.name)}));var i={},o=[];return e.forEach((e=>{if(e.group){var t=i[e.group];t||((t={}).layername=r?r[o.length]||r[r.length-1]:null,o.push(t),i[e.group]=t),t.size=(t.size||0)+function(e){return e.content.byteLength||e.content.length}(e),t[Cw(e)]={filename:e.name,content:e.content},e.filename&&(t.filename=e.filename)}})),o}async function Mw(e,t,r){var n=bw.importContent(e,t);return!function(e){return e.layers.every((function(e){return 0===bw.getFeatureCount(e)}))}(n)&&(e.layername&&n.layers.forEach((t=>t.name=e.layername)),r.push({dataset:n,layername:e.layername||e.filename}),!0)}async function Rw(e=[]){var t=e;try{if(t.length>0){return await async function(e,t){var r=Pw(e,t);e=null;let n=[];for(var i of r)i.size>4e7&&await ww(35),await Mw(i,t,n);return n}(t,{})}}catch(qw){}}function Dw(e,t){const r=window.URL||window.webkitURL||window,n=new Blob([e]),i=r.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=t,document.body.appendChild(o),o.click(),r.revokeObjectURL(i),setTimeout((function(){r.revokeObjectURL(i),document.body.removeChild(o)}),400)}function Ow(e,t){Fg(t,(function(t,r){if(t)throw t;Dw(new Blob([r]),e)}))}function Lw(e,t,r=!0,n="test.zip"){const i=Mg(e,{format:t}),o=e.layers[0].name||"layer";if("shapefile"===t&&i.push({content:"UTF-8",filename:`${o}.cpg`}),r){Ow(n??"test.zip",i)}else i.forEach((e=>{Dw(e.content,e.filename)}))}bw.svg=Object.assign({},Du,gl,Uh,Ah,Rh),Object.assign(bw,{Dbf:Gh,DbfReader:Pd,DouglasPeucker:Md,parseGeoJSON:np,geojson:yl,json:{parse:function(e){var t=xp(G(e)?new _d(e):e,0);sp(t);var r=pp(t);return sp(t),t.peek()!=Xd&&op(t.peek(),t.index()),r}},ShpType:Rd,topojson:Dd,Visvalingam:Ld,ArcCollection:Oo,Bounds:St,clipIterByBounds:function(e,t){for(var r,n,i,o,a=[],s=function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin]]}(t);e.hasNext();)Nd(a,n,r=[e.x,e.y],s),n=r,i||(i=r);return(o=Bd(i,r))&&a.length>0&&!Bd(a[0],a[a.length-1])&&a.push(a[0].concat()),(o&&a.length<4||a.length<2)&&(a=[]),a},DataTable:Fi,editArcs:Vd,Heap:Od,IdLookupIndex:function(e){var t=new Uint32Array(e);this.setId=function(r,n){r>=0&&n>=0&&n<e-1?t[r]=n+1:y("Invalid value")},this.hasId=function(e){return this.getId(e)>-1},this.getId=function(r){return r>=0&&r<e?t[r]-1:-1}},NodeCollection:Bo,parseDMS:hs,formatDMS:ps,PathIndex:Cl,PolygonIndex:Al,ShpReader:Yd,Transform:xt}),Object.assign(bw,lc,ic,Sp,jp,kp,mc,Xo,zi,Gp,nf,vf,pf,pd,Si,wf,Bg,qs,Gs,Zg,u_,fu,bd,Hf,p_,w_,Cu,ay,Pg,o_,M_,Vc,vv,uc,D_,N_,py,Df,Ev,nn,yo,Dv,Aa,Jc,Xf,Mp,Lv,To,Dl,Xl,Nl,Jg,Pc,Sr,H_,nv,cn,xc,ru,Rc,Wc,Bv,zv,Xc,Tp,Hv,Qb,_a,Wb,ob,ji,us,Kr,Na,Po,_n,Zd,Ef,ty,fw,vs,Do,tc,Vr,gw,vw,g,Bl,sh,Sh,Ms,kf,ly,So,il,Vu,Hu,Xa,Vg);const Bw={};function $w(e,t){const r=ca(t);Bw[e]=r}async function zw(e,t=void 0,r="https://epsg.gis.digsur.com/epsg/"){const n=e.toUpperCase();if(void 0===Bw["EPSG:4326"]&&($w("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs +type=crs"),$w("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs +type=crs"),$w("EPSG:4490","+proj=longlat +ellps=GRS80 +no_defs +type=crs")),t){const e=ca(t);return Bw[n]=e,e}{const e=Bw[n];if(e)return e;if(r){const e=n.trim().substring(5),t=await fetch(r+e);if(!t.ok)return;const i=await t.json(),o=ca(i.prj4||i.wkt);return Bw[n]=o,o}}}var Fw={import2DFiles:async function(e){if(0===e.length)return;const t=Array.from(e);var r=function(e){return Array.from(e).map((function(e){return e.name}))}(t),n=[];try{n=await async function(e){var t,r=[];for(var n of e){var i=await Sw(n);t=bw.isGzipFile(n.name)?await Ew(i):bw.isZipFile(n.name)?await Tw(i):bw.isKmzFile(n.name)?await Aw(i):[i],r=r.concat(t)}return e.length=0,r}(t)}catch(qw){return}let i=[];if(i=function(e,t=[]){var r={};return t.concat(e).reduce((function(e,t){return bw.looksLikeContentFile(t.name)&&t.name in r==0&&(r[t.name]=!0,e.push(t)),e}),[])}(n,i),0===i.length){r.join(", ");return}return await Rw(i)},saveZipFile:Ow,saveDataset:Lw,saveDatasetFromGeojson:function(e,t,r=!0,n="test.zip"){Lw(ry(e,{}),t,r,n)},getProj:zw,transformDataset:async function(e,t="EPSG:4326",r="EPSG:3857",n={}){return Zb(e,await zw(t),await zw(r),n),e}};Object.assign(Fw,{cli:md,cmd:a,geom:Qr,utils:o,internal:bw}),e.exports?e.exports=Fw:"object"==typeof window&&window&&(window.data2d=Fw)}(mapshaper)),mapshaper.exports}var mapshaperExports=requireMapshaper();const sides=["top","right","bottom","left"],alignments=["start","end"],placements=sides.reduce(((e,t)=>e.concat(t,t+"-"+alignments[0],t+"-"+alignments[1])),[]),min=Math.min,max=Math.max,oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(e,t,r){return max(e,min(t,r))}function evaluate(e,t){return"function"==typeof e?e(t):e}function getSide(e){return e.split("-")[0]}function getAlignment(e){return e.split("-")[1]}function getOppositeAxis(e){return"x"===e?"y":"x"}function getAxisLength(e){return"y"===e?"height":"width"}function getSideAxis(e){return["top","bottom"].includes(getSide(e))?"y":"x"}function getAlignmentAxis(e){return getOppositeAxis(getSideAxis(e))}function getAlignmentSides(e,t,r){void 0===r&&(r=!1);const n=getAlignment(e),i=getAlignmentAxis(e),o=getAxisLength(i);let a="x"===i?n===(r?"end":"start")?"right":"left":"start"===n?"bottom":"top";return t.reference[o]>t.floating[o]&&(a=getOppositePlacement(a)),[a,getOppositePlacement(a)]}function getExpandedPlacements(e){const t=getOppositePlacement(e);return[getOppositeAlignmentPlacement(e),t,getOppositeAlignmentPlacement(t)]}function getOppositeAlignmentPlacement(e){return e.replace(/start|end/g,(e=>oppositeAlignmentMap[e]))}function getSideList(e,t,r){const n=["left","right"],i=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return r?t?i:n:t?n:i;case"left":case"right":return t?o:a;default:return[]}}function getOppositeAxisPlacements(e,t,r,n){const i=getAlignment(e);let o=getSideList(getSide(e),"start"===r,n);return i&&(o=o.map((e=>e+"-"+i)),t&&(o=o.concat(o.map(getOppositeAlignmentPlacement)))),o}function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,(e=>oppositeSideMap[e]))}function expandPaddingObject(e){return{top:0,right:0,bottom:0,left:0,...e}}function getPaddingObject(e){return"number"!=typeof e?expandPaddingObject(e):{top:e,right:e,bottom:e,left:e}}function rectToClientRect(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function computeCoordsFromPlacement(e,t,r){let{reference:n,floating:i}=e;const o=getSideAxis(t),a=getAlignmentAxis(t),s=getAxisLength(a),l=getSide(t),c="y"===o,u=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,d=n[s]/2-i[s]/2;let p;switch(l){case"top":p={x:u,y:n.y-i.height};break;case"bottom":p={x:u,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:h};break;case"left":p={x:n.x-i.width,y:h};break;default:p={x:n.x,y:n.y}}switch(getAlignment(t)){case"start":p[a]-=d*(r&&c?-1:1);break;case"end":p[a]+=d*(r&&c?-1:1)}return p}const computePosition=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:o=[],platform:a}=r,s=o.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:h}=computeCoordsFromPlacement(c,n,l),d=n,p={},f=0;for(let m=0;m<s.length;m++){const{name:r,fn:o}=s[m],{x:g,y:y,data:_,reset:v}=await o({x:u,y:h,initialPlacement:n,placement:d,strategy:i,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=null!=g?g:u,h=null!=y?y:h,p={...p,[r]:{...p[r],..._}},v&&f<=50&&(f++,"object"==typeof v&&(v.placement&&(d=v.placement),v.rects&&(c=!0===v.rects?await a.getElementRects({reference:e,floating:t,strategy:i}):v.rects),({x:u,y:h}=computeCoordsFromPlacement(c,d,l))),m=-1)}return{x:u,y:h,placement:d,strategy:i,middlewareData:p}};async function detectOverflow(e,t){var r;void 0===t&&(t={});const{x:n,y:i,platform:o,rects:a,elements:s,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=evaluate(t,e),f=getPaddingObject(p),m=s[d?"floating"===h?"reference":"floating":h],g=rectToClientRect(await o.getClippingRect({element:null==(r=await(null==o.isElement?void 0:o.isElement(m)))||r?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(s.floating)),boundary:c,rootBoundary:u,strategy:l})),y="floating"===h?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,_=await(null==o.getOffsetParent?void 0:o.getOffsetParent(s.floating)),v=await(null==o.isElement?void 0:o.isElement(_))&&await(null==o.getScale?void 0:o.getScale(_))||{x:1,y:1},b=rectToClientRect(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:_,strategy:l}):y);return{top:(g.top-b.top+f.top)/v.y,bottom:(b.bottom-g.bottom+f.bottom)/v.y,left:(g.left-b.left+f.left)/v.x,right:(b.right-g.right+f.right)/v.x}}const arrow=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:o,platform:a,elements:s,middlewareData:l}=t,{element:c,padding:u=0}=evaluate(e,t)||{};if(null==c)return{};const h=getPaddingObject(u),d={x:r,y:n},p=getAlignmentAxis(i),f=getAxisLength(p),m=await a.getDimensions(c),g="y"===p,y=g?"top":"left",_=g?"bottom":"right",v=g?"clientHeight":"clientWidth",b=o.reference[f]+o.reference[p]-d[p]-o.floating[f],w=d[p]-o.reference[p],x=await(null==a.getOffsetParent?void 0:a.getOffsetParent(c));let S=x?x[v]:0;S&&await(null==a.isElement?void 0:a.isElement(x))||(S=s.floating[v]||o.floating[f]);const E=b/2-w/2,T=S/2-m[f]/2-1,A=min(h[y],T),C=min(h[_],T),I=A,k=S-m[f]-C,P=S/2-m[f]/2+E,M=clamp(I,P,k),R=!l.arrow&&null!=getAlignment(i)&&P!==M&&o.reference[f]/2-(P<I?A:C)-m[f]/2<0,D=R?P<I?P-I:P-k:0;return{[p]:d[p]+D,data:{[p]:M,centerOffset:P-M-D,...R&&{alignmentOffset:D}},reset:R}}});function getPlacementList(e,t,r){return(e?[...r.filter((t=>getAlignment(t)===e)),...r.filter((t=>getAlignment(t)!==e))]:r.filter((e=>getSide(e)===e))).filter((r=>!e||(getAlignment(r)===e||!!t&&getOppositeAlignmentPlacement(r)!==r)))}const autoPlacement=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var r,n,i;const{rects:o,middlewareData:a,placement:s,platform:l,elements:c}=t,{crossAxis:u=!1,alignment:h,allowedPlacements:d=placements,autoAlignment:p=!0,...f}=evaluate(e,t),m=void 0!==h||d===placements?getPlacementList(h||null,p,d):d,g=await detectOverflow(t,f),y=(null==(r=a.autoPlacement)?void 0:r.index)||0,_=m[y];if(null==_)return{};const v=getAlignmentSides(_,o,await(null==l.isRTL?void 0:l.isRTL(c.floating)));if(s!==_)return{reset:{placement:m[0]}};const b=[g[getSide(_)],g[v[0]],g[v[1]]],w=[...(null==(n=a.autoPlacement)?void 0:n.overflows)||[],{placement:_,overflows:b}],x=m[y+1];if(x)return{data:{index:y+1,overflows:w},reset:{placement:x}};const S=w.map((e=>{const t=getAlignment(e.placement);return[e.placement,t&&u?e.overflows.slice(0,2).reduce(((e,t)=>e+t),0):e.overflows[0],e.overflows]})).sort(((e,t)=>e[1]-t[1])),E=(null==(i=S.filter((e=>e[2].slice(0,getAlignment(e[0])?2:3).every((e=>e<=0))))[0])?void 0:i[0])||S[0][0];return E!==s?{data:{index:y+1,overflows:w},reset:{placement:E}}:{}}}},flip=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:o,rects:a,initialPlacement:s,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=evaluate(e,t);if(null!=(r=o.arrow)&&r.alignmentOffset)return{};const y=getSide(i),_=getSideAxis(s),v=getSide(s)===s,b=await(null==l.isRTL?void 0:l.isRTL(c.floating)),w=d||(v||!m?[getOppositePlacement(s)]:getExpandedPlacements(s)),x="none"!==f;!d&&x&&w.push(...getOppositeAxisPlacements(s,m,f,b));const S=[s,...w],E=await detectOverflow(t,g),T=[];let A=(null==(n=o.flip)?void 0:n.overflows)||[];if(u&&T.push(E[y]),h){const e=getAlignmentSides(i,a,b);T.push(E[e[0]],E[e[1]])}if(A=[...A,{placement:i,overflows:T}],!T.every((e=>e<=0))){var C,I;const e=((null==(C=o.flip)?void 0:C.index)||0)+1,t=S[e];if(t)return{data:{index:e,overflows:A},reset:{placement:t}};let r=null==(I=A.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:I.placement;if(!r)switch(p){case"bestFit":{var k;const e=null==(k=A.filter((e=>{if(x){const t=getSideAxis(e.placement);return t===_||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:k[0];e&&(r=e);break}case"initialPlacement":r=s}if(i!==r)return{reset:{placement:r}}}return{}}}};async function convertValueToCoords(e,t){const{placement:r,platform:n,elements:i}=e,o=await(null==n.isRTL?void 0:n.isRTL(i.floating)),a=getSide(r),s=getAlignment(r),l="y"===getSideAxis(r),c=["left","top"].includes(a)?-1:1,u=o&&l?-1:1,h=evaluate(t,e);let{mainAxis:d,crossAxis:p,alignmentAxis:f}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return s&&"number"==typeof f&&(p="end"===s?-1*f:f),l?{x:p*u,y:d*c}:{x:d*c,y:p*u}}const offset=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:o,placement:a,middlewareData:s}=t,l=await convertValueToCoords(t,e);return a===(null==(r=s.offset)?void 0:r.placement)&&null!=(n=s.arrow)&&n.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:a}}}}},shift=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...l}=evaluate(e,t),c={x:r,y:n},u=await detectOverflow(t,l),h=getSideAxis(getSide(i)),d=getOppositeAxis(h);let p=c[d],f=c[h];if(o){const e="y"===d?"bottom":"right";p=clamp(p+u["y"===d?"top":"left"],p,p-u[e])}if(a){const e="y"===h?"bottom":"right";f=clamp(f+u["y"===h?"top":"left"],f,f-u[e])}const m=s.fn({...t,[d]:p,[h]:f});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[d]:o,[h]:a}}}}}},size=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:o,platform:a,elements:s}=t,{apply:l=()=>{},...c}=evaluate(e,t),u=await detectOverflow(t,c),h=getSide(i),d=getAlignment(i),p="y"===getSideAxis(i),{width:f,height:m}=o.floating;let g,y;"top"===h||"bottom"===h?(g=h,y=d===(await(null==a.isRTL?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(y=h,g="end"===d?"top":"bottom");const _=m-u.top-u.bottom,v=f-u.left-u.right,b=min(m-u[g],_),w=min(f-u[y],v),x=!t.middlewareData.shift;let S=b,E=w;if(null!=(r=t.middlewareData.shift)&&r.enabled.x&&(E=v),null!=(n=t.middlewareData.shift)&&n.enabled.y&&(S=_),x&&!d){const e=max(u.left,0),t=max(u.right,0),r=max(u.top,0),n=max(u.bottom,0);p?E=f-2*(0!==e||0!==t?e+t:max(u.left,u.right)):S=m-2*(0!==r||0!==n?r+n:max(u.top,u.bottom))}await l({...t,availableWidth:E,availableHeight:S});const T=await a.getDimensions(s.floating);return f!==T.width||m!==T.height?{reset:{rects:!0}}:{}}}};function n$1(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function o(e){return n$1(e).getComputedStyle(e)}const i=Math.min,r=Math.max,l=Math.round;function c$1(e){const t=o(e);let r=parseFloat(t.width),n=parseFloat(t.height);const i=e.offsetWidth,a=e.offsetHeight,s=l(r)!==i||l(n)!==a;return s&&(r=i,n=a),{width:r,height:n,fallback:s}}function s(e){return h$1(e)?(e.nodeName||"").toLowerCase():""}let f;function u(){if(f)return f;const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?(f=e.brands.map((e=>e.brand+"/"+e.version)).join(" "),f):navigator.userAgent}function a(e){return e instanceof n$1(e).HTMLElement}function d$1(e){return e instanceof n$1(e).Element}function h$1(e){return e instanceof n$1(e).Node}function p(e){return"undefined"!=typeof ShadowRoot&&(e instanceof n$1(e).ShadowRoot||e instanceof ShadowRoot)}function g$1(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=o(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function m$1(e){return["table","td","th"].includes(s(e))}function y$1(e){const t=/firefox/i.test(u()),r=o(e),n=r.backdropFilter||r.WebkitBackdropFilter;return"none"!==r.transform||"none"!==r.perspective||!!n&&"none"!==n||t&&"filter"===r.willChange||t&&!!r.filter&&"none"!==r.filter||["transform","perspective"].some((e=>r.willChange.includes(e)))||["paint","layout","strict","content"].some((e=>{const t=r.contain;return null!=t&&t.includes(e)}))}function x$1(){return!/^((?!chrome|android).)*safari/i.test(u())}function w(e){return["html","body","#document"].includes(s(e))}function v(e){return d$1(e)?e:e.contextElement}const b$1={x:1,y:1};function L(e){const t=v(e);if(!a(t))return b$1;const r=t.getBoundingClientRect(),{width:n,height:i,fallback:o}=c$1(t);let s=(o?l(r.width):r.width)/n,c=(o?l(r.height):r.height)/i;return s&&Number.isFinite(s)||(s=1),c&&Number.isFinite(c)||(c=1),{x:s,y:c}}function E$1(e,t,r,n){var i,o;void 0===t&&(t=!1),void 0===r&&(r=!1);const a=e.getBoundingClientRect(),s=v(e);let l=b$1;t&&(n?d$1(n)&&(l=L(n)):l=L(e));const c=s?n$1(s):window,u=!x$1()&&r;let h=(a.left+(u&&(null==(i=c.visualViewport)?void 0:i.offsetLeft)||0))/l.x,d=(a.top+(u&&(null==(o=c.visualViewport)?void 0:o.offsetTop)||0))/l.y,p=a.width/l.x,f=a.height/l.y;if(s){const e=n$1(s),t=n&&d$1(n)?n$1(n):n;let r=e.frameElement;for(;r&&n&&t!==e;){const e=L(r),t=r.getBoundingClientRect(),n=getComputedStyle(r);t.x+=(r.clientLeft+parseFloat(n.paddingLeft))*e.x,t.y+=(r.clientTop+parseFloat(n.paddingTop))*e.y,h*=e.x,d*=e.y,p*=e.x,f*=e.y,h+=t.x,d+=t.y,r=n$1(r).frameElement}}return{width:p,height:f,top:d,right:h+p,bottom:d+f,left:h,x:h,y:d}}function R(e){return((h$1(e)?e.ownerDocument:e.document)||window.document).documentElement}function T(e){return d$1(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function C$1(e){return E$1(R(e)).left+T(e).scrollLeft}function F(e){if("html"===s(e))return e;const t=e.assignedSlot||e.parentNode||p(e)&&e.host||R(e);return p(t)?t.host:t}function W(e){const t=F(e);return w(t)?t.ownerDocument.body:a(t)&&g$1(t)?t:W(t)}function D(e,t){var r;void 0===t&&(t=[]);const n=W(e),i=n===(null==(r=e.ownerDocument)?void 0:r.body),o=n$1(n);return i?t.concat(o,o.visualViewport||[],g$1(n)?n:[]):t.concat(n,D(n))}function S$1(e,t,n){return"viewport"===t?rectToClientRect(function(e,t){const r=n$1(e),n=R(e),i=r.visualViewport;let o=n.clientWidth,a=n.clientHeight,s=0,l=0;if(i){o=i.width,a=i.height;const e=x$1();(e||!e&&"fixed"===t)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:o,height:a,x:s,y:l}}(e,n)):d$1(t)?rectToClientRect(function(e,t){const r=E$1(e,!0,"fixed"===t),n=r.top+e.clientTop,i=r.left+e.clientLeft,o=a(e)?L(e):{x:1,y:1};return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:i*o.x,y:n*o.y}}(t,n)):rectToClientRect(function(e){const t=R(e),n=T(e),i=e.ownerDocument.body,a=r(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=r(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let l=-n.scrollLeft+C$1(e);const c=-n.scrollTop;return"rtl"===o(i).direction&&(l+=r(t.clientWidth,i.clientWidth)-a),{width:a,height:s,x:l,y:c}}(R(e)))}function A(e){return a(e)&&"fixed"!==o(e).position?e.offsetParent:null}function H$1(e){const t=n$1(e);let r=A(e);for(;r&&m$1(r)&&"static"===o(r).position;)r=A(r);return r&&("html"===s(r)||"body"===s(r)&&"static"===o(r).position&&!y$1(r))?t:r||function(e){let t=F(e);for(;a(t)&&!w(t);){if(y$1(t))return t;t=F(t)}return null}(e)||t}function O(e,t,r){const n=a(t),i=R(t),o=E$1(e,!0,"fixed"===r,t);let l={scrollLeft:0,scrollTop:0};const c={x:0,y:0};if(n||!n&&"fixed"!==r)if(("body"!==s(t)||g$1(i))&&(l=T(t)),a(t)){const e=E$1(t,!0);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else i&&(c.x=C$1(i));return{x:o.left+l.scrollLeft-c.x,y:o.top+l.scrollTop-c.y,width:o.width,height:o.height}}const P={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:a,strategy:l}=e;const c=[..."clippingAncestors"===n?function(e,t){const r=t.get(e);if(r)return r;let n=D(e).filter((e=>d$1(e)&&"body"!==s(e))),i=null;const a="fixed"===o(e).position;let l=a?F(e):e;for(;d$1(l)&&!w(l);){const e=o(l),t=y$1(l);(a?t||i:t||"static"!==e.position||!i||!["absolute","fixed"].includes(i.position))?i=e:n=n.filter((e=>e!==l)),l=F(l)}return t.set(e,n),n}(t,this._c):[].concat(n),a],u=c[0],h=c.reduce(((e,n)=>{const o=S$1(t,n,l);return e.top=r(o.top,e.top),e.right=i(o.right,e.right),e.bottom=i(o.bottom,e.bottom),e.left=r(o.left,e.left),e}),S$1(t,u,l));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:n}=e;const i=a(r),o=R(r);if(r===o)return t;let l={scrollLeft:0,scrollTop:0},c={x:1,y:1};const u={x:0,y:0};if((i||!i&&"fixed"!==n)&&(("body"!==s(r)||g$1(o))&&(l=T(r)),a(r))){const e=E$1(r);c=L(r),u.x=e.x+r.clientLeft,u.y=e.y+r.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x,y:t.y*c.y-l.scrollTop*c.y+u.y}},isElement:d$1,getDimensions:function(e){return a(e)?c$1(e):e.getBoundingClientRect()},getOffsetParent:H$1,getDocumentElement:R,getScale:L,async getElementRects(e){let{reference:t,floating:r,strategy:n}=e;const i=this.getOffsetParent||H$1,o=this.getDimensions;return{reference:O(t,await i(r),n),floating:{x:0,y:0,...await o(r)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===o(e).direction},B$1=(e,t,r)=>{const n=new Map,i={platform:P,...r},o={...i.platform,_c:n};return computePosition(e,t,{...i,platform:o})},h={disabled:!1,distance:5,skidding:0,container:"body",boundary:void 0,instantMove:!1,disposeTimeout:150,popperTriggers:[],strategy:"absolute",preventOverflow:!0,flip:!0,shift:!0,overflowPadding:0,arrowPadding:0,arrowOverflow:!0,autoHideOnMousedown:!1,themes:{tooltip:{placement:"top",triggers:["hover","focus","touch"],hideTriggers:e=>[...e,"click"],delay:{show:200,hide:0},handleResize:!1,html:!1,loadingContent:"..."},dropdown:{placement:"bottom",triggers:["click"],delay:0,handleResize:!0,autoHide:!0},menu:{$extend:"dropdown",triggers:["hover","focus"],popperTriggers:["hover"],delay:{show:0,hide:400}}}};function S(e,t){let r,n=h.themes[e]||{};do{r=n[t],typeof r>"u"?n.$extend?n=h.themes[n.$extend]||{}:(n=null,r=h[t]):n=null}while(n);return r}function Ze(e){const t=[e];let r=h.themes[e]||{};do{r.$extend&&!r.$resetCss?(t.push(r.$extend),r=h.themes[r.$extend]||{}):r=null}while(r);return t.map((e=>`v-popper--theme-${e}`))}function re$1(e){const t=[e];let r=h.themes[e]||{};do{r.$extend?(t.push(r.$extend),r=h.themes[r.$extend]||{}):r=null}while(r);return t}let $=!1;if(typeof window<"u"){$=!1;try{const e=Object.defineProperty({},"passive",{get(){$=!0}});window.addEventListener("test",null,e)}catch{}}let _e=!1;typeof window<"u"&&typeof navigator<"u"&&(_e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream);const Te=["auto","top","bottom","left","right"].reduce(((e,t)=>e.concat([t,`${t}-start`,`${t}-end`])),[]),pe={hover:"mouseenter",focus:"focus",click:"click",touch:"touchstart",pointer:"pointerdown"},ae={hover:"mouseleave",focus:"blur",click:"click",touch:"touchend",pointer:"pointerup"};function de(e,t){const r=e.indexOf(t);-1!==r&&e.splice(r,1)}function G(){return new Promise((e=>requestAnimationFrame((()=>{requestAnimationFrame(e)}))))}const d=[];let g=null;const le$1={};function he(e){let t=le$1[e];return t||(t=le$1[e]=[]),t}let Y=function(){};function n(e){return function(t){return S(t.theme,e)}}typeof window<"u"&&(Y=window.Element);const q="__floating-vue__popper",Q=()=>defineComponent({name:"VPopper",provide(){return{[q]:{parentPopper:this}}},inject:{[q]:{default:null}},props:{theme:{type:String,required:!0},targetNodes:{type:Function,required:!0},referenceNode:{type:Function,default:null},popperNode:{type:Function,required:!0},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:n("disabled")},positioningDisabled:{type:Boolean,default:n("positioningDisabled")},placement:{type:String,default:n("placement"),validator:e=>Te.includes(e)},delay:{type:[String,Number,Object],default:n("delay")},distance:{type:[Number,String],default:n("distance")},skidding:{type:[Number,String],default:n("skidding")},triggers:{type:Array,default:n("triggers")},showTriggers:{type:[Array,Function],default:n("showTriggers")},hideTriggers:{type:[Array,Function],default:n("hideTriggers")},popperTriggers:{type:Array,default:n("popperTriggers")},popperShowTriggers:{type:[Array,Function],default:n("popperShowTriggers")},popperHideTriggers:{type:[Array,Function],default:n("popperHideTriggers")},container:{type:[String,Object,Y,Boolean],default:n("container")},boundary:{type:[String,Y],default:n("boundary")},strategy:{type:String,validator:e=>["absolute","fixed"].includes(e),default:n("strategy")},autoHide:{type:[Boolean,Function],default:n("autoHide")},handleResize:{type:Boolean,default:n("handleResize")},instantMove:{type:Boolean,default:n("instantMove")},eagerMount:{type:Boolean,default:n("eagerMount")},popperClass:{type:[String,Array,Object],default:n("popperClass")},computeTransformOrigin:{type:Boolean,default:n("computeTransformOrigin")},autoMinSize:{type:Boolean,default:n("autoMinSize")},autoSize:{type:[Boolean,String],default:n("autoSize")},autoMaxSize:{type:Boolean,default:n("autoMaxSize")},autoBoundaryMaxSize:{type:Boolean,default:n("autoBoundaryMaxSize")},preventOverflow:{type:Boolean,default:n("preventOverflow")},overflowPadding:{type:[Number,String],default:n("overflowPadding")},arrowPadding:{type:[Number,String],default:n("arrowPadding")},arrowOverflow:{type:Boolean,default:n("arrowOverflow")},flip:{type:Boolean,default:n("flip")},shift:{type:Boolean,default:n("shift")},shiftCrossAxis:{type:Boolean,default:n("shiftCrossAxis")},noAutoFocus:{type:Boolean,default:n("noAutoFocus")},disposeTimeout:{type:Number,default:n("disposeTimeout")}},emits:{show:()=>!0,hide:()=>!0,"update:shown":e=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},data(){return{isShown:!1,isMounted:!1,skipTransition:!1,classes:{showFrom:!1,showTo:!1,hideFrom:!1,hideTo:!0},result:{x:0,y:0,placement:"",strategy:this.strategy,arrow:{x:0,y:0,centerOffset:0},transformOrigin:null},randomId:`popper_${[Math.random(),Date.now()].map((e=>e.toString(36).substring(2,10))).join("_")}`,shownChildren:new Set,lastAutoHide:!0,pendingHide:!1,containsGlobalTarget:!1,isDisposed:!0,mouseDownContains:!1}},computed:{popperId(){return null!=this.ariaId?this.ariaId:this.randomId},shouldMountContent(){return this.eagerMount||this.isMounted},slotData(){return{popperId:this.popperId,isShown:this.isShown,shouldMountContent:this.shouldMountContent,skipTransition:this.skipTransition,autoHide:"function"==typeof this.autoHide?this.lastAutoHide:this.autoHide,show:this.show,hide:this.hide,handleResize:this.handleResize,onResize:this.onResize,classes:{...this.classes,popperClass:this.popperClass},result:this.positioningDisabled?null:this.result,attrs:this.$attrs}},parentPopper(){var e;return null==(e=this[q])?void 0:e.parentPopper},hasPopperShowTriggerHover(){var e,t;return(null==(e=this.popperTriggers)?void 0:e.includes("hover"))||(null==(t=this.popperShowTriggers)?void 0:t.includes("hover"))}},watch:{shown:"$_autoShowHide",disabled(e){e?this.dispose():this.init()},async container(){this.isShown&&(this.$_ensureTeleport(),await this.$_computePosition())},triggers:{handler:"$_refreshListeners",deep:!0},positioningDisabled:"$_refreshListeners",...["placement","distance","skidding","boundary","strategy","overflowPadding","arrowPadding","preventOverflow","shift","shiftCrossAxis","flip"].reduce(((e,t)=>(e[t]="$_computePosition",e)),{})},created(){this.autoMinSize,this.autoMaxSize},mounted(){this.init(),this.$_detachPopperNode()},activated(){this.$_autoShowHide()},deactivated(){this.hide()},beforeUnmount(){this.dispose()},methods:{show({event:e=null,skipDelay:t=!1,force:r=!1}={}){var n,i;null!=(n=this.parentPopper)&&n.lockedChild&&this.parentPopper.lockedChild!==this||(this.pendingHide=!1,(r||!this.disabled)&&((null==(i=this.parentPopper)?void 0:i.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.$_scheduleShow(e,t),this.$emit("show"),this.$_showFrameLocked=!0,requestAnimationFrame((()=>{this.$_showFrameLocked=!1}))),this.$emit("update:shown",!0))},hide({event:e=null,skipDelay:t=!1}={}){var r;if(!this.$_hideInProgress){if(this.shownChildren.size>0)return void(this.pendingHide=!0);if(this.hasPopperShowTriggerHover&&this.$_isAimingPopper())return void(this.parentPopper&&(this.parentPopper.lockedChild=this,clearTimeout(this.parentPopper.lockedChildTimer),this.parentPopper.lockedChildTimer=setTimeout((()=>{this.parentPopper.lockedChild===this&&(this.parentPopper.lockedChild.hide({skipDelay:t}),this.parentPopper.lockedChild=null)}),1e3)));(null==(r=this.parentPopper)?void 0:r.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.pendingHide=!1,this.$_scheduleHide(e,t),this.$emit("hide"),this.$emit("update:shown",!1)}},init(){var e;this.isDisposed&&(this.isDisposed=!1,this.isMounted=!1,this.$_events=[],this.$_preventShow=!1,this.$_referenceNode=(null==(e=this.referenceNode)?void 0:e.call(this))??this.$el,this.$_targetNodes=this.targetNodes().filter((e=>e.nodeType===e.ELEMENT_NODE)),this.$_popperNode=this.popperNode(),this.$_innerNode=this.$_popperNode.querySelector(".v-popper__inner"),this.$_arrowNode=this.$_popperNode.querySelector(".v-popper__arrow-container"),this.$_swapTargetAttrs("title","data-original-title"),this.$_detachPopperNode(),this.triggers.length&&this.$_addEventListeners(),this.shown&&this.show())},dispose(){this.isDisposed||(this.isDisposed=!0,this.$_removeEventListeners(),this.hide({skipDelay:!0}),this.$_detachPopperNode(),this.isMounted=!1,this.isShown=!1,this.$_updateParentShownChildren(!1),this.$_swapTargetAttrs("data-original-title","title"))},async onResize(){this.isShown&&(await this.$_computePosition(),this.$emit("resize"))},async $_computePosition(){if(this.isDisposed||this.positioningDisabled)return;const e={strategy:this.strategy,middleware:[]};(this.distance||this.skidding)&&e.middleware.push(offset({mainAxis:this.distance,crossAxis:this.skidding}));const t=this.placement.startsWith("auto");if(t?e.middleware.push(autoPlacement({alignment:this.placement.split("-")[1]??""})):e.placement=this.placement,this.preventOverflow&&(this.shift&&e.middleware.push(shift({padding:this.overflowPadding,boundary:this.boundary,crossAxis:this.shiftCrossAxis})),!t&&this.flip&&e.middleware.push(flip({padding:this.overflowPadding,boundary:this.boundary}))),e.middleware.push(arrow({element:this.$_arrowNode,padding:this.arrowPadding})),this.arrowOverflow&&e.middleware.push({name:"arrowOverflow",fn:({placement:e,rects:t,middlewareData:r})=>{let n;const{centerOffset:i}=r.arrow;return n=e.startsWith("top")||e.startsWith("bottom")?Math.abs(i)>t.reference.width/2:Math.abs(i)>t.reference.height/2,{data:{overflow:n}}}}),this.autoMinSize||this.autoSize){const t=this.autoSize?this.autoSize:this.autoMinSize?"min":null;e.middleware.push({name:"autoSize",fn:({rects:e,placement:r,middlewareData:n})=>{var i;if(null!=(i=n.autoSize)&&i.skip)return{};let o,a;return r.startsWith("top")||r.startsWith("bottom")?o=e.reference.width:a=e.reference.height,this.$_innerNode.style["min"===t?"minWidth":"max"===t?"maxWidth":"width"]=null!=o?`${o}px`:null,this.$_innerNode.style["min"===t?"minHeight":"max"===t?"maxHeight":"height"]=null!=a?`${a}px`:null,{data:{skip:!0},reset:{rects:!0}}}})}(this.autoMaxSize||this.autoBoundaryMaxSize)&&(this.$_innerNode.style.maxWidth=null,this.$_innerNode.style.maxHeight=null,e.middleware.push(size({boundary:this.boundary,padding:this.overflowPadding,apply:({availableWidth:e,availableHeight:t})=>{this.$_innerNode.style.maxWidth=null!=e?`${e}px`:null,this.$_innerNode.style.maxHeight=null!=t?`${t}px`:null}})));const r=await B$1(this.$_referenceNode,this.$_popperNode,e);Object.assign(this.result,{x:r.x,y:r.y,placement:r.placement,strategy:r.strategy,arrow:{...r.middlewareData.arrow,...r.middlewareData.arrowOverflow}})},$_scheduleShow(e,t=!1){if(this.$_updateParentShownChildren(!0),this.$_hideInProgress=!1,clearTimeout(this.$_scheduleTimer),g&&this.instantMove&&g.instantMove&&g!==this.parentPopper)return g.$_applyHide(!0),void this.$_applyShow(!0);t?this.$_applyShow():this.$_scheduleTimer=setTimeout(this.$_applyShow.bind(this),this.$_computeDelay("show"))},$_scheduleHide(e,t=!1){this.shownChildren.size>0?this.pendingHide=!0:(this.$_updateParentShownChildren(!1),this.$_hideInProgress=!0,clearTimeout(this.$_scheduleTimer),this.isShown&&(g=this),t?this.$_applyHide():this.$_scheduleTimer=setTimeout(this.$_applyHide.bind(this),this.$_computeDelay("hide")))},$_computeDelay(e){const t=this.delay;return parseInt(t&&t[e]||t||0)},async $_applyShow(e=!1){clearTimeout(this.$_disposeTimer),clearTimeout(this.$_scheduleTimer),this.skipTransition=e,!this.isShown&&(this.$_ensureTeleport(),await G(),await this.$_computePosition(),await this.$_applyShowEffect(),this.positioningDisabled||this.$_registerEventListeners([...D(this.$_referenceNode),...D(this.$_popperNode)],"scroll",(()=>{this.$_computePosition()})))},async $_applyShowEffect(){if(this.$_hideInProgress)return;if(this.computeTransformOrigin){const e=this.$_referenceNode.getBoundingClientRect(),t=this.$_popperNode.querySelector(".v-popper__wrapper"),r=t.parentNode.getBoundingClientRect(),n=e.x+e.width/2-(r.left+t.offsetLeft),i=e.y+e.height/2-(r.top+t.offsetTop);this.result.transformOrigin=`${n}px ${i}px`}this.isShown=!0,this.$_applyAttrsToTarget({"aria-describedby":this.popperId,"data-popper-shown":""});const e=this.showGroup;if(e){let t;for(let r=0;r<d.length;r++)t=d[r],t.showGroup!==e&&(t.hide(),t.$emit("close-group"))}d.push(this),document.body.classList.add("v-popper--some-open");for(const t of re$1(this.theme))he(t).push(this),document.body.classList.add(`v-popper--some-open--${t}`);this.$emit("apply-show"),this.classes.showFrom=!0,this.classes.showTo=!1,this.classes.hideFrom=!1,this.classes.hideTo=!1,await G(),this.classes.showFrom=!1,this.classes.showTo=!0,this.noAutoFocus||this.$_popperNode.focus()},async $_applyHide(e=!1){if(this.shownChildren.size>0)return this.pendingHide=!0,void(this.$_hideInProgress=!1);if(clearTimeout(this.$_scheduleTimer),!this.isShown)return;this.skipTransition=e,de(d,this),0===d.length&&document.body.classList.remove("v-popper--some-open");for(const r of re$1(this.theme)){const e=he(r);de(e,this),0===e.length&&document.body.classList.remove(`v-popper--some-open--${r}`)}g===this&&(g=null),this.isShown=!1,this.$_applyAttrsToTarget({"aria-describedby":void 0,"data-popper-shown":void 0}),clearTimeout(this.$_disposeTimer);const t=this.disposeTimeout;null!==t&&(this.$_disposeTimer=setTimeout((()=>{this.$_popperNode&&(this.$_detachPopperNode(),this.isMounted=!1)}),t)),this.$_removeEventListeners("scroll"),this.$emit("apply-hide"),this.classes.showFrom=!1,this.classes.showTo=!1,this.classes.hideFrom=!0,this.classes.hideTo=!1,await G(),this.classes.hideFrom=!1,this.classes.hideTo=!0},$_autoShowHide(){this.shown?this.show():this.hide()},$_ensureTeleport(){if(this.isDisposed)return;let e=this.container;if("string"==typeof e?e=window.document.querySelector(e):!1===e&&(e=this.$_targetNodes[0].parentNode),!e)throw new Error("No container for popover: "+this.container);e.appendChild(this.$_popperNode),this.isMounted=!0},$_addEventListeners(){const e=e=>{this.isShown&&!this.$_hideInProgress||(e.usedByTooltip=!0,!this.$_preventShow&&this.show({event:e}))};this.$_registerTriggerListeners(this.$_targetNodes,pe,this.triggers,this.showTriggers,e),this.$_registerTriggerListeners([this.$_popperNode],pe,this.popperTriggers,this.popperShowTriggers,e);const t=e=>{e.usedByTooltip||this.hide({event:e})};this.$_registerTriggerListeners(this.$_targetNodes,ae,this.triggers,this.hideTriggers,t),this.$_registerTriggerListeners([this.$_popperNode],ae,this.popperTriggers,this.popperHideTriggers,t)},$_registerEventListeners(e,t,r){this.$_events.push({targetNodes:e,eventType:t,handler:r}),e.forEach((e=>e.addEventListener(t,r,$?{passive:!0}:void 0)))},$_registerTriggerListeners(e,t,r,n,i){let o=r;null!=n&&(o="function"==typeof n?n(o):n),o.forEach((r=>{const n=t[r];n&&this.$_registerEventListeners(e,n,i)}))},$_removeEventListeners(e){const t=[];this.$_events.forEach((r=>{const{targetNodes:n,eventType:i,handler:o}=r;e&&e!==i?t.push(r):n.forEach((e=>e.removeEventListener(i,o)))})),this.$_events=t},$_refreshListeners(){this.isDisposed||(this.$_removeEventListeners(),this.$_addEventListeners())},$_handleGlobalClose(e,t=!1){this.$_showFrameLocked||(this.hide({event:e}),e.closePopover?this.$emit("close-directive"):this.$emit("auto-hide"),t&&(this.$_preventShow=!0,setTimeout((()=>{this.$_preventShow=!1}),300)))},$_detachPopperNode(){this.$_popperNode.parentNode&&this.$_popperNode.parentNode.removeChild(this.$_popperNode)},$_swapTargetAttrs(e,t){for(const r of this.$_targetNodes){const n=r.getAttribute(e);n&&(r.removeAttribute(e),r.setAttribute(t,n))}},$_applyAttrsToTarget(e){for(const t of this.$_targetNodes)for(const r in e){const n=e[r];null==n?t.removeAttribute(r):t.setAttribute(r,n)}},$_updateParentShownChildren(e){let t=this.parentPopper;for(;t;)e?t.shownChildren.add(this.randomId):(t.shownChildren.delete(this.randomId),t.pendingHide&&t.hide()),t=t.parentPopper},$_isAimingPopper(){const e=this.$_referenceNode.getBoundingClientRect();if(y>=e.left&&y<=e.right&&_>=e.top&&_<=e.bottom){const e=this.$_popperNode.getBoundingClientRect(),t=y-c,r=_-m,n=e.left+e.width/2-c+(e.top+e.height/2)-m+e.width+e.height,i=c+t*n,o=m+r*n;return C(c,m,i,o,e.left,e.top,e.left,e.bottom)||C(c,m,i,o,e.left,e.top,e.right,e.top)||C(c,m,i,o,e.right,e.top,e.right,e.bottom)||C(c,m,i,o,e.left,e.bottom,e.right,e.bottom)}return!1}},render(){return this.$slots.default(this.slotData)}});if(typeof document<"u"&&typeof window<"u"){if(_e){const e=!$||{passive:!0,capture:!0};document.addEventListener("touchstart",(e=>ue(e)),e),document.addEventListener("touchend",(e=>fe(e,!0)),e)}else window.addEventListener("mousedown",(e=>ue(e)),!0),window.addEventListener("click",(e=>fe(e,!1)),!0);window.addEventListener("resize",tt)}function ue(e,t){for(let r=0;r<d.length;r++){const t=d[r];try{t.mouseDownContains=t.popperNode().contains(e.target)}catch{}}}function fe(e,t){Pe(e,t)}function Pe(e,t){const r={};for(let n=d.length-1;n>=0;n--){const i=d[n];try{const n=i.containsGlobalTarget=i.mouseDownContains||i.popperNode().contains(e.target);i.pendingHide=!1,requestAnimationFrame((()=>{if(i.pendingHide=!1,!r[i.randomId]&&ce(i,n,e)){if(i.$_handleGlobalClose(e,t),!e.closeAllPopover&&e.closePopover&&n){let e=i.parentPopper;for(;e;)r[e.randomId]=!0,e=e.parentPopper;return}let o=i.parentPopper;for(;o&&ce(o,o.containsGlobalTarget,e);)o.$_handleGlobalClose(e,t),o=o.parentPopper}}))}catch{}}}function ce(e,t,r){return r.closeAllPopover||r.closePopover&&t||et(e,r)&&!t}function et(e,t){if("function"==typeof e.autoHide){const r=e.autoHide(t);return e.lastAutoHide=r,r}return e.autoHide}function tt(){for(let e=0;e<d.length;e++)d[e].$_computePosition()}let c=0,m=0,y=0,_=0;function C(e,t,r,n,i,o,a,s){const l=((a-i)*(t-o)-(s-o)*(e-i))/((s-o)*(r-e)-(a-i)*(n-t)),c=((r-e)*(t-o)-(n-t)*(e-i))/((s-o)*(r-e)-(a-i)*(n-t));return l>=0&&l<=1&&c>=0&&c<=1}typeof window<"u"&&window.addEventListener("mousemove",(e=>{c=y,m=_,y=e.clientX,_=e.clientY}),$?{passive:!0}:void 0);const ot={extends:Q()},B=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r};function it$1(e,t,r,n,i,o){return openBlock(),createElementBlock("div",{ref:"reference",class:normalizeClass(["v-popper",{"v-popper--shown":e.slotData.isShown}])},[renderSlot(e.$slots,"default",normalizeProps(guardReactiveProps(e.slotData)))],2)}const st=B(ot,[["render",it$1]]);function nt(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var n=e.indexOf("Edge/");return n>0?parseInt(e.substring(n+5,e.indexOf(".",n)),10):-1}let z;function X(){X.init||(X.init=!0,z=-1!==nt())}var E={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){X(),nextTick((()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()}));const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",z&&this.$el.appendChild(e),e.data="about:blank",z||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!z&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const rt=withScopeId();pushScopeId("data-v-b329ee4c");const pt={class:"resize-observer",tabindex:"-1"};popScopeId();const at=rt(((e,t,r,n,i,o)=>(openBlock(),createBlock("div",pt))));E.render=at,E.__scopeId="data-v-b329ee4c",E.__file="src/components/ResizeObserver.vue";const Z=(e="theme")=>({computed:{themeClass(){return Ze(this[e])}}}),dt=defineComponent({name:"VPopperContent",components:{ResizeObserver:E},mixins:[Z()],props:{popperId:String,theme:String,shown:Boolean,mounted:Boolean,skipTransition:Boolean,autoHide:Boolean,handleResize:Boolean,classes:Object,result:Object},emits:["hide","resize"],methods:{toPx:e=>null==e||isNaN(e)?null:`${e}px`}}),lt$1=["id","aria-hidden","tabindex","data-popper-placement"],ht={ref:"inner",class:"v-popper__inner"},ut=createBaseVNode("div",{class:"v-popper__arrow-outer"},null,-1),ft=createBaseVNode("div",{class:"v-popper__arrow-inner"},null,-1),ct=[ut,ft];function mt(e,t,r,n,i,o){const a=resolveComponent("ResizeObserver");return openBlock(),createElementBlock("div",{id:e.popperId,ref:"popover",class:normalizeClass(["v-popper__popper",[e.themeClass,e.classes.popperClass,{"v-popper__popper--shown":e.shown,"v-popper__popper--hidden":!e.shown,"v-popper__popper--show-from":e.classes.showFrom,"v-popper__popper--show-to":e.classes.showTo,"v-popper__popper--hide-from":e.classes.hideFrom,"v-popper__popper--hide-to":e.classes.hideTo,"v-popper__popper--skip-transition":e.skipTransition,"v-popper__popper--arrow-overflow":e.result&&e.result.arrow.overflow,"v-popper__popper--no-positioning":!e.result}]]),style:normalizeStyle$1(e.result?{position:e.result.strategy,transform:`translate3d(${Math.round(e.result.x)}px,${Math.round(e.result.y)}px,0)`}:void 0),"aria-hidden":e.shown?"false":"true",tabindex:e.autoHide?0:void 0,"data-popper-placement":e.result?e.result.placement:void 0,onKeyup:t[2]||(t[2]=withKeys((t=>e.autoHide&&e.$emit("hide")),["esc"]))},[createBaseVNode("div",{class:"v-popper__backdrop",onClick:t[0]||(t[0]=t=>e.autoHide&&e.$emit("hide"))}),createBaseVNode("div",{class:"v-popper__wrapper",style:normalizeStyle$1(e.result?{transformOrigin:e.result.transformOrigin}:void 0)},[createBaseVNode("div",ht,[e.mounted?(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("div",null,[renderSlot(e.$slots,"default")]),e.handleResize?(openBlock(),createBlock(a,{key:0,onNotify:t[1]||(t[1]=t=>e.$emit("resize",t))})):createCommentVNode("",!0)],64)):createCommentVNode("",!0)],512),createBaseVNode("div",{ref:"arrow",class:"v-popper__arrow-container",style:normalizeStyle$1(e.result?{left:e.toPx(e.result.arrow.x),top:e.toPx(e.result.arrow.y)}:void 0)},ct,4)],4)],46,lt$1)}const ee$1=B(dt,[["render",mt]]),te={methods:{show(...e){return this.$refs.popper.show(...e)},hide(...e){return this.$refs.popper.hide(...e)},dispose(...e){return this.$refs.popper.dispose(...e)},onResize(...e){return this.$refs.popper.onResize(...e)}}};let K=function(){};typeof window<"u"&&(K=window.Element);const gt$1=defineComponent({name:"VPopperWrapper",components:{Popper:st,PopperContent:ee$1},mixins:[te,Z("finalTheme")],props:{theme:{type:String,default:null},referenceNode:{type:Function,default:null},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:void 0},positioningDisabled:{type:Boolean,default:void 0},placement:{type:String,default:void 0},delay:{type:[String,Number,Object],default:void 0},distance:{type:[Number,String],default:void 0},skidding:{type:[Number,String],default:void 0},triggers:{type:Array,default:void 0},showTriggers:{type:[Array,Function],default:void 0},hideTriggers:{type:[Array,Function],default:void 0},popperTriggers:{type:Array,default:void 0},popperShowTriggers:{type:[Array,Function],default:void 0},popperHideTriggers:{type:[Array,Function],default:void 0},container:{type:[String,Object,K,Boolean],default:void 0},boundary:{type:[String,K],default:void 0},strategy:{type:String,default:void 0},autoHide:{type:[Boolean,Function],default:void 0},handleResize:{type:Boolean,default:void 0},instantMove:{type:Boolean,default:void 0},eagerMount:{type:Boolean,default:void 0},popperClass:{type:[String,Array,Object],default:void 0},computeTransformOrigin:{type:Boolean,default:void 0},autoMinSize:{type:Boolean,default:void 0},autoSize:{type:[Boolean,String],default:void 0},autoMaxSize:{type:Boolean,default:void 0},autoBoundaryMaxSize:{type:Boolean,default:void 0},preventOverflow:{type:Boolean,default:void 0},overflowPadding:{type:[Number,String],default:void 0},arrowPadding:{type:[Number,String],default:void 0},arrowOverflow:{type:Boolean,default:void 0},flip:{type:Boolean,default:void 0},shift:{type:Boolean,default:void 0},shiftCrossAxis:{type:Boolean,default:void 0},noAutoFocus:{type:Boolean,default:void 0},disposeTimeout:{type:Number,default:void 0}},emits:{show:()=>!0,hide:()=>!0,"update:shown":e=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},computed:{finalTheme(){return this.theme??this.$options.vPopperTheme}},methods:{getTargetNodes(){return Array.from(this.$el.children).filter((e=>e!==this.$refs.popperContent.$el))}}});function wt(e,t,r,n,i,o){const a=resolveComponent("PopperContent"),s=resolveComponent("Popper");return openBlock(),createBlock(s,mergeProps({ref:"popper"},e.$props,{theme:e.finalTheme,"target-nodes":e.getTargetNodes,"popper-node":()=>e.$refs.popperContent.$el,class:[e.themeClass],onShow:t[0]||(t[0]=()=>e.$emit("show")),onHide:t[1]||(t[1]=()=>e.$emit("hide")),"onUpdate:shown":t[2]||(t[2]=t=>e.$emit("update:shown",t)),onApplyShow:t[3]||(t[3]=()=>e.$emit("apply-show")),onApplyHide:t[4]||(t[4]=()=>e.$emit("apply-hide")),onCloseGroup:t[5]||(t[5]=()=>e.$emit("close-group")),onCloseDirective:t[6]||(t[6]=()=>e.$emit("close-directive")),onAutoHide:t[7]||(t[7]=()=>e.$emit("auto-hide")),onResize:t[8]||(t[8]=()=>e.$emit("resize"))}),{default:withCtx((({popperId:t,isShown:r,shouldMountContent:n,skipTransition:i,autoHide:o,show:s,hide:l,handleResize:c,onResize:u,classes:h,result:d})=>[renderSlot(e.$slots,"default",{shown:r,show:s,hide:l}),createVNode(a,{ref:"popperContent","popper-id":t,theme:e.finalTheme,shown:r,mounted:n,"skip-transition":i,"auto-hide":o,"handle-resize":c,classes:h,result:d,onHide:l,onResize:u},{default:withCtx((()=>[renderSlot(e.$slots,"popper",{shown:r,hide:l})])),_:2},1032,["popper-id","theme","shown","mounted","skip-transition","auto-hide","handle-resize","classes","result","onHide","onResize"])])),_:3},16,["theme","target-nodes","popper-node","class"])}const k=B(gt$1,[["render",wt]]),Se={...k,name:"VDropdown",vPopperTheme:"dropdown"},be={...k,name:"VMenu",vPopperTheme:"menu"},Ce={...k,name:"VTooltip",vPopperTheme:"tooltip"},$t=defineComponent({name:"VTooltipDirective",components:{Popper:Q(),PopperContent:ee$1},mixins:[te],inheritAttrs:!1,props:{theme:{type:String,default:"tooltip"},html:{type:Boolean,default:e=>S(e.theme,"html")},content:{type:[String,Number,Function],default:null},loadingContent:{type:String,default:e=>S(e.theme,"loadingContent")},targetNodes:{type:Function,required:!0}},data:()=>({asyncContent:null}),computed:{isContentAsync(){return"function"==typeof this.content},loading(){return this.isContentAsync&&null==this.asyncContent},finalContent(){return this.isContentAsync?this.loading?this.loadingContent:this.asyncContent:this.content}},watch:{content:{handler(){this.fetchContent(!0)},immediate:!0},async finalContent(){await this.$nextTick(),this.$refs.popper.onResize()}},created(){this.$_fetchId=0},methods:{fetchContent(e){if("function"==typeof this.content&&this.$_isShown&&(e||!this.$_loading&&null==this.asyncContent)){this.asyncContent=null,this.$_loading=!0;const e=++this.$_fetchId,t=this.content(this);t.then?t.then((t=>this.onResult(e,t))):this.onResult(e,t)}},onResult(e,t){e===this.$_fetchId&&(this.$_loading=!1,this.asyncContent=t)},onShow(){this.$_isShown=!0,this.fetchContent()},onHide(){this.$_isShown=!1}}}),vt=["innerHTML"],yt=["textContent"];function _t(e,t,r,n,i,o){const a=resolveComponent("PopperContent"),s=resolveComponent("Popper");return openBlock(),createBlock(s,mergeProps({ref:"popper"},e.$attrs,{theme:e.theme,"target-nodes":e.targetNodes,"popper-node":()=>e.$refs.popperContent.$el,onApplyShow:e.onShow,onApplyHide:e.onHide}),{default:withCtx((({popperId:t,isShown:r,shouldMountContent:n,skipTransition:i,autoHide:o,hide:s,handleResize:l,onResize:c,classes:u,result:h})=>[createVNode(a,{ref:"popperContent",class:normalizeClass({"v-popper--tooltip-loading":e.loading}),"popper-id":t,theme:e.theme,shown:r,mounted:n,"skip-transition":i,"auto-hide":o,"handle-resize":l,classes:u,result:h,onHide:s,onResize:c},{default:withCtx((()=>[e.html?(openBlock(),createElementBlock("div",{key:0,innerHTML:e.finalContent},null,8,vt)):(openBlock(),createElementBlock("div",{key:1,textContent:toDisplayString(e.finalContent)},null,8,yt))])),_:2},1032,["class","popper-id","theme","shown","mounted","skip-transition","auto-hide","handle-resize","classes","result","onHide","onResize"])])),_:1},16,["theme","target-nodes","popper-node","onApplyShow","onApplyHide"])}const ze=B($t,[["render",_t]]),Ae="v-popper--has-tooltip";function Tt(e,t){let r=e.placement;if(!r&&t)for(const n of Te)t[n]&&(r=n);return r||(r=S(e.theme||"tooltip","placement")),r}function Ne(e,t,r){let n;const i=typeof t;return n="string"===i?{content:t}:t&&"object"===i?t:{content:!1},n.placement=Tt(n,r),n.targetNodes=()=>[e],n.referenceNode=()=>e,n}let x,b,Pt=0;function St(){if(x)return;b=ref$1([]),x=createApp({name:"VTooltipDirectiveApp",setup:()=>({directives:b}),render(){return this.directives.map((e=>h$2(ze,{...e.options,shown:e.shown||e.options.shown,key:e.id})))},devtools:{hide:!0}});const e=document.createElement("div");document.body.appendChild(e),x.mount(e)}function bt(e,t,r){St();const n=ref$1(Ne(e,t,r)),i=ref$1(!1),o={id:Pt++,options:n,shown:i};return b.value.push(o),e.classList&&e.classList.add(Ae),e.$_popper={options:n,item:o,show(){i.value=!0},hide(){i.value=!1}}}function He(e){if(e.$_popper){const t=b.value.indexOf(e.$_popper.item);-1!==t&&b.value.splice(t,1),delete e.$_popper,delete e.$_popperOldShown,delete e.$_popperMountTarget}e.classList&&e.classList.remove(Ae)}function me(e,{value:t,modifiers:r}){const n=Ne(e,t,r);if(!n.content||S(n.theme||"tooltip","disabled"))He(e);else{let i;e.$_popper?(i=e.$_popper,i.options.value=n):i=bt(e,t,r),typeof t.shown<"u"&&t.shown!==e.$_popperOldShown&&(e.$_popperOldShown=t.shown,t.shown?i.show():i.hide())}}const oe={beforeMount:me,updated:me,beforeUnmount(e){He(e)}};function ge$1(e){e.addEventListener("mousedown",H),e.addEventListener("click",H),e.addEventListener("touchstart",Oe,!!$&&{passive:!0})}function we(e){e.removeEventListener("mousedown",H),e.removeEventListener("click",H),e.removeEventListener("touchstart",Oe),e.removeEventListener("touchend",Me),e.removeEventListener("touchcancel",Be)}function H(e){const t=e.currentTarget;e.closePopover=!t.$_vclosepopover_touch,e.closeAllPopover=t.$_closePopoverModifiers&&!!t.$_closePopoverModifiers.all}function Oe(e){if(1===e.changedTouches.length){const t=e.currentTarget;t.$_vclosepopover_touch=!0;const r=e.changedTouches[0];t.$_vclosepopover_touchPoint=r,t.addEventListener("touchend",Me),t.addEventListener("touchcancel",Be)}}function Me(e){const t=e.currentTarget;if(t.$_vclosepopover_touch=!1,1===e.changedTouches.length){const r=e.changedTouches[0],n=t.$_vclosepopover_touchPoint;e.closePopover=Math.abs(r.screenY-n.screenY)<20&&Math.abs(r.screenX-n.screenX)<20,e.closeAllPopover=t.$_closePopoverModifiers&&!!t.$_closePopoverModifiers.all}}function Be(e){e.currentTarget.$_vclosepopover_touch=!1}const ie={beforeMount(e,{value:t,modifiers:r}){e.$_closePopoverModifiers=r,(typeof t>"u"||t)&&ge$1(e)},updated(e,{value:t,oldValue:r,modifiers:n}){e.$_closePopoverModifiers=n,t!==r&&(typeof t>"u"||t?ge$1(e):we(e))},beforeUnmount(e){we(e)}},Mt=oe,Et=ie,kt=Se,Lt$1=be,Vt=Ce,QPdfviewer=defineComponent({name:"QPdfviewer",props:{src:String,type:{type:String,default:"html5",validator:e=>-1!==["html5","pdfjs"].indexOf(e)},errorString:{type:String,default:"This browser does not support PDFs. Download the PDF to view it:"},contentStyle:[String,Object,Array],contentClass:[String,Object,Array],innerContentStyle:[String,Object,Array],innerContentClass:[String,Object,Array]},emits:[],setup(e){const t="q-pdfviewer-"+Math.random().toString(36).substr(2,9);function r(){return h$2("a",{href:e.src,target:"_blank"})}return()=>function(){if(void 0!==e.src&&e.src.length>0)return h$2("div",{class:["q-pdfviewer",e.contentClass],style:[e.contentStyle]},["pdfjs"===e.type?h$2("iframe",{class:["q-pdfviewer__iframe"],src:"/pdfjs/web/viewer.html?file="+encodeURIComponent(e.src),width:"100%",height:"100%"},[r()]):h$2("object",{class:[e.innerContentClass],style:[e.innerContentStyle],id:t,data:e.src,type:"application/pdf",width:"100%",height:"100%"},[h$2("iframe",{class:["q-pdfviewer__iframe"],src:e.src,width:"100%",height:"100%"},[r()])])])}()}}),qpdfviewer=({app:e})=>{e.component("QPdfviewer",QPdfviewer)},qpdfviewer$1=Object.freeze(Object.defineProperty({__proto__:null,default:qpdfviewer},Symbol.toStringTag,{value:"Module"}));var utils={};const Aacute="",aacute="",Abreve="",abreve="",ac="",acd="",acE="",Acirc="",acirc="",acute="",Acy="",acy="",AElig="",aelig="",af="",Afr="",afr="",Agrave="",agrave="",alefsym="",aleph="",Alpha="",alpha="",Amacr="",amacr="",amalg="",amp="&",AMP="&",andand="",And="",and="",andd="",andslope="",andv="",ang="",ange="",angle="",angmsdaa="",angmsdab="",angmsdac="",angmsdad="",angmsdae="",angmsdaf="",angmsdag="",angmsdah="",angmsd="",angrt="",angrtvb="",angrtvbd="",angsph="",angst="",angzarr="",Aogon="",aogon="",Aopf="",aopf="",apacir="",ap="",apE="",ape="",apid="",apos="'",ApplyFunction="",approx="",approxeq="",Aring="",aring="",Ascr="",ascr="",Assign="",ast="*",asymp="",asympeq="",Atilde="",atilde="",Auml="",auml="",awconint="",awint="",backcong="",backepsilon="",backprime="",backsim="",backsimeq="",Backslash="",Barv="",barvee="",barwed="",Barwed="",barwedge="",bbrk="",bbrktbrk="",bcong="",Bcy="",bcy="",bdquo="",becaus="",because="",Because="",bemptyv="",bepsi="",bernou="",Bernoullis="",Beta="",beta="",beth="",between="",Bfr="",bfr="",bigcap="",bigcirc="",bigcup="",bigodot="",bigoplus="",bigotimes="",bigsqcup="",bigstar="",bigtriangledown="",bigtriangleup="",biguplus="",bigvee="",bigwedge="",bkarow="",blacklozenge="",blacksquare="",blacktriangle="",blacktriangledown="",blacktriangleleft="",blacktriangleright="",blank="",blk12="",blk14="",blk34="",block$1="",bne="=",bnequiv="",bNot="",bnot="",Bopf="",bopf="",bot="",bottom="",bowtie="",boxbox="",boxdl="",boxdL="",boxDl="",boxDL="",boxdr="",boxdR="",boxDr="",boxDR="",boxh="",boxH="",boxhd="",boxHd="",boxhD="",boxHD="",boxhu="",boxHu="",boxhU="",boxHU="",boxminus="",boxplus="",boxtimes="",boxul="",boxuL="",boxUl="",boxUL="",boxur="",boxuR="",boxUr="",boxUR="",boxv="",boxV="",boxvh="",boxvH="",boxVh="",boxVH="",boxvl="",boxvL="",boxVl="",boxVL="",boxvr="",boxvR="",boxVr="",boxVR="",bprime="",breve="",Breve="",brvbar="",bscr="",Bscr="",bsemi="",bsim="",bsime="",bsolb="",bsol="\\",bsolhsub="",bull="",bullet="",bump="",bumpE="",bumpe="",Bumpeq="",bumpeq="",Cacute="",cacute="",capand="",capbrcup="",capcap="",cap="",Cap="",capcup="",capdot="",CapitalDifferentialD="",caps="",caret="",caron="",Cayleys="",ccaps="",Ccaron="",ccaron="",Ccedil="",ccedil="",Ccirc="",ccirc="",Cconint="",ccups="",ccupssm="",Cdot="",cdot="",cedil="",Cedilla="",cemptyv="",cent="",centerdot="",CenterDot="",cfr="",Cfr="",CHcy="",chcy="",check="",checkmark="",Chi="",chi="",circ="",circeq="",circlearrowleft="",circlearrowright="",circledast="",circledcirc="",circleddash="",CircleDot="",circledR="",circledS="",CircleMinus="",CirclePlus="",CircleTimes="",cir="",cirE="",cire="",cirfnint="",cirmid="",cirscir="",ClockwiseContourIntegral="",CloseCurlyDoubleQuote="",CloseCurlyQuote="",clubs="",clubsuit="",colon=":",Colon="",Colone="",colone="",coloneq="",comma=",",commat="@",comp="",compfn="",complement="",complexes="",cong="",congdot="",Congruent="",conint="",Conint="",ContourIntegral="",copf="",Copf="",coprod="",Coproduct="",copy="",COPY="",copysr="",CounterClockwiseContourIntegral="",crarr="",cross="",Cross="",Cscr="",cscr="",csub="",csube="",csup="",csupe="",ctdot="",cudarrl="",cudarrr="",cuepr="",cuesc="",cularr="",cularrp="",cupbrcap="",cupcap="",CupCap="",cup="",Cup="",cupcup="",cupdot="",cupor="",cups="",curarr="",curarrm="",curlyeqprec="",curlyeqsucc="",curlyvee="",curlywedge="",curren="",curvearrowleft="",curvearrowright="",cuvee="",cuwed="",cwconint="",cwint="",cylcty="",dagger="",Dagger="",daleth="",darr="",Darr="",dArr="",dash="",Dashv="",dashv="",dbkarow="",dblac="",Dcaron="",dcaron="",Dcy="",dcy="",ddagger="",ddarr="",DD="",dd="",DDotrahd="",ddotseq="",deg="",Del="",Delta="",delta="",demptyv="",dfisht="",Dfr="",dfr="",dHar="",dharl="",dharr="",DiacriticalAcute="",DiacriticalDot="",DiacriticalDoubleAcute="",DiacriticalGrave="`",DiacriticalTilde="",diam="",diamond="",Diamond="",diamondsuit="",diams="",die="",DifferentialD="",digamma="",disin="",div="",divide="",divideontimes="",divonx="",DJcy="",djcy="",dlcorn="",dlcrop="",dollar="$",Dopf="",dopf="",Dot="",dot="",DotDot="",doteq="",doteqdot="",DotEqual="",dotminus="",dotplus="",dotsquare="",doublebarwedge="",DoubleContourIntegral="",DoubleDot="",DoubleDownArrow="",DoubleLeftArrow="",DoubleLeftRightArrow="",DoubleLeftTee="",DoubleLongLeftArrow="",DoubleLongLeftRightArrow="",DoubleLongRightArrow="",DoubleRightArrow="",DoubleRightTee="",DoubleUpArrow="",DoubleUpDownArrow="",DoubleVerticalBar="",DownArrowBar="",downarrow="",DownArrow="",Downarrow="",DownArrowUpArrow="",DownBreve="",downdownarrows="",downharpoonleft="",downharpoonright="",DownLeftRightVector="",DownLeftTeeVector="",DownLeftVectorBar="",DownLeftVector="",DownRightTeeVector="",DownRightVectorBar="",DownRightVector="",DownTeeArrow="",DownTee="",drbkarow="",drcorn="",drcrop="",Dscr="",dscr="",DScy="",dscy="",dsol="",Dstrok="",dstrok="",dtdot="",dtri="",dtrif="",duarr="",duhar="",dwangle="",DZcy="",dzcy="",dzigrarr="",Eacute="",eacute="",easter="",Ecaron="",ecaron="",Ecirc="",ecirc="",ecir="",ecolon="",Ecy="",ecy="",eDDot="",Edot="",edot="",eDot="",ee="",efDot="",Efr="",efr="",eg="",Egrave="",egrave="",egs="",egsdot="",el="",Element$1="",elinters="",ell="",els="",elsdot="",Emacr="",emacr="",empty="",emptyset="",EmptySmallSquare="",emptyv="",EmptyVerySmallSquare="",emsp13="",emsp14="",emsp="",ENG="",eng="",ensp="",Eogon="",eogon="",Eopf="",eopf="",epar="",eparsl="",eplus="",epsi="",Epsilon="",epsilon="",epsiv="",eqcirc="",eqcolon="",eqsim="",eqslantgtr="",eqslantless="",Equal="",equals="=",EqualTilde="",equest="",Equilibrium="",equiv="",equivDD="",eqvparsl="",erarr="",erDot="",escr="",Escr="",esdot="",Esim="",esim="",Eta="",eta="",ETH="",eth="",Euml="",euml="",euro="",excl="!",exist="",Exists="",expectation="",exponentiale="",ExponentialE="",fallingdotseq="",Fcy="",fcy="",female="",ffilig="",fflig="",ffllig="",Ffr="",ffr="",filig="",FilledSmallSquare="",FilledVerySmallSquare="",fjlig="fj",flat="",fllig="",fltns="",fnof="",Fopf="",fopf="",forall="",ForAll="",fork="",forkv="",Fouriertrf="",fpartint="",frac12="",frac13="",frac14="",frac15="",frac16="",frac18="",frac23="",frac25="",frac34="",frac35="",frac38="",frac45="",frac56="",frac58="",frac78="",frasl="",frown="",fscr="",Fscr="",gacute="",Gamma="",gamma="",Gammad="",gammad="",gap="",Gbreve="",gbreve="",Gcedil="",Gcirc="",gcirc="",Gcy="",gcy="",Gdot="",gdot="",ge="",gE="",gEl="",gel="",geq="",geqq="",geqslant="",gescc="",ges="",gesdot="",gesdoto="",gesdotol="",gesl="",gesles="",Gfr="",gfr="",gg="",Gg="",ggg="",gimel="",GJcy="",gjcy="",gla="",gl="",glE="",glj="",gnap="",gnapprox="",gne="",gnE="",gneq="",gneqq="",gnsim="",Gopf="",gopf="",grave="`",GreaterEqual="",GreaterEqualLess="",GreaterFullEqual="",GreaterGreater="",GreaterLess="",GreaterSlantEqual="",GreaterTilde="",Gscr="",gscr="",gsim="",gsime="",gsiml="",gtcc="",gtcir="",gt=">",GT=">",Gt="",gtdot="",gtlPar="",gtquest="",gtrapprox="",gtrarr="",gtrdot="",gtreqless="",gtreqqless="",gtrless="",gtrsim="",gvertneqq="",gvnE="",Hacek="",hairsp="",half="",hamilt="",HARDcy="",hardcy="",harrcir="",harr="",hArr="",harrw="",Hat="^",hbar="",Hcirc="",hcirc="",hearts="",heartsuit="",hellip="",hercon="",hfr="",Hfr="",HilbertSpace="",hksearow="",hkswarow="",hoarr="",homtht="",hookleftarrow="",hookrightarrow="",hopf="",Hopf="",horbar="",HorizontalLine="",hscr="",Hscr="",hslash="",Hstrok="",hstrok="",HumpDownHump="",HumpEqual="",hybull="",hyphen="",Iacute="",iacute="",ic="",Icirc="",icirc="",Icy="",icy="",Idot="",IEcy="",iecy="",iexcl="",iff="",ifr="",Ifr="",Igrave="",igrave="",ii="",iiiint="",iiint="",iinfin="",iiota="",IJlig="",ijlig="",Imacr="",imacr="",image$1="",ImaginaryI="",imagline="",imagpart="",imath="",Im="",imof="",imped="",Implies="",incare="",infin="",infintie="",inodot="",intcal="",int="",Int="",integers="",Integral="",intercal="",Intersection$1="",intlarhk="",intprod="",InvisibleComma="",InvisibleTimes="",IOcy="",iocy="",Iogon="",iogon="",Iopf="",iopf="",Iota="",iota="",iprod="",iquest="",iscr="",Iscr="",isin="",isindot="",isinE="",isins="",isinsv="",isinv="",it="",Itilde="",itilde="",Iukcy="",iukcy="",Iuml="",iuml="",Jcirc="",jcirc="",Jcy="",jcy="",Jfr="",jfr="",jmath="",Jopf="",jopf="",Jscr="",jscr="",Jsercy="",jsercy="",Jukcy="",jukcy="",Kappa="",kappa="",kappav="",Kcedil="",kcedil="",Kcy="",kcy="",Kfr="",kfr="",kgreen="",KHcy="",khcy="",KJcy="",kjcy="",Kopf="",kopf="",Kscr="",kscr="",lAarr="",Lacute="",lacute="",laemptyv="",lagran="",Lambda="",lambda="",lang="",Lang="",langd="",langle="",lap="",Laplacetrf="",laquo="",larrb="",larrbfs="",larr="",Larr="",lArr="",larrfs="",larrhk="",larrlp="",larrpl="",larrsim="",larrtl="",latail="",lAtail="",lat="",late="",lates="",lbarr="",lBarr="",lbbrk="",lbrace="{",lbrack="[",lbrke="",lbrksld="",lbrkslu="",Lcaron="",lcaron="",Lcedil="",lcedil="",lceil="",lcub="{",Lcy="",lcy="",ldca="",ldquo="",ldquor="",ldrdhar="",ldrushar="",ldsh="",le="",lE="",LeftAngleBracket="",LeftArrowBar="",leftarrow="",LeftArrow="",Leftarrow="",LeftArrowRightArrow="",leftarrowtail="",LeftCeiling="",LeftDoubleBracket="",LeftDownTeeVector="",LeftDownVectorBar="",LeftDownVector="",LeftFloor="",leftharpoondown="",leftharpoonup="",leftleftarrows="",leftrightarrow="",LeftRightArrow="",Leftrightarrow="",leftrightarrows="",leftrightharpoons="",leftrightsquigarrow="",LeftRightVector="",LeftTeeArrow="",LeftTee="",LeftTeeVector="",leftthreetimes="",LeftTriangleBar="",LeftTriangle="",LeftTriangleEqual="",LeftUpDownVector="",LeftUpTeeVector="",LeftUpVectorBar="",LeftUpVector="",LeftVectorBar="",LeftVector="",lEg="",leg="",leq="",leqq="",leqslant="",lescc="",les="",lesdot="",lesdoto="",lesdotor="",lesg="",lesges="",lessapprox="",lessdot="",lesseqgtr="",lesseqqgtr="",LessEqualGreater="",LessFullEqual="",LessGreater="",lessgtr="",LessLess="",lesssim="",LessSlantEqual="",LessTilde="",lfisht="",lfloor="",Lfr="",lfr="",lg="",lgE="",lHar="",lhard="",lharu="",lharul="",lhblk="",LJcy="",ljcy="",llarr="",ll="",Ll="",llcorner="",Lleftarrow="",llhard="",lltri="",Lmidot="",lmidot="",lmoustache="",lmoust="",lnap="",lnapprox="",lne="",lnE="",lneq="",lneqq="",lnsim="",loang="",loarr="",lobrk="",longleftarrow="",LongLeftArrow="",Longleftarrow="",longleftrightarrow="",LongLeftRightArrow="",Longleftrightarrow="",longmapsto="",longrightarrow="",LongRightArrow="",Longrightarrow="",looparrowleft="",looparrowright="",lopar="",Lopf="",lopf="",loplus="",lotimes="",lowast="",lowbar="_",LowerLeftArrow="",LowerRightArrow="",loz="",lozenge="",lozf="",lpar="(",lparlt="",lrarr="",lrcorner="",lrhar="",lrhard="",lrm="",lrtri="",lsaquo="",lscr="",Lscr="",lsh="",Lsh="",lsim="",lsime="",lsimg="",lsqb="[",lsquo="",lsquor="",Lstrok="",lstrok="",ltcc="",ltcir="",lt="<",LT="<",Lt="",ltdot="",lthree="",ltimes="",ltlarr="",ltquest="",ltri="",ltrie="",ltrif="",ltrPar="",lurdshar="",luruhar="",lvertneqq="",lvnE="",macr="",male="",malt="",maltese="",map="",mapsto="",mapstodown="",mapstoleft="",mapstoup="",marker="",mcomma="",Mcy="",mcy="",mdash="",mDDot="",measuredangle="",MediumSpace="",Mellintrf="",Mfr="",mfr="",mho="",micro="",midast="*",midcir="",mid="",middot="",minusb="",minus="",minusd="",minusdu="",MinusPlus="",mlcp="",mldr="",mnplus="",models="",Mopf="",mopf="",mp="",mscr="",Mscr="",mstpos="",Mu="",mu="",multimap="",mumap="",nabla="",Nacute="",nacute="",nang="",nap="",napE="",napid="",napos="",napprox="",natural="",naturals="",natur="",nbsp="",nbump="",nbumpe="",ncap="",Ncaron="",ncaron="",Ncedil="",ncedil="",ncong="",ncongdot="",ncup="",Ncy="",ncy="",ndash="",nearhk="",nearr="",neArr="",nearrow="",ne="",nedot="",NegativeMediumSpace="",NegativeThickSpace="",NegativeThinSpace="",NegativeVeryThinSpace="",nequiv="",nesear="",nesim="",NestedGreaterGreater="",NestedLessLess="",NewLine="\n",nexist="",nexists="",Nfr="",nfr="",ngE="",nge="",ngeq="",ngeqq="",ngeqslant="",nges="",nGg="",ngsim="",nGt="",ngt="",ngtr="",nGtv="",nharr="",nhArr="",nhpar="",ni="",nis="",nisd="",niv="",NJcy="",njcy="",nlarr="",nlArr="",nldr="",nlE="",nle="",nleftarrow="",nLeftarrow="",nleftrightarrow="",nLeftrightarrow="",nleq="",nleqq="",nleqslant="",nles="",nless="",nLl="",nlsim="",nLt="",nlt="",nltri="",nltrie="",nLtv="",nmid="",NoBreak="",NonBreakingSpace="",nopf="",Nopf="",Not="",not="",NotCongruent="",NotCupCap="",NotDoubleVerticalBar="",NotElement="",NotEqual="",NotEqualTilde="",NotExists="",NotGreater="",NotGreaterEqual="",NotGreaterFullEqual="",NotGreaterGreater="",NotGreaterLess="",NotGreaterSlantEqual="",NotGreaterTilde="",NotHumpDownHump="",NotHumpEqual="",notin="",notindot="",notinE="",notinva="",notinvb="",notinvc="",NotLeftTriangleBar="",NotLeftTriangle="",NotLeftTriangleEqual="",NotLess="",NotLessEqual="",NotLessGreater="",NotLessLess="",NotLessSlantEqual="",NotLessTilde="",NotNestedGreaterGreater="",NotNestedLessLess="",notni="",notniva="",notnivb="",notnivc="",NotPrecedes="",NotPrecedesEqual="",NotPrecedesSlantEqual="",NotReverseElement="",NotRightTriangleBar="",NotRightTriangle="",NotRightTriangleEqual="",NotSquareSubset="",NotSquareSubsetEqual="",NotSquareSuperset="",NotSquareSupersetEqual="",NotSubset="",NotSubsetEqual="",NotSucceeds="",NotSucceedsEqual="",NotSucceedsSlantEqual="",NotSucceedsTilde="",NotSuperset="",NotSupersetEqual="",NotTilde="",NotTildeEqual="",NotTildeFullEqual="",NotTildeTilde="",NotVerticalBar="",nparallel="",npar="",nparsl="",npart="",npolint="",npr="",nprcue="",nprec="",npreceq="",npre="",nrarrc="",nrarr="",nrArr="",nrarrw="",nrightarrow="",nRightarrow="",nrtri="",nrtrie="",nsc="",nsccue="",nsce="",Nscr="",nscr="",nshortmid="",nshortparallel="",nsim="",nsime="",nsimeq="",nsmid="",nspar="",nsqsube="",nsqsupe="",nsub="",nsubE="",nsube="",nsubset="",nsubseteq="",nsubseteqq="",nsucc="",nsucceq="",nsup="",nsupE="",nsupe="",nsupset="",nsupseteq="",nsupseteqq="",ntgl="",Ntilde="",ntilde="",ntlg="",ntriangleleft="",ntrianglelefteq="",ntriangleright="",ntrianglerighteq="",Nu="",nu="",num="#",numero="",numsp="",nvap="",nvdash="",nvDash="",nVdash="",nVDash="",nvge="",nvgt=">",nvHarr="",nvinfin="",nvlArr="",nvle="",nvlt="<",nvltrie="",nvrArr="",nvrtrie="",nvsim="",nwarhk="",nwarr="",nwArr="",nwarrow="",nwnear="",Oacute="",oacute="",oast="",Ocirc="",ocirc="",ocir="",Ocy="",ocy="",odash="",Odblac="",odblac="",odiv="",odot="",odsold="",OElig="",oelig="",ofcir="",Ofr="",ofr="",ogon="",Ograve="",ograve="",ogt="",ohbar="",ohm="",oint="",olarr="",olcir="",olcross="",oline="",olt="",Omacr="",omacr="",Omega="",omega="",Omicron="",omicron="",omid="",ominus="",Oopf="",oopf="",opar="",OpenCurlyDoubleQuote="",OpenCurlyQuote="",operp="",oplus="",orarr="",Or="",or="",ord="",order="",orderof="",ordf="",ordm="",origof="",oror="",orslope="",orv="",oS="",Oscr="",oscr="",Oslash="",oslash="",osol="",Otilde="",otilde="",otimesas="",Otimes="",otimes="",Ouml="",ouml="",ovbar="",OverBar="",OverBrace="",OverBracket="",OverParenthesis="",para="",parallel="",par="",parsim="",parsl="",part="",PartialD="",Pcy="",pcy="",percnt="%",period=".",permil="",perp="",pertenk="",Pfr="",pfr="",Phi="",phi="",phiv="",phmmat="",phone="",Pi="",pi="",pitchfork="",piv="",planck="",planckh="",plankv="",plusacir="",plusb="",pluscir="",plus="+",plusdo="",plusdu="",pluse="",PlusMinus="",plusmn="",plussim="",plustwo="",pm="",Poincareplane="",pointint="",popf="",Popf="",pound="",prap="",Pr="",pr="",prcue="",precapprox="",prec="",preccurlyeq="",Precedes="",PrecedesEqual="",PrecedesSlantEqual="",PrecedesTilde="",preceq="",precnapprox="",precneqq="",precnsim="",pre="",prE="",precsim="",prime="",Prime="",primes="",prnap="",prnE="",prnsim="",prod="",Product="",profalar="",profline="",profsurf="",prop="",Proportional="",Proportion="",propto="",prsim="",prurel="",Pscr="",pscr="",Psi="",psi="",puncsp="",Qfr="",qfr="",qint="",qopf="",Qopf="",qprime="",Qscr="",qscr="",quaternions="",quatint="",quest="?",questeq="",quot='"',QUOT='"',rAarr="",race="",Racute="",racute="",radic="",raemptyv="",rang="",Rang="",rangd="",range="",rangle="",raquo="",rarrap="",rarrb="",rarrbfs="",rarrc="",rarr="",Rarr="",rArr="",rarrfs="",rarrhk="",rarrlp="",rarrpl="",rarrsim="",Rarrtl="",rarrtl="",rarrw="",ratail="",rAtail="",ratio="",rationals="",rbarr="",rBarr="",RBarr="",rbbrk="",rbrace="}",rbrack="]",rbrke="",rbrksld="",rbrkslu="",Rcaron="",rcaron="",Rcedil="",rcedil="",rceil="",rcub="}",Rcy="",rcy="",rdca="",rdldhar="",rdquo="",rdquor="",rdsh="",real="",realine="",realpart="",reals="",Re="",rect="",reg="",REG="",ReverseElement="",ReverseEquilibrium="",ReverseUpEquilibrium="",rfisht="",rfloor="",rfr="",Rfr="",rHar="",rhard="",rharu="",rharul="",Rho="",rho="",rhov="",RightAngleBracket="",RightArrowBar="",rightarrow="",RightArrow="",Rightarrow="",RightArrowLeftArrow="",rightarrowtail="",RightCeiling="",RightDoubleBracket="",RightDownTeeVector="",RightDownVectorBar="",RightDownVector="",RightFloor="",rightharpoondown="",rightharpoonup="",rightleftarrows="",rightleftharpoons="",rightrightarrows="",rightsquigarrow="",RightTeeArrow="",RightTee="",RightTeeVector="",rightthreetimes="",RightTriangleBar="",RightTriangle="",RightTriangleEqual="",RightUpDownVector="",RightUpTeeVector="",RightUpVectorBar="",RightUpVector="",RightVectorBar="",RightVector="",ring="",risingdotseq="",rlarr="",rlhar="",rlm="",rmoustache="",rmoust="",rnmid="",roang="",roarr="",robrk="",ropar="",ropf="",Ropf="",roplus="",rotimes="",RoundImplies="",rpar=")",rpargt="",rppolint="",rrarr="",Rrightarrow="",rsaquo="",rscr="",Rscr="",rsh="",Rsh="",rsqb="]",rsquo="",rsquor="",rthree="",rtimes="",rtri="",rtrie="",rtrif="",rtriltri="",RuleDelayed="",ruluhar="",rx="",Sacute="",sacute="",sbquo="",scap="",Scaron="",scaron="",Sc="",sc="",sccue="",sce="",scE="",Scedil="",scedil="",Scirc="",scirc="",scnap="",scnE="",scnsim="",scpolint="",scsim="",Scy="",scy="",sdotb="",sdot="",sdote="",searhk="",searr="",seArr="",searrow="",sect="",semi=";",seswar="",setminus="",setmn="",sext="",Sfr="",sfr="",sfrown="",sharp="",SHCHcy="",shchcy="",SHcy="",shcy="",ShortDownArrow="",ShortLeftArrow="",shortmid="",shortparallel="",ShortRightArrow="",ShortUpArrow="",shy="",Sigma="",sigma="",sigmaf="",sigmav="",sim="",simdot="",sime="",simeq="",simg="",simgE="",siml="",simlE="",simne="",simplus="",simrarr="",slarr="",SmallCircle="",smallsetminus="",smashp="",smeparsl="",smid="",smile="",smt="",smte="",smtes="",SOFTcy="",softcy="",solbar="",solb="",sol="/",Sopf="",sopf="",spades="",spadesuit="",spar="",sqcap="",sqcaps="",sqcup="",sqcups="",Sqrt="",sqsub="",sqsube="",sqsubset="",sqsubseteq="",sqsup="",sqsupe="",sqsupset="",sqsupseteq="",square="",Square="",SquareIntersection="",SquareSubset="",SquareSubsetEqual="",SquareSuperset="",SquareSupersetEqual="",SquareUnion="",squarf="",squ="",squf="",srarr="",Sscr="",sscr="",ssetmn="",ssmile="",sstarf="",Star="",star="",starf="",straightepsilon="",straightphi="",strns="",sub="",Sub="",subdot="",subE="",sube="",subedot="",submult="",subnE="",subne="",subplus="",subrarr="",subset="",Subset="",subseteq="",subseteqq="",SubsetEqual="",subsetneq="",subsetneqq="",subsim="",subsub="",subsup="",succapprox="",succ="",succcurlyeq="",Succeeds="",SucceedsEqual="",SucceedsSlantEqual="",SucceedsTilde="",succeq="",succnapprox="",succneqq="",succnsim="",succsim="",SuchThat="",sum="",Sum="",sung="",sup1="",sup2="",sup3="",sup="",Sup="",supdot="",supdsub="",supE="",supe="",supedot="",Superset="",SupersetEqual="",suphsol="",suphsub="",suplarr="",supmult="",supnE="",supne="",supplus="",supset="",Supset="",supseteq="",supseteqq="",supsetneq="",supsetneqq="",supsim="",supsub="",supsup="",swarhk="",swarr="",swArr="",swarrow="",swnwar="",szlig="",Tab="\t",target="",Tau="",tau="",tbrk="",Tcaron="",tcaron="",Tcedil="",tcedil="",Tcy="",tcy="",tdot="",telrec="",Tfr="",tfr="",there4="",therefore="",Therefore="",Theta="",theta="",thetasym="",thetav="",thickapprox="",thicksim="",ThickSpace="",ThinSpace="",thinsp="",thkap="",thksim="",THORN="",thorn="",tilde="",Tilde="",TildeEqual="",TildeFullEqual="",TildeTilde="",timesbar="",timesb="",times="",timesd="",tint="",toea="",topbot="",topcir="",top="",Topf="",topf="",topfork="",tosa="",tprime="",trade="",TRADE="",triangle="",triangledown="",triangleleft="",trianglelefteq="",triangleq="",triangleright="",trianglerighteq="",tridot="",trie="",triminus="",TripleDot="",triplus="",trisb="",tritime="",trpezium="",Tscr="",tscr="",TScy="",tscy="",TSHcy="",tshcy="",Tstrok="",tstrok="",twixt="",twoheadleftarrow="",twoheadrightarrow="",Uacute="",uacute="",uarr="",Uarr="",uArr="",Uarrocir="",Ubrcy="",ubrcy="",Ubreve="",ubreve="",Ucirc="",ucirc="",Ucy="",ucy="",udarr="",Udblac="",udblac="",udhar="",ufisht="",Ufr="",ufr="",Ugrave="",ugrave="",uHar="",uharl="",uharr="",uhblk="",ulcorn="",ulcorner="",ulcrop="",ultri="",Umacr="",umacr="",uml="",UnderBar="_",UnderBrace="",UnderBracket="",UnderParenthesis="",Union="",UnionPlus="",Uogon="",uogon="",Uopf="",uopf="",UpArrowBar="",uparrow="",UpArrow="",Uparrow="",UpArrowDownArrow="",updownarrow="",UpDownArrow="",Updownarrow="",UpEquilibrium="",upharpoonleft="",upharpoonright="",uplus="",UpperLeftArrow="",UpperRightArrow="",upsi="",Upsi="",upsih="",Upsilon="",upsilon="",UpTeeArrow="",UpTee="",upuparrows="",urcorn="",urcorner="",urcrop="",Uring="",uring="",urtri="",Uscr="",uscr="",utdot="",Utilde="",utilde="",utri="",utrif="",uuarr="",Uuml="",uuml="",uwangle="",vangrt="",varepsilon="",varkappa="",varnothing="",varphi="",varpi="",varpropto="",varr="",vArr="",varrho="",varsigma="",varsubsetneq="",varsubsetneqq="",varsupsetneq="",varsupsetneqq="",vartheta="",vartriangleleft="",vartriangleright="",vBar="",Vbar="",vBarv="",Vcy="",vcy="",vdash="",vDash="",Vdash="",VDash="",Vdashl="",veebar="",vee="",Vee="",veeeq="",vellip="",verbar="|",Verbar="",vert="|",Vert="",VerticalBar="",VerticalLine="|",VerticalSeparator="",VerticalTilde="",VeryThinSpace="",Vfr="",vfr="",vltri="",vnsub="",vnsup="",Vopf="",vopf="",vprop="",vrtri="",Vscr="",vscr="",vsubnE="",vsubne="",vsupnE="",vsupne="",Vvdash="",vzigzag="",Wcirc="",wcirc="",wedbar="",wedge="",Wedge="",wedgeq="",weierp="",Wfr="",wfr="",Wopf="",wopf="",wp="",wr="",wreath="",Wscr="",wscr="",xcap="",xcirc="",xcup="",xdtri="",Xfr="",xfr="",xharr="",xhArr="",Xi="",xi="",xlarr="",xlArr="",xmap="",xnis="",xodot="",Xopf="",xopf="",xoplus="",xotime="",xrarr="",xrArr="",Xscr="",xscr="",xsqcup="",xuplus="",xutri="",xvee="",xwedge="",Yacute="",yacute="",YAcy="",yacy="",Ycirc="",ycirc="",Ycy="",ycy="",yen="",Yfr="",yfr="",YIcy="",yicy="",Yopf="",yopf="",Yscr="",yscr="",YUcy="",yucy="",yuml="",Yuml="",Zacute="",zacute="",Zcaron="",zcaron="",Zcy="",zcy="",Zdot="",zdot="",zeetrf="",ZeroWidthSpace="",Zeta="",zeta="",zfr="",Zfr="",ZHcy="",zhcy="",zigrarr="",zopf="",Zopf="",Zscr="",zscr="",zwj="",zwnj="",require$$0={Aacute:Aacute,aacute:aacute,Abreve:Abreve,abreve:abreve,ac:ac,acd:acd,acE:acE,Acirc:Acirc,acirc:acirc,acute:acute,Acy:Acy,acy:acy,AElig:AElig,aelig:aelig,af:af,Afr:Afr,afr:afr,Agrave:Agrave,agrave:agrave,alefsym:alefsym,aleph:aleph,Alpha:Alpha,alpha:alpha,Amacr:Amacr,amacr:amacr,amalg:amalg,amp:amp,AMP:AMP,andand:andand,And:And,and:and,andd:andd,andslope:andslope,andv:andv,ang:ang,ange:ange,angle:angle,angmsdaa:angmsdaa,angmsdab:angmsdab,angmsdac:angmsdac,angmsdad:angmsdad,angmsdae:angmsdae,angmsdaf:angmsdaf,angmsdag:angmsdag,angmsdah:angmsdah,angmsd:angmsd,angrt:angrt,angrtvb:angrtvb,angrtvbd:angrtvbd,angsph:angsph,angst:angst,angzarr:angzarr,Aogon:Aogon,aogon:aogon,Aopf:Aopf,aopf:aopf,apacir:apacir,ap:ap,apE:apE,ape:ape,apid:apid,apos:apos,ApplyFunction:ApplyFunction,approx:approx,approxeq:approxeq,Aring:Aring,aring:aring,Ascr:Ascr,ascr:ascr,Assign:Assign,ast:ast,asymp:asymp,asympeq:asympeq,Atilde:Atilde,atilde:atilde,Auml:Auml,auml:auml,awconint:awconint,awint:awint,backcong:backcong,backepsilon:backepsilon,backprime:backprime,backsim:backsim,backsimeq:backsimeq,Backslash:Backslash,Barv:Barv,barvee:barvee,barwed:barwed,Barwed:Barwed,barwedge:barwedge,bbrk:bbrk,bbrktbrk:bbrktbrk,bcong:bcong,Bcy:Bcy,bcy:bcy,bdquo:bdquo,becaus:becaus,because:because,Because:Because,bemptyv:bemptyv,bepsi:bepsi,bernou:bernou,Bernoullis:Bernoullis,Beta:Beta,beta:beta,beth:beth,between:between,Bfr:Bfr,bfr:bfr,bigcap:bigcap,bigcirc:bigcirc,bigcup:bigcup,bigodot:bigodot,bigoplus:bigoplus,bigotimes:bigotimes,bigsqcup:bigsqcup,bigstar:bigstar,bigtriangledown:bigtriangledown,bigtriangleup:bigtriangleup,biguplus:biguplus,bigvee:bigvee,bigwedge:bigwedge,bkarow:bkarow,blacklozenge:blacklozenge,blacksquare:blacksquare,blacktriangle:blacktriangle,blacktriangledown:blacktriangledown,blacktriangleleft:blacktriangleleft,blacktriangleright:blacktriangleright,blank:blank,blk12:blk12,blk14:blk14,blk34:blk34,block:block$1,bne:bne,bnequiv:bnequiv,bNot:bNot,bnot:bnot,Bopf:Bopf,bopf:bopf,bot:bot,bottom:bottom,bowtie:bowtie,boxbox:boxbox,boxdl:boxdl,boxdL:boxdL,boxDl:boxDl,boxDL:boxDL,boxdr:boxdr,boxdR:boxdR,boxDr:boxDr,boxDR:boxDR,boxh:boxh,boxH:boxH,boxhd:boxhd,boxHd:boxHd,boxhD:boxhD,boxHD:boxHD,boxhu:boxhu,boxHu:boxHu,boxhU:boxhU,boxHU:boxHU,boxminus:boxminus,boxplus:boxplus,boxtimes:boxtimes,boxul:boxul,boxuL:boxuL,boxUl:boxUl,boxUL:boxUL,boxur:boxur,boxuR:boxuR,boxUr:boxUr,boxUR:boxUR,boxv:boxv,boxV:boxV,boxvh:boxvh,boxvH:boxvH,boxVh:boxVh,boxVH:boxVH,boxvl:boxvl,boxvL:boxvL,boxVl:boxVl,boxVL:boxVL,boxvr:boxvr,boxvR:boxvR,boxVr:boxVr,boxVR:boxVR,bprime:bprime,breve:breve,Breve:Breve,brvbar:brvbar,bscr:bscr,Bscr:Bscr,bsemi:bsemi,bsim:bsim,bsime:bsime,bsolb:bsolb,bsol:bsol,bsolhsub:bsolhsub,bull:bull,bullet:bullet,bump:bump,bumpE:bumpE,bumpe:bumpe,Bumpeq:Bumpeq,bumpeq:bumpeq,Cacute:Cacute,cacute:cacute,capand:capand,capbrcup:capbrcup,capcap:capcap,cap:cap,Cap:Cap,capcup:capcup,capdot:capdot,CapitalDifferentialD:CapitalDifferentialD,caps:caps,caret:caret,caron:caron,Cayleys:Cayleys,ccaps:ccaps,Ccaron:Ccaron,ccaron:ccaron,Ccedil:Ccedil,ccedil:ccedil,Ccirc:Ccirc,ccirc:ccirc,Cconint:Cconint,ccups:ccups,ccupssm:ccupssm,Cdot:Cdot,cdot:cdot,cedil:cedil,Cedilla:Cedilla,cemptyv:cemptyv,cent:cent,centerdot:centerdot,CenterDot:CenterDot,cfr:cfr,Cfr:Cfr,CHcy:CHcy,chcy:chcy,check:check,checkmark:checkmark,Chi:Chi,chi:chi,circ:circ,circeq:circeq,circlearrowleft:circlearrowleft,circlearrowright:circlearrowright,circledast:circledast,circledcirc:circledcirc,circleddash:circleddash,CircleDot:CircleDot,circledR:circledR,circledS:circledS,CircleMinus:CircleMinus,CirclePlus:CirclePlus,CircleTimes:CircleTimes,cir:cir,cirE:cirE,cire:cire,cirfnint:cirfnint,cirmid:cirmid,cirscir:cirscir,ClockwiseContourIntegral:ClockwiseContourIntegral,CloseCurlyDoubleQuote:CloseCurlyDoubleQuote,CloseCurlyQuote:CloseCurlyQuote,clubs:clubs,clubsuit:clubsuit,colon:colon,Colon:Colon,Colone:Colone,colone:colone,coloneq:coloneq,comma:comma,commat:commat,comp:comp,compfn:compfn,complement:complement,complexes:complexes,cong:cong,congdot:congdot,Congruent:Congruent,conint:conint,Conint:Conint,ContourIntegral:ContourIntegral,copf:copf,Copf:Copf,coprod:coprod,Coproduct:Coproduct,copy:copy,COPY:COPY,copysr:copysr,CounterClockwiseContourIntegral:CounterClockwiseContourIntegral,crarr:crarr,cross:cross,Cross:Cross,Cscr:Cscr,cscr:cscr,csub:csub,csube:csube,csup:csup,csupe:csupe,ctdot:ctdot,cudarrl:cudarrl,cudarrr:cudarrr,cuepr:cuepr,cuesc:cuesc,cularr:cularr,cularrp:cularrp,cupbrcap:cupbrcap,cupcap:cupcap,CupCap:CupCap,cup:cup,Cup:Cup,cupcup:cupcup,cupdot:cupdot,cupor:cupor,cups:cups,curarr:curarr,curarrm:curarrm,curlyeqprec:curlyeqprec,curlyeqsucc:curlyeqsucc,curlyvee:curlyvee,curlywedge:curlywedge,curren:curren,curvearrowleft:curvearrowleft,curvearrowright:curvearrowright,cuvee:cuvee,cuwed:cuwed,cwconint:cwconint,cwint:cwint,cylcty:cylcty,dagger:dagger,Dagger:Dagger,daleth:daleth,darr:darr,Darr:Darr,dArr:dArr,dash:dash,Dashv:Dashv,dashv:dashv,dbkarow:dbkarow,dblac:dblac,Dcaron:Dcaron,dcaron:dcaron,Dcy:Dcy,dcy:dcy,ddagger:ddagger,ddarr:ddarr,DD:DD,dd:dd,DDotrahd:DDotrahd,ddotseq:ddotseq,deg:deg,Del:Del,Delta:Delta,delta:delta,demptyv:demptyv,dfisht:dfisht,Dfr:Dfr,dfr:dfr,dHar:dHar,dharl:dharl,dharr:dharr,DiacriticalAcute:DiacriticalAcute,DiacriticalDot:DiacriticalDot,DiacriticalDoubleAcute:DiacriticalDoubleAcute,DiacriticalGrave:DiacriticalGrave,DiacriticalTilde:DiacriticalTilde,diam:diam,diamond:diamond,Diamond:Diamond,diamondsuit:diamondsuit,diams:diams,die:die,DifferentialD:DifferentialD,digamma:digamma,disin:disin,div:div,divide:divide,divideontimes:divideontimes,divonx:divonx,DJcy:DJcy,djcy:djcy,dlcorn:dlcorn,dlcrop:dlcrop,dollar:dollar,Dopf:Dopf,dopf:dopf,Dot:Dot,dot:dot,DotDot:DotDot,doteq:doteq,doteqdot:doteqdot,DotEqual:DotEqual,dotminus:dotminus,dotplus:dotplus,dotsquare:dotsquare,doublebarwedge:doublebarwedge,DoubleContourIntegral:DoubleContourIntegral,DoubleDot:DoubleDot,DoubleDownArrow:DoubleDownArrow,DoubleLeftArrow:DoubleLeftArrow,DoubleLeftRightArrow:DoubleLeftRightArrow,DoubleLeftTee:DoubleLeftTee,DoubleLongLeftArrow:DoubleLongLeftArrow,DoubleLongLeftRightArrow:DoubleLongLeftRightArrow,DoubleLongRightArrow:DoubleLongRightArrow,DoubleRightArrow:DoubleRightArrow,DoubleRightTee:DoubleRightTee,DoubleUpArrow:DoubleUpArrow,DoubleUpDownArrow:DoubleUpDownArrow,DoubleVerticalBar:DoubleVerticalBar,DownArrowBar:DownArrowBar,downarrow:downarrow,DownArrow:DownArrow,Downarrow:Downarrow,DownArrowUpArrow:DownArrowUpArrow,DownBreve:DownBreve,downdownarrows:downdownarrows,downharpoonleft:downharpoonleft,downharpoonright:downharpoonright,DownLeftRightVector:DownLeftRightVector,DownLeftTeeVector:DownLeftTeeVector,DownLeftVectorBar:DownLeftVectorBar,DownLeftVector:DownLeftVector,DownRightTeeVector:DownRightTeeVector,DownRightVectorBar:DownRightVectorBar,DownRightVector:DownRightVector,DownTeeArrow:DownTeeArrow,DownTee:DownTee,drbkarow:drbkarow,drcorn:drcorn,drcrop:drcrop,Dscr:Dscr,dscr:dscr,DScy:DScy,dscy:dscy,dsol:dsol,Dstrok:Dstrok,dstrok:dstrok,dtdot:dtdot,dtri:dtri,dtrif:dtrif,duarr:duarr,duhar:duhar,dwangle:dwangle,DZcy:DZcy,dzcy:dzcy,dzigrarr:dzigrarr,Eacute:Eacute,eacute:eacute,easter:easter,Ecaron:Ecaron,ecaron:ecaron,Ecirc:Ecirc,ecirc:ecirc,ecir:ecir,ecolon:ecolon,Ecy:Ecy,ecy:ecy,eDDot:eDDot,Edot:Edot,edot:edot,eDot:eDot,ee:ee,efDot:efDot,Efr:Efr,efr:efr,eg:eg,Egrave:Egrave,egrave:egrave,egs:egs,egsdot:egsdot,el:el,Element:Element$1,elinters:elinters,ell:ell,els:els,elsdot:elsdot,Emacr:Emacr,emacr:emacr,empty:empty,emptyset:emptyset,EmptySmallSquare:EmptySmallSquare,emptyv:emptyv,EmptyVerySmallSquare:EmptyVerySmallSquare,emsp13:emsp13,emsp14:emsp14,emsp:emsp,ENG:ENG,eng:eng,ensp:ensp,Eogon:Eogon,eogon:eogon,Eopf:Eopf,eopf:eopf,epar:epar,eparsl:eparsl,eplus:eplus,epsi:epsi,Epsilon:Epsilon,epsilon:epsilon,epsiv:epsiv,eqcirc:eqcirc,eqcolon:eqcolon,eqsim:eqsim,eqslantgtr:eqslantgtr,eqslantless:eqslantless,Equal:Equal,equals:equals,EqualTilde:EqualTilde,equest:equest,Equilibrium:Equilibrium,equiv:equiv,equivDD:equivDD,eqvparsl:eqvparsl,erarr:erarr,erDot:erDot,escr:escr,Escr:Escr,esdot:esdot,Esim:Esim,esim:esim,Eta:Eta,eta:eta,ETH:ETH,eth:eth,Euml:Euml,euml:euml,euro:euro,excl:excl,exist:exist,Exists:Exists,expectation:expectation,exponentiale:exponentiale,ExponentialE:ExponentialE,fallingdotseq:fallingdotseq,Fcy:Fcy,fcy:fcy,female:female,ffilig:ffilig,fflig:fflig,ffllig:ffllig,Ffr:Ffr,ffr:ffr,filig:filig,FilledSmallSquare:FilledSmallSquare,FilledVerySmallSquare:FilledVerySmallSquare,fjlig:fjlig,flat:flat,fllig:fllig,fltns:fltns,fnof:fnof,Fopf:Fopf,fopf:fopf,forall:forall,ForAll:ForAll,fork:fork,forkv:forkv,Fouriertrf:Fouriertrf,fpartint:fpartint,frac12:frac12,frac13:frac13,frac14:frac14,frac15:frac15,frac16:frac16,frac18:frac18,frac23:frac23,frac25:frac25,frac34:frac34,frac35:frac35,frac38:frac38,frac45:frac45,frac56:frac56,frac58:frac58,frac78:frac78,frasl:frasl,frown:frown,fscr:fscr,Fscr:Fscr,gacute:gacute,Gamma:Gamma,gamma:gamma,Gammad:Gammad,gammad:gammad,gap:gap,Gbreve:Gbreve,gbreve:gbreve,Gcedil:Gcedil,Gcirc:Gcirc,gcirc:gcirc,Gcy:Gcy,gcy:gcy,Gdot:Gdot,gdot:gdot,ge:ge,gE:gE,gEl:gEl,gel:gel,geq:geq,geqq:geqq,geqslant:geqslant,gescc:gescc,ges:ges,gesdot:gesdot,gesdoto:gesdoto,gesdotol:gesdotol,gesl:gesl,gesles:gesles,Gfr:Gfr,gfr:gfr,gg:gg,Gg:Gg,ggg:ggg,gimel:gimel,GJcy:GJcy,gjcy:gjcy,gla:gla,gl:gl,glE:glE,glj:glj,gnap:gnap,gnapprox:gnapprox,gne:gne,gnE:gnE,gneq:gneq,gneqq:gneqq,gnsim:gnsim,Gopf:Gopf,gopf:gopf,grave:grave,GreaterEqual:GreaterEqual,GreaterEqualLess:GreaterEqualLess,GreaterFullEqual:GreaterFullEqual,GreaterGreater:GreaterGreater,GreaterLess:GreaterLess,GreaterSlantEqual:GreaterSlantEqual,GreaterTilde:GreaterTilde,Gscr:Gscr,gscr:gscr,gsim:gsim,gsime:gsime,gsiml:gsiml,gtcc:gtcc,gtcir:gtcir,gt:gt,GT:GT,Gt:Gt,gtdot:gtdot,gtlPar:gtlPar,gtquest:gtquest,gtrapprox:gtrapprox,gtrarr:gtrarr,gtrdot:gtrdot,gtreqless:gtreqless,gtreqqless:gtreqqless,gtrless:gtrless,gtrsim:gtrsim,gvertneqq:gvertneqq,gvnE:gvnE,Hacek:Hacek,hairsp:hairsp,half:half,hamilt:hamilt,HARDcy:HARDcy,hardcy:hardcy,harrcir:harrcir,harr:harr,hArr:hArr,harrw:harrw,Hat:Hat,hbar:hbar,Hcirc:Hcirc,hcirc:hcirc,hearts:hearts,heartsuit:heartsuit,hellip:hellip,hercon:hercon,hfr:hfr,Hfr:Hfr,HilbertSpace:HilbertSpace,hksearow:hksearow,hkswarow:hkswarow,hoarr:hoarr,homtht:homtht,hookleftarrow:hookleftarrow,hookrightarrow:hookrightarrow,hopf:hopf,Hopf:Hopf,horbar:horbar,HorizontalLine:HorizontalLine,hscr:hscr,Hscr:Hscr,hslash:hslash,Hstrok:Hstrok,hstrok:hstrok,HumpDownHump:HumpDownHump,HumpEqual:HumpEqual,hybull:hybull,hyphen:hyphen,Iacute:Iacute,iacute:iacute,ic:ic,Icirc:Icirc,icirc:icirc,Icy:Icy,icy:icy,Idot:Idot,IEcy:IEcy,iecy:iecy,iexcl:iexcl,iff:iff,ifr:ifr,Ifr:Ifr,Igrave:Igrave,igrave:igrave,ii:ii,iiiint:iiiint,iiint:iiint,iinfin:iinfin,iiota:iiota,IJlig:IJlig,ijlig:ijlig,Imacr:Imacr,imacr:imacr,image:image$1,ImaginaryI:ImaginaryI,imagline:imagline,imagpart:imagpart,imath:imath,Im:Im,imof:imof,imped:imped,Implies:Implies,incare:incare,in:"",infin:infin,infintie:infintie,inodot:inodot,intcal:intcal,int:int,Int:Int,integers:integers,Integral:Integral,intercal:intercal,Intersection:Intersection$1,intlarhk:intlarhk,intprod:intprod,InvisibleComma:InvisibleComma,InvisibleTimes:InvisibleTimes,IOcy:IOcy,iocy:iocy,Iogon:Iogon,iogon:iogon,Iopf:Iopf,iopf:iopf,Iota:Iota,iota:iota,iprod:iprod,iquest:iquest,iscr:iscr,Iscr:Iscr,isin:isin,isindot:isindot,isinE:isinE,isins:isins,isinsv:isinsv,isinv:isinv,it:it,Itilde:Itilde,itilde:itilde,Iukcy:Iukcy,iukcy:iukcy,Iuml:Iuml,iuml:iuml,Jcirc:Jcirc,jcirc:jcirc,Jcy:Jcy,jcy:jcy,Jfr:Jfr,jfr:jfr,jmath:jmath,Jopf:Jopf,jopf:jopf,Jscr:Jscr,jscr:jscr,Jsercy:Jsercy,jsercy:jsercy,Jukcy:Jukcy,jukcy:jukcy,Kappa:Kappa,kappa:kappa,kappav:kappav,Kcedil:Kcedil,kcedil:kcedil,Kcy:Kcy,kcy:kcy,Kfr:Kfr,kfr:kfr,kgreen:kgreen,KHcy:KHcy,khcy:khcy,KJcy:KJcy,kjcy:kjcy,Kopf:Kopf,kopf:kopf,Kscr:Kscr,kscr:kscr,lAarr:lAarr,Lacute:Lacute,lacute:lacute,laemptyv:laemptyv,lagran:lagran,Lambda:Lambda,lambda:lambda,lang:lang,Lang:Lang,langd:langd,langle:langle,lap:lap,Laplacetrf:Laplacetrf,laquo:laquo,larrb:larrb,larrbfs:larrbfs,larr:larr,Larr:Larr,lArr:lArr,larrfs:larrfs,larrhk:larrhk,larrlp:larrlp,larrpl:larrpl,larrsim:larrsim,larrtl:larrtl,latail:latail,lAtail:lAtail,lat:lat,late:late,lates:lates,lbarr:lbarr,lBarr:lBarr,lbbrk:lbbrk,lbrace:lbrace,lbrack:lbrack,lbrke:lbrke,lbrksld:lbrksld,lbrkslu:lbrkslu,Lcaron:Lcaron,lcaron:lcaron,Lcedil:Lcedil,lcedil:lcedil,lceil:lceil,lcub:lcub,Lcy:Lcy,lcy:lcy,ldca:ldca,ldquo:ldquo,ldquor:ldquor,ldrdhar:ldrdhar,ldrushar:ldrushar,ldsh:ldsh,le:le,lE:lE,LeftAngleBracket:LeftAngleBracket,LeftArrowBar:LeftArrowBar,leftarrow:leftarrow,LeftArrow:LeftArrow,Leftarrow:Leftarrow,LeftArrowRightArrow:LeftArrowRightArrow,leftarrowtail:leftarrowtail,LeftCeiling:LeftCeiling,LeftDoubleBracket:LeftDoubleBracket,LeftDownTeeVector:LeftDownTeeVector,LeftDownVectorBar:LeftDownVectorBar,LeftDownVector:LeftDownVector,LeftFloor:LeftFloor,leftharpoondown:leftharpoondown,leftharpoonup:leftharpoonup,leftleftarrows:leftleftarrows,leftrightarrow:leftrightarrow,LeftRightArrow:LeftRightArrow,Leftrightarrow:Leftrightarrow,leftrightarrows:leftrightarrows,leftrightharpoons:leftrightharpoons,leftrightsquigarrow:leftrightsquigarrow,LeftRightVector:LeftRightVector,LeftTeeArrow:LeftTeeArrow,LeftTee:LeftTee,LeftTeeVector:LeftTeeVector,leftthreetimes:leftthreetimes,LeftTriangleBar:LeftTriangleBar,LeftTriangle:LeftTriangle,LeftTriangleEqual:LeftTriangleEqual,LeftUpDownVector:LeftUpDownVector,LeftUpTeeVector:LeftUpTeeVector,LeftUpVectorBar:LeftUpVectorBar,LeftUpVector:LeftUpVector,LeftVectorBar:LeftVectorBar,LeftVector:LeftVector,lEg:lEg,leg:leg,leq:leq,leqq:leqq,leqslant:leqslant,lescc:lescc,les:les,lesdot:lesdot,lesdoto:lesdoto,lesdotor:lesdotor,lesg:lesg,lesges:lesges,lessapprox:lessapprox,lessdot:lessdot,lesseqgtr:lesseqgtr,lesseqqgtr:lesseqqgtr,LessEqualGreater:LessEqualGreater,LessFullEqual:LessFullEqual,LessGreater:LessGreater,lessgtr:lessgtr,LessLess:LessLess,lesssim:lesssim,LessSlantEqual:LessSlantEqual,LessTilde:LessTilde,lfisht:lfisht,lfloor:lfloor,Lfr:Lfr,lfr:lfr,lg:lg,lgE:lgE,lHar:lHar,lhard:lhard,lharu:lharu,lharul:lharul,lhblk:lhblk,LJcy:LJcy,ljcy:ljcy,llarr:llarr,ll:ll,Ll:Ll,llcorner:llcorner,Lleftarrow:Lleftarrow,llhard:llhard,lltri:lltri,Lmidot:Lmidot,lmidot:lmidot,lmoustache:lmoustache,lmoust:lmoust,lnap:lnap,lnapprox:lnapprox,lne:lne,lnE:lnE,lneq:lneq,lneqq:lneqq,lnsim:lnsim,loang:loang,loarr:loarr,lobrk:lobrk,longleftarrow:longleftarrow,LongLeftArrow:LongLeftArrow,Longleftarrow:Longleftarrow,longleftrightarrow:longleftrightarrow,LongLeftRightArrow:LongLeftRightArrow,Longleftrightarrow:Longleftrightarrow,longmapsto:longmapsto,longrightarrow:longrightarrow,LongRightArrow:LongRightArrow,Longrightarrow:Longrightarrow,looparrowleft:looparrowleft,looparrowright:looparrowright,lopar:lopar,Lopf:Lopf,lopf:lopf,loplus:loplus,lotimes:lotimes,lowast:lowast,lowbar:lowbar,LowerLeftArrow:LowerLeftArrow,LowerRightArrow:LowerRightArrow,loz:loz,lozenge:lozenge,lozf:lozf,lpar:lpar,lparlt:lparlt,lrarr:lrarr,lrcorner:lrcorner,lrhar:lrhar,lrhard:lrhard,lrm:lrm,lrtri:lrtri,lsaquo:lsaquo,lscr:lscr,Lscr:Lscr,lsh:lsh,Lsh:Lsh,lsim:lsim,lsime:lsime,lsimg:lsimg,lsqb:lsqb,lsquo:lsquo,lsquor:lsquor,Lstrok:Lstrok,lstrok:lstrok,ltcc:ltcc,ltcir:ltcir,lt:lt,LT:LT,Lt:Lt,ltdot:ltdot,lthree:lthree,ltimes:ltimes,ltlarr:ltlarr,ltquest:ltquest,ltri:ltri,ltrie:ltrie,ltrif:ltrif,ltrPar:ltrPar,lurdshar:lurdshar,luruhar:luruhar,lvertneqq:lvertneqq,lvnE:lvnE,macr:macr,male:male,malt:malt,maltese:maltese,Map:"",map:map,mapsto:mapsto,mapstodown:mapstodown,mapstoleft:mapstoleft,mapstoup:mapstoup,marker:marker,mcomma:mcomma,Mcy:Mcy,mcy:mcy,mdash:mdash,mDDot:mDDot,measuredangle:measuredangle,MediumSpace:MediumSpace,Mellintrf:Mellintrf,Mfr:Mfr,mfr:mfr,mho:mho,micro:micro,midast:midast,midcir:midcir,mid:mid,middot:middot,minusb:minusb,minus:minus,minusd:minusd,minusdu:minusdu,MinusPlus:MinusPlus,mlcp:mlcp,mldr:mldr,mnplus:mnplus,models:models,Mopf:Mopf,mopf:mopf,mp:mp,mscr:mscr,Mscr:Mscr,mstpos:mstpos,Mu:Mu,mu:mu,multimap:multimap,mumap:mumap,nabla:nabla,Nacute:Nacute,nacute:nacute,nang:nang,nap:nap,napE:napE,napid:napid,napos:napos,napprox:napprox,natural:natural,naturals:naturals,natur:natur,nbsp:nbsp,nbump:nbump,nbumpe:nbumpe,ncap:ncap,Ncaron:Ncaron,ncaron:ncaron,Ncedil:Ncedil,ncedil:ncedil,ncong:ncong,ncongdot:ncongdot,ncup:ncup,Ncy:Ncy,ncy:ncy,ndash:ndash,nearhk:nearhk,nearr:nearr,neArr:neArr,nearrow:nearrow,ne:ne,nedot:nedot,NegativeMediumSpace:NegativeMediumSpace,NegativeThickSpace:NegativeThickSpace,NegativeThinSpace:NegativeThinSpace,NegativeVeryThinSpace:NegativeVeryThinSpace,nequiv:nequiv,nesear:nesear,nesim:nesim,NestedGreaterGreater:NestedGreaterGreater,NestedLessLess:NestedLessLess,NewLine:NewLine,nexist:nexist,nexists:nexists,Nfr:Nfr,nfr:nfr,ngE:ngE,nge:nge,ngeq:ngeq,ngeqq:ngeqq,ngeqslant:ngeqslant,nges:nges,nGg:nGg,ngsim:ngsim,nGt:nGt,ngt:ngt,ngtr:ngtr,nGtv:nGtv,nharr:nharr,nhArr:nhArr,nhpar:nhpar,ni:ni,nis:nis,nisd:nisd,niv:niv,NJcy:NJcy,njcy:njcy,nlarr:nlarr,nlArr:nlArr,nldr:nldr,nlE:nlE,nle:nle,nleftarrow:nleftarrow,nLeftarrow:nLeftarrow,nleftrightarrow:nleftrightarrow,nLeftrightarrow:nLeftrightarrow,nleq:nleq,nleqq:nleqq,nleqslant:nleqslant,nles:nles,nless:nless,nLl:nLl,nlsim:nlsim,nLt:nLt,nlt:nlt,nltri:nltri,nltrie:nltrie,nLtv:nLtv,nmid:nmid,NoBreak:NoBreak,NonBreakingSpace:NonBreakingSpace,nopf:nopf,Nopf:Nopf,Not:Not,not:not,NotCongruent:NotCongruent,NotCupCap:NotCupCap,NotDoubleVerticalBar:NotDoubleVerticalBar,NotElement:NotElement,NotEqual:NotEqual,NotEqualTilde:NotEqualTilde,NotExists:NotExists,NotGreater:NotGreater,NotGreaterEqual:NotGreaterEqual,NotGreaterFullEqual:NotGreaterFullEqual,NotGreaterGreater:NotGreaterGreater,NotGreaterLess:NotGreaterLess,NotGreaterSlantEqual:NotGreaterSlantEqual,NotGreaterTilde:NotGreaterTilde,NotHumpDownHump:NotHumpDownHump,NotHumpEqual:NotHumpEqual,notin:notin,notindot:notindot,notinE:notinE,notinva:notinva,notinvb:notinvb,notinvc:notinvc,NotLeftTriangleBar:NotLeftTriangleBar,NotLeftTriangle:NotLeftTriangle,NotLeftTriangleEqual:NotLeftTriangleEqual,NotLess:NotLess,NotLessEqual:NotLessEqual,NotLessGreater:NotLessGreater,NotLessLess:NotLessLess,NotLessSlantEqual:NotLessSlantEqual,NotLessTilde:NotLessTilde,NotNestedGreaterGreater:NotNestedGreaterGreater,NotNestedLessLess:NotNestedLessLess,notni:notni,notniva:notniva,notnivb:notnivb,notnivc:notnivc,NotPrecedes:NotPrecedes,NotPrecedesEqual:NotPrecedesEqual,NotPrecedesSlantEqual:NotPrecedesSlantEqual,NotReverseElement:NotReverseElement,NotRightTriangleBar:NotRightTriangleBar,NotRightTriangle:NotRightTriangle,NotRightTriangleEqual:NotRightTriangleEqual,NotSquareSubset:NotSquareSubset,NotSquareSubsetEqual:NotSquareSubsetEqual,NotSquareSuperset:NotSquareSuperset,NotSquareSupersetEqual:NotSquareSupersetEqual,NotSubset:NotSubset,NotSubsetEqual:NotSubsetEqual,NotSucceeds:NotSucceeds,NotSucceedsEqual:NotSucceedsEqual,NotSucceedsSlantEqual:NotSucceedsSlantEqual,NotSucceedsTilde:NotSucceedsTilde,NotSuperset:NotSuperset,NotSupersetEqual:NotSupersetEqual,NotTilde:NotTilde,NotTildeEqual:NotTildeEqual,NotTildeFullEqual:NotTildeFullEqual,NotTildeTilde:NotTildeTilde,NotVerticalBar:NotVerticalBar,nparallel:nparallel,npar:npar,nparsl:nparsl,npart:npart,npolint:npolint,npr:npr,nprcue:nprcue,nprec:nprec,npreceq:npreceq,npre:npre,nrarrc:nrarrc,nrarr:nrarr,nrArr:nrArr,nrarrw:nrarrw,nrightarrow:nrightarrow,nRightarrow:nRightarrow,nrtri:nrtri,nrtrie:nrtrie,nsc:nsc,nsccue:nsccue,nsce:nsce,Nscr:Nscr,nscr:nscr,nshortmid:nshortmid,nshortparallel:nshortparallel,nsim:nsim,nsime:nsime,nsimeq:nsimeq,nsmid:nsmid,nspar:nspar,nsqsube:nsqsube,nsqsupe:nsqsupe,nsub:nsub,nsubE:nsubE,nsube:nsube,nsubset:nsubset,nsubseteq:nsubseteq,nsubseteqq:nsubseteqq,nsucc:nsucc,nsucceq:nsucceq,nsup:nsup,nsupE:nsupE,nsupe:nsupe,nsupset:nsupset,nsupseteq:nsupseteq,nsupseteqq:nsupseteqq,ntgl:ntgl,Ntilde:Ntilde,ntilde:ntilde,ntlg:ntlg,ntriangleleft:ntriangleleft,ntrianglelefteq:ntrianglelefteq,ntriangleright:ntriangleright,ntrianglerighteq:ntrianglerighteq,Nu:Nu,nu:nu,num:num,numero:numero,numsp:numsp,nvap:nvap,nvdash:nvdash,nvDash:nvDash,nVdash:nVdash,nVDash:nVDash,nvge:nvge,nvgt:nvgt,nvHarr:nvHarr,nvinfin:nvinfin,nvlArr:nvlArr,nvle:nvle,nvlt:nvlt,nvltrie:nvltrie,nvrArr:nvrArr,nvrtrie:nvrtrie,nvsim:nvsim,nwarhk:nwarhk,nwarr:nwarr,nwArr:nwArr,nwarrow:nwarrow,nwnear:nwnear,Oacute:Oacute,oacute:oacute,oast:oast,Ocirc:Ocirc,ocirc:ocirc,ocir:ocir,Ocy:Ocy,ocy:ocy,odash:odash,Odblac:Odblac,odblac:odblac,odiv:odiv,odot:odot,odsold:odsold,OElig:OElig,oelig:oelig,ofcir:ofcir,Ofr:Ofr,ofr:ofr,ogon:ogon,Ograve:Ograve,ograve:ograve,ogt:ogt,ohbar:ohbar,ohm:ohm,oint:oint,olarr:olarr,olcir:olcir,olcross:olcross,oline:oline,olt:olt,Omacr:Omacr,omacr:omacr,Omega:Omega,omega:omega,Omicron:Omicron,omicron:omicron,omid:omid,ominus:ominus,Oopf:Oopf,oopf:oopf,opar:opar,OpenCurlyDoubleQuote:OpenCurlyDoubleQuote,OpenCurlyQuote:OpenCurlyQuote,operp:operp,oplus:oplus,orarr:orarr,Or:Or,or:or,ord:ord,order:order,orderof:orderof,ordf:ordf,ordm:ordm,origof:origof,oror:oror,orslope:orslope,orv:orv,oS:oS,Oscr:Oscr,oscr:oscr,Oslash:Oslash,oslash:oslash,osol:osol,Otilde:Otilde,otilde:otilde,otimesas:otimesas,Otimes:Otimes,otimes:otimes,Ouml:Ouml,ouml:ouml,ovbar:ovbar,OverBar:OverBar,OverBrace:OverBrace,OverBracket:OverBracket,OverParenthesis:OverParenthesis,para:para,parallel:parallel,par:par,parsim:parsim,parsl:parsl,part:part,PartialD:PartialD,Pcy:Pcy,pcy:pcy,percnt:percnt,period:period,permil:permil,perp:perp,pertenk:pertenk,Pfr:Pfr,pfr:pfr,Phi:Phi,phi:phi,phiv:phiv,phmmat:phmmat,phone:phone,Pi:Pi,pi:pi,pitchfork:pitchfork,piv:piv,planck:planck,planckh:planckh,plankv:plankv,plusacir:plusacir,plusb:plusb,pluscir:pluscir,plus:plus,plusdo:plusdo,plusdu:plusdu,pluse:pluse,PlusMinus:PlusMinus,plusmn:plusmn,plussim:plussim,plustwo:plustwo,pm:pm,Poincareplane:Poincareplane,pointint:pointint,popf:popf,Popf:Popf,pound:pound,prap:prap,Pr:Pr,pr:pr,prcue:prcue,precapprox:precapprox,prec:prec,preccurlyeq:preccurlyeq,Precedes:Precedes,PrecedesEqual:PrecedesEqual,PrecedesSlantEqual:PrecedesSlantEqual,PrecedesTilde:PrecedesTilde,preceq:preceq,precnapprox:precnapprox,precneqq:precneqq,precnsim:precnsim,pre:pre,prE:prE,precsim:precsim,prime:prime,Prime:Prime,primes:primes,prnap:prnap,prnE:prnE,prnsim:prnsim,prod:prod,Product:Product,profalar:profalar,profline:profline,profsurf:profsurf,prop:prop,Proportional:Proportional,Proportion:Proportion,propto:propto,prsim:prsim,prurel:prurel,Pscr:Pscr,pscr:pscr,Psi:Psi,psi:psi,puncsp:puncsp,Qfr:Qfr,qfr:qfr,qint:qint,qopf:qopf,Qopf:Qopf,qprime:qprime,Qscr:Qscr,qscr:qscr,quaternions:quaternions,quatint:quatint,quest:quest,questeq:questeq,quot:quot,QUOT:QUOT,rAarr:rAarr,race:race,Racute:Racute,racute:racute,radic:radic,raemptyv:raemptyv,rang:rang,Rang:Rang,rangd:rangd,range:range,rangle:rangle,raquo:raquo,rarrap:rarrap,rarrb:rarrb,rarrbfs:rarrbfs,rarrc:rarrc,rarr:rarr,Rarr:Rarr,rArr:rArr,rarrfs:rarrfs,rarrhk:rarrhk,rarrlp:rarrlp,rarrpl:rarrpl,rarrsim:rarrsim,Rarrtl:Rarrtl,rarrtl:rarrtl,rarrw:rarrw,ratail:ratail,rAtail:rAtail,ratio:ratio,rationals:rationals,rbarr:rbarr,rBarr:rBarr,RBarr:RBarr,rbbrk:rbbrk,rbrace:rbrace,rbrack:rbrack,rbrke:rbrke,rbrksld:rbrksld,rbrkslu:rbrkslu,Rcaron:Rcaron,rcaron:rcaron,Rcedil:Rcedil,rcedil:rcedil,rceil:rceil,rcub:rcub,Rcy:Rcy,rcy:rcy,rdca:rdca,rdldhar:rdldhar,rdquo:rdquo,rdquor:rdquor,rdsh:rdsh,real:real,realine:realine,realpart:realpart,reals:reals,Re:Re,rect:rect,reg:reg,REG:REG,ReverseElement:ReverseElement,ReverseEquilibrium:ReverseEquilibrium,ReverseUpEquilibrium:ReverseUpEquilibrium,rfisht:rfisht,rfloor:rfloor,rfr:rfr,Rfr:Rfr,rHar:rHar,rhard:rhard,rharu:rharu,rharul:rharul,Rho:Rho,rho:rho,rhov:rhov,RightAngleBracket:RightAngleBracket,RightArrowBar:RightArrowBar,rightarrow:rightarrow,RightArrow:RightArrow,Rightarrow:Rightarrow,RightArrowLeftArrow:RightArrowLeftArrow,rightarrowtail:rightarrowtail,RightCeiling:RightCeiling,RightDoubleBracket:RightDoubleBracket,RightDownTeeVector:RightDownTeeVector,RightDownVectorBar:RightDownVectorBar,RightDownVector:RightDownVector,RightFloor:RightFloor,rightharpoondown:rightharpoondown,rightharpoonup:rightharpoonup,rightleftarrows:rightleftarrows,rightleftharpoons:rightleftharpoons,rightrightarrows:rightrightarrows,rightsquigarrow:rightsquigarrow,RightTeeArrow:RightTeeArrow,RightTee:RightTee,RightTeeVector:RightTeeVector,rightthreetimes:rightthreetimes,RightTriangleBar:RightTriangleBar,RightTriangle:RightTriangle,RightTriangleEqual:RightTriangleEqual,RightUpDownVector:RightUpDownVector,RightUpTeeVector:RightUpTeeVector,RightUpVectorBar:RightUpVectorBar,RightUpVector:RightUpVector,RightVectorBar:RightVectorBar,RightVector:RightVector,ring:ring,risingdotseq:risingdotseq,rlarr:rlarr,rlhar:rlhar,rlm:rlm,rmoustache:rmoustache,rmoust:rmoust,rnmid:rnmid,roang:roang,roarr:roarr,robrk:robrk,ropar:ropar,ropf:ropf,Ropf:Ropf,roplus:roplus,rotimes:rotimes,RoundImplies:RoundImplies,rpar:rpar,rpargt:rpargt,rppolint:rppolint,rrarr:rrarr,Rrightarrow:Rrightarrow,rsaquo:rsaquo,rscr:rscr,Rscr:Rscr,rsh:rsh,Rsh:Rsh,rsqb:rsqb,rsquo:rsquo,rsquor:rsquor,rthree:rthree,rtimes:rtimes,rtri:rtri,rtrie:rtrie,rtrif:rtrif,rtriltri:rtriltri,RuleDelayed:RuleDelayed,ruluhar:ruluhar,rx:rx,Sacute:Sacute,sacute:sacute,sbquo:sbquo,scap:scap,Scaron:Scaron,scaron:scaron,Sc:Sc,sc:sc,sccue:sccue,sce:sce,scE:scE,Scedil:Scedil,scedil:scedil,Scirc:Scirc,scirc:scirc,scnap:scnap,scnE:scnE,scnsim:scnsim,scpolint:scpolint,scsim:scsim,Scy:Scy,scy:scy,sdotb:sdotb,sdot:sdot,sdote:sdote,searhk:searhk,searr:searr,seArr:seArr,searrow:searrow,sect:sect,semi:semi,seswar:seswar,setminus:setminus,setmn:setmn,sext:sext,Sfr:Sfr,sfr:sfr,sfrown:sfrown,sharp:sharp,SHCHcy:SHCHcy,shchcy:shchcy,SHcy:SHcy,shcy:shcy,ShortDownArrow:ShortDownArrow,ShortLeftArrow:ShortLeftArrow,shortmid:shortmid,shortparallel:shortparallel,ShortRightArrow:ShortRightArrow,ShortUpArrow:ShortUpArrow,shy:shy,Sigma:Sigma,sigma:sigma,sigmaf:sigmaf,sigmav:sigmav,sim:sim,simdot:simdot,sime:sime,simeq:simeq,simg:simg,simgE:simgE,siml:siml,simlE:simlE,simne:simne,simplus:simplus,simrarr:simrarr,slarr:slarr,SmallCircle:SmallCircle,smallsetminus:smallsetminus,smashp:smashp,smeparsl:smeparsl,smid:smid,smile:smile,smt:smt,smte:smte,smtes:smtes,SOFTcy:SOFTcy,softcy:softcy,solbar:solbar,solb:solb,sol:sol,Sopf:Sopf,sopf:sopf,spades:spades,spadesuit:spadesuit,spar:spar,sqcap:sqcap,sqcaps:sqcaps,sqcup:sqcup,sqcups:sqcups,Sqrt:Sqrt,sqsub:sqsub,sqsube:sqsube,sqsubset:sqsubset,sqsubseteq:sqsubseteq,sqsup:sqsup,sqsupe:sqsupe,sqsupset:sqsupset,sqsupseteq:sqsupseteq,square:square,Square:Square,SquareIntersection:SquareIntersection,SquareSubset:SquareSubset,SquareSubsetEqual:SquareSubsetEqual,SquareSuperset:SquareSuperset,SquareSupersetEqual:SquareSupersetEqual,SquareUnion:SquareUnion,squarf:squarf,squ:squ,squf:squf,srarr:srarr,Sscr:Sscr,sscr:sscr,ssetmn:ssetmn,ssmile:ssmile,sstarf:sstarf,Star:Star,star:star,starf:starf,straightepsilon:straightepsilon,straightphi:straightphi,strns:strns,sub:sub,Sub:Sub,subdot:subdot,subE:subE,sube:sube,subedot:subedot,submult:submult,subnE:subnE,subne:subne,subplus:subplus,subrarr:subrarr,subset:subset,Subset:Subset,subseteq:subseteq,subseteqq:subseteqq,SubsetEqual:SubsetEqual,subsetneq:subsetneq,subsetneqq:subsetneqq,subsim:subsim,subsub:subsub,subsup:subsup,succapprox:succapprox,succ:succ,succcurlyeq:succcurlyeq,Succeeds:Succeeds,SucceedsEqual:SucceedsEqual,SucceedsSlantEqual:SucceedsSlantEqual,SucceedsTilde:SucceedsTilde,succeq:succeq,succnapprox:succnapprox,succneqq:succneqq,succnsim:succnsim,succsim:succsim,SuchThat:SuchThat,sum:sum,Sum:Sum,sung:sung,sup1:sup1,sup2:sup2,sup3:sup3,sup:sup,Sup:Sup,supdot:supdot,supdsub:supdsub,supE:supE,supe:supe,supedot:supedot,Superset:Superset,SupersetEqual:SupersetEqual,suphsol:suphsol,suphsub:suphsub,suplarr:suplarr,supmult:supmult,supnE:supnE,supne:supne,supplus:supplus,supset:supset,Supset:Supset,supseteq:supseteq,supseteqq:supseteqq,supsetneq:supsetneq,supsetneqq:supsetneqq,supsim:supsim,supsub:supsub,supsup:supsup,swarhk:swarhk,swarr:swarr,swArr:swArr,swarrow:swarrow,swnwar:swnwar,szlig:szlig,Tab:Tab,target:target,Tau:Tau,tau:tau,tbrk:tbrk,Tcaron:Tcaron,tcaron:tcaron,Tcedil:Tcedil,tcedil:tcedil,Tcy:Tcy,tcy:tcy,tdot:tdot,telrec:telrec,Tfr:Tfr,tfr:tfr,there4:there4,therefore:therefore,Therefore:Therefore,Theta:Theta,theta:theta,thetasym:thetasym,thetav:thetav,thickapprox:thickapprox,thicksim:thicksim,ThickSpace:ThickSpace,ThinSpace:ThinSpace,thinsp:thinsp,thkap:thkap,thksim:thksim,THORN:THORN,thorn:thorn,tilde:tilde,Tilde:Tilde,TildeEqual:TildeEqual,TildeFullEqual:TildeFullEqual,TildeTilde:TildeTilde,timesbar:timesbar,timesb:timesb,times:times,timesd:timesd,tint:tint,toea:toea,topbot:topbot,topcir:topcir,top:top,Topf:Topf,topf:topf,topfork:topfork,tosa:tosa,tprime:tprime,trade:trade,TRADE:TRADE,triangle:triangle,triangledown:triangledown,triangleleft:triangleleft,trianglelefteq:trianglelefteq,triangleq:triangleq,triangleright:triangleright,trianglerighteq:trianglerighteq,tridot:tridot,trie:trie,triminus:triminus,TripleDot:TripleDot,triplus:triplus,trisb:trisb,tritime:tritime,trpezium:trpezium,Tscr:Tscr,tscr:tscr,TScy:TScy,tscy:tscy,TSHcy:TSHcy,tshcy:tshcy,Tstrok:Tstrok,tstrok:tstrok,twixt:twixt,twoheadleftarrow:twoheadleftarrow,twoheadrightarrow:twoheadrightarrow,Uacute:Uacute,uacute:uacute,uarr:uarr,Uarr:Uarr,uArr:uArr,Uarrocir:Uarrocir,Ubrcy:Ubrcy,ubrcy:ubrcy,Ubreve:Ubreve,ubreve:ubreve,Ucirc:Ucirc,ucirc:ucirc,Ucy:Ucy,ucy:ucy,udarr:udarr,Udblac:Udblac,udblac:udblac,udhar:udhar,ufisht:ufisht,Ufr:Ufr,ufr:ufr,Ugrave:Ugrave,ugrave:ugrave,uHar:uHar,uharl:uharl,uharr:uharr,uhblk:uhblk,ulcorn:ulcorn,ulcorner:ulcorner,ulcrop:ulcrop,ultri:ultri,Umacr:Umacr,umacr:umacr,uml:uml,UnderBar:UnderBar,UnderBrace:UnderBrace,UnderBracket:UnderBracket,UnderParenthesis:UnderParenthesis,Union:Union,UnionPlus:UnionPlus,Uogon:Uogon,uogon:uogon,Uopf:Uopf,uopf:uopf,UpArrowBar:UpArrowBar,uparrow:uparrow,UpArrow:UpArrow,Uparrow:Uparrow,UpArrowDownArrow:UpArrowDownArrow,updownarrow:updownarrow,UpDownArrow:UpDownArrow,Updownarrow:Updownarrow,UpEquilibrium:UpEquilibrium,upharpoonleft:upharpoonleft,upharpoonright:upharpoonright,uplus:uplus,UpperLeftArrow:UpperLeftArrow,UpperRightArrow:UpperRightArrow,upsi:upsi,Upsi:Upsi,upsih:upsih,Upsilon:Upsilon,upsilon:upsilon,UpTeeArrow:UpTeeArrow,UpTee:UpTee,upuparrows:upuparrows,urcorn:urcorn,urcorner:urcorner,urcrop:urcrop,Uring:Uring,uring:uring,urtri:urtri,Uscr:Uscr,uscr:uscr,utdot:utdot,Utilde:Utilde,utilde:utilde,utri:utri,utrif:utrif,uuarr:uuarr,Uuml:Uuml,uuml:uuml,uwangle:uwangle,vangrt:vangrt,varepsilon:varepsilon,varkappa:varkappa,varnothing:varnothing,varphi:varphi,varpi:varpi,varpropto:varpropto,varr:varr,vArr:vArr,varrho:varrho,varsigma:varsigma,varsubsetneq:varsubsetneq,varsubsetneqq:varsubsetneqq,varsupsetneq:varsupsetneq,varsupsetneqq:varsupsetneqq,vartheta:vartheta,vartriangleleft:vartriangleleft,vartriangleright:vartriangleright,vBar:vBar,Vbar:Vbar,vBarv:vBarv,Vcy:Vcy,vcy:vcy,vdash:vdash,vDash:vDash,Vdash:Vdash,VDash:VDash,Vdashl:Vdashl,veebar:veebar,vee:vee,Vee:Vee,veeeq:veeeq,vellip:vellip,verbar:verbar,Verbar:Verbar,vert:vert,Vert:Vert,VerticalBar:VerticalBar,VerticalLine:VerticalLine,VerticalSeparator:VerticalSeparator,VerticalTilde:VerticalTilde,VeryThinSpace:VeryThinSpace,Vfr:Vfr,vfr:vfr,vltri:vltri,vnsub:vnsub,vnsup:vnsup,Vopf:Vopf,vopf:vopf,vprop:vprop,vrtri:vrtri,Vscr:Vscr,vscr:vscr,vsubnE:vsubnE,vsubne:vsubne,vsupnE:vsupnE,vsupne:vsupne,Vvdash:Vvdash,vzigzag:vzigzag,Wcirc:Wcirc,wcirc:wcirc,wedbar:wedbar,wedge:wedge,Wedge:Wedge,wedgeq:wedgeq,weierp:weierp,Wfr:Wfr,wfr:wfr,Wopf:Wopf,wopf:wopf,wp:wp,wr:wr,wreath:wreath,Wscr:Wscr,wscr:wscr,xcap:xcap,xcirc:xcirc,xcup:xcup,xdtri:xdtri,Xfr:Xfr,xfr:xfr,xharr:xharr,xhArr:xhArr,Xi:Xi,xi:xi,xlarr:xlarr,xlArr:xlArr,xmap:xmap,xnis:xnis,xodot:xodot,Xopf:Xopf,xopf:xopf,xoplus:xoplus,xotime:xotime,xrarr:xrarr,xrArr:xrArr,Xscr:Xscr,xscr:xscr,xsqcup:xsqcup,xuplus:xuplus,xutri:xutri,xvee:xvee,xwedge:xwedge,Yacute:Yacute,yacute:yacute,YAcy:YAcy,yacy:yacy,Ycirc:Ycirc,ycirc:ycirc,Ycy:Ycy,ycy:ycy,yen:yen,Yfr:Yfr,yfr:yfr,YIcy:YIcy,yicy:yicy,Yopf:Yopf,yopf:yopf,Yscr:Yscr,yscr:yscr,YUcy:YUcy,yucy:yucy,yuml:yuml,Yuml:Yuml,Zacute:Zacute,zacute:zacute,Zcaron:Zcaron,zcaron:zcaron,Zcy:Zcy,zcy:zcy,Zdot:Zdot,zdot:zdot,zeetrf:zeetrf,ZeroWidthSpace:ZeroWidthSpace,Zeta:Zeta,zeta:zeta,zfr:zfr,Zfr:Zfr,ZHcy:ZHcy,zhcy:zhcy,zigrarr:zigrarr,zopf:zopf,Zopf:Zopf,Zscr:Zscr,zscr:zscr,zwj:zwj,zwnj:zwnj};var entities,hasRequiredEntities,regex$4,hasRequiredRegex$4;function requireEntities(){return hasRequiredEntities?entities:(hasRequiredEntities=1,entities=require$$0)}function requireRegex$4(){return hasRequiredRegex$4?regex$4:(hasRequiredRegex$4=1,regex$4=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/)}var mdurl={},encode_1,hasRequiredEncode,decode_1,hasRequiredDecode,format,hasRequiredFormat,parse,hasRequiredParse,hasRequiredMdurl;function requireEncode(){if(hasRequiredEncode)return encode_1;hasRequiredEncode=1;var e={};function t(r,n,i){var o,a,s,l,c,u="";for("string"!=typeof n&&(i=n,n=t.defaultChars),void 0===i&&(i=!0),c=function(t){var r,n,i=e[t];if(i)return i;for(i=e[t]=[],r=0;r<128;r++)n=String.fromCharCode(r),/^[0-9a-z]$/i.test(n)?i.push(n):i.push("%"+("0"+r.toString(16).toUpperCase()).slice(-2));for(r=0;r<t.length;r++)i[t.charCodeAt(r)]=t[r];return i}(n),o=0,a=r.length;o<a;o++)if(s=r.charCodeAt(o),i&&37===s&&o+2<a&&/^[0-9a-f]{2}$/i.test(r.slice(o+1,o+3)))u+=r.slice(o,o+3),o+=2;else if(s<128)u+=c[s];else if(s>=55296&&s<=57343){if(s>=55296&&s<=56319&&o+1<a&&(l=r.charCodeAt(o+1))>=56320&&l<=57343){u+=encodeURIComponent(r[o]+r[o+1]),o++;continue}u+="%EF%BF%BD"}else u+=encodeURIComponent(r[o]);return u}return t.defaultChars=";/?:@&=+$,-_.!~*'()#",t.componentChars="-_.!~*'()",encode_1=t}function requireDecode(){if(hasRequiredDecode)return decode_1;hasRequiredDecode=1;var e={};function t(r,n){var i;return"string"!=typeof n&&(n=t.defaultChars),i=function(t){var r,n,i=e[t];if(i)return i;for(i=e[t]=[],r=0;r<128;r++)n=String.fromCharCode(r),i.push(n);for(r=0;r<t.length;r++)i[n=t.charCodeAt(r)]="%"+("0"+n.toString(16).toUpperCase()).slice(-2);return i}(n),r.replace(/(%[a-f0-9]{2})+/gi,(function(e){var t,r,n,o,a,s,l,c="";for(t=0,r=e.length;t<r;t+=3)(n=parseInt(e.slice(t+1,t+3),16))<128?c+=i[n]:192==(224&n)&&t+3<r&&128==(192&(o=parseInt(e.slice(t+4,t+6),16)))?(c+=(l=n<<6&1984|63&o)<128?"":String.fromCharCode(l),t+=3):224==(240&n)&&t+6<r&&(o=parseInt(e.slice(t+4,t+6),16),a=parseInt(e.slice(t+7,t+9),16),128==(192&o)&&128==(192&a))?(c+=(l=n<<12&61440|o<<6&4032|63&a)<2048||l>=55296&&l<=57343?"":String.fromCharCode(l),t+=6):240==(248&n)&&t+9<r&&(o=parseInt(e.slice(t+4,t+6),16),a=parseInt(e.slice(t+7,t+9),16),s=parseInt(e.slice(t+10,t+12),16),128==(192&o)&&128==(192&a)&&128==(192&s))?((l=n<<18&1835008|o<<12&258048|a<<6&4032|63&s)<65536||l>1114111?c+="":(l-=65536,c+=String.fromCharCode(55296+(l>>10),56320+(1023&l))),t+=9):c+="";return c}))}return t.defaultChars=";/?:@&=+$,#",t.componentChars="",decode_1=t}function requireFormat(){return hasRequiredFormat?format:(hasRequiredFormat=1,format=function(e){var t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&-1!==e.hostname.indexOf(":")?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||""})}function requireParse(){if(hasRequiredParse)return parse;function e(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}hasRequiredParse=1;var t=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,n=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,i=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),o=["'"].concat(i),a=["%","/","?",";","#"].concat(o),s=["/","?","#"],l=/^[+a-z0-9A-Z_-]{0,63}$/,c=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,u={javascript:!0,"javascript:":!0},h={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};return e.prototype.parse=function(e,r){var i,o,d,p,f,m=e;if(m=m.trim(),!r&&1===e.split("#").length){var g=n.exec(m);if(g)return this.pathname=g[1],g[2]&&(this.search=g[2]),this}var y=t.exec(m);if(y&&(d=(y=y[0]).toLowerCase(),this.protocol=y,m=m.substr(y.length)),(r||y||m.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(f="//"===m.substr(0,2))||y&&u[y]||(m=m.substr(2),this.slashes=!0)),!u[y]&&(f||y&&!h[y])){var _,v,b=-1;for(i=0;i<s.length;i++)-1!==(p=m.indexOf(s[i]))&&(-1===b||p<b)&&(b=p);for(-1!==(v=-1===b?m.lastIndexOf("@"):m.lastIndexOf("@",b))&&(_=m.slice(0,v),m=m.slice(v+1),this.auth=_),b=-1,i=0;i<a.length;i++)-1!==(p=m.indexOf(a[i]))&&(-1===b||p<b)&&(b=p);-1===b&&(b=m.length),":"===m[b-1]&&b--;var w=m.slice(0,b);m=m.slice(b),this.parseHost(w),this.hostname=this.hostname||"";var x="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!x){var S=this.hostname.split(/\./);for(i=0,o=S.length;i<o;i++){var E=S[i];if(E&&!E.match(l)){for(var T="",A=0,C=E.length;A<C;A++)E.charCodeAt(A)>127?T+="x":T+=E[A];if(!T.match(l)){var I=S.slice(0,i),k=S.slice(i+1),P=E.match(c);P&&(I.push(P[1]),k.unshift(P[2])),k.length&&(m=k.join(".")+m),this.hostname=I.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var M=m.indexOf("#");-1!==M&&(this.hash=m.substr(M),m=m.slice(0,M));var R=m.indexOf("?");return-1!==R&&(this.search=m.substr(R),m=m.slice(0,R)),m&&(this.pathname=m),h[d]&&this.hostname&&!this.pathname&&(this.pathname=""),this},e.prototype.parseHost=function(e){var t=r.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},parse=function(t,r){if(t&&t instanceof e)return t;var n=new e;return n.parse(t,r),n}}function requireMdurl(){return hasRequiredMdurl||(hasRequiredMdurl=1,mdurl.encode=requireEncode(),mdurl.decode=requireDecode(),mdurl.format=requireFormat(),mdurl.parse=requireParse()),mdurl}var uc_micro={},regex$3,hasRequiredRegex$3,regex$2,hasRequiredRegex$2,regex$1,hasRequiredRegex$1,regex,hasRequiredRegex,hasRequiredUc_micro,hasRequiredUtils;function requireRegex$3(){return hasRequiredRegex$3?regex$3:(hasRequiredRegex$3=1,regex$3=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/)}function requireRegex$2(){return hasRequiredRegex$2?regex$2:(hasRequiredRegex$2=1,regex$2=/[\0-\x1F\x7F-\x9F]/)}function requireRegex$1(){return hasRequiredRegex$1?regex$1:(hasRequiredRegex$1=1,regex$1=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/)}function requireRegex(){return hasRequiredRegex?regex:(hasRequiredRegex=1,regex=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/)}function requireUc_micro(){return hasRequiredUc_micro||(hasRequiredUc_micro=1,uc_micro.Any=requireRegex$3(),uc_micro.Cc=requireRegex$2(),uc_micro.Cf=requireRegex$1(),uc_micro.P=requireRegex$4(),uc_micro.Z=requireRegex()),uc_micro}function requireUtils(){return hasRequiredUtils||(hasRequiredUtils=1,function(e){var t=Object.prototype.hasOwnProperty;function r(e,r){return t.call(e,r)}function n(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(!!(65535&~e&&65534!=(65535&e))&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function i(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}var o=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,a=new RegExp(o.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),s=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,l=requireEntities();var c=/[&<>"]/,u=/[&<>"]/g,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function d(e){return h[e]}var p=/[.?*+^$[\]\\(){}|-]/g;var f=requireRegex$4();e.lib={},e.lib.mdurl=requireMdurl(),e.lib.ucmicro=requireUc_micro(),e.assign=function(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach((function(r){e[r]=t[r]}))}})),e},e.isString=function(e){return"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)},e.has=r,e.unescapeMd=function(e){return e.indexOf("\\")<0?e:e.replace(o,"$1")},e.unescapeAll=function(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(a,(function(e,t,o){return t||function(e,t){var o=0;return r(l,t)?l[t]:35===t.charCodeAt(0)&&s.test(t)&&n(o="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?i(o):e}(e,o)}))},e.isValidEntityCode=n,e.fromCodePoint=i,e.escapeHtml=function(e){return c.test(e)?e.replace(u,d):e},e.arrayReplaceAt=function(e,t,r){return[].concat(e.slice(0,t),r,e.slice(t+1))},e.isSpace=function(e){switch(e){case 9:case 32:return!0}return!1},e.isWhiteSpace=function(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},e.isMdAsciiPunct=function(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},e.isPunctChar=function(e){return f.test(e)},e.escapeRE=function(e){return e.replace(p,"\\$&")},e.normalizeReference=function(e){return e=e.trim().replace(/\s+/g," "),""==="".toLowerCase()&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}}(utils)),utils}var helpers={},parse_link_label,hasRequiredParse_link_label,parse_link_destination,hasRequiredParse_link_destination,parse_link_title,hasRequiredParse_link_title,hasRequiredHelpers,renderer,hasRequiredRenderer,ruler,hasRequiredRuler,normalize,hasRequiredNormalize,block,hasRequiredBlock,inline,hasRequiredInline,linkify,hasRequiredLinkify,replacements,hasRequiredReplacements,smartquotes,hasRequiredSmartquotes,token,hasRequiredToken,state_core,hasRequiredState_core,parser_core,hasRequiredParser_core,table,hasRequiredTable,code,hasRequiredCode,fence,hasRequiredFence,blockquote,hasRequiredBlockquote,hr,hasRequiredHr,list,hasRequiredList,reference,hasRequiredReference,html_blocks,hasRequiredHtml_blocks;function requireParse_link_label(){return hasRequiredParse_link_label?parse_link_label:(hasRequiredParse_link_label=1,parse_link_label=function(e,t,r){var n,i,o,a,s=-1,l=e.posMax,c=e.pos;for(e.pos=t+1,n=1;e.pos<l;){if(93===(o=e.src.charCodeAt(e.pos))&&0===--n){i=!0;break}if(a=e.pos,e.md.inline.skipToken(e),91===o)if(a===e.pos-1)n++;else if(r)return e.pos=c,-1}return i&&(s=e.pos),e.pos=c,s})}function requireParse_link_destination(){if(hasRequiredParse_link_destination)return parse_link_destination;hasRequiredParse_link_destination=1;var e=requireUtils().unescapeAll;return parse_link_destination=function(t,r,n){var i,o,a=r,s={ok:!1,pos:0,lines:0,str:""};if(60===t.charCodeAt(r)){for(r++;r<n;){if(10===(i=t.charCodeAt(r)))return s;if(60===i)return s;if(62===i)return s.pos=r+1,s.str=e(t.slice(a+1,r)),s.ok=!0,s;92===i&&r+1<n?r+=2:r++}return s}for(o=0;r<n&&32!==(i=t.charCodeAt(r))&&!(i<32||127===i);)if(92===i&&r+1<n){if(32===t.charCodeAt(r+1))break;r+=2}else{if(40===i&&++o>32)return s;if(41===i){if(0===o)break;o--}r++}return a===r||0!==o||(s.str=e(t.slice(a,r)),s.lines=0,s.pos=r,s.ok=!0),s}}function requireParse_link_title(){if(hasRequiredParse_link_title)return parse_link_title;hasRequiredParse_link_title=1;var e=requireUtils().unescapeAll;return parse_link_title=function(t,r,n){var i,o,a=0,s=r,l={ok:!1,pos:0,lines:0,str:""};if(r>=n)return l;if(34!==(o=t.charCodeAt(r))&&39!==o&&40!==o)return l;for(r++,40===o&&(o=41);r<n;){if((i=t.charCodeAt(r))===o)return l.pos=r+1,l.lines=a,l.str=e(t.slice(s+1,r)),l.ok=!0,l;if(40===i&&41===o)return l;10===i?a++:92===i&&r+1<n&&(r++,10===t.charCodeAt(r)&&a++),r++}return l}}function requireHelpers(){return hasRequiredHelpers||(hasRequiredHelpers=1,helpers.parseLinkLabel=requireParse_link_label(),helpers.parseLinkDestination=requireParse_link_destination(),helpers.parseLinkTitle=requireParse_link_title()),helpers}function requireRenderer(){if(hasRequiredRenderer)return renderer;hasRequiredRenderer=1;var e=requireUtils().assign,t=requireUtils().unescapeAll,r=requireUtils().escapeHtml,n={};function i(){this.rules=e({},n)}return n.code_inline=function(e,t,n,i,o){var a=e[t];return"<code"+o.renderAttrs(a)+">"+r(e[t].content)+"</code>"},n.code_block=function(e,t,n,i,o){var a=e[t];return"<pre"+o.renderAttrs(a)+"><code>"+r(e[t].content)+"</code></pre>\n"},n.fence=function(e,n,i,o,a){var s,l,c,u,h,d=e[n],p=d.info?t(d.info).trim():"",f="",m="";return p&&(f=(c=p.split(/(\s+)/g))[0],m=c.slice(2).join("")),0===(s=i.highlight&&i.highlight(d.content,f,m)||r(d.content)).indexOf("<pre")?s+"\n":p?(l=d.attrIndex("class"),u=d.attrs?d.attrs.slice():[],l<0?u.push(["class",i.langPrefix+f]):(u[l]=u[l].slice(),u[l][1]+=" "+i.langPrefix+f),h={attrs:u},"<pre><code"+a.renderAttrs(h)+">"+s+"</code></pre>\n"):"<pre><code"+a.renderAttrs(d)+">"+s+"</code></pre>\n"},n.image=function(e,t,r,n,i){var o=e[t];return o.attrs[o.attrIndex("alt")][1]=i.renderInlineAsText(o.children,r,n),i.renderToken(e,t,r)},n.hardbreak=function(e,t,r){return r.xhtmlOut?"<br />\n":"<br>\n"},n.softbreak=function(e,t,r){return r.breaks?r.xhtmlOut?"<br />\n":"<br>\n":"\n"},n.text=function(e,t){return r(e[t].content)},n.html_block=function(e,t){return e[t].content},n.html_inline=function(e,t){return e[t].content},i.prototype.renderAttrs=function(e){var t,n,i;if(!e.attrs)return"";for(i="",t=0,n=e.attrs.length;t<n;t++)i+=" "+r(e.attrs[t][0])+'="'+r(e.attrs[t][1])+'"';return i},i.prototype.renderToken=function(e,t,r){var n,i="",o=!1,a=e[t];return a.hidden?"":(a.block&&-1!==a.nesting&&t&&e[t-1].hidden&&(i+="\n"),i+=(-1===a.nesting?"</":"<")+a.tag,i+=this.renderAttrs(a),0===a.nesting&&r.xhtmlOut&&(i+=" /"),a.block&&(o=!0,1===a.nesting&&t+1<e.length&&("inline"===(n=e[t+1]).type||n.hidden||-1===n.nesting&&n.tag===a.tag)&&(o=!1)),i+=o?">\n":">")},i.prototype.renderInline=function(e,t,r){for(var n,i="",o=this.rules,a=0,s=e.length;a<s;a++)void 0!==o[n=e[a].type]?i+=o[n](e,a,t,r,this):i+=this.renderToken(e,a,t);return i},i.prototype.renderInlineAsText=function(e,t,r){for(var n="",i=0,o=e.length;i<o;i++)"text"===e[i].type?n+=e[i].content:"image"===e[i].type?n+=this.renderInlineAsText(e[i].children,t,r):"softbreak"===e[i].type&&(n+="\n");return n},i.prototype.render=function(e,t,r){var n,i,o,a="",s=this.rules;for(n=0,i=e.length;n<i;n++)"inline"===(o=e[n].type)?a+=this.renderInline(e[n].children,t,r):void 0!==s[o]?a+=s[e[n].type](e,n,t,r,this):a+=this.renderToken(e,n,t,r);return a},renderer=i}function requireRuler(){if(hasRequiredRuler)return ruler;function e(){this.__rules__=[],this.__cache__=null}return hasRequiredRuler=1,e.prototype.__find__=function(e){for(var t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1},e.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||e.__cache__[t].push(r.fn))}))}))},e.prototype.at=function(e,t,r){var n=this.__find__(e),i=r||{};if(-1===n)throw new Error("Parser rule not found: "+e);this.__rules__[n].fn=t,this.__rules__[n].alt=i.alt||[],this.__cache__=null},e.prototype.before=function(e,t,r,n){var i=this.__find__(e),o=n||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:r,alt:o.alt||[]}),this.__cache__=null},e.prototype.after=function(e,t,r,n){var i=this.__find__(e),o=n||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:r,alt:o.alt||[]}),this.__cache__=null},e.prototype.push=function(e,t,r){var n=r||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:n.alt||[]}),this.__cache__=null},e.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);var r=[];return e.forEach((function(e){var n=this.__find__(e);if(n<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[n].enabled=!0,r.push(e)}),this),this.__cache__=null,r},e.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach((function(e){e.enabled=!1})),this.enable(e,t)},e.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);var r=[];return e.forEach((function(e){var n=this.__find__(e);if(n<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[n].enabled=!1,r.push(e)}),this),this.__cache__=null,r},e.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},ruler=e}function requireNormalize(){if(hasRequiredNormalize)return normalize;hasRequiredNormalize=1;var e=/\r\n?|\n/g,t=/\0/g;return normalize=function(r){var n;n=(n=r.src.replace(e,"\n")).replace(t,""),r.src=n}}function requireBlock(){return hasRequiredBlock?block:(hasRequiredBlock=1,block=function(e){var t;e.inlineMode?((t=new e.Token("inline","",0)).content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)})}function requireInline(){return hasRequiredInline?inline:(hasRequiredInline=1,inline=function(e){var t,r,n,i=e.tokens;for(r=0,n=i.length;r<n;r++)"inline"===(t=i[r]).type&&e.md.inline.parse(t.content,e.md,e.env,t.children)})}function requireLinkify(){if(hasRequiredLinkify)return linkify;hasRequiredLinkify=1;var e=requireUtils().arrayReplaceAt;function t(e){return/^<\/a\s*>/i.test(e)}return linkify=function(r){var n,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w=r.tokens;if(r.md.options.linkify)for(i=0,o=w.length;i<o;i++)if("inline"===w[i].type&&r.md.linkify.pretest(w[i].content))for(m=0,n=(a=w[i].children).length-1;n>=0;n--)if("link_close"!==(l=a[n]).type){if("html_inline"===l.type&&(b=l.content,/^<a[>\s]/i.test(b)&&m>0&&m--,t(l.content)&&m++),!(m>0)&&"text"===l.type&&r.md.linkify.test(l.content)){for(h=l.content,v=r.md.linkify.match(h),c=[],f=l.level,p=0,u=0;u<v.length;u++)g=v[u].url,y=r.md.normalizeLink(g),r.md.validateLink(y)&&(_=v[u].text,_=v[u].schema?"mailto:"!==v[u].schema||/^mailto:/i.test(_)?r.md.normalizeLinkText(_):r.md.normalizeLinkText("mailto:"+_).replace(/^mailto:/,""):r.md.normalizeLinkText("http://"+_).replace(/^http:\/\//,""),(d=v[u].index)>p&&((s=new r.Token("text","",0)).content=h.slice(p,d),s.level=f,c.push(s)),(s=new r.Token("link_open","a",1)).attrs=[["href",y]],s.level=f++,s.markup="linkify",s.info="auto",c.push(s),(s=new r.Token("text","",0)).content=_,s.level=f,c.push(s),(s=new r.Token("link_close","a",-1)).level=--f,s.markup="linkify",s.info="auto",c.push(s),p=v[u].lastIndex);p<h.length&&((s=new r.Token("text","",0)).content=h.slice(p),s.level=f,c.push(s)),w[i].children=a=e(a,n,c)}}else for(n--;a[n].level!==l.level&&"link_open"!==a[n].type;)n--}}function requireReplacements(){if(hasRequiredReplacements)return replacements;hasRequiredReplacements=1;var e=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,t=/\((c|tm|r|p)\)/i,r=/\((c|tm|r|p)\)/gi,n={c:"",r:"",p:"",tm:""};function i(e,t){return n[t.toLowerCase()]}function o(e){var t,n,o=0;for(t=e.length-1;t>=0;t--)"text"!==(n=e[t]).type||o||(n.content=n.content.replace(r,i)),"link_open"===n.type&&"auto"===n.info&&o--,"link_close"===n.type&&"auto"===n.info&&o++}function a(t){var r,n,i=0;for(r=t.length-1;r>=0;r--)"text"!==(n=t[r]).type||i||e.test(n.content)&&(n.content=n.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1").replace(/(^|\s)--(?=\s|$)/gm,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1")),"link_open"===n.type&&"auto"===n.info&&i--,"link_close"===n.type&&"auto"===n.info&&i++}return replacements=function(r){var n;if(r.md.options.typographer)for(n=r.tokens.length-1;n>=0;n--)"inline"===r.tokens[n].type&&(t.test(r.tokens[n].content)&&o(r.tokens[n].children),e.test(r.tokens[n].content)&&a(r.tokens[n].children))}}function requireSmartquotes(){if(hasRequiredSmartquotes)return smartquotes;hasRequiredSmartquotes=1;var e=requireUtils().isWhiteSpace,t=requireUtils().isPunctChar,r=requireUtils().isMdAsciiPunct,n=/['"]/,i=/['"]/g;function o(e,t,r){return e.substr(0,t)+r+e.substr(t+1)}function a(n,a){var s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C;for(T=[],s=0;s<n.length;s++){for(l=n[s],p=n[s].level,S=T.length-1;S>=0&&!(T[S].level<=p);S--);if(T.length=S+1,"text"===l.type){h=0,d=(c=l.content).length;e:for(;h<d&&(i.lastIndex=h,u=i.exec(c));){if(w=x=!0,h=u.index+1,E="'"===u[0],m=32,u.index-1>=0)m=c.charCodeAt(u.index-1);else for(S=s-1;S>=0&&("softbreak"!==n[S].type&&"hardbreak"!==n[S].type);S--)if(n[S].content){m=n[S].content.charCodeAt(n[S].content.length-1);break}if(g=32,h<d)g=c.charCodeAt(h);else for(S=s+1;S<n.length&&("softbreak"!==n[S].type&&"hardbreak"!==n[S].type);S++)if(n[S].content){g=n[S].content.charCodeAt(0);break}if(y=r(m)||t(String.fromCharCode(m)),_=r(g)||t(String.fromCharCode(g)),v=e(m),(b=e(g))?w=!1:_&&(v||y||(w=!1)),v?x=!1:y&&(b||_||(x=!1)),34===g&&'"'===u[0]&&m>=48&&m<=57&&(x=w=!1),w&&x&&(w=y,x=_),w||x){if(x)for(S=T.length-1;S>=0&&(f=T[S],!(T[S].level<p));S--)if(f.single===E&&T[S].level===p){f=T[S],E?(A=a.md.options.quotes[2],C=a.md.options.quotes[3]):(A=a.md.options.quotes[0],C=a.md.options.quotes[1]),l.content=o(l.content,u.index,C),n[f.token].content=o(n[f.token].content,f.pos,A),h+=C.length-1,f.token===s&&(h+=A.length-1),d=(c=l.content).length,T.length=S;continue e}w?T.push({token:s,pos:u.index,single:E,level:p}):x&&E&&(l.content=o(l.content,u.index,""))}else E&&(l.content=o(l.content,u.index,""))}}}}return smartquotes=function(e){var t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&n.test(e.tokens[t].content)&&a(e.tokens[t].children,e)}}function requireToken(){if(hasRequiredToken)return token;function e(e,t,r){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=r,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}return hasRequiredToken=1,e.prototype.attrIndex=function(e){var t,r,n;if(!this.attrs)return-1;for(r=0,n=(t=this.attrs).length;r<n;r++)if(t[r][0]===e)return r;return-1},e.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]},e.prototype.attrSet=function(e,t){var r=this.attrIndex(e),n=[e,t];r<0?this.attrPush(n):this.attrs[r]=n},e.prototype.attrGet=function(e){var t=this.attrIndex(e),r=null;return t>=0&&(r=this.attrs[t][1]),r},e.prototype.attrJoin=function(e,t){var r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t},token=e}function requireState_core(){if(hasRequiredState_core)return state_core;hasRequiredState_core=1;var e=requireToken();function t(e,t,r){this.src=e,this.env=r,this.tokens=[],this.inlineMode=!1,this.md=t}return t.prototype.Token=e,state_core=t}function requireParser_core(){if(hasRequiredParser_core)return parser_core;hasRequiredParser_core=1;var e=requireRuler(),t=[["normalize",requireNormalize()],["block",requireBlock()],["inline",requireInline()],["linkify",requireLinkify()],["replacements",requireReplacements()],["smartquotes",requireSmartquotes()]];function r(){this.ruler=new e;for(var r=0;r<t.length;r++)this.ruler.push(t[r][0],t[r][1])}return r.prototype.process=function(e){var t,r,n;for(t=0,r=(n=this.ruler.getRules("")).length;t<r;t++)n[t](e)},r.prototype.State=requireState_core(),parser_core=r}function requireTable(){if(hasRequiredTable)return table;hasRequiredTable=1;var e=requireUtils().isSpace;function t(e,t){var r=e.bMarks[t]+e.tShift[t],n=e.eMarks[t];return e.src.substr(r,n-r)}function r(e){var t,r=[],n=0,i=e.length,o=!1,a=0,s="";for(t=e.charCodeAt(n);n<i;)124===t&&(o?(s+=e.substring(a,n-1),a=n):(r.push(s+e.substring(a,n)),s="",a=n+1)),o=92===t,n++,t=e.charCodeAt(n);return r.push(s+e.substring(a)),r}return table=function(n,i,o,a){var s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E;if(i+2>o)return!1;if(d=i+1,n.sCount[d]<n.blkIndent)return!1;if(n.sCount[d]-n.blkIndent>=4)return!1;if((c=n.bMarks[d]+n.tShift[d])>=n.eMarks[d])return!1;if(124!==(S=n.src.charCodeAt(c++))&&45!==S&&58!==S)return!1;if(c>=n.eMarks[d])return!1;if(124!==(E=n.src.charCodeAt(c++))&&45!==E&&58!==E&&!e(E))return!1;if(45===S&&e(E))return!1;for(;c<n.eMarks[d];){if(124!==(s=n.src.charCodeAt(c))&&45!==s&&58!==s&&!e(s))return!1;c++}for(p=(l=t(n,i+1)).split("|"),g=[],u=0;u<p.length;u++){if(!(y=p[u].trim())){if(0===u||u===p.length-1)continue;return!1}if(!/^:?-+:?$/.test(y))return!1;58===y.charCodeAt(y.length-1)?g.push(58===y.charCodeAt(0)?"center":"right"):58===y.charCodeAt(0)?g.push("left"):g.push("")}if(-1===(l=t(n,i).trim()).indexOf("|"))return!1;if(n.sCount[i]-n.blkIndent>=4)return!1;if((p=r(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),0===(f=p.length)||f!==g.length)return!1;if(a)return!0;for(b=n.parentType,n.parentType="table",x=n.md.block.ruler.getRules("blockquote"),(m=n.push("table_open","table",1)).map=_=[i,0],(m=n.push("thead_open","thead",1)).map=[i,i+1],(m=n.push("tr_open","tr",1)).map=[i,i+1],u=0;u<p.length;u++)m=n.push("th_open","th",1),g[u]&&(m.attrs=[["style","text-align:"+g[u]]]),(m=n.push("inline","",0)).content=p[u].trim(),m.children=[],m=n.push("th_close","th",-1);for(m=n.push("tr_close","tr",-1),m=n.push("thead_close","thead",-1),d=i+2;d<o&&!(n.sCount[d]<n.blkIndent);d++){for(w=!1,u=0,h=x.length;u<h;u++)if(x[u](n,d,o,!0)){w=!0;break}if(w)break;if(!(l=t(n,d).trim()))break;if(n.sCount[d]-n.blkIndent>=4)break;for((p=r(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),d===i+2&&((m=n.push("tbody_open","tbody",1)).map=v=[i+2,0]),(m=n.push("tr_open","tr",1)).map=[d,d+1],u=0;u<f;u++)m=n.push("td_open","td",1),g[u]&&(m.attrs=[["style","text-align:"+g[u]]]),(m=n.push("inline","",0)).content=p[u]?p[u].trim():"",m.children=[],m=n.push("td_close","td",-1);m=n.push("tr_close","tr",-1)}return v&&(m=n.push("tbody_close","tbody",-1),v[1]=d),m=n.push("table_close","table",-1),_[1]=d,n.parentType=b,n.line=d,!0},table}function requireCode(){return hasRequiredCode?code:(hasRequiredCode=1,code=function(e,t,r){var n,i,o;if(e.sCount[t]-e.blkIndent<4)return!1;for(i=n=t+1;n<r;)if(e.isEmpty(n))n++;else{if(!(e.sCount[n]-e.blkIndent>=4))break;i=++n}return e.line=i,(o=e.push("code_block","code",0)).content=e.getLines(t,i,4+e.blkIndent,!1)+"\n",o.map=[t,e.line],!0})}function requireFence(){return hasRequiredFence?fence:(hasRequiredFence=1,fence=function(e,t,r,n){var i,o,a,s,l,c,u,h=!1,d=e.bMarks[t]+e.tShift[t],p=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(d+3>p)return!1;if(126!==(i=e.src.charCodeAt(d))&&96!==i)return!1;if(l=d,(o=(d=e.skipChars(d,i))-l)<3)return!1;if(u=e.src.slice(l,d),a=e.src.slice(d,p),96===i&&a.indexOf(String.fromCharCode(i))>=0)return!1;if(n)return!0;for(s=t;!(++s>=r)&&!((d=l=e.bMarks[s]+e.tShift[s])<(p=e.eMarks[s])&&e.sCount[s]<e.blkIndent);)if(e.src.charCodeAt(d)===i&&!(e.sCount[s]-e.blkIndent>=4||(d=e.skipChars(d,i))-l<o||(d=e.skipSpaces(d))<p)){h=!0;break}return o=e.sCount[t],e.line=s+(h?1:0),(c=e.push("fence","code",0)).info=a,c.content=e.getLines(t+1,s,o,!0),c.markup=u,c.map=[t,e.line],!0})}function requireBlockquote(){if(hasRequiredBlockquote)return blockquote;hasRequiredBlockquote=1;var e=requireUtils().isSpace;return blockquote=function(t,r,n,i){var o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T=t.lineMax,A=t.bMarks[r]+t.tShift[r],C=t.eMarks[r];if(t.sCount[r]-t.blkIndent>=4)return!1;if(62!==t.src.charCodeAt(A++))return!1;if(i)return!0;for(l=p=t.sCount[r]+1,32===t.src.charCodeAt(A)?(A++,l++,p++,o=!1,b=!0):9===t.src.charCodeAt(A)?(b=!0,(t.bsCount[r]+p)%4==3?(A++,l++,p++,o=!1):o=!0):b=!1,f=[t.bMarks[r]],t.bMarks[r]=A;A<C&&(a=t.src.charCodeAt(A),e(a));)9===a?p+=4-(p+t.bsCount[r]+(o?1:0))%4:p++,A++;for(m=[t.bsCount[r]],t.bsCount[r]=t.sCount[r]+1+(b?1:0),u=A>=C,_=[t.sCount[r]],t.sCount[r]=p-l,v=[t.tShift[r]],t.tShift[r]=A-t.bMarks[r],x=t.md.block.ruler.getRules("blockquote"),y=t.parentType,t.parentType="blockquote",d=r+1;d<n&&(E=t.sCount[d]<t.blkIndent,!((A=t.bMarks[d]+t.tShift[d])>=(C=t.eMarks[d])));d++)if(62!==t.src.charCodeAt(A++)||E){if(u)break;for(w=!1,s=0,c=x.length;s<c;s++)if(x[s](t,d,n,!0)){w=!0;break}if(w){t.lineMax=d,0!==t.blkIndent&&(f.push(t.bMarks[d]),m.push(t.bsCount[d]),v.push(t.tShift[d]),_.push(t.sCount[d]),t.sCount[d]-=t.blkIndent);break}f.push(t.bMarks[d]),m.push(t.bsCount[d]),v.push(t.tShift[d]),_.push(t.sCount[d]),t.sCount[d]=-1}else{for(l=p=t.sCount[d]+1,32===t.src.charCodeAt(A)?(A++,l++,p++,o=!1,b=!0):9===t.src.charCodeAt(A)?(b=!0,(t.bsCount[d]+p)%4==3?(A++,l++,p++,o=!1):o=!0):b=!1,f.push(t.bMarks[d]),t.bMarks[d]=A;A<C&&(a=t.src.charCodeAt(A),e(a));)9===a?p+=4-(p+t.bsCount[d]+(o?1:0))%4:p++,A++;u=A>=C,m.push(t.bsCount[d]),t.bsCount[d]=t.sCount[d]+1+(b?1:0),_.push(t.sCount[d]),t.sCount[d]=p-l,v.push(t.tShift[d]),t.tShift[d]=A-t.bMarks[d]}for(g=t.blkIndent,t.blkIndent=0,(S=t.push("blockquote_open","blockquote",1)).markup=">",S.map=h=[r,0],t.md.block.tokenize(t,r,d),(S=t.push("blockquote_close","blockquote",-1)).markup=">",t.lineMax=T,t.parentType=y,h[1]=t.line,s=0;s<v.length;s++)t.bMarks[s+r]=f[s],t.tShift[s+r]=v[s],t.sCount[s+r]=_[s],t.bsCount[s+r]=m[s];return t.blkIndent=g,!0}}function requireHr(){if(hasRequiredHr)return hr;hasRequiredHr=1;var e=requireUtils().isSpace;return hr=function(t,r,n,i){var o,a,s,l,c=t.bMarks[r]+t.tShift[r],u=t.eMarks[r];if(t.sCount[r]-t.blkIndent>=4)return!1;if(42!==(o=t.src.charCodeAt(c++))&&45!==o&&95!==o)return!1;for(a=1;c<u;){if((s=t.src.charCodeAt(c++))!==o&&!e(s))return!1;s===o&&a++}return!(a<3)&&(i||(t.line=r+1,(l=t.push("hr","hr",0)).map=[r,t.line],l.markup=Array(a+1).join(String.fromCharCode(o))),!0)}}function requireList(){if(hasRequiredList)return list;hasRequiredList=1;var e=requireUtils().isSpace;function t(t,r){var n,i,o,a;return i=t.bMarks[r]+t.tShift[r],o=t.eMarks[r],42!==(n=t.src.charCodeAt(i++))&&45!==n&&43!==n||i<o&&(a=t.src.charCodeAt(i),!e(a))?-1:i}function r(t,r){var n,i=t.bMarks[r]+t.tShift[r],o=i,a=t.eMarks[r];if(o+1>=a)return-1;if((n=t.src.charCodeAt(o++))<48||n>57)return-1;for(;;){if(o>=a)return-1;if(!((n=t.src.charCodeAt(o++))>=48&&n<=57)){if(41===n||46===n)break;return-1}if(o-i>=10)return-1}return o<a&&(n=t.src.charCodeAt(o),!e(n))?-1:o}return list=function(e,n,i,o){var a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x,S,E,T,A,C,I,k,P,M,R,D,O=!1,L=!0;if(e.sCount[n]-e.blkIndent>=4)return!1;if(e.listIndent>=0&&e.sCount[n]-e.listIndent>=4&&e.sCount[n]<e.blkIndent)return!1;if(o&&"paragraph"===e.parentType&&e.sCount[n]>=e.blkIndent&&(O=!0),(I=r(e,n))>=0){if(d=!0,P=e.bMarks[n]+e.tShift[n],_=Number(e.src.slice(P,I-1)),O&&1!==_)return!1}else{if(!((I=t(e,n))>=0))return!1;d=!1}if(O&&e.skipSpaces(I)>=e.eMarks[n])return!1;if(y=e.src.charCodeAt(I-1),o)return!0;for(g=e.tokens.length,d?(D=e.push("ordered_list_open","ol",1),1!==_&&(D.attrs=[["start",_]])):D=e.push("bullet_list_open","ul",1),D.map=m=[n,0],D.markup=String.fromCharCode(y),b=n,k=!1,R=e.md.block.ruler.getRules("list"),S=e.parentType,e.parentType="list";b<i;){for(C=I,v=e.eMarks[b],h=w=e.sCount[b]+I-(e.bMarks[n]+e.tShift[n]);C<v;){if(9===(a=e.src.charCodeAt(C)))w+=4-(w+e.bsCount[b])%4;else{if(32!==a)break;w++}C++}if((u=(s=C)>=v?1:w-h)>4&&(u=1),c=h+u,(D=e.push("list_item_open","li",1)).markup=String.fromCharCode(y),D.map=p=[n,0],d&&(D.info=e.src.slice(P,I-1)),A=e.tight,T=e.tShift[n],E=e.sCount[n],x=e.listIndent,e.listIndent=e.blkIndent,e.blkIndent=c,e.tight=!0,e.tShift[n]=s-e.bMarks[n],e.sCount[n]=w,s>=v&&e.isEmpty(n+1)?e.line=Math.min(e.line+2,i):e.md.block.tokenize(e,n,i,!0),e.tight&&!k||(L=!1),k=e.line-n>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=x,e.tShift[n]=T,e.sCount[n]=E,e.tight=A,(D=e.push("list_item_close","li",-1)).markup=String.fromCharCode(y),b=n=e.line,p[1]=b,s=e.bMarks[n],b>=i)break;if(e.sCount[b]<e.blkIndent)break;if(e.sCount[n]-e.blkIndent>=4)break;for(M=!1,l=0,f=R.length;l<f;l++)if(R[l](e,b,i,!0)){M=!0;break}if(M)break;if(d){if((I=r(e,b))<0)break;P=e.bMarks[b]+e.tShift[b]}else if((I=t(e,b))<0)break;if(y!==e.src.charCodeAt(I-1))break}return(D=d?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(y),m[1]=b,e.line=b,e.parentType=S,L&&function(e,t){var r,n,i=e.level+2;for(r=t+2,n=e.tokens.length-2;r<n;r++)e.tokens[r].level===i&&"paragraph_open"===e.tokens[r].type&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}(e,g),!0}}function requireReference(){if(hasRequiredReference)return reference;hasRequiredReference=1;var e=requireUtils().normalizeReference,t=requireUtils().isSpace;return reference=function(r,n,i,o){var a,s,l,c,u,h,d,p,f,m,g,y,_,v,b,w,x=0,S=r.bMarks[n]+r.tShift[n],E=r.eMarks[n],T=n+1;if(r.sCount[n]-r.blkIndent>=4)return!1;if(91!==r.src.charCodeAt(S))return!1;for(;++S<E;)if(93===r.src.charCodeAt(S)&&92!==r.src.charCodeAt(S-1)){if(S+1===E)return!1;if(58!==r.src.charCodeAt(S+1))return!1;break}for(c=r.lineMax,b=r.md.block.ruler.getRules("reference"),m=r.parentType,r.parentType="reference";T<c&&!r.isEmpty(T);T++)if(!(r.sCount[T]-r.blkIndent>3||r.sCount[T]<0)){for(v=!1,h=0,d=b.length;h<d;h++)if(b[h](r,T,c,!0)){v=!0;break}if(v)break}for(E=(_=r.getLines(n,T,r.blkIndent,!1).trim()).length,S=1;S<E;S++){if(91===(a=_.charCodeAt(S)))return!1;if(93===a){f=S;break}(10===a||92===a&&++S<E&&10===_.charCodeAt(S))&&x++}if(f<0||58!==_.charCodeAt(f+1))return!1;for(S=f+2;S<E;S++)if(10===(a=_.charCodeAt(S)))x++;else if(!t(a))break;if(!(g=r.md.helpers.parseLinkDestination(_,S,E)).ok)return!1;if(u=r.md.normalizeLink(g.str),!r.md.validateLink(u))return!1;for(s=S=g.pos,l=x+=g.lines,y=S;S<E;S++)if(10===(a=_.charCodeAt(S)))x++;else if(!t(a))break;for(g=r.md.helpers.parseLinkTitle(_,S,E),S<E&&y!==S&&g.ok?(w=g.str,S=g.pos,x+=g.lines):(w="",S=s,x=l);S<E&&(a=_.charCodeAt(S),t(a));)S++;if(S<E&&10!==_.charCodeAt(S)&&w)for(w="",S=s,x=l;S<E&&(a=_.charCodeAt(S),t(a));)S++;return!(S<E&&10!==_.charCodeAt(S))&&(!!(p=e(_.slice(1,f)))&&(o||(void 0===r.env.references&&(r.env.references={}),void 0===r.env.references[p]&&(r.env.references[p]={title:w,href:u}),r.parentType=m,r.line=n+x+1),!0))}}function requireHtml_blocks(){return hasRequiredHtml_blocks?html_blocks:(hasRequiredHtml_blocks=1,html_blocks=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"])}var html_re={},hasRequiredHtml_re,html_block,hasRequiredHtml_block,heading,hasRequiredHeading,lheading,hasRequiredLheading,paragraph,hasRequiredParagraph,state_block,hasRequiredState_block,parser_block,hasRequiredParser_block,text,hasRequiredText,newline,hasRequiredNewline,_escape,hasRequired_escape,backticks,hasRequiredBackticks;function requireHtml_re(){if(hasRequiredHtml_re)return html_re;hasRequiredHtml_re=1;var e="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",t="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",r=new RegExp("^(?:"+e+"|"+t+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),n=new RegExp("^(?:"+e+"|"+t+")");return html_re.HTML_TAG_RE=r,html_re.HTML_OPEN_CLOSE_TAG_RE=n,html_re}function requireHtml_block(){if(hasRequiredHtml_block)return html_block;hasRequiredHtml_block=1;var e=requireHtml_blocks(),t=requireHtml_re().HTML_OPEN_CLOSE_TAG_RE,r=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+e.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(t.source+"\\s*$"),/^$/,!1]];return html_block=function(e,t,n,i){var o,a,s,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(c))return!1;for(l=e.src.slice(c,u),o=0;o<r.length&&!r[o][0].test(l);o++);if(o===r.length)return!1;if(i)return r[o][2];if(a=t+1,!r[o][1].test(l))for(;a<n&&!(e.sCount[a]<e.blkIndent);a++)if(c=e.bMarks[a]+e.tShift[a],u=e.eMarks[a],l=e.src.slice(c,u),r[o][1].test(l)){0!==l.length&&a++;break}return e.line=a,(s=e.push("html_block","",0)).map=[t,a],s.content=e.getLines(t,a,e.blkIndent,!0),!0}}function requireHeading(){if(hasRequiredHeading)return heading;hasRequiredHeading=1;var e=requireUtils().isSpace;return heading=function(t,r,n,i){var o,a,s,l,c=t.bMarks[r]+t.tShift[r],u=t.eMarks[r];if(t.sCount[r]-t.blkIndent>=4)return!1;if(35!==(o=t.src.charCodeAt(c))||c>=u)return!1;for(a=1,o=t.src.charCodeAt(++c);35===o&&c<u&&a<=6;)a++,o=t.src.charCodeAt(++c);return!(a>6||c<u&&!e(o))&&(i||(u=t.skipSpacesBack(u,c),(s=t.skipCharsBack(u,35,c))>c&&e(t.src.charCodeAt(s-1))&&(u=s),t.line=r+1,(l=t.push("heading_open","h"+String(a),1)).markup="########".slice(0,a),l.map=[r,t.line],(l=t.push("inline","",0)).content=t.src.slice(c,u).trim(),l.map=[r,t.line],l.children=[],(l=t.push("heading_close","h"+String(a),-1)).markup="########".slice(0,a)),!0)}}function requireLheading(){return hasRequiredLheading?lheading:(hasRequiredLheading=1,lheading=function(e,t,r){var n,i,o,a,s,l,c,u,h,d,p=t+1,f=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;for(d=e.parentType,e.parentType="paragraph";p<r&&!e.isEmpty(p);p++)if(!(e.sCount[p]-e.blkIndent>3)){if(e.sCount[p]>=e.blkIndent&&(l=e.bMarks[p]+e.tShift[p])<(c=e.eMarks[p])&&(45===(h=e.src.charCodeAt(l))||61===h)&&(l=e.skipChars(l,h),(l=e.skipSpaces(l))>=c)){u=61===h?1:2;break}if(!(e.sCount[p]<0)){for(i=!1,o=0,a=f.length;o<a;o++)if(f[o](e,p,r,!0)){i=!0;break}if(i)break}}return!!u&&(n=e.getLines(t,p,e.blkIndent,!1).trim(),e.line=p+1,(s=e.push("heading_open","h"+String(u),1)).markup=String.fromCharCode(h),s.map=[t,e.line],(s=e.push("inline","",0)).content=n,s.map=[t,e.line-1],s.children=[],(s=e.push("heading_close","h"+String(u),-1)).markup=String.fromCharCode(h),e.parentType=d,!0)})}function requireParagraph(){return hasRequiredParagraph?paragraph:(hasRequiredParagraph=1,paragraph=function(e,t){var r,n,i,o,a,s,l=t+1,c=e.md.block.ruler.getRules("paragraph"),u=e.lineMax;for(s=e.parentType,e.parentType="paragraph";l<u&&!e.isEmpty(l);l++)if(!(e.sCount[l]-e.blkIndent>3||e.sCount[l]<0)){for(n=!1,i=0,o=c.length;i<o;i++)if(c[i](e,l,u,!0)){n=!0;break}if(n)break}return r=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,(a=e.push("paragraph_open","p",1)).map=[t,e.line],(a=e.push("inline","",0)).content=r,a.map=[t,e.line],a.children=[],a=e.push("paragraph_close","p",-1),e.parentType=s,!0})}function requireState_block(){if(hasRequiredState_block)return state_block;hasRequiredState_block=1;var e=requireToken(),t=requireUtils().isSpace;function r(e,r,n,i){var o,a,s,l,c,u,h,d;for(this.src=e,this.md=r,this.env=n,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",d=!1,s=l=u=h=0,c=(a=this.src).length;l<c;l++){if(o=a.charCodeAt(l),!d){if(t(o)){u++,9===o?h+=4-h%4:h++;continue}d=!0}10!==o&&l!==c-1||(10!==o&&l++,this.bMarks.push(s),this.eMarks.push(l),this.tShift.push(u),this.sCount.push(h),this.bsCount.push(0),d=!1,u=0,h=0,s=l+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}return r.prototype.push=function(t,r,n){var i=new e(t,r,n);return i.block=!0,n<0&&this.level--,i.level=this.level,n>0&&this.level++,this.tokens.push(i),i},r.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},r.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},r.prototype.skipSpaces=function(e){for(var r,n=this.src.length;e<n&&(r=this.src.charCodeAt(e),t(r));e++);return e},r.prototype.skipSpacesBack=function(e,r){if(e<=r)return e;for(;e>r;)if(!t(this.src.charCodeAt(--e)))return e+1;return e},r.prototype.skipChars=function(e,t){for(var r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e},r.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e},r.prototype.getLines=function(e,r,n,i){var o,a,s,l,c,u,h,d=e;if(e>=r)return"";for(u=new Array(r-e),o=0;d<r;d++,o++){for(a=0,h=l=this.bMarks[d],c=d+1<r||i?this.eMarks[d]+1:this.eMarks[d];l<c&&a<n;){if(s=this.src.charCodeAt(l),t(s))9===s?a+=4-(a+this.bsCount[d])%4:a++;else{if(!(l-h<this.tShift[d]))break;a++}l++}u[o]=a>n?new Array(a-n+1).join(" ")+this.src.slice(l,c):this.src.slice(l,c)}return u.join("")},r.prototype.Token=e,state_block=r}function requireParser_block(){if(hasRequiredParser_block)return parser_block;hasRequiredParser_block=1;var e=requireRuler(),t=[["table",requireTable(),["paragraph","reference"]],["code",requireCode()],["fence",requireFence(),["paragraph","reference","blockquote","list"]],["blockquote",requireBlockquote(),["paragraph","reference","blockquote","list"]],["hr",requireHr(),["paragraph","reference","blockquote","list"]],["list",requireList(),["paragraph","reference","blockquote"]],["reference",requireReference()],["html_block",requireHtml_block(),["paragraph","reference","blockquote"]],["heading",requireHeading(),["paragraph","reference","blockquote"]],["lheading",requireLheading()],["paragraph",requireParagraph()]];function r(){this.ruler=new e;for(var r=0;r<t.length;r++)this.ruler.push(t[r][0],t[r][1],{alt:(t[r][2]||[]).slice()})}return r.prototype.tokenize=function(e,t,r){for(var n,i=this.ruler.getRules(""),o=i.length,a=t,s=!1,l=e.md.options.maxNesting;a<r&&(e.line=a=e.skipEmptyLines(a),!(a>=r))&&!(e.sCount[a]<e.blkIndent);){if(e.level>=l){e.line=r;break}for(n=0;n<o&&!i[n](e,a,r,!1);n++);e.tight=!s,e.isEmpty(e.line-1)&&(s=!0),(a=e.line)<r&&e.isEmpty(a)&&(s=!0,a++,e.line=a)}},r.prototype.parse=function(e,t,r,n){var i;e&&(i=new this.State(e,t,r,n),this.tokenize(i,i.line,i.lineMax))},r.prototype.State=requireState_block(),parser_block=r}function requireText(){if(hasRequiredText)return text;function e(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}return hasRequiredText=1,text=function(t,r){for(var n=t.pos;n<t.posMax&&!e(t.src.charCodeAt(n));)n++;return n!==t.pos&&(r||(t.pending+=t.src.slice(t.pos,n)),t.pos=n,!0)}}function requireNewline(){if(hasRequiredNewline)return newline;hasRequiredNewline=1;var e=requireUtils().isSpace;return newline=function(t,r){var n,i,o,a=t.pos;if(10!==t.src.charCodeAt(a))return!1;if(n=t.pending.length-1,i=t.posMax,!r)if(n>=0&&32===t.pending.charCodeAt(n))if(n>=1&&32===t.pending.charCodeAt(n-1)){for(o=n-1;o>=1&&32===t.pending.charCodeAt(o-1);)o--;t.pending=t.pending.slice(0,o),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(a++;a<i&&e(t.src.charCodeAt(a));)a++;return t.pos=a,!0}}function require_escape(){if(hasRequired_escape)return _escape;hasRequired_escape=1;for(var e=requireUtils().isSpace,t=[],r=0;r<256;r++)t.push(0);return"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){t[e.charCodeAt(0)]=1})),_escape=function(r,n){var i,o=r.pos,a=r.posMax;if(92!==r.src.charCodeAt(o))return!1;if(++o<a){if((i=r.src.charCodeAt(o))<256&&0!==t[i])return n||(r.pending+=r.src[o]),r.pos+=2,!0;if(10===i){for(n||r.push("hardbreak","br",0),o++;o<a&&(i=r.src.charCodeAt(o),e(i));)o++;return r.pos=o,!0}}return n||(r.pending+="\\"),r.pos++,!0}}function requireBackticks(){return hasRequiredBackticks?backticks:(hasRequiredBackticks=1,backticks=function(e,t){var r,n,i,o,a,s,l,c,u=e.pos;if(96!==e.src.charCodeAt(u))return!1;for(r=u,u++,n=e.posMax;u<n&&96===e.src.charCodeAt(u);)u++;if(l=(i=e.src.slice(r,u)).length,e.backticksScanned&&(e.backticks[l]||0)<=r)return t||(e.pending+=i),e.pos+=l,!0;for(a=s=u;-1!==(a=e.src.indexOf("`",s));){for(s=a+1;s<n&&96===e.src.charCodeAt(s);)s++;if((c=s-a)===l)return t||((o=e.push("code_inline","code",0)).markup=i,o.content=e.src.slice(u,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),e.pos=s,!0;e.backticks[c]=a}return e.backticksScanned=!0,t||(e.pending+=i),e.pos+=l,!0})}var strikethrough={},hasRequiredStrikethrough;function requireStrikethrough(){if(hasRequiredStrikethrough)return strikethrough;function e(e,t){var r,n,i,o,a,s=[],l=t.length;for(r=0;r<l;r++)126===(i=t[r]).marker&&-1!==i.end&&(o=t[i.end],(a=e.tokens[i.token]).type="s_open",a.tag="s",a.nesting=1,a.markup="~~",a.content="",(a=e.tokens[o.token]).type="s_close",a.tag="s",a.nesting=-1,a.markup="~~",a.content="","text"===e.tokens[o.token-1].type&&"~"===e.tokens[o.token-1].content&&s.push(o.token-1));for(;s.length;){for(n=(r=s.pop())+1;n<e.tokens.length&&"s_close"===e.tokens[n].type;)n++;r!==--n&&(a=e.tokens[n],e.tokens[n]=e.tokens[r],e.tokens[r]=a)}}return hasRequiredStrikethrough=1,strikethrough.tokenize=function(e,t){var r,n,i,o,a=e.pos,s=e.src.charCodeAt(a);if(t)return!1;if(126!==s)return!1;if(i=(n=e.scanDelims(e.pos,!0)).length,o=String.fromCharCode(s),i<2)return!1;for(i%2&&(e.push("text","",0).content=o,i--),r=0;r<i;r+=2)e.push("text","",0).content=o+o,e.delimiters.push({marker:s,length:0,token:e.tokens.length-1,end:-1,open:n.can_open,close:n.can_close});return e.pos+=n.length,!0},strikethrough.postProcess=function(t){var r,n=t.tokens_meta,i=t.tokens_meta.length;for(e(t,t.delimiters),r=0;r<i;r++)n[r]&&n[r].delimiters&&e(t,n[r].delimiters)},strikethrough}var emphasis={},hasRequiredEmphasis,link,hasRequiredLink,image,hasRequiredImage,autolink,hasRequiredAutolink,html_inline,hasRequiredHtml_inline,entity,hasRequiredEntity,balance_pairs,hasRequiredBalance_pairs,text_collapse,hasRequiredText_collapse,state_inline,hasRequiredState_inline,parser_inline,hasRequiredParser_inline,re,hasRequiredRe,linkifyIt,hasRequiredLinkifyIt,_default,hasRequired_default,zero,hasRequiredZero,commonmark,hasRequiredCommonmark,lib,hasRequiredLib,markdownIt$1,hasRequiredMarkdownIt;function requireEmphasis(){if(hasRequiredEmphasis)return emphasis;function e(e,t){var r,n,i,o,a,s;for(r=t.length-1;r>=0;r--)95!==(n=t[r]).marker&&42!==n.marker||-1!==n.end&&(i=t[n.end],s=r>0&&t[r-1].end===n.end+1&&t[r-1].marker===n.marker&&t[r-1].token===n.token-1&&t[n.end+1].token===i.token+1,a=String.fromCharCode(n.marker),(o=e.tokens[n.token]).type=s?"strong_open":"em_open",o.tag=s?"strong":"em",o.nesting=1,o.markup=s?a+a:a,o.content="",(o=e.tokens[i.token]).type=s?"strong_close":"em_close",o.tag=s?"strong":"em",o.nesting=-1,o.markup=s?a+a:a,o.content="",s&&(e.tokens[t[r-1].token].content="",e.tokens[t[n.end+1].token].content="",r--))}return hasRequiredEmphasis=1,emphasis.tokenize=function(e,t){var r,n,i=e.pos,o=e.src.charCodeAt(i);if(t)return!1;if(95!==o&&42!==o)return!1;for(n=e.scanDelims(e.pos,42===o),r=0;r<n.length;r++)e.push("text","",0).content=String.fromCharCode(o),e.delimiters.push({marker:o,length:n.length,token:e.tokens.length-1,end:-1,open:n.can_open,close:n.can_close});return e.pos+=n.length,!0},emphasis.postProcess=function(t){var r,n=t.tokens_meta,i=t.tokens_meta.length;for(e(t,t.delimiters),r=0;r<i;r++)n[r]&&n[r].delimiters&&e(t,n[r].delimiters)},emphasis}function requireLink(){if(hasRequiredLink)return link;hasRequiredLink=1;var e=requireUtils().normalizeReference,t=requireUtils().isSpace;return link=function(r,n){var i,o,a,s,l,c,u,h,d="",p="",f=r.pos,m=r.posMax,g=r.pos,y=!0;if(91!==r.src.charCodeAt(r.pos))return!1;if(l=r.pos+1,(s=r.md.helpers.parseLinkLabel(r,r.pos,!0))<0)return!1;if((c=s+1)<m&&40===r.src.charCodeAt(c)){for(y=!1,c++;c<m&&(o=r.src.charCodeAt(c),t(o)||10===o);c++);if(c>=m)return!1;if(g=c,(u=r.md.helpers.parseLinkDestination(r.src,c,r.posMax)).ok){for(d=r.md.normalizeLink(u.str),r.md.validateLink(d)?c=u.pos:d="",g=c;c<m&&(o=r.src.charCodeAt(c),t(o)||10===o);c++);if(u=r.md.helpers.parseLinkTitle(r.src,c,r.posMax),c<m&&g!==c&&u.ok)for(p=u.str,c=u.pos;c<m&&(o=r.src.charCodeAt(c),t(o)||10===o);c++);}(c>=m||41!==r.src.charCodeAt(c))&&(y=!0),c++}if(y){if(void 0===r.env.references)return!1;if(c<m&&91===r.src.charCodeAt(c)?(g=c+1,(c=r.md.helpers.parseLinkLabel(r,c))>=0?a=r.src.slice(g,c++):c=s+1):c=s+1,a||(a=r.src.slice(l,s)),!(h=r.env.references[e(a)]))return r.pos=f,!1;d=h.href,p=h.title}return n||(r.pos=l,r.posMax=s,r.push("link_open","a",1).attrs=i=[["href",d]],p&&i.push(["title",p]),r.md.inline.tokenize(r),r.push("link_close","a",-1)),r.pos=c,r.posMax=m,!0}}function requireImage(){if(hasRequiredImage)return image;hasRequiredImage=1;var e=requireUtils().normalizeReference,t=requireUtils().isSpace;return image=function(r,n){var i,o,a,s,l,c,u,h,d,p,f,m,g,y="",_=r.pos,v=r.posMax;if(33!==r.src.charCodeAt(r.pos))return!1;if(91!==r.src.charCodeAt(r.pos+1))return!1;if(c=r.pos+2,(l=r.md.helpers.parseLinkLabel(r,r.pos+1,!1))<0)return!1;if((u=l+1)<v&&40===r.src.charCodeAt(u)){for(u++;u<v&&(o=r.src.charCodeAt(u),t(o)||10===o);u++);if(u>=v)return!1;for(g=u,(d=r.md.helpers.parseLinkDestination(r.src,u,r.posMax)).ok&&(y=r.md.normalizeLink(d.str),r.md.validateLink(y)?u=d.pos:y=""),g=u;u<v&&(o=r.src.charCodeAt(u),t(o)||10===o);u++);if(d=r.md.helpers.parseLinkTitle(r.src,u,r.posMax),u<v&&g!==u&&d.ok)for(p=d.str,u=d.pos;u<v&&(o=r.src.charCodeAt(u),t(o)||10===o);u++);else p="";if(u>=v||41!==r.src.charCodeAt(u))return r.pos=_,!1;u++}else{if(void 0===r.env.references)return!1;if(u<v&&91===r.src.charCodeAt(u)?(g=u+1,(u=r.md.helpers.parseLinkLabel(r,u))>=0?s=r.src.slice(g,u++):u=l+1):u=l+1,s||(s=r.src.slice(c,l)),!(h=r.env.references[e(s)]))return r.pos=_,!1;y=h.href,p=h.title}return n||(a=r.src.slice(c,l),r.md.inline.parse(a,r.md,r.env,m=[]),(f=r.push("image","img",0)).attrs=i=[["src",y],["alt",""]],f.children=m,f.content=a,p&&i.push(["title",p])),r.pos=u,r.posMax=v,!0}}function requireAutolink(){if(hasRequiredAutolink)return autolink;hasRequiredAutolink=1;var e=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,t=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/;return autolink=function(r,n){var i,o,a,s,l,c,u=r.pos;if(60!==r.src.charCodeAt(u))return!1;for(l=r.pos,c=r.posMax;;){if(++u>=c)return!1;if(60===(s=r.src.charCodeAt(u)))return!1;if(62===s)break}return i=r.src.slice(l+1,u),t.test(i)?(o=r.md.normalizeLink(i),!!r.md.validateLink(o)&&(n||((a=r.push("link_open","a",1)).attrs=[["href",o]],a.markup="autolink",a.info="auto",(a=r.push("text","",0)).content=r.md.normalizeLinkText(i),(a=r.push("link_close","a",-1)).markup="autolink",a.info="auto"),r.pos+=i.length+2,!0)):!!e.test(i)&&(o=r.md.normalizeLink("mailto:"+i),!!r.md.validateLink(o)&&(n||((a=r.push("link_open","a",1)).attrs=[["href",o]],a.markup="autolink",a.info="auto",(a=r.push("text","",0)).content=r.md.normalizeLinkText(i),(a=r.push("link_close","a",-1)).markup="autolink",a.info="auto"),r.pos+=i.length+2,!0))}}function requireHtml_inline(){if(hasRequiredHtml_inline)return html_inline;hasRequiredHtml_inline=1;var e=requireHtml_re().HTML_TAG_RE;return html_inline=function(t,r){var n,i,o,a=t.pos;return!!t.md.options.html&&(o=t.posMax,!(60!==t.src.charCodeAt(a)||a+2>=o)&&(!(33!==(n=t.src.charCodeAt(a+1))&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))&&(!!(i=t.src.slice(a).match(e))&&(r||(t.push("html_inline","",0).content=t.src.slice(a,a+i[0].length)),t.pos+=i[0].length,!0))))}}function requireEntity(){if(hasRequiredEntity)return entity;hasRequiredEntity=1;var e=requireEntities(),t=requireUtils().has,r=requireUtils().isValidEntityCode,n=requireUtils().fromCodePoint,i=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,o=/^&([a-z][a-z0-9]{1,31});/i;return entity=function(a,s){var l,c,u=a.pos,h=a.posMax;if(38!==a.src.charCodeAt(u))return!1;if(u+1<h)if(35===a.src.charCodeAt(u+1)){if(c=a.src.slice(u).match(i))return s||(l="x"===c[1][0].toLowerCase()?parseInt(c[1].slice(1),16):parseInt(c[1],10),a.pending+=r(l)?n(l):n(65533)),a.pos+=c[0].length,!0}else if((c=a.src.slice(u).match(o))&&t(e,c[1]))return s||(a.pending+=e[c[1]]),a.pos+=c[0].length,!0;return s||(a.pending+="&"),a.pos++,!0}}function requireBalance_pairs(){if(hasRequiredBalance_pairs)return balance_pairs;function e(e,t){var r,n,i,o,a,s,l,c,u={},h=t.length;if(h){var d=0,p=-2,f=[];for(r=0;r<h;r++)if(i=t[r],f.push(0),t[d].marker===i.marker&&p===i.token-1||(d=r),p=i.token,i.length=i.length||0,i.close){for(u.hasOwnProperty(i.marker)||(u[i.marker]=[-1,-1,-1,-1,-1,-1]),a=u[i.marker][(i.open?3:0)+i.length%3],s=n=d-f[d]-1;n>a;n-=f[n]+1)if((o=t[n]).marker===i.marker&&o.open&&o.end<0&&(l=!1,(o.close||i.open)&&(o.length+i.length)%3==0&&(o.length%3==0&&i.length%3==0||(l=!0)),!l)){c=n>0&&!t[n-1].open?f[n-1]+1:0,f[r]=r-n+c,f[n]=c,i.open=!1,o.end=r,o.close=!1,s=-1,p=-2;break}-1!==s&&(u[i.marker][(i.open?3:0)+(i.length||0)%3]=s)}}}return hasRequiredBalance_pairs=1,balance_pairs=function(t){var r,n=t.tokens_meta,i=t.tokens_meta.length;for(e(0,t.delimiters),r=0;r<i;r++)n[r]&&n[r].delimiters&&e(0,n[r].delimiters)}}function requireText_collapse(){return hasRequiredText_collapse?text_collapse:(hasRequiredText_collapse=1,text_collapse=function(e){var t,r,n=0,i=e.tokens,o=e.tokens.length;for(t=r=0;t<o;t++)i[t].nesting<0&&n--,i[t].level=n,i[t].nesting>0&&n++,"text"===i[t].type&&t+1<o&&"text"===i[t+1].type?i[t+1].content=i[t].content+i[t+1].content:(t!==r&&(i[r]=i[t]),r++);t!==r&&(i.length=r)})}function requireState_inline(){if(hasRequiredState_inline)return state_inline;hasRequiredState_inline=1;var e=requireToken(),t=requireUtils().isWhiteSpace,r=requireUtils().isPunctChar,n=requireUtils().isMdAsciiPunct;function i(e,t,r,n){this.src=e,this.env=r,this.md=t,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1}return i.prototype.pushPending=function(){var t=new e("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t},i.prototype.push=function(t,r,n){this.pending&&this.pushPending();var i=new e(t,r,n),o=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),i.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(i),this.tokens_meta.push(o),i},i.prototype.scanDelims=function(e,i){var o,a,s,l,c,u,h,d,p,f=e,m=!0,g=!0,y=this.posMax,_=this.src.charCodeAt(e);for(o=e>0?this.src.charCodeAt(e-1):32;f<y&&this.src.charCodeAt(f)===_;)f++;return s=f-e,a=f<y?this.src.charCodeAt(f):32,h=n(o)||r(String.fromCharCode(o)),p=n(a)||r(String.fromCharCode(a)),u=t(o),(d=t(a))?m=!1:p&&(u||h||(m=!1)),u?g=!1:h&&(d||p||(g=!1)),i?(l=m,c=g):(l=m&&(!g||h),c=g&&(!m||p)),{can_open:l,can_close:c,length:s}},i.prototype.Token=e,state_inline=i}function requireParser_inline(){if(hasRequiredParser_inline)return parser_inline;hasRequiredParser_inline=1;var e=requireRuler(),t=[["text",requireText()],["newline",requireNewline()],["escape",require_escape()],["backticks",requireBackticks()],["strikethrough",requireStrikethrough().tokenize],["emphasis",requireEmphasis().tokenize],["link",requireLink()],["image",requireImage()],["autolink",requireAutolink()],["html_inline",requireHtml_inline()],["entity",requireEntity()]],r=[["balance_pairs",requireBalance_pairs()],["strikethrough",requireStrikethrough().postProcess],["emphasis",requireEmphasis().postProcess],["text_collapse",requireText_collapse()]];function n(){var n;for(this.ruler=new e,n=0;n<t.length;n++)this.ruler.push(t[n][0],t[n][1]);for(this.ruler2=new e,n=0;n<r.length;n++)this.ruler2.push(r[n][0],r[n][1])}return n.prototype.skipToken=function(e){var t,r,n=e.pos,i=this.ruler.getRules(""),o=i.length,a=e.md.options.maxNesting,s=e.cache;if(void 0===s[n]){if(e.level<a)for(r=0;r<o&&(e.level++,t=i[r](e,!0),e.level--,!t);r++);else e.pos=e.posMax;t||e.pos++,s[n]=e.pos}else e.pos=s[n]},n.prototype.tokenize=function(e){for(var t,r,n=this.ruler.getRules(""),i=n.length,o=e.posMax,a=e.md.options.maxNesting;e.pos<o;){if(e.level<a)for(r=0;r<i&&!(t=n[r](e,!1));r++);if(t){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},n.prototype.parse=function(e,t,r,n){var i,o,a,s=new this.State(e,t,r,n);for(this.tokenize(s),a=(o=this.ruler2.getRules("")).length,i=0;i<a;i++)o[i](s)},n.prototype.State=requireState_inline(),parser_inline=n}function requireRe(){return hasRequiredRe?re:(hasRequiredRe=1,re=function(e){var t={};t.src_Any=requireRegex$3().source,t.src_Cc=requireRegex$2().source,t.src_Z=requireRegex().source,t.src_P=requireRegex$4().source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");var r="[><]";return t.src_pseudo_letter="(?:(?![><]|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|[><]|"+t.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+r+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]).|"+(e&&e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+").|;(?!"+t.src_ZCc+").|\\!+(?!"+t.src_ZCc+"|[!]).|\\?(?!"+t.src_ZCc+"|[?]).)+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy='(^|[><]|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t})}function requireLinkifyIt(){if(hasRequiredLinkifyIt)return linkifyIt;function e(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){t&&Object.keys(t).forEach((function(r){e[r]=t[r]}))})),e}function t(e){return Object.prototype.toString.call(e)}function r(e){return"[object Function]"===t(e)}function n(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}hasRequiredLinkifyIt=1;var i={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var o={"http:":{validate:function(e,t,r){var n=e.slice(t);return r.re.http||(r.re.http=new RegExp("^\\/\\/"+r.re.src_auth+r.re.src_host_port_strict+r.re.src_path,"i")),r.re.http.test(n)?n.match(r.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,r){var n=e.slice(t);return r.re.no_http||(r.re.no_http=new RegExp("^"+r.re.src_auth+"(?:localhost|(?:(?:"+r.re.src_domain+")\\.)+"+r.re.src_domain_root+")"+r.re.src_port+r.re.src_host_terminator+r.re.src_path,"i")),r.re.no_http.test(n)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:n.match(r.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,r){var n=e.slice(t);return r.re.mailto||(r.re.mailto=new RegExp("^"+r.re.src_email_name+"@"+r.re.src_host_strict,"i")),r.re.mailto.test(n)?n.match(r.re.mailto)[0].length:0}}},a="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function s(e){var i=e.re=requireRe()(e.__opts__),o=e.__tlds__.slice();function a(e){return e.replace("%TLDS%",i.src_tlds)}e.onCompile(),e.__tlds_replaced__||o.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),o.push(i.src_xn),i.src_tlds=o.join("|"),i.email_fuzzy=RegExp(a(i.tpl_email_fuzzy),"i"),i.link_fuzzy=RegExp(a(i.tpl_link_fuzzy),"i"),i.link_no_ip_fuzzy=RegExp(a(i.tpl_link_no_ip_fuzzy),"i"),i.host_fuzzy_test=RegExp(a(i.tpl_host_fuzzy_test),"i");var s=[];function l(e,t){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}e.__compiled__={},Object.keys(e.__schemas__).forEach((function(n){var i=e.__schemas__[n];if(null!==i){var o={validate:null,link:null};if(e.__compiled__[n]=o,"[object Object]"===t(i))return!function(e){return"[object RegExp]"===t(e)}(i.validate)?r(i.validate)?o.validate=i.validate:l(n,i):o.validate=function(e){return function(t,r){var n=t.slice(r);return e.test(n)?n.match(e)[0].length:0}}(i.validate),void(r(i.normalize)?o.normalize=i.normalize:i.normalize?l(n,i):o.normalize=function(e,t){t.normalize(e)});!function(e){return"[object String]"===t(e)}(i)?l(n,i):s.push(n)}})),s.forEach((function(t){e.__compiled__[e.__schemas__[t]]&&(e.__compiled__[t].validate=e.__compiled__[e.__schemas__[t]].validate,e.__compiled__[t].normalize=e.__compiled__[e.__schemas__[t]].normalize)})),e.__compiled__[""]={validate:null,normalize:function(e,t){t.normalize(e)}};var c=Object.keys(e.__compiled__).filter((function(t){return t.length>0&&e.__compiled__[t]})).map(n).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+i.src_ZPCc+"))("+c+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+i.src_ZPCc+"))("+c+")","ig"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(e)}function l(e,t){var r=e.__index__,n=e.__last_index__,i=e.__text_cache__.slice(r,n);this.schema=e.__schema__.toLowerCase(),this.index=r+t,this.lastIndex=n+t,this.raw=i,this.text=i,this.url=i}function c(e,t){var r=new l(e,t);return e.__compiled__[r.schema].normalize(r,e),r}function u(t,r){if(!(this instanceof u))return new u(t,r);var n;r||(n=t,Object.keys(n||{}).reduce((function(e,t){return e||i.hasOwnProperty(t)}),!1)&&(r=t,t={})),this.__opts__=e({},i,r),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=e({},o,t),this.__compiled__={},this.__tlds__=a,this.__tlds_replaced__=!1,this.re={},s(this)}return u.prototype.add=function(e,t){return this.__schemas__[e]=t,s(this),this},u.prototype.set=function(t){return this.__opts__=e(this.__opts__,t),this},u.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;var t,r,n,i,o,a,s,l;if(this.re.schema_test.test(e))for((s=this.re.schema_search).lastIndex=0;null!==(t=s.exec(e));)if(i=this.testSchemaAt(e,t[2],s.lastIndex)){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+i;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(o=r.index+r[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=r.index+r[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&e.indexOf("@")>=0&&null!==(n=e.match(this.re.email_fuzzy))&&(o=n.index+n[1].length,a=n.index+n[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=a)),this.__index__>=0},u.prototype.pretest=function(e){return this.re.pretest.test(e)},u.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0},u.prototype.match=function(e){var t=0,r=[];this.__index__>=0&&this.__text_cache__===e&&(r.push(c(this,t)),t=this.__last_index__);for(var n=t?e.slice(t):e;this.test(n);)r.push(c(this,t)),n=n.slice(this.__last_index__),t+=this.__last_index__;return r.length?r:null},u.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter((function(e,t,r){return e!==r[t-1]})).reverse(),s(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,s(this),this)},u.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},u.prototype.onCompile=function(){},linkifyIt=u}function require_default(){return hasRequired_default?_default:(hasRequired_default=1,_default={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}})}function requireZero(){return hasRequiredZero?zero:(hasRequiredZero=1,zero={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}})}function requireCommonmark(){return hasRequiredCommonmark?commonmark:(hasRequiredCommonmark=1,commonmark={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}})}function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1;var e=requireUtils(),t=requireHelpers(),r=requireRenderer(),n=requireParser_core(),i=requireParser_block(),o=requireParser_inline(),a=requireLinkifyIt(),s=requireMdurl(),l=requirePunycode(),c={default:require_default(),zero:requireZero(),commonmark:requireCommonmark()},u=/^(vbscript|javascript|file|data):/,h=/^data:image\/(gif|png|jpeg|webp);/;function d(e){var t=e.trim().toLowerCase();return!u.test(t)||!!h.test(t)}var p=["http:","https:","mailto:"];function f(e){var t=s.parse(e,!0);if(t.hostname&&(!t.protocol||p.indexOf(t.protocol)>=0))try{t.hostname=l.toASCII(t.hostname)}catch(r){}return s.encode(s.format(t))}function m(e){var t=s.parse(e,!0);if(t.hostname&&(!t.protocol||p.indexOf(t.protocol)>=0))try{t.hostname=l.toUnicode(t.hostname)}catch(r){}return s.decode(s.format(t),s.decode.defaultChars+"%")}function g(s,l){if(!(this instanceof g))return new g(s,l);l||e.isString(s)||(l=s||{},s="default"),this.inline=new o,this.block=new i,this.core=new n,this.renderer=new r,this.linkify=new a,this.validateLink=d,this.normalizeLink=f,this.normalizeLinkText=m,this.utils=e,this.helpers=e.assign({},t),this.options={},this.configure(s),l&&this.set(l)}return g.prototype.set=function(t){return e.assign(this.options,t),this},g.prototype.configure=function(t){var r,n=this;if(e.isString(t)&&!(t=c[r=t]))throw new Error('Wrong `markdown-it` preset "'+r+'", check name');if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&n.set(t.options),t.components&&Object.keys(t.components).forEach((function(e){t.components[e].rules&&n[e].ruler.enableOnly(t.components[e].rules),t.components[e].rules2&&n[e].ruler2.enableOnly(t.components[e].rules2)})),this},g.prototype.enable=function(e,t){var r=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach((function(t){r=r.concat(this[t].ruler.enable(e,!0))}),this),r=r.concat(this.inline.ruler2.enable(e,!0));var n=e.filter((function(e){return r.indexOf(e)<0}));if(n.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this},g.prototype.disable=function(e,t){var r=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach((function(t){r=r.concat(this[t].ruler.disable(e,!0))}),this),r=r.concat(this.inline.ruler2.disable(e,!0));var n=e.filter((function(e){return r.indexOf(e)<0}));if(n.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this},g.prototype.use=function(e){var t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this},g.prototype.parse=function(e,t){if("string"!=typeof e)throw new Error("Input data should be a String");var r=new this.core.State(e,this,t);return this.core.process(r),r.tokens},g.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},g.prototype.parseInline=function(e,t){var r=new this.core.State(e,this,t);return r.inlineMode=!0,this.core.process(r),r.tokens},g.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)},lib=g}function requireMarkdownIt(){return hasRequiredMarkdownIt?markdownIt$1:(hasRequiredMarkdownIt=1,markdownIt$1=requireLib())}var markdownItExports=requireMarkdownIt();const markdownIt=getDefaultExportFromCjs$1(markdownItExports);var markdownItImsize$1={exports:{}},markdownItImsize=markdownItImsize$1.exports,hasRequiredMarkdownItImsize;function requireMarkdownItImsize(){return hasRequiredMarkdownItImsize||(hasRequiredMarkdownItImsize=1,e=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){var n=r(2),i=r(1);e.exports=function(e,t){e.inline.ruler.before("emphasis","image",function(e,t){return function(r,o){var a,s,l,c,u,h,d,p,f,m,g,y,_="",v="",b="",w=r.pos,x=r.posMax;if(33!==r.src.charCodeAt(r.pos))return!1;if(91!==r.src.charCodeAt(r.pos+1))return!1;if(u=r.pos+2,(c=e.helpers.parseLinkLabel(r,r.pos+1,!1))<0)return!1;if((h=c+1)<x&&40===r.src.charCodeAt(h)){for(h++;h<x&&(32===(s=r.src.charCodeAt(h))||10===s);h++);if(h>=x)return!1;for(y=h,(p=e.helpers.parseLinkDestination(r.src,h,r.posMax)).ok&&(b=r.md.normalizeLink(p.str),r.md.validateLink(b)?h=p.pos:b=""),y=h;h<x&&(32===(s=r.src.charCodeAt(h))||10===s);h++);if(p=e.helpers.parseLinkTitle(r.src,h,r.posMax),h<x&&y!==h&&p.ok)for(f=p.str,h=p.pos;h<x&&(32===(s=r.src.charCodeAt(h))||10===s);h++);else f="";if(h-1>=0&&32===(s=r.src.charCodeAt(h-1))&&(p=i(r.src,h,r.posMax)).ok)for(_=p.width,v=p.height,h=p.pos;h<x&&(32===(s=r.src.charCodeAt(h))||10===s);h++);if(h>=x||41!==r.src.charCodeAt(h))return r.pos=w,!1;h++}else{if(void 0===r.env.references)return!1;for(;h<x&&(32===(s=r.src.charCodeAt(h))||10===s);h++);if(h<x&&91===r.src.charCodeAt(h)?(y=h+1,(h=e.helpers.parseLinkLabel(r,h))>=0?l=r.src.slice(y,h++):h=c+1):h=c+1,l||(l=r.src.slice(u,c)),!(d=r.env.references[e.utils.normalizeReference(l)]))return r.pos=w,!1;b=d.href,f=d.title}if(!o){r.pos=u,r.posMax=c;var S=new r.md.inline.State(r.src.slice(u,c),r.md,r.env,g=[]);if(S.md.inline.tokenize(S),t&&t.autofill&&""===_&&""===v)try{var E=n(b);_=E.width,v=E.height}catch(e2){}(m=r.push("image","img",0)).attrs=a=[["src",b],["alt",""]],m.children=g,f&&a.push(["title",f]),""!==_&&a.push(["width",_]),""!==v&&a.push(["height",v])}return r.pos=h,r.posMax=x,!0}}(e,t))}},function(e,t,r){function n(e,t,r){var n,i=t,o={ok:!1,pos:t,value:""};for(n=e.charCodeAt(t);t<r&&n>=48&&n<=57||37===n;)n=e.charCodeAt(++t);return o.ok=!0,o.pos=t,o.value=e.slice(i,t),o}e.exports=function(e,t,r){var i,o={ok:!1,pos:0,width:"",height:""};if(t>=r)return o;if(61!==(i=e.charCodeAt(t)))return o;if(t++,120!==(i=e.charCodeAt(t))&&(i<48||i>57))return o;var a=n(e,t,r);if(t=a.pos,120!==(i=e.charCodeAt(t)))return o;var s=n(e,++t,r);return t=s.pos,o.width=a.value,o.height=s.value,o.pos=t,o.ok=!0,o}},function(e,t,r){(function(t){var n=r(16),i=r(6),o=r(3),a={};r(5).forEach((function(e){a[e]=r(4)("./"+e)}));var s=131072;function l(e,t){var r=o(e,t);if(r in a){var n=a[r].calculate(e,t);if(!1!==n)return n.type=r,n}throw new TypeError("Unsupported file type")}e.exports=function(e,r){if("string"!=typeof e)throw new TypeError("Input must be file name");var o=i.resolve(e);if("function"!=typeof r){var a=function(e){var r=n.openSync(e,"r"),i=n.fstatSync(r).size,o=Math.min(i,s),a=new t(o);return n.readSync(r,a,0,o,0),n.closeSync(r),a}(o);return l(a,o)}!function(e,r){n.open(e,"r",(function(e,i){if(e)return r(e);var o=n.fstatSync(i).size,a=Math.min(o,s),l=new t(a);n.read(i,l,0,a,0,(function(e){if(e)return r(e);n.close(i,(function(e){r(e,l)}))}))}))}(o,(function(e,t){if(e)return r(e);var n;try{n=l(t,o)}catch(e2){e=e2}r(e,n)}))}}).call(t,r(7).Buffer)},function(e,t,r){var n={};r(5).forEach((function(e){n[e]=r(4)("./"+e).detect})),e.exports=function(e,t){var r;for(r in n)if(r in n&&n[r](e,t))return r;throw new TypeError("Unsupported type")}},function(e,t,r){var n={"./bmp":8,"./bmp.js":8,"./gif":9,"./gif.js":9,"./jpg":10,"./jpg.js":10,"./png":11,"./png.js":11,"./psd":12,"./psd.js":12,"./svg":13,"./svg.js":13,"./tiff":14,"./tiff.js":14,"./webp":15,"./webp.js":15};function i(e){return r(o(e))}function o(e){return n[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=4},function(e,t,r){e.exports=["bmp","gif","jpg","png","tiff"]},function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return n.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,n="/"===a.charAt(0))}return(n?"/":"")+(t=r(o(t.split("/"),(function(e){return!!e})),!n).join("/"))||"."},t.normalize=function(e){var n=t.isAbsolute(e),i="/"===a(e,-1);return(e=r(o(e.split("/"),(function(e){return!!e})),!n).join("/"))||n||(e="."),e&&i&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var i=n(e.split("/")),o=n(r.split("/")),a=Math.min(i.length,o.length),s=a,l=0;l<a;l++)if(i[l]!==o[l]){s=l;break}var c=[];for(l=s;l<i.length;l++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(t,r(18))},function(e,t,r){(function(e){
/*!
              * The buffer module from node.js, for the browser.
              *
              * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
              * @license  MIT
              */
var n=r(21),i=r(19),o=r(20);t.Buffer=e,t.SlowBuffer=function t(r,n){if(!(this instanceof t))return new t(r,n);var i=new e(r,n);return delete i.parent,i},t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var a=1073741823,s={};function e(t,r){var n=this;if(!(n instanceof e))return new e(t,r);var i,l,c=typeof t;if("number"===c)i=+t;else if("string"===c)i=e.byteLength(t,r);else{if("object"!==c||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&o(t.data)&&(t=t.data),i=+t.length}if(i>a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");if(i<0?i=0:i>>>=0,e.TYPED_ARRAY_SUPPORT?n=e._augment(new Uint8Array(i)):(n.length=i,n._isBuffer=!0),e.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)n._set(t);else if(function(t){return o(t)||e.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}(t))if(e.isBuffer(t))for(l=0;l<i;l++)n[l]=t.readUInt8(l);else for(l=0;l<i;l++)n[l]=(t[l]%256+256)%256;else if("string"===c)n.write(t,0,r);else if("number"===c&&!e.TYPED_ARRAY_SUPPORT)for(l=0;l<i;l++)n[l]=0;return i>0&&i<=e.poolSize&&(n.parent=s),n}function l(e,t,r,n){return A(function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function c(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function u(e,t,r){var n="",i="";r=Math.min(e.length,r);for(var o=t;o<r;o++)e[o]<=127?(n+=C(i)+String.fromCharCode(e[o]),i=""):i+="%"+e[o].toString(16);return n+C(i)}function h(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;i++)n+=String.fromCharCode(127&e[i]);return n}function d(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;i++)n+=String.fromCharCode(e[i]);return n}function p(e,t,r){var n,i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var o="",a=t;a<r;a++)o+=(n=e[a])<16?"0"+n.toString(16):n.toString(16);return o}function f(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function m(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function g(t,r,n,i,o,a){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(r>o||r<a)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range")}function y(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;i++)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function _(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;i++)e[r+i]=t>>>8*(n?i:3-i)&255}function v(e,t,r,n,i,o){if(t>i||t<o)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range");if(r<0)throw new RangeError("index out of range")}function b(e,t,r,n,o){return o||v(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function w(e,t,r,n,o){return o||v(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}e.TYPED_ARRAY_SUPPORT=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(e2){return!1}}(),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var n=t.length,i=r.length,o=0,a=Math.min(n,i);o<a&&t[o]===r[o];o++);return o!==a&&(n=t[o],i=r[o]),n<i?-1:i<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!o(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new e(0);if(1===t.length)return t[0];var n;if(void 0===r)for(r=0,n=0;n<t.length;n++)r+=t[n].length;var i=new e(r),a=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,a),a+=s.length}return i},e.byteLength=function(e,t){var r;switch(e+="",t||"utf8"){case"ascii":case"binary":case"raw":default:r=e.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*e.length;break;case"hex":r=e.length>>>1;break;case"utf8":case"utf-8":r=E(e).length;break;case"base64":r=T(e).length}return r},e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(e,t,r){var n=!1;if(e||(e="utf8"),(t>>>=0)<0&&(t=0),(r=void 0===r||r===1/0?this.length:r>>>0)>this.length&&(r=this.length),r<=t)return"";for(;;)switch(e){case"hex":return p(this,t,r);case"utf8":case"utf-8":return u(this,t,r);case"ascii":return h(this,t,r);case"binary":return d(this,t,r);case"base64":return c(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:e.compare(this,t)},e.prototype.indexOf=function(t,r){if(r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r>>=0,0===this.length)return-1;if(r>=this.length)return-1;if(r<0&&(r=Math.max(this.length+r,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,r);if(e.isBuffer(t))return n(this,t,r);if("number"==typeof t)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,r):n(this,[t],r);function n(e,t,r){for(var n=-1,i=0;r+i<e.length;i++)if(e[r+i]===t[-1===n?0:i-n]){if(-1===n&&(n=i),i-n+1===t.length)return r+n}else n=-1;return-1}throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(e){return this.readUInt8(e)},e.prototype.set=function(e,t){return this.writeUInt8(e,t)},e.prototype.write=function(e,t,r,n){if(isFinite(t))isFinite(r)||(n=r,r=void 0);else{var i=n;n=t,t=r,r=i}if(t=Number(t)||0,r<0||t<0||t>this.length)throw new RangeError("attempt to write outside buffer bounds");var o,a=this.length-t;switch(r?(r=Number(r))>a&&(r=a):r=a,n=String(n||"utf8").toLowerCase()){case"hex":o=function(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;a++){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");e[r+a]=s}return a}(this,e,t,r);break;case"utf8":case"utf-8":o=function(e,t,r,n){return A(E(t,e.length-r),e,r,n)}(this,e,t,r);break;case"ascii":o=l(this,e,t,r);break;case"binary":o=function(e,t,r,n){return l(e,t,r,n)}(this,e,t,r);break;case"base64":o=function(e,t,r,n){return A(T(t),e,r,n)}(this,e,t,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=function(e,t,r,n){return A(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);a++)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}(this,e,t,r);break;default:throw new TypeError("Unknown encoding: "+n)}return o},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},e.prototype.slice=function(t,r){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(r=void 0===r?i:~~r)<0?(r+=i)<0&&(r=0):r>i&&(r=i),r<t&&(r=t),e.TYPED_ARRAY_SUPPORT)n=e._augment(this.subarray(t,r));else{var o=r-t;n=new e(o,void 0);for(var a=0;a<o;a++)n[a]=this[a+t]}return n.length&&(n.parent=this.parent||this),n},e.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||m(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},e.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||m(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},e.prototype.readUInt8=function(e,t){return t||m(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||m(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||m(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||m(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||m(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||m(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||m(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return t||m(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){t||m(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){t||m(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return t||m(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||m(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||m(e,4,this.length),i.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||m(e,4,this.length),i.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||m(e,8,this.length),i.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||m(e,8,this.length),i.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||g(this,e,t,r,Math.pow(2,8*r),0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i>>>0&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||g(this,e,t,r,Math.pow(2,8*r),0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o>>>0&255;return t+r},e.prototype.writeUInt8=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=t,r+1},e.prototype.writeUInt16LE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t,this[r+1]=t>>>8):y(this,t,r,!0),r+2},e.prototype.writeUInt16BE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=t):y(this,t,r,!1),r+2},e.prototype.writeUInt32LE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=t):_(this,t,r,!0),r+4},e.prototype.writeUInt32BE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t):_(this,t,r,!1),r+4},e.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||g(this,e,t,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=0,o=1,a=e<0?1:0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=(e/o|0)-a&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||g(this,e,t,r,Math.pow(2,8*r-1)-1,-Math.pow(2,8*r-1));var i=r-1,o=1,a=e<0?1:0;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=(e/o|0)-a&255;return t+r},e.prototype.writeInt8=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=t,r+1},e.prototype.writeInt16LE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=t,this[r+1]=t>>>8):y(this,t,r,!0),r+2},e.prototype.writeInt16BE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=t):y(this,t,r,!1),r+2},e.prototype.writeInt32LE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[r]=t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):_(this,t,r,!0),r+4},e.prototype.writeInt32BE=function(t,r,n){return t=+t,r>>>=0,n||g(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t):_(this,t,r,!1),r+4},e.prototype.writeFloatLE=function(e,t,r){return b(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return b(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return w(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return w(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,i){if(n||(n=0),i||0===i||(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);var o=i-n;if(o<1e3||!e.TYPED_ARRAY_SUPPORT)for(var a=0;a<o;a++)t[a+r]=this[a+n];else t._set(this.subarray(n,n+o),r);return o},e.prototype.fill=function(e,t,r){if(e||(e=0),t||(t=0),r||(r=this.length),r<t)throw new RangeError("end < start");if(r!==t&&0!==this.length){if(t<0||t>=this.length)throw new RangeError("start out of bounds");if(r<0||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof e)for(n=t;n<r;n++)this[n]=e;else{var i=E(e.toString()),o=i.length;for(n=t;n<r;n++)this[n]=i[n%o]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),r=0,n=t.length;r<n;r+=1)t[r]=this[r];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var x=e.prototype;e._augment=function(t){return t.constructor=e,t._isBuffer=!0,t._set=t.set,t.get=x.get,t.set=x.set,t.write=x.write,t.toString=x.toString,t.toLocaleString=x.toString,t.toJSON=x.toJSON,t.equals=x.equals,t.compare=x.compare,t.indexOf=x.indexOf,t.copy=x.copy,t.slice=x.slice,t.readUIntLE=x.readUIntLE,t.readUIntBE=x.readUIntBE,t.readUInt8=x.readUInt8,t.readUInt16LE=x.readUInt16LE,t.readUInt16BE=x.readUInt16BE,t.readUInt32LE=x.readUInt32LE,t.readUInt32BE=x.readUInt32BE,t.readIntLE=x.readIntLE,t.readIntBE=x.readIntBE,t.readInt8=x.readInt8,t.readInt16LE=x.readInt16LE,t.readInt16BE=x.readInt16BE,t.readInt32LE=x.readInt32LE,t.readInt32BE=x.readInt32BE,t.readFloatLE=x.readFloatLE,t.readFloatBE=x.readFloatBE,t.readDoubleLE=x.readDoubleLE,t.readDoubleBE=x.readDoubleBE,t.writeUInt8=x.writeUInt8,t.writeUIntLE=x.writeUIntLE,t.writeUIntBE=x.writeUIntBE,t.writeUInt16LE=x.writeUInt16LE,t.writeUInt16BE=x.writeUInt16BE,t.writeUInt32LE=x.writeUInt32LE,t.writeUInt32BE=x.writeUInt32BE,t.writeIntLE=x.writeIntLE,t.writeIntBE=x.writeIntBE,t.writeInt8=x.writeInt8,t.writeInt16LE=x.writeInt16LE,t.writeInt16BE=x.writeInt16BE,t.writeInt32LE=x.writeInt32LE,t.writeInt32BE=x.writeInt32BE,t.writeFloatLE=x.writeFloatLE,t.writeFloatBE=x.writeFloatBE,t.writeDoubleLE=x.writeDoubleLE,t.writeDoubleBE=x.writeDoubleBE,t.fill=x.fill,t.inspect=x.inspect,t.toArrayBuffer=x.toArrayBuffer,t};var S=/[^+\/0-9A-z\-]/g;function E(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;a++){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((t-=3)>-1&&o.push(239,191,189),i=null);if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<2097152))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function T(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(S,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);i++)t[i+r]=e[i];return i}function C(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}}).call(t,r(7).Buffer)},function(e,t,r){e.exports={detect:function(e){return"BM"===e.toString("ascii",0,2)},calculate:function(e){return{width:e.readUInt32LE(18),height:e.readUInt32LE(22)}}}},function(e,t,r){var n=/^GIF8[7,9]a/;e.exports={detect:function(e){var t=e.toString("ascii",0,6);return n.test(t)},calculate:function(e){return{width:e.readUInt16LE(6),height:e.readUInt16LE(8)}}}},function(e,t,r){var n={ffdb:"0001010101",ffe0:"4a46494600",ffe1:"4578696600",ffe2:"4943435f50",ffe3:"",ffe8:"5350494646",ffec:"4475636b79",ffed:"50686f746f",ffee:"41646f6265"};function i(e,t){return{height:e.readUInt16BE(t),width:e.readUInt16BE(t+2)}}function o(e,t){if(t>e.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==e[t])throw new TypeError("Invalid JPG, marker table corrupted")}e.exports={detect:function(e){var t=e.toString("hex",0,2),r=e.toString("hex",2,4);if("ffd8"!==t)return!1;var i=e.toString("hex",6,11),o=r&&n[r];return""!==o&&(i===o||"ffdb"===r)},calculate:function(e){var t,r;for(e=e.slice(4);e.length;){if(t=e.readUInt16BE(0),o(e,t),192===(r=e[t+1])||194===r)return i(e,t+5);e=e.slice(t+2)}throw new TypeError("Invalid JPG, no size found")}}},function(e,t,r){e.exports={detect:function(e){if("PNG\r\n\n"===e.toString("ascii",1,8)){if("IHDR"!==e.toString("ascii",12,16))throw new TypeError("invalid png");return!0}},calculate:function(e){return{width:e.readUInt32BE(16),height:e.readUInt32BE(20)}}}},function(e,t,r){e.exports={detect:function(e){return"8BPS"===e.toString("ascii",0,4)},calculate:function(e){return{width:e.readUInt32BE(18),height:e.readUInt32BE(14)}}}},function(e,t,r){var n=/<svg[^>]+[^>]*>/,i=/<svg [^>]+>/,o=/(^|\s)width\s*=\s*"(.+?)"/i,a=/(^|\s)height\s*=\s*"(.+?)"/i,s=/(^|\s)viewbox\s*=\s*"(.+?)"/i;function l(e){var t=e.toString().replace(/[\r\n\s]+/g," ").match(i),r=t&&t[0];if(r){var n=r.match(o),l=r.match(a),c=function(e){var t=1;if(e&&e[2]){var r=e[2].split(/\s/g);4===r.length&&(t=((r=r.map((function(e){return parseInt(e,10)})))[2]-r[0])/(r[3]-r[1]))}return t}(r.match(s));return{width:parseInt(n&&n[2],10)||0,height:parseInt(l&&l[2],10)||0,ratio:c}}}e.exports={detect:function(e){return n.test(e)},calculate:function(e){var t=l(e),r=t.width,n=t.height,i=t.ratio;if(r&&n)return{width:r,height:n};if(r)return{width:r,height:Math.floor(r/i)};if(n)return{width:Math.floor(n*i),height:n};throw new TypeError("invalid svg")}}},function(e,t,r){(function(t){var n=r(16),i=r(17);function o(e,t){var r=i(e,16,8,t);return(i(e,16,10,t)<<16)+r}function a(e){if(e.length>24)return e.slice(12)}e.exports={detect:function(e){var t=e.toString("hex",0,4);return"49492a00"===t||"4d4d002a"===t},calculate:function(e,r){if(!r)throw new TypeError("Tiff doesn't support buffer");var s="BE"===function(e){var t=e.toString("ascii",0,2);return"II"===t?"LE":"MM"===t?"BE":void 0}(e),l=function(e,t){for(var r,n,s,l={};e&&e.length&&(r=i(e,16,0,t),n=i(e,16,2,t),s=i(e,32,4,t),0!==r);)1===s&&3===n&&(l[r]=o(e,t)),e=a(e);return l}(function(e,r,o){var a=i(e,32,4,o),s=1024,l=n.statSync(r).size;a+s>l&&(s=l-a-10);var c=new t(s),u=n.openSync(r,"r");return n.readSync(u,c,0,s,a),c.slice(2)}(e,r,s),s),c=l[256],u=l[257];if(!c||!u)throw new TypeError("Invalid Tiff, missing tags");return{width:c,height:u}}}}).call(t,r(7).Buffer)},function(e,t,r){e.exports={detect:function(e){var t="RIFF"===e.toString("ascii",0,4),r="WEBP"===e.toString("ascii",8,12),n="VP8"===e.toString("ascii",12,15);return t&&r&&n},calculate:function(e){var t=e.toString("ascii",12,16);if(e=e.slice(20,30),"VP8 "===t&&47!==e[0])return function(e){return{width:16383&e.readInt16LE(6),height:16383&e.readInt16LE(8)}}(e);var r=e.toString("hex",3,6);return"VP8L"===t&&"9d012a"!==r&&function(e){return{width:1+((63&e[2])<<8|e[1]),height:1+((15&e[4])<<10|e[3]<<2|(192&e[2])>>6)}}(e)}}},function(e,t,r){},function(e,t,r){e.exports=function(e,t,r,n){return r=r||0,e["readUInt"+t+(n?"BE":"LE")].call(e,r)}},function(e,t,r){var n=e.exports={},i=[],o=!1;function a(){if(!o){var e;o=!0;for(var t=i.length;t;){e=i,i=[];for(var r=-1;++r<t;)e[r]();t=i.length}o=!1}}function s(){}n.nextTick=function(e){i.push(e),o||setTimeout(a,0)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=s,n.addListener=s,n.once=s,n.off=s,n.removeListener=s,n.removeAllListeners=s,n.emit=s,n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=f,a/=256,c-=8);e[r+p-f]|=128*m}},function(e,t,r){var n=Array.isArray,i=Object.prototype.toString;e.exports=n||function(e){return!!e&&"[object Array]"==i.call(e)}},function(e,t,r){!function(e){var t="undefined"!=typeof Uint8Array?Uint8Array:Array,r="+".charCodeAt(0),n="/".charCodeAt(0),i="0".charCodeAt(0),o="a".charCodeAt(0),a="A".charCodeAt(0),s="-".charCodeAt(0),l="_".charCodeAt(0);function c(e){var t=e.charCodeAt(0);return t===r||t===s?62:t===n||t===l?63:t<i?-1:t<i+10?t-i+26+26:t<a+26?t-a:t<o+26?t-o+26:void 0}e.toByteArray=function(e){var r,n,i,o,a,s;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=e.length;a="="===e.charAt(l-2)?2:"="===e.charAt(l-1)?1:0,s=new t(3*e.length/4-a),i=a>0?e.length-4:e.length;var u=0;function h(e){s[u++]=e}for(r=0,n=0;r<i;r+=4,n+=3)h((16711680&(o=c(e.charAt(r))<<18|c(e.charAt(r+1))<<12|c(e.charAt(r+2))<<6|c(e.charAt(r+3))))>>16),h((65280&o)>>8),h(255&o);return 2===a?h(255&(o=c(e.charAt(r))<<2|c(e.charAt(r+1))>>4)):1===a&&(h((o=c(e.charAt(r))<<10|c(e.charAt(r+1))<<4|c(e.charAt(r+2))>>2)>>8&255),h(255&o)),s},e.fromByteArray=function(e){var t,r,n,i,o=e.length%3,a="";function s(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,n=e.length-o;t<n;t+=3)r=(e[t]<<16)+(e[t+1]<<8)+e[t+2],a+=s((i=r)>>18&63)+s(i>>12&63)+s(i>>6&63)+s(63&i);switch(o){case 1:a+=s((r=e[e.length-1])>>2),a+=s(r<<4&63),a+="==";break;case 2:a+=s((r=(e[e.length-2]<<8)+e[e.length-1])>>10),a+=s(r>>4&63),a+=s(r<<2&63),a+="="}return a}}(t)}])},markdownItImsize$1.exports=e()),markdownItImsize$1.exports;var e}var markdownItImsizeExports=requireMarkdownItImsize();const imsize=getDefaultExportFromCjs$1(markdownItImsizeExports);var prism={exports:{}},hasRequiredPrism;function requirePrism(){return hasRequiredPrism||(hasRequiredPrism=1,e=prism,t=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,r=0,n={},i={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof o?new o(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++r}),e.__id},clone:function e(t,r){var n,o;switch(r=r||{},i.util.type(t)){case"Object":if(o=i.util.objId(t),r[o])return r[o];for(var a in n={},r[o]=n,t)t.hasOwnProperty(a)&&(n[a]=e(t[a],r));return n;case"Array":return o=i.util.objId(t),r[o]?r[o]:(n=[],r[o]=n,t.forEach((function(t,i){n[i]=e(t,r)})),n);default:return t}},getLanguage:function(e){for(;e;){var r=t.exec(e.className);if(r)return r[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,r){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+r)},currentScript:function(){if("undefined"==typeof document)return null;if(document.currentScript&&"SCRIPT"===document.currentScript.tagName)return document.currentScript;try{throw new Error}catch(n){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(n.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var r in t)if(t[r].src==e)return t[r]}return null}},isActive:function(e,t,r){for(var n="no-"+t;e;){var i=e.classList;if(i.contains(t))return!0;if(i.contains(n))return!1;e=e.parentElement}return!!r}},languages:{plain:n,plaintext:n,text:n,txt:n,extend:function(e,t){var r=i.util.clone(i.languages[e]);for(var n in t)r[n]=t[n];return r},insertBefore:function(e,t,r,n){var o=(n=n||i.languages)[e],a={};for(var s in o)if(o.hasOwnProperty(s)){if(s==t)for(var l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);r.hasOwnProperty(s)||(a[s]=o[s])}var c=n[e];return n[e]=a,i.languages.DFS(i.languages,(function(t,r){r===c&&t!=e&&(this[t]=a)})),a},DFS:function e(t,r,n,o){o=o||{};var a=i.util.objId;for(var s in t)if(t.hasOwnProperty(s)){r.call(t,s,t[s],n||s);var l=t[s],c=i.util.type(l);"Object"!==c||o[a(l)]?"Array"!==c||o[a(l)]||(o[a(l)]=!0,e(l,r,s,o)):(o[a(l)]=!0,e(l,r,null,o))}}},plugins:{},highlightAll:function(e,t){i.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,r){var n={callback:r,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};i.hooks.run("before-highlightall",n),n.elements=Array.prototype.slice.apply(n.container.querySelectorAll(n.selector)),i.hooks.run("before-all-elements-highlight",n);for(var o,a=0;o=n.elements[a++];)i.highlightElement(o,!0===t,n.callback)},highlightElement:function(t,r,n){var o=i.util.getLanguage(t),a=i.languages[o];i.util.setLanguage(t,o);var s=t.parentElement;s&&"pre"===s.nodeName.toLowerCase()&&i.util.setLanguage(s,o);var l={element:t,language:o,grammar:a,code:t.textContent};function c(e){l.highlightedCode=e,i.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,i.hooks.run("after-highlight",l),i.hooks.run("complete",l),n&&n.call(l.element)}if(i.hooks.run("before-sanity-check",l),(s=l.element.parentElement)&&"pre"===s.nodeName.toLowerCase()&&!s.hasAttribute("tabindex")&&s.setAttribute("tabindex","0"),!l.code)return i.hooks.run("complete",l),void(n&&n.call(l.element));if(i.hooks.run("before-highlight",l),l.grammar)if(r&&e.Worker){var u=new Worker(i.filename);u.onmessage=function(e){c(e.data)},u.postMessage(JSON.stringify({language:l.language,code:l.code,immediateClose:!0}))}else c(i.highlight(l.code,l.grammar,l.language));else c(i.util.encode(l.code))},highlight:function(e,t,r){var n={code:e,grammar:t,language:r};if(i.hooks.run("before-tokenize",n),!n.grammar)throw new Error('The language "'+n.language+'" has no grammar.');return n.tokens=i.tokenize(n.code,n.grammar),i.hooks.run("after-tokenize",n),o.stringify(i.util.encode(n.tokens),n.language)},tokenize:function(e,t){var r=t.rest;if(r){for(var n in r)t[n]=r[n];delete t.rest}var i=new l;return c(i,i.head,e),s(e,i,t,i.head,0),function(e){for(var t=[],r=e.head.next;r!==e.tail;)t.push(r.value),r=r.next;return t}(i)},hooks:{all:{},add:function(e,t){var r=i.hooks.all;r[e]=r[e]||[],r[e].push(t)},run:function(e,t){var r=i.hooks.all[e];if(r&&r.length)for(var n,o=0;n=r[o++];)n(t)}},Token:o};function o(e,t,r,n){this.type=e,this.content=t,this.alias=r,this.length=0|(n||"").length}function a(e,t,r,n){e.lastIndex=t;var i=e.exec(r);if(i&&n&&i[1]){var o=i[1].length;i.index+=o,i[0]=i[0].slice(o)}return i}function s(e,t,r,n,l,h){for(var d in r)if(r.hasOwnProperty(d)&&r[d]){var p=r[d];p=Array.isArray(p)?p:[p];for(var f=0;f<p.length;++f){if(h&&h.cause==d+","+f)return;var m=p[f],g=m.inside,y=!!m.lookbehind,_=!!m.greedy,v=m.alias;if(_&&!m.pattern.global){var b=m.pattern.toString().match(/[imsuy]*$/)[0];m.pattern=RegExp(m.pattern.source,b+"g")}for(var w=m.pattern||m,x=n.next,S=l;x!==t.tail&&!(h&&S>=h.reach);S+=x.value.length,x=x.next){var E=x.value;if(t.length>e.length)return;if(!(E instanceof o)){var T,A=1;if(_){if(!(T=a(w,S,e,y))||T.index>=e.length)break;var C=T.index,I=T.index+T[0].length,k=S;for(k+=x.value.length;C>=k;)k+=(x=x.next).value.length;if(S=k-=x.value.length,x.value instanceof o)continue;for(var P=x;P!==t.tail&&(k<I||"string"==typeof P.value);P=P.next)A++,k+=P.value.length;A--,E=e.slice(S,k),T.index-=S}else if(!(T=a(w,0,E,y)))continue;C=T.index;var M=T[0],R=E.slice(0,C),D=E.slice(C+M.length),O=S+E.length;h&&O>h.reach&&(h.reach=O);var L=x.prev;if(R&&(L=c(t,L,R),S+=R.length),u(t,L,A),x=c(t,L,new o(d,g?i.tokenize(M,g):M,v,M)),D&&c(t,x,D),A>1){var B={cause:d+","+f,reach:O};s(e,t,r,x.prev,S,B),h&&B.reach>h.reach&&(h.reach=B.reach)}}}}}}function l(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function c(e,t,r){var n=t.next,i={value:r,prev:t,next:n};return t.next=i,n.prev=i,e.length++,i}function u(e,t,r){for(var n=t.next,i=0;i<r&&n!==e.tail;i++)n=n.next;t.next=n,n.prev=t,e.length-=i}if(e.Prism=i,o.stringify=function e(t,r){if("string"==typeof t)return t;if(Array.isArray(t)){var n="";return t.forEach((function(t){n+=e(t,r)})),n}var o={type:t.type,content:e(t.content,r),tag:"span",classes:["token",t.type],attributes:{},language:r},a=t.alias;a&&(Array.isArray(a)?Array.prototype.push.apply(o.classes,a):o.classes.push(a)),i.hooks.run("wrap",o);var s="";for(var l in o.attributes)s+=" "+l+'="'+(o.attributes[l]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+s+">"+o.content+"</"+o.tag+">"},!e.document)return e.addEventListener?(i.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var r=JSON.parse(t.data),n=r.language,o=r.code,a=r.immediateClose;e.postMessage(i.highlight(o,i.languages[n],n)),a&&e.close()}),!1),i):i;var h=i.util.currentScript();function d(){i.manual||i.highlightAll()}if(h&&(i.filename=h.src,h.hasAttribute("data-manual")&&(i.manual=!0)),!i.manual){var p=document.readyState;"loading"===p||"interactive"===p&&h&&h.defer?document.addEventListener("DOMContentLoaded",d):window.requestAnimationFrame?window.requestAnimationFrame(d):window.setTimeout(d,16)}return i}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{}),e.exports&&(e.exports=t),void 0!==commonjsGlobal&&(commonjsGlobal.Prism=t),t.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},t.languages.markup.tag.inside["attr-value"].inside.entity=t.languages.markup.entity,t.languages.markup.doctype.inside["internal-subset"].inside=t.languages.markup,t.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(t.languages.markup.tag,"addInlined",{value:function(e,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:t.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+r]={pattern:/[\s\S]+/,inside:t.languages[r]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:i},t.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(t.languages.markup.tag,"addAttribute",{value:function(e,r){t.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[r,"language-"+r],inside:t.languages[r]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),t.languages.html=t.languages.markup,t.languages.mathml=t.languages.markup,t.languages.svg=t.languages.markup,t.languages.xml=t.languages.extend("markup",{}),t.languages.ssml=t.languages.xml,t.languages.atom=t.languages.xml,t.languages.rss=t.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))}(t),t.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},t.languages.javascript=t.languages.extend("clike",{"class-name":[t.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),t.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,t.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:t.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:t.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:t.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:t.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:t.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),t.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:t.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),t.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),t.languages.markup&&(t.languages.markup.tag.addInlined("script","javascript"),t.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),t.languages.js=t.languages.javascript,function(){if(void 0!==t&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},r="data-src-status",n="loading",i="loaded",o="pre[data-src]:not(["+r+'="'+i+'"]):not(['+r+'="'+n+'"])';t.hooks.add("before-highlightall",(function(e){e.selector+=", "+o})),t.hooks.add("before-sanity-check",(function(a){var s=a.element;if(s.matches(o)){a.code="",s.setAttribute(r,n);var l=s.appendChild(document.createElement("CODE"));l.textContent="Loading";var c=s.getAttribute("data-src"),u=a.language;if("none"===u){var h=(/\.(\w+)$/.exec(c)||[,"none"])[1];u=e[h]||h}t.util.setLanguage(l,u),t.util.setLanguage(s,u);var d=t.plugins.autoloader;d&&d.loadLanguages(u),function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&(n.status<400&&n.responseText?t(n.responseText):n.status>=400?r(" Error "+n.status+" while fetching file: "+n.statusText):r(" Error: File does not exist or is empty"))},n.send(null)}(c,(function(e){s.setAttribute(r,i);var n=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var r=Number(t[1]),n=t[2],i=t[3];return n?i?[r,Number(i)]:[r,void 0]:[r,r]}}(s.getAttribute("data-range"));if(n){var o=e.split(/\r\n?|\n/g),a=n[0],c=null==n[1]?o.length:n[1];a<0&&(a+=o.length),a=Math.max(0,Math.min(a-1,o.length)),c<0&&(c+=o.length),c=Math.max(0,Math.min(c,o.length)),e=o.slice(a,c).join("\n"),s.hasAttribute("data-start")||s.setAttribute("data-start",String(a+1))}l.textContent=e,t.highlightElement(l)}),(function(e){s.setAttribute(r,"failed"),l.textContent=e}))}})),t.plugins.fileHighlight={highlight:function(e){for(var r,n=(e||document).querySelectorAll(o),i=0;r=n[i++];)t.highlightElement(r)}};var a=!1;t.fileHighlight=function(){a||(a=!0),t.plugins.fileHighlight.highlight.apply(this,arguments)}}}()),prism.exports;var e,t}var prismExports=requirePrism();const Prism=getDefaultExportFromCjs$1(prismExports);function prismHighlight(e,t,r){if(""===r?r="js":"vue"===r&&(r="html"),void 0!==e.languages[r]){return`<pre class="q-markdown--code q-markdown--code__inner language-${r}"><code>${e.highlight(t,e.languages[r],r)}</code></pre>\n`}return""}function extendBlockQuote(e){e.renderer.rules.blockquote_open=(e,t,r,n,i)=>(e[t].attrSet("class","q-markdown--note"),i.renderToken(e,t,r))}function containerPlugin(e,t,r){const n=(r=r||{}).marker||":",i=n.charCodeAt(0),o=n.length,a=r.validate||function(e){return e.trim().split(" ",2)[0]===t},s=r.render||function(e,r,n,i,o){return 1===e[r].nesting&&e[r].attrPush(["class",t]),o.renderToken(e,r,n,i,o)};e.block.ruler.before("fence","container_"+t,(function(e,r,s,l){let c,u,h,d=!1,p=e.bMarks[r]+e.tShift[r],f=e.eMarks[r];if(i!==e.src.charCodeAt(p))return!1;for(c=p+1;c<=f&&n[(c-p)%o]===e.src[c];c++);const m=Math.floor((c-p)/o);if(m<3)return!1;c-=(c-p)%o;const g=e.src.slice(p,c),y=e.src.slice(c,f);if(!a(y))return!1;if(l)return!0;for(u=r;(u++,!(u>=s))&&(p=e.bMarks[u]+e.tShift[u],f=e.eMarks[u],!(p<f&&e.sCount[u]<e.blkIndent));)if(i===e.src.charCodeAt(p)&&!(e.sCount[u]-e.blkIndent>=4)){for(c=p+1;c<=f&&n[(c-p)%o]===e.src[c];c++);if(!(Math.floor((c-p)/o)<m||(c-=(c-p)%o,c=e.skipSpaces(c),c<f))){d=!0;break}}const _=e.parentType,v=e.lineMax;return e.parentType="container",e.lineMax=u,h=e.push("container_"+t+"_open","div",1),h.markup=g,h.block=!0,h.info=y,h.map=[r,u],e.md.block.tokenize(e,r+1,u),h=e.push("container_"+t+"_close","div",-1),h.markup=e.src.slice(p,c),h.block=!0,e.parentType=_,e.lineMax=v,e.line=u+(d?1:0),!0}),{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules["container_"+t+"_open"]=s,e.renderer.rules["container_"+t+"_close"]=s}function createContainer(e,t){return[containerPlugin,e,{render(r,n){const i=r[n],o=i.info.trim().slice(e.length).trim();return 1===i.nesting?`<div class="q-markdown--note q-markdown--note--${e}"><p class="q-markdown--note-title">${o||t}</p>\n`:"</div>\n"}}]}function extendContainers(e){e.use(...createContainer("info","INFO")),e.use(...createContainer("tip","TIP")),e.use(...createContainer("warning","WARNING")),e.use(...createContainer("danger","IMPORTANT")),e.use(...createContainer("","")),e.use(containerPlugin,"v-pre",{render:(e,t)=>1===e[t].nesting?"<div v-pre>\n":"</div>\n"})}function slugify(e){return encodeURIComponent(String(e).trim().replace(/\s+/g,"-"))}function unemoji(e,t){return"emoji"===t.type?Object.assign(new e,t,{content:t.markup}):t}function extendHeading(e,t=[],r=!1,n=1,i=3,o=!1){let a;e.core.ruler.push("headingLinks",(function(e){a||(a=e.Token)})),e.renderer.rules.heading_open=(s,l,c,u,h)=>{const d=s[l],p=parseInt(d.tag[1]),f=s[l+1].children,m=f.reduce(((e,t)=>e+t.content),""),g=[];g.push("q-markdown--heading"),g.push(`q-markdown--heading-${d.tag}`),"="===d.markup?g.push("q-markdown--title-heavy"):"-"===d.markup&&g.push("q-markdown--title-light"),!0!==o&&n&&i&&n<=i&&p>=n&&p<=i&&g.push("q-markdown--heading--anchor-link");const y=unemoji.bind(null,a),_=slugify(e.renderer.renderInline(f.map(y),c,u).replace(/[<>]/g,"").toLowerCase());if(d.attrSet("id",_),d.attrSet("name",_),d.attrSet("class",g.join(" ")),r&&n&&i&&n<=i&&p>=n&&p<=i&&t.push({id:_,label:m,level:p,children:[]}),!0!==o&&p<=i){const t=new a("link_open","a",1);t.attrSet("href","#"+_),t.attrSet("aria-hidden","true");const r=new a("link_close","a",-1),n=f.slice();return s[l+1].children=[t,...n,r],e.renderer.renderToken(s,l,c,u,h)}return h.renderToken(s,l,c)}}function extendImage(e){e.renderer.rules.image=(e,t,r,n,i)=>{const o=e[t];return o.attrSet("class","q-markdown--image"),Array.isArray(o.children)&&o.children.length>0&&"text"===o.children[0].type&&o.attrSet("alt",o.children[0].content),i.renderToken(e,t,r)}}function extendLink(e,{noopener:t=!0,noreferrer:r=!0}){e.renderer.rules.link_open=(e,n,i,o,a)=>{const s=e[n],l=s.attrIndex("href");if("#"===s.attrs[l][1][0]&&"undefined"!=typeof location&&(s.attrs[l][1]=location.pathname+s.attrs[l][1]),""===s.attrs[l][1])s.attrSet("class","q-markdown--link q-markdown--link-local"),e[n+1]&&"text"===e[n+1].type&&e[n+1].content&&s.attrSet("id",slugify(e[n+1].content));else if("/"===s.attrs[l][1][0]||"#"===s.attrs[l][1][0]||s.attrs[l][1].startsWith(".."))s.attrSet("class","q-markdown--link q-markdown--link-local");else if(s.attrSet("class","q-markdown--link q-markdown--link-external"),s.attrSet("target","_blank"),!0===t||!0===r){const e=[];!0===t&&e.push("noopener"),!0===r&&e.push("noreferrer"),s.attrSet("rel",e.join(" "))}return a.renderToken(e,n,i)}}function extendTable(e){e.renderer.rules.table_open=(e,t,r,n,i)=>(e[t].attrSet("class","q-markdown--table"),i.renderToken(e,t,r))}function extendToken(e){const t=e.renderer.rules.code_inline;e.renderer.rules.code_inline=(e,r,n,i,o)=>(e[r].attrSet("class","q-markdown--token"),t(e,r,n,i,o))}function extendFenceLineNumbers(e,t){const r=e.renderer.rules.fence;e.renderer.rules.fence=(...e)=>{const n=r(...e),i=n.slice(n.indexOf("<code>")+6,n.indexOf("</code>")).trim().split("\n"),o=`<div class="q-markdown--line-numbers non-selectable">${[...Array(i.length)].map(((e,r)=>`<div class="q-markup--line-number">${void 0===t?r+1:t}</div>`)).join("")}</div><div class="q-markdown--code-wrapper">${n}</div>`;return`<div class="q-markdown--line-numbers-wrapper">${i.length<3?n:o}</div>`}}function fallback(e){const t=document.createElement("textarea");t.value=e,t.contentEditable="true",t.style.position="fixed";const r=()=>{};addFocusout(r),document.body.appendChild(t),t.focus(),t.select();const n=document.execCommand("copy");return t.remove(),removeFocusout(r),n}function copyToClipboard(e){return void 0!==navigator.clipboard?navigator.clipboard.writeText(e):new Promise(((t,r)=>{const n=fallback(e);n?t(!0):r(n)}))}const globalProps=reactive({});function useQMarkdownGlobalProps(e){for(const t in globalProps)delete globalProps[t];for(const t in e)globalProps[t]=e[t]}const QMarkdown=defineComponent({name:"QMarkdown",props:{src:{type:String,default:""},noBlockquote:Boolean,noBreaks:Boolean,noContainer:Boolean,noHighlight:Boolean,noHtml:Boolean,noImage:Boolean,noLineNumbers:Boolean,noLink:Boolean,noLinkify:Boolean,noHeadingAnchorLinks:Boolean,noTypographer:Boolean,lineNumberAlt:{type:String,validator:e=>1===e.length},toc:Boolean,tocStart:{type:Number,default:1,validator:e=>e>=1&&e<=6},tocEnd:{type:Number,default:3,validator:e=>e>=1&&e<=6},contentStyle:[Object,Array,String],contentClass:[Object,Array,String],noNoopener:Boolean,noNoreferrer:Boolean,showCopy:Boolean,copyIcon:String,noCopyTooltip:Boolean,doneIcon:String,copyTooltipText:{type:String,default:"Copy to clipboard"},copyResponseText:{type:String,default:"Copied to clipboard"},fixCr:Boolean,plugins:{type:Array,default:()=>[]}},emits:["data"],setup(e,{slots:t,emit:r,expose:n}){const i=useQuasar(),o=ref$1(null),a=ref$1(null),s=ref$1(null);onBeforeMount((()=>{l.value.src&&l.value.src.length>0&&(a.value=l.value.fixCr?l.value.src.replace(/\\n/gi,"\n"):l.value.src)}));const l=computed((()=>({...e,...globalProps}))),c=computed((()=>{let e="";return l.value.src&&l.value.src.length>0&&(e=l.value.fixCr?l.value.src.replace(/\\n/gi,"\n"):l.value.src),void 0!==t.default&&t.default()[0].children.trim().length>0&&(e=t.default()[0].children),e})),u=computed((()=>l.value.copyIcon?l.value.copyIcon:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z")),h=computed((()=>l.value.doneIcon?l.value.doneIcon:"M0 0h24v24H0z@@fill:none;&&M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"));function d(e){return void 0===e||!1===e}function p(){if(!0===l.value.showCopy)return h$2(QBtn,{class:"q-markdown__copy",color:i.dark.isActive?"amber":"primary",dense:!0,flat:!0,round:!0,icon:u.value,onClick:e=>{copyToClipboard(s.value.innerText),i.notify&&i.notify({message:l.value.copyResponseText,color:i.dark.isActive?"grey-10":"white",textColor:i.dark.isActive?"amber":"primary",icon:h.value,position:"top",timeout:2e3})}},(()=>[!0!==l.value.noCopyTooltip&&h$2(QTooltip,(()=>l.value.copyTooltipText))]))}return watch$2((()=>l.value.src),(e=>{a.value=l.value.fixCr?l.value.src.replace(/\\n/gi,"\n"):l.value.src,o.value=null})),watch$2((()=>[l.value.noBlockquote,l.value.noBreaks,l.value.noContainer,l.value.noHighlight,l.value.noHtml,l.value.noImage,l.value.noLineNumbers,l.value.noLink,l.value.noLinkify,l.value.noHeadingAnchorLinks,l.value.noTypographer,l.value.lineNumberAlt,l.value.toc,l.value.tocStart,l.value.tocEnd,l.value.contentStyle,l.value.contentClass,l.value.noNoopener,l.value.noNoreferrer,l.value.plugins]),(()=>{o.value=null})),n({makeTree:function(e){const t=[];let r=null;const n=e=>{if(e.level===l.value.tocStart)r=e,t.push(e);else if(e.level===l.value.tocStart+1)r.children.push(e);else{let t=r;for(let r=0;r<e.level-(l.value.tocStart+1);++r)t=t.children[t.children.length-1];t&&t.children.push(e)}};for(let i=0;i<e.length;++i)n(e[i]);return t}}),()=>function(){if(null===o.value){const e=[],t=c.value||"",n=(e,t)=>d(l.value.noHighlight)?prismHighlight(Prism,e,t):e,i={html:d(l.value.noHtml),linkify:d(l.value.noLinkify),typographer:d(l.value.noTypographer),breaks:d(l.value.noBreaks),highlight:n},a=markdownIt(i);d(l.value.noImage)&&a.use(imsize),extendBlockQuote(a),extendHeading(a,e,l.value.toc,l.value.tocStart,l.value.tocEnd,l.value.noHeadingAnchorLinks),extendImage(a),extendLink(a,{noopener:!l.value.noNoopener,noreferrer:!l.value.noNoreferrer}),extendTable(a),extendToken(a),d(l.value.noContainer)&&extendContainers(a),d(l.value.noLineNumbers)&&extendFenceLineNumbers(a,l.value.lineNumberAlt);const s=[];d(l.value.noImage)||s.push("image"),d(l.value.noLink)||s.push("link"),d(l.value.noBlockquote)||s.push("blockquote"),s.length>0&&a.disable(s),l.value.plugins.length>0&&l.value.plugins.forEach((e=>{e instanceof Function?a.use(e):e.plugin instanceof Function&&e.options&&a.use(e.plugin,e.options)})),o.value=a.render(t),l.value.toc&&e.length>0&&r("data",e)}const e=h$2("div",{ref:s,class:["q-markdown",l.value.contentClass],style:l.value.contentStyle,innerHTML:o.value}),t=h$2("div",{style:{position:"relative"}},[e,p()]);return!0!==l.value.showCopy?e:t}()}}),getTemplate=e=>{let t="";if(e&&e.length>0){const r="<template",n="</template>",i=e.indexOf(r),o=e.lastIndexOf(n);i>-1&&o>-1&&(t=e.substring(i,o+n.length))}return t};function getTagParts(e){if(!0!==!("undefined"==typeof window||!window.document||!window.document.createElement))return{};const t={};let r;const n=getTemplate(e);n&&n.length>0&&(t.template=n);const i=document.createElement("html");return i.innerHTML=e,r=i.getElementsByTagName("script"),r.length>0&&(t.script=r[0].outerHTML),r=i.getElementsByTagName("style"),r.length>0&&(t.style=r[0].outerHTML),t}const version$2="2.0.5",VuePlugin$1={version:version$2,QMarkdown:QMarkdown,useQMarkdownGlobalProps:useQMarkdownGlobalProps,getTagParts:getTagParts,install(e){e.component(QMarkdown.name,QMarkdown)}},viteRegister=defineBoot((({app:e})=>{e.use(VuePlugin$1)})),viteRegister$1=Object.freeze(Object.defineProperty({__proto__:null,default:viteRegister},Symbol.toStringTag,{value:"Module"}));function boot(e){return e}
/*!
 * @quasar/quasar-ui-qflashcard v2.0.0-alpha.4
 * (c) 2022 Jeff Galbraith <jeff@quasar.dev>
 * Released under the MIT License.
 */var QFlashcard=defineComponent({name:"QFlashcard",props:{noHover:Boolean},setup:(e,{slots:t})=>()=>h$2("div",{class:"q-flashcard"+(!0===e.noHover?" no-hover":"")},t.default&&t.default()||[])}),QFlashcardSection=defineComponent({name:"QFlashcardSection",props:{active:Boolean,transition:[String,Array]},setup(e,{slots:t}){const r=(e,t)=>{const r=!0===t?"--active":"";return(e.startsWith("fc-")?e+r:"fc-"+e)+r},n=computed((()=>{if(void 0===e.transition)return"";let t=e.transition;const n=e.active;if("string"==typeof t){if(!t.includes(" "))return r(t,n);t=e.transition.split(" ")}return Array.isArray(t)?t.map((e=>r(e,n))).join(" "):""}));return()=>h$2("div",{class:["q-flashcard__section",n.value]},t.default&&t.default()||[])}});const version$1="2.0.0-alpha.4";function install$1(e){e.component(QFlashcard.name,QFlashcard),e.component(QFlashcardSection.name,QFlashcardSection)}var Plugin=Object.freeze({__proto__:null,version:version$1,QFlashcard:QFlashcard,QFlashcardSection:QFlashcardSection,install:install$1});const register$2=boot((({app:e})=>{e.use(Plugin)})),register$3=Object.freeze(Object.defineProperty({__proto__:null,default:register$2},Symbol.toStringTag,{value:"Module"}));
/*!
 * @quasar/quasar-ui-qoverlay v2.0.1
 * (c) 2022 Jeff Galbraith <jeff@quasar.dev>
 * Released under the MIT License.
 */
var listenOpts={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{var opts=Object.defineProperty({},"passive",{get:function(){Object.assign(listenOpts,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,opts),window.removeEventListener("qtest",null,opts)}catch(e2){}function getEventPath(e){if(e.path)return e.path;if(e.composedPath)return e.composedPath();for(var t=[],r=e.target;r;){if(t.push(r),"HTML"===r.tagName)return t.push(document),t.push(window),t;r=r.parentElement}}function stopAndPrevent(e){!1!==e.cancelable&&e.preventDefault(),e.stopPropagation()}function getVerticalScrollPosition(e){return e===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:e.scrollTop}function getHorizontalScrollPosition(e){return e===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:e.scrollLeft}function hasScrollbar(e,t){return void 0===t&&(t=!0),!(!e||e.nodeType!==Node.ELEMENT_NODE)&&(t?e.scrollHeight>e.clientHeight&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-y"])):e.scrollWidth>e.clientWidth&&(e.classList.contains("scroll")||e.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(e)["overflow-x"])))}var registered=0,scrollPositionX,scrollPositionY,maxScrollTop,vpPendingUpdate=!1,bodyLeft,bodyTop,closeTimer;function onWheel(e){shouldPreventScroll(e)&&stopAndPrevent(e)}function shouldPreventScroll(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;for(var t=getEventPath(e),r=e.shiftKey&&!e.deltaX,n=!r&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),i=r||n?e.deltaY:e.deltaX,o=0;o<t.length;o++){var a=t[o];if(hasScrollbar(a,n))return n?i<0&&0===a.scrollTop||i>0&&a.scrollTop+a.clientHeight===a.scrollHeight:i<0&&0===a.scrollLeft||i>0&&a.scrollLeft+a.clientWidth===a.scrollWidth}return!0}function onAppleScroll(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function onAppleResize(e){!0!==vpPendingUpdate&&(vpPendingUpdate=!0,requestAnimationFrame((function(){vpPendingUpdate=!1;var t=e.target.height,r=document.scrollingElement,n=r.clientHeight,i=r.scrollTop;void 0!==maxScrollTop&&t===window.innerHeight||(maxScrollTop=n-t,document.scrollingElement.scrollTop=i),i>maxScrollTop&&(document.scrollingElement.scrollTop-=Math.ceil((i-maxScrollTop)/8))})))}function apply(e,t){var r=document.body,n=void 0!==window.visualViewport;if("add"===e){var i=window.getComputedStyle(r),o=i.overflowY,a=i.overflowX;scrollPositionX=getHorizontalScrollPosition(window),scrollPositionY=getVerticalScrollPosition(window),bodyLeft=r.style.left,bodyTop=r.style.top,r.style.left="-"+scrollPositionX+"px",r.style.top="-"+scrollPositionY+"px","hidden"!==a&&("scroll"===a||r.scrollWidth>window.innerWidth)&&r.classList.add("q-body--force-scrollbar-x"),"hidden"!==o&&("scroll"===o||r.scrollHeight>window.innerHeight)&&r.classList.add("q-body--force-scrollbar-y"),r.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,!0===t.platform.is.ios&&(!0===n?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",onAppleResize,listenOpts.passiveCapture),window.visualViewport.addEventListener("scroll",onAppleResize,listenOpts.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",onAppleScroll,listenOpts.passiveCapture))}!0===t.platform.is.desktop&&!0===t.platform.is.mac&&window[e+"EventListener"]("wheel",onWheel,listenOpts.notPassive),"remove"===e&&(!0===t.platform.is.ios&&(!0===n?(window.visualViewport.removeEventListener("resize",onAppleResize,listenOpts.passiveCapture),window.visualViewport.removeEventListener("scroll",onAppleResize,listenOpts.passiveCapture)):window.removeEventListener("scroll",onAppleScroll,listenOpts.passiveCapture)),r.classList.remove("q-body--prevent-scroll"),r.classList.remove("q-body--force-scrollbar-x"),r.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,r.style.left=bodyLeft,r.style.top=bodyTop,window.scrollTo(scrollPositionX,scrollPositionY),maxScrollTop=void 0)}function preventScroll(e){var t=getCurrentInstance(),r=useQuasar()||t.proxy.$q||t.ctx.$q,n="add";if(!0===e){if(registered++,void 0!==closeTimer)return clearTimeout(closeTimer),void(closeTimer=void 0);if(registered>1)return}else{if(0===registered)return;if(--registered>0)return;if(n="remove",!0===r.platform.is.ios&&!0===r.platform.is.nativeMobile)return clearTimeout(closeTimer),void(closeTimer=setTimeout((function(){apply(n,r),closeTimer=void 0}),100))}apply(n,r)}var textToRgb=colors.textToRgb,QOverlay=defineComponent({name:"QOverlay",props:{backgroundColor:{type:String,default:"#000000"},opacity:{type:[Number,String],default:.35},zIndex:{type:[Number,String],default:6e3},cursorType:{type:String,default:"not-allowed"},noScroll:Boolean,modelValue:Boolean},setup:function(e,t){var r=t.slots;onBeforeUnmount((function(){e.noScroll&&e.modelValue&&preventScroll(!1)}));var n=computed((function(){var t=textToRgb(e.backgroundColor);return{zIndex:e.zIndex,backgroundColor:"rgba("+t.r+", "+t.g+", "+t.b+", "+e.opacity+")",padding:0,margin:0}}));function i(){var t=r.default,i=void 0===(t&&t());if(preventScroll(e.noScroll&&e.modelValue),e.modelValue||!i)return e.modelValue&&i?h$2("div",{class:"q-overlay fixed fullscreen cursor-"+e.cursorType,style:n.value},[r.body&&r.body()]):e.modelValue&&!i?function(t){var i=h$2("div",{class:"q-overlay q-overlay--component cursor-"+e.cursorType,style:n.value},r.body());return h$2("div",{class:"q-overlay--wrapper"},[i,t&&t()])}(t):h$2("div",{class:"q-overlay"},t&&t()||[])}return function(){return i()}}}),version="2.0.1";function install(e){e.component(QOverlay.name,QOverlay)}var VuePlugin=Object.freeze({__proto__:null,version:version,QOverlay:QOverlay,install:install});const register=boot((({app:e})=>{e.use(VuePlugin)})),register$1=Object.freeze(Object.defineProperty({__proto__:null,default:register},Symbol.toStringTag,{value:"Module"}));class DeviceWeb extends WebPlugin{async getId(){return{identifier:this.getUid()}}async getInfo(){if("undefined"==typeof navigator||!navigator.userAgent)throw this.unavailable("Device API not available in this browser");const e=navigator.userAgent,t=this.parseUa(e);return{model:t.model,platform:"web",operatingSystem:t.operatingSystem,osVersion:t.osVersion,manufacturer:navigator.vendor,isVirtual:!1,webViewVersion:t.browserVersion}}async getBatteryInfo(){if("undefined"==typeof navigator||!navigator.getBattery)throw this.unavailable("Device API not available in this browser");let e={};try{e=await navigator.getBattery()}catch(e2){}return{batteryLevel:e.level,isCharging:e.charging}}async getLanguageCode(){return{value:navigator.language.split("-")[0].toLowerCase()}}async getLanguageTag(){return{value:navigator.language}}parseUa(e){const t={},r=e.indexOf("(")+1;let n=e.indexOf(") AppleWebKit");-1!==e.indexOf(") Gecko")&&(n=e.indexOf(") Gecko"));const i=e.substring(r,n);if(-1!==e.indexOf("Android")){const e=i.replace("; wv","").split("; ").pop();e&&(t.model=e.split(" Build")[0]),t.osVersion=i.split("; ")[1]}else if(t.model=i.split("; ")[0],"undefined"!=typeof navigator&&navigator.oscpu)t.osVersion=navigator.oscpu;else if(-1!==e.indexOf("Windows"))t.osVersion=i;else{const e=i.split("; ").pop();if(e){const r=e.replace(" like Mac OS X","").split(" ");t.osVersion=r[r.length-1].replace(/_/g,".")}}/android/i.test(e)?t.operatingSystem="android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?t.operatingSystem="ios":/Win/.test(e)?t.operatingSystem="windows":/Mac/i.test(e)?t.operatingSystem="mac":t.operatingSystem="unknown";const o=!!window.ApplePaySession,a=!!window.chrome,s=/Firefox/.test(e),l=/Edg/.test(e),c=/FxiOS/.test(e),u=/CriOS/.test(e),h=/EdgiOS/.test(e);if(o||a&&!l||c||u||h){let r;r=c?"FxiOS":u?"CriOS":h?"EdgiOS":o?"Version":"Chrome";const n=e.split(" ");for(const e of n)if(e.includes(r)){const r=e.split("/")[1];t.browserVersion=r}}else if(s||l){const r=e.split("").reverse().join("").split("/")[0].split("").reverse().join("");t.browserVersion=r}return t}getUid(){if("undefined"!=typeof window&&window.localStorage){let e=window.localStorage.getItem("_capuid");return e||(e=this.uuid4(),window.localStorage.setItem("_capuid",e),e)}return this.uuid4()}uuid4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}}const web=Object.freeze(Object.defineProperty({__proto__:null,DeviceWeb:DeviceWeb},Symbol.toStringTag,{value:"Module"})),defaultCfg={threshold:0,root:null,rootMargin:"0px"};function update(e,t,r){let n,i,o;"function"==typeof r?(n=r,i=defaultCfg,o=void 0===t.cfg):(n=r.handler,i=Object.assign({},defaultCfg,r.cfg),o=void 0===t.cfg||!1===isDeepEqual(t.cfg,i)),t.handler!==n&&(t.handler=n),!0===o&&(t.cfg=i,t.observer?.unobserve(e),t.observer=new IntersectionObserver((([r])=>{if("function"==typeof t.handler){if(null===r.rootBounds&&!0===document.body.contains(e))return t.observer.unobserve(e),void t.observer.observe(e);(!1===t.handler(r,t.observer)||!0===t.once&&!0===r.isIntersecting)&&destroy(e)}}),i),t.observer.observe(e))}function destroy(e){const t=e.__qvisible;void 0!==t&&(t.observer?.unobserve(e),delete e.__qvisible)}const Intersection=createDirective({name:"intersection",mounted(e,{modifiers:t,value:r}){const n={once:!0===t.once};update(e,n,r),e.__qvisible=n},updated(e,t){const r=e.__qvisible;void 0!==r&&update(e,r,t.value)},beforeUnmount:destroy}),QIntersection=createComponent({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(e,{slots:t,emit:r}){const n=ref$1(!0===isRuntimeSsrPreHydration.value&&e.ssrPrerender),i=computed((()=>void 0!==e.root||void 0!==e.margin||void 0!==e.threshold?{handler:l,cfg:{root:e.root,rootMargin:e.margin,threshold:e.threshold}}:l)),o=computed((()=>!0!==e.disable&&(!0!==isRuntimeSsrPreHydration.value||!0!==e.once||!0!==e.ssrPrerender))),a=computed((()=>[[Intersection,i.value,void 0,{once:e.once}]])),s=computed((()=>`--q-transition-duration: ${e.transitionDuration}ms`));function l(t){n.value!==t.isIntersecting&&(n.value=t.isIntersecting,void 0!==e.onVisibility&&r("visibility",n.value))}function c(){return!0===n.value?[h$2("div",{key:"content",style:s.value},hSlot(t.default))]:void 0!==t.hidden?[h$2("div",{key:"hidden",style:s.value},t.hidden())]:void 0}return()=>{const t=e.transition?[h$2(Transition,{name:"q-transition--"+e.transition},c)]:c();return hDir(e.tag,{class:"q-intersection"},t,"main",o.value,(()=>a.value))}}});export{Group as $,invert as A,Buffer as B,applyTransform as C,extendFromString as D,subPixelOptimizeLine as E,subPixelOptimizeRect as F,identity as G,mul as H,BoundingRect as I,copy$2 as J,create$1 as K,clone$4 as L,Circle as M,Ellipse as N,Polygon$1 as O,Path as P,Polyline as Q,Ring as R,Sector as S,Transformable as T,Rect as U,Line as V,BezierCurve as W,Arc as X,CompoundPath as Y,ZRImage as Z,__extends as _,isFunction as a,containStroke$2 as a$,IncrementalDisplayable as a0,LinearGradient as a1,OrientedBoundingRect as a2,Point$2 as a3,RadialGradient as a4,ZRText as a5,trim as a6,normalizeCssArray as a7,retrieve3 as a8,merge$1 as a9,brushSingle as aA,Eventful as aB,init$1 as aC,sort as aD,registerPainter as aE,eqNaN as aF,getBoundingRect as aG,rotate as aH,retrieve as aI,copyTransform as aJ,find as aK,isMiddleOrRightButtonOnMouseUpDown as aL,stop as aM,contain as aN,min$2 as aO,max$3 as aP,parseXML as aQ,parseSVG as aR,makeViewBoxTransform as aS,Displayable as aT,copy$1 as aU,mergeAll as aV,normalize$4 as aW,sub$1 as aX,quadraticAt as aY,quadraticDerivativeAt as aZ,containStroke$4 as a_,mixin as aa,isTypedArray as ab,bind as ac,slice as ad,curry as ae,encodeHTML as af,setAsPrimitive as ag,modifyHSL as ah,concatArray as ai,calculateTextPosition as aj,PathProxy as ak,cubicRootAt as al,cubicAt as am,lerp as an,parsePercent as ao,normalizeArcAngles as ap,dist$2 as aq,lerp$1 as ar,quadraticProjectPoint as as,cubicProjectPoint as at,normalizeRadian as au,filter as av,noop as aw,WeakMap$1 as ax,LRU as ay,platformApi as az,each as b,QExpansionItem as b$,translate as b0,isDom as b1,addEventListener$1 as b2,normalizeEvent as b3,transformLocalCoord as b4,transformLocalCoordClear as b5,parse$3 as b6,stringify as b7,isRegExp as b8,isCombineMorphing as b9,QItemLabel as bA,QUploader as bB,throttle as bC,QSplitter as bD,QPopupProxy as bE,QBanner as bF,ClosePopup as bG,writeFileSync as bH,readFileSync as bI,existsSync as bJ,QLayout as bK,QToolbar as bL,QPageContainer as bM,QDialog as bN,QCardSection as bO,QSeparator as bP,QCardActions as bQ,QCard as bR,gunzipSync as bS,Device as bT,maplibreGlExports as bU,QRadio as bV,QImg as bW,QForm as bX,t$1 as bY,defineRouter as bZ,defineStore as b_,morphPath as ba,combineMorph as bb,separateMorph as bc,clonePath as bd,CanvasPainter as be,RBush$1 as bf,Plugin$1 as bg,QPage as bh,QScrollArea as bi,QBtn as bj,QPageSticky as bk,Plugin$6 as bl,useQuasar as bm,QList as bn,QItem as bo,QItemSection as bp,QSelect as bq,QPagination as br,QSpace as bs,QIcon as bt,QInput as bu,date as bv,QTable as bw,QTd as bx,QBtnDropdown as by,QCheckbox as bz,assert$1 as c,Ripple as c0,QDrawer as c1,QCarouselSlide as c2,QCarousel as c3,QIntersection as c4,QTabs as c5,QTab as c6,QTabPanels as c7,QTabPanel as c8,QAvatar as c9,libExports$2 as cA,Quasar as cB,Notify as cC,Plugin$2 as cD,Plugin$3 as cE,Dialog as cF,lang$1 as cG,register$4 as cH,defineBoot as cI,kt as cJ,Lt$1 as cK,Vt as cL,Screen as cM,Mt as cN,Et as cO,QToolbarTitle as cP,QHeader as cQ,QFooter as cR,qpdfviewer$1 as cS,viteRegister$1 as cT,register$3 as cU,register$1 as cV,QMenu as ca,QTooltip as cb,QColor as cc,QSkeleton as cd,QBadge as ce,QSlider as cf,QBtnGroup as cg,liteWindow as ch,LiteWindowContainer as ci,iconv as cj,QTimeline as ck,QTimelineEntry as cl,QSpinner as cm,md5$1 as cn,xxtea_encrypt_string$1 as co,xxtea_decrypt_string$1 as cp,QBtnToggle as cq,MapboxDraw as cr,mapshaperExports as cs,QRouteTab as ct,QBreadcrumbs as cu,QBreadcrumbsEl as cv,openURL as cw,libExports$3 as cx,libExports$4 as cy,require$$1 as cz,indexOf as d,extend$1 as e,isString as f,global as g,createHashMap as h,inherits as i,isObject$1 as j,isNumber$1 as k,isStringSafe as l,map$1 as m,isArray as n,env as o,process$1 as p,isArrayLike as q,reduce as r,keys as s,liftColor as t,retrieve2 as u,createFromString as v,defaults as w,hasOwn as x,mergePath as y,subPixelOptimize as z};
