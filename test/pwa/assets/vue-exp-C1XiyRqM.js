const e={silent:!1,logLevel:"warn"};function t(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}const r=Object.prototype,n=r.toString,o=r.hasOwnProperty,i=/^\s*function (\w+)/;function s(e){const t=e?.type??e;if(t){const e=t.toString().match(i);return e?e[1]:""}return""}function a(e){return"structuredClone"in globalThis?structuredClone(e):Array.isArray(e)?[...e]:t(e)?Object.assign({},e):e}let l=function(){};const u=(e,t)=>o.call(e,t),c=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},f=Array.isArray||function(e){return"[object Array]"===n.call(e)},d=e=>"[object Function]"===n.call(e),y=(e,r)=>t(e)&&u(e,"_vueTypes_name")&&(!r||e._vueTypes_name===r),p=e=>t(e)&&(u(e,"type")||["_vueTypes_name","validator","default","required"].some((t=>u(e,t))));function b(e,t){return Object.defineProperty(e.bind(t),"__original",{value:e})}function g(e,r,n=!1){let o,a=!0,c="";o=t(e)?e:{type:e};const b=y(o)?o._vueTypes_name+" - ":"";if(p(o)&&null!==o.type){if(void 0===o.type||!0===o.type)return a;if(!o.required&&null==r)return a;f(o.type)?(a=o.type.some((e=>!0===g(e,r,!0))),c=o.type.map((e=>s(e))).join(" or ")):(c=s(o),a="Array"===c?f(r):"Object"===c?t(r):"String"===c||"Number"===c||"Boolean"===c||"Function"===c?function(e){if(null==e)return"";const t=e.constructor.toString().match(i);return t?t[1].replace(/^Async/,""):""}(r)===c:r instanceof o.type)}if(!a){const e=`${b}value "${r}" should be of type "${c}"`;return!1===n?(l(e),!1):e}if(u(o,"validator")&&d(o.validator)){const e=l,t=[];if(l=e=>{t.push(e)},a=o.validator(r),l=e,!a){const e=(t.length>1?"* ":"")+t.join("\n* ");return t.length=0,!1===n?(l(e),a):e}}return a}function h(e,r){const n=Object.defineProperties(r,{_vueTypes_name:{value:e,writable:!0},isRequired:{get(){return this.required=!0,this}},def:{value(e){return void 0===e?this.type===Boolean||Array.isArray(this.type)&&this.type.includes(Boolean)?void(this.default=void 0):(u(this,"default")&&delete this.default,this):d(e)||!0===g(this,e,!0)?(f(e)||t(e)?this.default=()=>a(e):this.default=e,this):(l(`${this._vueTypes_name} - invalid default value: "${e}"`),this)}}}),{validator:o}=n;return d(o)&&(n.validator=b(o,n)),n}function v(e,t){const r=h(e,t);return Object.defineProperty(r,"validate",{value(e){return d(this.validator)&&l(`${this._vueTypes_name} - calling .validate() will overwrite the current custom validator function. Validator info:\n${JSON.stringify(this)}`),this.validator=b(e,this),this}})}function m(e){return e.replace(/^(?!\s*$)/gm,"  ")}const O=()=>v("any",{}),_=()=>v("boolean",{type:Boolean}),A=()=>v("string",{type:String}),j=()=>v("number",{type:Number}),w=()=>v("array",{type:Array}),I=()=>v("object",{type:Object});function T(e,t="custom validation failed"){if("function"!=typeof e)throw new TypeError("[VueTypes error]: You must provide a function as argument");return h(e.name||"<<anonymous function>>",{type:null,validator(r){const n=e(r);return n||l(`${this._vueTypes_name} - ${t}`),n}})}function $(e){if(!f(e))throw new TypeError("[VueTypes error]: You must provide an array as argument.");const t=`oneOf - value should be one of "${e.map((e=>"symbol"==typeof e?e.toString():e)).join('", "')}".`,r={validator(r){const n=-1!==e.indexOf(r);return n||l(t),n}};if(-1===e.indexOf(null)){const t=e.reduce(((e,t)=>{if(null!=t){const r=t.constructor;-1===e.indexOf(r)&&e.push(r)}return e}),[]);t.length>0&&(r.type=t)}return h("oneOf",r)}function E(e){if(!f(e))throw new TypeError("[VueTypes error]: You must provide an array as argument");let t=!1,r=!1,n=[];for(let i=0;i<e.length;i+=1){const o=e[i];if(p(o)){if(d(o.validator)&&(t=!0),y(o,"oneOf")&&o.type){n=n.concat(o.type);continue}if(y(o,"nullable")){r=!0;continue}if(!0===o.type||!o.type){l('oneOfType - invalid usage of "true" and "null" as types.');continue}n=n.concat(o.type)}else n.push(o)}n=n.filter(((e,t)=>n.indexOf(e)===t));const o=!1===r&&n.length>0?n:null;return h("oneOfType",t?{type:o,validator(t){const r=[],n=e.some((e=>{const n=g(e,t,!0);return"string"==typeof n&&r.push(n),!0===n}));return n||l(`oneOfType - provided value does not match any of the ${r.length} passed-in validators:\n${m(r.join("\n"))}`),n}}:{type:o})}function S(e){return h("arrayOf",{type:Array,validator(t){let r="";const n=t.every((t=>(r=g(e,t,!0),!0===r)));return n||l(`arrayOf - value validation error:\n${m(r)}`),n}})}function k(e){return h("instanceOf",{type:e})}function L(e){return h("objectOf",{type:Object,validator(r){let n="";if(!t(r))return!1;const o=Object.keys(r).every((t=>(n=g(e,r[t],!0),!0===n)));return o||l(`objectOf - value validation error:\n${m(n)}`),o}})}function R(e){const r=Object.keys(e),n=r.filter((t=>!!e[t]?.required)),o=h("shape",{type:Object,validator(o){if(!t(o))return!1;const i=Object.keys(o);if(n.length>0&&n.some((e=>-1===i.indexOf(e)))){const e=n.filter((e=>-1===i.indexOf(e)));return 1===e.length?l(`shape - required property "${e[0]}" is not defined.`):l(`shape - required properties "${e.join('", "')}" are not defined.`),!1}return i.every((t=>{if(-1===r.indexOf(t))return!0===this._vueTypes_isLoose||(l(`shape - shape definition does not include a "${t}" property. Allowed keys: "${r.join('", "')}".`),!1);const n=g(e[t],o[t],!0);return"string"==typeof n&&l(`shape - "${t}" property validation error:\n ${m(n)}`),!0===n}))}});return Object.defineProperty(o,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(o,"loose",{get(){return this._vueTypes_isLoose=!0,this}}),o}var D=Object.defineProperty,x=(e,t,r)=>(((e,t,r)=>{t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);const P=(()=>{var t;return x(t=class{static get any(){return O()}static get func(){return v("function",{type:Function}).def(this.defaults.func)}static get bool(){return void 0===this.defaults.bool?_():_().def(this.defaults.bool)}static get string(){return A().def(this.defaults.string)}static get number(){return j().def(this.defaults.number)}static get array(){return w().def(this.defaults.array)}static get object(){return I().def(this.defaults.object)}static get integer(){return h("integer",{type:Number,validator(e){const t=c(e);return!1===t&&l(`integer - "${e}" is not an integer`),t}}).def(this.defaults.integer)}static get symbol(){return h("symbol",{validator(e){const t="symbol"==typeof e;return!1===t&&l(`symbol - invalid value "${e}"`),t}})}static get nullable(){return Object.defineProperty({type:null,validator(e){const t=null===e;return!1===t&&l("nullable - value should be null"),t}},"_vueTypes_name",{value:"nullable"})}static extend(...e){l("VueTypes.extend has been removed. Use the ES6+ method instead. See https://dwightjack.github.io/vue-types/advanced/extending-vue-types.html#extending-namespaced-validators-in-es6 for details.")}},"defaults",{}),x(t,"sensibleDefaults"),x(t,"config",e),x(t,"custom",T),x(t,"oneOf",$),x(t,"instanceOf",k),x(t,"oneOfType",E),x(t,"arrayOf",S),x(t,"objectOf",L),x(t,"shape",R),x(t,"utils",{validate:(e,t)=>!0===g(t,e,!0),toType:(e,t,r=!1)=>r?v(e,t):h(e,t)}),t})();!function(e={func:()=>{},bool:!0,string:"",number:0,array:()=>[],object:()=>({}),integer:0}){var t;x(t=class extends P{static get sensibleDefaults(){return{...this.defaults}}static set sensibleDefaults(t){this.defaults=!1!==t?!0!==t?{...t}:{...e}:{}}},"defaults",{...e})}();var N=(e=>(e.LOADING="loading",e.LOADED="loaded",e.ERROR="error",e))(N||{});const B="undefined"!=typeof window&&null!==window,C=function(){if(B&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)return"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0;return!1}(),q=Object.prototype.propertyIsEnumerable,z=Object.getOwnPropertySymbols;function F(e){return"function"==typeof e||"[object Object]"===toString.call(e)}function G(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}function V(e,...t){if(!F(e))throw new TypeError("expected the first argument to be an object");if(0===t.length||"function"!=typeof Symbol||"function"!=typeof z)return e;for(const r of t){const t=z(r);for(const n of t)q.call(r,n)&&(e[n]=r[n])}return e}function M(e,...t){let r=0;var n;for(("object"==typeof(n=e)?null===n:"function"!=typeof n)&&(e=t[r++]),e||(e={});r<t.length;r++)if(F(t[r])){for(const n of Object.keys(t[r]))G(n)&&(F(e[n])&&F(t[r][n])?M(e[n],t[r][n]):e[n]=t[r][n]);V(e,t[r])}return e}const Y="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",H={rootMargin:"0px",threshold:0},J="data-lazy-timeout-id";class Q{constructor(e){this.options={loading:Y,error:"",observerOptions:H,log:!0,lifecycle:{},logLevel:"error"},this._images=new WeakMap,this.config(e)}config(e={}){M(this.options,e)}mount(e,t){if(!e)return;const{src:r,loading:n,error:o,lifecycle:i,delay:s}=this._valueFormatter("string"==typeof t?t:t.value);this._lifecycle(N.LOADING,i,e),e.setAttribute("src",n||Y),C||(this.loadImages(e,r,o,i),this._log((()=>{this._logger("Not support IntersectionObserver!")}))),this._initIntersectionObserver(e,r,o,i,s)}update(e,t){if(!e)return;this._realObserver(e)?.unobserve(e);const{src:r,error:n,lifecycle:o,delay:i}=this._valueFormatter("string"==typeof t?t:t.value);this._initIntersectionObserver(e,r,n,o,i)}unmount(e){e&&(this._realObserver(e)?.unobserve(e),this._images.delete(e))}loadImages(e,t,r,n){this._setImageSrc(e,t,r,n)}_setImageSrc(e,t,r,n){if("img"===e.tagName.toLowerCase()){if(t){e.getAttribute("src")!==t&&e.setAttribute("src",t)}this._listenImageStatus(e,(()=>{this._lifecycle(N.LOADED,n,e)}),(()=>{if(e.onload=null,this._lifecycle(N.ERROR,n,e),this._realObserver(e)?.disconnect(),r){e.getAttribute("src")!==r&&e.setAttribute("src",r)}this._log((()=>{this._logger(`Image failed to load!And failed src was: ${t} `)}))}))}else e.style.backgroundImage=`url('${t}')`}_initIntersectionObserver(e,t,r,n,o){const i=this.options.observerOptions;this._images.set(e,new IntersectionObserver((i=>{Array.prototype.forEach.call(i,(i=>{o&&o>0?this._delayedIntersectionCallback(e,i,o,t,r,n):this._intersectionCallback(e,i,t,r,n)}))}),i)),this._realObserver(e)?.observe(e)}_intersectionCallback(e,t,r,n,o){t.isIntersecting&&(this._realObserver(e)?.unobserve(t.target),this._setImageSrc(e,r,n,o))}_delayedIntersectionCallback(e,t,r,n,o,i){if(t.isIntersecting){if(t.target.hasAttribute(J))return;const s=setTimeout((()=>{this._intersectionCallback(e,t,n,o,i),t.target.removeAttribute(J)}),r);t.target.setAttribute(J,String(s))}else t.target.hasAttribute(J)&&(clearTimeout(Number(t.target.getAttribute(J))),t.target.removeAttribute(J))}_listenImageStatus(e,t,r){e.onload=t,e.onerror=r}_valueFormatter(e){let t=e,r=this.options.loading,n=this.options.error,o=this.options.lifecycle,i=this.options.delay;return F(e)&&(t=e.src,r=e.loading||this.options.loading,n=e.error||this.options.error,o=e.lifecycle||this.options.lifecycle,i=e.delay||this.options.delay),{src:t,loading:r,error:n,lifecycle:o,delay:i}}_log(e){this.options.log&&e()}_lifecycle(e,t,r){switch(e){case N.LOADING:r?.setAttribute("lazy",N.LOADING),t?.loading&&t.loading(r);break;case N.LOADED:r?.setAttribute("lazy",N.LOADED),t?.loaded&&t.loaded(r);break;case N.ERROR:r?.setAttribute("lazy",N.ERROR),t?.error&&t.error(r)}}_realObserver(e){return this._images.get(e)}_logger(e,...t){let r=console.error;switch(this.options.logLevel){case"error":r=console.error;break;case"warn":r=console.warn;break;case"info":r=console.info;break;case"debug":r=console.debug}r(e,t)}}const U={install(e,t){const r=new Q(t);e.config.globalProperties.$Lazyload=r,e.provide("Lazyload",r),e.directive("lazy",{mounted:r.mount.bind(r),updated:r.update.bind(r),unmounted:r.unmount.bind(r)})}};export{O as a,w as b,E as c,_ as d,U as i,j as n,I as o,A as s};
