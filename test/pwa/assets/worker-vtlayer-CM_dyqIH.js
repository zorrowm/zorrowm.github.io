/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
const e=Symbol("Comlink.proxy"),t=Symbol("Comlink.endpoint"),n=Symbol("Comlink.releaseProxy"),r=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),i=e=>"object"==typeof e&&null!==e||"function"==typeof e,a={canHandle:t=>i(t)&&t[e],serialize(e){const{port1:t,port2:n}=new MessageChannel;return u(e,t),[n,[n]]},deserialize:e=>(e.start(),function(e){const t=new Map;return e.addEventListener("message",function(e){const{data:n}=e;if(!n||!n.id)return;const r=t.get(n.id);if(r)try{r(n)}finally{t.delete(n.id)}}),m(e,t,[],void 0)}(e))},s=new Map([["proxy",a],["throw",{canHandle:e=>i(e)&&o in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function u(t,n=globalThis,i=["*"]){n.addEventListener("message",function a(s){if(!s||!s.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(i,s.origin))return void console.warn(`Invalid origin '${s.origin}' for comlink proxy`);const{id:l,type:f,path:h}=Object.assign({path:[]},s.data),p=(s.data.argumentList||[]).map(g);let m;try{const n=h.slice(0,-1).reduce((e,t)=>e[t],t),r=h.reduce((e,t)=>e[t],t);switch(f){case"GET":m=r;break;case"SET":n[h.slice(-1)[0]]=g(s.data.value),m=!0;break;case"APPLY":m=r.apply(n,p);break;case"CONSTRUCT":m=function(t){return Object.assign(t,{[e]:!0})}(new r(...p));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;u(t,n),m=function(e,t){return y.set(e,t),e}(e,[e])}break;case"RELEASE":m=void 0;break;default:return}}catch(e){m={value:e,[o]:0}}Promise.resolve(m).catch(e=>({value:e,[o]:0})).then(e=>{const[o,i]=_(e);n.postMessage(Object.assign(Object.assign({},o),{id:l}),i),"RELEASE"===f&&(n.removeEventListener("message",a),c(n),r in t&&"function"==typeof t[r]&&t[r]())}).catch(e=>{const[t,r]=_({value:new TypeError("Unserializable return value"),[o]:0});n.postMessage(Object.assign(Object.assign({},t),{id:l}),r)})}),n.start&&n.start()}function c(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function l(e){if(e)throw new Error("Proxy has been released and is not useable")}function f(e){return E(e,new Map,{type:"RELEASE"}).then(()=>{c(e)})}const h=new WeakMap,p="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(h.get(e)||0)-1;h.set(e,t),0===t&&f(e)});function m(e,r,o=[],i=function(){}){let a=!1;const s=new Proxy(i,{get(t,i){if(l(a),i===n)return()=>{!function(e){p&&p.unregister(e)}(s),f(e),r.clear(),a=!0};if("then"===i){if(0===o.length)return{then:()=>s};const t=E(e,r,{type:"GET",path:o.map(e=>e.toString())}).then(g);return t.then.bind(t)}return m(e,r,[...o,i])},set(t,n,i){l(a);const[s,u]=_(i);return E(e,r,{type:"SET",path:[...o,n].map(e=>e.toString()),value:s},u).then(g)},apply(n,i,s){l(a);const u=o[o.length-1];if(u===t)return E(e,r,{type:"ENDPOINT"}).then(g);if("bind"===u)return m(e,r,o.slice(0,-1));const[c,f]=d(s);return E(e,r,{type:"APPLY",path:o.map(e=>e.toString()),argumentList:c},f).then(g)},construct(t,n){l(a);const[i,s]=d(n);return E(e,r,{type:"CONSTRUCT",path:o.map(e=>e.toString()),argumentList:i},s).then(g)}});return function(e,t){const n=(h.get(t)||0)+1;h.set(t,n),p&&p.register(e,t,e)}(s,e),s}function d(e){const t=e.map(_);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const y=new WeakMap;function _(e){for(const[t,n]of s)if(n.canHandle(e)){const[r,o]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},o]}return[{type:"RAW",value:e},y.get(e)||[]]}function g(e){switch(e.type){case"HANDLER":return s.get(e.name).deserialize(e.value);case"RAW":return e.value}}function E(e,t,n,r){return new Promise(o=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(i,o),e.start&&e.start(),e.postMessage(Object.assign({id:i},n),r)})}class b{name;ItemsList;constructor(e){this.name=e,this.ItemsList=new Array}allowCrossLevel=!1;_currentLevel=-1;set CurrentLevel(e){this._currentLevel>=0&&this._currentLevel!==e&&(this._currentLevel=e,this.allowCrossLevel||this.removeAll()),this._currentLevel=e}fields={name:"String"};alpha=0;annoFieldName="name";geoType=1;isVisible=!0;maxLevel=22;minLevel=0;style;billboardCollection=void 0;primitiveCollection=void 0;orderFunc=void 0;styleFunc=void 0;removeAll(e){this.billboardCollection&&(this.billboardCollection.removeAll(),e&&e.scene.primitives.remove(this.billboardCollection)),this.primitiveCollection&&(this.primitiveCollection.removeAll(),e&&e.scene.primitives.remove(this.primitiveCollection))}show(e){this.billboardCollection&&(this.billboardCollection.show=e),this.primitiveCollection&&(this.primitiveCollection.show=e)}}function w(e){return null!=e}function T(e){let t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}w(Object.create)&&(T.prototype=Object.create(Error.prototype),T.prototype.constructor=T),T.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return w(this.stack)&&(e+=`\n${this.stack.toString()}`),e},T.throwInstantiationError=function(){throw new T("This function defines an interface and should not be called directly.")};const O={};function A(e,t,n){return`Expected ${n} to be typeof ${t}, actual typeof was ${e}`}O.typeOf={},O.defined=function(e,t){if(!w(t))throw new T(function(e){return`${e} is required, actual value was undefined`}(e))},O.typeOf.func=function(e,t){if("function"!=typeof t)throw new T(A(typeof t,"function",e))},O.typeOf.string=function(e,t){if("string"!=typeof t)throw new T(A(typeof t,"string",e))},O.typeOf.number=function(e,t){if("number"!=typeof t)throw new T(A(typeof t,"number",e))},O.typeOf.number.lessThan=function(e,t,n){if(O.typeOf.number(e,t),t>=n)throw new T(`Expected ${e} to be less than ${n}, actual value was ${t}`)},O.typeOf.number.lessThanOrEquals=function(e,t,n){if(O.typeOf.number(e,t),t>n)throw new T(`Expected ${e} to be less than or equal to ${n}, actual value was ${t}`)},O.typeOf.number.greaterThan=function(e,t,n){if(O.typeOf.number(e,t),t<=n)throw new T(`Expected ${e} to be greater than ${n}, actual value was ${t}`)},O.typeOf.number.greaterThanOrEquals=function(e,t,n){if(O.typeOf.number(e,t),t<n)throw new T(`Expected ${e} to be greater than or equal to ${n}, actual value was ${t}`)},O.typeOf.object=function(e,t){if("object"!=typeof t)throw new T(A(typeof t,"object",e))},O.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new T(A(typeof t,"boolean",e))},O.typeOf.bigint=function(e,t){if("bigint"!=typeof t)throw new T(A(typeof t,"bigint",e))},O.typeOf.number.equals=function(e,t,n,r){if(O.typeOf.number(e,n),O.typeOf.number(t,r),n!==r)throw new T(`${e} must be equal to ${t}, the actual values are ${n} and ${r}`)};var x,R,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function I(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var C=function(){if(R)return x;R=1;var e=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};return e.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0},e.prototype.init_by_array=function(e,t){var n,r,o;for(this.init_seed(19650218),n=1,r=0,o=this.N>t?this.N:t;o;o--){var i=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&i)>>>16)<<16)+1664525*(65535&i))+e[r]+r,this.mt[n]>>>=0,r++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),r>=t&&(r=0)}for(o=this.N-1;o;o--)i=this.mt[n-1]^this.mt[n-1]>>>30,this.mt[n]=(this.mt[n]^(1566083941*((4294901760&i)>>>16)<<16)+1566083941*(65535&i))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1);this.mt[0]=2147483648},e.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_seed(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random_int31=function(){return this.random_int()>>>1},e.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},e.prototype.random=function(){return this.random_int()*(1/4294967296)},e.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},e.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},x=e}(),N=I(C);const v={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};v.sign=Math.sign??function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1},v.signNotZero=function(e){return e<0?-1:1},v.toSNorm=function(e,t){return t=t??255,Math.round((.5*v.clamp(e,-1,1)+.5)*t)},v.fromSNorm=function(e,t){return t=t??255,v.clamp(e,0,t)/t*2-1},v.normalize=function(e,t,n){return 0===(n=Math.max(n-t,0))?0:v.clamp((e-t)/n,0,1)},v.sinh=Math.sinh??function(e){return(Math.exp(e)-Math.exp(-e))/2},v.cosh=Math.cosh??function(e){return(Math.exp(e)+Math.exp(-e))/2},v.lerp=function(e,t,n){return(1-n)*e+n*t},v.PI=Math.PI,v.ONE_OVER_PI=1/Math.PI,v.PI_OVER_TWO=Math.PI/2,v.PI_OVER_THREE=Math.PI/3,v.PI_OVER_FOUR=Math.PI/4,v.PI_OVER_SIX=Math.PI/6,v.THREE_PI_OVER_TWO=3*Math.PI/2,v.TWO_PI=2*Math.PI,v.ONE_OVER_TWO_PI=1/(2*Math.PI),v.RADIANS_PER_DEGREE=Math.PI/180,v.DEGREES_PER_RADIAN=180/Math.PI,v.RADIANS_PER_ARCSECOND=v.RADIANS_PER_DEGREE/3600,v.toRadians=function(e){if(!w(e))throw new T("degrees is required.");return e*v.RADIANS_PER_DEGREE},v.toDegrees=function(e){if(!w(e))throw new T("radians is required.");return e*v.DEGREES_PER_RADIAN},v.convertLongitudeRange=function(e){if(!w(e))throw new T("angle is required.");const t=v.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},v.clampToLatitudeRange=function(e){if(!w(e))throw new T("angle is required.");return v.clamp(e,-1*v.PI_OVER_TWO,v.PI_OVER_TWO)},v.negativePiToPi=function(e){if(!w(e))throw new T("angle is required.");return e>=-v.PI&&e<=v.PI?e:v.zeroToTwoPi(e+v.PI)-v.PI},v.zeroToTwoPi=function(e){if(!w(e))throw new T("angle is required.");if(e>=0&&e<=v.TWO_PI)return e;const t=v.mod(e,v.TWO_PI);return Math.abs(t)<v.EPSILON14&&Math.abs(e)>v.EPSILON14?v.TWO_PI:t},v.mod=function(e,t){if(!w(e))throw new T("m is required.");if(!w(t))throw new T("n is required.");if(0===t)throw new T("divisor cannot be 0.");return v.sign(e)===v.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},v.equalsEpsilon=function(e,t,n,r){if(!w(e))throw new T("left is required.");if(!w(t))throw new T("right is required.");n=n??0,r=r??n;const o=Math.abs(e-t);return o<=r||o<=n*Math.max(Math.abs(e),Math.abs(t))},v.lessThan=function(e,t,n){if(!w(e))throw new T("first is required.");if(!w(t))throw new T("second is required.");if(!w(n))throw new T("absoluteEpsilon is required.");return e-t<-n},v.lessThanOrEquals=function(e,t,n){if(!w(e))throw new T("first is required.");if(!w(t))throw new T("second is required.");if(!w(n))throw new T("absoluteEpsilon is required.");return e-t<n},v.greaterThan=function(e,t,n){if(!w(e))throw new T("first is required.");if(!w(t))throw new T("second is required.");if(!w(n))throw new T("absoluteEpsilon is required.");return e-t>n},v.greaterThanOrEquals=function(e,t,n){if(!w(e))throw new T("first is required.");if(!w(t))throw new T("second is required.");if(!w(n))throw new T("absoluteEpsilon is required.");return e-t>-n};const P=[1];v.factorial=function(e){if("number"!=typeof e||e<0)throw new T("A number greater than or equal to 0 is required.");const t=P.length;if(e>=t){let n=P[t-1];for(let r=t;r<=e;r++){const e=n*r;P.push(e),n=e}}return P[e]},v.incrementWrap=function(e,t,n){if(n=n??0,!w(e))throw new T("n is required.");if(t<=n)throw new T("maximumValue must be greater than minimumValue.");return++e>t&&(e=n),e},v.isPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new T("A number between 0 and (2^32)-1 is required.");return 0!==e&&!(e&e-1)},v.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>2147483648)throw new T("A number between 0 and 2^31 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},v.previousPowerOfTwo=function(e){if("number"!=typeof e||e<0||e>4294967295)throw new T("A number between 0 and (2^32)-1 is required.");return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,((e|=e>>32)>>>0)-(e>>>1)},v.clamp=function(e,t,n){return O.typeOf.number("value",e),O.typeOf.number("min",t),O.typeOf.number("max",n),e<t?t:e>n?n:e};let M=new N;function L(e,t,n){this.x=e??0,this.y=t??0,this.z=n??0}v.setRandomNumberSeed=function(e){if(!w(e))throw new T("seed is required.");M=new N(e)},v.nextRandomNumber=function(){return M.random()},v.randomBetween=function(e,t){return v.nextRandomNumber()*(t-e)+e},v.acosClamped=function(e){if(!w(e))throw new T("value is required.");return Math.acos(v.clamp(e,-1,1))},v.asinClamped=function(e){if(!w(e))throw new T("value is required.");return Math.asin(v.clamp(e,-1,1))},v.chordLength=function(e,t){if(!w(e))throw new T("angle is required.");if(!w(t))throw new T("radius is required.");return 2*t*Math.sin(.5*e)},v.logBase=function(e,t){if(!w(e))throw new T("number is required.");if(!w(t))throw new T("base is required.");return Math.log(e)/Math.log(t)},v.cbrt=Math.cbrt??function(e){const t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},v.log2=Math.log2??function(e){return Math.log(e)*Math.LOG2E},v.fog=function(e,t){const n=e*t;return 1-Math.exp(-n*n)},v.fastApproximateAtan=function(e){return O.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},v.fastApproximateAtan2=function(e,t){let n;O.typeOf.number("x",e),O.typeOf.number("y",t);let r=Math.abs(e);n=Math.abs(t);const o=Math.max(r,n);n=Math.min(r,n);const i=n/o;if(isNaN(i))throw new T("either x or y must be nonzero");return r=v.fastApproximateAtan(i),r=Math.abs(t)>Math.abs(e)?v.PI_OVER_TWO-r:r,r=e<0?v.PI-r:r,r=t<0?-r:r,r},L.fromSpherical=function(e,t){O.typeOf.object("spherical",e),w(t)||(t=new L);const n=e.clock,r=e.cone,o=e.magnitude??1,i=o*Math.sin(r);return t.x=i*Math.cos(n),t.y=i*Math.sin(n),t.z=o*Math.cos(r),t},L.fromElements=function(e,t,n,r){return w(r)?(r.x=e,r.y=t,r.z=n,r):new L(e,t,n)},L.clone=function(e,t){if(w(e))return w(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new L(e.x,e.y,e.z)},L.fromCartesian4=L.clone,L.packedLength=3,L.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.x,t[n++]=e.y,t[n]=e.z,t},L.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new L),n.x=e[t++],n.y=e[t++],n.z=e[t],n},L.packArray=function(e,t){O.defined("array",e);const n=e.length,r=3*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 3 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)L.pack(e[o],t,3*o);return t},L.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new T("array length must be a multiple of 3.");const n=e.length;w(t)?t.length=n/3:t=new Array(n/3);for(let r=0;r<n;r+=3){const n=r/3;t[n]=L.unpack(e,r,t[n])}return t},L.fromArray=L.unpack,L.maximumComponent=function(e){return O.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},L.minimumComponent=function(e){return O.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},L.minimumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n},L.maximumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n},L.clamp=function(e,t,n,r){O.typeOf.object("value",e),O.typeOf.object("min",t),O.typeOf.object("max",n),O.typeOf.object("result",r);const o=v.clamp(e.x,t.x,n.x),i=v.clamp(e.y,t.y,n.y),a=v.clamp(e.z,t.z,n.z);return r.x=o,r.y=i,r.z=a,r},L.magnitudeSquared=function(e){return O.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},L.magnitude=function(e){return Math.sqrt(L.magnitudeSquared(e))};const F=new L;L.distance=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),L.subtract(e,t,F),L.magnitude(F)},L.distanceSquared=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),L.subtract(e,t,F),L.magnitudeSquared(F)},L.normalize=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=L.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new T("normalized result is not a number");return t},L.dot=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},L.multiplyComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},L.divideComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n},L.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},L.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},L.multiplyByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},L.divideByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},L.negate=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},L.abs=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};const D=new L;L.lerp=function(e,t,n,r){return O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r),L.multiplyByScalar(t,n,D),r=L.multiplyByScalar(e,1-n,r),L.add(D,r,r)};const z=new L,B=new L;L.angleBetween=function(e,t){O.typeOf.object("left",e),O.typeOf.object("right",t),L.normalize(e,z),L.normalize(t,B);const n=L.dot(z,B),r=L.magnitude(L.cross(z,B,z));return Math.atan2(r,n)};const U=new L;L.mostOrthogonalAxis=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=L.normalize(e,U);return L.abs(n,n),n.x<=n.y?n.x<=n.z?L.clone(L.UNIT_X,t):L.clone(L.UNIT_Z,t):n.y<=n.z?L.clone(L.UNIT_Y,t):L.clone(L.UNIT_Z,t)},L.projectVector=function(e,t,n){O.defined("a",e),O.defined("b",t),O.defined("result",n);const r=L.dot(e,t)/L.dot(t,t);return L.multiplyByScalar(t,r,n)},L.equals=function(e,t){return e===t||w(e)&&w(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},L.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},L.equalsEpsilon=function(e,t,n,r){return e===t||w(e)&&w(t)&&v.equalsEpsilon(e.x,t.x,n,r)&&v.equalsEpsilon(e.y,t.y,n,r)&&v.equalsEpsilon(e.z,t.z,n,r)},L.cross=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,a=t.x,s=t.y,u=t.z,c=o*u-i*s,l=i*a-r*u,f=r*s-o*a;return n.x=c,n.y=l,n.z=f,n},L.midpoint=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z),n},L.fromDegrees=function(e,t,n,r,o){return O.typeOf.number("longitude",e),O.typeOf.number("latitude",t),e=v.toRadians(e),t=v.toRadians(t),L.fromRadians(e,t,n,r,o)};let j=new L,q=new L;function G(e,t,n,r){this.x=e??0,this.y=t??0,this.z=n??0,this.w=r??0}L._ellipsoidRadiiSquared=new L(40680631590769,40680631590769,40408299984661.445),L.fromRadians=function(e,t,n,r,o){O.typeOf.number("longitude",e),O.typeOf.number("latitude",t),n=n??0;const i=w(r)?r.radiiSquared:L._ellipsoidRadiiSquared,a=Math.cos(t);j.x=a*Math.cos(e),j.y=a*Math.sin(e),j.z=Math.sin(t),j=L.normalize(j,j),L.multiplyComponents(i,j,q);const s=Math.sqrt(L.dot(j,q));return q=L.divideByScalar(q,s,q),j=L.multiplyByScalar(j,n,j),w(o)||(o=new L),L.add(q,j,o)},L.fromDegreesArray=function(e,t,n){if(O.defined("coordinates",e),e.length<2||e.length%2!=0)throw new T("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;w(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],a=o/2;n[a]=L.fromDegrees(r,i,0,t,n[a])}return n},L.fromRadiansArray=function(e,t,n){if(O.defined("coordinates",e),e.length<2||e.length%2!=0)throw new T("the number of coordinates must be a multiple of 2 and at least 2");const r=e.length;w(n)?n.length=r/2:n=new Array(r/2);for(let o=0;o<r;o+=2){const r=e[o],i=e[o+1],a=o/2;n[a]=L.fromRadians(r,i,0,t,n[a])}return n},L.fromDegreesArrayHeights=function(e,t,n){if(O.defined("coordinates",e),e.length<3||e.length%3!=0)throw new T("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;w(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],a=e[o+2],s=o/3;n[s]=L.fromDegrees(r,i,a,t,n[s])}return n},L.fromRadiansArrayHeights=function(e,t,n){if(O.defined("coordinates",e),e.length<3||e.length%3!=0)throw new T("the number of coordinates must be a multiple of 3 and at least 3");const r=e.length;w(n)?n.length=r/3:n=new Array(r/3);for(let o=0;o<r;o+=3){const r=e[o],i=e[o+1],a=e[o+2],s=o/3;n[s]=L.fromRadians(r,i,a,t,n[s])}return n},L.ZERO=Object.freeze(new L(0,0,0)),L.ONE=Object.freeze(new L(1,1,1)),L.UNIT_X=Object.freeze(new L(1,0,0)),L.UNIT_Y=Object.freeze(new L(0,1,0)),L.UNIT_Z=Object.freeze(new L(0,0,1)),L.prototype.clone=function(e){return L.clone(this,e)},L.prototype.equals=function(e){return L.equals(this,e)},L.prototype.equalsEpsilon=function(e,t,n){return L.equalsEpsilon(this,e,t,n)},L.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`},G.fromElements=function(e,t,n,r,o){return w(o)?(o.x=e,o.y=t,o.z=n,o.w=r,o):new G(e,t,n,r)},G.fromColor=function(e,t){return O.typeOf.object("color",e),w(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new G(e.red,e.green,e.blue,e.alpha)},G.clone=function(e,t){if(w(e))return w(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new G(e.x,e.y,e.z,e.w)},G.packedLength=4,G.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},G.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new G),n.x=e[t++],n.y=e[t++],n.z=e[t++],n.w=e[t],n},G.packArray=function(e,t){O.defined("array",e);const n=e.length,r=4*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)G.pack(e[o],t,4*o);return t},G.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new T("array length must be a multiple of 4.");const n=e.length;w(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=G.unpack(e,r,t[n])}return t},G.fromArray=G.unpack,G.maximumComponent=function(e){return O.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},G.minimumComponent=function(e){return O.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},G.minimumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n},G.maximumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n},G.clamp=function(e,t,n,r){O.typeOf.object("value",e),O.typeOf.object("min",t),O.typeOf.object("max",n),O.typeOf.object("result",r);const o=v.clamp(e.x,t.x,n.x),i=v.clamp(e.y,t.y,n.y),a=v.clamp(e.z,t.z,n.z),s=v.clamp(e.w,t.w,n.w);return r.x=o,r.y=i,r.z=a,r.w=s,r},G.magnitudeSquared=function(e){return O.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},G.magnitude=function(e){return Math.sqrt(G.magnitudeSquared(e))};const k=new G;G.distance=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),G.subtract(e,t,k),G.magnitude(k)},G.distanceSquared=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),G.subtract(e,t,k),G.magnitudeSquared(k)},G.normalize=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=G.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new T("normalized result is not a number");return t},G.dot=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},G.multiplyComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},G.divideComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n.w=e.w/t.w,n},G.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},G.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},G.multiplyByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},G.divideByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},G.negate=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},G.abs=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};const W=new G;G.lerp=function(e,t,n,r){return O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r),G.multiplyByScalar(t,n,W),r=G.multiplyByScalar(e,1-n,r),G.add(W,r,r)};const V=new G;G.mostOrthogonalAxis=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=G.normalize(e,V);return G.abs(n,n),n.x<=n.y?n.x<=n.z?n.x<=n.w?G.clone(G.UNIT_X,t):G.clone(G.UNIT_W,t):n.z<=n.w?G.clone(G.UNIT_Z,t):G.clone(G.UNIT_W,t):n.y<=n.z?n.y<=n.w?G.clone(G.UNIT_Y,t):G.clone(G.UNIT_W,t):n.z<=n.w?G.clone(G.UNIT_Z,t):G.clone(G.UNIT_W,t)},G.equals=function(e,t){return e===t||w(e)&&w(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},G.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},G.equalsEpsilon=function(e,t,n,r){return e===t||w(e)&&w(t)&&v.equalsEpsilon(e.x,t.x,n,r)&&v.equalsEpsilon(e.y,t.y,n,r)&&v.equalsEpsilon(e.z,t.z,n,r)&&v.equalsEpsilon(e.w,t.w,n,r)},G.ZERO=Object.freeze(new G(0,0,0,0)),G.ONE=Object.freeze(new G(1,1,1,1)),G.UNIT_X=Object.freeze(new G(1,0,0,0)),G.UNIT_Y=Object.freeze(new G(0,1,0,0)),G.UNIT_Z=Object.freeze(new G(0,0,1,0)),G.UNIT_W=Object.freeze(new G(0,0,0,1)),G.prototype.clone=function(e){return G.clone(this,e)},G.prototype.equals=function(e){return G.equals(this,e)},G.prototype.equalsEpsilon=function(e,t,n){return G.equalsEpsilon(this,e,t,n)},G.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const H=new Float32Array(1),Y=new Uint8Array(H.buffer),X=new Uint32Array([287454020]),$=68===new Uint8Array(X.buffer)[0];G.packFloat=function(e,t){return O.typeOf.number("value",e),w(t)||(t=new G),H[0]=e,$?(t.x=Y[0],t.y=Y[1],t.z=Y[2],t.w=Y[3]):(t.x=Y[3],t.y=Y[2],t.z=Y[1],t.w=Y[0]),t},G.unpackFloat=function(e){return O.typeOf.object("packedFloat",e),$?(Y[0]=e.x,Y[1]=e.y,Y[2]=e.z,Y[3]=e.w):(Y[0]=e.w,Y[1]=e.z,Y[2]=e.y,Y[3]=e.x),H[0]};const K={};function Z(e,t,n,r,o,i,a,s,u){this[0]=e??0,this[1]=r??0,this[2]=a??0,this[3]=t??0,this[4]=o??0,this[5]=s??0,this[6]=n??0,this[7]=i??0,this[8]=u??0}K.EMPTY_OBJECT=Object.freeze({}),K.EMPTY_ARRAY=Object.freeze([]),Z.packedLength=9,Z.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t},Z.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new Z),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n},Z.packArray=function(e,t){O.defined("array",e);const n=e.length,r=9*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 9 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)Z.pack(e[o],t,9*o);return t},Z.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,9),e.length%9!=0)throw new T("array length must be a multiple of 9.");const n=e.length;w(t)?t.length=n/9:t=new Array(n/9);for(let r=0;r<n;r+=9){const n=r/9;t[n]=Z.unpack(e,r,t[n])}return t},Z.clone=function(e,t){if(w(e))return w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new Z(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},Z.fromArray=Z.unpack,Z.fromColumnMajorArray=function(e,t){return O.defined("values",e),Z.clone(e,t)},Z.fromRowMajorArray=function(e,t){return O.defined("values",e),w(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new Z(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Z.fromQuaternion=function(e,t){O.typeOf.object("quaternion",e);const n=e.x*e.x,r=e.x*e.y,o=e.x*e.z,i=e.x*e.w,a=e.y*e.y,s=e.y*e.z,u=e.y*e.w,c=e.z*e.z,l=e.z*e.w,f=e.w*e.w,h=n-a-c+f,p=2*(r-l),m=2*(o+u),d=2*(r+l),y=-n+a-c+f,_=2*(s-i),g=2*(o-u),E=2*(s+i),b=-n-a+c+f;return w(t)?(t[0]=h,t[1]=d,t[2]=g,t[3]=p,t[4]=y,t[5]=E,t[6]=m,t[7]=_,t[8]=b,t):new Z(h,p,m,d,y,_,g,E,b)},Z.fromHeadingPitchRoll=function(e,t){O.typeOf.object("headingPitchRoll",e);const n=Math.cos(-e.pitch),r=Math.cos(-e.heading),o=Math.cos(e.roll),i=Math.sin(-e.pitch),a=Math.sin(-e.heading),s=Math.sin(e.roll),u=n*r,c=-o*a+s*i*r,l=s*a+o*i*r,f=n*a,h=o*r+s*i*a,p=-s*r+o*i*a,m=-i,d=s*n,y=o*n;return w(t)?(t[0]=u,t[1]=f,t[2]=m,t[3]=c,t[4]=h,t[5]=d,t[6]=l,t[7]=p,t[8]=y,t):new Z(u,c,l,f,h,p,m,d,y)},Z.fromScale=function(e,t){return O.typeOf.object("scale",e),w(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new Z(e.x,0,0,0,e.y,0,0,0,e.z)},Z.fromUniformScale=function(e,t){return O.typeOf.number("scale",e),w(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new Z(e,0,0,0,e,0,0,0,e)},Z.fromCrossProduct=function(e,t){return O.typeOf.object("vector",e),w(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new Z(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},Z.fromRotationX=function(e,t){O.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return w(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=n,t[5]=r,t[6]=0,t[7]=-r,t[8]=n,t):new Z(1,0,0,0,n,-r,0,r,n)},Z.fromRotationY=function(e,t){O.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return w(t)?(t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=1,t[5]=0,t[6]=r,t[7]=0,t[8]=n,t):new Z(n,0,r,0,1,0,-r,0,n)},Z.fromRotationZ=function(e,t){O.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return w(t)?(t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Z(n,-r,0,r,n,0,0,0,1)},Z.toArray=function(e,t){return O.typeOf.object("matrix",e),w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},Z.getElementIndex=function(e,t){return O.typeOf.number.greaterThanOrEquals("row",t,0),O.typeOf.number.lessThanOrEquals("row",t,2),O.typeOf.number.greaterThanOrEquals("column",e,0),O.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},Z.getColumn=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,2),O.typeOf.object("result",n);const r=3*t,o=e[r],i=e[r+1],a=e[r+2];return n.x=o,n.y=i,n.z=a,n},Z.setColumn=function(e,t,n,r){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,2),O.typeOf.object("cartesian",n),O.typeOf.object("result",r);const o=3*t;return(r=Z.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r},Z.getRow=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,2),O.typeOf.object("result",n);const r=e[t],o=e[t+3],i=e[t+6];return n.x=r,n.y=o,n.z=i,n},Z.setRow=function(e,t,n,r){return O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,2),O.typeOf.object("cartesian",n),O.typeOf.object("result",r),(r=Z.clone(e,r))[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};const Q=new L;Z.setScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n);const r=Z.getScale(e,Q),o=t.x/r.x,i=t.y/r.y,a=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*a,n[7]=e[7]*a,n[8]=e[8]*a,n};const J=new L;Z.setUniformScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n);const r=Z.getScale(e,J),o=t/r.x,i=t/r.y,a=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*i,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*a,n[7]=e[7]*a,n[8]=e[8]*a,n};const ee=new L;Z.getScale=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t.x=L.magnitude(L.fromElements(e[0],e[1],e[2],ee)),t.y=L.magnitude(L.fromElements(e[3],e[4],e[5],ee)),t.z=L.magnitude(L.fromElements(e[6],e[7],e[8],ee)),t};const te=new L;Z.getMaximumScale=function(e){return Z.getScale(e,te),L.maximumComponent(te)};const ne=new L;Z.setRotation=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("result",n);const r=Z.getScale(e,ne);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=t[3]*r.y,n[4]=t[4]*r.y,n[5]=t[5]*r.y,n[6]=t[6]*r.z,n[7]=t[7]*r.z,n[8]=t[8]*r.z,n};const re=new L;Z.getRotation=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=Z.getScale(e,re);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[3]/n.y,t[4]=e[4]/n.y,t[5]=e[5]/n.y,t[6]=e[6]/n.z,t[7]=e[7]/n.z,t[8]=e[8]/n.z,t},Z.multiply=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],o=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],i=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],a=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],s=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],u=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],c=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],l=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],f=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=r,n[1]=o,n[2]=i,n[3]=a,n[4]=s,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n},Z.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n},Z.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n},Z.multiplyByVector=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("cartesian",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,a=e[0]*r+e[3]*o+e[6]*i,s=e[1]*r+e[4]*o+e[7]*i,u=e[2]*r+e[5]*o+e[8]*i;return n.x=a,n.y=s,n.z=u,n},Z.multiplyByScalar=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},Z.multiplyByScale=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n},Z.multiplyByUniformScale=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},Z.negate=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},Z.transpose=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[0],r=e[3],o=e[6],i=e[1],a=e[4],s=e[7],u=e[2],c=e[5],l=e[8];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=a,t[5]=s,t[6]=u,t[7]=c,t[8]=l,t};const oe=[1,0,0],ie=[2,2,1];function ae(e){let t=0;for(let n=0;n<3;++n){const r=e[Z.getElementIndex(ie[n],oe[n])];t+=2*r*r}return Math.sqrt(t)}function se(e,t){const n=v.EPSILON15;let r=0,o=1;for(let c=0;c<3;++c){const t=Math.abs(e[Z.getElementIndex(ie[c],oe[c])]);t>r&&(o=c,r=t)}let i=1,a=0;const s=oe[o],u=ie[o];if(Math.abs(e[Z.getElementIndex(u,s)])>n){const t=(e[Z.getElementIndex(u,u)]-e[Z.getElementIndex(s,s)])/2/e[Z.getElementIndex(u,s)];let n;n=t<0?-1/(-t+Math.sqrt(1+t*t)):1/(t+Math.sqrt(1+t*t)),i=1/Math.sqrt(1+n*n),a=n*i}return(t=Z.clone(Z.IDENTITY,t))[Z.getElementIndex(s,s)]=t[Z.getElementIndex(u,u)]=i,t[Z.getElementIndex(u,s)]=a,t[Z.getElementIndex(s,u)]=-a,t}const ue=new Z,ce=new Z;Z.computeEigenDecomposition=function(e,t){O.typeOf.object("matrix",e);const n=v.EPSILON20;let r=0,o=0;w(t)||(t={});const i=t.unitary=Z.clone(Z.IDENTITY,t.unitary),a=t.diagonal=Z.clone(e,t.diagonal),s=n*function(e){let t=0;for(let n=0;n<9;++n){const r=e[n];t+=r*r}return Math.sqrt(t)}(a);for(;o<10&&ae(a)>s;)se(a,ue),Z.transpose(ue,ce),Z.multiply(a,ue,a),Z.multiply(ce,a,a),Z.multiply(i,ue,i),++r>2&&(++o,r=0);return t},Z.abs=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},Z.determinant=function(e){O.typeOf.object("matrix",e);const t=e[0],n=e[3],r=e[6],o=e[1],i=e[4],a=e[7],s=e[2],u=e[5],c=e[8];return t*(i*c-u*a)+o*(u*r-n*c)+s*(n*a-i*r)},Z.inverse=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=Z.determinant(e);if(Math.abs(f)<=v.EPSILON15)throw new T("matrix is not invertible");t[0]=a*l-c*s,t[1]=c*o-r*l,t[2]=r*s-a*o,t[3]=u*s-i*l,t[4]=n*l-u*o,t[5]=i*o-n*s,t[6]=i*c-u*a,t[7]=u*r-n*c,t[8]=n*a-i*r;const h=1/f;return Z.multiplyByScalar(t,h,t)};const le=new Z;function fe(e){let t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}function he(e,t,n,r,o,i,a,s,u,c,l,f,h,p,m,d){this[0]=e??0,this[1]=o??0,this[2]=u??0,this[3]=h??0,this[4]=t??0,this[5]=i??0,this[6]=c??0,this[7]=p??0,this[8]=n??0,this[9]=a??0,this[10]=l??0,this[11]=m??0,this[12]=r??0,this[13]=s??0,this[14]=f??0,this[15]=d??0}Z.inverseTranspose=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),Z.inverse(Z.transpose(e,le),t)},Z.equals=function(e,t){return e===t||w(e)&&w(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},Z.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n},Z.IDENTITY=Object.freeze(new Z(1,0,0,0,1,0,0,0,1)),Z.ZERO=Object.freeze(new Z(0,0,0,0,0,0,0,0,0)),Z.COLUMN0ROW0=0,Z.COLUMN0ROW1=1,Z.COLUMN0ROW2=2,Z.COLUMN1ROW0=3,Z.COLUMN1ROW1=4,Z.COLUMN1ROW2=5,Z.COLUMN2ROW0=6,Z.COLUMN2ROW1=7,Z.COLUMN2ROW2=8,Object.defineProperties(Z.prototype,{length:{get:function(){return Z.packedLength}}}),Z.prototype.clone=function(e){return Z.clone(this,e)},Z.prototype.equals=function(e){return Z.equals(this,e)},Z.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},Z.prototype.equalsEpsilon=function(e,t){return Z.equalsEpsilon(this,e,t)},Z.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})`},w(Object.create)&&(fe.prototype=Object.create(Error.prototype),fe.prototype.constructor=fe),fe.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return w(this.stack)&&(e+=`\n${this.stack.toString()}`),e},he.packedLength=16,he.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t[n++]=e[4],t[n++]=e[5],t[n++]=e[6],t[n++]=e[7],t[n++]=e[8],t[n++]=e[9],t[n++]=e[10],t[n++]=e[11],t[n++]=e[12],t[n++]=e[13],t[n++]=e[14],t[n]=e[15],t},he.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new he),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n[4]=e[t++],n[5]=e[t++],n[6]=e[t++],n[7]=e[t++],n[8]=e[t++],n[9]=e[t++],n[10]=e[t++],n[11]=e[t++],n[12]=e[t++],n[13]=e[t++],n[14]=e[t++],n[15]=e[t],n},he.packArray=function(e,t){O.defined("array",e);const n=e.length,r=16*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 16 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)he.pack(e[o],t,16*o);return t},he.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,16),e.length%16!=0)throw new T("array length must be a multiple of 16.");const n=e.length;w(t)?t.length=n/16:t=new Array(n/16);for(let r=0;r<n;r+=16){const n=r/16;t[n]=he.unpack(e,r,t[n])}return t},he.clone=function(e,t){if(w(e))return w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new he(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},he.fromArray=he.unpack,he.fromColumnMajorArray=function(e,t){return O.defined("values",e),he.clone(e,t)},he.fromRowMajorArray=function(e,t){return O.defined("values",e),w(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new he(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},he.fromRotationTranslation=function(e,t,n){return O.typeOf.object("rotation",e),t=t??L.ZERO,w(n)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[3],n[5]=e[4],n[6]=e[5],n[7]=0,n[8]=e[6],n[9]=e[7],n[10]=e[8],n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,n):new he(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},he.fromTranslationQuaternionRotationScale=function(e,t,n,r){O.typeOf.object("translation",e),O.typeOf.object("rotation",t),O.typeOf.object("scale",n),w(r)||(r=new he);const o=n.x,i=n.y,a=n.z,s=t.x*t.x,u=t.x*t.y,c=t.x*t.z,l=t.x*t.w,f=t.y*t.y,h=t.y*t.z,p=t.y*t.w,m=t.z*t.z,d=t.z*t.w,y=t.w*t.w,_=s-f-m+y,g=2*(u-d),E=2*(c+p),b=2*(u+d),T=-s+f-m+y,A=2*(h-l),x=2*(c-p),R=2*(h+l),S=-s-f+m+y;return r[0]=_*o,r[1]=b*o,r[2]=x*o,r[3]=0,r[4]=g*i,r[5]=T*i,r[6]=R*i,r[7]=0,r[8]=E*a,r[9]=A*a,r[10]=S*a,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r},he.fromTranslationRotationScale=function(e,t){return O.typeOf.object("translationRotationScale",e),he.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},he.fromTranslation=function(e,t){return O.typeOf.object("translation",e),he.fromRotationTranslation(Z.IDENTITY,e,t)},he.fromScale=function(e,t){return O.typeOf.object("scale",e),w(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new he(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},he.fromUniformScale=function(e,t){return O.typeOf.number("scale",e),w(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new he(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)},he.fromRotation=function(e,t){return O.typeOf.object("rotation",e),w(t)||(t=new he),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};const pe=new L,me=new L,de=new L;he.fromCamera=function(e,t){O.typeOf.object("camera",e);const n=e.position,r=e.direction,o=e.up;O.typeOf.object("camera.position",n),O.typeOf.object("camera.direction",r),O.typeOf.object("camera.up",o),L.normalize(r,pe),L.normalize(L.cross(pe,o,me),me),L.normalize(L.cross(me,pe,de),de);const i=me.x,a=me.y,s=me.z,u=pe.x,c=pe.y,l=pe.z,f=de.x,h=de.y,p=de.z,m=n.x,d=n.y,y=n.z,_=i*-m+a*-d+s*-y,g=f*-m+h*-d+p*-y,E=u*m+c*d+l*y;return w(t)?(t[0]=i,t[1]=f,t[2]=-u,t[3]=0,t[4]=a,t[5]=h,t[6]=-c,t[7]=0,t[8]=s,t[9]=p,t[10]=-l,t[11]=0,t[12]=_,t[13]=g,t[14]=E,t[15]=1,t):new he(i,a,s,_,f,h,p,g,-u,-c,-l,E,0,0,0,1)},he.computePerspectiveFieldOfView=function(e,t,n,r,o){O.typeOf.number.greaterThan("fovY",e,0),O.typeOf.number.lessThan("fovY",e,Math.PI),O.typeOf.number.greaterThan("near",n,0),O.typeOf.number.greaterThan("far",r,0),O.typeOf.object("result",o);const i=1/Math.tan(.5*e),a=i/t,s=(r+n)/(n-r),u=2*r*n/(n-r);return o[0]=a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=s,o[11]=-1,o[12]=0,o[13]=0,o[14]=u,o[15]=0,o},he.computeOrthographicOffCenter=function(e,t,n,r,o,i,a){O.typeOf.number("left",e),O.typeOf.number("right",t),O.typeOf.number("bottom",n),O.typeOf.number("top",r),O.typeOf.number("near",o),O.typeOf.number("far",i),O.typeOf.object("result",a);let s=1/(t-e),u=1/(r-n),c=1/(i-o);const l=-(t+e)*s,f=-(r+n)*u,h=-(i+o)*c;return s*=2,u*=2,c*=-2,a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=c,a[11]=0,a[12]=l,a[13]=f,a[14]=h,a[15]=1,a},he.computePerspectiveOffCenter=function(e,t,n,r,o,i,a){O.typeOf.number("left",e),O.typeOf.number("right",t),O.typeOf.number("bottom",n),O.typeOf.number("top",r),O.typeOf.number("near",o),O.typeOf.number("far",i),O.typeOf.object("result",a);const s=2*o/(t-e),u=2*o/(r-n),c=(t+e)/(t-e),l=(r+n)/(r-n),f=-(i+o)/(i-o),h=-2*i*o/(i-o);return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=u,a[6]=0,a[7]=0,a[8]=c,a[9]=l,a[10]=f,a[11]=-1,a[12]=0,a[13]=0,a[14]=h,a[15]=0,a},he.computeInfinitePerspectiveOffCenter=function(e,t,n,r,o,i){O.typeOf.number("left",e),O.typeOf.number("right",t),O.typeOf.number("bottom",n),O.typeOf.number("top",r),O.typeOf.number("near",o),O.typeOf.object("result",i);const a=2*o/(t-e),s=2*o/(r-n),u=(t+e)/(t-e),c=(r+n)/(r-n),l=-2*o;return i[0]=a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=u,i[9]=c,i[10]=-1,i[11]=-1,i[12]=0,i[13]=0,i[14]=l,i[15]=0,i},he.computeViewportTransformation=function(e,t,n,r){w(r)||(r=new he);const o=(e=e??K.EMPTY_OBJECT).x??0,i=e.y??0;t=t??0;const a=.5*(e.width??0),s=.5*(e.height??0),u=.5*((n=n??1)-t),c=a,l=s,f=u,h=o+a,p=i+s,m=t+u;return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=f,r[11]=0,r[12]=h,r[13]=p,r[14]=m,r[15]=1,r},he.computeView=function(e,t,n,r,o){return O.typeOf.object("position",e),O.typeOf.object("direction",t),O.typeOf.object("up",n),O.typeOf.object("right",r),O.typeOf.object("result",o),o[0]=r.x,o[1]=n.x,o[2]=-t.x,o[3]=0,o[4]=r.y,o[5]=n.y,o[6]=-t.y,o[7]=0,o[8]=r.z,o[9]=n.z,o[10]=-t.z,o[11]=0,o[12]=-L.dot(r,e),o[13]=-L.dot(n,e),o[14]=L.dot(t,e),o[15]=1,o},he.toArray=function(e,t){return O.typeOf.object("matrix",e),w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},he.getElementIndex=function(e,t){return O.typeOf.number.greaterThanOrEquals("row",t,0),O.typeOf.number.lessThanOrEquals("row",t,3),O.typeOf.number.greaterThanOrEquals("column",e,0),O.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},he.getColumn=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,3),O.typeOf.object("result",n);const r=4*t,o=e[r],i=e[r+1],a=e[r+2],s=e[r+3];return n.x=o,n.y=i,n.z=a,n.w=s,n},he.setColumn=function(e,t,n,r){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,3),O.typeOf.object("cartesian",n),O.typeOf.object("result",r);const o=4*t;return(r=he.clone(e,r))[o]=n.x,r[o+1]=n.y,r[o+2]=n.z,r[o+3]=n.w,r},he.getRow=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,3),O.typeOf.object("result",n);const r=e[t],o=e[t+4],i=e[t+8],a=e[t+12];return n.x=r,n.y=o,n.z=i,n.w=a,n},he.setRow=function(e,t,n,r){return O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,3),O.typeOf.object("cartesian",n),O.typeOf.object("result",r),(r=he.clone(e,r))[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r},he.setTranslation=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.object("translation",t),O.typeOf.object("result",n),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n};const ye=new L;he.setScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n);const r=he.getScale(e,ye),o=t.x/r.x,i=t.y/r.y,a=t.z/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const _e=new L;he.setUniformScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n);const r=he.getScale(e,_e),o=t/r.x,i=t/r.y,a=t/r.z;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3],n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7],n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const ge=new L;he.getScale=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t.x=L.magnitude(L.fromElements(e[0],e[1],e[2],ge)),t.y=L.magnitude(L.fromElements(e[4],e[5],e[6],ge)),t.z=L.magnitude(L.fromElements(e[8],e[9],e[10],ge)),t};const Ee=new L;he.getMaximumScale=function(e){return he.getScale(e,Ee),L.maximumComponent(Ee)};const be=new L;he.setRotation=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("result",n);const r=he.getScale(e,be);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.x,n[3]=e[3],n[4]=t[3]*r.y,n[5]=t[4]*r.y,n[6]=t[5]*r.y,n[7]=e[7],n[8]=t[6]*r.z,n[9]=t[7]*r.z,n[10]=t[8]*r.z,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n};const we=new L;he.getRotation=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=he.getScale(e,we);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.x,t[3]=e[4]/n.y,t[4]=e[5]/n.y,t[5]=e[6]/n.y,t[6]=e[8]/n.z,t[7]=e[9]/n.z,t[8]=e[10]/n.z,t},he.multiply=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],m=e[11],d=e[12],y=e[13],_=e[14],g=e[15],E=t[0],b=t[1],w=t[2],T=t[3],A=t[4],x=t[5],R=t[6],S=t[7],I=t[8],C=t[9],N=t[10],v=t[11],P=t[12],M=t[13],L=t[14],F=t[15],D=r*E+s*b+f*w+d*T,z=o*E+u*b+h*w+y*T,B=i*E+c*b+p*w+_*T,U=a*E+l*b+m*w+g*T,j=r*A+s*x+f*R+d*S,q=o*A+u*x+h*R+y*S,G=i*A+c*x+p*R+_*S,k=a*A+l*x+m*R+g*S,W=r*I+s*C+f*N+d*v,V=o*I+u*C+h*N+y*v,H=i*I+c*C+p*N+_*v,Y=a*I+l*C+m*N+g*v,X=r*P+s*M+f*L+d*F,$=o*P+u*M+h*L+y*F,K=i*P+c*M+p*L+_*F,Z=a*P+l*M+m*L+g*F;return n[0]=D,n[1]=z,n[2]=B,n[3]=U,n[4]=j,n[5]=q,n[6]=G,n[7]=k,n[8]=W,n[9]=V,n[10]=H,n[11]=Y,n[12]=X,n[13]=$,n[14]=K,n[15]=Z,n},he.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n},he.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n},he.multiplyTransformation=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],a=e[4],s=e[5],u=e[6],c=e[8],l=e[9],f=e[10],h=e[12],p=e[13],m=e[14],d=t[0],y=t[1],_=t[2],g=t[4],E=t[5],b=t[6],w=t[8],T=t[9],A=t[10],x=t[12],R=t[13],S=t[14],I=r*d+a*y+c*_,C=o*d+s*y+l*_,N=i*d+u*y+f*_,v=r*g+a*E+c*b,P=o*g+s*E+l*b,M=i*g+u*E+f*b,L=r*w+a*T+c*A,F=o*w+s*T+l*A,D=i*w+u*T+f*A,z=r*x+a*R+c*S+h,B=o*x+s*R+l*S+p,U=i*x+u*R+f*S+m;return n[0]=I,n[1]=C,n[2]=N,n[3]=0,n[4]=v,n[5]=P,n[6]=M,n[7]=0,n[8]=L,n[9]=F,n[10]=D,n[11]=0,n[12]=z,n[13]=B,n[14]=U,n[15]=1,n},he.multiplyByMatrix3=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("rotation",t),O.typeOf.object("result",n);const r=e[0],o=e[1],i=e[2],a=e[4],s=e[5],u=e[6],c=e[8],l=e[9],f=e[10],h=t[0],p=t[1],m=t[2],d=t[3],y=t[4],_=t[5],g=t[6],E=t[7],b=t[8],w=r*h+a*p+c*m,T=o*h+s*p+l*m,A=i*h+u*p+f*m,x=r*d+a*y+c*_,R=o*d+s*y+l*_,S=i*d+u*y+f*_,I=r*g+a*E+c*b,C=o*g+s*E+l*b,N=i*g+u*E+f*b;return n[0]=w,n[1]=T,n[2]=A,n[3]=0,n[4]=x,n[5]=R,n[6]=S,n[7]=0,n[8]=I,n[9]=C,n[10]=N,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},he.multiplyByTranslation=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("translation",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,a=r*e[0]+o*e[4]+i*e[8]+e[12],s=r*e[1]+o*e[5]+i*e[9]+e[13],u=r*e[2]+o*e[6]+i*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=a,n[13]=s,n[14]=u,n[15]=e[15],n},he.multiplyByScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z;return 1===r&&1===o&&1===i?he.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=o*e[6],n[7]=e[7],n[8]=i*e[8],n[9]=i*e[9],n[10]=i*e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},he.multiplyByUniformScale=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3],n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7],n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},he.multiplyByVector=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("cartesian",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,a=t.w,s=e[0]*r+e[4]*o+e[8]*i+e[12]*a,u=e[1]*r+e[5]*o+e[9]*i+e[13]*a,c=e[2]*r+e[6]*o+e[10]*i+e[14]*a,l=e[3]*r+e[7]*o+e[11]*i+e[15]*a;return n.x=s,n.y=u,n.z=c,n.w=l,n},he.multiplyByPointAsVector=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("cartesian",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,a=e[0]*r+e[4]*o+e[8]*i,s=e[1]*r+e[5]*o+e[9]*i,u=e[2]*r+e[6]*o+e[10]*i;return n.x=a,n.y=s,n.z=u,n},he.multiplyByPoint=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("cartesian",t),O.typeOf.object("result",n);const r=t.x,o=t.y,i=t.z,a=e[0]*r+e[4]*o+e[8]*i+e[12],s=e[1]*r+e[5]*o+e[9]*i+e[13],u=e[2]*r+e[6]*o+e[10]*i+e[14];return n.x=a,n.y=s,n.z=u,n},he.multiplyByScalar=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n},he.negate=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},he.transpose=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[1],r=e[2],o=e[3],i=e[6],a=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[10]=e[10],t[11]=e[14],t[12]=o,t[13]=a,t[14]=s,t[15]=e[15],t},he.abs=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},he.equals=function(e,t){return e===t||w(e)&&w(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},he.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n},he.getTranslation=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},he.getMatrix3=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};const Te=new Z,Oe=new Z,Ae=new G,xe=new G(0,0,0,1);he.inverse=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[0],r=e[4],o=e[8],i=e[12],a=e[1],s=e[5],u=e[9],c=e[13],l=e[2],f=e[6],h=e[10],p=e[14],m=e[3],d=e[7],y=e[11],_=e[15];let g=h*_,E=p*y,b=f*_,w=p*d,T=f*y,A=h*d,x=l*_,R=p*m,S=l*y,I=h*m,C=l*d,N=f*m;const P=g*s+w*u+T*c-(E*s+b*u+A*c),M=E*a+x*u+I*c-(g*a+R*u+S*c),L=b*a+R*s+C*c-(w*a+x*s+N*c),F=A*a+S*s+N*u-(T*a+I*s+C*u),D=E*r+b*o+A*i-(g*r+w*o+T*i),z=g*n+R*o+S*i-(E*n+x*o+I*i),B=w*n+x*r+N*i-(b*n+R*r+C*i),U=T*n+I*r+C*o-(A*n+S*r+N*o);g=o*c,E=i*u,b=r*c,w=i*s,T=r*u,A=o*s,x=n*c,R=i*a,S=n*u,I=o*a,C=n*s,N=r*a;const j=g*d+w*y+T*_-(E*d+b*y+A*_),q=E*m+x*y+I*_-(g*m+R*y+S*_),k=b*m+R*d+C*_-(w*m+x*d+N*_),W=A*m+S*d+N*y-(T*m+I*d+C*y),V=b*h+A*p+E*f-(T*p+g*f+w*h),H=S*p+g*l+R*h-(x*h+I*p+E*l),Y=x*f+N*p+w*l-(C*p+b*l+R*f),X=C*h+T*l+I*f-(S*f+N*h+A*l);let $=n*P+r*M+o*L+i*F;if(Math.abs($)<v.EPSILON21){if(Z.equalsEpsilon(he.getMatrix3(e,Te),Oe,v.EPSILON7)&&G.equals(he.getRow(e,3,Ae),xe))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new fe("matrix is not invertible because its determinate is zero.")}return $=1/$,t[0]=P*$,t[1]=M*$,t[2]=L*$,t[3]=F*$,t[4]=D*$,t[5]=z*$,t[6]=B*$,t[7]=U*$,t[8]=j*$,t[9]=q*$,t[10]=k*$,t[11]=W*$,t[12]=V*$,t[13]=H*$,t[14]=Y*$,t[15]=X*$,t},he.inverseTransformation=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[0],r=e[1],o=e[2],i=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10],f=e[12],h=e[13],p=e[14],m=-n*f-r*h-o*p,d=-i*f-a*h-s*p,y=-u*f-c*h-l*p;return t[0]=n,t[1]=i,t[2]=u,t[3]=0,t[4]=r,t[5]=a,t[6]=c,t[7]=0,t[8]=o,t[9]=s,t[10]=l,t[11]=0,t[12]=m,t[13]=d,t[14]=y,t[15]=1,t};const Re=new he;he.inverseTranspose=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),he.inverse(he.transpose(e,Re),t)},he.IDENTITY=Object.freeze(new he(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),he.ZERO=Object.freeze(new he(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),he.COLUMN0ROW0=0,he.COLUMN0ROW1=1,he.COLUMN0ROW2=2,he.COLUMN0ROW3=3,he.COLUMN1ROW0=4,he.COLUMN1ROW1=5,he.COLUMN1ROW2=6,he.COLUMN1ROW3=7,he.COLUMN2ROW0=8,he.COLUMN2ROW1=9,he.COLUMN2ROW2=10,he.COLUMN2ROW3=11,he.COLUMN3ROW0=12,he.COLUMN3ROW1=13,he.COLUMN3ROW2=14,he.COLUMN3ROW3=15,Object.defineProperties(he.prototype,{length:{get:function(){return he.packedLength}}}),he.prototype.clone=function(e){return he.clone(this,e)},he.prototype.equals=function(e){return he.equals(this,e)},he.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},he.prototype.equalsEpsilon=function(e,t){return he.equalsEpsilon(this,e,t)},he.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var Se=Object.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047});function Ie(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Ce(){return!0}function Ne(e,t){function n(){throw new T(t)}t=t??"This object was destroyed, i.e., destroy() was called.";for(const r in e)"function"==typeof e[r]&&(e[r]=n);e.isDestroyed=Ce}const ve={UNSIGNED_BYTE:Se.UNSIGNED_BYTE,UNSIGNED_SHORT:Se.UNSIGNED_SHORT,UNSIGNED_INT:Se.UNSIGNED_INT,getSizeInBytes:function(e){switch(e){case ve.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ve.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ve.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new T("indexDatatype is required and must be a valid IndexDatatype constant.")},fromSizeInBytes:function(e){switch(e){case 2:return ve.UNSIGNED_SHORT;case 4:return ve.UNSIGNED_INT;case 1:return ve.UNSIGNED_BYTE;default:throw new T("Size in bytes cannot be mapped to an IndexDatatype")}},validate:function(e){return w(e)&&(e===ve.UNSIGNED_BYTE||e===ve.UNSIGNED_SHORT||e===ve.UNSIGNED_INT)},createTypedArray:function(e,t){if(!w(e))throw new T("numberOfVertices is required.");return e>=v.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},createTypedArrayFromArrayBuffer:function(e,t,n,r){if(!w(e))throw new T("numberOfVertices is required.");if(!w(t))throw new T("sourceArray is required.");if(!w(n))throw new T("byteOffset is required.");return e>=v.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,r):new Uint16Array(t,n,r)},fromTypedArray:function(e){if(e instanceof Uint8Array)return ve.UNSIGNED_BYTE;if(e instanceof Uint16Array)return ve.UNSIGNED_SHORT;if(e instanceof Uint32Array)return ve.UNSIGNED_INT;throw new T("array must be a Uint8Array, Uint16Array, or Uint32Array.")}};var Pe=Object.freeze(ve);const Me={STREAM_DRAW:Se.STREAM_DRAW,STATIC_DRAW:Se.STATIC_DRAW,DYNAMIC_DRAW:Se.DYNAMIC_DRAW,validate:function(e){return e===Me.STREAM_DRAW||e===Me.STATIC_DRAW||e===Me.DYNAMIC_DRAW}};var Le=Object.freeze(Me);function Fe(e){if(e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context),!w(e.typedArray)&&!w(e.sizeInBytes))throw new T("Either options.sizeInBytes or options.typedArray is required.");if(w(e.typedArray)&&w(e.sizeInBytes))throw new T("Cannot pass in both options.sizeInBytes and options.typedArray.");if(w(e.typedArray)&&(O.typeOf.object("options.typedArray",e.typedArray),O.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!Le.validate(e.usage))throw new T("usage is invalid.");const t=e.context._gl,n=e.bufferTarget,r=e.typedArray;let o=e.sizeInBytes;const i=e.usage,a=w(r);a&&(o=r.byteLength),O.typeOf.number.greaterThan("sizeInBytes",o,0);const s=t.createBuffer();t.bindBuffer(n,s),t.bufferData(n,a?r:o,i),t.bindBuffer(n,null),this._id=Ie(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=n,this._sizeInBytes=o,this._usage=i,this._buffer=s,this.vertexArrayDestroyable=!0}let De;Fe.createVertexBuffer=function(e){return O.defined("options.context",e.context),new Fe({context:e.context,bufferTarget:Se.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},Fe.createIndexBuffer=function(e){if(O.defined("options.context",e.context),!Pe.validate(e.indexDatatype))throw new T("Invalid indexDatatype.");if(e.indexDatatype===Pe.UNSIGNED_INT&&!e.context.elementIndexUint)throw new T("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");const t=e.context,n=e.indexDatatype,r=Pe.getSizeInBytes(n),o=new Fe({context:t,bufferTarget:Se.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),i=o.sizeInBytes/r;return Object.defineProperties(o,{indexDatatype:{get:function(){return n}},bytesPerIndex:{get:function(){return r}},numberOfIndices:{get:function(){return i}}}),o},Object.defineProperties(Fe.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),Fe.prototype._getBuffer=function(){return this._buffer},Fe.prototype.copyFromArrayView=function(e,t){t=t??0,O.defined("arrayView",e),O.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);const n=this._gl,r=this._bufferTarget;n.bindBuffer(r,this._buffer),n.bufferSubData(r,t,e),n.bindBuffer(r,null)},Fe.prototype.copyFromBuffer=function(e,t,n,r){if(!this._webgl2)throw new T("A WebGL 2 context is required.");if(!w(e))throw new T("readBuffer must be defined.");if(!w(r)||r<=0)throw new T("sizeInBytes must be defined and be greater than zero.");if(!w(t)||t<0||t+r>e._sizeInBytes)throw new T("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!w(n)||n<0||n+r>this._sizeInBytes)throw new T("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e._buffer&&(n>=t&&n<t+r||t>n&&t<n+r))throw new T("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===Se.ELEMENT_ARRAY_BUFFER&&e._bufferTarget!==Se.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==Se.ELEMENT_ARRAY_BUFFER&&e._bufferTarget===Se.ELEMENT_ARRAY_BUFFER)throw new T("Can not copy an index buffer into another buffer type.");const o=Se.COPY_READ_BUFFER,i=Se.COPY_WRITE_BUFFER,a=this._gl;a.bindBuffer(i,this._buffer),a.bindBuffer(o,e._buffer),a.copyBufferSubData(o,i,t,n,r),a.bindBuffer(i,null),a.bindBuffer(o,null)},Fe.prototype.getBufferData=function(e,t,n,r){if(t=t??0,n=n??0,!this._webgl2)throw new T("A WebGL 2 context is required.");if(!w(e))throw new T("arrayView is required.");let o,i,a=e.byteLength;if(w(r)?(o=r,w(a)?i=1:(a=e.length,i=e.BYTES_PER_ELEMENT)):w(a)?(o=a-n,i=1):(a=e.length,o=a-n,i=e.BYTES_PER_ELEMENT),n<0||n>a)throw new T("destinationOffset must be greater than zero and less than the arrayView length.");if(n+o>a)throw new T("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new T("sourceOffset must be greater than zero and less than the buffers size.");if(t+o*i>this._sizeInBytes)throw new T("sourceOffset + length must be less than the buffers size.");const s=this._gl,u=Se.COPY_READ_BUFFER;s.bindBuffer(u,this._buffer),s.getBufferSubData(u,t,e,n,r),s.bindBuffer(u,null)},Fe.prototype.isDestroyed=function(){return!1},Fe.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),Ne(this)};const ze={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},Be={};let Ue,je,qe,Ge,ke,We,Ve,He,Ye,Xe,$e,Ke,Ze,Qe,Je,et,tt,nt;function rt(e){const t=e.split(".");for(let n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}function ot(){if(!w(je)&&(je=!1,!ut())){const e=/ Chrome\/([\.0-9]+)/.exec(Ue.userAgent);null!==e&&(je=!0,qe=rt(e[1]))}return je}function it(){if(!w(Ge)&&(Ge=!1,!ot()&&!ut()&&/ Safari\/[\.0-9]+/.test(Ue.userAgent))){const e=/ Version\/([\.0-9]+)/.exec(Ue.userAgent);null!==e&&(Ge=!0,ke=rt(e[1]))}return Ge}function at(){if(!w(We)){We=!1;const e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Ue.userAgent);null!==e&&(We=!0,Ve=rt(e[1]),Ve.isNightly=!!e[2])}return We}function st(){if(!w(He)){let e;He=!1,"Microsoft Internet Explorer"===Ue.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Ue.userAgent),null!==e&&(He=!0,Ye=rt(e[1]))):"Netscape"===Ue.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Ue.userAgent),null!==e&&(He=!0,Ye=rt(e[1])))}return He}function ut(){if(!w(Xe)){Xe=!1;const e=/ Edg\/([\.0-9]+)/.exec(Ue.userAgent);null!==e&&(Xe=!0,$e=rt(e[1]))}return Xe}function ct(){if(!w(Ke)){Ke=!1;const e=/Firefox\/([\.0-9]+)/.exec(Ue.userAgent);null!==e&&(Ke=!0,Ze=rt(e[1]))}return Ke}function lt(){if(!w(nt)){const e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");const t=e.style.imageRendering;nt=w(t)&&""!==t,nt&&(tt=t)}return nt}function ft(){if(!ft.initialized)throw new T("You must call FeatureDetection.supportsWebP.initialize and wait for the promise to resolve before calling FeatureDetection.supportsWebP");return ft._result}Object.defineProperties(Be,{element:{get:function(){if(Be.supportsFullscreen())return document[ze.fullscreenElement]}},changeEventName:{get:function(){if(Be.supportsFullscreen())return ze.fullscreenchange}},errorEventName:{get:function(){if(Be.supportsFullscreen())return ze.fullscreenerror}},enabled:{get:function(){if(Be.supportsFullscreen())return document[ze.fullscreenEnabled]}},fullscreen:{get:function(){if(Be.supportsFullscreen())return null!==Be.element}}}),Be.supportsFullscreen=function(){if(w(De))return De;De=!1;const e=document.body;if("function"==typeof e.requestFullscreen)return ze.requestFullscreen="requestFullscreen",ze.exitFullscreen="exitFullscreen",ze.fullscreenEnabled="fullscreenEnabled",ze.fullscreenElement="fullscreenElement",ze.fullscreenchange="fullscreenchange",ze.fullscreenerror="fullscreenerror",De=!0,De;const t=["webkit","moz","o","ms","khtml"];let n;for(let r=0,o=t.length;r<o;++r){const o=t[r];n=`${o}RequestFullscreen`,"function"==typeof e[n]?(ze.requestFullscreen=n,De=!0):(n=`${o}RequestFullScreen`,"function"==typeof e[n]&&(ze.requestFullscreen=n,De=!0)),n=`${o}ExitFullscreen`,"function"==typeof document[n]?ze.exitFullscreen=n:(n=`${o}CancelFullScreen`,"function"==typeof document[n]&&(ze.exitFullscreen=n)),n=`${o}FullscreenEnabled`,void 0!==document[n]?ze.fullscreenEnabled=n:(n=`${o}FullScreenEnabled`,void 0!==document[n]&&(ze.fullscreenEnabled=n)),n=`${o}FullscreenElement`,void 0!==document[n]?ze.fullscreenElement=n:(n=`${o}FullScreenElement`,void 0!==document[n]&&(ze.fullscreenElement=n)),n=`${o}fullscreenchange`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenChange"),ze.fullscreenchange=n),n=`${o}fullscreenerror`,void 0!==document[`on${n}`]&&("ms"===o&&(n="MSFullscreenError"),ze.fullscreenerror=n)}return De},Be.requestFullscreen=function(e,t){Be.supportsFullscreen()&&e[ze.requestFullscreen]({vrDisplay:t})},Be.exitFullscreen=function(){Be.supportsFullscreen()&&document[ze.exitFullscreen]()},Be._names=ze,Ue="undefined"!=typeof navigator?navigator:{},ft._promise=void 0,ft._result=void 0,ft.initialize=function(){return w(ft._promise)||(ft._promise=new Promise(e=>{const t=new Image;t.onload=function(){ft._result=t.width>0&&t.height>0,e(ft._result)},t.onerror=function(){ft._result=!1,e(ft._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),ft._promise},Object.defineProperties(ft,{initialized:{get:function(){return w(ft._result)}}});const ht=[];"undefined"!=typeof ArrayBuffer&&(ht.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&ht.push(Uint8ClampedArray),"undefined"!=typeof Uint8ClampedArray&&ht.push(Uint8ClampedArray),"undefined"!=typeof BigInt64Array&&ht.push(BigInt64Array),"undefined"!=typeof BigUint64Array&&ht.push(BigUint64Array));const pt={isChrome:ot,chromeVersion:function(){return ot()&&qe},isSafari:it,safariVersion:function(){return it()&&ke},isWebkit:at,webkitVersion:function(){return at()&&Ve},isInternetExplorer:st,internetExplorerVersion:function(){return st()&&Ye},isEdge:ut,edgeVersion:function(){return ut()&&$e},isFirefox:ct,firefoxVersion:function(){return ct()&&Ze},isWindows:function(){return w(Qe)||(Qe=/Windows/i.test(Ue.appVersion)),Qe},isIPadOrIOS:function(){return w(Je)||(Je="iPhone"===navigator.platform||"iPod"===navigator.platform||"iPad"===navigator.platform),Je},hardwareConcurrency:Ue.hardwareConcurrency??3,supportsPointerEvents:function(){return w(et)||(et=!ct()&&"undefined"!=typeof PointerEvent&&(!w(Ue.pointerEnabled)||Ue.pointerEnabled)),et},supportsImageRenderingPixelated:lt,supportsWebP:ft,imageRenderingValue:function(){return lt()?tt:void 0},typedArrayTypes:ht};function mt(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function dt(e,t,n,r){this.red=e??1,this.green=t??1,this.blue=n??1,this.alpha=r??1}let yt,_t,gt;pt.supportsBasis=function(e){return pt.supportsWebAssembly()&&e.context.supportsBasis},pt.supportsFullscreen=function(){return Be.supportsFullscreen()},pt.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},pt.supportsBigInt64Array=function(){return"undefined"!=typeof BigInt64Array},pt.supportsBigUint64Array=function(){return"undefined"!=typeof BigUint64Array},pt.supportsBigInt=function(){return"undefined"!=typeof BigInt},pt.supportsWebWorkers=function(){return"undefined"!=typeof Worker},pt.supportsWebAssembly=function(){return"undefined"!=typeof WebAssembly},pt.supportsWebgl2=function(e){return O.defined("scene",e),e.context.webgl2},pt.supportsEsmWebWorkers=function(){return!ct()||parseInt(Ze)>=114},dt.fromCartesian4=function(e,t){return O.typeOf.object("cartesian",e),w(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new dt(e.x,e.y,e.z,e.w)},dt.fromBytes=function(e,t,n,r,o){return e=dt.byteToFloat(e??255),t=dt.byteToFloat(t??255),n=dt.byteToFloat(n??255),r=dt.byteToFloat(r??255),w(o)?(o.red=e,o.green=t,o.blue=n,o.alpha=r,o):new dt(e,t,n,r)},dt.fromAlpha=function(e,t,n){return O.typeOf.object("color",e),O.typeOf.number("alpha",t),w(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=t,n):new dt(e.red,e.green,e.blue,t)},pt.supportsTypedArrays()&&(yt=new ArrayBuffer(4),_t=new Uint32Array(yt),gt=new Uint8Array(yt)),dt.fromRgba=function(e,t){return _t[0]=e,dt.fromBytes(gt[0],gt[1],gt[2],gt[3],t)},dt.fromHsl=function(e,t,n,r,o){e=(e??0)%1,r=r??1;let i=n=n??0,a=n,s=n;if(0!==(t=t??0)){let r;r=n<.5?n*(1+t):n+t-n*t;const o=2*n-r;i=mt(o,r,e+1/3),a=mt(o,r,e),s=mt(o,r,e-1/3)}return w(o)?(o.red=i,o.green=a,o.blue=s,o.alpha=r,o):new dt(i,a,s,r)},dt.fromRandom=function(e,t){let n=(e=e??K.EMPTY_OBJECT).red;if(!w(n)){const t=e.minimumRed??0,r=e.maximumRed??1;O.typeOf.number.lessThanOrEquals("minimumRed",t,r),n=t+v.nextRandomNumber()*(r-t)}let r=e.green;if(!w(r)){const t=e.minimumGreen??0,n=e.maximumGreen??1;O.typeOf.number.lessThanOrEquals("minimumGreen",t,n),r=t+v.nextRandomNumber()*(n-t)}let o=e.blue;if(!w(o)){const t=e.minimumBlue??0,n=e.maximumBlue??1;O.typeOf.number.lessThanOrEquals("minimumBlue",t,n),o=t+v.nextRandomNumber()*(n-t)}let i=e.alpha;if(!w(i)){const t=e.minimumAlpha??0,n=e.maximumAlpha??1;O.typeOf.number.lessThanOrEquals("minimumAlpha",t,n),i=t+v.nextRandomNumber()*(n-t)}return w(t)?(t.red=n,t.green=r,t.blue=o,t.alpha=i,t):new dt(n,r,o,i)};const Et=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,bt=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,wt=/^rgba?\s*\(\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i,Tt=/^hsla?\s*\(\s*([0-9.]+)\s*[,\s]+\s*([0-9.]+%)\s*[,\s]+\s*([0-9.]+%)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i;function Ot(e,t){this.x=e??0,this.y=t??0}dt.fromCssColorString=function(e,t){O.typeOf.string("color",e),w(t)||(t=new dt);const n=dt[(e=e.trim()).toUpperCase()];if(w(n))return dt.clone(n,t),t;let r=Et.exec(e);return null!==r?(t.red=parseInt(r[1],16)/15,t.green=parseInt(r[2],16)/15,t.blue=parseInt(r[3],16)/15,t.alpha=parseInt(r[4]??"f",16)/15,t):(r=bt.exec(e),null!==r?(t.red=parseInt(r[1],16)/255,t.green=parseInt(r[2],16)/255,t.blue=parseInt(r[3],16)/255,t.alpha=parseInt(r[4]??"ff",16)/255,t):(r=wt.exec(e),null!==r?(t.red=parseFloat(r[1])/("%"===r[1].substr(-1)?100:255),t.green=parseFloat(r[2])/("%"===r[2].substr(-1)?100:255),t.blue=parseFloat(r[3])/("%"===r[3].substr(-1)?100:255),t.alpha=parseFloat(r[4]??"1.0"),t):(r=Tt.exec(e),null!==r?dt.fromHsl(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,parseFloat(r[4]??"1.0"),t):t=void 0)))},dt.packedLength=4,dt.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.red,t[n++]=e.green,t[n++]=e.blue,t[n]=e.alpha,t},dt.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new dt),n.red=e[t++],n.green=e[t++],n.blue=e[t++],n.alpha=e[t],n},dt.byteToFloat=function(e){return e/255},dt.floatToByte=function(e){return 1===e?255:256*e|0},dt.clone=function(e,t){if(w(e))return w(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new dt(e.red,e.green,e.blue,e.alpha)},dt.equals=function(e,t){return e===t||w(e)&&w(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},dt.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]},dt.prototype.clone=function(e){return dt.clone(this,e)},dt.prototype.equals=function(e){return dt.equals(this,e)},dt.prototype.equalsEpsilon=function(e,t){return this===e||w(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},dt.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`},dt.prototype.toCssColorString=function(){const e=dt.floatToByte(this.red),t=dt.floatToByte(this.green),n=dt.floatToByte(this.blue);return 1===this.alpha?`rgb(${e},${t},${n})`:`rgba(${e},${t},${n},${this.alpha})`},dt.prototype.toCssHexString=function(){let e=dt.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=dt.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let n=dt.floatToByte(this.blue).toString(16);if(n.length<2&&(n=`0${n}`),this.alpha<1){let r=dt.floatToByte(this.alpha).toString(16);return r.length<2&&(r=`0${r}`),`#${e}${t}${n}${r}`}return`#${e}${t}${n}`},dt.prototype.toBytes=function(e){const t=dt.floatToByte(this.red),n=dt.floatToByte(this.green),r=dt.floatToByte(this.blue),o=dt.floatToByte(this.alpha);return w(e)?(e[0]=t,e[1]=n,e[2]=r,e[3]=o,e):[t,n,r,o]},dt.bytesToRgba=function(e,t,n,r){return gt[0]=e,gt[1]=t,gt[2]=n,gt[3]=r,_t[0]},dt.prototype.toRgba=function(){return dt.bytesToRgba(dt.floatToByte(this.red),dt.floatToByte(this.green),dt.floatToByte(this.blue),dt.floatToByte(this.alpha))},dt.prototype.brighten=function(e,t){return O.typeOf.number("magnitude",e),O.typeOf.number.greaterThanOrEquals("magnitude",e,0),O.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},dt.prototype.darken=function(e,t){return O.typeOf.number("magnitude",e),O.typeOf.number.greaterThanOrEquals("magnitude",e,0),O.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},dt.prototype.withAlpha=function(e,t){return dt.fromAlpha(this,e,t)},dt.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n},dt.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n},dt.multiply=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n},dt.divide=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n},dt.mod=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n},dt.lerp=function(e,t,n,r){return O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r),r.red=v.lerp(e.red,t.red,n),r.green=v.lerp(e.green,t.green,n),r.blue=v.lerp(e.blue,t.blue,n),r.alpha=v.lerp(e.alpha,t.alpha,n),r},dt.multiplyByScalar=function(e,t,n){return O.typeOf.object("color",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n},dt.divideByScalar=function(e,t,n){return O.typeOf.object("color",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n},dt.ALICEBLUE=Object.freeze(dt.fromCssColorString("#F0F8FF")),dt.ANTIQUEWHITE=Object.freeze(dt.fromCssColorString("#FAEBD7")),dt.AQUA=Object.freeze(dt.fromCssColorString("#00FFFF")),dt.AQUAMARINE=Object.freeze(dt.fromCssColorString("#7FFFD4")),dt.AZURE=Object.freeze(dt.fromCssColorString("#F0FFFF")),dt.BEIGE=Object.freeze(dt.fromCssColorString("#F5F5DC")),dt.BISQUE=Object.freeze(dt.fromCssColorString("#FFE4C4")),dt.BLACK=Object.freeze(dt.fromCssColorString("#000000")),dt.BLANCHEDALMOND=Object.freeze(dt.fromCssColorString("#FFEBCD")),dt.BLUE=Object.freeze(dt.fromCssColorString("#0000FF")),dt.BLUEVIOLET=Object.freeze(dt.fromCssColorString("#8A2BE2")),dt.BROWN=Object.freeze(dt.fromCssColorString("#A52A2A")),dt.BURLYWOOD=Object.freeze(dt.fromCssColorString("#DEB887")),dt.CADETBLUE=Object.freeze(dt.fromCssColorString("#5F9EA0")),dt.CHARTREUSE=Object.freeze(dt.fromCssColorString("#7FFF00")),dt.CHOCOLATE=Object.freeze(dt.fromCssColorString("#D2691E")),dt.CORAL=Object.freeze(dt.fromCssColorString("#FF7F50")),dt.CORNFLOWERBLUE=Object.freeze(dt.fromCssColorString("#6495ED")),dt.CORNSILK=Object.freeze(dt.fromCssColorString("#FFF8DC")),dt.CRIMSON=Object.freeze(dt.fromCssColorString("#DC143C")),dt.CYAN=Object.freeze(dt.fromCssColorString("#00FFFF")),dt.DARKBLUE=Object.freeze(dt.fromCssColorString("#00008B")),dt.DARKCYAN=Object.freeze(dt.fromCssColorString("#008B8B")),dt.DARKGOLDENROD=Object.freeze(dt.fromCssColorString("#B8860B")),dt.DARKGRAY=Object.freeze(dt.fromCssColorString("#A9A9A9")),dt.DARKGREEN=Object.freeze(dt.fromCssColorString("#006400")),dt.DARKGREY=dt.DARKGRAY,dt.DARKKHAKI=Object.freeze(dt.fromCssColorString("#BDB76B")),dt.DARKMAGENTA=Object.freeze(dt.fromCssColorString("#8B008B")),dt.DARKOLIVEGREEN=Object.freeze(dt.fromCssColorString("#556B2F")),dt.DARKORANGE=Object.freeze(dt.fromCssColorString("#FF8C00")),dt.DARKORCHID=Object.freeze(dt.fromCssColorString("#9932CC")),dt.DARKRED=Object.freeze(dt.fromCssColorString("#8B0000")),dt.DARKSALMON=Object.freeze(dt.fromCssColorString("#E9967A")),dt.DARKSEAGREEN=Object.freeze(dt.fromCssColorString("#8FBC8F")),dt.DARKSLATEBLUE=Object.freeze(dt.fromCssColorString("#483D8B")),dt.DARKSLATEGRAY=Object.freeze(dt.fromCssColorString("#2F4F4F")),dt.DARKSLATEGREY=dt.DARKSLATEGRAY,dt.DARKTURQUOISE=Object.freeze(dt.fromCssColorString("#00CED1")),dt.DARKVIOLET=Object.freeze(dt.fromCssColorString("#9400D3")),dt.DEEPPINK=Object.freeze(dt.fromCssColorString("#FF1493")),dt.DEEPSKYBLUE=Object.freeze(dt.fromCssColorString("#00BFFF")),dt.DIMGRAY=Object.freeze(dt.fromCssColorString("#696969")),dt.DIMGREY=dt.DIMGRAY,dt.DODGERBLUE=Object.freeze(dt.fromCssColorString("#1E90FF")),dt.FIREBRICK=Object.freeze(dt.fromCssColorString("#B22222")),dt.FLORALWHITE=Object.freeze(dt.fromCssColorString("#FFFAF0")),dt.FORESTGREEN=Object.freeze(dt.fromCssColorString("#228B22")),dt.FUCHSIA=Object.freeze(dt.fromCssColorString("#FF00FF")),dt.GAINSBORO=Object.freeze(dt.fromCssColorString("#DCDCDC")),dt.GHOSTWHITE=Object.freeze(dt.fromCssColorString("#F8F8FF")),dt.GOLD=Object.freeze(dt.fromCssColorString("#FFD700")),dt.GOLDENROD=Object.freeze(dt.fromCssColorString("#DAA520")),dt.GRAY=Object.freeze(dt.fromCssColorString("#808080")),dt.GREEN=Object.freeze(dt.fromCssColorString("#008000")),dt.GREENYELLOW=Object.freeze(dt.fromCssColorString("#ADFF2F")),dt.GREY=dt.GRAY,dt.HONEYDEW=Object.freeze(dt.fromCssColorString("#F0FFF0")),dt.HOTPINK=Object.freeze(dt.fromCssColorString("#FF69B4")),dt.INDIANRED=Object.freeze(dt.fromCssColorString("#CD5C5C")),dt.INDIGO=Object.freeze(dt.fromCssColorString("#4B0082")),dt.IVORY=Object.freeze(dt.fromCssColorString("#FFFFF0")),dt.KHAKI=Object.freeze(dt.fromCssColorString("#F0E68C")),dt.LAVENDER=Object.freeze(dt.fromCssColorString("#E6E6FA")),dt.LAVENDAR_BLUSH=Object.freeze(dt.fromCssColorString("#FFF0F5")),dt.LAWNGREEN=Object.freeze(dt.fromCssColorString("#7CFC00")),dt.LEMONCHIFFON=Object.freeze(dt.fromCssColorString("#FFFACD")),dt.LIGHTBLUE=Object.freeze(dt.fromCssColorString("#ADD8E6")),dt.LIGHTCORAL=Object.freeze(dt.fromCssColorString("#F08080")),dt.LIGHTCYAN=Object.freeze(dt.fromCssColorString("#E0FFFF")),dt.LIGHTGOLDENRODYELLOW=Object.freeze(dt.fromCssColorString("#FAFAD2")),dt.LIGHTGRAY=Object.freeze(dt.fromCssColorString("#D3D3D3")),dt.LIGHTGREEN=Object.freeze(dt.fromCssColorString("#90EE90")),dt.LIGHTGREY=dt.LIGHTGRAY,dt.LIGHTPINK=Object.freeze(dt.fromCssColorString("#FFB6C1")),dt.LIGHTSEAGREEN=Object.freeze(dt.fromCssColorString("#20B2AA")),dt.LIGHTSKYBLUE=Object.freeze(dt.fromCssColorString("#87CEFA")),dt.LIGHTSLATEGRAY=Object.freeze(dt.fromCssColorString("#778899")),dt.LIGHTSLATEGREY=dt.LIGHTSLATEGRAY,dt.LIGHTSTEELBLUE=Object.freeze(dt.fromCssColorString("#B0C4DE")),dt.LIGHTYELLOW=Object.freeze(dt.fromCssColorString("#FFFFE0")),dt.LIME=Object.freeze(dt.fromCssColorString("#00FF00")),dt.LIMEGREEN=Object.freeze(dt.fromCssColorString("#32CD32")),dt.LINEN=Object.freeze(dt.fromCssColorString("#FAF0E6")),dt.MAGENTA=Object.freeze(dt.fromCssColorString("#FF00FF")),dt.MAROON=Object.freeze(dt.fromCssColorString("#800000")),dt.MEDIUMAQUAMARINE=Object.freeze(dt.fromCssColorString("#66CDAA")),dt.MEDIUMBLUE=Object.freeze(dt.fromCssColorString("#0000CD")),dt.MEDIUMORCHID=Object.freeze(dt.fromCssColorString("#BA55D3")),dt.MEDIUMPURPLE=Object.freeze(dt.fromCssColorString("#9370DB")),dt.MEDIUMSEAGREEN=Object.freeze(dt.fromCssColorString("#3CB371")),dt.MEDIUMSLATEBLUE=Object.freeze(dt.fromCssColorString("#7B68EE")),dt.MEDIUMSPRINGGREEN=Object.freeze(dt.fromCssColorString("#00FA9A")),dt.MEDIUMTURQUOISE=Object.freeze(dt.fromCssColorString("#48D1CC")),dt.MEDIUMVIOLETRED=Object.freeze(dt.fromCssColorString("#C71585")),dt.MIDNIGHTBLUE=Object.freeze(dt.fromCssColorString("#191970")),dt.MINTCREAM=Object.freeze(dt.fromCssColorString("#F5FFFA")),dt.MISTYROSE=Object.freeze(dt.fromCssColorString("#FFE4E1")),dt.MOCCASIN=Object.freeze(dt.fromCssColorString("#FFE4B5")),dt.NAVAJOWHITE=Object.freeze(dt.fromCssColorString("#FFDEAD")),dt.NAVY=Object.freeze(dt.fromCssColorString("#000080")),dt.OLDLACE=Object.freeze(dt.fromCssColorString("#FDF5E6")),dt.OLIVE=Object.freeze(dt.fromCssColorString("#808000")),dt.OLIVEDRAB=Object.freeze(dt.fromCssColorString("#6B8E23")),dt.ORANGE=Object.freeze(dt.fromCssColorString("#FFA500")),dt.ORANGERED=Object.freeze(dt.fromCssColorString("#FF4500")),dt.ORCHID=Object.freeze(dt.fromCssColorString("#DA70D6")),dt.PALEGOLDENROD=Object.freeze(dt.fromCssColorString("#EEE8AA")),dt.PALEGREEN=Object.freeze(dt.fromCssColorString("#98FB98")),dt.PALETURQUOISE=Object.freeze(dt.fromCssColorString("#AFEEEE")),dt.PALEVIOLETRED=Object.freeze(dt.fromCssColorString("#DB7093")),dt.PAPAYAWHIP=Object.freeze(dt.fromCssColorString("#FFEFD5")),dt.PEACHPUFF=Object.freeze(dt.fromCssColorString("#FFDAB9")),dt.PERU=Object.freeze(dt.fromCssColorString("#CD853F")),dt.PINK=Object.freeze(dt.fromCssColorString("#FFC0CB")),dt.PLUM=Object.freeze(dt.fromCssColorString("#DDA0DD")),dt.POWDERBLUE=Object.freeze(dt.fromCssColorString("#B0E0E6")),dt.PURPLE=Object.freeze(dt.fromCssColorString("#800080")),dt.RED=Object.freeze(dt.fromCssColorString("#FF0000")),dt.ROSYBROWN=Object.freeze(dt.fromCssColorString("#BC8F8F")),dt.ROYALBLUE=Object.freeze(dt.fromCssColorString("#4169E1")),dt.SADDLEBROWN=Object.freeze(dt.fromCssColorString("#8B4513")),dt.SALMON=Object.freeze(dt.fromCssColorString("#FA8072")),dt.SANDYBROWN=Object.freeze(dt.fromCssColorString("#F4A460")),dt.SEAGREEN=Object.freeze(dt.fromCssColorString("#2E8B57")),dt.SEASHELL=Object.freeze(dt.fromCssColorString("#FFF5EE")),dt.SIENNA=Object.freeze(dt.fromCssColorString("#A0522D")),dt.SILVER=Object.freeze(dt.fromCssColorString("#C0C0C0")),dt.SKYBLUE=Object.freeze(dt.fromCssColorString("#87CEEB")),dt.SLATEBLUE=Object.freeze(dt.fromCssColorString("#6A5ACD")),dt.SLATEGRAY=Object.freeze(dt.fromCssColorString("#708090")),dt.SLATEGREY=dt.SLATEGRAY,dt.SNOW=Object.freeze(dt.fromCssColorString("#FFFAFA")),dt.SPRINGGREEN=Object.freeze(dt.fromCssColorString("#00FF7F")),dt.STEELBLUE=Object.freeze(dt.fromCssColorString("#4682B4")),dt.TAN=Object.freeze(dt.fromCssColorString("#D2B48C")),dt.TEAL=Object.freeze(dt.fromCssColorString("#008080")),dt.THISTLE=Object.freeze(dt.fromCssColorString("#D8BFD8")),dt.TOMATO=Object.freeze(dt.fromCssColorString("#FF6347")),dt.TURQUOISE=Object.freeze(dt.fromCssColorString("#40E0D0")),dt.VIOLET=Object.freeze(dt.fromCssColorString("#EE82EE")),dt.WHEAT=Object.freeze(dt.fromCssColorString("#F5DEB3")),dt.WHITE=Object.freeze(dt.fromCssColorString("#FFFFFF")),dt.WHITESMOKE=Object.freeze(dt.fromCssColorString("#F5F5F5")),dt.YELLOW=Object.freeze(dt.fromCssColorString("#FFFF00")),dt.YELLOWGREEN=Object.freeze(dt.fromCssColorString("#9ACD32")),dt.TRANSPARENT=Object.freeze(new dt(0,0,0,0)),Ot.fromElements=function(e,t,n){return w(n)?(n.x=e,n.y=t,n):new Ot(e,t)},Ot.clone=function(e,t){if(w(e))return w(t)?(t.x=e.x,t.y=e.y,t):new Ot(e.x,e.y)},Ot.fromCartesian3=Ot.clone,Ot.fromCartesian4=Ot.clone,Ot.packedLength=2,Ot.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.x,t[n]=e.y,t},Ot.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new Ot),n.x=e[t++],n.y=e[t],n},Ot.packArray=function(e,t){O.defined("array",e);const n=e.length,r=2*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 2 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)Ot.pack(e[o],t,2*o);return t},Ot.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,2),e.length%2!=0)throw new T("array length must be a multiple of 2.");const n=e.length;w(t)?t.length=n/2:t=new Array(n/2);for(let r=0;r<n;r+=2){const n=r/2;t[n]=Ot.unpack(e,r,t[n])}return t},Ot.fromArray=Ot.unpack,Ot.maximumComponent=function(e){return O.typeOf.object("cartesian",e),Math.max(e.x,e.y)},Ot.minimumComponent=function(e){return O.typeOf.object("cartesian",e),Math.min(e.x,e.y)},Ot.minimumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n},Ot.maximumByComponent=function(e,t,n){return O.typeOf.object("first",e),O.typeOf.object("second",t),O.typeOf.object("result",n),n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n},Ot.clamp=function(e,t,n,r){O.typeOf.object("value",e),O.typeOf.object("min",t),O.typeOf.object("max",n),O.typeOf.object("result",r);const o=v.clamp(e.x,t.x,n.x),i=v.clamp(e.y,t.y,n.y);return r.x=o,r.y=i,r},Ot.magnitudeSquared=function(e){return O.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},Ot.magnitude=function(e){return Math.sqrt(Ot.magnitudeSquared(e))};const At=new Ot;Ot.distance=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),Ot.subtract(e,t,At),Ot.magnitude(At)},Ot.distanceSquared=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),Ot.subtract(e,t,At),Ot.magnitudeSquared(At)},Ot.normalize=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=Ot.magnitude(e);if(t.x=e.x/n,t.y=e.y/n,isNaN(t.x)||isNaN(t.y))throw new T("normalized result is not a number");return t},Ot.dot=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.x*t.x+e.y*t.y},Ot.cross=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.x*t.y-e.y*t.x},Ot.multiplyComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x*t.x,n.y=e.y*t.y,n},Ot.divideComponents=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x/t.x,n.y=e.y/t.y,n},Ot.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n},Ot.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n},Ot.multiplyByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n},Ot.divideByScalar=function(e,t,n){return O.typeOf.object("cartesian",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n},Ot.negate=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},Ot.abs=function(e,t){return O.typeOf.object("cartesian",e),O.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};const xt=new Ot;Ot.lerp=function(e,t,n,r){return O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r),Ot.multiplyByScalar(t,n,xt),r=Ot.multiplyByScalar(e,1-n,r),Ot.add(xt,r,r)};const Rt=new Ot,St=new Ot;Ot.angleBetween=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),Ot.normalize(e,Rt),Ot.normalize(t,St),v.acosClamped(Ot.dot(Rt,St))};const It=new Ot;Ot.mostOrthogonalAxis=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=Ot.normalize(e,It);return Ot.abs(n,n),n.x<=n.y?Ot.clone(Ot.UNIT_X,t):Ot.clone(Ot.UNIT_Y,t)},Ot.equals=function(e,t){return e===t||w(e)&&w(t)&&e.x===t.x&&e.y===t.y},Ot.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},Ot.equalsEpsilon=function(e,t,n,r){return e===t||w(e)&&w(t)&&v.equalsEpsilon(e.x,t.x,n,r)&&v.equalsEpsilon(e.y,t.y,n,r)},Ot.ZERO=Object.freeze(new Ot(0,0)),Ot.ONE=Object.freeze(new Ot(1,1)),Ot.UNIT_X=Object.freeze(new Ot(1,0)),Ot.UNIT_Y=Object.freeze(new Ot(0,1)),Ot.prototype.clone=function(e){return Ot.clone(this,e)},Ot.prototype.equals=function(e){return Ot.equals(this,e)},Ot.prototype.equalsEpsilon=function(e,t,n){return Ot.equalsEpsilon(this,e,t,n)},Ot.prototype.toString=function(){return`(${this.x}, ${this.y})`};const Ct=new L,Nt=new L;function vt(e,t,n,r,o){if(!w(e))throw new T("cartesian is required.");if(!w(t))throw new T("oneOverRadii is required.");if(!w(n))throw new T("oneOverRadiiSquared is required.");if(!w(r))throw new T("centerToleranceSquared is required.");const i=e.x,a=e.y,s=e.z,u=t.x,c=t.y,l=t.z,f=i*i*u*u,h=a*a*c*c,p=s*s*l*l,m=f+h+p,d=Math.sqrt(1/m),y=L.multiplyByScalar(e,d,Ct);if(m<r)return isFinite(d)?L.clone(y,o):void 0;const _=n.x,g=n.y,E=n.z,b=Nt;b.x=y.x*_*2,b.y=y.y*g*2,b.z=y.z*E*2;let O,A,x,R,S,I,C,N,P,M,F,D=(1-d)*L.magnitude(e)/(.5*L.magnitude(b)),z=0;do{D-=z,x=1/(1+D*_),R=1/(1+D*g),S=1/(1+D*E),I=x*x,C=R*R,N=S*S,P=I*x,M=C*R,F=N*S,O=f*I+h*C+p*N-1,A=f*P*_+h*M*g+p*F*E,z=O/(-2*A)}while(Math.abs(O)>v.EPSILON12);return w(o)?(o.x=i*x,o.y=a*R,o.z=s*S,o):new L(i*x,a*R,s*S)}function Pt(e,t,n){this.longitude=e??0,this.latitude=t??0,this.height=n??0}Pt.fromRadians=function(e,t,n,r){return O.typeOf.number("longitude",e),O.typeOf.number("latitude",t),n=n??0,w(r)?(r.longitude=e,r.latitude=t,r.height=n,r):new Pt(e,t,n)},Pt.fromDegrees=function(e,t,n,r){return O.typeOf.number("longitude",e),O.typeOf.number("latitude",t),e=v.toRadians(e),t=v.toRadians(t),Pt.fromRadians(e,t,n,r)};const Mt=new L,Lt=new L,Ft=new L;function Dt(e,t,n,r){t=t??0,n=n??0,r=r??0,O.typeOf.number.greaterThanOrEquals("x",t,0),O.typeOf.number.greaterThanOrEquals("y",n,0),O.typeOf.number.greaterThanOrEquals("z",r,0),e._radii=new L(t,n,r),e._radiiSquared=new L(t*t,n*n,r*r),e._radiiToTheFourth=new L(t*t*t*t,n*n*n*n,r*r*r*r),e._oneOverRadii=new L(0===t?0:1/t,0===n?0:1/n,0===r?0:1/r),e._oneOverRadiiSquared=new L(0===t?0:1/(t*t),0===n?0:1/(n*n),0===r?0:1/(r*r)),e._minimumRadius=Math.min(t,n,r),e._maximumRadius=Math.max(t,n,r),e._centerToleranceSquared=v.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function zt(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,Dt(this,e,t,n)}Pt._ellipsoidOneOverRadii=new L(1/6378137,1/6378137,1/6356752.314245179),Pt._ellipsoidOneOverRadiiSquared=new L(1/40680631590769,1/40680631590769,1/40408299984661.445),Pt._ellipsoidCenterToleranceSquared=v.EPSILON1,Pt.fromCartesian=function(e,t,n){const r=w(t)?t.oneOverRadii:Pt._ellipsoidOneOverRadii,o=w(t)?t.oneOverRadiiSquared:Pt._ellipsoidOneOverRadiiSquared,i=vt(e,r,o,w(t)?t._centerToleranceSquared:Pt._ellipsoidCenterToleranceSquared,Lt);if(!w(i))return;let a=L.multiplyComponents(i,o,Mt);a=L.normalize(a,a);const s=L.subtract(e,i,Ft),u=Math.atan2(a.y,a.x),c=Math.asin(a.z),l=v.sign(L.dot(s,e))*L.magnitude(s);return w(n)?(n.longitude=u,n.latitude=c,n.height=l,n):new Pt(u,c,l)},Pt.toCartesian=function(e,t,n){return O.defined("cartographic",e),L.fromRadians(e.longitude,e.latitude,e.height,t,n)},Pt.clone=function(e,t){if(w(e))return w(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new Pt(e.longitude,e.latitude,e.height)},Pt.equals=function(e,t){return e===t||w(e)&&w(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},Pt.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e.longitude-t.longitude)<=n&&Math.abs(e.latitude-t.latitude)<=n&&Math.abs(e.height-t.height)<=n},Pt.ZERO=Object.freeze(new Pt(0,0,0)),Pt.prototype.clone=function(e){return Pt.clone(this,e)},Pt.prototype.equals=function(e){return Pt.equals(this,e)},Pt.prototype.equalsEpsilon=function(e,t){return Pt.equalsEpsilon(this,e,t)},Pt.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`},Object.defineProperties(zt.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),zt.clone=function(e,t){if(!w(e))return;const n=e._radii;return w(t)?(L.clone(n,t._radii),L.clone(e._radiiSquared,t._radiiSquared),L.clone(e._radiiToTheFourth,t._radiiToTheFourth),L.clone(e._oneOverRadii,t._oneOverRadii),L.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new zt(n.x,n.y,n.z)},zt.fromCartesian3=function(e,t){return w(t)||(t=new zt),w(e)?(Dt(t,e.x,e.y,e.z),t):t},zt.WGS84=Object.freeze(new zt(6378137,6378137,6356752.314245179)),zt.UNIT_SPHERE=Object.freeze(new zt(1,1,1)),zt.MOON=Object.freeze(new zt(v.LUNAR_RADIUS,v.LUNAR_RADIUS,v.LUNAR_RADIUS)),zt.MARS=Object.freeze(new zt(3396190,3396190,3376200)),zt._default=zt.WGS84,Object.defineProperties(zt,{default:{get:function(){return zt._default},set:function(e){O.typeOf.object("value",e),zt._default=e,L._ellipsoidRadiiSquared=e.radiiSquared,Pt._ellipsoidOneOverRadii=e.oneOverRadii,Pt._ellipsoidOneOverRadiiSquared=e.oneOverRadiiSquared,Pt._ellipsoidCenterToleranceSquared=e._centerToleranceSquared}}}),zt.prototype.clone=function(e){return zt.clone(this,e)},zt.packedLength=L.packedLength,zt.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,L.pack(e._radii,t,n),t},zt.unpack=function(e,t,n){O.defined("array",e),t=t??0;const r=L.unpack(e,t);return zt.fromCartesian3(r,n)},zt.prototype.geocentricSurfaceNormal=L.normalize,zt.prototype.geodeticSurfaceNormalCartographic=function(e,t){O.typeOf.object("cartographic",e);const n=e.longitude,r=e.latitude,o=Math.cos(r),i=o*Math.cos(n),a=o*Math.sin(n),s=Math.sin(r);return w(t)||(t=new L),t.x=i,t.y=a,t.z=s,L.normalize(t,t)},zt.prototype.geodeticSurfaceNormal=function(e,t){if(O.typeOf.object("cartesian",e),isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new T("cartesian has a NaN component");if(!L.equalsEpsilon(e,L.ZERO,v.EPSILON14))return w(t)||(t=new L),t=L.multiplyComponents(e,this._oneOverRadiiSquared,t),L.normalize(t,t)};const Bt=new L,Ut=new L;zt.prototype.cartographicToCartesian=function(e,t){const n=Bt,r=Ut;this.geodeticSurfaceNormalCartographic(e,n),L.multiplyComponents(this._radiiSquared,n,r);const o=Math.sqrt(L.dot(n,r));return L.divideByScalar(r,o,r),L.multiplyByScalar(n,e.height,n),w(t)||(t=new L),L.add(r,n,t)},zt.prototype.cartographicArrayToCartesianArray=function(e,t){O.defined("cartographics",e);const n=e.length;w(t)?t.length=n:t=new Array(n);for(let r=0;r<n;r++)t[r]=this.cartographicToCartesian(e[r],t[r]);return t};const jt=new L,qt=new L,Gt=new L;zt.prototype.cartesianToCartographic=function(e,t){const n=this.scaleToGeodeticSurface(e,qt);if(!w(n))return;const r=this.geodeticSurfaceNormal(n,jt),o=L.subtract(e,n,Gt),i=Math.atan2(r.y,r.x),a=Math.asin(r.z),s=v.sign(L.dot(o,e))*L.magnitude(o);return w(t)?(t.longitude=i,t.latitude=a,t.height=s,t):new Pt(i,a,s)},zt.prototype.cartesianArrayToCartographicArray=function(e,t){O.defined("cartesians",e);const n=e.length;w(t)?t.length=n:t=new Array(n);for(let r=0;r<n;++r)t[r]=this.cartesianToCartographic(e[r],t[r]);return t},zt.prototype.scaleToGeodeticSurface=function(e,t){return vt(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},zt.prototype.scaleToGeocentricSurface=function(e,t){O.typeOf.object("cartesian",e),w(t)||(t=new L);const n=e.x,r=e.y,o=e.z,i=this._oneOverRadiiSquared,a=1/Math.sqrt(n*n*i.x+r*r*i.y+o*o*i.z);return L.multiplyByScalar(e,a,t)},zt.prototype.transformPositionToScaledSpace=function(e,t){return w(t)||(t=new L),L.multiplyComponents(e,this._oneOverRadii,t)},zt.prototype.transformPositionFromScaledSpace=function(e,t){return w(t)||(t=new L),L.multiplyComponents(e,this._radii,t)},zt.prototype.equals=function(e){return this===e||w(e)&&L.equals(this._radii,e._radii)},zt.prototype.toString=function(){return this._radii.toString()},zt.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,n){if(O.typeOf.object("position",e),!v.equalsEpsilon(this._radii.x,this._radii.y,v.EPSILON15))throw new T("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");O.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=t??0;const r=this._squaredXOverSquaredZ;if(w(n)||(n=new L),n.x=0,n.y=0,n.z=e.z*(1-r),!(Math.abs(n.z)>=this._radii.z-t))return n};const kt=new L;zt.prototype.getLocalCurvature=function(e,t){O.typeOf.object("surfacePosition",e),w(t)||(t=new Ot);const n=this.getSurfaceNormalIntersectionWithZAxis(e,0,kt),r=L.distance(e,n),o=r*(this.minimumRadius*r/this.maximumRadius**2)**2;return Ot.fromElements(1/r,1/o,t)};const Wt=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],Vt=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function Ht(e,t,n){O.typeOf.number("a",e),O.typeOf.number("b",t),O.typeOf.func("func",n);const r=.5*(t+e),o=.5*(t-e);let i=0;for(let a=0;a<5;a++){const e=o*Wt[a];i+=Vt[a]*(n(r+e)+n(r-e))}return i*=o,i}function Yt(e){this._ellipsoid=e??zt.default,this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}zt.prototype.surfaceArea=function(e){O.typeOf.object("rectangle",e);const t=e.west;let n=e.east;const r=e.south,o=e.north;for(;n<t;)n+=v.TWO_PI;const i=this._radiiSquared,a=i.x,s=i.y,u=i.z,c=a*s;return Ht(r,o,function(e){const r=Math.cos(e),o=Math.sin(e);return Math.cos(e)*Ht(t,n,function(e){const t=Math.cos(e),n=Math.sin(e);return Math.sqrt(c*o*o+u*(s*t*t+a*n*n)*r*r)})})},Object.defineProperties(Yt.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),Yt.prototype.project=function(e,t){const n=this._semimajorAxis,r=e.longitude*n,o=e.latitude*n,i=e.height;return w(t)?(t.x=r,t.y=o,t.z=i,t):new L(r,o,i)},Yt.prototype.unproject=function(e,t){if(!w(e))throw new T("cartesian is required");const n=this._oneOverSemimajorAxis,r=e.x*n,o=e.y*n,i=e.z;return w(t)?(t.longitude=r,t.latitude=o,t.height=i,t):new Pt(r,o,i)};var Xt=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function $t(e,t,n){O.defined("array",e),O.defined("itemToFind",t),O.defined("comparator",n);let r,o,i=0,a=e.length-1;for(;i<=a;)if(r=~~((i+a)/2),o=n(e[r],t),o<0)i=r+1;else{if(!(o>0))return r;a=r-1}return~(a+1)}function Kt(e,t,n,r,o){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=o}function Zt(e){if(null===e||isNaN(e))throw new T("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}const Qt=[31,28,31,30,31,30,31,31,30,31,30,31];function Jt(e,t,n,r,o,i,a,s){e=e??1,t=t??1,n=n??1,r=r??0,o=o??0,i=i??0,a=a??0,s=s??!1,O.typeOf.number.greaterThanOrEquals("Year",e,1),O.typeOf.number.lessThanOrEquals("Year",e,9999),O.typeOf.number.greaterThanOrEquals("Month",t,1),O.typeOf.number.lessThanOrEquals("Month",t,12),O.typeOf.number.greaterThanOrEquals("Day",n,1),O.typeOf.number.lessThanOrEquals("Day",n,31),O.typeOf.number.greaterThanOrEquals("Hour",r,0),O.typeOf.number.lessThanOrEquals("Hour",r,23),O.typeOf.number.greaterThanOrEquals("Minute",o,0),O.typeOf.number.lessThanOrEquals("Minute",o,59),O.typeOf.bool("IsLeapSecond",s),O.typeOf.number.greaterThanOrEquals("Second",i,0),O.typeOf.number.lessThanOrEquals("Second",i,s?60:59),O.typeOf.number.greaterThanOrEquals("Millisecond",a,0),O.typeOf.number.lessThan("Millisecond",a,1e3),function(){const r=2===t&&Zt(e)?Qt[t-1]+1:Qt[t-1];if(n>r)throw new T("Month and Day represents invalid date")}(),this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=o,this.second=i,this.millisecond=a,this.isLeapSecond=s}function en(e,t){this.julianDate=e,this.offset=t}var tn=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),nn=Object.freeze({UTC:0,TAI:1});const rn=new Jt,on=[31,28,31,30,31,30,31,31,30,31,30,31];function an(e,t){return Tn.compare(e.julianDate,t.julianDate)}const sn=new en;function un(e){sn.julianDate=e;const t=Tn.leapSeconds;let n=$t(t,sn,an);n<0&&(n=~n),n>=t.length&&(n=t.length-1);let r=t[n].offset;n>0&&Tn.secondsDifference(t[n].julianDate,e)>r&&(n--,r=t[n].offset),Tn.addSeconds(e,r,e)}function cn(e,t){sn.julianDate=e;const n=Tn.leapSeconds;let r=$t(n,sn,an);if(r<0&&(r=~r),0===r)return Tn.addSeconds(e,-n[0].offset,t);if(r>=n.length)return Tn.addSeconds(e,-n[r-1].offset,t);const o=Tn.secondsDifference(n[r].julianDate,e);return 0===o?Tn.addSeconds(e,-n[r].offset,t):o<=1?void 0:Tn.addSeconds(e,-n[--r].offset,t)}function ln(e,t,n){const r=t/tn.SECONDS_PER_DAY|0;return e+=r,(t-=tn.SECONDS_PER_DAY*r)<0&&(e--,t+=tn.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function fn(e,t,n,r,o,i,a){const s=(t-14)/12|0,u=e+4800+s;let c=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);const l=i+(r*tn.SECONDS_PER_HOUR+o*tn.SECONDS_PER_MINUTE+a*tn.SECONDS_PER_MILLISECOND);return l>=43200&&(c-=1),[c,l]}const hn=/^(\d{4})$/,pn=/^(\d{4})-(\d{2})$/,mn=/^(\d{4})-?(\d{3})$/,dn=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,yn=/^(\d{4})-?(\d{2})-?(\d{2})$/,_n=/([Z+\-])?(\d{2})?:?(\d{2})?$/,gn=/^(\d{2})(\.\d+)?/.source+_n.source,En=/^(\d{2}):?(\d{2})(\.\d+)?/.source+_n.source,bn=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+_n.source,wn="Invalid ISO 8601 date.";function Tn(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=e??0,t=t??0,n=n??nn.UTC;const r=0|e;ln(r,t+=(e-r)*tn.SECONDS_PER_DAY,this),n===nn.UTC&&un(this)}Tn.fromGregorianDate=function(e,t){if(!(e instanceof Jt))throw new T("date must be a valid GregorianDate.");const n=fn(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return w(t)?(ln(n[0],n[1],t),un(t),t):new Tn(n[0],n[1],nn.UTC)},Tn.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new T("date must be a valid JavaScript Date.");const n=fn(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return w(t)?(ln(n[0],n[1],t),un(t),t):new Tn(n[0],n[1],nn.UTC)},Tn.fromIso8601=function(e,t){if("string"!=typeof e)throw new T(wn);let n,r=(e=e.replace(",",".")).split("T"),o=1,i=1,a=0,s=0,u=0,c=0;const l=r[0],f=r[1];let h,p,m,d;if(!w(l))throw new T(wn);if(r=l.match(yn),null!==r){if(m=l.split("-").length-1,m>0&&2!==m)throw new T(wn);n=+r[1],o=+r[2],i=+r[3]}else if(r=l.match(pn),null!==r)n=+r[1],o=+r[2];else if(r=l.match(hn),null!==r)n=+r[1];else{let e;if(r=l.match(mn),null!==r){if(n=+r[1],e=+r[2],p=Zt(n),e<1||p&&e>366||!p&&e>365)throw new T(wn)}else{if(r=l.match(dn),null===r)throw new T(wn);{n=+r[1];const t=+r[2],o=+r[3]||0;if(m=l.split("-").length-1,m>0&&(!w(r[3])&&1!==m||w(r[3])&&2!==m))throw new T(wn);e=7*t+o-new Date(Date.UTC(n,0,4)).getUTCDay()-3}}h=new Date(Date.UTC(n,0,1)),h.setUTCDate(e),o=h.getUTCMonth()+1,i=h.getUTCDate()}if(p=Zt(n),o<1||o>12||i<1||(2!==o||!p)&&i>on[o-1]||p&&2===o&&i>29)throw new T(wn);if(w(f)){if(r=f.match(bn),null!==r){if(m=f.split(":").length-1,m>0&&2!==m&&3!==m)throw new T(wn);a=+r[1],s=+r[2],u=+r[3],c=1e3*+(r[4]||0),d=5}else if(r=f.match(En),null!==r){if(m=f.split(":").length-1,m>2)throw new T(wn);a=+r[1],s=+r[2],u=60*+(r[3]||0),d=4}else{if(r=f.match(gn),null===r)throw new T(wn);a=+r[1],s=60*+(r[2]||0),d=3}if(s>=60||u>=61||a>24||24===a&&(s>0||u>0||c>0))throw new T(wn);const e=r[d],t=+r[d+1],l=+(r[d+2]||0);switch(e){case"+":a-=t,s-=l;break;case"-":a+=t,s+=l;break;case"Z":break;default:s+=new Date(Date.UTC(n,o-1,i,a,s)).getTimezoneOffset()}}const y=60===u;for(y&&u--;s>=60;)s-=60,a++;for(;a>=24;)a-=24,i++;for(h=p&&2===o?29:on[o-1];i>h;)i-=h,o++,o>12&&(o-=12,n++),h=p&&2===o?29:on[o-1];for(;s<0;)s+=60,a--;for(;a<0;)a+=24,i--;for(;i<1;)o--,o<1&&(o+=12,n--),h=p&&2===o?29:on[o-1],i+=h;const _=fn(n,o,i,a,s,u,c);return w(t)?(ln(_[0],_[1],t),un(t)):t=new Tn(_[0],_[1],nn.UTC),y&&Tn.addSeconds(t,1,t),t},Tn.now=function(e){return Tn.fromDate(new Date,e)};const On=new Tn(0,0,nn.TAI);Tn.toGregorianDate=function(e,t){if(!w(e))throw new T("julianDate is required.");let n=!1,r=cn(e,On);w(r)||(Tn.addSeconds(e,-1,On),r=cn(On,On),n=!0);let o=r.dayNumber;const i=r.secondsOfDay;i>=43200&&(o+=1);let a=o+68569|0;const s=4*a/146097|0;a=a-((146097*s+3)/4|0)|0;const u=4e3*(a+1)/1461001|0;a=a-(1461*u/4|0)+31|0;const c=80*a/2447|0,l=a-(2447*c/80|0)|0;a=c/11|0;const f=c+2-12*a|0,h=100*(s-49)+u+a|0;let p=i/tn.SECONDS_PER_HOUR|0,m=i-p*tn.SECONDS_PER_HOUR;const d=m/tn.SECONDS_PER_MINUTE|0;m-=d*tn.SECONDS_PER_MINUTE;let y=0|m;const _=(m-y)/tn.SECONDS_PER_MILLISECOND;return p+=12,p>23&&(p-=24),n&&(y+=1),w(t)?(t.year=h,t.month=f,t.day=l,t.hour=p,t.minute=d,t.second=y,t.millisecond=_,t.isLeapSecond=n,t):new Jt(h,f,l,p,d,y,_,n)},Tn.toDate=function(e){if(!w(e))throw new T("julianDate is required.");const t=Tn.toGregorianDate(e,rn);let n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},Tn.toIso8601=function(e,t){if(!w(e))throw new T("julianDate is required.");const n=Tn.toGregorianDate(e,rn);let r=n.year,o=n.month,i=n.day,a=n.hour;const s=n.minute,u=n.second,c=n.millisecond;let l;if(1e4===r&&1===o&&1===i&&0===a&&0===s&&0===u&&0===c&&(r=9999,o=12,i=31,a=24),!w(t)&&0!==c){const e=.01*c;return l=e<1e-6?e.toFixed(20).replace(".","").replace(/0+$/,""):e.toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`}return w(t)&&0!==t?(l=(.01*c).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}.${l}Z`):`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}Z`},Tn.clone=function(e,t){if(w(e))return w(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Tn(e.dayNumber,e.secondsOfDay,nn.TAI)},Tn.compare=function(e,t){if(!w(e))throw new T("left is required.");if(!w(t))throw new T("right is required.");const n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},Tn.equals=function(e,t){return e===t||w(e)&&w(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},Tn.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(Tn.secondsDifference(e,t))<=n},Tn.totalDays=function(e){if(!w(e))throw new T("julianDate is required.");return e.dayNumber+e.secondsOfDay/tn.SECONDS_PER_DAY},Tn.secondsDifference=function(e,t){if(!w(e))throw new T("left is required.");if(!w(t))throw new T("right is required.");return(e.dayNumber-t.dayNumber)*tn.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},Tn.daysDifference=function(e,t){if(!w(e))throw new T("left is required.");if(!w(t))throw new T("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/tn.SECONDS_PER_DAY},Tn.computeTaiMinusUtc=function(e){sn.julianDate=e;const t=Tn.leapSeconds;let n=$t(t,sn,an);return n<0&&(n=~n,--n,n<0&&(n=0)),t[n].offset},Tn.addSeconds=function(e,t,n){if(!w(e))throw new T("julianDate is required.");if(!w(t))throw new T("seconds is required.");if(!w(n))throw new T("result is required.");return ln(e.dayNumber,e.secondsOfDay+t,n)},Tn.addMinutes=function(e,t,n){if(!w(e))throw new T("julianDate is required.");if(!w(t))throw new T("minutes is required.");if(!w(n))throw new T("result is required.");const r=e.secondsOfDay+t*tn.SECONDS_PER_MINUTE;return ln(e.dayNumber,r,n)},Tn.addHours=function(e,t,n){if(!w(e))throw new T("julianDate is required.");if(!w(t))throw new T("hours is required.");if(!w(n))throw new T("result is required.");const r=e.secondsOfDay+t*tn.SECONDS_PER_HOUR;return ln(e.dayNumber,r,n)},Tn.addDays=function(e,t,n){if(!w(e))throw new T("julianDate is required.");if(!w(t))throw new T("days is required.");if(!w(n))throw new T("result is required.");return ln(e.dayNumber+t,e.secondsOfDay,n)},Tn.lessThan=function(e,t){return Tn.compare(e,t)<0},Tn.lessThanOrEquals=function(e,t){return Tn.compare(e,t)<=0},Tn.greaterThan=function(e,t){return Tn.compare(e,t)>0},Tn.greaterThanOrEquals=function(e,t){return Tn.compare(e,t)>=0},Tn.prototype.clone=function(e){return Tn.clone(this,e)},Tn.prototype.equals=function(e){return Tn.equals(this,e)},Tn.prototype.equalsEpsilon=function(e,t){return Tn.equalsEpsilon(this,e,t)},Tn.prototype.toString=function(){return Tn.toIso8601(this)},Tn.leapSeconds=[new en(new Tn(2441317,43210,nn.TAI),10),new en(new Tn(2441499,43211,nn.TAI),11),new en(new Tn(2441683,43212,nn.TAI),12),new en(new Tn(2442048,43213,nn.TAI),13),new en(new Tn(2442413,43214,nn.TAI),14),new en(new Tn(2442778,43215,nn.TAI),15),new en(new Tn(2443144,43216,nn.TAI),16),new en(new Tn(2443509,43217,nn.TAI),17),new en(new Tn(2443874,43218,nn.TAI),18),new en(new Tn(2444239,43219,nn.TAI),19),new en(new Tn(2444786,43220,nn.TAI),20),new en(new Tn(2445151,43221,nn.TAI),21),new en(new Tn(2445516,43222,nn.TAI),22),new en(new Tn(2446247,43223,nn.TAI),23),new en(new Tn(2447161,43224,nn.TAI),24),new en(new Tn(2447892,43225,nn.TAI),25),new en(new Tn(2448257,43226,nn.TAI),26),new en(new Tn(2448804,43227,nn.TAI),27),new en(new Tn(2449169,43228,nn.TAI),28),new en(new Tn(2449534,43229,nn.TAI),29),new en(new Tn(2450083,43230,nn.TAI),30),new en(new Tn(2450630,43231,nn.TAI),31),new en(new Tn(2451179,43232,nn.TAI),32),new en(new Tn(2453736,43233,nn.TAI),33),new en(new Tn(2454832,43234,nn.TAI),34),new en(new Tn(2456109,43235,nn.TAI),35),new en(new Tn(2457204,43236,nn.TAI),36),new en(new Tn(2457754,43237,nn.TAI),37)];var An,xn,Rn,Sn,In,Cn,Nn,vn={exports:{}},Pn={exports:{}},Mn=Pn.exports,Ln={exports:{}},Fn=Ln.exports,Dn={exports:{}},zn=Dn.exports,Bn=(Sn||(Sn=1,Cn=vn.exports,Nn=function(e,t,n,r){var o=r&&r.URI;function i(e,t){var n=arguments.length>=1;if(!(this instanceof i))return n?arguments.length>=2?new i(e,t):new i(e):new i;if(void 0===e){if(n)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&n)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}i.version="1.19.11";var a=i.prototype,s=Object.prototype.hasOwnProperty;function u(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function l(e){return"Array"===c(e)}function f(e,t){var n,r,o={};if("RegExp"===c(t))o=null;else if(l(t))for(n=0,r=t.length;n<r;n++)o[t[n]]=!0;else o[t]=!0;for(n=0,r=e.length;n<r;n++)(o&&void 0!==o[e[n]]||!o&&t.test(e[n]))&&(e.splice(n,1),r--,n--);return e}function h(e,t){var n,r;if(l(t)){for(n=0,r=t.length;n<r;n++)if(!h(e,t[n]))return!1;return!0}var o=c(t);for(n=0,r=e.length;n<r;n++)if("RegExp"===o){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function p(e,t){if(!l(e)||!l(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function m(e){return e.replace(/^\/+|\/+$/g,"")}function d(e){return escape(e)}function y(e){return encodeURIComponent(e).replace(/[!'()*]/g,d).replace(/\*/g,"%2A")}i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:i.preventInvalidHostname,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}},i.preventInvalidHostname=!1,i.duplicateQueryParameters=!1,i.escapeQuerySpace=!0,i.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,i.idn_expression=/[^a-z0-9\._-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,i.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},i.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},i.hostProtocols=["http","https"],i.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},i.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return i.domAttributes[t]}},i.encode=y,i.decode=decodeURIComponent,i.iso8859=function(){i.encode=escape,i.decode=unescape},i.unicode=function(){i.encode=y,i.decode=decodeURIComponent},i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},i.encodeQuery=function(e,t){var n=i.encode(e+"");return void 0===t&&(t=i.escapeQuerySpace),t?n.replace(/%20/g,"+"):n},i.decodeQuery=function(e,t){e+="",void 0===t&&(t=i.escapeQuerySpace);try{return i.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,g={encode:"encode",decode:"decode"},E=function(e,t){return function(n){try{return i[t](n+"").replace(i.characters[e][t].expression,function(n){return i.characters[e][t].map[n]})}catch(e){return n}}};for(_ in g)i[_+"PathSegment"]=E("pathname",g[_]),i[_+"UrnPathSegment"]=E("urnpath",g[_]);var b=function(e,t,n){return function(r){var o;o=n?function(e){return i[t](i[n](e))}:i[t];for(var a=(r+"").split(e),s=0,u=a.length;s<u;s++)a[s]=o(a[s]);return a.join(e)}};function w(e){return function(t,n){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!n),this)}}function T(e,t){return function(n,r){return void 0===n?this._parts[e]||"":(null!==n&&(n+="").charAt(0)===t&&(n=n.substring(1)),this._parts[e]=n,this.build(!r),this)}}i.decodePath=b("/","decodePathSegment"),i.decodeUrnPath=b(":","decodeUrnPathSegment"),i.recodePath=b("/","encodePathSegment","decode"),i.recodeUrnPath=b(":","encodeUrnPathSegment","decode"),i.encodeReserved=E("reserved","encode"),i.parse=function(e,t){var n;return t||(t={preventInvalidHostname:i.preventInvalidHostname}),(n=(e=(e=e.replace(i.leading_whitespace_expression,"")).replace(i.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n)),(n=e.indexOf("?"))>-1&&(t.query=e.substring(n+1)||null,e=e.substring(0,n)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=i.parseAuthority(e,t)):(n=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(i.protocol_expression)?t.protocol=void 0:"//"===e.substring(n+1,n+3).replace(/\\/g,"/")?(e=e.substring(n+3),e=i.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0)),t.path=e,t},i.parseHost=function(e,t){e||(e="");var n,r,o=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===o&&(o=e.length),"["===e.charAt(0))n=e.indexOf("]"),t.hostname=e.substring(1,n)||null,t.port=e.substring(n+2,o)||null,"/"===t.port&&(t.port=null);else{var a=e.indexOf(":"),s=e.indexOf("/"),u=e.indexOf(":",a+1);-1!==u&&(-1===s||u<s)?(t.hostname=e.substring(0,o)||null,t.port=null):(r=e.substring(0,o).split(":"),t.hostname=r[0]||null,t.port=r[1]||null)}return t.hostname&&"/"!==e.substring(o).charAt(0)&&(o++,e="/"+e),t.preventInvalidHostname&&i.ensureValidHostname(t.hostname,t.protocol),t.port&&i.ensureValidPort(t.port),e.substring(o)||"/"},i.parseAuthority=function(e,t){return e=i.parseUserinfo(e,t),i.parseHost(e,t)},i.parseUserinfo=function(e,t){var n=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var r,o=e.indexOf("/"),a=e.lastIndexOf("@",o>-1?o:e.length-1);return a>-1&&(-1===o||a<o)?(r=e.substring(0,a).split(":"),t.username=r[0]?i.decode(r[0]):null,r.shift(),t.password=r[0]?i.decode(r.join(":")):null,e=n.substring(a+1)):(t.username=null,t.password=null),e},i.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,o,a={},u=e.split("&"),c=u.length,l=0;l<c;l++)n=u[l].split("="),r=i.decodeQuery(n.shift(),t),o=n.length?i.decodeQuery(n.join("="),t):null,"__proto__"!==r&&(s.call(a,r)?("string"!=typeof a[r]&&null!==a[r]||(a[r]=[a[r]]),a[r].push(o)):a[r]=o);return a},i.build=function(e){var t="",n=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",n=!0),t+=i.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&n&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},i.buildHost=function(e){var t="";return e.hostname?(i.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},i.buildAuthority=function(e){return i.buildUserinfo(e)+i.buildHost(e)},i.buildUserinfo=function(e){var t="";return e.username&&(t+=i.encode(e.username)),e.password&&(t+=":"+i.encode(e.password)),t&&(t+="@"),t},i.buildQuery=function(e,t,n){var r,o,a,u,c="";for(o in e)if("__proto__"!==o&&s.call(e,o))if(l(e[o]))for(r={},a=0,u=e[o].length;a<u;a++)void 0!==e[o][a]&&void 0===r[e[o][a]+""]&&(c+="&"+i.buildQueryParameter(o,e[o][a],n),!0!==t&&(r[e[o][a]+""]=!0));else void 0!==e[o]&&(c+="&"+i.buildQueryParameter(o,e[o],n));return c.substring(1)},i.buildQueryParameter=function(e,t,n){return i.encodeQuery(e,n)+(null!==t?"="+i.encodeQuery(t,n):"")},i.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)s.call(t,r)&&i.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=n);"string"==typeof e[t]&&(e[t]=[e[t]]),l(n)||(n=[n]),e[t]=(e[t]||[]).concat(n)}},i.setQuery=function(e,t,n){if("object"==typeof t)for(var r in t)s.call(t,r)&&i.setQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===n?null:n}},i.removeQuery=function(e,t,n){var r,o,a;if(l(t))for(r=0,o=t.length;r<o;r++)e[t[r]]=void 0;else if("RegExp"===c(t))for(a in e)t.test(a)&&(e[a]=void 0);else if("object"==typeof t)for(a in t)s.call(t,a)&&i.removeQuery(e,a,t[a]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===c(n)?!l(e[t])&&n.test(e[t])?e[t]=void 0:e[t]=f(e[t],n):e[t]!==String(n)||l(n)&&1!==n.length?l(e[t])&&(e[t]=f(e[t],n)):e[t]=void 0:e[t]=void 0}},i.hasQuery=function(e,t,n,r){switch(c(t)){case"String":break;case"RegExp":for(var o in e)if(s.call(e,o)&&t.test(o)&&(void 0===n||i.hasQuery(e,o,n)))return!0;return!1;case"Object":for(var a in t)if(s.call(t,a)&&!i.hasQuery(e,a,t[a]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(n)){case"Undefined":return t in e;case"Boolean":return n===Boolean(l(e[t])?e[t].length:e[t]);case"Function":return!!n(e[t],t,e);case"Array":return!!l(e[t])&&(r?h:p)(e[t],n);case"RegExp":return l(e[t])?!!r&&h(e[t],n):Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return l(e[t])?!!r&&h(e[t],n):e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},i.joinPaths=function(){for(var e=[],t=[],n=0,r=0;r<arguments.length;r++){var o=new i(arguments[r]);e.push(o);for(var a=o.segment(),s=0;s<a.length;s++)"string"==typeof a[s]&&t.push(a[s]),a[s]&&n++}if(!t.length||!n)return new i("");var u=new i("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||u.path("/"+u.path()),u.normalize()},i.commonPath=function(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n++)if(e.charAt(n)!==t.charAt(n)){n--;break}return n<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(n)&&"/"===t.charAt(n)||(n=e.substring(0,n).lastIndexOf("/")),e.substring(0,n+1))},i.withinString=function(e,t,n){n||(n={});var r=n.start||i.findUri.start,o=n.end||i.findUri.end,a=n.trim||i.findUri.trim,s=n.parens||i.findUri.parens,u=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var c=r.exec(e);if(!c)break;var l=c.index;if(n.ignoreHtml){var f=e.slice(Math.max(l-3,0),l);if(f&&u.test(f))continue}for(var h=l+e.slice(l).search(o),p=e.slice(l,h),m=-1;;){var d=s.exec(p);if(!d)break;var y=d.index+d[0].length;m=Math.max(m,y)}if(!((p=m>-1?p.slice(0,m)+p.slice(m).replace(a,""):p.replace(a,"")).length<=c[0].length||n.ignore&&n.ignore.test(p))){var _=t(p,l,h=l+p.length,e);void 0!==_?(_=String(_),e=e.slice(0,l)+_+e.slice(h),r.lastIndex=l+_.length):r.lastIndex=h}}return r.lastIndex=0,e},i.ensureValidHostname=function(t,n){var r=!!t,o=!1;if(!!n&&(o=h(i.hostProtocols,n)),o&&!r)throw new TypeError("Hostname cannot be empty, if protocol is "+n);if(t&&t.match(i.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(i.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},i.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},i.noConflict=function(e){if(e){var t={URI:this.noConflict()};return r.URITemplate&&"function"==typeof r.URITemplate.noConflict&&(t.URITemplate=r.URITemplate.noConflict()),r.IPv6&&"function"==typeof r.IPv6.noConflict&&(t.IPv6=r.IPv6.noConflict()),r.SecondLevelDomains&&"function"==typeof r.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=r.SecondLevelDomains.noConflict()),t}return r.URI===this&&(r.URI=o),this},a.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=i.build(this._parts),this._deferred_build=!1),this},a.clone=function(){return new i(this)},a.valueOf=a.toString=function(){return this.build(!1)._string},a.protocol=w("protocol"),a.username=w("username"),a.password=w("password"),a.hostname=w("hostname"),a.port=w("port"),a.query=T("query","?"),a.fragment=T("fragment","#"),a.search=function(e,t){var n=this.query(e,t);return"string"==typeof n&&n.length?"?"+n:n},a.hash=function(e,t){var n=this.fragment(e,t);return"string"==typeof n&&n.length?"#"+n:n},a.pathname=function(e,t){if(void 0===e||!0===e){var n=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?i.decodeUrnPath:i.decodePath)(n):n}return this._parts.urn?this._parts.path=e?i.recodeUrnPath(e):"":this._parts.path=e?i.recodePath(e):"/",this.build(!t),this},a.path=a.pathname,a.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="",this._parts=i._parts();var r=e instanceof i,o="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[i.getDomAttribute(e)]||"",o=!1),!r&&o&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=i.parse(String(e),this._parts);else{if(!r&&!o)throw new TypeError("invalid input");var a=r?e._parts:e;for(n in a)"query"!==n&&s.call(this._parts,n)&&(this._parts[n]=a[n]);a.query&&this.query(a.query,!1)}return this.build(!t),this},a.is=function(e){var t=!1,r=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,r=i.ip4_expression.test(this._parts.hostname),o=i.ip6_expression.test(this._parts.hostname),s=(a=!(t=r||o))&&n&&n.has(this._parts.hostname),u=a&&i.idn_expression.test(this._parts.hostname),c=a&&i.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return a;case"sld":return s;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return o;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var O=a.protocol,A=a.port,x=a.hostname;a.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(i.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return O.call(this,e,t)},a.scheme=a.protocol,a.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),i.ensureValidPort(e))),A.call(this,e,t))},a.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==i.parseHost(e,n))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=n.hostname,this._parts.preventInvalidHostname&&i.ensureValidHostname(e,this._parts.protocol)}return x.call(this,e,t)},a.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=this.protocol();return this.authority()?(n?n+"://":"")+this.authority():""}var r=i(e);return this.protocol(r.protocol()).authority(r.authority()).build(!t),this},a.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildHost(this._parts):"";if("/"!==i.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},a.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildAuthority(this._parts):"";if("/"!==i.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},a.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var n=i.buildUserinfo(this._parts);return n?n.substring(0,n.length-1):n}return"@"!==e[e.length-1]&&(e+="@"),i.parseUserinfo(e,this._parts),this.build(!t),this},a.resource=function(e,t){var n;return void 0===e?this.path()+this.search()+this.hash():(n=i.parse(e),this._parts.path=n.path,this._parts.query=n.query,this._parts.fragment=n.fragment,this.build(!t),this)},a.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}var r=this._parts.hostname.length-this.domain().length,o=this._parts.hostname.substring(0,r),a=new RegExp("^"+u(o));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&i.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(a,e),this.build(!t),this},a.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&n.length<2)return this._parts.hostname;var r=this._parts.hostname.length-this.tld(t).length-1;return r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(i.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var o=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},a.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),o=this._parts.hostname.substring(r+1);return!0!==t&&n&&n.list[o.toLowerCase()]&&n.get(this._parts.hostname)||o}var i;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");i=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},a.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?i.decodePath(r):r}var o=this._parts.path.length-this.filename().length,a=this._parts.path.substring(0,o),s=new RegExp("^"+u(a));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=i.recodePath(e),this._parts.path=this._parts.path.replace(s,e),this.build(!t),this},a.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(n+1);return e?i.decodePathSegment(r):r}var o=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(o=!0);var a=new RegExp(u(this.filename())+"$");return e=i.recodePath(e),this._parts.path=this._parts.path.replace(a,e),o?this.normalizePath(t):this.build(!t),this},a.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var n,r,o=this.filename(),a=o.lastIndexOf(".");return-1===a?"":(n=o.substring(a+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",e?i.decodePathSegment(r):r)}"."===e.charAt(0)&&(e=e.substring(1));var s,c=this.suffix();if(c)s=e?new RegExp(u(c)+"$"):new RegExp(u("."+c)+"$");else{if(!e)return this;this._parts.path+="."+i.recodePath(e)}return s&&(e=i.recodePath(e),this._parts.path=this._parts.path.replace(s,e)),this.build(!t),this},a.segment=function(e,t,n){var r=this._parts.urn?":":"/",o=this.path(),i="/"===o.substring(0,1),a=o.split(r);if(void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(i&&a.shift(),e<0&&(e=Math.max(a.length+e,0)),void 0===t)return void 0===e?a:a[e];if(null===e||void 0===a[e])if(l(t)){a=[];for(var s=0,u=t.length;s<u;s++)(t[s].length||a.length&&a[a.length-1].length)&&(a.length&&!a[a.length-1].length&&a.pop(),a.push(m(t[s])))}else(t||"string"==typeof t)&&(t=m(t),""===a[a.length-1]?a[a.length-1]=t:a.push(t));else t?a[e]=m(t):a.splice(e,1);return i&&a.unshift(""),this.path(a.join(r),n)},a.segmentCoded=function(e,t,n){var r,o,a;if("number"!=typeof e&&(n=t,t=e,e=void 0),void 0===t){if(l(r=this.segment(e,t,n)))for(o=0,a=r.length;o<a;o++)r[o]=i.decode(r[o]);else r=void 0!==r?i.decode(r):void 0;return r}if(l(t))for(o=0,a=t.length;o<a;o++)t[o]=i.encode(t[o]);else t="string"==typeof t||t instanceof String?i.encode(t):t;return this.segment(e,t,n)};var R=a.query;return a.query=function(e,t){if(!0===e)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);return this._parts.query=i.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=i.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):R.call(this,e,t)},a.setQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)r[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var o in e)s.call(e,o)&&(r[o]=e[o])}return this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},a.addQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.addQuery(r,e,void 0===t?null:t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},a.removeQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.removeQuery(r,e,t),this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},a.hasQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(r,e,t,n)},a.setSearch=a.setQuery,a.addSearch=a.addQuery,a.removeSearch=a.removeQuery,a.hasSearch=a.hasQuery,a.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},a.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},a.normalizeHostname=function(n){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n)),this},a.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},a.normalizePath=function(e){var t,n=this._parts.path;if(!n)return this;if(this._parts.urn)return this._parts.path=i.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var r,o,a="";for("/"!==(n=i.recodePath(n)).charAt(0)&&(t=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(a=n.substring(1).match(/^(\.\.\/)+/)||"")&&(a=a[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)0!==r?(-1===(o=n.substring(0,r).lastIndexOf("/"))&&(o=r),n=n.substring(0,o)+n.substring(r+3)):n=n.substring(3);return t&&this.is("relative")&&(n=a+n.substring(1)),this._parts.path=n,this.build(!e),this},a.normalizePathname=a.normalizePath,a.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},a.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},a.normalizeSearch=a.normalizeQuery,a.normalizeHash=a.normalizeFragment,a.iso8859=function(){var e=i.encode,t=i.decode;i.encode=escape,i.decode=decodeURIComponent;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},a.unicode=function(){var e=i.encode,t=i.decode;i.encode=y,i.decode=unescape;try{this.normalize()}finally{i.encode=e,i.decode=t}return this},a.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";if(t._parts.protocol&&(n+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/"),n+=t.path(!0),t._parts.query){for(var r="",o=0,a=t._parts.query.split("&"),s=a.length;o<s;o++){var u=(a[o]||"").split("=");r+="&"+i.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(r+="="+i.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+i.decodeQuery(t.hash(),!0)},a.absoluteTo=function(e){var t,n,r,o=this.clone(),a=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof i||(e=new i(e)),o._parts.protocol)return o;if(o._parts.protocol=e._parts.protocol,this._parts.hostname)return o;for(n=0;r=a[n];n++)o._parts[r]=e._parts[r];return o._parts.path?(".."===o._parts.path.substring(-2)&&(o._parts.path+="/"),"/"!==o.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),o._parts.path=(t?t+"/":"")+o._parts.path,o.normalizePath())):(o._parts.path=e._parts.path,o._parts.query||(o._parts.query=e._parts.query)),o.build(),o},a.relativeTo=function(e){var t,n,r,o,a,s=this.clone().normalize();if(s._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new i(e).normalize(),t=s._parts,n=e._parts,o=s.path(),a=e.path(),"/"!==o.charAt(0))throw new Error("URI is already relative");if("/"!==a.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===n.protocol&&(t.protocol=null),t.username!==n.username||t.password!==n.password)return s.build();if(null!==t.protocol||null!==t.username||null!==t.password)return s.build();if(t.hostname!==n.hostname||t.port!==n.port)return s.build();if(t.hostname=null,t.port=null,o===a)return t.path="",s.build();if(!(r=i.commonPath(o,a)))return s.build();var u=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=u+t.path.substring(r.length)||"./",s.build()},a.equals=function(e){var t,n,r,o,a,u=this.clone(),c=new i(e),f={};if(u.normalize(),c.normalize(),u.toString()===c.toString())return!0;if(r=u.query(),o=c.query(),u.query(""),c.query(""),u.toString()!==c.toString())return!1;if(r.length!==o.length)return!1;for(a in t=i.parseQuery(r,this._parts.escapeQuerySpace),n=i.parseQuery(o,this._parts.escapeQuerySpace),t)if(s.call(t,a)){if(l(t[a])){if(!p(t[a],n[a]))return!1}else if(t[a]!==n[a])return!1;f[a]=!0}for(a in n)if(s.call(n,a)&&!f[a])return!1;return!0},a.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},a.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},a.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},i},(In=vn).exports?In.exports=Nn(function(){return An||(An=1,e=Pn,t=Pn.exports,function(n){var r=t&&!t.nodeType&&t,o=e&&!e.nodeType&&e,i="object"==typeof S&&S;i.global!==i&&i.window!==i&&i.self!==i||(n=i);var a,s,u=2147483647,c=36,l=/^xn--/,f=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,d=String.fromCharCode;function y(e){throw new RangeError(p[e])}function _(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function g(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+_((e=e.replace(h,".")).split("."),t).join(".")}function E(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function b(e){return _(e,function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+d(e)}).join("")}function w(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:c}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,n){var r=0;for(e=n?m(e/700):e>>1,e+=m(e/t);e>455;r+=c)e=m(e/35);return m(r+36*e/(e+38))}function A(e){var t,n,r,o,i,a,s,l,f,h,p=[],d=e.length,_=0,g=128,E=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&y("not-basic"),p.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<d;){for(i=_,a=1,s=c;o>=d&&y("invalid-input"),((l=w(e.charCodeAt(o++)))>=c||l>m((u-_)/a))&&y("overflow"),_+=l*a,!(l<(f=s<=E?1:s>=E+26?26:s-E));s+=c)a>m(u/(h=c-f))&&y("overflow"),a*=h;E=O(_-i,t=p.length+1,0==i),m(_/t)>u-g&&y("overflow"),g+=m(_/t),_%=t,p.splice(_++,0,g)}return b(p)}function x(e){var t,n,r,o,i,a,s,l,f,h,p,_,g,b,w,A=[];for(_=(e=E(e)).length,t=128,n=0,i=72,a=0;a<_;++a)(p=e[a])<128&&A.push(d(p));for(r=o=A.length,o&&A.push("-");r<_;){for(s=u,a=0;a<_;++a)(p=e[a])>=t&&p<s&&(s=p);for(s-t>m((u-n)/(g=r+1))&&y("overflow"),n+=(s-t)*g,t=s,a=0;a<_;++a)if((p=e[a])<t&&++n>u&&y("overflow"),p==t){for(l=n,f=c;!(l<(h=f<=i?1:f>=i+26?26:f-i));f+=c)w=l-h,b=c-h,A.push(d(T(h+w%b,0))),l=m(w/b);A.push(d(T(l,0))),i=O(n,g,r==o),n=0,++r}++n,++t}return A.join("")}if(a={version:"1.3.2",ucs2:{decode:E,encode:b},decode:A,encode:x,toASCII:function(e){return g(e,function(e){return f.test(e)?"xn--"+x(e):e})},toUnicode:function(e){return g(e,function(e){return l.test(e)?A(e.slice(4).toLowerCase()):e})}},r&&o)if(e.exports==r)o.exports=a;else for(s in a)a.hasOwnProperty(s)&&(r[s]=a[s]);else n.punycode=a}(Mn)),Pn.exports;var e,t}(),function(){return xn||(xn=1,t=Fn,n=function(e){var t=e&&e.IPv6;return{best:function(e){var t,n,r=e.toLowerCase().split(":"),o=r.length,i=8;for(""===r[0]&&""===r[1]&&""===r[2]?(r.shift(),r.shift()):""===r[0]&&""===r[1]?r.shift():""===r[o-1]&&""===r[o-2]&&r.pop(),-1!==r[(o=r.length)-1].indexOf(".")&&(i=7),t=0;t<o&&""!==r[t];t++);if(t<i)for(r.splice(t,1,"0000");r.length<i;)r.splice(t,0,"0000");for(var a=0;a<i;a++){n=r[a].split("");for(var s=0;s<3&&"0"===n[0]&&n.length>1;s++)n.splice(0,1);r[a]=n.join("")}var u=-1,c=0,l=0,f=-1,h=!1;for(a=0;a<i;a++)h?"0"===r[a]?l+=1:(h=!1,l>c&&(u=f,c=l)):"0"===r[a]&&(h=!0,f=a,l=1);l>c&&(u=f,c=l),c>1&&r.splice(u,c,""),o=r.length;var p="";for(""===r[0]&&(p=":"),a=0;a<o&&(p+=r[a],a!==o-1);a++)p+=":";return""===r[o-1]&&(p+=":"),p},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}},(e=Ln).exports?e.exports=n():t.IPv6=n(t)),Ln.exports;var e,t,n}(),function(){return Rn||(Rn=1,t=zn,n=function(e){var t=e&&e.SecondLevelDomains,n={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return!1;var o=n.list[e.slice(t+1)];return!!o&&o.indexOf(" "+e.slice(r+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var r=n.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var r=e.lastIndexOf(".",t-1);if(r<=0||r>=t-1)return null;var o=n.list[e.slice(t+1)];return o?o.indexOf(" "+e.slice(r+1,t)+" ")<0?null:e.slice(r+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return n},(e=Dn).exports?e.exports=n():t.SecondLevelDomains=n(t)),Dn.exports;var e,t,n}
/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */()):Cn.URI=Nn(Cn.punycode,Cn.IPv6,Cn.SecondLevelDomains,Cn)),vn.exports),Un=I(Bn);function jn(e,t){if(null===e||"object"!=typeof e)return e;t=t??!1;const n=new e.constructor;for(const r in e)if(e.hasOwnProperty(r)){let o=e[r];t&&(o=jn(o,t)),n[r]=o}return n}function qn(e,t,n){n=n??!1;const r={},o=w(e),i=w(t);let a,s,u;if(o)for(a in e)e.hasOwnProperty(a)&&(s=e[a],i&&n&&"object"==typeof s&&t.hasOwnProperty(a)?(u=t[a],r[a]="object"==typeof u?qn(s,u,n):s):r[a]=s);if(i)for(a in t)t.hasOwnProperty(a)&&!r.hasOwnProperty(a)&&(u=t[a],r[a]=u);return r}function Gn(){let e,t;const n=new Promise(function(n,r){e=n,t=r});return{resolve:e,reject:t,promise:n}}function kn(e,t){let n;return"undefined"!=typeof document&&(n=document),kn._implementation(e,t,n)}kn._implementation=function(e,t,n){if(!w(e))throw new T("relative uri is required.");if(!w(t)){if(void 0===n)return e;t=n.baseURI??n.location.href}const r=new Un(e);return""!==r.scheme()?r.toString():r.absoluteTo(t).toString()};const Wn={};function Vn(e,t,n){w(t)||(t=e.width),w(n)||(n=e.height);let r=Wn[t];w(r)||(r={},Wn[t]=r);let o=r[n];if(!w(o)){const e=document.createElement("canvas");e.width=t,e.height=n,o=e.getContext("2d",{willReadFrequently:!0}),o.globalCompositeOperation="copy",r[n]=o}return o.drawImage(e,0,0,t,n),o.getImageData(0,0,t,n).data}const Hn=/^blob:/i;function Yn(e){return O.typeOf.string("uri",e),Hn.test(e)}let Xn;function $n(e){w(Xn)||(Xn=document.createElement("a")),Xn.href=window.location.href;const t=Xn.host,n=Xn.protocol;return Xn.href=e,Xn.href=Xn.href,n!==Xn.protocol||t!==Xn.host}const Kn=/^data:/i;function Zn(e){return O.typeOf.string("uri",e),Kn.test(e)}var Qn=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),Jn=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3});function er(e){const t=(e=e??K.EMPTY_OBJECT).throttleByServer??!1,n=e.throttle??!1;this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=e.priority??0,this.throttle=n,this.throttleByServer=t,this.type=e.type??Jn.OTHER,this.serverKey=e.serverKey,this.state=Qn.UNISSUED,this.deferred=void 0,this.cancelled=!1}function tr(e,t,n){this.statusCode=e,this.response=t,this.responseHeaders=n,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){const t={};if(!e)return t;const n=e.split("\r\n");for(let r=0;r<n.length;++r){const e=n[r],o=e.indexOf(": ");if(o>0){const n=e.substring(0,o),r=e.substring(o+2);t[n]=r}}return t}(this.responseHeaders))}function nr(){this._listeners=new Map,this._toRemove=new Map,this._toAdd=new Map,this._invokingListeners=!1,this._listenerCount=0}function rr(e,t,n,r){t.has(n)||t.set(n,new Set);const o=t.get(n);return!o.has(r)&&(o.add(r),!0)}function or(e,t,n,r){const o=t.get(n);if(!o||!o.has(r))return!1;if(e._invokingListeners){if(!rr(0,e._toRemove,n,r))return!1}else o.delete(r),0===o.size&&t.delete(n);return!0}function ir(e){O.typeOf.object("options",e),O.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function ar(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}er.prototype.cancel=function(){this.cancelled=!0},er.prototype.clone=function(e){return w(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=Qn.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new er(this)},tr.prototype.toString=function(){let e="Request has failed.";return w(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e},Object.defineProperties(nr.prototype,{numberOfListeners:{get:function(){return this._listenerCount}}}),nr.prototype.addEventListener=function(e,t){O.typeOf.func("listener",e);const n=this;return rr(0,n._invokingListeners?n._toAdd:n._listeners,e,t)&&n._listenerCount++,function(){n.removeEventListener(e,t)}},nr.prototype.removeEventListener=function(e,t){O.typeOf.func("listener",e);const n=or(this,this._listeners,e,t),r=or(this,this._toAdd,e,t),o=n||r;return o&&this._listenerCount--,o},nr.prototype.raiseEvent=function(){this._invokingListeners=!0;for(const[e,t]of this._listeners.entries())if(w(e))for(const n of t)e.apply(n,arguments);this._invokingListeners=!1;for(const[e,t]of this._toAdd.entries())for(const n of t)rr(0,this._listeners,e,n);this._toAdd.clear();for(const[e,t]of this._toRemove.entries())for(const n of t)or(this,this._listeners,e,n);this._toRemove.clear()},Object.defineProperties(ir.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){O.typeOf.number.greaterThanOrEquals("maximumLength",e,0);const t=this._length;if(e<t){const n=this._array;for(let r=e;r<t;++r)n[r]=void 0;this._length=e,n.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}}),ir.prototype.reserve=function(e){e=e??this._length,this._array.length=e},ir.prototype.heapify=function(e){e=e??0;const t=this._length,n=this._comparator,r=this._array;let o=-1,i=!0;for(;i;){const a=2*(e+1),s=a-1;o=s<t&&n(r[s],r[e])<0?s:e,a<t&&n(r[a],r[o])<0&&(o=a),o!==e?(ar(r,o,e),e=o):i=!1}},ir.prototype.resort=function(){const e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},ir.prototype.insert=function(e){O.defined("element",e);const t=this._array,n=this._comparator,r=this._maximumLength;let o,i=this._length++;for(i<t.length?t[i]=e:t.push(e);0!==i;){const e=Math.floor((i-1)/2);if(!(n(t[i],t[e])<0))break;ar(t,i,e),i=e}return w(r)&&this._length>r&&(o=t[r],this._length=r),o},ir.prototype.pop=function(e){if(e=e??0,0===this._length)return;O.typeOf.number.lessThan("index",e,this._length);const t=this._array,n=t[e];return ar(t,e,--this._length),this.heapify(e),t[this._length]=void 0,n};const sr={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0};let ur=20;const cr=new ir({comparator:function(e,t){return e.priority-t.priority}});cr.maximumLength=ur,cr.reserve(ur);const lr=[];let fr={};const hr="undefined"!=typeof document?new Un(document.location.href):new Un,pr=new nr;function mr(){}function dr(e){w(e.priorityFunction)&&(e.priority=e.priorityFunction())}function yr(e){return e.state===Qn.UNISSUED&&(e.state=Qn.ISSUED,e.deferred=Gn()),e.deferred.promise}function _r(e){const t=yr(e);return e.state=Qn.ACTIVE,lr.push(e),++sr.numberOfActiveRequests,++sr.numberOfActiveRequestsEver,++fr[e.serverKey],e.requestFunction().then(function(e){return function(t){if(e.state===Qn.CANCELLED)return;const n=e.deferred;--sr.numberOfActiveRequests,--fr[e.serverKey],pr.raiseEvent(),e.state=Qn.RECEIVED,e.deferred=void 0,n.resolve(t)}}(e)).catch(function(e){return function(t){e.state!==Qn.CANCELLED&&(++sr.numberOfFailedRequests,--sr.numberOfActiveRequests,--fr[e.serverKey],pr.raiseEvent(t),e.state=Qn.FAILED,e.deferred.reject(t))}}(e)),t}function gr(e){const t=e.state===Qn.ACTIVE;if(e.state=Qn.CANCELLED,++sr.numberOfCancelledRequests,w(e.deferred)){const t=e.deferred;e.deferred=void 0,t.reject()}t&&(--sr.numberOfActiveRequests,--fr[e.serverKey],++sr.numberOfCancelledActiveRequests),w(e.cancelFunction)&&e.cancelFunction()}mr.maximumRequests=50,mr.maximumRequestsPerServer=18,mr.requestsByServer={},mr.throttleRequests=!0,mr.debugShowStatistics=!1,mr.requestCompletedEvent=pr,Object.defineProperties(mr,{statistics:{get:function(){return sr}},priorityHeapLength:{get:function(){return ur},set:function(e){if(e<ur)for(;cr.length>e;)gr(cr.pop());ur=e,cr.maximumLength=e,cr.reserve(e)}}}),mr.serverHasOpenSlots=function(e,t){t=t??1;const n=mr.requestsByServer[e]??mr.maximumRequestsPerServer;return fr[e]+t<=n},mr.heapHasOpenSlots=function(e){return cr.length+e<=ur},mr.update=function(){let e,t,n=0;const r=lr.length;for(e=0;e<r;++e)t=lr[e],t.cancelled&&gr(t),t.state===Qn.ACTIVE?n>0&&(lr[e-n]=t):++n;lr.length-=n;const o=cr.internalArray,i=cr.length;for(e=0;e<i;++e)dr(o[e]);cr.resort();const a=Math.max(mr.maximumRequests-lr.length,0);let s=0;for(;s<a&&cr.length>0;)t=cr.pop(),t.cancelled?gr(t):!t.throttleByServer||mr.serverHasOpenSlots(t.serverKey)?(_r(t),++s):gr(t);mr.debugShowStatistics&&(0===sr.numberOfActiveRequests&&sr.lastNumberOfActiveRequests>0&&(sr.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${sr.numberOfAttemptedRequests}`),sr.numberOfAttemptedRequests=0),sr.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${sr.numberOfCancelledRequests}`),sr.numberOfCancelledRequests=0),sr.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${sr.numberOfCancelledActiveRequests}`),sr.numberOfCancelledActiveRequests=0),sr.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${sr.numberOfFailedRequests}`),sr.numberOfFailedRequests=0)),sr.lastNumberOfActiveRequests=sr.numberOfActiveRequests)},mr.getServerKey=function(e){O.typeOf.string("url",e);let t=new Un(e);""===t.scheme()&&(t=t.absoluteTo(hr),t.normalize());let n=t.authority();return/:/.test(n)||(n=`${n}:${"https"===t.scheme()?"443":"80"}`),w(fr[n])||(fr[n]=0),n},mr.request=function(e){if(O.typeOf.object("request",e),O.typeOf.string("request.url",e.url),O.typeOf.func("request.requestFunction",e.requestFunction),Zn(e.url)||Yn(e.url))return pr.raiseEvent(),e.state=Qn.RECEIVED,e.requestFunction();if(++sr.numberOfAttemptedRequests,w(e.serverKey)||(e.serverKey=mr.getServerKey(e.url)),mr.throttleRequests&&e.throttleByServer&&!mr.serverHasOpenSlots(e.serverKey))return;if(!mr.throttleRequests||!e.throttle)return _r(e);if(lr.length>=mr.maximumRequests)return;dr(e);const t=cr.insert(e);if(w(t)){if(t===e)return;gr(t)}return yr(e)},mr.clearForSpecs=function(){for(;cr.length>0;)gr(cr.pop());const e=lr.length;for(let t=0;t<e;++t)gr(lr[t]);lr.length=0,fr={},sr.numberOfAttemptedRequests=0,sr.numberOfActiveRequests=0,sr.numberOfCancelledRequests=0,sr.numberOfCancelledActiveRequests=0,sr.numberOfFailedRequests=0,sr.numberOfActiveRequestsEver=0,sr.lastNumberOfActiveRequests=0},mr.numberOfActiveRequestsByServer=function(e){return fr[e]},mr.requestHeap=cr;const Er={};let br={};Er.add=function(e,t){if(!w(e))throw new T("host is required.");if(!w(t)||t<=0)throw new T("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;w(br[n])||(br[n]=!0)},Er.remove=function(e,t){if(!w(e))throw new T("host is required.");if(!w(t)||t<=0)throw new T("port is required to be greater than 0.");const n=`${e.toLowerCase()}:${t}`;w(br[n])&&delete br[n]},Er.contains=function(e){if(!w(e))throw new T("url is required.");const t=function(e){const t=new Un(e);t.normalize();let n=t.authority();if(0!==n.length){if(t.authority(n),-1!==n.indexOf("@")){const e=n.split("@");n=e[1]}if(-1===n.indexOf(":")){let e=t.scheme();if(0===e.length&&(e=window.location.protocol,e=e.substring(0,e.length-1)),"http"===e)n+=":80";else{if("https"!==e)return;n+=":443"}}return n}}(e);return!(!w(t)||!w(br[t]))},Er.clear=function(){br={}};const wr=function(){try{const e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Tr(e){"string"==typeof(e=e??K.EMPTY_OBJECT)&&(e={url:e}),O.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=Or(e.templateValues,{}),this._queryParameters=Or(e.queryParameters,{}),this.headers=Or(e.headers,{}),this.request=e.request??new er,this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=e.retryAttempts??0,this._retryCount=0,e.parseUrl??1?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function Or(e,t){return w(e)?jn(e):t}let Ar;function xr(e,t,n){if(!n)return qn(e,t);const r=jn(e,!0);for(const o in t)if(t.hasOwnProperty(o)){let e=r[o];const n=t[o];w(e)?(Array.isArray(e)||(e=r[o]=[e]),r[o]=e.concat(n)):r[o]=Array.isArray(n)?n.slice():n}return r}function Rr(e,t,n){const r={};r[t]=n,e.setQueryParameters(r);const o=e.request,i=e.url;o.url=i,o.requestFunction=function(){const e=Gn();return window[n]=function(t){e.resolve(t);try{delete window[n]}catch(e){window[n]=void 0}},Tr._Implementations.loadAndExecuteScript(i,n,e),e.promise};const a=mr.request(o);if(w(a))return a.catch(function(r){return o.state!==Qn.FAILED?Promise.reject(r):e.retryOnError(r).then(function(i){return i?(o.state=Qn.UNISSUED,o.deferred=void 0,Rr(e,t,n)):Promise.reject(r)})})}function Sr(e){if(e.state===Qn.ISSUED||e.state===Qn.ACTIVE)throw new fe("The Resource is already being fetched.");e.state=Qn.UNISSUED,e.deferred=void 0}Tr.createIfNeeded=function(e){return e instanceof Tr?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Tr({url:e})},Tr.supportsImageBitmapOptions=function(){return w(Ar)?Ar:"function"!=typeof createImageBitmap?(Ar=Promise.resolve(!1),Ar):(Ar=Tr.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then(function(e){return Promise.all([createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"}),createImageBitmap(e)])}).then(function(e){const t=Vn(e[0]),n=Vn(e[1]);return t[1]!==n[1]}).catch(function(){return!1}),Ar)},Object.defineProperties(Tr,{isBlobSupported:{get:function(){return wr}}}),Object.defineProperties(Tr.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return function(e){if(!w(e))throw new T("uri is required.");const t=new Un(e);t.normalize();let n=t.path(),r=n.lastIndexOf("/");return-1!==r&&(n=n.substr(r+1)),r=n.lastIndexOf("."),n=-1===r?"":n.substr(r+1),n}(this._url)}},isDataUri:{get:function(){return Zn(this._url)}},isBlobUri:{get:function(){return Yn(this._url)}},isCrossOriginUrl:{get:function(){return $n(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}}),Tr.prototype.toString=function(){return this.getUrlComponent(!0,!0)},Tr.prototype.parseUrl=function(e,t,n,r){let o=new Un(e);const i=function(e){return 0===e.length?{}:-1===e.indexOf("=")?{[e]:void 0}:function(e){if(!w(e))throw new T("queryString is required.");const t={};if(""===e)return t;const n=e.replace(/\+/g,"%20").split(/[&;]/);for(let r=0,o=n.length;r<o;++r){const e=n[r].split("="),o=decodeURIComponent(e[0]);let i=e[1];i=w(i)?decodeURIComponent(i):"";const a=t[o];"string"==typeof a?t[o]=[a,i]:Array.isArray(a)?a.push(i):t[o]=i}return t}(e)}(o.query());this._queryParameters=t?xr(i,this.queryParameters,n):i,o.search(""),o.fragment(""),w(r)&&""===o.scheme()&&(o=o.absoluteTo(kn(r))),this._url=o.toString()},Tr.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let n=this._url;e&&(n=`${n}${function(e){const t=Object.keys(e);return 0===t.length?"":1!==t.length||w(e[t[0]])?`?${function(e){if(!w(e))throw new T("obj is required.");let t="";for(const n in e)if(e.hasOwnProperty(n)){const r=e[n],o=`${encodeURIComponent(n)}=`;if(Array.isArray(r))for(let e=0,n=r.length;e<n;++e)t+=`${o+encodeURIComponent(r[e])}&`;else t+=`${o+encodeURIComponent(r)}&`}return t=t.slice(0,-1),t}(e)}`:`?${t[0]}`}(this.queryParameters)}`),n=n.replace(/%7B/g,"{").replace(/%7D/g,"}");const r=this._templateValues;return Object.keys(r).length>0&&(n=n.replace(/{(.*?)}/g,function(e,t){const n=r[t];return w(n)?encodeURIComponent(n):e})),t&&w(this.proxy)&&(n=this.proxy.getURL(n)),n},Tr.prototype.setQueryParameters=function(e,t){this._queryParameters=t?xr(this._queryParameters,e,!1):xr(e,this._queryParameters,!1)},Tr.prototype.appendQueryParameters=function(e){this._queryParameters=xr(e,this._queryParameters,!0)},Tr.prototype.setTemplateValues=function(e,t){this._templateValues=t?qn(this._templateValues,e):qn(e,this._templateValues)},Tr.prototype.getDerivedResource=function(e){const t=this.clone();if(t._retryCount=0,w(e.url)){const n=e.preserveQueryParameters??!1;t.parseUrl(e.url,!0,n,this._url)}return w(e.queryParameters)&&(t._queryParameters=qn(e.queryParameters,t.queryParameters)),w(e.templateValues)&&(t._templateValues=qn(e.templateValues,t.templateValues)),w(e.headers)&&(t.headers=qn(e.headers,t.headers)),w(e.proxy)&&(t.proxy=e.proxy),w(e.request)&&(t.request=e.request),w(e.retryCallback)&&(t.retryCallback=e.retryCallback),w(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},Tr.prototype.retryOnError=function(e){const t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);const n=this;return Promise.resolve(t(this,e)).then(function(e){return++n._retryCount,e})},Tr.prototype.clone=function(e){return w(e)?(e._url=this._url,e._queryParameters=jn(this._queryParameters),e._templateValues=jn(this._templateValues),e.headers=jn(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e):new Tr({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:w(this.credits)?this.credits.slice():void 0})},Tr.prototype.getBaseUri=function(e){return function(e,t){if(!w(e))throw new T("uri is required.");let n="";const r=e.lastIndexOf("/");return-1!==r&&(n=e.substring(0,r+1)),t?(0!==(e=new Un(e)).query().length&&(n+=`?${e.query()}`),0!==e.fragment().length&&(n+=`#${e.fragment()}`),n):n}(this.getUrlComponent(e),e)},Tr.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e=`${e}/`),e)},Tr.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Tr.fetchArrayBuffer=function(e){return new Tr(e).fetchArrayBuffer()},Tr.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Tr.fetchBlob=function(e){return new Tr(e).fetchBlob()},Tr.prototype.fetchImage=function(e){const t=(e=e??K.EMPTY_OBJECT).preferImageBitmap??!1,n=e.preferBlob??!1,r=e.flipY??!1,o=e.skipColorSpaceConversion??!1;if(Sr(this.request),!wr||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return this._fetchImage({resource:this,flipY:r,skipColorSpaceConversion:o,preferImageBitmap:t});const i=this.fetchBlob();if(!w(i))return;let a,s,u,c;return Tr.supportsImageBitmapOptions().then(function(e){return a=e,s=a&&t,i}).then(function(e){if(!w(e))return;if(c=e,s)return Tr.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});const t=window.URL.createObjectURL(e);return u=new Tr({url:t}),u._fetchImage({flipY:r,skipColorSpaceConversion:o,preferImageBitmap:!1})}).then(function(e){if(w(e))return e.blob=c,s||window.URL.revokeObjectURL(u.url),e}).catch(function(e){return w(u)&&window.URL.revokeObjectURL(u.url),e.blob=c,Promise.reject(e)})},Tr.prototype._fetchImage=function(e){const t=this,n=e.flipY,r=e.skipColorSpaceConversion,o=e.preferImageBitmap,i=t.request;i.url=t.url,i.requestFunction=function(){let e=!1;t.isDataUri||t.isBlobUri||(e=t.isCrossOriginUrl);const a=Gn();return Tr._Implementations.createImage(i,e,a,n,r,o),a.promise};const a=mr.request(i);if(w(a))return a.catch(function(e){return i.state!==Qn.FAILED?Promise.reject(e):t.retryOnError(e).then(function(a){return a?(i.state=Qn.UNISSUED,i.deferred=void 0,t._fetchImage({flipY:n,skipColorSpaceConversion:r,preferImageBitmap:o})):Promise.reject(e)})})},Tr.fetchImage=function(e){return new Tr(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},Tr.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Tr.fetchText=function(e){return new Tr(e).fetchText()},Tr.prototype.fetchJson=function(){const e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(w(e))return e.then(function(e){if(w(e))return JSON.parse(e)})},Tr.fetchJson=function(e){return new Tr(e).fetchJson()},Tr.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Tr.fetchXML=function(e){return new Tr(e).fetchXML()},Tr.prototype.fetchJsonp=function(e){let t;e=e??"callback",Sr(this.request);do{t=`loadJsonp${v.nextRandomNumber().toString().substring(2,8)}`}while(w(window[t]));return Rr(this,e,t)},Tr.fetchJsonp=function(e){return new Tr(e).fetchJsonp(e.callbackParameterName)},Tr.prototype._makeRequest=function(e){const t=this;Sr(t.request);const n=t.request,r=t.url;n.url=r,n.requestFunction=function(){const o=e.responseType,i=qn(e.headers,t.headers),a=e.overrideMimeType,s=e.method,u=e.data,c=Gn(),l=Tr._Implementations.loadWithXhr(r,o,s,u,i,c,a);return w(l)&&w(l.abort)&&(n.cancelFunction=function(){l.abort()}),c.promise};const o=mr.request(n);if(w(o))return o.then(function(e){return n.cancelFunction=void 0,e}).catch(function(r){return n.cancelFunction=void 0,n.state!==Qn.FAILED?Promise.reject(r):t.retryOnError(r).then(function(o){return o?(n.state=Qn.UNISSUED,n.deferred=void 0,t.fetch(e)):Promise.reject(r)})})};const Ir=/^data:(.*?)(;base64)?,(.*)$/;function Cr(e,t){const n=decodeURIComponent(t);return e?atob(n):n}function Nr(e,t){const n=Cr(e,t),r=new ArrayBuffer(n.length),o=new Uint8Array(r);for(let i=0;i<n.length;i++)o[i]=n.charCodeAt(i);return r}Tr.prototype.fetch=function(e){return(e=Or(e,{})).method="GET",this._makeRequest(e)},Tr.fetch=function(e){return new Tr(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr.prototype.delete=function(e){return(e=Or(e,{})).method="DELETE",this._makeRequest(e)},Tr.delete=function(e){return new Tr(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Tr.prototype.head=function(e){return(e=Or(e,{})).method="HEAD",this._makeRequest(e)},Tr.head=function(e){return new Tr(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr.prototype.options=function(e){return(e=Or(e,{})).method="OPTIONS",this._makeRequest(e)},Tr.options=function(e){return new Tr(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr.prototype.post=function(e,t){return O.defined("data",e),(t=Or(t,{})).method="POST",t.data=e,this._makeRequest(t)},Tr.post=function(e){return new Tr(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr.prototype.put=function(e,t){return O.defined("data",e),(t=Or(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Tr.put=function(e){return new Tr(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr.prototype.patch=function(e,t){return O.defined("data",e),(t=Or(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Tr.patch=function(e){return new Tr(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Tr._Implementations={},Tr._Implementations.loadImageElement=function(e,t,n){const r=new Image;r.onload=function(){0===r.naturalWidth&&0===r.naturalHeight&&0===r.width&&0===r.height&&(r.width=300,r.height=150),n.resolve(r)},r.onerror=function(e){n.reject(e)},t&&(Er.contains(e)?r.crossOrigin="use-credentials":r.crossOrigin=""),r.src=e},Tr._Implementations.createImage=function(e,t,n,r,o,i,a){const s=e.url;Tr.supportsImageBitmapOptions().then(function(u){if(!u||!i)return void Tr._Implementations.loadImageElement(s,t,n);const c=Gn(),l=Tr._Implementations.loadWithXhr(s,"blob","GET",void 0,a,c,void 0,void 0,void 0);return w(l)&&w(l.abort)&&(e.cancelFunction=function(){l.abort()}),c.promise.then(function(e){if(w(e))return Tr.createImageBitmapFromBlob(e,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:o});n.reject(new fe(`Successfully retrieved ${s} but it contained no content.`))}).then(function(e){n.resolve(e)})}).catch(function(e){n.reject(e)})},Tr.createImageBitmapFromBlob=function(e,t){return O.defined("options",t),O.typeOf.bool("options.flipY",t.flipY),O.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),O.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};const vr="undefined"==typeof XMLHttpRequest;function Pr(e){e=e??K.EMPTY_OBJECT,this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._addNewLeapSeconds=e.addNewLeapSeconds??!0,w(e.data)?Lr(this,e.data):Lr(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function Mr(e,t){return Tn.compare(e.julianDate,t)}function Lr(e,t){if(!w(t.columnNames))throw new fe("Error in loaded EOP data: The columnNames property is required.");if(!w(t.samples))throw new fe("Error in loaded EOP data: The samples property is required.");const n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),o=t.columnNames.indexOf("yPoleWanderRadians"),i=t.columnNames.indexOf("ut1MinusUtcSeconds"),a=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),s=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||o<0||i<0||a<0||s<0||u<0)throw new fe("Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");const c=e._samples=t.samples,l=e._dates=[];let f;e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=o,e._ut1MinusUtcSecondsColumn=i,e._xCelestialPoleOffsetRadiansColumn=a,e._yCelestialPoleOffsetRadiansColumn=s,e._taiMinusUtcSecondsColumn=u,e._columnCount=t.columnNames.length,e._lastIndex=void 0;const h=e._addNewLeapSeconds;for(let p=0,m=c.length;p<m;p+=e._columnCount){const e=c[p+n],t=c[p+u],r=new Tn(e+tn.MODIFIED_JULIAN_DATE_DIFFERENCE,t,nn.TAI);if(l.push(r),h){if(t!==f&&w(f)){const e=Tn.leapSeconds,n=$t(e,r,Mr);if(n<0){const o=new en(r,t);e.splice(~n,0,o)}}f=t}}}function Fr(e,t,n,r,o){const i=n*r;o.xPoleWander=t[i+e._xPoleWanderRadiansColumn],o.yPoleWander=t[i+e._yPoleWanderRadiansColumn],o.xPoleOffset=t[i+e._xCelestialPoleOffsetRadiansColumn],o.yPoleOffset=t[i+e._yCelestialPoleOffsetRadiansColumn],o.ut1MinusUtc=t[i+e._ut1MinusUtcSecondsColumn]}function Dr(e,t,n){return t+e*(n-t)}function zr(e,t,n,r,o,i,a){const s=e._columnCount;if(i>t.length-1)return a.xPoleWander=0,a.yPoleWander=0,a.xPoleOffset=0,a.yPoleOffset=0,a.ut1MinusUtc=0,a;const u=t[o],c=t[i];if(u.equals(c)||r.equals(u))return Fr(e,n,o,s,a),a;if(r.equals(c))return Fr(e,n,i,s,a),a;const l=Tn.secondsDifference(r,u)/Tn.secondsDifference(c,u),f=o*s,h=i*s;let p=n[f+e._ut1MinusUtcSecondsColumn],m=n[h+e._ut1MinusUtcSecondsColumn];const d=m-p;if(d>.5||d<-.5){const t=n[f+e._taiMinusUtcSecondsColumn],o=n[h+e._taiMinusUtcSecondsColumn];t!==o&&(c.equals(r)?p=m:m-=o-t)}return a.xPoleWander=Dr(l,n[f+e._xPoleWanderRadiansColumn],n[h+e._xPoleWanderRadiansColumn]),a.yPoleWander=Dr(l,n[f+e._yPoleWanderRadiansColumn],n[h+e._yPoleWanderRadiansColumn]),a.xPoleOffset=Dr(l,n[f+e._xCelestialPoleOffsetRadiansColumn],n[h+e._xCelestialPoleOffsetRadiansColumn]),a.yPoleOffset=Dr(l,n[f+e._yCelestialPoleOffsetRadiansColumn],n[h+e._yCelestialPoleOffsetRadiansColumn]),a.ut1MinusUtc=Dr(l,p,m),a}function Br(e,t,n){this.heading=e??0,this.pitch=t??0,this.roll=n??0}Tr._Implementations.loadWithXhr=function(e,t,n,r,o,i,a){const s=Ir.exec(e);if(null!==s)return void i.resolve(function(e,t){t=t??"";const n=e[1],r=!!e[2],o=e[3];let i,a;switch(t){case"":case"text":return Cr(r,o);case"arraybuffer":return Nr(r,o);case"blob":return i=Nr(r,o),new Blob([i],{type:n});case"document":return a=new DOMParser,a.parseFromString(Cr(r,o),n);case"json":return JSON.parse(Cr(r,o));default:throw new T(`Unhandled responseType: ${t}`)}}(s,t));if(vr)return void function(e,t,n,r,o,i){fetch(e,{method:n,headers:o}).then(async e=>{if(!e.ok){const t={};return e.headers.forEach((e,n)=>{t[n]=e}),void i.reject(new tr(e.status,e,t))}switch(t){case"text":i.resolve(e.text());break;case"json":i.resolve(e.json());break;default:i.resolve(new Uint8Array(await e.arrayBuffer()).buffer)}}).catch(()=>{i.reject(new tr)})}(e,t,n,0,o,i);const u=new XMLHttpRequest;if(Er.contains(e)&&(u.withCredentials=!0),u.open(n,e,!0),w(a)&&w(u.overrideMimeType)&&u.overrideMimeType(a),w(o))for(const l in o)o.hasOwnProperty(l)&&u.setRequestHeader(l,o[l]);w(t)&&(u.responseType=t);let c=!1;return"string"==typeof e&&(c=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),u.onload=function(){if((u.status<200||u.status>=300)&&(!c||0!==u.status))return void i.reject(new tr(u.status,u.response,u.getAllResponseHeaders()));const e=u.response,r=u.responseType;if("HEAD"===n||"OPTIONS"===n){const e=u.getAllResponseHeaders().trim().split(/[\r\n]+/),t={};return e.forEach(function(e){const n=e.split(": "),r=n.shift();t[r]=n.join(": ")}),void i.resolve(t)}if(204===u.status)i.resolve(void 0);else if(!w(e)||w(t)&&r!==t)if("json"===t&&"string"==typeof e)try{i.resolve(JSON.parse(e))}catch(e){i.reject(e)}else(""===r||"document"===r)&&w(u.responseXML)&&u.responseXML.hasChildNodes()?i.resolve(u.responseXML):""!==r&&"text"!==r||!w(u.responseText)?i.reject(new fe("Invalid XMLHttpRequest response type.")):i.resolve(u.responseText);else i.resolve(e)},u.onerror=function(e){i.reject(new tr)},u.send(r),u},Tr._Implementations.loadAndExecuteScript=function(e,t,n){return function(e){const t=document.createElement("script");return t.async=!0,t.src=e,new Promise((e,n)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");const r=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,r.removeChild(t),e()},t.onerror=function(e){n(e)},r.appendChild(t)})}(e).catch(function(e){n.reject(e)})},Tr._DefaultImplementations={},Tr._DefaultImplementations.createImage=Tr._Implementations.createImage,Tr._DefaultImplementations.loadWithXhr=Tr._Implementations.loadWithXhr,Tr._DefaultImplementations.loadAndExecuteScript=Tr._Implementations.loadAndExecuteScript,Tr.DEFAULT=Object.freeze(new Tr({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),Pr.fromUrl=async function(e,t){O.defined("url",e),t=t??K.EMPTY_OBJECT;const n=Tr.createIfNeeded(e);let r;try{r=await n.fetchJson()}catch(e){throw new fe(`An error occurred while retrieving the EOP data from the URL ${n.url}.`)}return new Pr({addNewLeapSeconds:t.addNewLeapSeconds,data:r})},Pr.NONE=Object.freeze({compute:function(e,t){return w(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Kt(0,0,0,0,0),t}}),Pr.prototype.compute=function(e,t){if(!w(this._samples))return;if(w(t)||(t=new Kt(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;const n=this._dates,r=this._lastIndex;let o=0,i=0;if(w(r)){const a=n[r],s=n[r+1],u=Tn.lessThanOrEquals(a,e),c=!w(s),l=c||Tn.greaterThanOrEquals(s,e);if(u&&l)return o=r,!c&&s.equals(e)&&++o,i=o+1,zr(this,n,this._samples,e,o,i,t),t}let a=$t(n,e,Tn.compare,this._dateColumn);return a>=0?(a<n.length-1&&n[a+1].equals(e)&&++a,o=a,i=a):(i=~a,o=i-1,o<0&&(o=0)),this._lastIndex=o,zr(this,n,this._samples,e,o,i,t),t},Br.fromQuaternion=function(e,t){if(!w(e))throw new T("quaternion is required");w(t)||(t=new Br);const n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),i=1-2*(e.y*e.y+e.z*e.z),a=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(a,i),t.roll=Math.atan2(o,r),t.pitch=-v.asinClamped(n),t},Br.fromDegrees=function(e,t,n,r){if(!w(e))throw new T("heading is required");if(!w(t))throw new T("pitch is required");if(!w(n))throw new T("roll is required");return w(r)||(r=new Br),r.heading=e*v.RADIANS_PER_DEGREE,r.pitch=t*v.RADIANS_PER_DEGREE,r.roll=n*v.RADIANS_PER_DEGREE,r},Br.clone=function(e,t){if(w(e))return w(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Br(e.heading,e.pitch,e.roll)},Br.equals=function(e,t){return e===t||w(e)&&w(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},Br.equalsEpsilon=function(e,t,n,r){return e===t||w(e)&&w(t)&&v.equalsEpsilon(e.heading,t.heading,n,r)&&v.equalsEpsilon(e.pitch,t.pitch,n,r)&&v.equalsEpsilon(e.roll,t.roll,n,r)},Br.prototype.clone=function(e){return Br.clone(this,e)},Br.prototype.equals=function(e){return Br.equals(this,e)},Br.prototype.equalsEpsilon=function(e,t,n){return Br.equalsEpsilon(this,e,t,n)},Br.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};const Ur=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;let jr,qr,Gr;function kr(e){return"undefined"==typeof document?e:(w(jr)||(jr=document.createElement("a")),jr.href=e,jr.href)}function Wr(){if(w(qr))return qr;let e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:w(import.meta?.url)?kn(".",import.meta.url):"object"==typeof define&&w(define.amd)&&!define.amd.toUrlUndefined&&w(require.toUrl)?kn("..",Yr("Core/buildModuleUrl.js")):function(){const e=document.getElementsByTagName("script");for(let t=0,n=e.length;t<n;++t){const n=e[t].getAttribute("src"),r=Ur.exec(n);if(null!==r)return r[1]}}(),!w(e))throw new T("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return qr=new Tr({url:kr(e)}),qr.appendForwardSlash(),qr}function Vr(e){return kr(require.toUrl(`../${e}`))}function Hr(e){return Wr().getDerivedResource({url:e}).url}function Yr(e){return w(Gr)||(Gr="object"==typeof define&&w(define.amd)&&!define.amd.toUrlUndefined&&w(require.toUrl)?Vr:Hr),Gr(e)}function Xr(e,t,n){this.x=e,this.y=t,this.s=n}function $r(e){e=e??K.EMPTY_OBJECT,this._xysFileUrlTemplate=Tr.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=e.interpolationOrder??9,this._sampleZeroJulianEphemerisDate=e.sampleZeroJulianEphemerisDate??2442396.5,this._sampleZeroDateTT=new Tn(this._sampleZeroJulianEphemerisDate,0,nn.TAI),this._stepSizeDays=e.stepSizeDays??1,this._samplesPerXysFile=e.samplesPerXysFile??1e3,this._totalSamples=e.totalSamples??27426,this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];const t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),o=Math.pow(this._stepSizeDays,t);for(let i=0;i<=t;++i){n[i]=o,r[i]=i*this._stepSizeDays;for(let e=0;e<=t;++e)e!==i&&(n[i]*=i-e);n[i]=1/n[i]}this._work=new Array(t+1),this._coef=new Array(t+1)}Yr._cesiumScriptRegex=Ur,Yr._buildModuleUrlFromBaseUrl=Hr,Yr._clearBaseResource=function(){qr=void 0},Yr.setBaseUrl=function(e){qr=Tr.DEFAULT.getDerivedResource({url:e})},Yr.getCesiumBaseUrl=Wr;const Kr=new Tn(0,0,nn.TAI);function Zr(e,t,n){const r=Kr;return r.dayNumber=t,r.secondsOfDay=n,Tn.daysDifference(r,e._sampleZeroDateTT)}function Qr(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let n;const r=e._xysFileUrlTemplate;n=w(r)?r.getDerivedResource({templateValues:{0:t}}):new Tr({url:Yr(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});const o=n.fetchJson().then(function(n){e._chunkDownloadsInProgress[t]=!1;const r=e._samples,o=n.samples,i=t*e._samplesPerXysFile*3;for(let e=0,t=o.length;e<t;++e)r[i+e]=o[e]});return e._chunkDownloadsInProgress[t]=o,o}function Jr(e,t,n,r){this.x=e??0,this.y=t??0,this.z=n??0,this.w=r??0}$r.prototype.preload=function(e,t,n,r){const o=Zr(this,e,t),i=Zr(this,n,r);let a=o/this._stepSizeDays-this._interpolationOrder/2|0;a<0&&(a=0);let s=i/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;s>=this._totalSamples&&(s=this._totalSamples-1);const u=a/this._samplesPerXysFile|0,c=s/this._samplesPerXysFile|0,l=[];for(let f=u;f<=c;++f)l.push(Qr(this,f));return Promise.all(l)},$r.prototype.computeXysRadians=function(e,t,n){const r=Zr(this,e,t);if(r<0)return;const o=r/this._stepSizeDays|0;if(o>=this._totalSamples)return;const i=this._interpolationOrder;let a=o-(i/2|0);a<0&&(a=0);let s=a+i;s>=this._totalSamples&&(s=this._totalSamples-1,a=s-i,a<0&&(a=0));let u=!1;const c=this._samples;if(w(c[3*a])||(Qr(this,a/this._samplesPerXysFile|0),u=!0),w(c[3*s])||(Qr(this,s/this._samplesPerXysFile|0),u=!0),u)return;w(n)?(n.x=0,n.y=0,n.s=0):n=new Xr(0,0,0);const l=r-a*this._stepSizeDays,f=this._work,h=this._denominators,p=this._coef,m=this._xTable;let d,y;for(d=0;d<=i;++d)f[d]=l-m[d];for(d=0;d<=i;++d){for(p[d]=1,y=0;y<=i;++y)y!==d&&(p[d]*=f[y]);p[d]*=h[d];let e=3*(a+d);n.x+=p[d]*c[e++],n.y+=p[d]*c[e++],n.s+=p[d]*c[e]}return n};let eo=new L;Jr.fromAxisAngle=function(e,t,n){O.typeOf.object("axis",e),O.typeOf.number("angle",t);const r=t/2,o=Math.sin(r);eo=L.normalize(e,eo);const i=eo.x*o,a=eo.y*o,s=eo.z*o,u=Math.cos(r);return w(n)?(n.x=i,n.y=a,n.z=s,n.w=u,n):new Jr(i,a,s,u)};const to=[1,2,0],no=new Array(3);Jr.fromRotationMatrix=function(e,t){let n,r,o,i,a;O.typeOf.object("matrix",e);const s=e[Z.COLUMN0ROW0],u=e[Z.COLUMN1ROW1],c=e[Z.COLUMN2ROW2],l=s+u+c;if(l>0)n=Math.sqrt(l+1),a=.5*n,n=.5/n,r=(e[Z.COLUMN1ROW2]-e[Z.COLUMN2ROW1])*n,o=(e[Z.COLUMN2ROW0]-e[Z.COLUMN0ROW2])*n,i=(e[Z.COLUMN0ROW1]-e[Z.COLUMN1ROW0])*n;else{const t=to;let l=0;u>s&&(l=1),c>s&&c>u&&(l=2);const f=t[l],h=t[f];n=Math.sqrt(e[Z.getElementIndex(l,l)]-e[Z.getElementIndex(f,f)]-e[Z.getElementIndex(h,h)]+1);const p=no;p[l]=.5*n,n=.5/n,a=(e[Z.getElementIndex(h,f)]-e[Z.getElementIndex(f,h)])*n,p[f]=(e[Z.getElementIndex(f,l)]+e[Z.getElementIndex(l,f)])*n,p[h]=(e[Z.getElementIndex(h,l)]+e[Z.getElementIndex(l,h)])*n,r=-p[0],o=-p[1],i=-p[2]}return w(t)?(t.x=r,t.y=o,t.z=i,t.w=a,t):new Jr(r,o,i,a)};const ro=new Jr;let oo=new Jr,io=new Jr,ao=new Jr;Jr.fromHeadingPitchRoll=function(e,t){return O.typeOf.object("headingPitchRoll",e),ao=Jr.fromAxisAngle(L.UNIT_X,e.roll,ro),io=Jr.fromAxisAngle(L.UNIT_Y,-e.pitch,t),t=Jr.multiply(io,ao,io),oo=Jr.fromAxisAngle(L.UNIT_Z,-e.heading,ro),Jr.multiply(oo,t,t)};const so=new L,uo=new L,co=new Jr,lo=new Jr,fo=new Jr;Jr.packedLength=4,Jr.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},Jr.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new Jr),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n},Jr.packedInterpolationLength=3,Jr.convertPackedArrayForInterpolation=function(e,t,n,r){Jr.unpack(e,4*n,fo),Jr.conjugate(fo,fo);for(let o=0,i=n-t+1;o<i;o++){const n=3*o;Jr.unpack(e,4*(t+o),co),Jr.multiply(co,fo,co),co.w<0&&Jr.negate(co,co),Jr.computeAxis(co,so);const i=Jr.computeAngle(co);w(r)||(r=[]),r[n]=so.x*i,r[n+1]=so.y*i,r[n+2]=so.z*i}},Jr.unpackInterpolationResult=function(e,t,n,r,o){w(o)||(o=new Jr),L.fromArray(e,0,uo);const i=L.magnitude(uo);return Jr.unpack(t,4*r,lo),0===i?Jr.clone(Jr.IDENTITY,co):Jr.fromAxisAngle(uo,i,co),Jr.multiply(co,lo,o)},Jr.clone=function(e,t){if(w(e))return w(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new Jr(e.x,e.y,e.z,e.w)},Jr.conjugate=function(e,t){return O.typeOf.object("quaternion",e),O.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},Jr.magnitudeSquared=function(e){return O.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},Jr.magnitude=function(e){return Math.sqrt(Jr.magnitudeSquared(e))},Jr.normalize=function(e,t){O.typeOf.object("result",t);const n=1/Jr.magnitude(e),r=e.x*n,o=e.y*n,i=e.z*n,a=e.w*n;return t.x=r,t.y=o,t.z=i,t.w=a,t},Jr.inverse=function(e,t){O.typeOf.object("result",t);const n=Jr.magnitudeSquared(e);return t=Jr.conjugate(e,t),Jr.multiplyByScalar(t,1/n,t)},Jr.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},Jr.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},Jr.negate=function(e,t){return O.typeOf.object("quaternion",e),O.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},Jr.dot=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},Jr.multiply=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e.x,o=e.y,i=e.z,a=e.w,s=t.x,u=t.y,c=t.z,l=t.w,f=a*s+r*l+o*c-i*u,h=a*u-r*c+o*l+i*s,p=a*c+r*u-o*s+i*l,m=a*l-r*s-o*u-i*c;return n.x=f,n.y=h,n.z=p,n.w=m,n},Jr.multiplyByScalar=function(e,t,n){return O.typeOf.object("quaternion",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},Jr.divideByScalar=function(e,t,n){return O.typeOf.object("quaternion",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},Jr.computeAxis=function(e,t){O.typeOf.object("quaternion",e),O.typeOf.object("result",t);const n=e.w;if(Math.abs(n-1)<v.EPSILON6||Math.abs(n+1)<v.EPSILON6)return t.x=1,t.y=t.z=0,t;const r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t},Jr.computeAngle=function(e){return O.typeOf.object("quaternion",e),Math.abs(e.w-1)<v.EPSILON6?0:2*Math.acos(e.w)};let ho=new Jr;Jr.lerp=function(e,t,n,r){return O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r),ho=Jr.multiplyByScalar(t,n,ho),r=Jr.multiplyByScalar(e,1-n,r),Jr.add(ho,r,r)};let po=new Jr,mo=new Jr,yo=new Jr;Jr.slerp=function(e,t,n,r){O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r);let o=Jr.dot(e,t),i=t;if(o<0&&(o=-o,i=po=Jr.negate(t,po)),1-o<v.EPSILON6)return Jr.lerp(e,i,n,r);const a=Math.acos(o);return mo=Jr.multiplyByScalar(e,Math.sin((1-n)*a),mo),yo=Jr.multiplyByScalar(i,Math.sin(n*a),yo),r=Jr.add(mo,yo,r),Jr.multiplyByScalar(r,1/Math.sin(a),r)},Jr.log=function(e,t){O.typeOf.object("quaternion",e),O.typeOf.object("result",t);const n=v.acosClamped(e.w);let r=0;return 0!==n&&(r=n/Math.sin(n)),L.multiplyByScalar(e,r,t)},Jr.exp=function(e,t){O.typeOf.object("cartesian",e),O.typeOf.object("result",t);const n=L.magnitude(e);let r=0;return 0!==n&&(r=Math.sin(n)/n),t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t.w=Math.cos(n),t};const _o=new L,go=new L,Eo=new Jr,bo=new Jr;Jr.computeInnerQuadrangle=function(e,t,n,r){O.typeOf.object("q0",e),O.typeOf.object("q1",t),O.typeOf.object("q2",n),O.typeOf.object("result",r);const o=Jr.conjugate(t,Eo);Jr.multiply(o,n,bo);const i=Jr.log(bo,_o);Jr.multiply(o,e,bo);const a=Jr.log(bo,go);return L.add(i,a,i),L.multiplyByScalar(i,.25,i),L.negate(i,i),Jr.exp(i,Eo),Jr.multiply(t,Eo,r)},Jr.squad=function(e,t,n,r,o,i){O.typeOf.object("q0",e),O.typeOf.object("q1",t),O.typeOf.object("s0",n),O.typeOf.object("s1",r),O.typeOf.number("t",o),O.typeOf.object("result",i);const a=Jr.slerp(e,t,o,Eo),s=Jr.slerp(n,r,o,bo);return Jr.slerp(a,s,2*o*(1-o),i)};const wo=new Jr,To=1.9011074535173003,Oo=pt.supportsTypedArrays()?new Float32Array(8):[],Ao=pt.supportsTypedArrays()?new Float32Array(8):[],xo=pt.supportsTypedArrays()?new Float32Array(8):[],Ro=pt.supportsTypedArrays()?new Float32Array(8):[];for(let ef=0;ef<7;++ef){const e=ef+1,t=2*e+1;Oo[ef]=1/(e*t),Ao[ef]=e/t}Oo[7]=To/136,Ao[7]=8*To/17,Jr.fastSlerp=function(e,t,n,r){O.typeOf.object("start",e),O.typeOf.object("end",t),O.typeOf.number("t",n),O.typeOf.object("result",r);let o,i=Jr.dot(e,t);i>=0?o=1:(o=-1,i=-i);const a=i-1,s=1-n,u=n*n,c=s*s;for(let p=7;p>=0;--p)xo[p]=(Oo[p]*u-Ao[p])*a,Ro[p]=(Oo[p]*c-Ao[p])*a;const l=o*n*(1+xo[0]*(1+xo[1]*(1+xo[2]*(1+xo[3]*(1+xo[4]*(1+xo[5]*(1+xo[6]*(1+xo[7])))))))),f=s*(1+Ro[0]*(1+Ro[1]*(1+Ro[2]*(1+Ro[3]*(1+Ro[4]*(1+Ro[5]*(1+Ro[6]*(1+Ro[7])))))))),h=Jr.multiplyByScalar(e,f,wo);return Jr.multiplyByScalar(t,l,r),Jr.add(h,r,r)},Jr.fastSquad=function(e,t,n,r,o,i){O.typeOf.object("q0",e),O.typeOf.object("q1",t),O.typeOf.object("s0",n),O.typeOf.object("s1",r),O.typeOf.number("t",o),O.typeOf.object("result",i);const a=Jr.fastSlerp(e,t,o,Eo),s=Jr.fastSlerp(n,r,o,bo);return Jr.fastSlerp(a,s,2*o*(1-o),i)},Jr.equals=function(e,t){return e===t||w(e)&&w(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},Jr.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n},Jr.ZERO=Object.freeze(new Jr(0,0,0,0)),Jr.IDENTITY=Object.freeze(new Jr(0,0,0,1)),Jr.prototype.clone=function(e){return Jr.clone(this,e)},Jr.prototype.equals=function(e){return Jr.equals(this,e)},Jr.prototype.equalsEpsilon=function(e,t){return Jr.equalsEpsilon(this,e,t)},Jr.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const So={},Io={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Co={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},No={},vo={east:new L,north:new L,up:new L,west:new L,south:new L,down:new L};let Po=new L,Mo=new L,Lo=new L;So.localFrameToFixedFrameGenerator=function(e,t){if(!Io.hasOwnProperty(e)||!Io[e].hasOwnProperty(t))throw new T("firstAxis and secondAxis must be east, north, up, west, south or down.");const n=Io[e][t];let r;const o=e+t;return w(No[o])?r=No[o]:(r=function(r,o,i){if(!w(r))throw new T("origin is required.");if(isNaN(r.x)||isNaN(r.y)||isNaN(r.z))throw new T("origin has a NaN component");if(w(i)||(i=new he),L.equalsEpsilon(r,L.ZERO,v.EPSILON14))L.unpack(Co[e],0,Po),L.unpack(Co[t],0,Mo),L.unpack(Co[n],0,Lo);else if(v.equalsEpsilon(r.x,0,v.EPSILON14)&&v.equalsEpsilon(r.y,0,v.EPSILON14)){const o=v.sign(r.z);L.unpack(Co[e],0,Po),"east"!==e&&"west"!==e&&L.multiplyByScalar(Po,o,Po),L.unpack(Co[t],0,Mo),"east"!==t&&"west"!==t&&L.multiplyByScalar(Mo,o,Mo),L.unpack(Co[n],0,Lo),"east"!==n&&"west"!==n&&L.multiplyByScalar(Lo,o,Lo)}else{(o=o??zt.default).geodeticSurfaceNormal(r,vo.up);const i=vo.up,a=vo.east;a.x=-r.y,a.y=r.x,a.z=0,L.normalize(a,vo.east),L.cross(i,a,vo.north),L.multiplyByScalar(vo.up,-1,vo.down),L.multiplyByScalar(vo.east,-1,vo.west),L.multiplyByScalar(vo.north,-1,vo.south),Po=vo[e],Mo=vo[t],Lo=vo[n]}return i[0]=Po.x,i[1]=Po.y,i[2]=Po.z,i[3]=0,i[4]=Mo.x,i[5]=Mo.y,i[6]=Mo.z,i[7]=0,i[8]=Lo.x,i[9]=Lo.y,i[10]=Lo.z,i[11]=0,i[12]=r.x,i[13]=r.y,i[14]=r.z,i[15]=1,i},No[o]=r),r},So.eastNorthUpToFixedFrame=So.localFrameToFixedFrameGenerator("east","north"),So.northEastDownToFixedFrame=So.localFrameToFixedFrameGenerator("north","east"),So.northUpEastToFixedFrame=So.localFrameToFixedFrameGenerator("north","up"),So.northWestUpToFixedFrame=So.localFrameToFixedFrameGenerator("north","west");const Fo=new Jr,Do=new L(1,1,1),zo=new he;So.headingPitchRollToFixedFrame=function(e,t,n,r,o){O.typeOf.object("HeadingPitchRoll",t),r=r??So.eastNorthUpToFixedFrame;const i=Jr.fromHeadingPitchRoll(t,Fo),a=he.fromTranslationQuaternionRotationScale(L.ZERO,i,Do,zo);return o=r(e,n,o),he.multiply(o,a,o)};const Bo=new he,Uo=new Z;So.headingPitchRollQuaternion=function(e,t,n,r,o){O.typeOf.object("HeadingPitchRoll",t);const i=So.headingPitchRollToFixedFrame(e,t,n,r,Bo),a=he.getMatrix3(i,Uo);return Jr.fromRotationMatrix(a,o)};const jo=new L(1,1,1),qo=new L,Go=new he,ko=new he,Wo=new Z,Vo=new Jr;So.fixedFrameToHeadingPitchRoll=function(e,t,n,r){O.defined("transform",e),t=t??zt.default,n=n??So.eastNorthUpToFixedFrame,w(r)||(r=new Br);const o=he.getTranslation(e,qo);if(L.equals(o,L.ZERO))return r.heading=0,r.pitch=0,r.roll=0,r;let i=he.inverseTransformation(n(o,t,Go),Go),a=he.setScale(e,jo,ko);a=he.setTranslation(a,L.ZERO,a),i=he.multiply(i,a,i);let s=Jr.fromRotationMatrix(he.getMatrix3(i,Wo),Vo);return s=Jr.normalize(s,s),Br.fromQuaternion(s,r)};const Ho=v.TWO_PI/86400;let Yo=new Tn;So.computeIcrfToCentralBodyFixedMatrix=function(e,t){let n=So.computeIcrfToFixedMatrix(e,t);return w(n)||(n=So.computeTemeToPseudoFixedMatrix(e,t)),n},So.computeTemeToPseudoFixedMatrix=function(e,t){if(!w(e))throw new T("date is required.");Yo=Tn.addSeconds(e,-Tn.computeTaiMinusUtc(e),Yo);const n=Yo.dayNumber,r=Yo.secondsOfDay;let o;const i=n-2451545;o=r>=43200?(i+.5)/tn.DAYS_PER_JULIAN_CENTURY:(i-.5)/tn.DAYS_PER_JULIAN_CENTURY;const a=(24110.54841+o*(8640184.812866+o*(.093104+-62e-7*o)))*Ho%v.TWO_PI+(72921158553e-15+11772758384668e-32*(n-2451545.5))*((r+.5*tn.SECONDS_PER_DAY)%tn.SECONDS_PER_DAY),s=Math.cos(a),u=Math.sin(a);return w(t)?(t[0]=s,t[1]=-u,t[2]=0,t[3]=u,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Z(s,u,0,-u,s,0,0,0,1)},So.iau2006XysData=new $r,So.earthOrientationParameters=Pr.NONE;const Xo=32.184;So.preloadIcrfFixed=function(e){const t=e.start.dayNumber,n=e.start.secondsOfDay+Xo,r=e.stop.dayNumber,o=e.stop.secondsOfDay+Xo;return So.iau2006XysData.preload(t,n,r,o)},So.computeIcrfToFixedMatrix=function(e,t){if(!w(e))throw new T("date is required.");w(t)||(t=new Z);const n=So.computeFixedToIcrfMatrix(e,t);if(w(n))return Z.transpose(n,t)};const $o=new Br,Ko=new Z,Zo=new Tn;So.computeMoonFixedToIcrfMatrix=function(e,t){if(!w(e))throw new T("date is required.");const n=Tn.addSeconds(e,32.184,Zo),r=Tn.totalDays(n)-2451545,o=v.toRadians(12.112)-v.toRadians(.052992)*r,i=v.toRadians(24.224)-v.toRadians(.105984)*r,a=v.toRadians(227.645)+v.toRadians(13.012)*r,s=v.toRadians(261.105)+v.toRadians(13.340716)*r,u=v.toRadians(358)+v.toRadians(.9856)*r;return $o.pitch=v.toRadians(180)-v.toRadians(3.878)*Math.sin(o)-v.toRadians(.12)*Math.sin(i)+v.toRadians(.07)*Math.sin(a)-v.toRadians(.017)*Math.sin(s),$o.roll=v.toRadians(-23.47)+v.toRadians(1.543)*Math.cos(o)+v.toRadians(.24)*Math.cos(i)-v.toRadians(.028)*Math.cos(a)+v.toRadians(.007)*Math.cos(s),$o.heading=v.toRadians(154.375)+v.toRadians(13.17635831)*r+v.toRadians(3.558)*Math.sin(o)+v.toRadians(.121)*Math.sin(i)-v.toRadians(.064)*Math.sin(a)+v.toRadians(.016)*Math.sin(s)+v.toRadians(.025)*Math.sin(u),Z.fromHeadingPitchRoll($o,Ko)},So.computeIcrfToMoonFixedMatrix=function(e,t){if(!w(e))throw new T("date is required.");w(t)||(t=new Z);const n=So.computeMoonFixedToIcrfMatrix(e,t);if(w(n))return Z.transpose(n,t)};const Qo=new Xr(0,0,0),Jo=new Kt(0,0,0,0,0),ei=new Z,ti=new Z;So.computeFixedToIcrfMatrix=function(e,t){if(!w(e))throw new T("date is required.");w(t)||(t=new Z);const n=So.earthOrientationParameters.compute(e,Jo);if(!w(n))return;const r=e.dayNumber,o=e.secondsOfDay+Xo,i=So.iau2006XysData.computeXysRadians(r,o,Qo);if(!w(i))return;const a=i.x+n.xPoleOffset,s=i.y+n.yPoleOffset,u=1/(1+Math.sqrt(1-a*a-s*s)),c=ei;c[0]=1-u*a*a,c[3]=-u*a*s,c[6]=a,c[1]=-u*a*s,c[4]=1-u*s*s,c[7]=s,c[2]=-a,c[5]=-s,c[8]=1-u*(a*a+s*s);const l=Z.fromRotationZ(-i.s,ti),f=Z.multiply(c,l,ei),h=e.dayNumber-2451545,p=(e.secondsOfDay-Tn.computeTaiMinusUtc(e)+n.ut1MinusUtc)/tn.SECONDS_PER_DAY;let m=.779057273264+p+.00273781191135448*(h+p);m=m%1*v.TWO_PI;const d=Z.fromRotationZ(m,ti),y=Z.multiply(f,d,ei),_=Math.cos(n.xPoleWander),g=Math.cos(n.yPoleWander),E=Math.sin(n.xPoleWander),b=Math.sin(n.yPoleWander);let O=r-2451545+o/tn.SECONDS_PER_DAY;O/=36525;const A=-47e-6*O*v.RADIANS_PER_DEGREE/3600,x=Math.cos(A),R=Math.sin(A),S=ti;return S[0]=_*x,S[1]=_*R,S[2]=E,S[3]=-g*R+b*E*x,S[4]=g*x+b*E*R,S[5]=-b*_,S[6]=-b*R-g*E*x,S[7]=b*x-g*E*R,S[8]=g*_,Z.multiply(y,S,t)};const ni=new G;So.pointToWindowCoordinates=function(e,t,n,r){return(r=So.pointToGLWindowCoordinates(e,t,n,r)).y=2*t[5]-r.y,r},So.pointToGLWindowCoordinates=function(e,t,n,r){if(!w(e))throw new T("modelViewProjectionMatrix is required.");if(!w(t))throw new T("viewportTransformation is required.");if(!w(n))throw new T("point is required.");w(r)||(r=new Ot);const o=ni;return he.multiplyByVector(e,G.fromElements(n.x,n.y,n.z,1,o),o),G.multiplyByScalar(o,1/o.w,o),he.multiplyByVector(t,o,o),Ot.fromCartesian4(o,r)};const ri=new L,oi=new L,ii=new L;So.rotationMatrixFromPositionVelocity=function(e,t,n,r){if(!w(e))throw new T("position is required.");if(!w(t))throw new T("velocity is required.");const o=(n??zt.default).geodeticSurfaceNormal(e,ri);let i=L.cross(t,o,oi);L.equalsEpsilon(i,L.ZERO,v.EPSILON6)&&(i=L.clone(L.UNIT_X,i));const a=L.cross(i,t,ii);return L.normalize(a,a),L.cross(t,a,i),L.negate(i,i),L.normalize(i,i),w(r)||(r=new Z),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=i.x,r[4]=i.y,r[5]=i.z,r[6]=a.x,r[7]=a.y,r[8]=a.z,r};const ai=new he(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),si=new Pt,ui=new L,ci=new L,li=new Z,fi=new he,hi=new he;function pi(e,t,n,r){this.west=e??0,this.south=t??0,this.east=n??0,this.north=r??0}So.basisTo2D=function(e,t,n){if(!w(e))throw new T("projection is required.");if(!w(t))throw new T("matrix is required.");if(!w(n))throw new T("result is required.");const r=he.getTranslation(t,ci),o=e.ellipsoid;let i;if(L.equals(r,L.ZERO))i=L.clone(L.ZERO,ui);else{const t=o.cartesianToCartographic(r,si);i=e.project(t,ui),L.fromElements(i.z,i.x,i.y,i)}const a=So.eastNorthUpToFixedFrame(r,o,fi),s=he.inverseTransformation(a,hi),u=he.getMatrix3(t,li),c=he.multiplyByMatrix3(s,u,n);return he.multiply(ai,c,n),he.setTranslation(n,i,n),n},So.ellipsoidTo2DModelMatrix=function(e,t,n){if(!w(e))throw new T("projection is required.");if(!w(t))throw new T("center is required.");if(!w(n))throw new T("result is required.");const r=e.ellipsoid,o=So.eastNorthUpToFixedFrame(t,r,fi),i=he.inverseTransformation(o,hi),a=r.cartesianToCartographic(t,si),s=e.project(a,ui);L.fromElements(s.z,s.x,s.y,s);const u=he.fromTranslation(s,fi);return he.multiply(ai,i,n),he.multiply(u,n,n),n},Object.defineProperties(pi.prototype,{width:{get:function(){return pi.computeWidth(this)}},height:{get:function(){return pi.computeHeight(this)}}}),pi.packedLength=4,pi.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e.west,t[n++]=e.south,t[n++]=e.east,t[n]=e.north,t},pi.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new pi),n.west=e[t++],n.south=e[t++],n.east=e[t++],n.north=e[t],n},pi.computeWidth=function(e){O.typeOf.object("rectangle",e);let t=e.east;const n=e.west;return t<n&&(t+=v.TWO_PI),t-n},pi.computeHeight=function(e){return O.typeOf.object("rectangle",e),e.north-e.south},pi.fromDegrees=function(e,t,n,r,o){return e=v.toRadians(e??0),t=v.toRadians(t??0),n=v.toRadians(n??0),r=v.toRadians(r??0),w(o)?(o.west=e,o.south=t,o.east=n,o.north=r,o):new pi(e,t,n,r)},pi.fromRadians=function(e,t,n,r,o){return w(o)?(o.west=e??0,o.south=t??0,o.east=n??0,o.north=r??0,o):new pi(e,t,n,r)},pi.fromCartographicArray=function(e,t){O.defined("cartographics",e);let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,i=-Number.MAX_VALUE,a=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let u=0,c=e.length;u<c;u++){const t=e[u];n=Math.min(n,t.longitude),r=Math.max(r,t.longitude),a=Math.min(a,t.latitude),s=Math.max(s,t.latitude);const c=t.longitude>=0?t.longitude:t.longitude+v.TWO_PI;o=Math.min(o,c),i=Math.max(i,c)}return r-n>i-o&&(n=o,r=i,r>v.PI&&(r-=v.TWO_PI),n>v.PI&&(n-=v.TWO_PI)),w(t)?(t.west=n,t.south=a,t.east=r,t.north=s,t):new pi(n,a,r,s)},pi.fromCartesianArray=function(e,t,n){O.defined("cartesians",e),t=t??zt.default;let r=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let c=0,l=e.length;c<l;c++){const n=t.cartesianToCartographic(e[c]);r=Math.min(r,n.longitude),o=Math.max(o,n.longitude),s=Math.min(s,n.latitude),u=Math.max(u,n.latitude);const l=n.longitude>=0?n.longitude:n.longitude+v.TWO_PI;i=Math.min(i,l),a=Math.max(a,l)}return o-r>a-i&&(r=i,o=a,o>v.PI&&(o-=v.TWO_PI),r>v.PI&&(r-=v.TWO_PI)),w(n)?(n.west=r,n.south=s,n.east=o,n.north=u,n):new pi(r,s,o,u)};const mi=new L,di=new L,yi=new L,_i=new L,gi=new L,Ei=new Array(5);for(let ef=0;ef<Ei.length;++ef)Ei[ef]=new L;pi.fromBoundingSphere=function(e,t,n){O.typeOf.object("boundingSphere",e);const r=e.center,o=e.radius;if(w(t)||(t=zt.default),w(n)||(n=new pi),L.equals(r,L.ZERO))return pi.clone(pi.MAX_VALUE,n),n;const i=So.eastNorthUpToFixedFrame(r,t,mi),a=he.multiplyByPointAsVector(i,L.UNIT_X,di);L.normalize(a,a);const s=he.multiplyByPointAsVector(i,L.UNIT_Y,yi);L.normalize(s,s),L.multiplyByScalar(s,o,s),L.multiplyByScalar(a,o,a);const u=L.negate(s,gi),c=L.negate(a,_i),l=Ei;let f=l[0];return L.add(r,s,f),f=l[1],L.add(r,c,f),f=l[2],L.add(r,u,f),f=l[3],L.add(r,a,f),l[4]=r,pi.fromCartesianArray(l,t,n)},pi.clone=function(e,t){if(w(e))return w(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new pi(e.west,e.south,e.east,e.north)},pi.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e.west-t.west)<=n&&Math.abs(e.south-t.south)<=n&&Math.abs(e.east-t.east)<=n&&Math.abs(e.north-t.north)<=n},pi.prototype.clone=function(e){return pi.clone(this,e)},pi.prototype.equals=function(e){return pi.equals(this,e)},pi.equals=function(e,t){return e===t||w(e)&&w(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},pi.prototype.equalsEpsilon=function(e,t){return pi.equalsEpsilon(this,e,t)},pi._validate=function(e){O.typeOf.object("rectangle",e);const t=e.north;O.typeOf.number.greaterThanOrEquals("north",t,-v.PI_OVER_TWO),O.typeOf.number.lessThanOrEquals("north",t,v.PI_OVER_TWO);const n=e.south;O.typeOf.number.greaterThanOrEquals("south",n,-v.PI_OVER_TWO),O.typeOf.number.lessThanOrEquals("south",n,v.PI_OVER_TWO);const r=e.west;O.typeOf.number.greaterThanOrEquals("west",r,-Math.PI),O.typeOf.number.lessThanOrEquals("west",r,Math.PI);const o=e.east;O.typeOf.number.greaterThanOrEquals("east",o,-Math.PI),O.typeOf.number.lessThanOrEquals("east",o,Math.PI)},pi.southwest=function(e,t){return O.typeOf.object("rectangle",e),w(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new Pt(e.west,e.south)},pi.northwest=function(e,t){return O.typeOf.object("rectangle",e),w(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new Pt(e.west,e.north)},pi.northeast=function(e,t){return O.typeOf.object("rectangle",e),w(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new Pt(e.east,e.north)},pi.southeast=function(e,t){return O.typeOf.object("rectangle",e),w(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new Pt(e.east,e.south)},pi.center=function(e,t){O.typeOf.object("rectangle",e);let n=e.east;const r=e.west;n<r&&(n+=v.TWO_PI);const o=v.negativePiToPi(.5*(r+n)),i=.5*(e.south+e.north);return w(t)?(t.longitude=o,t.latitude=i,t.height=0,t):new Pt(o,i)},pi.intersection=function(e,t,n){O.typeOf.object("rectangle",e),O.typeOf.object("otherRectangle",t);let r=e.east,o=e.west,i=t.east,a=t.west;r<o&&i>0?r+=v.TWO_PI:i<a&&r>0&&(i+=v.TWO_PI),r<o&&a<0?a+=v.TWO_PI:i<a&&o<0&&(o+=v.TWO_PI);const s=v.negativePiToPi(Math.max(o,a)),u=v.negativePiToPi(Math.min(r,i));if((e.west<e.east||t.west<t.east)&&u<=s)return;const c=Math.max(e.south,t.south),l=Math.min(e.north,t.north);return c>=l?void 0:w(n)?(n.west=s,n.south=c,n.east=u,n.north=l,n):new pi(s,c,u,l)},pi.simpleIntersection=function(e,t,n){O.typeOf.object("rectangle",e),O.typeOf.object("otherRectangle",t);const r=Math.max(e.west,t.west),o=Math.max(e.south,t.south),i=Math.min(e.east,t.east),a=Math.min(e.north,t.north);if(!(o>=a||r>=i))return w(n)?(n.west=r,n.south=o,n.east=i,n.north=a,n):new pi(r,o,i,a)},pi.union=function(e,t,n){O.typeOf.object("rectangle",e),O.typeOf.object("otherRectangle",t),w(n)||(n=new pi);let r=e.east,o=e.west,i=t.east,a=t.west;r<o&&i>0?r+=v.TWO_PI:i<a&&r>0&&(i+=v.TWO_PI),r<o&&a<0?a+=v.TWO_PI:i<a&&o<0&&(o+=v.TWO_PI);const s=v.negativePiToPi(Math.min(o,a)),u=v.negativePiToPi(Math.max(r,i));return n.west=s,n.south=Math.min(e.south,t.south),n.east=u,n.north=Math.max(e.north,t.north),n},pi.expand=function(e,t,n){return O.typeOf.object("rectangle",e),O.typeOf.object("cartographic",t),w(n)||(n=new pi),n.west=Math.min(e.west,t.longitude),n.south=Math.min(e.south,t.latitude),n.east=Math.max(e.east,t.longitude),n.north=Math.max(e.north,t.latitude),n},pi.contains=function(e,t){O.typeOf.object("rectangle",e),O.typeOf.object("cartographic",t);let n=t.longitude;const r=t.latitude,o=e.west;let i=e.east;return i<o&&(i+=v.TWO_PI,n<0&&(n+=v.TWO_PI)),(n>o||v.equalsEpsilon(n,o,v.EPSILON14))&&(n<i||v.equalsEpsilon(n,i,v.EPSILON14))&&r>=e.south&&r<=e.north};const bi=new Pt;pi.subsample=function(e,t,n,r){O.typeOf.object("rectangle",e),t=t??zt.default,n=n??0,w(r)||(r=[]);let o=0;const i=e.north,a=e.south,s=e.east,u=e.west,c=bi;c.height=n,c.longitude=u,c.latitude=i,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=a,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.latitude=i<0?i:a>0?a:0;for(let l=1;l<8;++l)c.longitude=-Math.PI+l*v.PI_OVER_TWO,pi.contains(e,c)&&(r[o]=t.cartographicToCartesian(c,r[o]),o++);return 0===c.latitude&&(c.longitude=u,r[o]=t.cartographicToCartesian(c,r[o]),o++,c.longitude=s,r[o]=t.cartographicToCartesian(c,r[o]),o++),r.length=o,r},pi.subsection=function(e,t,n,r,o,i){if(O.typeOf.object("rectangle",e),O.typeOf.number.greaterThanOrEquals("westLerp",t,0),O.typeOf.number.lessThanOrEquals("westLerp",t,1),O.typeOf.number.greaterThanOrEquals("southLerp",n,0),O.typeOf.number.lessThanOrEquals("southLerp",n,1),O.typeOf.number.greaterThanOrEquals("eastLerp",r,0),O.typeOf.number.lessThanOrEquals("eastLerp",r,1),O.typeOf.number.greaterThanOrEquals("northLerp",o,0),O.typeOf.number.lessThanOrEquals("northLerp",o,1),O.typeOf.number.lessThanOrEquals("westLerp",t,r),O.typeOf.number.lessThanOrEquals("southLerp",n,o),w(i)||(i=new pi),e.west<=e.east){const n=e.east-e.west;i.west=e.west+t*n,i.east=e.west+r*n}else{const n=v.TWO_PI+e.east-e.west;i.west=v.negativePiToPi(e.west+t*n),i.east=v.negativePiToPi(e.west+r*n)}const a=e.north-e.south;return i.south=e.south+n*a,i.north=e.south+o*a,1===t&&(i.west=e.east),1===r&&(i.east=e.east),1===n&&(i.south=e.north),1===o&&(i.north=e.north),i},pi.MAX_VALUE=Object.freeze(new pi(-Math.PI,-v.PI_OVER_TWO,Math.PI,v.PI_OVER_TWO));const wi={POINTS:Se.POINTS,LINES:Se.LINES,LINE_LOOP:Se.LINE_LOOP,LINE_STRIP:Se.LINE_STRIP,TRIANGLES:Se.TRIANGLES,TRIANGLE_STRIP:Se.TRIANGLE_STRIP,TRIANGLE_FAN:Se.TRIANGLE_FAN,isLines:function(e){return e===wi.LINES||e===wi.LINE_LOOP||e===wi.LINE_STRIP},isTriangles:function(e){return e===wi.TRIANGLES||e===wi.TRIANGLE_STRIP||e===wi.TRIANGLE_FAN},validate:function(e){return e===wi.POINTS||e===wi.LINES||e===wi.LINE_LOOP||e===wi.LINE_STRIP||e===wi.TRIANGLES||e===wi.TRIANGLE_STRIP||e===wi.TRIANGLE_FAN}};var Ti=Object.freeze(wi);const Oi={UNSIGNED_BYTE:Se.UNSIGNED_BYTE,UNSIGNED_SHORT:Se.UNSIGNED_SHORT,UNSIGNED_INT:Se.UNSIGNED_INT,FLOAT:Se.FLOAT,HALF_FLOAT:Se.HALF_FLOAT_OES,UNSIGNED_INT_24_8:Se.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:Se.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:Se.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:Se.UNSIGNED_SHORT_5_6_5,toWebGLConstant:function(e,t){switch(e){case Oi.UNSIGNED_BYTE:return Se.UNSIGNED_BYTE;case Oi.UNSIGNED_SHORT:return Se.UNSIGNED_SHORT;case Oi.UNSIGNED_INT:return Se.UNSIGNED_INT;case Oi.FLOAT:return Se.FLOAT;case Oi.HALF_FLOAT:return t.webgl2?Se.HALF_FLOAT:Se.HALF_FLOAT_OES;case Oi.UNSIGNED_INT_24_8:return Se.UNSIGNED_INT_24_8;case Oi.UNSIGNED_SHORT_4_4_4_4:return Se.UNSIGNED_SHORT_4_4_4_4;case Oi.UNSIGNED_SHORT_5_5_5_1:return Se.UNSIGNED_SHORT_5_5_5_1;case Oi.UNSIGNED_SHORT_5_6_5:return Oi.UNSIGNED_SHORT_5_6_5}},isPacked:function(e){return e===Oi.UNSIGNED_INT_24_8||e===Oi.UNSIGNED_SHORT_4_4_4_4||e===Oi.UNSIGNED_SHORT_5_5_5_1||e===Oi.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case Oi.UNSIGNED_BYTE:return 1;case Oi.UNSIGNED_SHORT:case Oi.UNSIGNED_SHORT_4_4_4_4:case Oi.UNSIGNED_SHORT_5_5_5_1:case Oi.UNSIGNED_SHORT_5_6_5:case Oi.HALF_FLOAT:return 2;case Oi.UNSIGNED_INT:case Oi.FLOAT:case Oi.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===Oi.UNSIGNED_BYTE||e===Oi.UNSIGNED_SHORT||e===Oi.UNSIGNED_INT||e===Oi.FLOAT||e===Oi.HALF_FLOAT||e===Oi.UNSIGNED_INT_24_8||e===Oi.UNSIGNED_SHORT_4_4_4_4||e===Oi.UNSIGNED_SHORT_5_5_5_1||e===Oi.UNSIGNED_SHORT_5_6_5},getTypedArrayConstructor:function(e){const t=Oi.sizeInBytes(e);return t===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:t===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:t===Float32Array.BYTES_PER_ELEMENT&&e===Oi.FLOAT?Float32Array:Uint32Array}};var Ai=Object.freeze(Oi);const xi={DEPTH_COMPONENT:Se.DEPTH_COMPONENT,DEPTH_STENCIL:Se.DEPTH_STENCIL,ALPHA:Se.ALPHA,RED:Se.RED,RG:Se.RG,RGB:Se.RGB,RGBA:Se.RGBA,RED_INTEGER:Se.RED_INTEGER,RG_INTEGER:Se.RG_INTEGER,RGB_INTEGER:Se.RGB_INTEGER,RGBA_INTEGER:Se.RGBA_INTEGER,LUMINANCE:Se.LUMINANCE,LUMINANCE_ALPHA:Se.LUMINANCE_ALPHA,RGB_DXT1:Se.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:Se.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:Se.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:Se.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:Se.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:Se.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:Se.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:Se.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:Se.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:Se.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:Se.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:Se.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:Se.COMPRESSED_RGBA_BPTC_UNORM,componentsLength:function(e){switch(e){case xi.RGB:case xi.RGB_INTEGER:return 3;case xi.RGBA:case xi.RGBA_INTEGER:return 4;case xi.LUMINANCE_ALPHA:case xi.RG:case xi.RG_INTEGER:return 2;case xi.ALPHA:case xi.RED:case xi.RED_INTEGER:case xi.LUMINANCE:default:return 1}},validate:function(e){return e===xi.DEPTH_COMPONENT||e===xi.DEPTH_STENCIL||e===xi.ALPHA||e===xi.RED||e===xi.RG||e===xi.RGB||e===xi.RGBA||e===xi.RED_INTEGER||e===xi.RG_INTEGER||e===xi.RGB_INTEGER||e===xi.RGBA_INTEGER||e===xi.LUMINANCE||e===xi.LUMINANCE_ALPHA||e===xi.RGB_DXT1||e===xi.RGBA_DXT1||e===xi.RGBA_DXT3||e===xi.RGBA_DXT5||e===xi.RGB_PVRTC_4BPPV1||e===xi.RGB_PVRTC_2BPPV1||e===xi.RGBA_PVRTC_4BPPV1||e===xi.RGBA_PVRTC_2BPPV1||e===xi.RGBA_ASTC||e===xi.RGB_ETC1||e===xi.RGB8_ETC2||e===xi.RGBA8_ETC2_EAC||e===xi.RGBA_BC7},isColorFormat:function(e){return e===xi.RED||e===xi.ALPHA||e===xi.RGB||e===xi.RGBA||e===xi.LUMINANCE||e===xi.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===xi.DEPTH_COMPONENT||e===xi.DEPTH_STENCIL},isCompressedFormat:function(e){return e===xi.RGB_DXT1||e===xi.RGBA_DXT1||e===xi.RGBA_DXT3||e===xi.RGBA_DXT5||e===xi.RGB_PVRTC_4BPPV1||e===xi.RGB_PVRTC_2BPPV1||e===xi.RGBA_PVRTC_4BPPV1||e===xi.RGBA_PVRTC_2BPPV1||e===xi.RGBA_ASTC||e===xi.RGB_ETC1||e===xi.RGB8_ETC2||e===xi.RGBA8_ETC2_EAC||e===xi.RGBA_BC7},isDXTFormat:function(e){return e===xi.RGB_DXT1||e===xi.RGBA_DXT1||e===xi.RGBA_DXT3||e===xi.RGBA_DXT5},isPVRTCFormat:function(e){return e===xi.RGB_PVRTC_4BPPV1||e===xi.RGB_PVRTC_2BPPV1||e===xi.RGBA_PVRTC_4BPPV1||e===xi.RGBA_PVRTC_2BPPV1},isASTCFormat:function(e){return e===xi.RGBA_ASTC},isETC1Format:function(e){return e===xi.RGB_ETC1},isETC2Format:function(e){return e===xi.RGB8_ETC2||e===xi.RGBA8_ETC2_EAC},isBC7Format:function(e){return e===xi.RGBA_BC7},compressedTextureSizeInBytes:function(e,t,n){switch(e){case xi.RGB_DXT1:case xi.RGBA_DXT1:case xi.RGB_ETC1:case xi.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*8;case xi.RGBA_DXT3:case xi.RGBA_DXT5:case xi.RGBA_ASTC:case xi.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((n+3)/4)*16;case xi.RGB_PVRTC_4BPPV1:case xi.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(n,8)*4+7)/8);case xi.RGB_PVRTC_2BPPV1:case xi.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(n,8)*2+7)/8);case xi.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(n/4)*16;default:return 0}},textureSizeInBytes:function(e,t,n,r){let o=xi.componentsLength(e);return Ai.isPacked(t)&&(o=1),o*Ai.sizeInBytes(t)*n*r},texture3DSizeInBytes:function(e,t,n,r,o){let i=xi.componentsLength(e);return Ai.isPacked(t)&&(i=1),i*Ai.sizeInBytes(t)*n*r*o},alignmentInBytes:function(e,t,n){const r=xi.textureSizeInBytes(e,t,n,1)%4;return 0===r?4:2===r?2:1},createTypedArray:function(e,t,n,r){return new(Ai.getTypedArrayConstructor(t))(xi.componentsLength(e)*n*r)},flipY:function(e,t,n,r,o){if(1===o)return e;const i=xi.createTypedArray(t,n,r,o),a=xi.componentsLength(t),s=r*a;for(let u=0;u<o;++u){const t=u*r*a,n=(o-u-1)*r*a;for(let r=0;r<s;++r)i[n+r]=e[t+r]}return i},toInternalFormat:function(e,t,n){if(!n.webgl2)return e;if(e===xi.DEPTH_STENCIL)return Se.DEPTH24_STENCIL8;if(e===xi.DEPTH_COMPONENT){if(t===Ai.UNSIGNED_SHORT)return Se.DEPTH_COMPONENT16;if(t===Ai.UNSIGNED_INT)return Se.DEPTH_COMPONENT24}if(t===Ai.FLOAT)switch(e){case xi.RGBA:return Se.RGBA32F;case xi.RGB:return Se.RGB32F;case xi.RG:return Se.RG32F;case xi.RED:return Se.R32F}if(t===Ai.HALF_FLOAT)switch(e){case xi.RGBA:return Se.RGBA16F;case xi.RGB:return Se.RGB16F;case xi.RG:return Se.RG16F;case xi.RED:return Se.R16F}if(t===Ai.UNSIGNED_BYTE)switch(e){case xi.RGBA:return Se.RGBA8;case xi.RGB:return Se.RGB8;case xi.RG:return Se.RG8;case xi.RED:return Se.R8}if(t===Ai.INT)switch(e){case xi.RGBA_INTEGER:return Se.RGBA32I;case xi.RGB_INTEGER:return Se.RGB32I;case xi.RG_INTEGER:return Se.RG32I;case xi.RED_INTEGER:return Se.R32I}if(t===Ai.UNSIGNED_INT)switch(e){case xi.RGBA_INTEGER:return Se.RGBA32UI;case xi.RGB_INTEGER:return Se.RGB32UI;case xi.RG_INTEGER:return Se.RG32UI;case xi.RED_INTEGER:return Se.R32UI}return e}};var Ri=Object.freeze(xi);const Si={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};function Ii(e,t,n){const r=e._gl;r.framebufferTexture2D(r.FRAMEBUFFER,t,n._target,n._texture,0)}function Ci(e,t,n){const r=e._gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n._getRenderbuffer())}function Ni(e){const t=(e=e??K.EMPTY_OBJECT).context;O.defined("options.context",t);const n=t._gl,r=Si.maximumColorAttachments;if(this._gl=n,this._framebuffer=n.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=e.destroyAttachments??!0,w(e.colorTextures)&&w(e.colorRenderbuffers))throw new T("Cannot have both color texture and color renderbuffer attachments.");if(w(e.depthTexture)&&w(e.depthRenderbuffer))throw new T("Cannot have both a depth texture and depth renderbuffer attachment.");if(w(e.depthStencilTexture)&&w(e.depthStencilRenderbuffer))throw new T("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.");const o=w(e.depthTexture)||w(e.depthRenderbuffer),i=w(e.depthStencilTexture)||w(e.depthStencilRenderbuffer);if(o&&i)throw new T("Cannot have both a depth and depth-stencil attachment.");if(w(e.stencilRenderbuffer)&&i)throw new T("Cannot have both a stencil and depth-stencil attachment.");if(o&&w(e.stencilRenderbuffer))throw new T("Cannot have both a depth and stencil attachment.");if(this._bind(),w(e.colorTextures)){const n=e.colorTextures,o=this._colorTextures.length=this._activeColorAttachments.length=n.length;if(o>r)throw new T("The number of color attachments exceeds the number supported.");for(let e=0;e<o;++e){const r=n[e];if(!Ri.isColorFormat(r.pixelFormat))throw new T("The color-texture pixel-format must be a color format.");if(r.pixelDatatype===Ai.FLOAT&&!t.colorBufferFloat)throw new T("The color texture pixel datatype is FLOAT and the WebGL implementation does not support the EXT_color_buffer_float or WEBGL_color_buffer_float extensions. See Context.colorBufferFloat.");if(r.pixelDatatype===Ai.HALF_FLOAT&&!t.colorBufferHalfFloat)throw new T("The color texture pixel datatype is HALF_FLOAT and the WebGL implementation does not support the EXT_color_buffer_half_float extension. See Context.colorBufferHalfFloat.");const o=this._gl.COLOR_ATTACHMENT0+e;Ii(this,o,r),this._activeColorAttachments[e]=o,this._colorTextures[e]=r}}if(w(e.colorRenderbuffers)){const t=e.colorRenderbuffers,n=this._colorRenderbuffers.length=this._activeColorAttachments.length=t.length;if(n>r)throw new T("The number of color attachments exceeds the number supported.");for(let e=0;e<n;++e){const n=t[e],r=this._gl.COLOR_ATTACHMENT0+e;Ci(this,r,n),this._activeColorAttachments[e]=r,this._colorRenderbuffers[e]=n}}if(w(e.depthTexture)){const t=e.depthTexture;if(t.pixelFormat!==Ri.DEPTH_COMPONENT)throw new T("The depth-texture pixel-format must be DEPTH_COMPONENT.");Ii(this,this._gl.DEPTH_ATTACHMENT,t),this._depthTexture=t}if(w(e.depthRenderbuffer)){const t=e.depthRenderbuffer;Ci(this,this._gl.DEPTH_ATTACHMENT,t),this._depthRenderbuffer=t}if(w(e.stencilRenderbuffer)){const t=e.stencilRenderbuffer;Ci(this,this._gl.STENCIL_ATTACHMENT,t),this._stencilRenderbuffer=t}if(w(e.depthStencilTexture)){const t=e.depthStencilTexture;if(t.pixelFormat!==Ri.DEPTH_STENCIL)throw new T("The depth-stencil pixel-format must be DEPTH_STENCIL.");Ii(this,this._gl.DEPTH_STENCIL_ATTACHMENT,t),this._depthStencilTexture=t}if(w(e.depthStencilRenderbuffer)){const t=e.depthStencilRenderbuffer;Ci(this,this._gl.DEPTH_STENCIL_ATTACHMENT,t),this._depthStencilRenderbuffer=t}this._unBind()}function vi(e,t,n,r){this[0]=e??0,this[1]=n??0,this[2]=t??0,this[3]=r??0}Object.defineProperties(Si,{maximumCombinedTextureImageUnits:{get:function(){return Si._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return Si._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return Si._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return Si._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return Si._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return Si._maximumTextureSize}},maximumVaryingVectors:{get:function(){return Si._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return Si._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return Si._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return Si._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return Si._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return Si._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return Si._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return Si._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return Si._maximumViewportWidth}},maximumViewportHeight:{get:function(){return Si._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return Si._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return Si._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return Si._maximumColorAttachments}},maximumSamples:{get:function(){return Si._maximumSamples}},highpFloatSupported:{get:function(){return Si._highpFloatSupported}},highpIntSupported:{get:function(){return Si._highpIntSupported}}}),Object.defineProperties(Ni.prototype,{status:{get:function(){this._bind();const e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),Ni.prototype._bind=function(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},Ni.prototype._unBind=function(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},Ni.prototype.bindDraw=function(){const e=this._gl;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._framebuffer)},Ni.prototype.bindRead=function(){const e=this._gl;e.bindFramebuffer(e.READ_FRAMEBUFFER,this._framebuffer)},Ni.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},Ni.prototype.getColorTexture=function(e){if(!w(e)||e<0||e>=this._colorTextures.length)throw new T("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[e]},Ni.prototype.getColorRenderbuffer=function(e){if(!w(e)||e<0||e>=this._colorRenderbuffers.length)throw new T("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[e]},Ni.prototype.isDestroyed=function(){return!1},Ni.prototype.destroy=function(){if(this.destroyAttachments){const e=this._colorTextures;for(let n=0;n<e.length;++n){const t=e[n];w(t)&&t.destroy()}const t=this._colorRenderbuffers;for(let n=0;n<t.length;++n){const e=t[n];w(e)&&e.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),Ne(this)},vi.packedLength=4,vi.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,t[n++]=e[0],t[n++]=e[1],t[n++]=e[2],t[n++]=e[3],t},vi.unpack=function(e,t,n){return O.defined("array",e),t=t??0,w(n)||(n=new vi),n[0]=e[t++],n[1]=e[t++],n[2]=e[t++],n[3]=e[t++],n},vi.packArray=function(e,t){O.defined("array",e);const n=e.length,r=4*n;if(w(t)){if(!Array.isArray(t)&&t.length!==r)throw new T("If result is a typed array, it must have exactly array.length * 4 elements");t.length!==r&&(t.length=r)}else t=new Array(r);for(let o=0;o<n;++o)vi.pack(e[o],t,4*o);return t},vi.unpackArray=function(e,t){if(O.defined("array",e),O.typeOf.number.greaterThanOrEquals("array.length",e.length,4),e.length%4!=0)throw new T("array length must be a multiple of 4.");const n=e.length;w(t)?t.length=n/4:t=new Array(n/4);for(let r=0;r<n;r+=4){const n=r/4;t[n]=vi.unpack(e,r,t[n])}return t},vi.clone=function(e,t){if(w(e))return w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new vi(e[0],e[2],e[1],e[3])},vi.fromArray=vi.unpack,vi.fromColumnMajorArray=function(e,t){return O.defined("values",e),vi.clone(e,t)},vi.fromRowMajorArray=function(e,t){return O.defined("values",e),w(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new vi(e[0],e[1],e[2],e[3])},vi.fromScale=function(e,t){return O.typeOf.object("scale",e),w(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new vi(e.x,0,0,e.y)},vi.fromUniformScale=function(e,t){return O.typeOf.number("scale",e),w(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new vi(e,0,0,e)},vi.fromRotation=function(e,t){O.typeOf.number("angle",e);const n=Math.cos(e),r=Math.sin(e);return w(t)?(t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t):new vi(n,-r,r,n)},vi.toArray=function(e,t){return O.typeOf.object("matrix",e),w(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},vi.getElementIndex=function(e,t){return O.typeOf.number.greaterThanOrEquals("row",t,0),O.typeOf.number.lessThanOrEquals("row",t,1),O.typeOf.number.greaterThanOrEquals("column",e,0),O.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},vi.getColumn=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,1),O.typeOf.object("result",n);const r=2*t,o=e[r],i=e[r+1];return n.x=o,n.y=i,n},vi.setColumn=function(e,t,n,r){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,1),O.typeOf.object("cartesian",n),O.typeOf.object("result",r);const o=2*t;return(r=vi.clone(e,r))[o]=n.x,r[o+1]=n.y,r},vi.getRow=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,1),O.typeOf.object("result",n);const r=e[t],o=e[t+2];return n.x=r,n.y=o,n},vi.setRow=function(e,t,n,r){return O.typeOf.object("matrix",e),O.typeOf.number.greaterThanOrEquals("index",t,0),O.typeOf.number.lessThanOrEquals("index",t,1),O.typeOf.object("cartesian",n),O.typeOf.object("result",r),(r=vi.clone(e,r))[t]=n.x,r[t+2]=n.y,r};const Pi=new Ot;vi.setScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n);const r=vi.getScale(e,Pi),o=t.x/r.x,i=t.y/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Mi=new Ot;vi.setUniformScale=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n);const r=vi.getScale(e,Mi),o=t/r.x,i=t/r.y;return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*i,n[3]=e[3]*i,n};const Li=new Ot;vi.getScale=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t.x=Ot.magnitude(Ot.fromElements(e[0],e[1],Li)),t.y=Ot.magnitude(Ot.fromElements(e[2],e[3],Li)),t};const Fi=new Ot;vi.getMaximumScale=function(e){return vi.getScale(e,Fi),Ot.maximumComponent(Fi)};const Di=new Ot;vi.setRotation=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("result",n);const r=vi.getScale(e,Di);return n[0]=t[0]*r.x,n[1]=t[1]*r.x,n[2]=t[2]*r.y,n[3]=t[3]*r.y,n};const zi=new Ot;vi.getRotation=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=vi.getScale(e,zi);return t[0]=e[0]/n.x,t[1]=e[1]/n.x,t[2]=e[2]/n.y,t[3]=e[3]/n.y,t},vi.multiply=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n);const r=e[0]*t[0]+e[2]*t[1],o=e[0]*t[2]+e[2]*t[3],i=e[1]*t[0]+e[3]*t[1],a=e[1]*t[2]+e[3]*t[3];return n[0]=r,n[1]=i,n[2]=o,n[3]=a,n},vi.add=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},vi.subtract=function(e,t,n){return O.typeOf.object("left",e),O.typeOf.object("right",t),O.typeOf.object("result",n),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},vi.multiplyByVector=function(e,t,n){O.typeOf.object("matrix",e),O.typeOf.object("cartesian",t),O.typeOf.object("result",n);const r=e[0]*t.x+e[2]*t.y,o=e[1]*t.x+e[3]*t.y;return n.x=r,n.y=o,n},vi.multiplyByScalar=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scalar",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},vi.multiplyByScale=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.object("scale",t),O.typeOf.object("result",n),n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n},vi.multiplyByUniformScale=function(e,t,n){return O.typeOf.object("matrix",e),O.typeOf.number("scale",t),O.typeOf.object("result",n),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},vi.negate=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},vi.transpose=function(e,t){O.typeOf.object("matrix",e),O.typeOf.object("result",t);const n=e[0],r=e[2],o=e[1],i=e[3];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t},vi.abs=function(e,t){return O.typeOf.object("matrix",e),O.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},vi.equals=function(e,t){return e===t||w(e)&&w(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},vi.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},vi.equalsEpsilon=function(e,t,n){return n=n??0,e===t||w(e)&&w(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n},vi.IDENTITY=Object.freeze(new vi(1,0,0,1)),vi.ZERO=Object.freeze(new vi(0,0,0,0)),vi.COLUMN0ROW0=0,vi.COLUMN0ROW1=1,vi.COLUMN1ROW0=2,vi.COLUMN1ROW1=3,Object.defineProperties(vi.prototype,{length:{get:function(){return vi.packedLength}}}),vi.prototype.clone=function(e){return vi.clone(this,e)},vi.prototype.equals=function(e){return vi.equals(this,e)},vi.prototype.equalsEpsilon=function(e,t){return vi.equalsEpsilon(this,e,t)},vi.prototype.toString=function(){return`(${this[0]}, ${this[2]})\n(${this[1]}, ${this[3]})`};const Bi={BYTE:Se.BYTE,UNSIGNED_BYTE:Se.UNSIGNED_BYTE,SHORT:Se.SHORT,UNSIGNED_SHORT:Se.UNSIGNED_SHORT,INT:Se.INT,UNSIGNED_INT:Se.UNSIGNED_INT,FLOAT:Se.FLOAT,DOUBLE:Se.DOUBLE,getSizeInBytes:function(e){if(!w(e))throw new T("value is required.");switch(e){case Bi.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Bi.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Bi.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Bi.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Bi.INT:return Int32Array.BYTES_PER_ELEMENT;case Bi.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Bi.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Bi.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new T("componentDatatype is not a valid value.")}},fromTypedArray:function(e){if(e instanceof Int8Array)return Bi.BYTE;if(e instanceof Uint8Array)return Bi.UNSIGNED_BYTE;if(e instanceof Int16Array)return Bi.SHORT;if(e instanceof Uint16Array)return Bi.UNSIGNED_SHORT;if(e instanceof Int32Array)return Bi.INT;if(e instanceof Uint32Array)return Bi.UNSIGNED_INT;if(e instanceof Float32Array)return Bi.FLOAT;if(e instanceof Float64Array)return Bi.DOUBLE;throw new T("array must be an Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, Uint32Array, Float32Array, or Float64Array.")},validate:function(e){return w(e)&&(e===Bi.BYTE||e===Bi.UNSIGNED_BYTE||e===Bi.SHORT||e===Bi.UNSIGNED_SHORT||e===Bi.INT||e===Bi.UNSIGNED_INT||e===Bi.FLOAT||e===Bi.DOUBLE)},createTypedArray:function(e,t){if(!w(e))throw new T("componentDatatype is required.");if(!w(t))throw new T("valuesOrLength is required.");switch(e){case Bi.BYTE:return new Int8Array(t);case Bi.UNSIGNED_BYTE:return new Uint8Array(t);case Bi.SHORT:return new Int16Array(t);case Bi.UNSIGNED_SHORT:return new Uint16Array(t);case Bi.INT:return new Int32Array(t);case Bi.UNSIGNED_INT:return new Uint32Array(t);case Bi.FLOAT:return new Float32Array(t);case Bi.DOUBLE:return new Float64Array(t);default:throw new T("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,n,r){if(!w(e))throw new T("componentDatatype is required.");if(!w(t))throw new T("buffer is required.");switch(n=n??0,r=r??(t.byteLength-n)/Bi.getSizeInBytes(e),e){case Bi.BYTE:return new Int8Array(t,n,r);case Bi.UNSIGNED_BYTE:return new Uint8Array(t,n,r);case Bi.SHORT:return new Int16Array(t,n,r);case Bi.UNSIGNED_SHORT:return new Uint16Array(t,n,r);case Bi.INT:return new Int32Array(t,n,r);case Bi.UNSIGNED_INT:return new Uint32Array(t,n,r);case Bi.FLOAT:return new Float32Array(t,n,r);case Bi.DOUBLE:return new Float64Array(t,n,r);default:throw new T("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return Bi.BYTE;case"UNSIGNED_BYTE":return Bi.UNSIGNED_BYTE;case"SHORT":return Bi.SHORT;case"UNSIGNED_SHORT":return Bi.UNSIGNED_SHORT;case"INT":return Bi.INT;case"UNSIGNED_INT":return Bi.UNSIGNED_INT;case"FLOAT":return Bi.FLOAT;case"DOUBLE":return Bi.DOUBLE;default:throw new T("name is not a valid value.")}}};var Ui=Object.freeze(Bi),ji=Object.freeze({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3});function qi(e){e=e??K.EMPTY_OBJECT,O.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=e.primitiveType??Ti.TRIANGLES,this.boundingSphere=e.boundingSphere,this.geometryType=e.geometryType??ji.NONE,this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}qi.computeNumberOfVertices=function(e){O.typeOf.object("geometry",e);let t=-1;for(const n in e.attributes)if(e.attributes.hasOwnProperty(n)&&w(e.attributes[n])&&w(e.attributes[n].values)){const r=e.attributes[n],o=r.values.length/r.componentsPerAttribute;if(t!==o&&-1!==t)throw new T("All attribute lists must have the same number of attributes.");t=o}return t};const Gi=new Pt,ki=new L,Wi=new he,Vi=[new Pt,new Pt,new Pt],Hi=[new Ot,new Ot,new Ot],Yi=[new Ot,new Ot,new Ot],Xi=new L,$i=new Jr,Ki=new he,Zi=new vi;function Qi(e){if(!w((e=e??K.EMPTY_OBJECT).componentDatatype))throw new T("options.componentDatatype is required.");if(!w(e.componentsPerAttribute))throw new T("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||e.componentsPerAttribute>4)throw new T("options.componentsPerAttribute must be between 1 and 4.");if(!w(e.values))throw new T("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=e.normalize??!1,this.values=e.values}function Ji(e,t,n,r,o){this._format=e,this._datatype=t,this._width=n,this._height=r,this._buffer=o}function ea(){if(!w(oa._canTransferArrayBuffer)){const t=ra("transferTypedArrayTest");t.postMessage=t.webkitPostMessage??t.postMessage;const n=99,r=new Int8Array([n]);try{t.postMessage({array:r},[r.buffer])}catch(e){return oa._canTransferArrayBuffer=!1,oa._canTransferArrayBuffer}oa._canTransferArrayBuffer=new Promise(e=>{t.onmessage=function(r){const o=r.data.array,i=w(o)&&o[0]===n;e(i),t.terminate(),oa._canTransferArrayBuffer=i}})}return oa._canTransferArrayBuffer}qi._textureCoordinateRotationPoints=function(e,t,n,r){let o;const i=pi.center(r,Gi),a=Pt.toCartesian(i,n,ki),s=So.eastNorthUpToFixedFrame(a,n,Wi),u=he.inverse(s,Wi),c=Hi,l=Vi;l[0].longitude=r.west,l[0].latitude=r.south,l[1].longitude=r.west,l[1].latitude=r.north,l[2].longitude=r.east,l[2].latitude=r.south;let f=Xi;for(o=0;o<3;o++)Pt.toCartesian(l[o],n,f),f=he.multiplyByPointAsVector(u,f,f),c[o].x=f.x,c[o].y=f.y;const h=Jr.fromAxisAngle(L.UNIT_Z,-t,$i),p=Z.fromQuaternion(h,Ki),m=e.length;let d=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(o=0;o<m;o++)f=he.multiplyByPointAsVector(u,e[o],f),f=Z.multiplyByVector(p,f,f),d=Math.min(d,f.x),y=Math.min(y,f.y),_=Math.max(_,f.x),g=Math.max(g,f.y);const E=vi.fromRotation(t,Zi),b=Yi;b[0].x=d,b[0].y=y,b[1].x=d,b[1].y=g,b[2].x=_,b[2].y=y;const w=c[0],T=c[2].x-w.x,O=c[1].y-w.y;for(o=0;o<3;o++){const e=b[o];vi.multiplyByVector(E,e,e),e.x=(e.x-w.x)/T,e.y=(e.y-w.y)/O}const A=b[0],x=b[1],R=b[2],S=new Array(6);return Ot.pack(A,S),Ot.pack(x,S,2),Ot.pack(R,S,4),S},Object.defineProperties(Ji.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}},arrayBufferView:{get:function(){return this._buffer}}}),Ji.clone=function(e){if(w(e))return new Ji(e._format,e._datatype,e._width,e._height,e._buffer)},Ji.prototype.clone=function(){return Ji.clone(this)};const ta=new nr;function na(e){let t;try{t=new Blob([e],{type:"application/javascript"})}catch(n){const o=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);o.append(e),t=o.getBlob("application/javascript")}return(window.URL||window.webkitURL).createObjectURL(t)}function ra(e){const t=new Un(e),n=0!==t.scheme().length&&0===t.fragment().length,r=e.replace(/\.js$/,""),o={};let i,a;if($n(e))a=e;else if(!n){const e=Yr(`${oa._workerModulePrefix}/${r}.js`);$n(e)&&(a=e)}if(a)return i=na(`import "${a}";`),o.type="module",new Worker(i,o);if(!n&&"undefined"!=typeof CESIUM_WORKERS){const e=`\n      importScripts("${na(CESIUM_WORKERS)}");\n      CesiumWorkers["${r}"]();\n    `;return i=na(e),new Worker(i,o)}if(i=e,n||(i=Yr(`${oa._workerModulePrefix+r}.js`)),!pt.supportsEsmWebWorkers())throw new fe("This browser is not supported. Please update your browser to continue.");return o.type="module",new Worker(i,o)}function oa(e,t){this._workerPath=e,this._maximumActiveTasks=t??Number.POSITIVE_INFINITY,this._activeTasks=0,this._nextID=0,this._webAssemblyPromise=void 0}const ia=[];function aa(){}let sa;function ua(e){let t;return O.defined("resourceOrUrlOrBuffer",e),t=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?Promise.resolve(e):Tr.createIfNeeded(e).fetchArrayBuffer(),t.then(function(e){return aa.transcode(e,sa)})}function ca(e,t){this.start=e??0,this.stop=t??0}function la(e,t){this.center=L.clone(e??L.ZERO),this.radius=t??0}oa.prototype.scheduleTask=function(e,t){if(w(this._worker)||(this._worker=ra(this._workerPath)),!(this._activeTasks>=this._maximumActiveTasks))return async function(e,t,n){++e._activeTasks;try{const r=await async function(e,t,n){const r=await Promise.resolve(ea());w(n)?r||(n.length=0):n=ia;const o=e._nextID++,i=new Promise((t,n)=>{e._worker.addEventListener("message",((e,t,n,r)=>{const o=({data:i})=>{if(i.id===t){if(w(i.error)){let e=i.error;"RuntimeError"===e.name?(e=new fe(i.error.message),e.stack=i.error.stack):"DeveloperError"===e.name?(e=new T(i.error.message),e.stack=i.error.stack):"Error"===e.name&&(e=new Error(i.error.message),e.stack=i.error.stack),ta.raiseEvent(e),r(e)}else ta.raiseEvent(),n(i.result);e.removeEventListener("message",o)}};return o})(e._worker,o,t,n))});return e._worker.postMessage({id:o,baseUrl:Yr.getCesiumBaseUrl().url,parameters:t,canTransferArrayBuffer:r},n),i}(e,t,n);return--e._activeTasks,r}catch(t){throw--e._activeTasks,t}}(this,e,t)},oa.prototype.initWebAssemblyModule=async function(e){return w(this._webAssemblyPromise)||(this._webAssemblyPromise=(async()=>{const t=this._worker=ra(this._workerPath),n=await async function(e,t){const n={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!pt.supportsWebAssembly()){if(!w(t.fallbackModulePath))throw new fe(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return n.modulePath=Yr(t.fallbackModulePath),n}n.wasmBinaryFile=Yr(t.wasmBinaryFile);const r=await Tr.fetchArrayBuffer({url:n.wasmBinaryFile});return n.wasmBinary=r,n}(this,e),r=await Promise.resolve(ea());let o;const i=n.wasmBinary;w(i)&&r&&(o=[i]);const a=new Promise((e,n)=>{t.onmessage=function({data:t}){w(t)?e(t.result):n(new fe("Could not configure wasm module"))}});return t.postMessage({canTransferArrayBuffer:r,parameters:{webAssemblyConfig:n}},o),a})()),this._webAssemblyPromise},oa.prototype.isDestroyed=function(){return!1},oa.prototype.destroy=function(){return w(this._worker)&&this._worker.terminate(),Ne(this)},oa.taskCompletedEvent=ta,oa._defaultWorkerModulePrefix="Workers/",oa._workerModulePrefix=oa._defaultWorkerModulePrefix,oa._canTransferArrayBuffer=void 0,aa._transcodeTaskProcessor=new oa("transcodeKTX2",Number.POSITIVE_INFINITY),aa._readyPromise=void 0,aa.transcode=function(e,t){return O.defined("supportedTargetFormats",t),w(aa._readyPromise)||function(){const e=aa._transcodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then(function(e){if(e)return aa._transcodeTaskProcessor;throw new fe("KTX2 transcoder could not be initialized.")});aa._readyPromise=e}(),aa._readyPromise.then(function(n){let r=e;e instanceof ArrayBuffer&&(r=new Uint8Array(e));const o={supportedTargetFormats:t,ktx2Buffer:r};return n.scheduleTask(o,[r.buffer])}).then(function(e){const t=e.length,n=Object.keys(e[0]);for(let r=0;r<t;r++){const t=e[r];for(let e=0;e<n.length;e++){const r=t[n[e]];t[n[e]]=new Ji(r.internalFormat,r.datatype,r.width,r.height,r.levelBuffer)}}if(1===n.length){for(let r=0;r<t;++r)e[r]=e[r][n[0]];1===t&&(e=e[0])}return e}).catch(function(e){throw e})},ua.setKTX2SupportedFormats=function(e,t,n,r,o,i){sa={s3tc:e,pvrtc:t,astc:n,etc:r,etc1:o,bc7:i}};const fa=new L,ha=new L,pa=new L,ma=new L,da=new L,ya=new L,_a=new L,ga=new L,Ea=new L,ba=new L,wa=new L,Ta=new L,Oa=4/3*v.PI;la.fromPoints=function(e,t){if(w(t)||(t=new la),!w(e)||0===e.length)return t.center=L.clone(L.ZERO,t.center),t.radius=0,t;const n=L.clone(e[0],_a),r=L.clone(n,fa),o=L.clone(n,ha),i=L.clone(n,pa),a=L.clone(n,ma),s=L.clone(n,da),u=L.clone(n,ya),c=e.length;let l;for(l=1;l<c;l++){L.clone(e[l],n);const t=n.x,c=n.y,f=n.z;t<r.x&&L.clone(n,r),t>a.x&&L.clone(n,a),c<o.y&&L.clone(n,o),c>s.y&&L.clone(n,s),f<i.z&&L.clone(n,i),f>u.z&&L.clone(n,u)}const f=L.magnitudeSquared(L.subtract(a,r,ga)),h=L.magnitudeSquared(L.subtract(s,o,ga)),p=L.magnitudeSquared(L.subtract(u,i,ga));let m=r,d=a,y=f;h>y&&(y=h,m=o,d=s),p>y&&(y=p,m=i,d=u);const _=Ea;_.x=.5*(m.x+d.x),_.y=.5*(m.y+d.y),_.z=.5*(m.z+d.z);let g=L.magnitudeSquared(L.subtract(d,_,ga)),E=Math.sqrt(g);const b=ba;b.x=r.x,b.y=o.y,b.z=i.z;const T=wa;T.x=a.x,T.y=s.y,T.z=u.z;const O=L.midpoint(b,T,Ta);let A=0;for(l=0;l<c;l++){L.clone(e[l],n);const t=L.magnitude(L.subtract(n,O,ga));t>A&&(A=t);const r=L.magnitudeSquared(L.subtract(n,_,ga));if(r>g){const e=Math.sqrt(r);E=.5*(E+e),g=E*E;const t=e-E;_.x=(E*_.x+t*n.x)/e,_.y=(E*_.y+t*n.y)/e,_.z=(E*_.z+t*n.z)/e}}return E<A?(L.clone(_,t.center),t.radius=E):(L.clone(O,t.center),t.radius=A),t};const Aa=new Yt,xa=new L,Ra=new L,Sa=new Pt,Ia=new Pt;la.fromRectangle2D=function(e,t,n){return la.fromRectangleWithHeights2D(e,t,0,0,n)},la.fromRectangleWithHeights2D=function(e,t,n,r,o){if(w(o)||(o=new la),!w(e))return o.center=L.clone(L.ZERO,o.center),o.radius=0,o;Aa._ellipsoid=zt.default,t=t??Aa,pi.southwest(e,Sa),Sa.height=n,pi.northeast(e,Ia),Ia.height=r;const i=t.project(Sa,xa),a=t.project(Ia,Ra),s=a.x-i.x,u=a.y-i.y,c=a.z-i.z;o.radius=.5*Math.sqrt(s*s+u*u+c*c);const l=o.center;return l.x=i.x+.5*s,l.y=i.y+.5*u,l.z=i.z+.5*c,o};const Ca=[];la.fromRectangle3D=function(e,t,n,r){if(t=t??zt.default,n=n??0,w(r)||(r=new la),!w(e))return r.center=L.clone(L.ZERO,r.center),r.radius=0,r;const o=pi.subsample(e,t,n,Ca);return la.fromPoints(o,r)},la.fromVertices=function(e,t,n,r){if(w(r)||(r=new la),!w(e)||0===e.length)return r.center=L.clone(L.ZERO,r.center),r.radius=0,r;t=t??L.ZERO,n=n??3,O.typeOf.number.greaterThanOrEquals("stride",n,3);const o=_a;o.x=e[0]+t.x,o.y=e[1]+t.y,o.z=e[2]+t.z;const i=L.clone(o,fa),a=L.clone(o,ha),s=L.clone(o,pa),u=L.clone(o,ma),c=L.clone(o,da),l=L.clone(o,ya),f=e.length;let h;for(h=0;h<f;h+=n){const n=e[h]+t.x,r=e[h+1]+t.y,f=e[h+2]+t.z;o.x=n,o.y=r,o.z=f,n<i.x&&L.clone(o,i),n>u.x&&L.clone(o,u),r<a.y&&L.clone(o,a),r>c.y&&L.clone(o,c),f<s.z&&L.clone(o,s),f>l.z&&L.clone(o,l)}const p=L.magnitudeSquared(L.subtract(u,i,ga)),m=L.magnitudeSquared(L.subtract(c,a,ga)),d=L.magnitudeSquared(L.subtract(l,s,ga));let y=i,_=u,g=p;m>g&&(g=m,y=a,_=c),d>g&&(g=d,y=s,_=l);const E=Ea;E.x=.5*(y.x+_.x),E.y=.5*(y.y+_.y),E.z=.5*(y.z+_.z);let b=L.magnitudeSquared(L.subtract(_,E,ga)),T=Math.sqrt(b);const A=ba;A.x=i.x,A.y=a.y,A.z=s.z;const x=wa;x.x=u.x,x.y=c.y,x.z=l.z;const R=L.midpoint(A,x,Ta);let S=0;for(h=0;h<f;h+=n){o.x=e[h]+t.x,o.y=e[h+1]+t.y,o.z=e[h+2]+t.z;const n=L.magnitude(L.subtract(o,R,ga));n>S&&(S=n);const r=L.magnitudeSquared(L.subtract(o,E,ga));if(r>b){const e=Math.sqrt(r);T=.5*(T+e),b=T*T;const t=e-T;E.x=(T*E.x+t*o.x)/e,E.y=(T*E.y+t*o.y)/e,E.z=(T*E.z+t*o.z)/e}}return T<S?(L.clone(E,r.center),r.radius=T):(L.clone(R,r.center),r.radius=S),r},la.fromEncodedCartesianVertices=function(e,t,n){if(w(n)||(n=new la),!w(e)||!w(t)||e.length!==t.length||0===e.length)return n.center=L.clone(L.ZERO,n.center),n.radius=0,n;const r=_a;r.x=e[0]+t[0],r.y=e[1]+t[1],r.z=e[2]+t[2];const o=L.clone(r,fa),i=L.clone(r,ha),a=L.clone(r,pa),s=L.clone(r,ma),u=L.clone(r,da),c=L.clone(r,ya),l=e.length;let f;for(f=0;f<l;f+=3){const n=e[f]+t[f],l=e[f+1]+t[f+1],h=e[f+2]+t[f+2];r.x=n,r.y=l,r.z=h,n<o.x&&L.clone(r,o),n>s.x&&L.clone(r,s),l<i.y&&L.clone(r,i),l>u.y&&L.clone(r,u),h<a.z&&L.clone(r,a),h>c.z&&L.clone(r,c)}const h=L.magnitudeSquared(L.subtract(s,o,ga)),p=L.magnitudeSquared(L.subtract(u,i,ga)),m=L.magnitudeSquared(L.subtract(c,a,ga));let d=o,y=s,_=h;p>_&&(_=p,d=i,y=u),m>_&&(_=m,d=a,y=c);const g=Ea;g.x=.5*(d.x+y.x),g.y=.5*(d.y+y.y),g.z=.5*(d.z+y.z);let E=L.magnitudeSquared(L.subtract(y,g,ga)),b=Math.sqrt(E);const T=ba;T.x=o.x,T.y=i.y,T.z=a.z;const O=wa;O.x=s.x,O.y=u.y,O.z=c.z;const A=L.midpoint(T,O,Ta);let x=0;for(f=0;f<l;f+=3){r.x=e[f]+t[f],r.y=e[f+1]+t[f+1],r.z=e[f+2]+t[f+2];const n=L.magnitude(L.subtract(r,A,ga));n>x&&(x=n);const o=L.magnitudeSquared(L.subtract(r,g,ga));if(o>E){const e=Math.sqrt(o);b=.5*(b+e),E=b*b;const t=e-b;g.x=(b*g.x+t*r.x)/e,g.y=(b*g.y+t*r.y)/e,g.z=(b*g.z+t*r.z)/e}}return b<x?(L.clone(g,n.center),n.radius=b):(L.clone(A,n.center),n.radius=x),n},la.fromCornerPoints=function(e,t,n){O.typeOf.object("corner",e),O.typeOf.object("oppositeCorner",t),w(n)||(n=new la);const r=L.midpoint(e,t,n.center);return n.radius=L.distance(r,t),n},la.fromEllipsoid=function(e,t){return O.typeOf.object("ellipsoid",e),w(t)||(t=new la),L.clone(L.ZERO,t.center),t.radius=e.maximumRadius,t};const Na=new L;la.fromBoundingSpheres=function(e,t){if(w(t)||(t=new la),!w(e)||0===e.length)return t.center=L.clone(L.ZERO,t.center),t.radius=0,t;const n=e.length;if(1===n)return la.clone(e[0],t);if(2===n)return la.union(e[0],e[1],t);const r=[];let o;for(o=0;o<n;o++)r.push(e[o].center);const i=(t=la.fromPoints(r,t)).center;let a=t.radius;for(o=0;o<n;o++){const t=e[o];a=Math.max(a,L.distance(i,t.center,Na)+t.radius)}return t.radius=a,t};const va=new L,Pa=new L,Ma=new L;la.fromOrientedBoundingBox=function(e,t){O.defined("orientedBoundingBox",e),w(t)||(t=new la);const n=e.halfAxes,r=Z.getColumn(n,0,va),o=Z.getColumn(n,1,Pa),i=Z.getColumn(n,2,Ma);return L.add(r,o,r),L.add(r,i,r),t.center=L.clone(e.center,t.center),t.radius=L.magnitude(r),t};const La=new L,Fa=new L;la.fromTransformation=function(e,t){O.typeOf.object("transformation",e),w(t)||(t=new la);const n=he.getTranslation(e,La),r=he.getScale(e,Fa),o=.5*L.magnitude(r);return t.center=L.clone(n,t.center),t.radius=o,t},la.clone=function(e,t){if(w(e))return w(t)?(t.center=L.clone(e.center,t.center),t.radius=e.radius,t):new la(e.center,e.radius)},la.packedLength=4,la.pack=function(e,t,n){O.typeOf.object("value",e),O.defined("array",t),n=n??0;const r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t},la.unpack=function(e,t,n){O.defined("array",e),t=t??0,w(n)||(n=new la);const r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};const Da=new L,za=new L;la.union=function(e,t,n){O.typeOf.object("left",e),O.typeOf.object("right",t),w(n)||(n=new la);const r=e.center,o=e.radius,i=t.center,a=t.radius,s=L.subtract(i,r,Da),u=L.magnitude(s);if(o>=u+a)return e.clone(n),n;if(a>=u+o)return t.clone(n),n;const c=.5*(o+u+a),l=L.multiplyByScalar(s,(-o+c)/u,za);return L.add(l,r,l),L.clone(l,n.center),n.radius=c,n};const Ba=new L;la.expand=function(e,t,n){O.typeOf.object("sphere",e),O.typeOf.object("point",t),n=la.clone(e,n);const r=L.magnitude(L.subtract(t,n.center,Ba));return r>n.radius&&(n.radius=r),n},la.intersectPlane=function(e,t){O.typeOf.object("sphere",e),O.typeOf.object("plane",t);const n=e.center,r=e.radius,o=t.normal,i=L.dot(o,n)+t.distance;return i<-r?Xt.OUTSIDE:i<r?Xt.INTERSECTING:Xt.INSIDE},la.transform=function(e,t,n){return O.typeOf.object("sphere",e),O.typeOf.object("transform",t),w(n)||(n=new la),n.center=he.multiplyByPoint(t,e.center,n.center),n.radius=he.getMaximumScale(t)*e.radius,n};const Ua=new L;la.distanceSquaredTo=function(e,t){O.typeOf.object("sphere",e),O.typeOf.object("cartesian",t);const n=L.subtract(e.center,t,Ua),r=L.magnitude(n)-e.radius;return r<=0?0:r*r},la.transformWithoutScale=function(e,t,n){return O.typeOf.object("sphere",e),O.typeOf.object("transform",t),w(n)||(n=new la),n.center=he.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};const ja=new L;la.computePlaneDistances=function(e,t,n,r){O.typeOf.object("sphere",e),O.typeOf.object("position",t),O.typeOf.object("direction",n),w(r)||(r=new ca);const o=L.subtract(e.center,t,ja),i=L.dot(n,o);return r.start=i-e.radius,r.stop=i+e.radius,r};const qa=new L,Ga=new L,ka=new L,Wa=new L,Va=new L,Ha=new Pt,Ya=new Array(8);for(let ef=0;ef<8;++ef)Ya[ef]=new L;const Xa=new Yt;function $a(e){e=e??K.EMPTY_OBJECT,this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}la.projectTo2D=function(e,t,n){O.typeOf.object("sphere",e),Xa._ellipsoid=zt.default;const r=(t=t??Xa).ellipsoid;let o=e.center;const i=e.radius;let a;a=L.equals(o,L.ZERO)?L.clone(L.UNIT_X,qa):r.geodeticSurfaceNormal(o,qa);const s=L.cross(L.UNIT_Z,a,Ga);L.normalize(s,s);const u=L.cross(a,s,ka);L.normalize(u,u),L.multiplyByScalar(a,i,a),L.multiplyByScalar(u,i,u),L.multiplyByScalar(s,i,s);const c=L.negate(u,Va),l=L.negate(s,Wa),f=Ya;let h=f[0];L.add(a,u,h),L.add(h,s,h),h=f[1],L.add(a,u,h),L.add(h,l,h),h=f[2],L.add(a,c,h),L.add(h,l,h),h=f[3],L.add(a,c,h),L.add(h,s,h),L.negate(a,a),h=f[4],L.add(a,u,h),L.add(h,s,h),h=f[5],L.add(a,u,h),L.add(h,l,h),h=f[6],L.add(a,c,h),L.add(h,l,h),h=f[7],L.add(a,c,h),L.add(h,s,h);const p=f.length;for(let _=0;_<p;++_){const e=f[_];L.add(o,e,e);const n=r.cartesianToCartographic(e,Ha);t.project(n,e)}o=(n=la.fromPoints(f,n)).center;const m=o.x,d=o.y,y=o.z;return o.x=y,o.y=m,o.z=d,n},la.isOccluded=function(e,t){return O.typeOf.object("sphere",e),O.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},la.equals=function(e,t){return e===t||w(e)&&w(t)&&L.equals(e.center,t.center)&&e.radius===t.radius},la.prototype.intersectPlane=function(e){return la.intersectPlane(this,e)},la.prototype.distanceSquaredTo=function(e){return la.distanceSquaredTo(this,e)},la.prototype.computePlaneDistances=function(e,t,n){return la.computePlaneDistances(this,e,t,n)},la.prototype.isOccluded=function(e){return la.isOccluded(this,e)},la.prototype.equals=function(e){return la.equals(this,e)},la.prototype.clone=function(e){return la.clone(this,e)},la.prototype.volume=function(){const e=this.radius;return Oa*e*e*e};var Ka=Object.freeze({NONE:0,TOP:1,ALL:2});function Za(e){e=e??K.EMPTY_OBJECT,this.position=e.position??!1,this.normal=e.normal??!1,this.st=e.st??!1,this.bitangent=e.bitangent??!1,this.tangent=e.tangent??!1,this.color=e.color??!1}Za.POSITION_ONLY=Object.freeze(new Za({position:!0})),Za.POSITION_AND_NORMAL=Object.freeze(new Za({position:!0,normal:!0})),Za.POSITION_NORMAL_AND_ST=Object.freeze(new Za({position:!0,normal:!0,st:!0})),Za.POSITION_AND_ST=Object.freeze(new Za({position:!0,st:!0})),Za.POSITION_AND_COLOR=Object.freeze(new Za({position:!0,color:!0})),Za.ALL=Object.freeze(new Za({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),Za.DEFAULT=Za.POSITION_NORMAL_AND_ST,Za.packedLength=6,Za.pack=function(e,t,n){if(!w(e))throw new T("value is required");if(!w(t))throw new T("array is required");return n=n??0,t[n++]=e.position?1:0,t[n++]=e.normal?1:0,t[n++]=e.st?1:0,t[n++]=e.tangent?1:0,t[n++]=e.bitangent?1:0,t[n]=e.color?1:0,t},Za.unpack=function(e,t,n){if(!w(e))throw new T("array is required");return t=t??0,w(n)||(n=new Za),n.position=1===e[t++],n.normal=1===e[t++],n.st=1===e[t++],n.tangent=1===e[t++],n.bitangent=1===e[t++],n.color=1===e[t],n},Za.clone=function(e,t){if(w(e))return w(t)||(t=new Za),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};const Qa=new L;function Ja(e){const t=(e=e??K.EMPTY_OBJECT).minimum,n=e.maximum;if(O.typeOf.object("min",t),O.typeOf.object("max",n),w(e.offsetAttribute)&&e.offsetAttribute===Ka.TOP)throw new T("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");const r=e.vertexFormat??Za.DEFAULT;this._minimum=L.clone(t),this._maximum=L.clone(n),this._vertexFormat=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}Ja.fromDimensions=function(e){const t=(e=e??K.EMPTY_OBJECT).dimensions;O.typeOf.object("dimensions",t),O.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),O.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),O.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);const n=L.multiplyByScalar(t,.5,new L);return new Ja({minimum:L.negate(n,new L),maximum:n,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})},Ja.fromAxisAlignedBoundingBox=function(e){return O.typeOf.object("boundingBox",e),new Ja({minimum:e.minimum,maximum:e.maximum})},Ja.packedLength=2*L.packedLength+Za.packedLength+1,Ja.pack=function(e,t,n){return O.typeOf.object("value",e),O.defined("array",t),n=n??0,L.pack(e._minimum,t,n),L.pack(e._maximum,t,n+L.packedLength),Za.pack(e._vertexFormat,t,n+2*L.packedLength),t[n+2*L.packedLength+Za.packedLength]=e._offsetAttribute??-1,t};const es=new L,ts=new L,ns=new Za,rs={minimum:es,maximum:ts,vertexFormat:ns,offsetAttribute:void 0};let os;Ja.unpack=function(e,t,n){O.defined("array",e),t=t??0;const r=L.unpack(e,t,es),o=L.unpack(e,t+L.packedLength,ts),i=Za.unpack(e,t+2*L.packedLength,ns),a=e[t+2*L.packedLength+Za.packedLength];return w(n)?(n._minimum=L.clone(r,n._minimum),n._maximum=L.clone(o,n._maximum),n._vertexFormat=Za.clone(i,n._vertexFormat),n._offsetAttribute=-1===a?void 0:a,n):(rs.offsetAttribute=-1===a?void 0:a,new Ja(rs))},Ja.createGeometry=function(e){const t=e._minimum,n=e._maximum,r=e._vertexFormat;if(L.equals(t,n))return;const o=new $a;let i,a;if(r.position&&(r.st||r.normal||r.tangent||r.bitangent)){if(r.position&&(a=new Float64Array(72),a[0]=t.x,a[1]=t.y,a[2]=n.z,a[3]=n.x,a[4]=t.y,a[5]=n.z,a[6]=n.x,a[7]=n.y,a[8]=n.z,a[9]=t.x,a[10]=n.y,a[11]=n.z,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=n.x,a[16]=t.y,a[17]=t.z,a[18]=n.x,a[19]=n.y,a[20]=t.z,a[21]=t.x,a[22]=n.y,a[23]=t.z,a[24]=n.x,a[25]=t.y,a[26]=t.z,a[27]=n.x,a[28]=n.y,a[29]=t.z,a[30]=n.x,a[31]=n.y,a[32]=n.z,a[33]=n.x,a[34]=t.y,a[35]=n.z,a[36]=t.x,a[37]=t.y,a[38]=t.z,a[39]=t.x,a[40]=n.y,a[41]=t.z,a[42]=t.x,a[43]=n.y,a[44]=n.z,a[45]=t.x,a[46]=t.y,a[47]=n.z,a[48]=t.x,a[49]=n.y,a[50]=t.z,a[51]=n.x,a[52]=n.y,a[53]=t.z,a[54]=n.x,a[55]=n.y,a[56]=n.z,a[57]=t.x,a[58]=n.y,a[59]=n.z,a[60]=t.x,a[61]=t.y,a[62]=t.z,a[63]=n.x,a[64]=t.y,a[65]=t.z,a[66]=n.x,a[67]=t.y,a[68]=n.z,a[69]=t.x,a[70]=t.y,a[71]=n.z,o.position=new Qi({componentDatatype:Ui.DOUBLE,componentsPerAttribute:3,values:a})),r.normal){const e=new Float32Array(72);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=1,e[9]=0,e[10]=0,e[11]=1,e[12]=0,e[13]=0,e[14]=-1,e[15]=0,e[16]=0,e[17]=-1,e[18]=0,e[19]=0,e[20]=-1,e[21]=0,e[22]=0,e[23]=-1,e[24]=1,e[25]=0,e[26]=0,e[27]=1,e[28]=0,e[29]=0,e[30]=1,e[31]=0,e[32]=0,e[33]=1,e[34]=0,e[35]=0,e[36]=-1,e[37]=0,e[38]=0,e[39]=-1,e[40]=0,e[41]=0,e[42]=-1,e[43]=0,e[44]=0,e[45]=-1,e[46]=0,e[47]=0,e[48]=0,e[49]=1,e[50]=0,e[51]=0,e[52]=1,e[53]=0,e[54]=0,e[55]=1,e[56]=0,e[57]=0,e[58]=1,e[59]=0,e[60]=0,e[61]=-1,e[62]=0,e[63]=0,e[64]=-1,e[65]=0,e[66]=0,e[67]=-1,e[68]=0,e[69]=0,e[70]=-1,e[71]=0,o.normal=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:e})}if(r.st){const e=new Float32Array(48);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=1,e[5]=1,e[6]=0,e[7]=1,e[8]=1,e[9]=0,e[10]=0,e[11]=0,e[12]=0,e[13]=1,e[14]=1,e[15]=1,e[16]=0,e[17]=0,e[18]=1,e[19]=0,e[20]=1,e[21]=1,e[22]=0,e[23]=1,e[24]=1,e[25]=0,e[26]=0,e[27]=0,e[28]=0,e[29]=1,e[30]=1,e[31]=1,e[32]=1,e[33]=0,e[34]=0,e[35]=0,e[36]=0,e[37]=1,e[38]=1,e[39]=1,e[40]=0,e[41]=0,e[42]=1,e[43]=0,e[44]=1,e[45]=1,e[46]=0,e[47]=1,o.st=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:2,values:e})}if(r.tangent){const e=new Float32Array(72);e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=1,e[7]=0,e[8]=0,e[9]=1,e[10]=0,e[11]=0,e[12]=-1,e[13]=0,e[14]=0,e[15]=-1,e[16]=0,e[17]=0,e[18]=-1,e[19]=0,e[20]=0,e[21]=-1,e[22]=0,e[23]=0,e[24]=0,e[25]=1,e[26]=0,e[27]=0,e[28]=1,e[29]=0,e[30]=0,e[31]=1,e[32]=0,e[33]=0,e[34]=1,e[35]=0,e[36]=0,e[37]=-1,e[38]=0,e[39]=0,e[40]=-1,e[41]=0,e[42]=0,e[43]=-1,e[44]=0,e[45]=0,e[46]=-1,e[47]=0,e[48]=-1,e[49]=0,e[50]=0,e[51]=-1,e[52]=0,e[53]=0,e[54]=-1,e[55]=0,e[56]=0,e[57]=-1,e[58]=0,e[59]=0,e[60]=1,e[61]=0,e[62]=0,e[63]=1,e[64]=0,e[65]=0,e[66]=1,e[67]=0,e[68]=0,e[69]=1,e[70]=0,e[71]=0,o.tangent=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:e})}if(r.bitangent){const e=new Float32Array(72);e[0]=0,e[1]=1,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=1,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=1,e[14]=0,e[15]=0,e[16]=1,e[17]=0,e[18]=0,e[19]=1,e[20]=0,e[21]=0,e[22]=1,e[23]=0,e[24]=0,e[25]=0,e[26]=1,e[27]=0,e[28]=0,e[29]=1,e[30]=0,e[31]=0,e[32]=1,e[33]=0,e[34]=0,e[35]=1,e[36]=0,e[37]=0,e[38]=1,e[39]=0,e[40]=0,e[41]=1,e[42]=0,e[43]=0,e[44]=1,e[45]=0,e[46]=0,e[47]=1,e[48]=0,e[49]=0,e[50]=1,e[51]=0,e[52]=0,e[53]=1,e[54]=0,e[55]=0,e[56]=1,e[57]=0,e[58]=0,e[59]=1,e[60]=0,e[61]=0,e[62]=1,e[63]=0,e[64]=0,e[65]=1,e[66]=0,e[67]=0,e[68]=1,e[69]=0,e[70]=0,e[71]=1,o.bitangent=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:e})}i=new Uint16Array(36),i[0]=0,i[1]=1,i[2]=2,i[3]=0,i[4]=2,i[5]=3,i[6]=6,i[7]=5,i[8]=4,i[9]=7,i[10]=6,i[11]=4,i[12]=8,i[13]=9,i[14]=10,i[15]=8,i[16]=10,i[17]=11,i[18]=14,i[19]=13,i[20]=12,i[21]=15,i[22]=14,i[23]=12,i[24]=18,i[25]=17,i[26]=16,i[27]=19,i[28]=18,i[29]=16,i[30]=20,i[31]=21,i[32]=22,i[33]=20,i[34]=22,i[35]=23}else a=new Float64Array(24),a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=n.x,a[4]=t.y,a[5]=t.z,a[6]=n.x,a[7]=n.y,a[8]=t.z,a[9]=t.x,a[10]=n.y,a[11]=t.z,a[12]=t.x,a[13]=t.y,a[14]=n.z,a[15]=n.x,a[16]=t.y,a[17]=n.z,a[18]=n.x,a[19]=n.y,a[20]=n.z,a[21]=t.x,a[22]=n.y,a[23]=n.z,o.position=new Qi({componentDatatype:Ui.DOUBLE,componentsPerAttribute:3,values:a}),i=new Uint16Array(36),i[0]=4,i[1]=5,i[2]=6,i[3]=4,i[4]=6,i[5]=7,i[6]=1,i[7]=0,i[8]=3,i[9]=1,i[10]=3,i[11]=2,i[12]=1,i[13]=6,i[14]=5,i[15]=1,i[16]=2,i[17]=6,i[18]=2,i[19]=3,i[20]=7,i[21]=2,i[22]=7,i[23]=6,i[24]=3,i[25]=0,i[26]=4,i[27]=3,i[28]=4,i[29]=7,i[30]=0,i[31]=1,i[32]=5,i[33]=0,i[34]=5,i[35]=4;const s=L.subtract(n,t,Qa),u=.5*L.magnitude(s);if(w(e._offsetAttribute)){const t=a.length,n=e._offsetAttribute===Ka.NONE?0:1,r=new Uint8Array(t/3).fill(n);o.applyOffset=new Qi({componentDatatype:Ui.UNSIGNED_BYTE,componentsPerAttribute:1,values:r})}return new qi({attributes:o,indices:i,primitiveType:Ti.TRIANGLES,boundingSphere:new la(L.ZERO,u),offsetAttribute:e._offsetAttribute})},Ja.getUnitBox=function(){return w(os)||(os=Ja.createGeometry(Ja.fromDimensions({dimensions:new L(1,1,1),vertexFormat:Za.POSITION_ONLY}))),os};const is={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",getMathType:function(e){switch(e){case is.SCALAR:return Number;case is.VEC2:return Ot;case is.VEC3:return L;case is.VEC4:return G;case is.MAT2:return vi;case is.MAT3:return Z;case is.MAT4:return he;default:throw new T("attributeType is not a valid value.")}},getNumberOfComponents:function(e){switch(e){case is.SCALAR:return 1;case is.VEC2:return 2;case is.VEC3:return 3;case is.VEC4:case is.MAT2:return 4;case is.MAT3:return 9;case is.MAT4:return 16;default:throw new T("attributeType is not a valid value.")}},getAttributeLocationCount:function(e){switch(e){case is.SCALAR:case is.VEC2:case is.VEC3:case is.VEC4:return 1;case is.MAT2:return 2;case is.MAT3:return 3;case is.MAT4:return 4;default:throw new T("attributeType is not a valid value.")}},getGlslType:function(e){switch(O.typeOf.string("attributeType",e),e){case is.SCALAR:return"float";case is.VEC2:return"vec2";case is.VEC3:return"vec3";case is.VEC4:return"vec4";case is.MAT2:return"mat2";case is.MAT3:return"mat3";case is.MAT4:return"mat4";default:throw new T("attributeType is not a valid value.")}}};var as=Object.freeze(is);const ss=1/256,us={octEncodeInRange:function(e,t,n){O.defined("vector",e),O.defined("result",n);const r=L.magnitudeSquared(e);if(Math.abs(r-1)>v.EPSILON6)throw new T("vector must be normalized.");if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){const e=n.x,t=n.y;n.x=(1-Math.abs(t))*v.signNotZero(e),n.y=(1-Math.abs(e))*v.signNotZero(t)}return n.x=v.toSNorm(n.x,t),n.y=v.toSNorm(n.y,t),n},octEncode:function(e,t){return us.octEncodeInRange(e,255,t)}},cs=new Ot,ls=new Uint8Array(1);function fs(e){return ls[0]=e,ls[0]}us.octEncodeToCartesian4=function(e,t){return us.octEncodeInRange(e,65535,cs),t.x=fs(cs.x*ss),t.y=fs(cs.x),t.z=fs(cs.y*ss),t.w=fs(cs.y),t},us.octDecodeInRange=function(e,t,n,r){if(O.defined("result",r),e<0||e>n||t<0||t>n)throw new T(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=v.fromSNorm(e,n),r.y=v.fromSNorm(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const e=r.x;r.x=(1-Math.abs(r.y))*v.signNotZero(e),r.y=(1-Math.abs(e))*v.signNotZero(r.y)}return L.normalize(r,r)},us.octDecode=function(e,t,n){return us.octDecodeInRange(e,t,255,n)},us.octDecodeFromCartesian4=function(e,t){O.typeOf.object("encoded",e),O.typeOf.object("result",t);const n=e.x,r=e.y,o=e.z,i=e.w;if(n<0||n>255||r<0||r>255||o<0||o>255||i<0||i>255)throw new T("x, y, z, and w must be unsigned normalized integers between 0 and 255");const a=256*n+r,s=256*o+i;return us.octDecodeInRange(a,s,65535,t)},us.octPackFloat=function(e){return O.defined("encoded",e),256*e.x+e.y};const hs=new Ot;function ps(e){return e>>1^-(1&e)}us.octEncodeFloat=function(e){return us.octEncode(e,hs),us.octPackFloat(hs)},us.octDecodeFloat=function(e,t){O.defined("value",e);const n=e/256,r=Math.floor(n),o=256*(n-r);return us.octDecode(r,o,t)},us.octPack=function(e,t,n,r){O.defined("v1",e),O.defined("v2",t),O.defined("v3",n),O.defined("result",r);const o=us.octEncodeFloat(e),i=us.octEncodeFloat(t),a=us.octEncode(n,hs);return r.x=65536*a.x+o,r.y=65536*a.y+i,r},us.octUnpack=function(e,t,n,r){O.defined("packed",e),O.defined("v1",t),O.defined("v2",n),O.defined("v3",r);let o=e.x/65536;const i=Math.floor(o),a=65536*(o-i);o=e.y/65536;const s=Math.floor(o),u=65536*(o-s);us.octDecodeFloat(a,t),us.octDecodeFloat(u,n),us.octDecode(i,s,r)},us.compressTextureCoordinates=function(e){return O.defined("textureCoordinates",e),4096*(4095*e.x|0)+(4095*e.y|0)},us.decompressTextureCoordinates=function(e,t){O.defined("compressed",e),O.defined("result",t);const n=e/4096,r=Math.floor(n);return t.x=r/4095,t.y=(e-4096*r)/4095,t},us.zigZagDeltaDecode=function(e,t,n){O.defined("uBuffer",e),O.defined("vBuffer",t),O.typeOf.number.equals("uBuffer.length","vBuffer.length",e.length,t.length),w(n)&&O.typeOf.number.equals("uBuffer.length","heightBuffer.length",e.length,n.length);const r=e.length;let o=0,i=0,a=0;for(let s=0;s<r;++s)o+=ps(e[s]),i+=ps(t[s]),e[s]=o,t[s]=i,w(n)&&(a+=ps(n[s]),n[s]=a)},us.dequantize=function(e,t,n,r){O.defined("typedArray",e),O.defined("componentDatatype",t),O.defined("type",n),O.defined("count",r);const o=as.getNumberOfComponents(n);let i;switch(t){case Ui.BYTE:i=127;break;case Ui.UNSIGNED_BYTE:i=255;break;case Ui.SHORT:i=32767;break;case Ui.UNSIGNED_SHORT:i=65535;break;case Ui.INT:i=2147483647;break;case Ui.UNSIGNED_INT:i=4294967295;break;default:throw new T(`Cannot dequantize component datatype: ${t}`)}const a=new Float32Array(r*o);for(let s=0;s<r;s++)for(let t=0;t<o;t++){const n=s*o+t;a[n]=Math.max(e[n]/i,-1)}return a},us.decodeRGB565=function(e,t){O.defined("typedArray",e);const n=3*e.length;w(t)&&O.typeOf.number.equals("result.length","typedArray.length * 3",t.length,n);const r=e.length;w(t)||(t=new Float32Array(3*r));const o=1/31,i=1/63;for(let a=0;a<r;a++){const n=e[a],r=n>>11,s=n>>5&63,u=31&n,c=3*a;t[c]=r*o,t[c+1]=s*i,t[c+2]=u*o}return t};const ms=new L,ds=new L,ys=new L;function _s(){this.high=L.clone(L.ZERO),this.low=L.clone(L.ZERO)}_s.encode=function(e,t){let n;return O.typeOf.number("value",e),w(t)||(t={high:0,low:0}),e>=0?(n=65536*Math.floor(e/65536),t.high=n,t.low=e-n):(n=65536*Math.floor(-e/65536),t.high=-n,t.low=e+n),t};const gs={high:0,low:0};_s.fromCartesian=function(e,t){O.typeOf.object("cartesian",e),w(t)||(t=new _s);const n=t.high,r=t.low;return _s.encode(e.x,gs),n.x=gs.high,r.x=gs.low,_s.encode(e.y,gs),n.y=gs.high,r.y=gs.low,_s.encode(e.z,gs),n.z=gs.high,r.z=gs.low,t};const Es=new _s;_s.writeElements=function(e,t,n){O.defined("cartesianArray",t),O.typeOf.number("index",n),O.typeOf.number.greaterThanOrEquals("index",n,0),_s.fromCartesian(e,Es);const r=Es.high,o=Es.low;t[n]=r.x,t[n+1]=r.y,t[n+2]=r.z,t[n+3]=o.x,t[n+4]=o.y,t[n+5]=o.z};const bs={};function ws(e,t,n){const r=e+t;return v.sign(e)!==v.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}bs.computeDiscriminant=function(e,t,n){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");return t*t-4*e*n},bs.computeRealRoots=function(e,t,n){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");let r;if(0===e)return 0===t?[]:[-n/t];if(0===t){if(0===n)return[0,0];const t=Math.abs(n),o=Math.abs(e);if(t<o&&t/o<v.EPSILON14)return[0,0];if(t>o&&o/t<v.EPSILON14)return[];if(r=-n/e,r<0)return[];const i=Math.sqrt(r);return[-i,i]}if(0===n)return r=-t/e,r<0?[r,0]:[0,r];const o=ws(t*t,-4*e*n,v.EPSILON14);if(o<0)return[];const i=-.5*ws(t,v.sign(t)*Math.sqrt(o),v.EPSILON14);return t>0?[i/e,n/i]:[n/i,i/e]};const Ts={};function Os(e,t,n,r){const o=e,i=t/3,a=n/3,s=r,u=o*a,c=i*s,l=i*i,f=a*a,h=o*a-l,p=o*s-i*a,m=i*s-f,d=4*h*m-p*p;let y,_;if(d<0){let e,t,n;l*c>=u*f?(e=o,t=h,n=-2*i*h+o*p):(e=s,t=m,n=-s*p+2*a*m);const r=-(n<0?-1:1)*Math.abs(e)*Math.sqrt(-d);_=-n+r;const g=_/2,E=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),b=_===r?-E:-t/E;return y=t<=0?E+b:-n/(E*E+b*b+t),l*c>=u*f?[(y-i)/o]:[-s/(y+a)]}const g=h,E=-2*i*h+o*p,b=m,w=-s*p+2*a*m,T=Math.sqrt(d),O=Math.sqrt(3)/2;let A=Math.abs(Math.atan2(o*T,-E)/3);y=2*Math.sqrt(-g);let x=Math.cos(A);_=y*x;let R=y*(-x/2-O*Math.sin(A));const S=_+R>2*i?_-i:R-i,I=o,C=S/I;A=Math.abs(Math.atan2(s*T,-w)/3),y=2*Math.sqrt(-b),x=Math.cos(A),_=y*x,R=y*(-x/2-O*Math.sin(A));const N=-s,v=_+R<2*a?_+a:R+a,P=N/v,M=-S*v-I*N,L=(a*M-i*(S*N))/(-i*M+a*(I*v));return C<=L?C<=P?L<=P?[C,L,P]:[C,P,L]:[P,C,L]:C<=P?[L,C,P]:L<=P?[L,P,C]:[P,L,C]}Ts.computeDiscriminant=function(e,t,n,r){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");if("number"!=typeof r)throw new T("d is a required number.");const o=t*t,i=n*n;return 18*e*t*n*r+o*i-e*e*27*(r*r)-4*(e*i*n+o*t*r)},Ts.computeRealRoots=function(e,t,n,r){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");if("number"!=typeof r)throw new T("d is a required number.");let o,i;if(0===e)return bs.computeRealRoots(t,n,r);if(0===t){if(0===n){if(0===r)return[0,0,0];i=-r/e;const t=i<0?-Math.pow(-i,1/3):Math.pow(i,1/3);return[t,t,t]}return 0===r?(o=bs.computeRealRoots(e,0,n),0===o.Length?[0]:[o[0],0,o[1]]):Os(e,0,n,r)}return 0===n?0===r?(i=-t/e,i<0?[i,0,0]:[0,0,i]):Os(e,t,0,r):0===r?(o=bs.computeRealRoots(e,t,n),0===o.length?[0]:o[1]<=0?[o[0],o[1],0]:o[0]>=0?[0,o[0],o[1]]:[o[0],0,o[1]]):Os(e,t,n,r)};const As={};function xs(e,t){t=L.clone(t??L.ZERO),L.equals(t,L.ZERO)||L.normalize(t,t),this.origin=L.clone(e??L.ZERO),this.direction=t}As.computeDiscriminant=function(e,t,n,r,o){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");if("number"!=typeof r)throw new T("d is a required number.");if("number"!=typeof o)throw new T("e is a required number.");const i=e*e,a=t*t,s=a*t,u=n*n,c=u*n,l=r*r,f=l*r,h=o*o;return a*u*l-4*s*f-4*e*c*l+18*e*t*n*f-27*i*l*l+i*e*256*(h*o)+o*(18*s*n*r-4*a*c+16*e*u*u-80*e*t*u*r-6*e*a*l+144*i*n*l)+h*(144*e*a*n-27*a*a-128*i*u-192*i*t*r)},As.computeRealRoots=function(e,t,n,r,o){if("number"!=typeof e)throw new T("a is a required number.");if("number"!=typeof t)throw new T("b is a required number.");if("number"!=typeof n)throw new T("c is a required number.");if("number"!=typeof r)throw new T("d is a required number.");if("number"!=typeof o)throw new T("e is a required number.");if(Math.abs(e)<v.EPSILON15)return Ts.computeRealRoots(t,n,r,o);const i=t/e,a=n/e,s=r/e,u=o/e;let c=i<0?1:0;switch(c+=a<0?c+1:c,c+=s<0?c+1:c,c+=u<0?c+1:c,c){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return function(e,t,n,r){const o=e*e,i=t-3*o/8,a=n-t*e/2+o*e/8,s=r-n*e/4+t*o/16-3*o*o/256,u=Ts.computeRealRoots(1,2*i,i*i-4*s,-a*a);if(u.length>0){const t=-e/4,n=u[u.length-1];if(Math.abs(n)<v.EPSILON14){const e=bs.computeRealRoots(1,i,s);if(2===e.length){const n=e[0],r=e[1];let o;if(n>=0&&r>=0){const e=Math.sqrt(n),o=Math.sqrt(r);return[t-o,t-e,t+e,t+o]}if(n>=0&&r<0)return o=Math.sqrt(n),[t-o,t+o];if(n<0&&r>=0)return o=Math.sqrt(r),[t-o,t+o]}return[]}if(n>0){const e=Math.sqrt(n),r=(i+n-a/e)/2,o=(i+n+a/e)/2,s=bs.computeRealRoots(1,e,r),u=bs.computeRealRoots(1,-e,o);return 0!==s.length?(s[0]+=t,s[1]+=t,0!==u.length?(u[0]+=t,u[1]+=t,s[1]<=u[0]?[s[0],s[1],u[0],u[1]]:u[1]<=s[0]?[u[0],u[1],s[0],s[1]]:s[0]>=u[0]&&s[1]<=u[1]?[u[0],s[0],s[1],u[1]]:u[0]>=s[0]&&u[1]<=s[1]?[s[0],u[0],u[1],s[1]]:s[0]>u[0]&&s[0]<u[1]?[u[0],s[0],u[1],s[1]]:[s[0],u[0],s[1],u[1]]):s):0!==u.length?(u[0]+=t,u[1]+=t,u):[]}}return[]}(i,a,s,u);case 1:case 2:case 5:case 8:case 11:return function(e,t,n,r){const o=e*e,i=-2*t,a=n*e+t*t-4*r,s=o*r-n*t*e+n*n,u=Ts.computeRealRoots(1,i,a,s);if(u.length>0){const i=u[0],a=t-i,s=a*a,c=e/2,l=a/2,f=s-4*r,h=s+4*Math.abs(r),p=o-4*i,m=o+4*Math.abs(i);let d,y,_,g,E,b;if(i<0||f*m<p*h){const t=Math.sqrt(p);d=t/2,y=0===t?0:(e*l-n)/t}else{const t=Math.sqrt(f);d=0===t?0:(e*l-n)/t,y=t/2}0===c&&0===d?(_=0,g=0):v.sign(c)===v.sign(d)?(_=c+d,g=i/_):(g=c-d,_=i/g),0===l&&0===y?(E=0,b=0):v.sign(l)===v.sign(y)?(E=l+y,b=r/E):(b=l-y,E=r/b);const w=bs.computeRealRoots(1,_,E),T=bs.computeRealRoots(1,g,b);if(0!==w.length)return 0!==T.length?w[1]<=T[0]?[w[0],w[1],T[0],T[1]]:T[1]<=w[0]?[T[0],T[1],w[0],w[1]]:w[0]>=T[0]&&w[1]<=T[1]?[T[0],w[0],w[1],T[1]]:T[0]>=w[0]&&T[1]<=w[1]?[w[0],T[0],T[1],w[1]]:w[0]>T[0]&&w[0]<T[1]?[T[0],w[0],T[1],w[1]]:[w[0],T[0],w[1],T[1]]:w;if(0!==T.length)return T}return[]}(i,a,s,u);default:return}},xs.clone=function(e,t){if(w(e))return w(t)?(t.origin=L.clone(e.origin),t.direction=L.clone(e.direction),t):new xs(e.origin,e.direction)},xs.getPoint=function(e,t,n){return O.typeOf.object("ray",e),O.typeOf.number("t",t),w(n)||(n=new L),n=L.multiplyByScalar(e.direction,t,n),L.add(e.origin,n,n)};const Rs={rayPlane:function(e,t,n){if(!w(e))throw new T("ray is required.");if(!w(t))throw new T("plane is required.");w(n)||(n=new L);const r=e.origin,o=e.direction,i=t.normal,a=L.dot(i,o);if(Math.abs(a)<v.EPSILON15)return;const s=(-t.distance-L.dot(i,r))/a;return s<0?void 0:(n=L.multiplyByScalar(o,s,n),L.add(r,n,n))}},Ss=new L,Is=new L,Cs=new L,Ns=new L,vs=new L;Rs.rayTriangleParametric=function(e,t,n,r,o){if(!w(e))throw new T("ray is required.");if(!w(t))throw new T("p0 is required.");if(!w(n))throw new T("p1 is required.");if(!w(r))throw new T("p2 is required.");o=o??!1;const i=e.origin,a=e.direction,s=L.subtract(n,t,Ss),u=L.subtract(r,t,Is),c=L.cross(a,u,Cs),l=L.dot(s,c);let f,h,p,m,d;if(o){if(l<v.EPSILON6)return;if(f=L.subtract(i,t,Ns),p=L.dot(f,c),p<0||p>l)return;if(h=L.cross(f,s,vs),m=L.dot(a,h),m<0||p+m>l)return;d=L.dot(u,h)/l}else{if(Math.abs(l)<v.EPSILON6)return;const e=1/l;if(f=L.subtract(i,t,Ns),p=L.dot(f,c)*e,p<0||p>1)return;if(h=L.cross(f,s,vs),m=L.dot(a,h)*e,m<0||p+m>1)return;d=L.dot(u,h)*e}return d},Rs.rayTriangle=function(e,t,n,r,o,i){const a=Rs.rayTriangleParametric(e,t,n,r,o);if(w(a)&&!(a<0))return w(i)||(i=new L),L.multiplyByScalar(e.direction,a,i),L.add(e.origin,i,i)};const Ps=new xs;Rs.lineSegmentTriangle=function(e,t,n,r,o,i,a){if(!w(e))throw new T("v0 is required.");if(!w(t))throw new T("v1 is required.");if(!w(n))throw new T("p0 is required.");if(!w(r))throw new T("p1 is required.");if(!w(o))throw new T("p2 is required.");const s=Ps;L.clone(e,s.origin),L.subtract(t,e,s.direction),L.normalize(s.direction,s.direction);const u=Rs.rayTriangleParametric(s,n,r,o,i);if(!(!w(u)||u<0||u>L.distance(e,t)))return w(a)||(a=new L),L.multiplyByScalar(s.direction,u,a),L.add(s.origin,a,a)};const Ms={root0:0,root1:0};function Ls(e,t,n){w(n)||(n=new ca);const r=e.origin,o=e.direction,i=t.center,a=t.radius*t.radius,s=L.subtract(r,i,Cs),u=function(e,t,n,r){const o=t*t-4*e*n;if(o<0)return;if(o>0){const n=1/(2*e),i=Math.sqrt(o),a=(-t+i)*n,s=(-t-i)*n;return a<s?(r.root0=a,r.root1=s):(r.root0=s,r.root1=a),r}const i=-t/(2*e);return 0!==i?(r.root0=r.root1=i,r):void 0}(L.dot(o,o),2*L.dot(o,s),L.magnitudeSquared(s)-a,Ms);if(w(u))return n.start=u.root0,n.stop=u.root1,n}Rs.raySphere=function(e,t,n){if(!w(e))throw new T("ray is required.");if(!w(t))throw new T("sphere is required.");if(w(n=Ls(e,t,n))&&!(n.stop<0))return n.start=Math.max(n.start,0),n};const Fs=new xs;Rs.lineSegmentSphere=function(e,t,n,r){if(!w(e))throw new T("p0 is required.");if(!w(t))throw new T("p1 is required.");if(!w(n))throw new T("sphere is required.");const o=Fs;L.clone(e,o.origin);const i=L.subtract(t,e,o.direction),a=L.magnitude(i);if(L.normalize(i,i),!(!w(r=Ls(o,n,r))||r.stop<0||r.start>a))return r.start=Math.max(r.start,0),r.stop=Math.min(r.stop,a),r};const Ds=new L,zs=new L;function Bs(e,t,n){const r=e+t;return v.sign(e)!==v.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}Rs.rayEllipsoid=function(e,t){if(!w(e))throw new T("ray is required.");if(!w(t))throw new T("ellipsoid is required.");const n=t.oneOverRadii,r=L.multiplyComponents(n,e.origin,Ds),o=L.multiplyComponents(n,e.direction,zs),i=L.magnitudeSquared(r),a=L.dot(r,o);let s,u,c,l,f;if(i>1){if(a>=0)return;const e=a*a;if(s=i-1,u=L.magnitudeSquared(o),c=u*s,e<c)return;if(e>c){l=a*a-c,f=-a+Math.sqrt(l);const e=f/u,t=s/f;return e<t?new ca(e,t):{start:t,stop:e}}const t=Math.sqrt(s/u);return new ca(t,t)}return i<1?(s=i-1,u=L.magnitudeSquared(o),c=u*s,l=a*a-c,f=-a+Math.sqrt(l),new ca(0,f/u)):a<0?(u=L.magnitudeSquared(o),new ca(0,-a/u)):void 0},Rs.quadraticVectorExpression=function(e,t,n,r,o){const i=r*r,a=o*o,s=(e[Z.COLUMN1ROW1]-e[Z.COLUMN2ROW2])*a,u=o*(r*Bs(e[Z.COLUMN1ROW0],e[Z.COLUMN0ROW1],v.EPSILON15)+t.y),c=e[Z.COLUMN0ROW0]*i+e[Z.COLUMN2ROW2]*a+r*t.x+n,l=a*Bs(e[Z.COLUMN2ROW1],e[Z.COLUMN1ROW2],v.EPSILON15),f=o*(r*Bs(e[Z.COLUMN2ROW0],e[Z.COLUMN0ROW2])+t.z);let h;const p=[];if(0===f&&0===l){if(h=bs.computeRealRoots(s,u,c),0===h.length)return p;const e=h[0],t=Math.sqrt(Math.max(1-e*e,0));if(p.push(new L(r,o*e,o*-t)),p.push(new L(r,o*e,o*t)),2===h.length){const e=h[1],t=Math.sqrt(Math.max(1-e*e,0));p.push(new L(r,o*e,o*-t)),p.push(new L(r,o*e,o*t))}return p}const m=f*f,d=l*l,y=f*l,_=s*s+d,g=2*(u*s+y),E=2*c*s+u*u-d+m,b=2*(c*u-y),w=c*c-m;if(0===_&&0===g&&0===E&&0===b)return p;h=As.computeRealRoots(_,g,E,b,w);const T=h.length;if(0===T)return p;for(let O=0;O<T;++O){const e=h[O],t=e*e,n=Math.max(1-t,0),i=Math.sqrt(n);let a;a=v.sign(s)===v.sign(c)?Bs(s*t+c,u*e,v.EPSILON12):v.sign(c)===v.sign(u*e)?Bs(s*t,u*e+c,v.EPSILON12):Bs(s*t+u*e,c,v.EPSILON12);const m=a*Bs(l*e,f,v.EPSILON15);m<0?p.push(new L(r,o*e,o*i)):m>0?p.push(new L(r,o*e,o*-i)):0!==i?(p.push(new L(r,o*e,o*-i)),p.push(new L(r,o*e,o*i)),++O):p.push(new L(r,o*e,o*i))}return p};const Us=new L,js=new L,qs=new L,Gs=new L,ks=new L,Ws=new Z,Vs=new Z,Hs=new Z,Ys=new Z,Xs=new Z,$s=new Z,Ks=new Z,Zs=new L,Qs=new L,Js=new Pt;Rs.grazingAltitudeLocation=function(e,t){if(!w(e))throw new T("ray is required.");if(!w(t))throw new T("ellipsoid is required.");const n=e.origin,r=e.direction;if(!L.equals(n,L.ZERO)){const e=t.geodeticSurfaceNormal(n,Us);if(L.dot(r,e)>=0)return n}const o=w(this.rayEllipsoid(e,t)),i=t.transformPositionToScaledSpace(r,Us),a=L.normalize(i,i),s=L.mostOrthogonalAxis(i,Gs),u=L.normalize(L.cross(s,a,js),js),c=L.normalize(L.cross(a,u,qs),qs),l=Ws;l[0]=a.x,l[1]=a.y,l[2]=a.z,l[3]=u.x,l[4]=u.y,l[5]=u.z,l[6]=c.x,l[7]=c.y,l[8]=c.z;const f=Z.transpose(l,Vs),h=Z.fromScale(t.radii,Hs),p=Z.fromScale(t.oneOverRadii,Ys),m=Xs;m[0]=0,m[1]=-r.z,m[2]=r.y,m[3]=r.z,m[4]=0,m[5]=-r.x,m[6]=-r.y,m[7]=r.x,m[8]=0;const d=Z.multiply(Z.multiply(f,p,$s),m,$s),y=Z.multiply(Z.multiply(d,h,Ks),l,Ks),_=Z.multiplyByVector(d,n,ks),g=Rs.quadraticVectorExpression(y,L.negate(_,Us),0,0,1);let E,b;const O=g.length;if(O>0){let e=L.clone(L.ZERO,Qs),i=Number.NEGATIVE_INFINITY;for(let t=0;t<O;++t){E=Z.multiplyByVector(h,Z.multiplyByVector(l,g[t],Zs),Zs);const o=L.normalize(L.subtract(E,n,Gs),Gs),a=L.dot(o,r);a>i&&(i=a,e=L.clone(E,e))}const a=t.cartesianToCartographic(e,Js);return i=v.clamp(i,0,1),b=L.magnitude(L.subtract(e,n,Gs))*Math.sqrt(1-i*i),b=o?-b:b,a.height=b,t.cartographicToCartesian(a,new L)}};const eu=new L;function tu(e,t){if(O.typeOf.object("normal",e),!v.equalsEpsilon(L.magnitude(e),1,v.EPSILON6))throw new T("normal must be normalized.");O.typeOf.number("distance",t),this.normal=L.clone(e),this.distance=t}Rs.lineSegmentPlane=function(e,t,n,r){if(!w(e))throw new T("endPoint0 is required.");if(!w(t))throw new T("endPoint1 is required.");if(!w(n))throw new T("plane is required.");w(r)||(r=new L);const o=L.subtract(t,e,eu),i=n.normal,a=L.dot(i,o);if(Math.abs(a)<v.EPSILON6)return;const s=L.dot(i,e),u=-(n.distance+s)/a;return u<0||u>1?void 0:(L.multiplyByScalar(o,u,r),L.add(e,r,r),r)},Rs.trianglePlaneIntersection=function(e,t,n,r){if(!(w(e)&&w(t)&&w(n)&&w(r)))throw new T("p0, p1, p2, and plane are required.");const o=r.normal,i=r.distance,a=L.dot(o,e)+i<0,s=L.dot(o,t)+i<0,u=L.dot(o,n)+i<0;let c,l,f=0;if(f+=a?1:0,f+=s?1:0,f+=u?1:0,1!==f&&2!==f||(c=new L,l=new L),1===f){if(a)return Rs.lineSegmentPlane(e,t,r,c),Rs.lineSegmentPlane(e,n,r,l),{positions:[e,t,n,c,l],indices:[0,3,4,1,2,4,1,4,3]};if(s)return Rs.lineSegmentPlane(t,n,r,c),Rs.lineSegmentPlane(t,e,r,l),{positions:[e,t,n,c,l],indices:[1,3,4,2,0,4,2,4,3]};if(u)return Rs.lineSegmentPlane(n,e,r,c),Rs.lineSegmentPlane(n,t,r,l),{positions:[e,t,n,c,l],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===f){if(!a)return Rs.lineSegmentPlane(t,e,r,c),Rs.lineSegmentPlane(n,e,r,l),{positions:[e,t,n,c,l],indices:[1,2,4,1,4,3,0,3,4]};if(!s)return Rs.lineSegmentPlane(n,t,r,c),Rs.lineSegmentPlane(e,t,r,l),{positions:[e,t,n,c,l],indices:[2,0,4,2,4,3,1,3,4]};if(!u)return Rs.lineSegmentPlane(e,n,r,c),Rs.lineSegmentPlane(t,n,r,l),{positions:[e,t,n,c,l],indices:[0,1,4,0,4,3,2,3,4]}}},tu.fromPointNormal=function(e,t,n){if(O.typeOf.object("point",e),O.typeOf.object("normal",t),!v.equalsEpsilon(L.magnitude(t),1,v.EPSILON6))throw new T("normal must be normalized.");const r=-L.dot(t,e);return w(n)?(L.clone(t,n.normal),n.distance=r,n):new tu(t,r)};const nu=new L;tu.fromCartesian4=function(e,t){O.typeOf.object("coefficients",e);const n=L.fromCartesian4(e,nu),r=e.w;if(!v.equalsEpsilon(L.magnitude(n),1,v.EPSILON6))throw new T("normal must be normalized.");return w(t)?(L.clone(n,t.normal),t.distance=r,t):new tu(n,r)},tu.getPointDistance=function(e,t){return O.typeOf.object("plane",e),O.typeOf.object("point",t),L.dot(e.normal,t)+e.distance};const ru=new L;tu.projectPointOntoPlane=function(e,t,n){O.typeOf.object("plane",e),O.typeOf.object("point",t),w(n)||(n=new L);const r=tu.getPointDistance(e,t),o=L.multiplyByScalar(e.normal,r,ru);return L.subtract(t,o,n)};const ou=new he,iu=new G,au=new L;tu.transform=function(e,t,n){O.typeOf.object("plane",e),O.typeOf.object("transform",t);const r=e.normal,o=e.distance,i=he.inverseTranspose(t,ou);let a=G.fromElements(r.x,r.y,r.z,o,iu);a=he.multiplyByVector(i,a,a);const s=L.fromCartesian4(a,au);return a=G.divideByScalar(a,L.magnitude(s),a),tu.fromCartesian4(a,n)},tu.clone=function(e,t){return O.typeOf.object("plane",e),w(t)?(L.clone(e.normal,t.normal),t.distance=e.distance,t):new tu(e.normal,e.distance)},tu.equals=function(e,t){return O.typeOf.object("left",e),O.typeOf.object("right",t),e.distance===t.distance&&L.equals(e.normal,t.normal)},tu.ORIGIN_XY_PLANE=Object.freeze(new tu(L.UNIT_Z,0)),tu.ORIGIN_YZ_PLANE=Object.freeze(new tu(L.UNIT_X,0)),tu.ORIGIN_ZX_PLANE=Object.freeze(new tu(L.UNIT_Y,0));const su={calculateACMR:function(e){const t=(e=e??K.EMPTY_OBJECT).indices;let n=e.maximumIndex;const r=e.cacheSize??24;if(!w(t))throw new T("indices is required.");const o=t.length;if(o<3||o%3!=0)throw new T("indices length must be a multiple of three.");if(n<=0)throw new T("maximumIndex must be greater than zero.");if(r<3)throw new T("cacheSize must be greater than two.");if(!w(n)){n=0;let e=0,r=t[e];for(;e<o;)r>n&&(n=r),++e,r=t[e]}const i=[];for(let s=0;s<n+1;s++)i[s]=0;let a=r+1;for(let s=0;s<o;++s)a-i[t[s]]>r&&(i[t[s]]=a,++a);return(a-r+1)/(o/3)},tipsify:function(e){const t=(e=e??K.EMPTY_OBJECT).indices,n=e.maximumIndex,r=e.cacheSize??24;let o;function i(e,t,n,r,i,a,s){let u,c=-1,l=-1,f=0;for(;f<n.length;){const e=n[f];r[e].numLiveTriangles&&(u=0,i-r[e].timeStamp+2*r[e].numLiveTriangles<=t&&(u=i-r[e].timeStamp),(u>l||-1===l)&&(l=u,c=e)),++f}return-1===c?function(e,t,n,r){for(;t.length>=1;){const n=t[t.length-1];if(t.splice(t.length-1,1),e[n].numLiveTriangles>0)return n}for(;o<r;){if(e[o].numLiveTriangles>0)return++o,o-1;++o}return-1}(r,a,0,s):c}if(!w(t))throw new T("indices is required.");const a=t.length;if(a<3||a%3!=0)throw new T("indices length must be a multiple of three.");if(n<=0)throw new T("maximumIndex must be greater than zero.");if(r<3)throw new T("cacheSize must be greater than two.");let s=0,u=0,c=t[u];const l=a;if(w(n))s=n+1;else{for(;u<l;)c>s&&(s=c),++u,c=t[u];if(-1===s)return 0;++s}const f=[];let h;for(h=0;h<s;h++)f[h]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};u=0;let p=0;for(;u<l;)f[t[u]].vertexTriangles.push(p),++f[t[u]].numLiveTriangles,f[t[u+1]].vertexTriangles.push(p),++f[t[u+1]].numLiveTriangles,f[t[u+2]].vertexTriangles.push(p),++f[t[u+2]].numLiveTriangles,++p,u+=3;let m=0,d=r+1;o=1;let y=[];const _=[];let g,E,b=0;const O=[],A=a/3,x=[];for(h=0;h<A;h++)x[h]=!1;let R,S;for(;-1!==m;){y=[],E=f[m],S=E.vertexTriangles.length;for(let e=0;e<S;++e)if(p=E.vertexTriangles[e],!x[p]){x[p]=!0,u=p+p+p;for(let e=0;e<3;++e)R=t[u],y.push(R),_.push(R),O[b]=R,++b,g=f[R],--g.numLiveTriangles,d-g.timeStamp>r&&(g.timeStamp=d,++d),++u}m=i(0,r,y,f,d,_,s)}return O}},uu={};function cu(e,t,n,r,o){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=o,e[t++]=o,e[t]=n}function lu(e){const t={};for(const n in e)if(e.hasOwnProperty(n)&&w(e[n])&&w(e[n].values)){const r=e[n];t[n]=new Qi({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function fu(e,t,n){for(const r in t)if(t.hasOwnProperty(r)&&w(t[r])&&w(t[r].values)){const o=t[r];for(let t=0;t<o.componentsPerAttribute;++t)e[r].values.push(o.values[n*o.componentsPerAttribute+t])}}uu.toWireframe=function(e){if(!w(e))throw new T("geometry is required.");const t=e.indices;if(w(t)){switch(e.primitiveType){case Ti.TRIANGLES:e.indices=function(e){const t=e.length,n=t/3*6,r=Pe.createTypedArray(t,n);let o=0;for(let i=0;i<t;i+=3,o+=6)cu(r,o,e[i],e[i+1],e[i+2]);return r}(t);break;case Ti.TRIANGLE_STRIP:e.indices=function(e){const t=e.length;if(t>=3){const n=6*(t-2),r=Pe.createTypedArray(t,n);cu(r,0,e[0],e[1],e[2]);let o=6;for(let i=3;i<t;++i,o+=6)cu(r,o,e[i-1],e[i],e[i-2]);return r}return new Uint16Array}(t);break;case Ti.TRIANGLE_FAN:e.indices=function(e){if(e.length>0){const t=e.length-1,n=6*(t-1),r=Pe.createTypedArray(t,n),o=e[0];let i=0;for(let a=1;a<t;++a,i+=6)cu(r,i,o,e[a],e[a+1]);return r}return new Uint16Array}(t);break;default:throw new T("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=Ti.LINES}return e},uu.createLineSegmentsForVectors=function(e,t,n){if(t=t??"normal",!w(e))throw new T("geometry is required.");if(!w(e.attributes.position))throw new T("geometry.attributes.position is required.");if(!w(e.attributes[t]))throw new T(`geometry.attributes must have an attribute with the same name as the attributeName parameter, ${t}.`);n=n??1e4;const r=e.attributes.position.values,o=e.attributes[t].values,i=r.length,a=new Float64Array(2*i);let s,u=0;for(let l=0;l<i;l+=3)a[u++]=r[l],a[u++]=r[l+1],a[u++]=r[l+2],a[u++]=r[l]+o[l]*n,a[u++]=r[l+1]+o[l+1]*n,a[u++]=r[l+2]+o[l+2]*n;const c=e.boundingSphere;return w(c)&&(s=new la(c.center,c.radius+n)),new qi({attributes:{position:new Qi({componentDatatype:Ui.DOUBLE,componentsPerAttribute:3,values:a})},primitiveType:Ti.LINES,boundingSphere:s})},uu.createAttributeLocations=function(e){if(!w(e))throw new T("geometry is required.");const t=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,r={};let o,i=0;const a=t.length;for(o=0;o<a;++o){const e=t[o];w(n[e])&&(r[e]=i++)}for(const s in n)n.hasOwnProperty(s)&&!w(r[s])&&(r[s]=i++);return r},uu.reorderForPreVertexCache=function(e){if(!w(e))throw new T("geometry is required.");const t=qi.computeNumberOfVertices(e),n=e.indices;if(w(n)){const r=new Int32Array(t);for(let e=0;e<t;e++)r[e]=-1;const o=n,i=o.length,a=Pe.createTypedArray(t,i);let s,u=0,c=0,l=0;for(;u<i;)s=r[o[u]],-1!==s?a[c]=s:(s=o[u],r[s]=l,a[c]=l,++l),++u,++c;e.indices=a;const f=e.attributes;for(const e in f)if(f.hasOwnProperty(e)&&w(f[e])&&w(f[e].values)){const n=f[e],o=n.values;let i=0;const a=n.componentsPerAttribute,s=Ui.createTypedArray(n.componentDatatype,l*a);for(;i<t;){const e=r[i];if(-1!==e)for(let t=0;t<a;t++)s[a*e+t]=o[a*i+t];++i}n.values=s}}return e},uu.reorderForPostVertexCache=function(e,t){if(!w(e))throw new T("geometry is required.");const n=e.indices;if(e.primitiveType===Ti.TRIANGLES&&w(n)){const r=n.length;let o=0;for(let e=0;e<r;e++)n[e]>o&&(o=n[e]);e.indices=su.tipsify({indices:n,maximumIndex:o,cacheSize:t})}return e},uu.fitToUnsignedShortIndices=function(e){if(!w(e))throw new T("geometry is required.");if(w(e.indices)&&e.primitiveType!==Ti.TRIANGLES&&e.primitiveType!==Ti.LINES&&e.primitiveType!==Ti.POINTS)throw new T("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");const t=[],n=qi.computeNumberOfVertices(e);if(w(e.indices)&&n>=v.SIXTY_FOUR_KILOBYTES){let n=[],r=[],o=0,i=lu(e.attributes);const a=e.indices,s=a.length;let u;e.primitiveType===Ti.TRIANGLES?u=3:e.primitiveType===Ti.LINES?u=2:e.primitiveType===Ti.POINTS&&(u=1);for(let c=0;c<s;c+=u){for(let t=0;t<u;++t){const s=a[c+t];let u=n[s];w(u)||(u=o++,n[s]=u,fu(i,e.attributes,s)),r.push(u)}o+u>=v.SIXTY_FOUR_KILOBYTES&&(t.push(new qi({attributes:i,indices:r,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),n=[],r=[],o=0,i=lu(e.attributes))}0!==r.length&&t.push(new qi({attributes:i,indices:r,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};const hu=new L,pu=new Pt;uu.projectTo2D=function(e,t,n,r,o){if(!w(e))throw new T("geometry is required.");if(!w(t))throw new T("attributeName is required.");if(!w(n))throw new T("attributeName3D is required.");if(!w(r))throw new T("attributeName2D is required.");if(!w(e.attributes[t]))throw new T(`geometry must have attribute matching the attributeName argument: ${t}.`);if(e.attributes[t].componentDatatype!==Ui.DOUBLE)throw new T("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");const i=e.attributes[t],a=(o=w(o)?o:new Yt).ellipsoid,s=i.values,u=new Float64Array(s.length);let c=0;for(let l=0;l<s.length;l+=3){const e=L.fromArray(s,l,hu),t=a.cartesianToCartographic(e,pu);if(!w(t))throw new T(`Could not project point (${e.x}, ${e.y}, ${e.z}) to 2D.`);const n=o.project(t,hu);u[c++]=n.x,u[c++]=n.y,u[c++]=n.z}return e.attributes[n]=i,e.attributes[r]=new Qi({componentDatatype:Ui.DOUBLE,componentsPerAttribute:3,values:u}),delete e.attributes[t],e};const mu={high:0,low:0};uu.encodeAttribute=function(e,t,n,r){if(!w(e))throw new T("geometry is required.");if(!w(t))throw new T("attributeName is required.");if(!w(n))throw new T("attributeHighName is required.");if(!w(r))throw new T("attributeLowName is required.");if(!w(e.attributes[t]))throw new T(`geometry must have attribute matching the attributeName argument: ${t}.`);if(e.attributes[t].componentDatatype!==Ui.DOUBLE)throw new T("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");const o=e.attributes[t],i=o.values,a=i.length,s=new Float32Array(a),u=new Float32Array(a);for(let l=0;l<a;++l)_s.encode(i[l],mu),s[l]=mu.high,u[l]=mu.low;const c=o.componentsPerAttribute;return e.attributes[n]=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:c,values:s}),e.attributes[r]=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:c,values:u}),delete e.attributes[t],e};let du=new L;function yu(e,t){if(w(t)){const n=t.values,r=n.length;for(let t=0;t<r;t+=3)L.unpack(n,t,du),he.multiplyByPoint(e,du,du),L.pack(du,n,t)}}function _u(e,t){if(w(t)){const n=t.values,r=n.length;for(let t=0;t<r;t+=3)L.unpack(n,t,du),Z.multiplyByVector(e,du,du),du=L.normalize(du,du),L.pack(du,n,t)}}const gu=new he,Eu=new Z;uu.transformToWorldCoordinates=function(e){if(!w(e))throw new T("instance is required.");const t=e.modelMatrix;if(he.equals(t,he.IDENTITY))return e;const n=e.geometry.attributes;yu(t,n.position),yu(t,n.prevPosition),yu(t,n.nextPosition),(w(n.normal)||w(n.tangent)||w(n.bitangent))&&(he.inverse(t,gu),he.transpose(gu,gu),he.getMatrix3(gu,Eu),_u(Eu,n.normal),_u(Eu,n.tangent),_u(Eu,n.bitangent));const r=e.geometry.boundingSphere;return w(r)&&(e.geometry.boundingSphere=la.transform(r,t,r)),e.modelMatrix=he.clone(he.IDENTITY),e};const bu=new L;function wu(e,t){const n=e.length;let r,o,i,a;const s=e[0].modelMatrix,u=w(e[0][t].indices),c=e[0][t].primitiveType;for(o=1;o<n;++o){if(!he.equals(e[o].modelMatrix,s))throw new T("All instances must have the same modelMatrix.");if(w(e[o][t].indices)!==u)throw new T("All instance geometries must have an indices or not have one.");if(e[o][t].primitiveType!==c)throw new T("All instance geometries must have the same primitiveType.")}const l=function(e,t){const n=e.length,r={},o=e[0][t].attributes;let i;for(i in o)if(o.hasOwnProperty(i)&&w(o[i])&&w(o[i].values)){const a=o[i];let s=a.values.length,u=!0;for(let r=1;r<n;++r){const n=e[r][t].attributes[i];if(!w(n)||a.componentDatatype!==n.componentDatatype||a.componentsPerAttribute!==n.componentsPerAttribute||a.normalize!==n.normalize){u=!1;break}s+=n.values.length}u&&(r[i]=new Qi({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:Ui.createTypedArray(a.componentDatatype,s)}))}return r}(e,t);let f,h,p,m;for(r in l)if(l.hasOwnProperty(r))for(f=l[r].values,a=0,o=0;o<n;++o)for(h=e[o][t].attributes[r].values,p=h.length,i=0;i<p;++i)f[a++]=h[i];if(u){let r=0;for(o=0;o<n;++o)r+=e[o][t].indices.length;const i=qi.computeNumberOfVertices(new qi({attributes:l,primitiveType:Ti.POINTS})),s=Pe.createTypedArray(i,r);let u=0,c=0;for(o=0;o<n;++o){const n=e[o][t].indices,r=n.length;for(a=0;a<r;++a)s[u++]=c+n[a];c+=qi.computeNumberOfVertices(e[o][t])}m=s}let d,y=new L,_=0;for(o=0;o<n;++o){if(d=e[o][t].boundingSphere,!w(d)){y=void 0;break}L.add(d.center,y,y)}if(w(y))for(L.divideByScalar(y,n,y),o=0;o<n;++o){d=e[o][t].boundingSphere;const n=L.magnitude(L.subtract(d.center,y,bu))+d.radius;n>_&&(_=n)}return new qi({attributes:l,indices:m,primitiveType:c,boundingSphere:w(y)?new la(y,_):void 0})}uu.combineInstances=function(e){if(!w(e)||e.length<1)throw new T("instances is required and must have length greater than zero.");const t=[],n=[],r=e.length;for(let i=0;i<r;++i){const r=e[i];w(r.geometry)?t.push(r):w(r.westHemisphereGeometry)&&w(r.eastHemisphereGeometry)&&n.push(r)}const o=[];return t.length>0&&o.push(wu(t,"geometry")),n.length>0&&(o.push(wu(n,"westHemisphereGeometry")),o.push(wu(n,"eastHemisphereGeometry"))),o};const Tu=new L,Ou=new L,Au=new L,xu=new L;uu.computeNormal=function(e){if(!w(e))throw new T("geometry is required.");if(!w(e.attributes.position)||!w(e.attributes.position.values))throw new T("geometry.attributes.position.values is required.");if(!w(e.indices))throw new T("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new T("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==Ti.TRIANGLES)throw new T("geometry.primitiveType must be PrimitiveType.TRIANGLES.");const t=e.indices,n=e.attributes,r=n.position.values,o=n.position.values.length/3,i=t.length,a=new Array(o),s=new Array(i/3),u=new Array(i);let c;for(c=0;c<o;c++)a[c]={indexOffset:0,count:0,currentCount:0};let l=0;for(c=0;c<i;c+=3){const e=t[c],n=t[c+1],o=t[c+2],i=3*e,u=3*n,f=3*o;Ou.x=r[i],Ou.y=r[i+1],Ou.z=r[i+2],Au.x=r[u],Au.y=r[u+1],Au.z=r[u+2],xu.x=r[f],xu.y=r[f+1],xu.z=r[f+2],a[e].count++,a[n].count++,a[o].count++,L.subtract(Au,Ou,Au),L.subtract(xu,Ou,xu),s[l]=L.cross(Au,xu,new L),l++}let f,h=0;for(c=0;c<o;c++)a[c].indexOffset+=h,h+=a[c].count;for(l=0,c=0;c<i;c+=3){f=a[t[c]];let e=f.indexOffset+f.currentCount;u[e]=l,f.currentCount++,f=a[t[c+1]],e=f.indexOffset+f.currentCount,u[e]=l,f.currentCount++,f=a[t[c+2]],e=f.indexOffset+f.currentCount,u[e]=l,f.currentCount++,l++}const p=new Float32Array(3*o);for(c=0;c<o;c++){const e=3*c;if(f=a[c],L.clone(L.ZERO,Tu),f.count>0){for(l=0;l<f.count;l++)L.add(Tu,s[u[f.indexOffset+l]],Tu);L.equalsEpsilon(L.ZERO,Tu,v.EPSILON10)&&L.clone(s[u[f.indexOffset]],Tu)}L.equalsEpsilon(L.ZERO,Tu,v.EPSILON10)&&(Tu.z=1),L.normalize(Tu,Tu),p[e]=Tu.x,p[e+1]=Tu.y,p[e+2]=Tu.z}return e.attributes.normal=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:p}),e};const Ru=new L,Su=new L,Iu=new L;uu.computeTangentAndBitangent=function(e){if(!w(e))throw new T("geometry is required.");const t=e.attributes,n=e.indices;if(!w(t.position)||!w(t.position.values))throw new T("geometry.attributes.position.values is required.");if(!w(t.normal)||!w(t.normal.values))throw new T("geometry.attributes.normal.values is required.");if(!w(t.st)||!w(t.st.values))throw new T("geometry.attributes.st.values is required.");if(!w(n))throw new T("geometry.indices is required.");if(n.length<2||n.length%3!=0)throw new T("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==Ti.TRIANGLES)throw new T("geometry.primitiveType must be PrimitiveType.TRIANGLES.");const r=e.attributes.position.values,o=e.attributes.normal.values,i=e.attributes.st.values,a=e.attributes.position.values.length/3,s=n.length,u=new Array(3*a);let c,l,f,h;for(c=0;c<u.length;c++)u[c]=0;for(c=0;c<s;c+=3){const e=n[c],t=n[c+1],o=n[c+2];l=3*e,f=3*t,h=3*o;const a=2*e,s=2*t,p=2*o,m=r[l],d=r[l+1],y=r[l+2],_=i[a],g=i[a+1],E=i[s+1]-g,b=i[p+1]-g,w=1/((i[s]-_)*b-(i[p]-_)*E),T=(b*(r[f]-m)-E*(r[h]-m))*w,O=(b*(r[f+1]-d)-E*(r[h+1]-d))*w,A=(b*(r[f+2]-y)-E*(r[h+2]-y))*w;u[l]+=T,u[l+1]+=O,u[l+2]+=A,u[f]+=T,u[f+1]+=O,u[f+2]+=A,u[h]+=T,u[h+1]+=O,u[h+2]+=A}const p=new Float32Array(3*a),m=new Float32Array(3*a);for(c=0;c<a;c++){l=3*c,f=l+1,h=l+2;const e=L.fromArray(o,l,Ru),t=L.fromArray(u,l,Iu),n=L.dot(e,t);L.multiplyByScalar(e,n,Su),L.normalize(L.subtract(t,Su,t),t),p[l]=t.x,p[f]=t.y,p[h]=t.z,L.normalize(L.cross(e,t,t),t),m[l]=t.x,m[f]=t.y,m[h]=t.z}return e.attributes.tangent=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:p}),e.attributes.bitangent=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:3,values:m}),e};const Cu=new Ot,Nu=new L,vu=new L,Pu=new L;let Mu=new Ot;function Lu(e,t){Math.abs(e.y)<v.EPSILON6&&(e.y=t?-v.EPSILON6:v.EPSILON6)}uu.compressVertices=function(e){if(!w(e))throw new T("geometry is required.");const t=e.attributes.extrudeDirection;let n,r;if(w(t)){const o=t.values;r=o.length/3;const i=new Float32Array(2*r);let a=0;for(n=0;n<r;++n)L.fromArray(o,3*n,Nu),L.equals(Nu,L.ZERO)?a+=2:(Mu=us.octEncodeInRange(Nu,65535,Mu),i[a++]=Mu.x,i[a++]=Mu.y);return e.attributes.compressedAttributes=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:2,values:i}),delete e.attributes.extrudeDirection,e}const o=e.attributes.normal,i=e.attributes.st,a=w(o),s=w(i);if(!a&&!s)return e;const u=e.attributes.tangent,c=e.attributes.bitangent,l=w(u),f=w(c);let h,p,m,d;a&&(h=o.values),s&&(p=i.values),l&&(m=u.values),f&&(d=c.values),r=(a?h.length:p.length)/(a?3:2);let y=r,_=s&&a?2:1;_+=l||f?1:0,y*=_;const g=new Float32Array(y);let E=0;for(n=0;n<r;++n){s&&(Ot.fromArray(p,2*n,Cu),g[E++]=us.compressTextureCoordinates(Cu));const e=3*n;a&&w(m)&&w(d)?(L.fromArray(h,e,Nu),L.fromArray(m,e,vu),L.fromArray(d,e,Pu),us.octPack(Nu,vu,Pu,Cu),g[E++]=Cu.x,g[E++]=Cu.y):(a&&(L.fromArray(h,e,Nu),g[E++]=us.octEncodeFloat(Nu)),l&&(L.fromArray(m,e,Nu),g[E++]=us.octEncodeFloat(Nu)),f&&(L.fromArray(d,e,Nu),g[E++]=us.octEncodeFloat(Nu)))}return e.attributes.compressedAttributes=new Qi({componentDatatype:Ui.FLOAT,componentsPerAttribute:_,values:g}),a&&delete e.attributes.normal,s&&delete e.attributes.st,f&&delete e.attributes.bitangent,l&&delete e.attributes.tangent,e};const Fu=new L;function Du(e,t,n,r){L.add(e,L.multiplyByScalar(L.subtract(t,e,Fu),e.y/(e.y-t.y),Fu),n),L.clone(n,r),Lu(n,!0),Lu(r,!1)}const zu=new L,Bu=new L,Uu=new L,ju=new L,qu={positions:new Array(7),indices:new Array(9)};function Gu(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;!function(e,t,n){if(0!==e.y&&0!==t.y&&0!==n.y)return Lu(e,e.y<0),Lu(t,t.y<0),void Lu(n,n.y<0);const r=Math.abs(e.y),o=Math.abs(t.y),i=Math.abs(n.y);let a;a=r>o?r>i?v.sign(e.y):v.sign(n.y):o>i?v.sign(t.y):v.sign(n.y);const s=a<0;Lu(e,s),Lu(t,s),Lu(n,s)}(e,t,n);const r=e.y<0,o=t.y<0,i=n.y<0;let a=0;a+=r?1:0,a+=o?1:0,a+=i?1:0;const s=qu.indices;1===a?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,r?(Du(e,t,zu,Uu),Du(e,n,Bu,ju),s[0]=0,s[3]=1,s[4]=2,s[6]=1):o?(Du(t,n,zu,Uu),Du(t,e,Bu,ju),s[0]=1,s[3]=2,s[4]=0,s[6]=2):i&&(Du(n,e,zu,Uu),Du(n,t,Bu,ju),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===a&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,r?o?i||(Du(n,e,zu,Uu),Du(n,t,Bu,ju),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(Du(t,n,zu,Uu),Du(t,e,Bu,ju),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(Du(e,t,zu,Uu),Du(e,n,Bu,ju),s[0]=1,s[1]=2,s[3]=1,s[6]=0));const u=qu.positions;return u[0]=e,u[1]=t,u[2]=n,u.length=3,1!==a&&2!==a||(u[3]=zu,u[4]=Bu,u[5]=Uu,u[6]=ju,u.length=7),qu}function ku(e,t){const n=e.attributes;if(0===n.position.values.length)return;for(const o in n)if(n.hasOwnProperty(o)&&w(n[o])&&w(n[o].values)){const e=n[o];e.values=Ui.createTypedArray(e.componentDatatype,e.values)}const r=qi.computeNumberOfVertices(e);return e.indices=Pe.createTypedArray(r,e.indices),t&&(e.boundingSphere=la.fromVertices(n.position.values)),e}function Wu(e){const t=e.attributes,n={};for(const r in t)if(t.hasOwnProperty(r)&&w(t[r])&&w(t[r].values)){const e=t[r];n[r]=new Qi({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:[]})}return new qi({attributes:n,indices:[],primitiveType:e.primitiveType})}function Vu(e,t,n){const r=w(e.geometry.boundingSphere);t=ku(t,r),w(n=ku(n,r))&&!w(t)?e.geometry=n:!w(n)&&w(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function Hu(e,t){const n=new e,r=new e,o=new e;return function(i,a,s,u,c,l,f,h){const p=e.fromArray(c,i*t,n),m=e.fromArray(c,a*t,r),d=e.fromArray(c,s*t,o);e.multiplyByScalar(p,u.x,p),e.multiplyByScalar(m,u.y,m),e.multiplyByScalar(d,u.z,d);const y=e.add(p,m,p);e.add(y,d,y),h&&e.normalize(y,y),e.pack(y,l,f*t)}}const Yu=Hu(G,4),Xu=Hu(L,3),$u=Hu(Ot,2),Ku=new L,Zu=new L,Qu=new L,Ju=new L;function ec(e,t,n,r,o,i,a,s,u,c,l,f,h,p,m,d){if(!(w(i)||w(a)||w(s)||w(u)||w(c)||0!==p))return;const y=function(e,t,n,r,o){let i,a,s,u,c,l,f,h;if(O.defined("point",e),O.defined("p0",t),O.defined("p1",n),O.defined("p2",r),w(o)||(o=new L),w(t.z)){if(L.equalsEpsilon(e,t,v.EPSILON14))return L.clone(L.UNIT_X,o);if(L.equalsEpsilon(e,n,v.EPSILON14))return L.clone(L.UNIT_Y,o);if(L.equalsEpsilon(e,r,v.EPSILON14))return L.clone(L.UNIT_Z,o);i=L.subtract(n,t,ms),a=L.subtract(r,t,ds),s=L.subtract(e,t,ys),u=L.dot(i,i),c=L.dot(i,a),l=L.dot(i,s),f=L.dot(a,a),h=L.dot(a,s)}else{if(Ot.equalsEpsilon(e,t,v.EPSILON14))return L.clone(L.UNIT_X,o);if(Ot.equalsEpsilon(e,n,v.EPSILON14))return L.clone(L.UNIT_Y,o);if(Ot.equalsEpsilon(e,r,v.EPSILON14))return L.clone(L.UNIT_Z,o);i=Ot.subtract(n,t,ms),a=Ot.subtract(r,t,ds),s=Ot.subtract(e,t,ys),u=Ot.dot(i,i),c=Ot.dot(i,a),l=Ot.dot(i,s),f=Ot.dot(a,a),h=Ot.dot(a,s)}o.y=f*l-c*h,o.z=u*h-c*l;const p=u*f-c*c;if(0!==p)return o.y/=p,o.z/=p,o.x=1-o.y-o.z,o}(r,L.fromArray(o,3*e,Ku),L.fromArray(o,3*t,Zu),L.fromArray(o,3*n,Qu),Ju);if(w(y)){if(w(i)&&Xu(e,t,n,y,i,f.normal.values,d,!0),w(c)){const r=L.fromArray(c,3*e,Ku),o=L.fromArray(c,3*t,Zu),i=L.fromArray(c,3*n,Qu);let a;L.multiplyByScalar(r,y.x,r),L.multiplyByScalar(o,y.y,o),L.multiplyByScalar(i,y.z,i),L.equals(r,L.ZERO)&&L.equals(o,L.ZERO)&&L.equals(i,L.ZERO)?(a=Ku,a.x=0,a.y=0,a.z=0):(a=L.add(r,o,r),L.add(a,i,a),L.normalize(a,a)),L.pack(a,f.extrudeDirection.values,3*d)}if(w(l)&&function(e,t,n,r,o,i,a){const s=o[e]*r.x,u=o[t]*r.y,c=o[n]*r.z;i[a]=s+u+c>v.EPSILON6?1:0}(e,t,n,y,l,f.applyOffset.values,d),w(a)&&Xu(e,t,n,y,a,f.tangent.values,d,!0),w(s)&&Xu(e,t,n,y,s,f.bitangent.values,d,!0),w(u)&&$u(e,t,n,y,u,f.st.values,d),p>0)for(let r=0;r<p;r++){const o=h[r];tc(e,t,n,y,d,m[o],f[o])}}}function tc(e,t,n,r,o,i,a){const s=i.componentsPerAttribute,u=i.values,c=a.values;switch(s){case 4:Yu(e,t,n,r,u,c,o,!1);break;case 3:Xu(e,t,n,r,u,c,o,!1);break;case 2:$u(e,t,n,r,u,c,o,!1);break;default:c[o]=u[e]*r.x+u[t]*r.y+u[n]*r.z}}function nc(e,t,n,r,o,i){const a=e.position.values.length/3;if(-1!==o){const s=r[o],u=n[s];return-1===u?(n[s]=a,e.position.values.push(i.x,i.y,i.z),t.push(a),a):(t.push(u),u)}return e.position.values.push(i.x,i.y,i.z),t.push(a),a}const rc={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function oc(e){const t=e.geometry,n=t.attributes,r=n.position.values,o=w(n.normal)?n.normal.values:void 0,i=w(n.bitangent)?n.bitangent.values:void 0,a=w(n.tangent)?n.tangent.values:void 0,s=w(n.st)?n.st.values:void 0,u=w(n.extrudeDirection)?n.extrudeDirection.values:void 0,c=w(n.applyOffset)?n.applyOffset.values:void 0,l=t.indices,f=[];for(const A in n)n.hasOwnProperty(A)&&!rc[A]&&w(n[A])&&f.push(A);const h=f.length,p=Wu(t),m=Wu(t);let d,y,_,g,E;const b=[];b.length=r.length/3;const T=[];for(T.length=r.length/3,E=0;E<b.length;++E)b[E]=-1,T[E]=-1;const O=l.length;for(E=0;E<O;E+=3){const e=l[E],t=l[E+1],O=l[E+2];let A=L.fromArray(r,3*e),x=L.fromArray(r,3*t),R=L.fromArray(r,3*O);const S=Gu(A,x,R);if(w(S)&&S.positions.length>3){const w=S.positions,A=S.indices,x=A.length;for(let R=0;R<x;++R){const x=A[R],S=w[x];S.y<0?(d=m.attributes,y=m.indices,_=b):(d=p.attributes,y=p.indices,_=T),g=nc(d,y,_,l,x<3?E+x:-1,S),ec(e,t,O,S,r,o,a,i,s,u,c,d,f,h,n,g)}}else w(S)&&(A=S.positions[0],x=S.positions[1],R=S.positions[2]),A.y<0?(d=m.attributes,y=m.indices,_=b):(d=p.attributes,y=p.indices,_=T),g=nc(d,y,_,l,E,A),ec(e,t,O,A,r,o,a,i,s,u,c,d,f,h,n,g),g=nc(d,y,_,l,E+1,x),ec(e,t,O,x,r,o,a,i,s,u,c,d,f,h,n,g),g=nc(d,y,_,l,E+2,R),ec(e,t,O,R,r,o,a,i,s,u,c,d,f,h,n,g)}Vu(e,m,p)}const ic=tu.fromPointNormal(L.ZERO,L.UNIT_Y),ac=new L,sc=new L;function uc(e,t,n,r,o,i,a){if(!w(a))return;const s=L.fromArray(r,3*e,Ku);L.equalsEpsilon(s,n,v.EPSILON10)?i.applyOffset.values[o]=a[e]:i.applyOffset.values[o]=a[t]}function cc(e){const t=e.geometry,n=t.attributes,r=n.position.values,o=w(n.applyOffset)?n.applyOffset.values:void 0,i=t.indices,a=Wu(t),s=Wu(t);let u;const c=i.length,l=[];l.length=r.length/3;const f=[];for(f.length=r.length/3,u=0;u<l.length;++u)l[u]=-1,f[u]=-1;for(u=0;u<c;u+=2){const e=i[u],t=i[u+1],n=L.fromArray(r,3*e,Ku),c=L.fromArray(r,3*t,Zu);let h;Math.abs(n.y)<v.EPSILON6&&(n.y<0?n.y=-v.EPSILON6:n.y=v.EPSILON6),Math.abs(c.y)<v.EPSILON6&&(c.y<0?c.y=-v.EPSILON6:c.y=v.EPSILON6);let p=a.attributes,m=a.indices,d=f,y=s.attributes,_=s.indices,g=l;const E=Rs.lineSegmentPlane(n,c,ic,Qu);if(w(E)){const b=L.multiplyByScalar(L.UNIT_Y,5*v.EPSILON9,ac);n.y<0&&(L.negate(b,b),p=s.attributes,m=s.indices,d=l,y=a.attributes,_=a.indices,g=f);const w=L.add(E,b,sc);h=nc(p,m,d,i,u,n),uc(e,t,n,r,h,p,o),h=nc(p,m,d,i,-1,w),uc(e,t,w,r,h,p,o),L.negate(b,b),L.add(E,b,w),h=nc(y,_,g,i,-1,w),uc(e,t,w,r,h,y,o),h=nc(y,_,g,i,u+1,c),uc(e,t,c,r,h,y,o)}else{let p,m,d;n.y<0?(p=s.attributes,m=s.indices,d=l):(p=a.attributes,m=a.indices,d=f),h=nc(p,m,d,i,u,n),uc(e,t,n,r,h,p,o),h=nc(p,m,d,i,u+1,c),uc(e,t,c,r,h,p,o)}}Vu(e,s,a)}const lc=new Ot,fc=new Ot,hc=new L,pc=new L,mc=new L,dc=new L,yc=new L,_c=new L,gc=new G;function Ec(e){const t=e.attributes,n=t.position.values,r=t.prevPosition.values,o=t.nextPosition.values,i=n.length;for(let a=0;a<i;a+=3){const e=L.unpack(n,a,hc);if(e.x>0)continue;const t=L.unpack(r,a,pc);(e.y<0&&t.y>0||e.y>0&&t.y<0)&&(a-3>0?(r[a]=n[a-3],r[a+1]=n[a-2],r[a+2]=n[a-1]):L.pack(e,r,a));const s=L.unpack(o,a,mc);(e.y<0&&s.y>0||e.y>0&&s.y<0)&&(a+3<i?(o[a]=n[a+3],o[a+1]=n[a+4],o[a+2]=n[a+5]):L.pack(e,o,a))}}const bc=5*v.EPSILON9,wc=v.EPSILON6;function Tc(e,t,n,r,o,i,a,s,u,c,l){this._context=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelDatatype=a,this._internalFormat=o,this._pixelFormat=i,this._size=s,this._preMultiplyAlpha=u,this._flipY=c,this._initialized=l}uu.splitLongitude=function(e){if(!w(e))throw new T("instance is required.");const t=e.geometry,n=t.boundingSphere;if(w(n)&&(n.center.x-n.radius>0||la.intersectPlane(n,tu.ORIGIN_ZX_PLANE)!==Xt.INTERSECTING))return e;if(t.geometryType!==ji.NONE)switch(t.geometryType){case ji.POLYLINES:!function(e){const t=e.geometry,n=t.attributes,r=n.position.values,o=n.prevPosition.values,i=n.nextPosition.values,a=n.expandAndWidth.values,s=w(n.st)?n.st.values:void 0,u=w(n.color)?n.color.values:void 0,c=Wu(t),l=Wu(t);let f,h,p,m=!1;const d=r.length/3;for(f=0;f<d;f+=4){const e=f,t=f+2,n=L.fromArray(r,3*e,hc),d=L.fromArray(r,3*t,pc);if(Math.abs(n.y)<wc)for(n.y=wc*(d.y<0?-1:1),r[3*f+1]=n.y,r[3*(f+1)+1]=n.y,h=3*e;h<3*e+12;h+=3)o[h]=r[3*f],o[h+1]=r[3*f+1],o[h+2]=r[3*f+2];if(Math.abs(d.y)<wc)for(d.y=wc*(n.y<0?-1:1),r[3*(f+2)+1]=d.y,r[3*(f+3)+1]=d.y,h=3*e;h<3*e+12;h+=3)i[h]=r[3*(f+2)],i[h+1]=r[3*(f+2)+1],i[h+2]=r[3*(f+2)+2];let y=c.attributes,_=c.indices,g=l.attributes,E=l.indices;const b=Rs.lineSegmentPlane(n,d,ic,dc);if(w(b)){m=!0;const r=L.multiplyByScalar(L.UNIT_Y,bc,yc);n.y<0&&(L.negate(r,r),y=l.attributes,_=l.indices,g=c.attributes,E=c.indices);const T=L.add(b,r,_c);y.position.values.push(n.x,n.y,n.z,n.x,n.y,n.z),y.position.values.push(T.x,T.y,T.z),y.position.values.push(T.x,T.y,T.z),y.prevPosition.values.push(o[3*e],o[3*e+1],o[3*e+2]),y.prevPosition.values.push(o[3*e+3],o[3*e+4],o[3*e+5]),y.prevPosition.values.push(n.x,n.y,n.z,n.x,n.y,n.z),y.nextPosition.values.push(T.x,T.y,T.z),y.nextPosition.values.push(T.x,T.y,T.z),y.nextPosition.values.push(T.x,T.y,T.z),y.nextPosition.values.push(T.x,T.y,T.z),L.negate(r,r),L.add(b,r,T),g.position.values.push(T.x,T.y,T.z),g.position.values.push(T.x,T.y,T.z),g.position.values.push(d.x,d.y,d.z,d.x,d.y,d.z),g.prevPosition.values.push(T.x,T.y,T.z),g.prevPosition.values.push(T.x,T.y,T.z),g.prevPosition.values.push(T.x,T.y,T.z),g.prevPosition.values.push(T.x,T.y,T.z),g.nextPosition.values.push(d.x,d.y,d.z,d.x,d.y,d.z),g.nextPosition.values.push(i[3*t],i[3*t+1],i[3*t+2]),g.nextPosition.values.push(i[3*t+3],i[3*t+4],i[3*t+5]);const O=Ot.fromArray(a,2*e,lc),A=Math.abs(O.y);y.expandAndWidth.values.push(-1,A,1,A),y.expandAndWidth.values.push(-1,-A,1,-A),g.expandAndWidth.values.push(-1,A,1,A),g.expandAndWidth.values.push(-1,-A,1,-A);let x=L.magnitudeSquared(L.subtract(b,n,mc));if(x/=L.magnitudeSquared(L.subtract(d,n,mc)),w(u)){const n=G.fromArray(u,4*e,gc),r=G.fromArray(u,4*t,gc),o=v.lerp(n.x,r.x,x),i=v.lerp(n.y,r.y,x),a=v.lerp(n.z,r.z,x),s=v.lerp(n.w,r.w,x);for(h=4*e;h<4*e+8;++h)y.color.values.push(u[h]);for(y.color.values.push(o,i,a,s),y.color.values.push(o,i,a,s),g.color.values.push(o,i,a,s),g.color.values.push(o,i,a,s),h=4*t;h<4*t+8;++h)g.color.values.push(u[h])}if(w(s)){const n=Ot.fromArray(s,2*e,lc),r=Ot.fromArray(s,2*(f+3),fc),o=v.lerp(n.x,r.x,x);for(h=2*e;h<2*e+4;++h)y.st.values.push(s[h]);for(y.st.values.push(o,n.y),y.st.values.push(o,r.y),g.st.values.push(o,n.y),g.st.values.push(o,r.y),h=2*t;h<2*t+4;++h)g.st.values.push(s[h])}p=y.position.values.length/3-4,_.push(p,p+2,p+1),_.push(p+1,p+2,p+3),p=g.position.values.length/3-4,E.push(p,p+2,p+1),E.push(p+1,p+2,p+3)}else{let e,t;for(n.y<0?(e=l.attributes,t=l.indices):(e=c.attributes,t=c.indices),e.position.values.push(n.x,n.y,n.z),e.position.values.push(n.x,n.y,n.z),e.position.values.push(d.x,d.y,d.z),e.position.values.push(d.x,d.y,d.z),h=3*f;h<3*f+12;++h)e.prevPosition.values.push(o[h]),e.nextPosition.values.push(i[h]);for(h=2*f;h<2*f+8;++h)e.expandAndWidth.values.push(a[h]),w(s)&&e.st.values.push(s[h]);if(w(u))for(h=4*f;h<4*f+16;++h)e.color.values.push(u[h]);p=e.position.values.length/3-4,t.push(p,p+2,p+1),t.push(p+1,p+2,p+3)}}m&&(Ec(l),Ec(c)),Vu(e,l,c)}(e);break;case ji.TRIANGLES:oc(e);break;case ji.LINES:cc(e)}else(function(e){switch(e.primitiveType){case Ti.TRIANGLE_FAN:return function(e){const t=qi.computeNumberOfVertices(e);if(t<3)throw new T("The number of vertices must be at least three.");const n=Pe.createTypedArray(t,3*(t-2));n[0]=1,n[1]=0,n[2]=2;let r=3;for(let o=3;o<t;++o)n[r++]=o-1,n[r++]=0,n[r++]=o;return e.indices=n,e.primitiveType=Ti.TRIANGLES,e}(e);case Ti.TRIANGLE_STRIP:return function(e){const t=qi.computeNumberOfVertices(e);if(t<3)throw new T("The number of vertices must be at least 3.");const n=Pe.createTypedArray(t,3*(t-2));n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let r=6;for(let o=3;o<t-1;o+=2)n[r++]=o,n[r++]=o-1,n[r++]=o+1,o+2<t&&(n[r++]=o,n[r++]=o+1,n[r++]=o+2);return e.indices=n,e.primitiveType=Ti.TRIANGLES,e}(e);case Ti.TRIANGLES:return function(e){if(w(e.indices))return e;const t=qi.computeNumberOfVertices(e);if(t<3)throw new T("The number of vertices must be at least three.");if(t%3!=0)throw new T("The number of vertices must be a multiple of three.");const n=Pe.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}(e);case Ti.LINE_STRIP:return function(e){const t=qi.computeNumberOfVertices(e);if(t<2)throw new T("The number of vertices must be at least two.");const n=Pe.createTypedArray(t,2*(t-1));n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return e.indices=n,e.primitiveType=Ti.LINES,e}(e);case Ti.LINE_LOOP:return function(e){const t=qi.computeNumberOfVertices(e);if(t<2)throw new T("The number of vertices must be at least two.");const n=Pe.createTypedArray(t,2*t);n[0]=0,n[1]=1;let r=2;for(let o=2;o<t;++o)n[r++]=o-1,n[r++]=o;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=Ti.LINES,e}(e);case Ti.LINES:return function(e){if(w(e.indices))return e;const t=qi.computeNumberOfVertices(e);if(t<2)throw new T("The number of vertices must be at least two.");if(t%2!=0)throw new T("The number of vertices must be a multiple of 2.");const n=Pe.createTypedArray(t,t);for(let r=0;r<t;++r)n[r]=r;return e.indices=n,e}(e)}})(t),t.primitiveType===Ti.TRIANGLES?oc(e):t.primitiveType===Ti.LINES&&cc(e);return e},Object.defineProperties(Tc.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),Tc.prototype.copyFrom=function(e){O.defined("options",e);const{xOffset:t=0,yOffset:n=0,source:r,skipColorSpaceConversion:o=!1}=e;if(O.defined("options.source",r),O.typeOf.number.greaterThanOrEquals("xOffset",t,0),O.typeOf.number.greaterThanOrEquals("yOffset",n,0),t+r.width>this._size)throw new T("xOffset + options.source.width must be less than or equal to width.");if(n+r.height>this._size)throw new T("yOffset + options.source.height must be less than or equal to height.");const{width:i,height:a}=r,s=this._context._gl,u=this._textureTarget,c=this._targetFace;s.activeTexture(s.TEXTURE0),s.bindTexture(u,this._texture);let l=r.arrayBufferView;const f=this._size,h=this._pixelFormat,p=this._internalFormat,m=this._pixelDatatype,d=this._preMultiplyAlpha,y=this._flipY;let _=4;w(l)&&(_=Ri.alignmentInBytes(h,m,i)),s.pixelStorei(s.UNPACK_ALIGNMENT,_),o?s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE):s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.BROWSER_DEFAULT_WEBGL);let g=!1;if(!this._initialized){let e;0===t&&0===n&&i===f&&a===f?(w(l)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),y&&(l=Ri.flipY(l,h,m,f,f)),e=l):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,y),e=r),g=!0):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),e=Ri.createTypedArray(h,m,f,f)),s.texImage2D(c,0,p,f,f,0,h,Ai.toWebGLConstant(m,this._context),e),this._initialized=!0}g||(w(l)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),y&&(l=Ri.flipY(l,h,m,i,a)),s.texSubImage2D(c,0,t,n,i,a,h,Ai.toWebGLConstant(m,this._context),l)):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,y),s.texSubImage2D(c,0,t,n,h,Ai.toWebGLConstant(m,this._context),r))),s.bindTexture(u,null)},Tc.prototype.copyFromFramebuffer=function(e,t,n,r,o,i){if(e=e??0,t=t??0,n=n??0,r=r??0,o=o??this._size,i=i??this._size,O.typeOf.number.greaterThanOrEquals("xOffset",e,0),O.typeOf.number.greaterThanOrEquals("yOffset",t,0),O.typeOf.number.greaterThanOrEquals("framebufferXOffset",n,0),O.typeOf.number.greaterThanOrEquals("framebufferYOffset",r,0),e+o>this._size)throw new T("xOffset + source.width must be less than or equal to width.");if(t+i>this._size)throw new T("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===Ai.FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===Ai.HALF_FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");const a=this._context._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(this._targetFace,0,e,t,n,r,o,i),a.bindTexture(s,null),this._initialized=!0},Tc.prototype.copyMipmapFromFramebuffer=function(e,t,n,r,o){if(e=e??0,t=t??0,n=n??this._size,r=r??this._size,o=o??0,O.typeOf.number.greaterThanOrEquals("xOffset",e,0),O.typeOf.number.greaterThanOrEquals("yOffset",t,0),e+n>this._size)throw new T("xOffset + source.width must be less than or equal to width.");if(t+r>this._size)throw new T("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===Ai.FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===Ai.HALF_FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");const i=this._context._gl,a=this._textureTarget;i.activeTexture(i.TEXTURE0),i.bindTexture(a,this._texture),i.copyTexImage2D(this._targetFace,o,this._internalFormat,e,t,n,r,0),i.bindTexture(a,null),this._initialized=!0};const Oc={DONT_CARE:Se.DONT_CARE,FASTEST:Se.FASTEST,NICEST:Se.NICEST,validate:function(e){return e===Oc.DONT_CARE||e===Oc.FASTEST||e===Oc.NICEST}};var Ac=Object.freeze(Oc);const xc={NEAREST:Se.NEAREST,LINEAR:Se.LINEAR,validate:function(e){return e===xc.NEAREST||e===xc.LINEAR}};var Rc=Object.freeze(xc);const Sc={NEAREST:Se.NEAREST,LINEAR:Se.LINEAR,NEAREST_MIPMAP_NEAREST:Se.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:Se.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:Se.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:Se.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===Sc.NEAREST||e===Sc.LINEAR||e===Sc.NEAREST_MIPMAP_NEAREST||e===Sc.LINEAR_MIPMAP_NEAREST||e===Sc.NEAREST_MIPMAP_LINEAR||e===Sc.LINEAR_MIPMAP_LINEAR}};var Ic=Object.freeze(Sc);const Cc={CLAMP_TO_EDGE:Se.CLAMP_TO_EDGE,REPEAT:Se.REPEAT,MIRRORED_REPEAT:Se.MIRRORED_REPEAT,validate:function(e){return e===Cc.CLAMP_TO_EDGE||e===Cc.REPEAT||e===Cc.MIRRORED_REPEAT}};var Nc=Object.freeze(Cc);function vc(e){e=e??K.EMPTY_OBJECT;const{wrapR:t=Nc.CLAMP_TO_EDGE,wrapS:n=Nc.CLAMP_TO_EDGE,wrapT:r=Nc.CLAMP_TO_EDGE,minificationFilter:o=Ic.LINEAR,magnificationFilter:i=Rc.LINEAR,maximumAnisotropy:a=1}=e;if(!Nc.validate(t))throw new T("Invalid sampler.wrapR.");if(!Nc.validate(n))throw new T("Invalid sampler.wrapS.");if(!Nc.validate(r))throw new T("Invalid sampler.wrapT.");if(!Ic.validate(o))throw new T("Invalid sampler.minificationFilter.");if(!Rc.validate(i))throw new T("Invalid sampler.magnificationFilter.");O.typeOf.number.greaterThanOrEquals("maximumAnisotropy",a,1),this._wrapR=t,this._wrapS=n,this._wrapT=r,this._minificationFilter=o,this._magnificationFilter=i,this._maximumAnisotropy=a}function Pc(e,t,n,r){const o=w(t.vertexBuffer),i=w(t.value),a=t.value?t.value.length:t.componentsPerAttribute;if(!o&&!i)throw new T("attribute must have a vertexBuffer or a value.");if(o&&i)throw new T("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.");if(1!==a&&2!==a&&3!==a&&4!==a){if(i)throw new T("attribute.value.length must be in the range [1, 4].");throw new T("attribute.componentsPerAttribute must be in the range [1, 4].")}if(w(t.componentDatatype)&&!Ui.validate(t.componentDatatype))throw new T("attribute must have a valid componentDatatype or not specify it.");if(w(t.strideInBytes)&&t.strideInBytes>255)throw new T("attribute must have a strideInBytes less than or equal to 255 or not specify it.");if(w(t.instanceDivisor)&&t.instanceDivisor>0&&!r.instancedArrays)throw new T("instanced arrays is not supported");if(w(t.instanceDivisor)&&t.instanceDivisor<0)throw new T("attribute must have an instanceDivisor greater than or equal to zero");if(w(t.instanceDivisor)&&i)throw new T("attribute cannot have have an instanceDivisor if it is not backed by a buffer");if(w(t.instanceDivisor)&&t.instanceDivisor>0&&0===t.index)throw new T("attribute zero cannot have an instanceDivisor greater than 0");const s={index:t.index??n,enabled:t.enabled??!0,vertexBuffer:t.vertexBuffer,value:i?t.value.slice(0):void 0,componentsPerAttribute:a,componentDatatype:t.componentDatatype??Ui.FLOAT,normalize:t.normalize??!1,offsetInBytes:t.offsetInBytes??0,strideInBytes:t.strideInBytes??0,instanceDivisor:t.instanceDivisor??0};if(o)s.vertexAttrib=function(e){const t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(r.glVertexAttribDivisor(t,this.instanceDivisor),r._vertexAttribDivisors[t]=this.instanceDivisor,r._previousDrawInstanced=!0)},s.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&r.glVertexAttribDivisor(n,0)};else{switch(s.componentsPerAttribute){case 1:s.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:s.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:s.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:s.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}s.disableVertexAttribArray=function(e){}}e.push(s)}function Mc(e,t,n){for(let r=0;r<t.length;++r){const n=t[r];n.enabled&&n.vertexAttrib(e)}w(n)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n._getBuffer())}function Lc(e){e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context),O.defined("options.attributes",e.attributes);const t=e.context,n=t._gl,r=e.attributes,o=e.indexBuffer;let i;const a=[];let s=1,u=!1,c=!1,l=r.length;for(i=0;i<l;++i)Pc(a,r[i],i,t);for(l=a.length,i=0;i<l;++i){const e=a[i];if(w(e.vertexBuffer)&&0===e.instanceDivisor){const t=e.strideInBytes||e.componentsPerAttribute*Ui.getSizeInBytes(e.componentDatatype);s=e.vertexBuffer.sizeInBytes/t;break}}for(i=0;i<l;++i)a[i].instanceDivisor>0&&(u=!0),w(a[i].value)&&(c=!0);const f={};for(i=0;i<l;++i){const e=a[i].index;if(f[e])throw new T(`Index ${e} is used by more than one attribute.`);f[e]=!0}let h;t.vertexArrayObject&&(h=t.glCreateVertexArray(),t.glBindVertexArray(h),Mc(n,a,o),t.glBindVertexArray(null)),this._numberOfVertices=s,this._hasInstancedAttributes=u,this._hasConstantAttributes=c,this._context=t,this._gl=n,this._vao=h,this._attributes=a,this._indexBuffer=o}function Fc(e){return e.values.length/e.componentsPerAttribute}function Dc(e){return Ui.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function zc(e){e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context);const{context:t,source:n,pixelFormat:r=Ri.RGBA,pixelDatatype:o=Ai.UNSIGNED_BYTE,flipY:i=!0,skipColorSpaceConversion:a=!1,sampler:s=new vc}=e,u=e.preMultiplyAlpha||r===Ri.RGB||r===Ri.LUMINANCE;let{width:c,height:l}=e;if(w(n)){if(!Object.values(zc.FaceName).every(e=>w(n[e])))throw new T(`options.source requires faces ${Object.values(zc.FaceName).join(", ")}.`);({width:c,height:l}=n.positiveX);for(const e of zc.faceNames()){const t=n[e];if(Number(t.width)!==c||Number(t.height)!==l)throw new T("Each face in options.source must have the same width and height.")}}const f=c;if(!w(c)||!w(l))throw new T("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.");if(c!==l)throw new T("Width must equal height.");if(f<=0)throw new T("Width and height must be greater than zero.");if(f>Si.maximumCubeMapSize)throw new T(`Width and height must be less than or equal to the maximum cube map size (${Si.maximumCubeMapSize}). Check maximumCubeMapSize.`);if(!Ri.validate(r))throw new T("Invalid options.pixelFormat.");if(Ri.isDepthFormat(r))throw new T("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.");if(!Ai.validate(o))throw new T("Invalid options.pixelDatatype.");if(o===Ai.FLOAT&&!t.floatingPointTexture)throw new T("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.");if(o===Ai.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new T("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension.");const h=6*Ri.textureSizeInBytes(r,o,f,f),p=Ri.toInternalFormat(r,o,t),m=t._gl,d=m.TEXTURE_CUBE_MAP,y=m.createTexture();this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=d,this._texture=y,this._pixelFormat=r,this._pixelDatatype=o,this._size=f,this._hasMipmap=!1,this._sizeInBytes=h,this._preMultiplyAlpha=u,this._flipY=i;const _=w(n);function g(e){return new Tc(t,y,d,e,p,r,o,f,u,i,_)}this._positiveX=g(m.TEXTURE_CUBE_MAP_POSITIVE_X),this._negativeX=g(m.TEXTURE_CUBE_MAP_NEGATIVE_X),this._positiveY=g(m.TEXTURE_CUBE_MAP_POSITIVE_Y),this._negativeY=g(m.TEXTURE_CUBE_MAP_NEGATIVE_Y),this._positiveZ=g(m.TEXTURE_CUBE_MAP_POSITIVE_Z),this._negativeZ=g(m.TEXTURE_CUBE_MAP_NEGATIVE_Z),this._sampler=s,Uc(this,s),m.activeTexture(m.TEXTURE0),m.bindTexture(d,y),a?m.pixelStorei(m.UNPACK_COLORSPACE_CONVERSION_WEBGL,m.NONE):m.pixelStorei(m.UNPACK_COLORSPACE_CONVERSION_WEBGL,m.BROWSER_DEFAULT_WEBGL);for(const E of zc.faceNames())Bc(this[E],n?.[E],0);m.bindTexture(d,null)}function Bc(e,t,n){n=n??0;const r=e._targetFace,o=Math.max(Math.floor(e._size/2**n),1),i=e._pixelFormat,a=e._pixelDatatype,s=e._internalFormat,u=e._flipY,c=e._preMultiplyAlpha,l=e._context,f=l._gl;if(!w(t))return void f.texImage2D(r,n,s,o,o,0,i,Ai.toWebGLConstant(a,l),null);let{arrayBufferView:h}=t,p=4;w(h)&&(p=Ri.alignmentInBytes(i,a,o)),f.pixelStorei(f.UNPACK_ALIGNMENT,p),w(h)?(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1),u&&(h=Ri.flipY(h,i,a,o,o)),f.texImage2D(r,n,s,o,o,0,i,Ai.toWebGLConstant(a,l),h)):(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,u),f.texImage2D(r,n,s,i,Ai.toWebGLConstant(a,l),t))}function Uc(e,t){let{minificationFilter:n,magnificationFilter:r}=t;const o=[Ic.NEAREST_MIPMAP_NEAREST,Ic.NEAREST_MIPMAP_LINEAR,Ic.LINEAR_MIPMAP_NEAREST,Ic.LINEAR_MIPMAP_LINEAR].includes(n),i=e._context,a=e._pixelDatatype;(a===Ai.FLOAT&&!i.textureFloatLinear||a===Ai.HALF_FLOAT&&!i.textureHalfFloatLinear)&&(n=o?Ic.NEAREST_MIPMAP_NEAREST:Ic.NEAREST,r=Rc.NEAREST);const s=i._gl,u=e._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(u,e._texture),s.texParameteri(u,s.TEXTURE_MIN_FILTER,n),s.texParameteri(u,s.TEXTURE_MAG_FILTER,r),s.texParameteri(u,s.TEXTURE_WRAP_S,t.wrapS),s.texParameteri(u,s.TEXTURE_WRAP_T,t.wrapT),w(e._textureFilterAnisotropic)&&s.texParameteri(u,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),s.bindTexture(u,null)}function jc(e){e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context);const{context:t,source:n,pixelFormat:r=Ri.RGBA,pixelDatatype:o=Ai.UNSIGNED_BYTE,flipY:i=!0,skipColorSpaceConversion:a=!1,sampler:s=new vc}=e;let{width:u,height:c}=e;w(n)&&(w(u)||(u=n.videoWidth??n.naturalWidth??n.width),w(c)||(c=n.videoHeight??n.naturalHeight??n.height));const l=e.preMultiplyAlpha||r===Ri.RGB||r===Ri.LUMINANCE,f=Ri.toInternalFormat(r,o,t),h=Ri.isCompressedFormat(f);if(!w(u)||!w(c))throw new T("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(O.typeOf.number.greaterThan("width",u,0),u>Si.maximumTextureSize)throw new T(`Width must be less than or equal to the maximum texture size (${Si.maximumTextureSize}).  Check maximumTextureSize.`);if(O.typeOf.number.greaterThan("height",c,0),c>Si.maximumTextureSize)throw new T(`Height must be less than or equal to the maximum texture size (${Si.maximumTextureSize}).  Check maximumTextureSize.`);if(!Ri.validate(r))throw new T("Invalid options.pixelFormat.");if(!h&&!Ai.validate(o))throw new T("Invalid options.pixelDatatype.");if(r===Ri.DEPTH_COMPONENT&&o!==Ai.UNSIGNED_SHORT&&o!==Ai.UNSIGNED_INT)throw new T("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(r===Ri.DEPTH_STENCIL&&o!==Ai.UNSIGNED_INT_24_8)throw new T("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(o===Ai.FLOAT&&!t.floatingPointTexture)throw new T("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(o===Ai.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new T("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(Ri.isDepthFormat(r)){if(w(n))throw new T("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!t.depthTexture)throw new T("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(h){if(!w(n)||!w(n.arrayBufferView))throw new T("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(Ri.isDXTFormat(f)&&!t.s3tc)throw new T("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_compressed_texture_s3tc extension. Check context.s3tc.");if(Ri.isPVRTCFormat(f)&&!t.pvrtc)throw new T("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_compressed_texture_pvrtc extension. Check context.pvrtc.");if(Ri.isASTCFormat(f)&&!t.astc)throw new T("When options.pixelFormat is ASTC compressed, this WebGL implementation must support the WEBGL_compressed_texture_astc extension. Check context.astc.");if(Ri.isETC2Format(f)&&!t.etc)throw new T("When options.pixelFormat is ETC2 compressed, this WebGL implementation must support the WEBGL_compressed_texture_etc extension. Check context.etc.");if(Ri.isETC1Format(f)&&!t.etc1)throw new T("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_compressed_texture_etc1 extension. Check context.etc1.");if(Ri.isBC7Format(f)&&!t.bc7)throw new T("When options.pixelFormat is BC7 compressed, this WebGL implementation must support the EXT_texture_compression_bptc extension. Check context.bc7.");if(Ri.compressedTextureSizeInBytes(f,u,c)!==n.arrayBufferView.byteLength)throw new T("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}const p=t._gl,m=h?Ri.compressedTextureSizeInBytes(r,u,c):Ri.textureSizeInBytes(r,o,u,c);this._id=e.id??Ie(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=p.TEXTURE_2D,this._texture=p.createTexture(),this._internalFormat=f,this._pixelFormat=r,this._pixelDatatype=o,this._width=u,this._height=c,this._dimensions=new Ot(u,c),this._hasMipmap=!1,this._sizeInBytes=m,this._preMultiplyAlpha=l,this._flipY=i,this._initialized=!1,this._sampler=void 0,this._sampler=s,Vc(this,s),p.activeTexture(p.TEXTURE0),p.bindTexture(this._textureTarget,this._texture),w(n)?(a?p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.NONE):p.pixelStorei(p.UNPACK_COLORSPACE_CONVERSION_WEBGL,p.BROWSER_DEFAULT_WEBGL),w(n.arrayBufferView)?Ri.isCompressedFormat(f)?function(e,t){const n=e._context._gl,r=e._textureTarget,o=e._internalFormat,{width:i,height:a}=e;if(n.pixelStorei(n.UNPACK_ALIGNMENT,4),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.compressedTexImage2D(r,0,o,i,a,0,t.arrayBufferView),w(t.mipLevels)){let e=i,s=a;for(let i=0;i<t.mipLevels.length;++i)e=kc(e),s=kc(s),n.compressedTexImage2D(r,i+1,o,e,s,0,t.mipLevels[i])}}(this,n):qc(this,n):w(n.framebuffer)?function(e,t){const n=e._context,r=n._gl;r.pixelStorei(r.UNPACK_ALIGNMENT,4),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),t.framebuffer!==n.defaultFramebuffer&&t.framebuffer._bind(),r.copyTexImage2D(e._textureTarget,0,e._internalFormat,t.xOffset,t.yOffset,e.width,e.height,0),t.framebuffer!==n.defaultFramebuffer&&t.framebuffer._unBind()}(this,n):Gc(this,n),this._initialized=!0):Wc(this),p.bindTexture(this._textureTarget,null)}function qc(e,t){const n=e._context,r=n._gl,o=e._textureTarget,i=e._internalFormat,{width:a,height:s,pixelFormat:u,pixelDatatype:c,flipY:l}=e,f=Ri.alignmentInBytes(u,c,a);r.pixelStorei(r.UNPACK_ALIGNMENT,f),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let{arrayBufferView:h}=t;if(l&&(h=Ri.flipY(h,u,c,a,s)),r.texImage2D(o,0,i,a,s,0,u,Ai.toWebGLConstant(c,n),h),w(t.mipLevels)){let e=a,l=s;for(let a=0;a<t.mipLevels.length;++a)e=kc(e),l=kc(l),r.texImage2D(o,a+1,i,e,l,0,u,Ai.toWebGLConstant(c,n),t.mipLevels[a])}}function Gc(e,t){const n=e._context,r=n._gl;r.pixelStorei(r.UNPACK_ALIGNMENT,4),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.preMultiplyAlpha),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e.flipY),r.texImage2D(e._textureTarget,0,e._internalFormat,e.pixelFormat,Ai.toWebGLConstant(e.pixelDatatype,n),t)}function kc(e){const t=0|Math.floor(e/2);return Math.max(t,1)}function Wc(e){const t=e._context;t._gl.texImage2D(e._textureTarget,0,e._internalFormat,e._width,e._height,0,e._pixelFormat,Ai.toWebGLConstant(e._pixelDatatype,t),null)}function Vc(e,t){let{minificationFilter:n,magnificationFilter:r}=t;const o=[Ic.NEAREST_MIPMAP_NEAREST,Ic.NEAREST_MIPMAP_LINEAR,Ic.LINEAR_MIPMAP_NEAREST,Ic.LINEAR_MIPMAP_LINEAR].includes(n),i=e._context,a=e._pixelFormat,s=e._pixelDatatype;(s===Ai.FLOAT&&!i.textureFloatLinear||s===Ai.HALF_FLOAT&&!i.textureHalfFloatLinear)&&(n=o?Ic.NEAREST_MIPMAP_NEAREST:Ic.NEAREST,r=Rc.NEAREST),i.webgl2&&Ri.isDepthFormat(a)&&(n=Ic.NEAREST,r=Rc.NEAREST);const u=i._gl,c=e._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(c,e._texture),u.texParameteri(c,u.TEXTURE_MIN_FILTER,n),u.texParameteri(c,u.TEXTURE_MAG_FILTER,r),u.texParameteri(c,u.TEXTURE_WRAP_S,t.wrapS),u.texParameteri(c,u.TEXTURE_WRAP_T,t.wrapT),w(e._textureFilterAnisotropic)&&u.texParameteri(c,e._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),u.bindTexture(c,null)}function Hc(e,t){e=e??0,this._near=e,t=t??Number.MAX_VALUE,this._far=t}Object.defineProperties(vc.prototype,{wrapR:{get:function(){return this._wrapR}},wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),vc.equals=function(e,t){return e===t||w(e)&&w(t)&&e._wrapR===t._wrapR&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},vc.NEAREST=Object.freeze(new vc({wrapR:Nc.CLAMP_TO_EDGE,wrapS:Nc.CLAMP_TO_EDGE,wrapT:Nc.CLAMP_TO_EDGE,minificationFilter:Ic.NEAREST,magnificationFilter:Rc.NEAREST})),Lc.fromGeometry=function(e){e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context);const t=e.context,n=e.geometry??K.EMPTY_OBJECT,r=e.bufferUsage??Le.DYNAMIC_DRAW,o=e.attributeLocations??K.EMPTY_OBJECT,i=e.interleave??!1,a=e.vertexArrayAttributes;let s,u,c;const l=w(a)?a:[],f=n.attributes;if(i){const e=function(e){let t,n,r;const o=[];for(n in e)e.hasOwnProperty(n)&&w(e[n])&&w(e[n].values)&&(o.push(n),e[n].componentDatatype===Ui.DOUBLE&&(e[n].componentDatatype=Ui.FLOAT,e[n].values=Ui.createTypedArray(Ui.FLOAT,e[n].values)));let i;const a=o.length;if(a>0)for(i=Fc(e[o[0]]),t=1;t<a;++t){const n=Fc(e[o[t]]);if(n!==i)throw new fe(`Each attribute list must have the same number of vertices.  Attribute ${o[t]} has a different number of vertices (${n.toString()}) than attribute ${o[0]} (${i.toString()}).`)}o.sort(function(t,n){return Ui.getSizeInBytes(e[n].componentDatatype)-Ui.getSizeInBytes(e[t].componentDatatype)});let s=0;const u={};for(t=0;t<a;++t)n=o[t],r=e[n],u[n]=s,s+=Dc(r);if(s>0){const c=Ui.getSizeInBytes(e[o[0]].componentDatatype),l=s%c;0!==l&&(s+=c-l);const f=new ArrayBuffer(i*s),h={};for(t=0;t<a;++t){n=o[t];const r=Ui.getSizeInBytes(e[n].componentDatatype);h[n]={pointer:Ui.createTypedArray(e[n].componentDatatype,f),index:u[n]/r,strideInComponentType:s/r}}for(t=0;t<i;++t)for(let i=0;i<a;++i){n=o[i],r=e[n];const a=r.values,s=h[n],u=s.pointer,c=r.componentsPerAttribute;for(let e=0;e<c;++e)u[s.index+e]=a[t*c+e];s.index+=s.strideInComponentType}return{buffer:f,offsetsInBytes:u,vertexSizeInBytes:s}}}(f);if(w(e)){c=Fe.createVertexBuffer({context:t,typedArray:e.buffer,usage:r});const n=e.offsetsInBytes,i=e.vertexSizeInBytes;for(s in f)f.hasOwnProperty(s)&&w(f[s])&&(u=f[s],w(u.values)?l.push({index:o[s],vertexBuffer:c,componentDatatype:u.componentDatatype,componentsPerAttribute:u.componentsPerAttribute,normalize:u.normalize,offsetInBytes:n[s],strideInBytes:i}):l.push({index:o[s],value:u.value,componentDatatype:u.componentDatatype,normalize:u.normalize}))}}else for(s in f)if(f.hasOwnProperty(s)&&w(f[s])){u=f[s];let e=u.componentDatatype;e===Ui.DOUBLE&&(e=Ui.FLOAT);let n={};c=void 0,w(u.values)&&(c=Fe.createVertexBuffer({context:t,typedArray:Ui.createTypedArray(e,u.values),usage:r}),n={index:o[s],vertexBuffer:c,value:u.value,componentDatatype:e,componentsPerAttribute:u.componentsPerAttribute,normalize:u.normalize}),w(u.typedArray)&&(c=Fe.createVertexBuffer({context:t,typedArray:u.typedArray,usage:r}),n={index:o[s],vertexBuffer:c,value:void 0,componentDatatype:e,componentsPerAttribute:as.getNumberOfComponents(u.type),normalize:u.normalized,instanceDivisor:u.instanceDivisor}),l.push(n)}let h;const p=n.indices;return w(p)&&(h=qi.computeNumberOfVertices(n)>=v.SIXTY_FOUR_KILOBYTES&&t.elementIndexUint?Fe.createIndexBuffer({context:t,typedArray:new Uint32Array(p),usage:r,indexDatatype:Pe.UNSIGNED_INT}):Fe.createIndexBuffer({context:t,typedArray:new Uint16Array(p),usage:r,indexDatatype:Pe.UNSIGNED_SHORT})),new Lc({context:t,attributes:l,indexBuffer:h})},Object.defineProperties(Lc.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),Lc.prototype.getAttribute=function(e){return O.defined("index",e),this._attributes[e]},Lc.prototype._bind=function(){w(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&function(e){const t=e._context,n=e._hasInstancedAttributes;if(!n&&!t._previousDrawInstanced)return;t._previousDrawInstanced=n;const r=t._vertexAttribDivisors,o=e._attributes,i=Si.maximumVertexAttributes;let a;if(n){const e=o.length;for(a=0;a<e;++a){const e=o[a];if(e.enabled){const n=e.instanceDivisor,o=e.index;n!==r[o]&&(t.glVertexAttribDivisor(o,n),r[o]=n)}}}else for(a=0;a<i;++a)r[a]>0&&(t.glVertexAttribDivisor(a,0),r[a]=0)}(this),this._hasConstantAttributes&&function(e,t){const n=e._attributes,r=n.length;for(let o=0;o<r;++o){const e=n[o];e.enabled&&w(e.value)&&e.vertexAttrib(t)}}(this,this._gl)):Mc(this._gl,this._attributes,this._indexBuffer)},Lc.prototype._unBind=function(){if(w(this._vao))this._context.glBindVertexArray(null);else{const e=this._attributes,t=this._gl;for(let n=0;n<e.length;++n){const r=e[n];r.enabled&&r.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},Lc.prototype.isDestroyed=function(){return!1},Lc.prototype.destroy=function(){const e=this._attributes;for(let n=0;n<e.length;++n){const t=e[n].vertexBuffer;w(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy()}const t=this._indexBuffer;return w(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),w(this._vao)&&this._context.glDeleteVertexArray(this._vao),Ne(this)},zc.prototype.copyFace=function(e,t,n,r){const o=new Ni({context:e.context,colorTextures:[t],destroyAttachments:!1});o._bind(),this[n].copyMipmapFromFramebuffer(0,0,t.width,t.height,r??0),o._unBind(),o.destroy()},zc.FaceName=Object.freeze({POSITIVEX:"positiveX",NEGATIVEX:"negativeX",POSITIVEY:"positiveY",NEGATIVEY:"negativeY",POSITIVEZ:"positiveZ",NEGATIVEZ:"negativeZ"}),zc.faceNames=function(){return function*(){yield zc.FaceName.POSITIVEX,yield zc.FaceName.NEGATIVEX,yield zc.FaceName.POSITIVEY,yield zc.FaceName.NEGATIVEY,yield zc.FaceName.POSITIVEZ,yield zc.FaceName.NEGATIVEZ}()},zc.loadFace=Bc,Object.defineProperties(zc.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){Uc(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),zc.getDirection=function(e,t){switch(e){case zc.FaceName.POSITIVEX:return L.clone(L.UNIT_X,t);case zc.FaceName.NEGATIVEX:return L.negate(L.UNIT_X,t);case zc.FaceName.POSITIVEY:return L.clone(L.UNIT_Y,t);case zc.FaceName.NEGATIVEY:return L.negate(L.UNIT_Y,t);case zc.FaceName.POSITIVEZ:return L.clone(L.UNIT_Z,t);case zc.FaceName.NEGATIVEZ:return L.negate(L.UNIT_Z,t)}},zc.prototype.loadMipmaps=function(e,t){if(O.defined("source",e),!Array.isArray(e))throw new T("source must be an array");const n=Math.log2(this._size);if(e.length!==n)throw new T("all mip levels must be defined");t=t??!1;const r=this._context._gl,o=this._texture,i=this._textureTarget;r.activeTexture(r.TEXTURE0),r.bindTexture(i,o),t?r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE):r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.BROWSER_DEFAULT_WEBGL);for(let a=0;a<e.length;a++){const t=e[a],n=a+1;for(const e of zc.faceNames())Bc(this[e],t[e],n)}r.bindTexture(i,null),this._hasMipmap=!0},zc.prototype.generateMipmap=function(e){if(e=e??Ac.DONT_CARE,this._size>1&&!v.isPowerOfTwo(this._size))throw new T("width and height must be a power of two to call generateMipmap().");if(!Ac.validate(e))throw new T("hint is invalid.");this._hasMipmap=!0;const t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)},zc.createVertexArray=function(e){const t=Ja.createGeometry(Ja.fromDimensions({dimensions:new L(2,2,2),vertexFormat:Za.POSITION_ONLY})),n=this._attributeLocations=uu.createAttributeLocations(t);return Lc.fromGeometry({context:e,geometry:t,attributeLocations:n,bufferUsage:Le.STATIC_DRAW})},zc.prototype.isDestroyed=function(){return!1},zc.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=Ne(this._positiveX),this._negativeX=Ne(this._negativeX),this._positiveY=Ne(this._positiveY),this._negativeY=Ne(this._negativeY),this._positiveZ=Ne(this._positiveZ),this._negativeZ=Ne(this._negativeZ),Ne(this)},jc.create=function(e){return new jc(e)},jc.fromFramebuffer=function(e){e=e??K.EMPTY_OBJECT,O.defined("options.context",e.context);const t=e.context,{pixelFormat:n=Ri.RGB,framebufferXOffset:r=0,framebufferYOffset:o=0,width:i=t.drawingBufferWidth,height:a=t.drawingBufferHeight,framebuffer:s}=e;if(!Ri.validate(n))throw new T("Invalid pixelFormat.");if(Ri.isDepthFormat(n)||Ri.isCompressedFormat(n))throw new T("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(O.defined("options.context",t),O.typeOf.number.greaterThanOrEquals("framebufferXOffset",r,0),O.typeOf.number.greaterThanOrEquals("framebufferYOffset",o,0),r+i>t.drawingBufferWidth)throw new T("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(o+a>t.drawingBufferHeight)throw new T("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new jc({context:t,width:i,height:a,pixelFormat:n,source:{framebuffer:w(s)?s:t.defaultFramebuffer,xOffset:r,yOffset:o,width:i,height:a}})},Object.defineProperties(jc.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){Vc(this,e),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),jc.prototype.copyFrom=function(e){O.defined("options",e);const{xOffset:t=0,yOffset:n=0,source:r,skipColorSpaceConversion:o=!1}=e;if(O.defined("options.source",r),Ri.isDepthFormat(this._pixelFormat))throw new T("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(Ri.isCompressedFormat(this._pixelFormat))throw new T("Cannot call copyFrom with a compressed texture pixel format.");O.typeOf.number.greaterThanOrEquals("xOffset",t,0),O.typeOf.number.greaterThanOrEquals("yOffset",n,0),O.typeOf.number.lessThanOrEquals("xOffset + options.source.width",t+r.width,this._width),O.typeOf.number.lessThanOrEquals("yOffset + options.source.height",n+r.height,this._height);const i=this._context._gl,a=this._textureTarget;i.activeTexture(i.TEXTURE0),i.bindTexture(a,this._texture);let{width:s,height:u}=r;w(r.videoWidth)&&w(r.videoHeight)?(s=r.videoWidth,u=r.videoHeight):w(r.naturalWidth)&&w(r.naturalHeight)&&(s=r.naturalWidth,u=r.naturalHeight),o?i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE):i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.BROWSER_DEFAULT_WEBGL);let c=!1;this._initialized||(0===t&&0===n&&s===this._width&&u===this._height?(w(r.arrayBufferView)?qc(this,r):Gc(this,r),c=!0):(i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),Wc(this)),this._initialized=!0),c||(w(r.arrayBufferView)?function(e,t,n,r,o,i){const a=e._context,s=a._gl,{pixelFormat:u,pixelDatatype:c}=e,l=Ri.alignmentInBytes(u,c,o);s.pixelStorei(s.UNPACK_ALIGNMENT,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),e.flipY&&(t=Ri.flipY(t,u,c,o,i)),s.texSubImage2D(e._textureTarget,0,n,r,o,i,u,Ai.toWebGLConstant(c,a),t)}(this,r.arrayBufferView,t,n,s,u):function(e,t,n,r){const o=e._context,i=o._gl;i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e.flipY),i.texSubImage2D(e._textureTarget,0,n,r,e.pixelFormat,Ai.toWebGLConstant(e.pixelDatatype,o),t)}(this,r,t,n)),i.bindTexture(a,null)},jc.prototype.copyFromFramebuffer=function(e,t,n,r,o,i){if(e=e??0,t=t??0,n=n??0,r=r??0,o=o??this._width,i=i??this._height,Ri.isDepthFormat(this._pixelFormat))throw new T("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===Ai.FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===Ai.HALF_FLOAT)throw new T("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(Ri.isCompressedFormat(this._pixelFormat))throw new T("Cannot call copyFrom with a compressed texture pixel format.");O.typeOf.number.greaterThanOrEquals("xOffset",e,0),O.typeOf.number.greaterThanOrEquals("yOffset",t,0),O.typeOf.number.greaterThanOrEquals("framebufferXOffset",n,0),O.typeOf.number.greaterThanOrEquals("framebufferYOffset",r,0),O.typeOf.number.lessThanOrEquals("xOffset + width",e+o,this._width),O.typeOf.number.lessThanOrEquals("yOffset + height",t+i,this._height);const a=this._context._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(s,0,e,t,n,r,o,i),a.bindTexture(s,null),this._initialized=!0},jc.prototype.generateMipmap=function(e){if(e=e??Ac.DONT_CARE,Ri.isDepthFormat(this._pixelFormat))throw new T("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(Ri.isCompressedFormat(this._pixelFormat))throw new T("Cannot call generateMipmap with a compressed pixel format.");if(!this._context.webgl2){if(this._width>1&&!v.isPowerOfTwo(this._width))throw new T("width must be a power of two to call generateMipmap() in a WebGL1 context.");if(this._height>1&&!v.isPowerOfTwo(this._height))throw new T("height must be a power of two to call generateMipmap() in a WebGL1 context.")}if(!Ac.validate(e))throw new T("hint is invalid.");this._hasMipmap=!0;const t=this._context._gl,n=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(n,this._texture),t.generateMipmap(n),t.bindTexture(n,null)},jc.prototype.isDestroyed=function(){return!1},jc.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),Ne(this)},Object.defineProperties(Hc.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),Hc.packedLength=2,Hc.pack=function(e,t,n){if(!w(e))throw new T("value is required");if(!w(t))throw new T("array is required");return n=n??0,t[n++]=e.near,t[n]=e.far,t},Hc.unpack=function(e,t,n){if(!w(e))throw new T("array is required");return t=t??0,w(n)||(n=new Hc),n.near=e[t++],n.far=e[t],n},Hc.equals=function(e,t){return e===t||w(e)&&w(t)&&e.near===t.near&&e.far===t.far},Hc.clone=function(e,t){if(w(e))return w(t)||(t=new Hc),t.near=e.near,t.far=e.far,t},Hc.prototype.clone=function(e){return Hc.clone(this,e)},Hc.prototype.equals=function(e){return Hc.equals(this,e)};var Yc=Object.freeze({NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2,CLAMP_TO_TERRAIN:3,RELATIVE_TO_TERRAIN:4,CLAMP_TO_3D_TILE:5,RELATIVE_TO_3D_TILE:6}),Xc=Object.freeze({CENTER:0,LEFT:1,RIGHT:-1}),$c=Object.freeze({CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1});const Kc={ADD:Se.FUNC_ADD,SUBTRACT:Se.FUNC_SUBTRACT,REVERSE_SUBTRACT:Se.FUNC_REVERSE_SUBTRACT,MIN:Se.MIN,MAX:Se.MAX};var Zc=Object.freeze(Kc);const Qc={ZERO:Se.ZERO,ONE:Se.ONE,SOURCE_COLOR:Se.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:Se.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:Se.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:Se.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:Se.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:Se.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:Se.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:Se.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:Se.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:Se.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:Se.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:Se.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:Se.SRC_ALPHA_SATURATE};var Jc=Object.freeze(Qc);const el={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Zc.ADD,equationAlpha:Zc.ADD,functionSourceRgb:Jc.SOURCE_ALPHA,functionSourceAlpha:Jc.ONE,functionDestinationRgb:Jc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Jc.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Zc.ADD,equationAlpha:Zc.ADD,functionSourceRgb:Jc.ONE,functionSourceAlpha:Jc.ONE,functionDestinationRgb:Jc.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Jc.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:Zc.ADD,equationAlpha:Zc.ADD,functionSourceRgb:Jc.SOURCE_ALPHA,functionSourceAlpha:Jc.ONE,functionDestinationRgb:Jc.ONE,functionDestinationAlpha:Jc.ONE})};var tl=Object.freeze(el);const nl={FRONT:Se.FRONT,BACK:Se.BACK,FRONT_AND_BACK:Se.FRONT_AND_BACK};var rl=Object.freeze(nl);function ol(e){e=e??K.EMPTY_OBJECT,this.material=e.material,this.translucent=e.translucent??!0,this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=e.closed??!1}function il(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=e.minificationFilter??Ic.LINEAR,this._magnificationFilter=e.magnificationFilter??Rc.LINEAR,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,this._initializationPromises=[],this._initializationError=void 0,function(e,t){let n;e=e??K.EMPTY_OBJECT,t._strict=e.strict??!1,t._count=e.count??0,t._template=jn(e.fabric??K.EMPTY_OBJECT),t.fabric=jn(e.fabric??K.EMPTY_OBJECT),t._template.uniforms=jn(t._template.uniforms??K.EMPTY_OBJECT),t._template.materials=jn(t._template.materials??K.EMPTY_OBJECT),t.type=w(t._template.type)?t._template.type:Ie(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];const r=il._materialCache.getMaterial(t.type);if(w(r)){const e=jn(r.fabric,!0);t._template=qn(t._template,e,!0),n=r.translucent}(function(e){const t=e._template,n=t.uniforms,r=t.materials,o=t.components;if(w(o)&&w(t.source))throw new T("fabric: cannot have source and components in the same template.");sl(t,ll,ul,!0),sl(o,fl,ul,!0);const i=[];for(const a in r)r.hasOwnProperty(a)&&i.push(a);sl(n,i,cl,!1)})(t),function(e){const t=e._template.components,n=e._template.source;if(w(n))e.shaderSource+=`${n}\n`;else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",w(t)){const n=Object.keys(e._template.materials).length>0;for(const r in t)if(t.hasOwnProperty(r))if("diffuse"===r||"emission"===r){const o=n&&hl(t[r],e)?t[r]:`czm_gammaCorrect(${t[r]})`;e.shaderSource+=`material.${r} = ${o}; \n`}else e.shaderSource+="alpha"===r?`material.alpha = ${t.alpha}; \n`:`material.${r} = ${t[r]};\n`}e.shaderSource+="return material;\n}\n"}}(t),function(e){const t=e._template.uniforms;for(const n in t)t.hasOwnProperty(n)&&_l(e,n)}(t),function(e){const t=e._strict,n=e._template.materials;for(const r in n)if(n.hasOwnProperty(r)){const o=new il({strict:t,fabric:n[r],count:e._count});e._count=o._count,e._uniforms=qn(e._uniforms,o._uniforms,!0),e.materials[r]=o,e._translucentFunctions=e._translucentFunctions.concat(o._translucentFunctions);const i="czm_getMaterial",a=`${i}_${e._count++}`;if(gl(o,i,a),e.shaderSource=o.shaderSource+e.shaderSource,0===gl(e,r,`${a}(materialInput)`)&&t)throw new T(`strict: shader source does not use material '${r}'.`)}}(t),w(r)||il._materialCache.addMaterial(t.type,t);const o=0===t._translucentFunctions.length||void 0;if(n=n??o,n=e.translucent??n,w(n))if("function"==typeof n){const e=function(){return n(t)};t._translucentFunctions.push(e)}else t._translucentFunctions.push(n)}(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1},minificationFilter:{get:function(){return this._minificationFilter},set:function(e){this._minificationFilter=e}},magnificationFilter:{get:function(){return this._magnificationFilter},set:function(e){this._magnificationFilter=e}}}),w(il._uniformList[this.type])||(il._uniformList[this.type]=Object.keys(this._uniforms))}function al(e,t){t.push(...e._initializationPromises);const n=e.materials;for(const r in n)n.hasOwnProperty(r)&&al(n[r],t)}function sl(e,t,n,r){if(w(e))for(const o in e)if(e.hasOwnProperty(o)){const e=-1!==t.indexOf(o);(r&&!e||!r&&e)&&n(o,t)}}function ul(e,t){let n=`fabric: property name '${e}' is not valid. It should be `;for(let r=0;r<t.length;r++){const e=`'${t[r]}'`;n+=r===t.length-1?`or ${e}.`:`${e}, `}throw new T(n)}function cl(e,t){throw new T(`fabric: uniforms and materials cannot share the same property '${e}'`)}Object.defineProperties(ol.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),ol.prototype.getFragmentShaderSource=function(){const e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),w(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},ol.prototype.isTranslucent=function(){return w(this.material)&&this.material.isTranslucent()||!w(this.material)&&this.translucent},ol.prototype.getRenderState=function(){const e=this.isTranslucent(),t=jn(this.renderState,!1);return e?(t.depthMask=!1,t.blending=tl.ALPHA_BLEND):t.depthMask=!0,t},ol.getDefaultRenderState=function(e,t,n){let r={depthTest:{enabled:!0}};return e&&(r.depthMask=!1,r.blending=tl.ALPHA_BLEND),t&&(r.cull={enabled:!0,face:rl.BACK}),w(n)&&(r=qn(n,r,!0)),r},il._uniformList={},il.fromType=function(e,t){if(!w(il._materialCache.getMaterial(e)))throw new T(`material with type '${e}' does not exist.`);const n=new il({fabric:{type:e}});if(w(t))for(const r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n},il.fromTypeAsync=async function(e,t){if(!w(il._materialCache.getMaterial(e)))throw new T(`material with type '${e}' does not exist.`);const n=[],r=new il({fabric:{type:e,uniforms:t}});if(al(r,n),await Promise.all(n),n.length=0,w(r._initializationError))throw r._initializationError;return r},il.prototype.isTranslucent=function(){if(w(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;let e=!0;const t=this._translucentFunctions,n=t.length;for(let r=0;r<n;++r){const n=t[r];if(e="function"==typeof n?e&&n():e&&n,!e)break}return e},il.prototype.update=function(e){let t,n;this._defaultTexture=e.defaultTexture;const r=this._loadedImages;let o=r.length;for(t=0;t<o;++t){const o=r[t];n=o.id;let i,a=o.image;Array.isArray(a)&&(i=a.slice(1,a.length).map(function(e){return e.bufferView}),a=a[0]);const s=new vc({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter});let u;u=w(a.internalFormat)?new jc({context:e,pixelFormat:a.internalFormat,width:a.width,height:a.height,source:{arrayBufferView:a.bufferView,mipLevels:i},sampler:s}):new jc({context:e,source:a,sampler:s});const c=this._textures[n];w(c)&&c!==this._defaultTexture&&c.destroy(),this._textures[n]=u;const l=`${n}Dimensions`;if(this.uniforms.hasOwnProperty(l)){const e=this.uniforms[l];e.x=u._width,e.y=u._height}}r.length=0;const i=this._loadedCubeMaps;for(o=i.length,t=0;t<o;++t){const r=i[t];n=r.id;const o=r.images,a=new zc({context:e,source:{positiveX:o[0],negativeX:o[1],positiveY:o[2],negativeY:o[3],positiveZ:o[4],negativeZ:o[5]},sampler:new vc({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[n]=a}i.length=0;const a=this._updateFunctions;for(o=a.length,t=0;t<o;++t)a[t](this,e);const s=this.materials;for(const u in s)s.hasOwnProperty(u)&&s[u].update(e)},il.prototype.isDestroyed=function(){return!1},il.prototype.destroy=function(){const e=this._textures;for(const n in e)if(e.hasOwnProperty(n)){const t=e[n];t!==this._defaultTexture&&t.destroy()}const t=this.materials;for(const n in t)t.hasOwnProperty(n)&&t[n].destroy();return Ne(this)};const ll=["type","materials","uniforms","components","source"],fl=["diffuse","specular","shininess","normal","emission","alpha"];function hl(e,t){const n=t._template.materials;for(const r in n)if(n.hasOwnProperty(r)&&e.indexOf(r)>-1)return!0;return!1}const pl={mat2:vi,mat3:Z,mat4:he},ml=/\.ktx2$/i;function dl(e,t){const n=e.uniforms[t];if(n===il.DefaultImageId)return Promise.resolve();const r=Tr.createIfNeeded(n);if(!(r instanceof Tr))return Promise.resolve();const o=Tr.createIfNeeded(e._texturePaths[t]);if(w(o)&&o.url===r.url)return Promise.resolve();let i;return i=ml.test(r.url)?ua(r.url):r.fetchImage(),Promise.resolve(i).then(function(n){e._loadedImages.push({id:t,image:n})}).catch(function(n){e._initializationError=n;const r=e._textures[t];w(r)&&r!==e._defaultTexture&&r.destroy(),e._textures[t]=e._defaultTexture}),e._texturePaths[t]=n,i}function yl(e,t){const n=e.uniforms[t];if(n===il.DefaultCubeMapId)return Promise.resolve();const r=n.positiveX+n.negativeX+n.positiveY+n.negativeY+n.positiveZ+n.negativeZ;if(r===e._texturePaths[t])return Promise.resolve();const o=[Tr.createIfNeeded(n.positiveX).fetchImage(),Tr.createIfNeeded(n.negativeX).fetchImage(),Tr.createIfNeeded(n.positiveY).fetchImage(),Tr.createIfNeeded(n.negativeY).fetchImage(),Tr.createIfNeeded(n.positiveZ).fetchImage(),Tr.createIfNeeded(n.negativeZ).fetchImage()],i=Promise.all(o);return i.then(function(n){e._loadedCubeMaps.push({id:t,images:n})}).catch(function(t){e._initializationError=t}),e._texturePaths[t]=r,i}function _l(e,t){const n=e._strict,r=e._template.uniforms,o=r[t],i=function(e){let t=e.type;if(!w(t)){const n=typeof e;if("number"===n)t="float";else if("boolean"===n)t="bool";else if("string"===n||e instanceof Tr||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageBitmap||e instanceof OffscreenCanvas)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===il.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===n)if(Array.isArray(e))4!==e.length&&9!==e.length&&16!==e.length||(t=`mat${Math.sqrt(e.length)}`);else{let n=0;for(const t in e)e.hasOwnProperty(t)&&(n+=1);n>=2&&n<=4?t=`vec${n}`:6===n&&(t="samplerCube")}}return t}(o);if(!w(i))throw new T(`fabric: uniform '${t}' has invalid type.`);let a;if("channels"===i){if(a=gl(e,t,o,!1),0===a&&n)throw new T(`strict: shader source does not use channels '${t}'.`)}else{if("sampler2D"===i){const n=`${t}Dimensions`;(function(e,t){return gl(e,t,t,void 0)})(e,n)>0&&(r[n]={type:"ivec3",x:1,y:1},_l(e,n))}if(!new RegExp(`uniform\\s+${i}\\s+${t}\\s*;`).test(e.shaderSource)){const n=`uniform ${i} ${t};`;e.shaderSource=n+e.shaderSource}const s=`${t}_${e._count++}`;if(a=gl(e,t,s),1===a&&n)throw new T(`strict: shader source does not use uniform '${t}'.`);if(e.uniforms[t]=o,"sampler2D"===i)e._uniforms[s]=function(){return e._textures[t]},e._updateFunctions.push(function(e){let t;return function(n,r){const o=n.uniforms,i=o[e],a=t!==i,s=!w(i)||i===il.DefaultImageId;t=i;let u,c,l=n._textures[e];if(i instanceof HTMLVideoElement)if(i.readyState>=2){if(a&&w(l)&&(l!==r.defaultTexture&&l.destroy(),l=void 0),!w(l)||l===r.defaultTexture)return l=new jc({context:r,source:i,sampler:new vc({minificationFilter:n._minificationFilter,magnificationFilter:n._magnificationFilter})}),void(n._textures[e]=l);l.copyFrom({source:i})}else w(l)||(n._textures[e]=r.defaultTexture);else{if(i instanceof jc&&i!==l){n._texturePaths[e]=void 0;const t=n._textures[e];return w(t)&&t!==n._defaultTexture&&t.destroy(),n._textures[e]=i,u=`${e}Dimensions`,void(o.hasOwnProperty(u)&&(c=o[u],c.x=i._width,c.y=i._height))}if(a&&w(l)&&s&&(l!==n._defaultTexture&&l.destroy(),l=void 0,n._texturePaths[e]=void 0),w(l)||(l=n._textures[e]=n._defaultTexture,u=`${e}Dimensions`,o.hasOwnProperty(u)&&(c=o[u],c.x=l._width,c.y=l._height)),!s)return(i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageBitmap||i instanceof OffscreenCanvas)&&i!==n._texturePaths[e]?(n._loadedImages.push({id:e,image:i}),void(n._texturePaths[e]=i)):void dl(n,e)}}}(t)),e._initializationPromises.push(dl(e,t));else if("samplerCube"===i)e._uniforms[s]=function(){return e._textures[t]},e._updateFunctions.push(function(e){return function(t,n){const r=t.uniforms[e];if(r instanceof zc){const n=t._textures[e];return n!==t._defaultTexture&&n.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=r)}w(t._textures[e])||(t._textures[e]=n.defaultCubeMap),yl(t,e)}}(t)),e._initializationPromises.push(yl(e,t));else if(-1!==i.indexOf("mat")){const n=new pl[i];e._uniforms[s]=function(){return pl[i].fromColumnMajorArray(e.uniforms[t],n)}}else e._uniforms[s]=function(){return e.uniforms[t]}}}function gl(e,t,n,r){r=r??!0;let o=0;const i=new RegExp(`([\\w${r?".":""}])?`+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(i,function(e,t,r){return t||r?e:(o+=1,n)}),o}il._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},il.DefaultImageId="czm_defaultImage",il.DefaultCubeMapId="czm_defaultCubeMap",il.ColorType="Color",il._materialCache.addMaterial(il.ColorType,{fabric:{type:il.ColorType,uniforms:{color:new dt(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),il.ImageType="Image",il._materialCache.addMaterial(il.ImageType,{fabric:{type:il.ImageType,uniforms:{image:il.DefaultImageId,repeat:new Ot(1,1),color:new dt(1,1,1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),il.DiffuseMapType="DiffuseMap",il._materialCache.addMaterial(il.DiffuseMapType,{fabric:{type:il.DiffuseMapType,uniforms:{image:il.DefaultImageId,channels:"rgb",repeat:new Ot(1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),il.AlphaMapType="AlphaMap",il._materialCache.addMaterial(il.AlphaMapType,{fabric:{type:il.AlphaMapType,uniforms:{image:il.DefaultImageId,channel:"a",repeat:new Ot(1,1)},components:{alpha:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),il.SpecularMapType="SpecularMap",il._materialCache.addMaterial(il.SpecularMapType,{fabric:{type:il.SpecularMapType,uniforms:{image:il.DefaultImageId,channel:"r",repeat:new Ot(1,1)},components:{specular:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),il.EmissionMapType="EmissionMap",il._materialCache.addMaterial(il.EmissionMapType,{fabric:{type:il.EmissionMapType,uniforms:{image:il.DefaultImageId,channels:"rgb",repeat:new Ot(1,1)},components:{emission:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),il.BumpMapType="BumpMap",il._materialCache.addMaterial(il.BumpMapType,{fabric:{type:il.BumpMapType,uniforms:{image:il.DefaultImageId,channel:"r",strength:.8,repeat:new Ot(1,1)},source:"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    vec2 centerPixel = fract(repeat * st);\n    float centerBump = texture(image, centerPixel).channel;\n\n    float imageWidth = float(imageDimensions.x);\n    vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\n    float rightBump = texture(image, rightPixel).channel;\n\n    float imageHeight = float(imageDimensions.y);\n    vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\n    float topBump = texture(image, leftPixel).channel;\n\n    vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n\n    material.normal = normalEC;\n    material.diffuse = vec3(0.01);\n\n    return material;\n}\n"},translucent:!1}),il.NormalMapType="NormalMap",il._materialCache.addMaterial(il.NormalMapType,{fabric:{type:il.NormalMapType,uniforms:{image:il.DefaultImageId,channels:"rgb",strength:.8,repeat:new Ot(1,1)},source:"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    vec4 textureValue = texture(image, fract(repeat * materialInput.st));\n    vec3 normalTangentSpace = textureValue.channels;\n    normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\n    normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\n    normalTangentSpace = normalize(normalTangentSpace);\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n    \n    material.normal = normalEC;\n    \n    return material;\n}\n"},translucent:!1}),il.GridType="Grid",il._materialCache.addMaterial(il.GridType,{fabric:{type:il.GridType,uniforms:{color:new dt(0,1,0,1),cellAlpha:.1,lineCount:new Ot(8,8),lineThickness:new Ot(1,1),lineOffset:new Ot(0,0)},source:'uniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n\n    float value;\n\n    // Fuzz Factor - Controls blurriness of lines\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    const float fuzz = 1.2;\n    vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;\n\n    // From "3D Engine Design for Virtual Globes" by Cozzi and Ring, Listing 4.13.\n    vec2 dx = abs(dFdx(st));\n    vec2 dy = abs(dFdy(st));\n    vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\n    value = min(\n        smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\n        smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\n    // If no derivatives available (IE 10?), revert to view-dependent fuzz\n    const float fuzz = 0.05;\n\n    vec2 range = 0.5 - (lineThickness * 0.05);\n    value = min(\n        1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n        1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\n\n    // Edges taken from RimLightingMaterial.glsl\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\n    float sRim = smoothstep(0.8, 1.0, dRim);\n    value *= (1.0 - sRim);\n\n    vec4 halfColor;\n    halfColor.rgb = color.rgb * 0.5;\n    halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));\n    halfColor = czm_gammaCorrect(halfColor);\n    material.diffuse = halfColor.rgb;\n    material.emission = halfColor.rgb;\n    material.alpha = halfColor.a;\n\n    return material;\n}\n'},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),il.StripeType="Stripe",il._materialCache.addMaterial(il.StripeType,{fabric:{type:il.StripeType,uniforms:{horizontal:!0,evenColor:new dt(1,1,1,.5),oddColor:new dt(0,0,1,.5),offset:0,repeat:5},source:"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // Based on the Stripes Fragment Shader in the Orange Book (11.1.2)\n    float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\n    float value = fract((coord - offset) * (repeat * 0.5));\n    float dist = min(value, min(abs(value - 0.5), 1.0 - value));\n\n    vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\n    vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\n    color = czm_gammaCorrect(color);\n\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),il.CheckerboardType="Checkerboard",il._materialCache.addMaterial(il.CheckerboardType,{fabric:{type:il.CheckerboardType,uniforms:{lightColor:new dt(1,1,1,.5),darkColor:new dt(0,0,0,.5),repeat:new Ot(5,5)},source:"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);  // 0.0 or 1.0\n\n    // Find the distance from the closest separator (region between two colors)\n    float scaledWidth = fract(repeat.s * st.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(repeat.t * st.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n    float value = min(scaledWidth, scaledHeight);\n\n    vec4 currentColor = mix(lightColor, darkColor, b);\n    vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\n\n    color = czm_gammaCorrect(color);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),il.DotType="Dot",il._materialCache.addMaterial(il.DotType,{fabric:{type:il.DotType,uniforms:{lightColor:new dt(1,1,0,.75),darkColor:new dt(0,1,1,.75),repeat:new Ot(5,5)},source:"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));  // 0.0 or 1.0\n\n    vec4 color = mix(lightColor, darkColor, b);\n    color = czm_gammaCorrect(color);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),il.WaterType="Water",il._materialCache.addMaterial(il.WaterType,{fabric:{type:il.WaterType,uniforms:{baseWaterColor:new dt(.2,.3,.6,1),blendColor:new dt(0,1,.699,1),specularMap:il.DefaultImageId,normalMap:il.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:"// Thanks for the contribution Jonas\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\nuniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float time = czm_frameNumber * animationSpeed;\n\n    // fade is a function of the distance from the fragment and the frequency of the waves\n    float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\n\n    float specularMapValue = texture(specularMap, materialInput.st).r;\n\n    // note: not using directional motion at this time, just set the angle to 0.0;\n    vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\n    vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\n\n    // fade out the normal perturbation as we move further from the water surface\n    normalTangentSpace.xy /= fade;\n\n    // attempt to fade out the normal perturbation as we approach non water areas (low specular map value)\n    normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\n\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // get ratios for alignment of the new normal vector with a vector perpendicular to the tangent plane\n    float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\n\n    // fade out water effect as specular map value decreases\n    material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;\n\n    // base color is a blend of the water and non-water color based on the value from the specular map\n    // may need a uniform blend factor to better control this\n    material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\n\n    // diffuse highlights are based on how perturbed the normal is\n    material.diffuse += (0.1 * tsPerturbationRatio);\n\n    material.diffuse = material.diffuse;\n\n    material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\n\n    material.specular = specularIntensity;\n    material.shininess = 10.0;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),il.RimLightingType="RimLighting",il._materialCache.addMaterial(il.RimLightingType,{fabric:{type:il.RimLightingType,uniforms:{color:new dt(1,0,0,.7),rimColor:new dt(1,1,1,.4),width:.3},source:"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\n    float s = smoothstep(1.0 - width, 1.0, d);\n\n    vec4 outColor = czm_gammaCorrect(color);\n    vec4 outRimColor = czm_gammaCorrect(rimColor);\n\n    material.diffuse = outColor.rgb;\n    material.emission = outRimColor.rgb * s;\n    material.alpha = mix(outColor.a, outRimColor.a, s);\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),il.FadeType="Fade",il._materialCache.addMaterial(il.FadeType,{fabric:{type:il.FadeType,uniforms:{fadeInColor:new dt(1,0,0,1),fadeOutColor:new dt(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new Ot(.5,.5)},source:"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\n\nfloat getTime(float t, float coord)\n{\n    float scalar = 1.0 / maximumDistance;\n    float q  = distance(t, coord) * scalar;\n    if (repeat)\n    {\n        float r = distance(t, coord + 1.0) * scalar;\n        float s = distance(t, coord - 1.0) * scalar;\n        q = min(min(r, s), q);\n    }\n    return clamp(q, 0.0, 1.0);\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float s = getTime(time.x, st.s) * fadeDirection.s;\n    float t = getTime(time.y, st.t) * fadeDirection.t;\n\n    float u = length(vec2(s, t));\n    vec4 color = mix(fadeInColor, fadeOutColor, u);\n\n    color = czm_gammaCorrect(color);\n    material.emission = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),il.PolylineArrowType="PolylineArrow",il._materialCache.addMaterial(il.PolylineArrowType,{fabric:{type:il.PolylineArrowType,uniforms:{color:new dt(1,1,1,1)},source:"uniform vec4 color;\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n#else\n     // If no derivatives available (IE 10?), 2.5% of the line will be the arrow head\n    float base = 0.975;\n#endif\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n\n    outColor = czm_gammaCorrect(outColor);\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n"},translucent:!0}),il.PolylineDashType="PolylineDash",il._materialCache.addMaterial(il.PolylineDashType,{fabric:{type:il.PolylineDashType,uniforms:{color:new dt(1,0,1,1),gapColor:new dt(0,0,0,0),dashLength:16,dashPattern:255},source:"uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nin float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n\n    fragColor = czm_gammaCorrect(fragColor);\n    material.emission = fragColor.rgb;\n    material.alpha = fragColor.a;\n    return material;\n}\n"},translucent:!0}),il.PolylineGlowType="PolylineGlow",il._materialCache.addMaterial(il.PolylineGlowType,{fabric:{type:il.PolylineGlowType,uniforms:{color:new dt(0,.5,1,1),glowPower:.25,taperPower:1},source:"uniform vec4 color;\nuniform float glowPower;\nuniform float taperPower;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n    if (taperPower <= 0.99999) {\n        glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));\n    }\n\n    vec4 fragColor;\n    fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n    fragColor.a = clamp(0.0, 1.0, glow) * color.a;\n    fragColor = czm_gammaCorrect(fragColor);\n\n    material.emission = fragColor.rgb;\n    material.alpha = fragColor.a;\n\n    return material;\n}\n"},translucent:!0}),il.PolylineOutlineType="PolylineOutline",il._materialCache.addMaterial(il.PolylineOutlineType,{fabric:{type:il.PolylineOutlineType,uniforms:{color:new dt(1,1,1,1),outlineColor:new dt(1,0,0,1),outlineWidth:1},source:"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\n\nin float v_width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\n    float b = step(0.5 - halfInteriorWidth, st.t);\n    b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float d1 = abs(st.t - (0.5 - halfInteriorWidth));\n    float d2 = abs(st.t - (0.5 + halfInteriorWidth));\n    float dist = min(d1, d2);\n\n    vec4 currentColor = mix(outlineColor, color, b);\n    vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\n    outColor = czm_gammaCorrect(outColor);\n\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n\n    return material;\n}\n"},translucent:function(e){const t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),il.ElevationContourType="ElevationContour",il._materialCache.addMaterial(il.ElevationContourType,{fabric:{type:il.ElevationContourType,uniforms:{spacing:100,color:new dt(1,0,0,1),width:1},source:"uniform vec4 color;\nuniform float spacing;\nuniform float width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float distanceToContour = mod(materialInput.height, spacing);\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    float dxc = abs(dFdx(materialInput.height));\n    float dyc = abs(dFdy(materialInput.height));\n    float dF = max(dxc, dyc) * czm_pixelRatio * width;\n    float alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\n    // If no derivatives available (IE 10?), use pixel ratio\n    float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;\n#endif\n\n    vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n\n    return material;\n}\n"},translucent:!1}),il.ElevationRampType="ElevationRamp",il._materialCache.addMaterial(il.ElevationRampType,{fabric:{type:il.ElevationRampType,uniforms:{image:il.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:"uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\n    vec4 rampColor = texture(image, vec2(scaledHeight, 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n"},translucent:!1}),il.SlopeRampMaterialType="SlopeRamp",il._materialCache.addMaterial(il.SlopeRampMaterialType,{fabric:{type:il.SlopeRampMaterialType,uniforms:{image:il.DefaultImageId},source:"uniform sampler2D image;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 rampColor = texture(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n"},translucent:!1}),il.AspectRampMaterialType="AspectRamp",il._materialCache.addMaterial(il.AspectRampMaterialType,{fabric:{type:il.AspectRampMaterialType,uniforms:{image:il.DefaultImageId},source:"uniform sampler2D image;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 rampColor = texture(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n"},translucent:!1}),il.ElevationBandType="ElevationBand",il._materialCache.addMaterial(il.ElevationBandType,{fabric:{type:il.ElevationBandType,uniforms:{heights:il.DefaultImageId,colors:il.DefaultImageId},source:"uniform sampler2D heights;\nuniform sampler2D colors;\n\n// This material expects heights to be sorted from lowest to highest.\n\nfloat getHeight(int idx, float invTexSize)\n{\n    vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);\n#ifdef OES_texture_float\n    return texture(heights, uv).x;\n#else\n    return czm_unpackFloat(texture(heights, uv));\n#endif\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float height = materialInput.height;\n    float invTexSize = 1.0 / float(heightsDimensions.x);\n\n    float minHeight = getHeight(0, invTexSize);\n    float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);\n\n    // early-out when outside the height range\n    if (height < minHeight || height > maxHeight) {\n        material.diffuse = vec3(0.0);\n        material.alpha = 0.0;\n        return material;\n    }\n\n    // Binary search to find heights above and below.\n    int idxBelow = 0;\n    int idxAbove = heightsDimensions.x;\n    float heightBelow = minHeight;\n    float heightAbove = maxHeight;\n\n    // while loop not allowed, so use for loop with max iterations.\n    // maxIterations of 16 supports a texture size up to 65536 (2^16).\n    const int maxIterations = 16;\n    for (int i = 0; i < maxIterations; i++) {\n        if (idxBelow >= idxAbove - 1) {\n            break;\n        }\n\n        int idxMid = (idxBelow + idxAbove) / 2;\n        float heightTex = getHeight(idxMid, invTexSize);\n\n        if (height > heightTex) {\n            idxBelow = idxMid;\n            heightBelow = heightTex;\n        } else {\n            idxAbove = idxMid;\n            heightAbove = heightTex;\n        }\n    }\n\n    float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);\n    vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);\n    vec4 color = texture(colors, colorUv);\n\n    // undo preumultiplied alpha\n    if (color.a > 0.0) \n    {\n        color.rgb /= color.a;\n    }\n    \n    color.rgb = czm_gammaCorrect(color.rgb);\n\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n    return material;\n}\n"},translucent:!0}),il.WaterMaskType="WaterMask",il._materialCache.addMaterial(il.WaterMaskType,{fabric:{type:il.WaterMaskType,source:"uniform vec4 waterColor;\nuniform vec4 landColor;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec4 outColor = mix(landColor, waterColor, materialInput.waterMask);\n    outColor = czm_gammaCorrect(outColor);\n\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n\n    return material;\n}\n",uniforms:{waterColor:new dt(1,1,1,1),landColor:new dt(0,0,0,0)}},translucent:!1});let El="void clipLineSegmentToNearPlane(\n    vec3 p0,\n    vec3 p1,\n    out vec4 positionWC,\n    out bool clipped,\n    out bool culledByNearPlane,\n    out vec4 clippedPositionEC)\n{\n    culledByNearPlane = false;\n    clipped = false;\n\n    vec3 p0ToP1 = p1 - p0;\n    float magnitude = length(p0ToP1);\n    vec3 direction = normalize(p0ToP1);\n\n    // Distance that p0 is behind the near plane. Negative means p0 is\n    // in front of the near plane.\n    float endPoint0Distance =  czm_currentFrustum.x + p0.z;\n\n    // Camera looks down -Z.\n    // When moving a point along +Z: LESS VISIBLE\n    //   * Points in front of the camera move closer to the camera.\n    //   * Points behind the camrea move farther away from the camera.\n    // When moving a point along -Z: MORE VISIBLE\n    //   * Points in front of the camera move farther away from the camera.\n    //   * Points behind the camera move closer to the camera.\n\n    // Positive denominator: -Z, becoming more visible\n    // Negative denominator: +Z, becoming less visible\n    // Nearly zero: parallel to near plane\n    float denominator = -direction.z;\n\n    if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)\n    {\n        // p0 is behind the near plane and the line to p1 is nearly parallel to\n        // the near plane, so cull the segment completely.\n        culledByNearPlane = true;\n    }\n    else if (endPoint0Distance > 0.0)\n    {\n        // p0 is behind the near plane, and the line to p1 is moving distinctly\n        // toward or away from it.\n\n        // t = (-plane distance - dot(plane normal, ray origin)) / dot(plane normal, ray direction)\n        float t = endPoint0Distance / denominator;\n        if (t < 0.0 || t > magnitude)\n        {\n            // Near plane intersection is not between the two points.\n            // We already confirmed p0 is behind the naer plane, so now\n            // we know the entire segment is behind it.\n            culledByNearPlane = true;\n        }\n        else\n        {\n            // Segment crosses the near plane, update p0 to lie exactly on it.\n            p0 = p0 + t * direction;\n\n            // Numerical noise might put us a bit on the wrong side of the near plane.\n            // Don't let that happen.\n            p0.z = min(p0.z, -czm_currentFrustum.x);\n\n            clipped = true;\n        }\n    }\n\n    clippedPositionEC = vec4(p0, 1.0);\n    positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);\n}\n\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\n    // expandDirection +1 is to the _left_ when looking from positionEC toward nextEC.\n\n#ifdef POLYLINE_DASH\n    // Compute the window coordinates of the points.\n    vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\n    vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\n    vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\n\n    // Determine the relative screen space direction of the line.\n    vec2 lineDir;\n    if (usePrevious) {\n        lineDir = normalize(positionWindow.xy - previousWindow.xy);\n    }\n    else {\n        lineDir = normalize(nextWindow.xy - positionWindow.xy);\n    }\n    angle = atan(lineDir.x, lineDir.y) - 1.570796327; // precomputed atan(1,0)\n\n    // Quantize the angle so it doesn't change rapidly between segments.\n    angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\n\n    vec4 clippedPrevWC, clippedPrevEC;\n    bool prevSegmentClipped, prevSegmentCulled;\n    clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);\n\n    vec4 clippedNextWC, clippedNextEC;\n    bool nextSegmentClipped, nextSegmentCulled;\n    clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);\n\n    bool segmentClipped, segmentCulled;\n    vec4 clippedPositionWC, clippedPositionEC;\n    clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);\n\n    if (segmentCulled)\n    {\n        return vec4(0.0, 0.0, 0.0, 1.0);\n    }\n\n    vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);\n    vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);\n\n    // If a segment was culled, we can't use the corresponding direction\n    // computed above. We should never see both of these be true without\n    // `segmentCulled` above also being true.\n    if (prevSegmentCulled)\n    {\n        directionToPrevWC = -directionToNextWC;\n    }\n    else if (nextSegmentCulled)\n    {\n        directionToNextWC = -directionToPrevWC;\n    }\n\n    vec2 thisSegmentForwardWC, otherSegmentForwardWC;\n    if (usePrevious)\n    {\n        thisSegmentForwardWC = -directionToPrevWC;\n        otherSegmentForwardWC = directionToNextWC;\n    }\n    else\n    {\n        thisSegmentForwardWC = directionToNextWC;\n        otherSegmentForwardWC =  -directionToPrevWC;\n    }\n\n    vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);\n\n    vec2 leftWC = thisSegmentLeftWC;\n    float expandWidth = width * 0.5;\n\n    // When lines are split at the anti-meridian, the position may be at the\n    // same location as the next or previous position, and we need to handle\n    // that to avoid producing NaNs.\n    if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))\n    {\n        vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);\n\n        vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;\n        float leftSumLength = length(leftSumWC);\n        leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);\n\n        // The sine of the angle between the two vectors is given by the formula\n        //         |a x b| = |a||b|sin(theta)\n        // which is\n        //     float sinAngle = length(cross(vec3(leftWC, 0.0), vec3(-thisSegmentForwardWC, 0.0)));\n        // Because the z components of both vectors are zero, the x and y coordinate will be zero.\n        // Therefore, the sine of the angle is just the z component of the cross product.\n        vec2 u = -thisSegmentForwardWC;\n        vec2 v = leftWC;\n        float sinAngle = abs(u.x * v.y - u.y * v.x);\n        expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n    }\n\n    vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;\n    return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;\n}\n\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\n    vec4 positionEC = czm_modelViewRelativeToEye * position;\n    vec4 prevEC = czm_modelViewRelativeToEye * previous;\n    vec4 nextEC = czm_modelViewRelativeToEye * next;\n    return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n\nin vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 prevPosition3DHigh;\nin vec3 prevPosition3DLow;\nin vec3 nextPosition3DHigh;\nin vec3 nextPosition3DLow;\nin vec2 expandAndWidth;\nin vec2 st;\nin float batchId;\n\nout float v_width;\nout vec2 v_st;\nout float v_polylineAngle;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = czm_computePosition();\n    vec4 prev = czm_computePrevPosition();\n    vec4 next = czm_computeNextPosition();\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n\n    v_width = width;\n    v_st.s = st.s;\n    v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);\n    v_polylineAngle = angle;\n}\n";function bl(e){const t=(e=e??K.EMPTY_OBJECT).translucent??!0,n=!1,r=bl.VERTEX_FORMAT;this.material=w(e.material)?e.material:il.fromType(il.ColorType),this.translucent=t,this._vertexShaderSource=e.vertexShaderSource??El,this._fragmentShaderSource=e.fragmentShaderSource??"#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\n\nin vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n\n    vec2 st = v_st;\n    st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);\n\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = vec3(st, 0.0);\n\n    czm_material material = czm_getMaterial(materialInput);\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\n    out_FragColor *= u_highlightColor;\n#endif\n\n    czm_writeLogDepth();\n}\n",this._renderState=ol.getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=r}pt.isInternetExplorer()||(El=`#define CLIP_POLYLINE \n${El}`),Object.defineProperties(bl.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)&&(e=`#define POLYLINE_DASH\n${e}`),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),bl.VERTEX_FORMAT=Za.POSITION_AND_ST,bl.prototype.getFragmentShaderSource=ol.prototype.getFragmentShaderSource,bl.prototype.isTranslucent=ol.prototype.isTranslucent,bl.prototype.getRenderState=ol.prototype.getRenderState;var wl,Tl=Object.freeze({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2});function Ol(e,t){return toString.call(e)===`[object ${t}]`}function Al(e){return Ol(e,"String")}function xl(e){return Ol(e,"Number")}function Rl(e){return void 0!==e}function Sl(e={},t={}){let n;for(n in t)e[n]=t[n];return e}wl||(wl=1,function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function t(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&o)+t[1]-389564586|0)<<12|i>>>20)+n|0)&n|~i&r)+t[2]+606105819|0)<<17|o>>>15)+i|0)&i|~o&n)+t[3]-1044525330|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&o)+t[5]+1200080426|0)<<12|i>>>20)+n|0)&n|~i&r)+t[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&n)+t[7]-45705983|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&o)+t[9]-1958414417|0)<<12|i>>>20)+n|0)&n|~i&r)+t[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&n)+t[11]-1990404162|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&o)+t[13]-40341101|0)<<12|i>>>20)+n|0)&n|~i&r)+t[14]-1502002290|0)<<17|o>>>15)+i|0)&i|~o&n)+t[15]+1236535329|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[1]-165796510|0)<<5|n>>>27)+r|0)&o|r&~o)+t[6]-1069501632|0)<<9|i>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|o>>>18)+i|0)&n|i&~n)+t[0]-373897302|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[5]-701558691|0)<<5|n>>>27)+r|0)&o|r&~o)+t[10]+38016083|0)<<9|i>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|o>>>18)+i|0)&n|i&~n)+t[4]-405537848|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[9]+568446438|0)<<5|n>>>27)+r|0)&o|r&~o)+t[14]-1019803690|0)<<9|i>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|o>>>18)+i|0)&n|i&~n)+t[8]+1163531501|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&o|r&~o)+t[2]-51403784|0)<<9|i>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|o>>>18)+i|0)&n|i&~n)+t[12]-1926607734|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^o)+t[8]-2022574463|0)<<11|i>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|o>>>16)+i|0)^i^n)+t[14]-35309556|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^o)+t[4]+1272893353|0)<<11|i>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|o>>>16)+i|0)^i^n)+t[10]-1094730640|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^o)+t[0]-358537222|0)<<11|i>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|o>>>16)+i|0)^i^n)+t[6]+76029189|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^o)+t[12]-421815835|0)<<11|i>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|o>>>16)+i|0)^i^n)+t[2]-995338651|0)<<23|r>>>9)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~o))+t[7]+1126891415|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[14]-1416354905|0)<<15|o>>>17)+i|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~o))+t[3]-1894986606|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[10]-1051523|0)<<15|o>>>17)+i|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~o))+t[15]-30611744|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[6]-1560198380|0)<<15|o>>>17)+i|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~o))+t[11]-1120210379|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[2]+718787259|0)<<15|o>>>17)+i|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+o|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}function n(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function r(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function o(e){var r,o,i,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=c;r+=64)t(l,n(e.substring(r-64,r)));for(o=(e=e.substring(r-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<o;r+=1)i[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(t(l,i),r=0;r<16;r+=1)i[r]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,i[14]=s,i[15]=u,t(l,i),l}function i(e){var n,o,i,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)t(l,r(e.subarray(n-64,n)));for(o=(e=n-64<c?e.subarray(n-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<o;n+=1)i[n>>2]|=e[n]<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(t(l,i),n=0;n<16;n+=1)i[n]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,i[14]=s,i[15]=u,t(l,i),l}function a(t){var n,r="";for(n=0;n<4;n+=1)r+=e[t>>8*n+4&15]+e[t>>8*n&15];return r}function s(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function u(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function c(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function l(){this.reset()}s(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,n){var r,o,i,a,s=this.byteLength,u=e(t,s),c=s;return undefined!==n&&(c=e(n,s)),u>c?new ArrayBuffer(0):(r=c-u,o=new ArrayBuffer(r),i=new Uint8Array(o),a=new Uint8Array(this,u,r),i.set(a),o)}}(),l.prototype.append=function(e){return this.appendBinary(u(e)),this},l.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var r,o=this._buff.length;for(r=64;r<=o;r+=64)t(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},l.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),n=s(this._hash),e&&(n=c(n)),this.reset(),n},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},l.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(e,n){var r,o,i,a=n;if(e[a>>2]|=128<<(a%4<<3),a>55)for(t(this._hash,e),a=0;a<16;a+=1)e[a]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(r[2],16),i=parseInt(r[1],16)||0,e[14]=o,e[15]=i,t(this._hash,e)},l.hash=function(e,t){return l.hashBinary(u(e),t)},l.hashBinary=function(e,t){var n=s(o(e));return t?c(n):n},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(e){var n,o=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),n}(this._buff.buffer,e),i=o.length;for(this._length+=e.byteLength,n=64;n<=i;n+=64)t(this._hash,r(o.subarray(n-64,n)));return this._buff=n-64<i?new Uint8Array(o.buffer.slice(n-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r[t]<<(t%4<<3);return this._finish(i,o),n=s(this._hash),e&&(n=c(n)),this.reset(),n},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var e=l.prototype.getState.call(this);return e.buff=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}(e.buff),e},l.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var n,r=e.length,o=new ArrayBuffer(r),i=new Uint8Array(o);for(n=0;n<r;n+=1)i[n]=e.charCodeAt(n);return t?i:o}(e.buff,!0),l.prototype.setState.call(this,e)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(e,t){var n=s(i(new Uint8Array(e)));return t?c(n):n}}());class Il{show=!0;minLevel;maxLevel;weight;scale=1;offset;fontColor="#000";fontFamily="";fontSize=10;backgroundColor;backgroundPadding;outlineColor;outlineAlpha;outlineWidth;imgUrl;imgWidth;imgHeight;labelField="name";filterField;includeValue;excludeValue;near;far;children;get font(){return this.fontSize+"px "+this.fontFamily}constructor(e){e&&this.copyFrom(e)}static fromOption(e){const t={};if(xl(e.scale)&&(t.scale=e.scale),xl(e.minLevel)&&(t.minLevel=e.minLevel),xl(e.maxLevel)&&(t.maxLevel=e.maxLevel),xl(e.near)&&(t.near=e.near),xl(e.far)&&(t.far=e.far),Rl(e.fontSize)||Al(e.fontFamily)){const n=e.fontSize??10,r=e.fontFamily??"";t.font=n+"px "+r}if(e.fontColor&&(t.fillColor=dt.fromCssColorString(e.fontColor)),Al(e.backgroundColor)&&(t.showBackground=!0,t.backgroundColor=dt.fromCssColorString(e.backgroundColor),t.backgroundPadding=new Ot(e.backgroundPadding,e.backgroundPadding)),e.outlineColor&&(t.style=Tl.FILL_AND_OUTLINE,t.outlineColor=dt.fromCssColorString(e.outlineColor).withAlpha(e.outlineAlpha??1),t.outlineWidth=e.outlineWidth??2),e.imgUrl){t.image=e.imgUrl,t.width=e.imgWidth,t.height=e.imgHeight;const n=xl(e.offset)?e.offset:0;t.pixelOffset=new Ot(0,n)}else""===e.imgUrl&&(t.image=void 0);return t}static fromDefaultOption(e){const t={show:!0,style:Tl.FILL,pixelOffset:Ot.ZERO,eyeOffset:L.ZERO,horizontalOrigin:Xc.CENTER,verticalOrigin:$c.CENTER,heightReference:Yc.CLAMP_TO_GROUND,distanceDisplayCondition:new Hc(0,2e7),disableDepthTestDistance:1e8};if(xl(e.scale)&&(t.scale=e.scale),xl(e.minLevel)&&(t.minLevel=e.minLevel),xl(e.maxLevel)&&(t.maxLevel=e.maxLevel),Rl(e.fontSize)||Al(e.fontFamily)){const n=e.fontSize??10,r=e.fontFamily??"";t.font=n+"px "+r}if(e.fontColor&&(t.fillColor=dt.fromCssColorString(e.fontColor)),Al(e.backgroundColor)&&(t.showBackground=!0,t.backgroundColor=dt.fromCssColorString(e.backgroundColor),t.backgroundPadding=new Ot(e.backgroundPadding,e.backgroundPadding)),e.outlineColor&&(t.style=Tl.FILL_AND_OUTLINE,t.outlineColor=dt.fromCssColorString(e.outlineColor).withAlpha(e.outlineAlpha??1),t.outlineWidth=e.outlineWidth??2),e.imgUrl){t.image=e.imgUrl,t.width=e.imgWidth,t.height=e.imgHeight;const n=xl(e.offset)?e.offset:0;t.pixelOffset=new Ot(0,n)}else""===e.imgUrl&&(t.image=void 0);return t}clone(){const e=new Il;return e.show=this.show,e.minLevel=this.minLevel,e.maxLevel=this.maxLevel,e.near=this.near,e.far=this.far,e.weight=this.weight,e.offset=this.offset,this.fontColor&&(e.fontColor=this.fontColor),this.fontSize&&(e.fontSize=this.fontSize),this.fontFamily&&(e.fontFamily=this.fontFamily),e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.outlineColor=this.outlineColor,e.outlineAlpha=this.outlineAlpha,e.outlineWidth=this.outlineWidth,e.imgUrl=this.imgUrl,e.imgWidth=this.imgWidth,e.imgHeight=this.imgHeight,e.labelField=this.labelField,e.filterField=this.filterField,e.includeValue=this.includeValue,e.excludeValue=this.excludeValue,e.children=this.children?[...this.children]:void 0,e}copyFrom(e){this.show=e.show,this.minLevel=e.minLevel,this.maxLevel=e.maxLevel,this.near=e.near,this.far=e.far,this.weight=e.weight,this.offset=e.offset,e.fontColor&&(this.fontColor=e.fontColor),e.fontSize&&(this.fontSize=e.fontSize),e.fontFamily&&(this.fontFamily=e.fontFamily),this.backgroundColor=e.backgroundColor,this.backgroundPadding=e.backgroundPadding,this.outlineColor=e.outlineColor,this.outlineAlpha=e.outlineAlpha,this.outlineWidth=e.outlineWidth,this.imgUrl=e.imgUrl,this.imgWidth=e.imgWidth,this.imgHeight=e.imgHeight,e.labelField&&(this.labelField=e.labelField),this.filterField=e.filterField,this.includeValue=e.includeValue,this.excludeValue=e.excludeValue,this.children=e.children?[...e.children]:void 0}getLabelOption(){const e={show:!0,font:this.font,fillColor:dt.fromCssColorString(this.fontColor),style:Tl.FILL,scale:this.scale,pixelOffset:Ot.ZERO,eyeOffset:L.ZERO,horizontalOrigin:Xc.CENTER,verticalOrigin:$c.CENTER,heightReference:Yc.CLAMP_TO_GROUND,distanceDisplayCondition:new Hc(0,2e7),disableDepthTestDistance:1e8};xl(this.weight)&&(e.eyeOffset=new L(0,0,-100*this.weight)),this.backgroundColor&&(e.showBackground=!0,e.backgroundColor=dt.fromCssColorString(this.backgroundColor),e.backgroundPadding=new Ot(this.backgroundPadding??7,this.backgroundPadding??5)),this.outlineColor&&(e.style=Tl.FILL_AND_OUTLINE,e.outlineColor=dt.fromCssColorString(this.outlineColor).withAlpha(this.outlineAlpha??1),e.outlineWidth=this.outlineWidth??2);let t=0;return xl(this.offset)&&(t=this.offset,e.pixelOffset=new Ot(0,t)),this.imgUrl&&(e.image=this.imgUrl,e.width=this.imgWidth,e.height=this.imgHeight),e}getBillboardOption(){return this.imgUrl?{image:this.imgUrl,width:this.imgWidth,height:this.imgHeight}:{}}}class Cl{show=!0;maxLevel=22;minLevel=0;color="#000";colorAlpha=1;gapColor;dashLength;dashPattern;outlineColor;outlineWidth;glowPower;taperPower;width=1;constructor(e){e&&this.copyFrom(e)}texture="";getValue(){let e=il.fromType(il.ColorType,{color:dt.fromCssColorString(this.color).withAlpha(this.colorAlpha??1)});if(this.gapColor&&(e=il.fromType(il.PolylineDashType,{color:dt.fromCssColorString(this.color).withAlpha(this.colorAlpha??1),gapColor:dt.fromCssColorString(this.gapColor),dashPattern:this.dashPattern,dashLength:this.dashLength??20})),this.outlineColor&&(e=il.fromType(il.PolylineOutlineType,{color:dt.fromCssColorString(this.color).withAlpha(this.colorAlpha??1),outlineColor:dt.fromCssColorString(this.outlineColor),outlineWidth:this.outlineWidth})),this.glowPower&&this.taperPower&&(e=il.fromType(il.PolylineGlowType,{color:dt.fromCssColorString(this.color).withAlpha(this.colorAlpha??1),glowPower:this.glowPower,taperPower:this.taperPower})),e)return new bl({material:e})}copyFrom(e){e&&(this.show=e.show,this.maxLevel=e.maxLevel,this.minLevel=e.minLevel,this.color=e.color,xl(e.colorAlpha)&&(this.colorAlpha=e.colorAlpha),Al(e.gapColor)&&(this.gapColor=e.gapColor),this.dashPattern=e.dashPattern,Al(e.outlineColor)&&(this.outlineColor=e.outlineColor),xl(e.outlineWidth)&&(this.outlineWidth=e.outlineWidth),this.glowPower=e.glowPower,this.taperPower=e.taperPower,this.width=e.width)}clone(){const e=new Cl;return e.show=this.show,e.maxLevel=this.maxLevel,e.minLevel=this.minLevel,e.color=this.color,e.gapColor=this.gapColor,e.dashPattern=this.dashPattern,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.glowPower=this.glowPower,e.taperPower=this.taperPower,e.width=this.width,e}}function Nl(e,t){this.x=e,this.y=t}Nl.prototype={clone(){return new Nl(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,n=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=n,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,o=n*this.x+t*this.y;return this.x=r,this.y=o,this},_rotateAround(e,t){const n=Math.cos(e),r=Math.sin(e),o=t.x+n*(this.x-t.x)-r*(this.y-t.y),i=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=o,this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Nl},Nl.convert=function(e){if(e instanceof Nl)return e;if(Array.isArray(e))return new Nl(+e[0],+e[1]);if(void 0!==e.x&&void 0!==e.y)return new Nl(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};class vl{constructor(e,t,n,r,o){this.properties={},this.extent=n,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=o,e.readFields(Pl,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos,n=[];let r,o=1,i=0,a=0,s=0;for(;e.pos<t;){if(i<=0){const t=e.readVarint();o=7&t,i=t>>3}if(i--,1===o||2===o)a+=e.readSVarint(),s+=e.readSVarint(),1===o&&(r&&n.push(r),r=[]),r&&r.push(new Nl(a,s));else{if(7!==o)throw new Error(`unknown command ${o}`);r&&r.push(r[0].clone())}}return r&&n.push(r),n}bbox(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let n=1,r=0,o=0,i=0,a=1/0,s=-1/0,u=1/0,c=-1/0;for(;e.pos<t;){if(r<=0){const t=e.readVarint();n=7&t,r=t>>3}if(r--,1===n||2===n)o+=e.readSVarint(),i+=e.readSVarint(),o<a&&(a=o),o>s&&(s=o),i<u&&(u=i),i>c&&(c=i);else if(7!==n)throw new Error(`unknown command ${n}`)}return[a,u,s,c]}toGeoJSON(e,t,n){const r=this.extent*Math.pow(2,n),o=this.extent*e,i=this.extent*t,a=this.loadGeometry();function s(e){return[360*(e.x+o)/r-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+i)/r)*Math.PI))-90]}function u(e){return e.map(s)}let c;if(1===this.type){const e=[];for(const n of a)e.push(n[0]);const t=u(e);c=1===e.length?{type:"Point",coordinates:t[0]}:{type:"MultiPoint",coordinates:t}}else if(2===this.type){const e=a.map(u);c=1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}}else{if(3!==this.type)throw new Error("unknown feature type");{const e=function(e){const t=e.length;if(t<=1)return[e];const n=[];let r,o;for(let i=0;i<t;i++){const t=Ml(e[i]);0!==t&&(void 0===o&&(o=t<0),o===t<0?(r&&n.push(r),r=[e[i]]):r&&r.push(e[i]))}return r&&n.push(r),n}(a),t=[];for(const n of e)t.push(n.map(u));c=1===t.length?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}}}const l={type:"Feature",geometry:c,properties:this.properties};return null!=this.id&&(l.id=this.id),l}}function Pl(e,t,n){1===e?t.id=n.readVarint():2===e?function(e,t){const n=e.readVarint()+e.pos;for(;e.pos<n;){const n=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[n]=r}}(n,t):3===e?t.type=n.readVarint():4===e&&(t._geometry=n.pos)}function Ml(e){let t=0;for(let n,r,o=0,i=e.length,a=i-1;o<i;a=o++)n=e[o],r=e[a],t+=(r.x-n.x)*(n.y+r.y);return t}vl.types=["Unknown","Point","LineString","Polygon"];class Ll{constructor(e,t){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Fl,this,t),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const t=this._pbf.readVarint()+this._pbf.pos;return new vl(this._pbf,t,this.extent,this._keys,this._values)}}function Fl(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){let t=null;const n=e.readVarint()+e.pos;for(;e.pos<n;){const n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}if(null==t)throw new Error("unknown feature value");return t}(n))}class Dl{constructor(e,t){this.layers=e.readFields(zl,{},t)}}function zl(e,t,n){if(3===e){const e=new Ll(n,n.readVarint()+n.pos);e.length&&(t[e.name]=e)}}const Bl=4294967296,Ul=1/Bl,jl="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class ql{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,n=this.length){for(;this.pos<n;){const n=this.readVarint(),r=n>>3,o=this.pos;this.type=7&n,e(r,t,this),this.pos===o&&this.skip(n)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Bl;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Bl;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let n,r;return r=t[this.pos++],n=127&r,r<128?n:(r=t[this.pos++],n|=(127&r)<<7,r<128?n:(r=t[this.pos++],n|=(127&r)<<14,r<128?n:(r=t[this.pos++],n|=(127&r)<<21,r<128?n:(r=t[this.pos],n|=(15&r)<<28,function(e,t,n){const r=n.buf;let o,i;if(i=r[n.pos++],o=(112&i)>>4,i<128)return Gl(e,o,t);if(i=r[n.pos++],o|=(127&i)<<3,i<128)return Gl(e,o,t);if(i=r[n.pos++],o|=(127&i)<<10,i<128)return Gl(e,o,t);if(i=r[n.pos++],o|=(127&i)<<17,i<128)return Gl(e,o,t);if(i=r[n.pos++],o|=(127&i)<<24,i<128)return Gl(e,o,t);if(i=r[n.pos++],o|=(1&i)<<31,i<128)return Gl(e,o,t);throw new Error("Expected varint not more than 10 bytes")}(n,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return Boolean(this.readVarint())}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&jl?jl.decode(this.buf.subarray(t,e)):function(e,t,n){let r="",o=t;for(;o<n;){const t=e[o];let i,a,s,u=null,c=t>239?4:t>223?3:t>191?2:1;if(o+c>n)break;1===c?t<128&&(u=t):2===c?(i=e[o+1],128==(192&i)&&(u=(31&t)<<6|63&i,u<=127&&(u=null))):3===c?(i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(u=(15&t)<<12|(63&i)<<6|63&a,(u<=2047||u>=55296&&u<=57343)&&(u=null))):4===c&&(i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&t)<<18|(63&i)<<12|(63&a)<<6|63&s,(u<=65535||u>=1114112)&&(u=null))),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),o+=c}return r}(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(e){const t=7&e;if(0===t)for(;this.buf[this.pos++]>127;);else if(2===t)this.pos=this.readVarint()+this.pos;else if(5===t)this.pos+=4;else{if(1!==t)throw new Error(`Unimplemented type: ${t}`);this.pos+=8}}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const e=new Uint8Array(t);e.set(this.buf),this.buf=e,this.dataView=new DataView(e.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Ul),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Ul),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?function(e,t){let n,r;if(e>=0?(n=e%4294967296|0,r=e/4294967296|0):(n=~(-e%4294967296),r=~(-e/4294967296),4294967295^n?n=n+1|0:(n=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos]=127&e}(n,0,t),function(e,t){const n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const t=this.pos;this.pos=function(e,t,n){for(let r,o,i=0;i<t.length;i++){if(r=t.charCodeAt(i),r>55295&&r<57344){if(!o){r>56319||i+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):o=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,o=r;continue}r=o-55296<<10|r-56320|65536,o=null}else o&&(e[n++]=239,e[n++]=191,e[n++]=189,o=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);const n=this.pos-t;n>=128&&kl(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let n=0;n<t;n++)this.buf[this.pos++]=e[n]}writeRawMessage(e,t){this.pos++;const n=this.pos;e(t,this);const r=this.pos-n;r>=128&&kl(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r}writeMessage(e,t,n){this.writeTag(e,2),this.writeRawMessage(t,n)}writePackedVarint(e,t){t.length&&this.writeMessage(e,Wl,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,Vl,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,Xl,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,Hl,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,Yl,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,$l,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,Kl,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,Zl,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,Ql,t)}writeBytesField(e,t){this.writeTag(e,2),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,5),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,5),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,1),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,1),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,0),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,0),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,2),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,5),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,1),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function Gl(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function kl(e,t,n){const r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(let o=n.pos-1;o>=e;o--)n.buf[o+r]=n.buf[o]}function Wl(e,t){for(let n=0;n<e.length;n++)t.writeVarint(e[n])}function Vl(e,t){for(let n=0;n<e.length;n++)t.writeSVarint(e[n])}function Hl(e,t){for(let n=0;n<e.length;n++)t.writeFloat(e[n])}function Yl(e,t){for(let n=0;n<e.length;n++)t.writeDouble(e[n])}function Xl(e,t){for(let n=0;n<e.length;n++)t.writeBoolean(e[n])}function $l(e,t){for(let n=0;n<e.length;n++)t.writeFixed32(e[n])}function Kl(e,t){for(let n=0;n<e.length;n++)t.writeSFixed32(e[n])}function Zl(e,t){for(let n=0;n<e.length;n++)t.writeFixed64(e[n])}function Ql(e,t){for(let n=0;n<e.length;n++)t.writeSFixed64(e[n])}function Jl(e,t,n,r){let o=r;const i=e[t];let a=!1;Al(n.excludeValue)?a=n.excludeValue.split(",").findIndex(e=>e===i)>=0:n.excludeValue&&i===n.excludeValue&&(a=!0);let s=!0;if(n.includeValue)if(xl(n.includeValue))i!==n.includeValue&&(s=!1);else{const e=n.includeValue.split(",");e&&(s=e.indexOf(i)>=0)}if(s&&!a){const e=Il.fromOption(n);return o=Sl(o,e),o}return!s||a?n.children?(n.children.forEach(n=>{const r=n.filterField??t;o=Jl(e,r,n,o)}),o):void 0:o}u(Object.freeze({__proto__:null,buildTileURLParams:function(e,t,n,r){return{tileURL:decodeURIComponent(e).replace("{z}",String(r)).replace("{x}",String(t)).replace("{y}",String(n)),tileKey:t+"_"+n+"_"+r,requestedTile:{x:t,y:n,level:r}}},createFromMetadata:function(e,t,n,r){const o=e,i="{z}/{x}/{y}."+o.format;let a=n;n||(a=o.name);const s=new Map,u={urlTemplate:t.replace("metadata.json",i),layerName:a,vtlayers:s};if(u){if(o.minzoom&&(u.minimumLevel=Number(o.minzoom)),o.maxzoom&&(u.maximumLevel=Number(o.maxzoom)),o.bounds){const e=o.bounds.split(",").map(e=>Number(e));u.rectangle=pi.fromDegrees(e[0],e[1],e[2],e[3])}if(o.json){const e=JSON.parse(o.json);if(e){const t=e.vector_layers,n=e.tilestats.layers;t.forEach(e=>{const t=r[e.id];if(!t)return;const o=new b(e.id);o.minLevel=e.minzoom??0,e.maxzoom&&e.maxzoom>o.minLevel&&(o.maxLevel=e.maxzoom);const i=n.find(t=>t.layer===e.id);if(i){switch(i.geometry){case"Point":o.geoType=1,o.style=new Il(t);break;case"LineString":o.geoType=2,o.style=new Cl(t);break;case"Polygon":o.geoType=3}e.fields&&(o.fields=e.fields),s.set(e.id,o)}})}}}return u},createFromTilejson:function(e,t,n,r){const o=e;let i=t;t||(i=o.name);const a=new Map,s={urlTemplate:r.replace("tile.json","{z}/{x}/{y}.mvt"),layerName:i,vtlayers:a};if(s){if(s.minimumLevel=o.minzoom,s.maximumLevel=o.maxzoom,o.bounds){const e=o.bounds;s.rectangle=pi.fromDegrees(e[0],e[1],e[2],e[3])}o.vector_layers.forEach(e=>{const t=n[e.id];if(!t)return;const r=new b(e.id);switch(r.minLevel=e.minzoom??0,e.maxzoom&&e.maxzoom>r.minLevel&&(r.maxLevel=e.maxzoom),r.style=new Il(t),e.geometry_type){case"multipoint":case"point":r.geoType=1;break;case"line":r.geoType=2;break;case"polygon":r.geoType=3}e.fields&&(r.fields=e.fields),a.set(e.id,r)})}return s},doParseTile:async function(e){const t=await(Tr.fetchArrayBuffer({url:e})?.catch(()=>{console.log("",e)}));if(t)return new Dl(new ql(t))},getFeatureLabelOption:function(e,t,n,r){return Jl(t,n,r,Sl({},e))},loadVTileJson:async function(e){return await fetch(e).catch(t=>{console.warn("",e)}).then(e=>{if(e)return e.json()})}}));
