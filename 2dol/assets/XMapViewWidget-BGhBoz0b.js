import{I as L,J as O,K as E}from"./vendor-Cm8vbQLD.js";import{b as X}from"./vue-router-exp-BoJcrdOF.js";import{B as s,h as A}from"./xframelib-exp-Dokv845S.js";import{g as h,T as x,L as U,c as Y,t as N}from"./xgis-ol-exp-CTawL6iO.js";import{D as q,p as J,F as z,G as K}from"./ol-exp-DuIEpEAh.js";import{d as Z,_}from"./index-3mXAM2d5.js";import{S as Q}from"./SystemsEvent-DUQCZw_Q.js";import{d as R,r as u,w as ee,p as B,_ as F,X as S,$ as T,a3 as V,a0 as d,I as m,a2 as H,y as te,q as ae,Y as oe,a6 as I,J as ne,A as le,H as re,a1 as ie}from"./@vue-exp-CxZKVZL7.js";import"./@hprose-exp-DksTqdcd.js";import"./axios-exp-B_zfNCMU.js";import"./@iconify/vue-exp-CNvCUaPp.js";const se=R({name:"otherTool",props:{xmap:{type:Object},isguest:L().def(!1)},emits:["dragBoxFeature"],components:{},setup(e,{emit:o}){const f=u(""),g=u(""),c=u("");ee(()=>e.xmap,()=>{l=!1,v=!1,t=!1});let l=!1;function r(){l?g.value="background-color:#fff":g.value="background-color:#808080",l=!l,s.DebugLayer&&(s.Logger().info(s.DebugLayer,l,"调试网格图层"),s.DebugLayer.setVisible(l))}let t=!1;function b(){if(!e.xmap)return;const a=e.xmap.map;t?(a?.un("click",i),f.value="background-color:#fff"):(a?.on("click",i),f.value="background-color:#808080"),t=!t}function i(a){}const j=B(()=>{let a="";return h.dataPanel&&(a="background-color:#ccc"),a});function C(){const a=h.dataPanel;h.dataPanel=!a}const y=B(()=>e.isguest);function P(){if(!n)return;const a=n.getGeometry(),k=new z(a);s.DrawFeatureTool&&s.DrawFeatureTool.addFeature(k);const G=new K().writeFeature(k);h.dataPanel=!0,o("dragBoxFeature",G)}function w(){s.DrawFeatureTool&&s.DrawFeatureTool.clear()}let v=!1,n;function D(){if(!e.xmap)return;const a=e.xmap.map;v?(a&&(n&&(n.un("boxend",P),n.un("boxstart",w),a.removeInteraction(n)),w(),Z(Q.System_ImageKeyWord,"")),c.value="background-color:#fff"):(a&&(s.Message?.info("请按住Ctrl+鼠标左键拉框查询"),n=new q({condition:J}),a.addInteraction(n),n.on("boxend",P),n.on("boxstart",w)),c.value="background-color:#808080"),v=!v}return{selectXYZ:b,backgroundStyle:f,backSelectStyle:c,notification:O,toggleRowGrid:r,vectorbackStyle:g,dataPanelSelected:j,changedataPanel:C,isGuestComputed:y,drawSelect:D}}}),ue={class:"tool-container"},de={title:"列表"},ce={title:"反向定位"},pe={title:"网格图层"},me={title:"瓦片链接"};function fe(e,o,f,g,c,l){const r=F("Icon");return S(),T("ul",ue,[e.isGuestComputed?H("",!0):(S(),T("li",{key:0,onClick:o[0]||(o[0]=(...t)=>e.changedataPanel&&e.changedataPanel(...t)),style:V(e.dataPanelSelected)},[d("span",de,[m(r,{icon:"gis:map-legend-o"})])],4)),e.isGuestComputed?H("",!0):(S(),T("li",{key:1,onClick:o[1]||(o[1]=(...t)=>e.drawSelect&&e.drawSelect(...t)),style:V(e.backSelectStyle)},[d("span",ce,[m(r,{icon:"teenyicons:drag-outline"})])],4)),d("li",{onClick:o[2]||(o[2]=(...t)=>e.toggleRowGrid&&e.toggleRowGrid(...t)),style:V(e.vectorbackStyle)},[d("span",pe,[m(r,{icon:"geo:turf-point-grid"})])],4),d("li",{onClick:o[3]||(o[3]=(...t)=>e.selectXYZ&&e.selectXYZ(...t)),style:V(e.backgroundStyle)},[d("span",me,[m(r,{icon:"arcticons:urlsanitizer"})])],4)])}const ge=_(se,[["render",fe],["__scopeId","data-v-93fca2ea"],["__file","otherTool.vue"]]),ve=R({name:"xViewContainer",props:{},components:{SwipeToolBar:x,XMapView:U,OtherTool:ge},setup(e,{attrs:o,slots:f,emit:g}){const c=u(document.body.clientHeight),l=u(document.body.clientWidth),r=X(),t=u(),b=[{label:"经纬度",value:"C"},{label:"墨卡托",value:"W"}],i=u("C"),j=u(!0);r.query.id,r.query?.type?.toString();const C=u();let y;function P(p){}function w(p){y=p.xmap,C.value=y,s.xMap=p.xmap,Y.eventOn(N.LAYER_OPACITY_CHANGED,P)}let v="C",n;te(()=>{A.windowResizeHandler(()=>{c.value=document.body.clientHeight,l.value=document.body.clientWidth})}),ae(()=>{let p=y?.map;p&&p.dispose()});const D=B(()=>h.dataPanel);let a=[],k=u(!1);const G=B(()=>a.length>0);function M(p){const $=i.value;$===v?t.value=n:$==="W"?t.value="EPSG:3857":t.value="EPSG:4326"}function W(p){switch(i.value){case"C":break;case"W":break;default:n.getUnits();break}}return{dataPanelVisible:D,visibleBatchDelete:G,isFinished:k,mapInitedHandler:w,layoutContentHeight:c,layoutContentWidth:l,mapRef:C,viewProjectionRef:t,enableXMap:j,PrjValue:i,prjOptions:b,prjChageHandler:M,dragSearchHandler:W}}}),be={class:"datapanel"},ye={style:{position:"relative"}},we={style:{position:"relative","margin-top":"10px"}},he={class:"prjSelectBar q-gutter-sm"};function Se(e,o,f,g,c,l){const r=F("SwipeToolBar"),t=F("OtherTool"),b=F("XMapView");return S(),T(ne,null,[e.enableXMap?(S(),oe(b,{key:0,hasLayerTree:!0,viewHeight:e.layoutContentHeight,viewProjection:e.viewProjectionRef,viewWidth:e.layoutContentWidth,initTDTLayers:["vec_c","cva_c"],onMapInited:e.mapInitedHandler},{mapLeftPanelGroup:I(()=>[le(d("div",be,[ie(e.$slots,"dataPanel",{},void 0,!0)],512),[[re,e.dataPanelVisible]])]),extendMenuGroup:I(()=>[d("div",ye,[m(r,{xmap:e.mapRef},null,8,["xmap"])]),d("div",we,[m(t,{xmap:e.mapRef,onDragBoxFeature:e.dragSearchHandler},null,8,["xmap","onDragBoxFeature"])])]),_:3},8,["viewHeight","viewProjection","viewWidth","onMapInited"])):H("",!0),d("div",he,[m(E,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[0]||(o[0]=i=>e.PrjValue=i),e.prjChageHandler],val:"C",label:"经纬度"},null,8,["modelValue","onUpdate:modelValue"]),m(E,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[1]||(o[1]=i=>e.PrjValue=i),e.prjChageHandler],val:"W",label:"墨卡托"},null,8,["modelValue","onUpdate:modelValue"])])],64)}const Me=_(ve,[["render",Se],["__scopeId","data-v-4b25b688"],["__file","XMapViewWidget.vue"]]);export{Me as default};
