import{d as w,r as u,b as M,B as x,O as f,S as g,F as L,a5 as S,Y as E,U as B,P as R,a6 as V,a2 as $,ad as z,R as A,D as O,K as U,c as F,A as H}from"./@vue-exp-18LRBxdm.js";import{F as r,y as b}from"./xframelib-exp-B5TZbF78.js";import{m as _,e as N,f as T,M as v,_ as j}from"./index-Dxssf89i.js";import{u as K}from"./vue-router-exp-CvNwyAs-.js";import"./axios-exp-C7rfqWEd.js";import"./vendor-BjjxFmO4.js";import"./ol-exp-BZzGrai6.js";import"./@iconify/vue-exp-C65O8cJc.js";import"./monaco-editor-exp-BNK_u0iZ.js";function P(a){a.selected=!a.selected}function Y(a){r.LayerManager.removeLayerItem("artificialLayer")}function q(a,n,s){r.LayerManager.addLayerItem({id:a,name:n},s)}function G(a){const n=a.tag?.layoutID,s=a.tag?.widgetID;n&&s&&n.split(",").forEach(d=>{const i=r.LayoutMap.get(d);i&&(a.selected?i.unloadWidget(s):i.loadWidget(s))})}const k=Object.freeze(Object.defineProperty({__proto__:null,AddLayerItem:q,ControlSkyVisible:P,RemoveLayerItem:Y,twoMapScreenControl:G},Symbol.toStringTag,{value:"Module"})),J={class:"menuBar"},Q=["title","onClick"],X=w({__name:"index",props:{layoutID:{type:String,default:"default"},menuData:{type:Array,default:_},iconColor:{type:String,default:"#f00"},itemSize:{type:String,default:"50px"}},setup(a){z(e=>({"21bb504e":a.itemSize+10,b1972080:s.value,b990f94a:a.itemSize}));const n=a,s=u(_.length),l=K(),i=u(new Map);function D(e){switch(e.type){case v.URL:window.open(e.path,"_blank");break;case v.Route:if(e.blank){if(e.path){let o=l.resolve({path:e.path});window.open(o.href,"_blank")}}else e.path&&l.push({path:e.path});break;case v.Action:const t=e.path;t&&k[t]&&(k[t](e),e.selected!=null&&(e.selected=!e.selected,i.value.set(e.name,e.selected)));break;case v.Widget:if(e.path){const o=r.LayoutMap.get(n.layoutID);if(!o){r.Message.warn(`LayoutID:${n.layoutID}的Manager不存在`);return}h(o,e),e.selected=!e.selected,i.value.set(e.name,e.selected)}else r.Message.warn(`加载${e.name} Widget:缺少WidgetID!`);break}}function h(e,t){t.path&&(t.selected?(t.unload?(r.Logger().info("卸载widget: "+t.path),e.unloadWidget(t.path)):(r.Logger().info("隐藏widget: "+t.path),e.changeWidgetVisible(t.path,!1)),t.children&&t.children.forEach(o=>{o.selected&&(r.Logger().info(`递归控制${t.path}的子Widget:`+o.path),h(e,o),o.selected=!o.selected)})):e.isWidgetLoaded(t.path)?(r.Logger().info("显示widget: "+t.path),e.changeWidgetVisible(t.path,!0)):(e.loadWidget(t.path),r.Logger().info("加载Widget："+t.path)))}function p(e){return i.value?.has(e.name)&&i.value.get(e.name)?"menuBarItem active":"menuBarItem"}function y(e){if(e.layoutID===n.layoutID){const t=e.widgetID,o=n.menuData.find(c=>c.type===0&&c.path===t&&c.unload!=!1);o&&(o.selected=!1,i.value.delete(o.name))}}return M(()=>{N(b.WidgetUnLoadedEvent,y)}),x(()=>{T(b.WidgetUnLoadedEvent,y)}),(e,t)=>{const o=A("Icon");return f(),g("ul",J,[(f(!0),g(L,null,S(a.menuData,(c,W)=>(f(),g("li",{key:W,class:E(p(c))},[B("span",{title:c.name,onClick:m=>D(c)},[c.icon?(f(),R(o,{key:0,icon:c.icon,color:a.iconColor},null,8,["icon","color"])):(f(),g(L,{key:1},[V($(c.name),1)],64))],8,Q)],2))),128))])}}}),Z=j(X,[["__scopeId","data-v-daa10b1c"]]);function C(a,n){let s;for(const l of a)if(l.path===n){s=l;break}else if(l.children){const d=C(l.children,n);if(d){s=d;break}}return s}const I=["id"],ce=w({__name:"index",setup(a,{expose:n}){const s=u([]),l=u(""),d=H(),i=d?.proxy?.$options.id,D=d?.proxy?.$options.layoutID,h=u(i);M(()=>{l.value=D;const e=C(_,i);e&&s.value.push(...e.children)});const p=u(!0);function y(e=!1){p.value=e}return n({changeVisible:y,isShow:p}),(e,t)=>(f(),g("div",{id:h.value},[O(F(Z,{menuData:s.value,layoutID:l.value,class:"currentChildMenu"},null,8,["menuData","layoutID"]),[[U,p.value]])],8,I))}});export{ce as default};
