import{ac as x,$ as E}from"./vendor-BjjxFmO4.js";import{b as O}from"./vue-router-exp-CvNwyAs-.js";import{F as s,c as X}from"./xframelib-exp-B5TZbF78.js";import{I as _,q as L,c as A,T as U}from"./xgis-ol-exp-CshjZaOS.js";import{N,Q as q,F as Y,G as z}from"./ol-exp-BZzGrai6.js";import{d as K,_ as I}from"./index-Dxssf89i.js";import{S as Z}from"./SystemsEvent-DUQCZw_Q.js";import{d as R,r as u,w as J,a as T,R as V,O as S,S as F,X as k,U as d,c as p,W as D,b as Q,o as ee,P as ae,_ as H,F as te,D as oe,K as ne,V as le}from"./@vue-exp-18LRBxdm.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-C65O8cJc.js";import"./monaco-editor-exp-BNK_u0iZ.js";const re=R({name:"otherTool",props:{xmap:{type:Object},isguest:x().def(!1)},emits:["dragBoxFeature"],components:{},setup(e,{emit:o}){const g=u(""),v=u(""),c=u("");J(()=>e.xmap,()=>{l=!1,b=!1,a=!1});let l=!1;function r(){l?v.value="background-color:#fff":v.value="background-color:#808080",l=!l,s.DebugLayer&&(s.Logger().info(s.DebugLayer,l,"调试网格图层"),s.DebugLayer.setVisible(l))}let a=!1;function y(){if(!e.xmap)return;const t=e.xmap.map;a?(t?.un("click",i),g.value="background-color:#fff"):(t?.on("click",i),g.value="background-color:#808080"),a=!a}function i(t){}const j=T(()=>{let t="";return e.xmap&&e.xmap.mapMenuState.dataPanel&&(t="background-color:#ccc"),t});function h(){if(e.xmap){const t=e.xmap.mapMenuState.dataPanel;e.xmap.mapMenuState.dataPanel=!t}}const f=T(()=>e.isguest);function C(){if(!n)return;const t=n.getGeometry(),P=new Y(t);s.DrawFeatureTool&&s.DrawFeatureTool.addFeature(P);const M=new z().writeFeature(P);e.xmap&&(e.xmap.mapMenuState.dataPanel=!0),o("dragBoxFeature",M)}function w(){s.DrawFeatureTool&&s.DrawFeatureTool.clear()}let b=!1,n;function B(){if(!e.xmap)return;const t=e.xmap.map;b?(t&&(n&&(n.un("boxend",C),n.un("boxstart",w),t.removeInteraction(n)),w(),K(Z.System_ImageKeyWord,"")),c.value="background-color:#fff"):(t&&(s.Message?.info("请按住Ctrl+鼠标左键拉框查询"),n=new N({condition:q}),t.addInteraction(n),n.on("boxend",C),n.on("boxstart",w)),c.value="background-color:#808080"),b=!b}return{selectXYZ:y,backgroundStyle:g,backSelectStyle:c,toggleRowGrid:r,vectorbackStyle:v,dataPanelSelected:j,changedataPanel:h,isGuestComputed:f,drawSelect:B}}}),ie={class:"tool-container"},se={title:"列表"},ue={title:"反向定位"},de={title:"网格图层"},ce={title:"瓦片链接"};function me(e,o,g,v,c,l){const r=V("Icon");return S(),F("ul",ie,[e.isGuestComputed?D("",!0):(S(),F("li",{key:0,onClick:o[0]||(o[0]=(...a)=>e.changedataPanel&&e.changedataPanel(...a)),style:k(e.dataPanelSelected)},[d("span",se,[p(r,{icon:"gis:map-legend-o"})])],4)),e.isGuestComputed?D("",!0):(S(),F("li",{key:1,onClick:o[1]||(o[1]=(...a)=>e.drawSelect&&e.drawSelect(...a)),style:k(e.backSelectStyle)},[d("span",ue,[p(r,{icon:"teenyicons:drag-outline"})])],4)),d("li",{onClick:o[2]||(o[2]=(...a)=>e.toggleRowGrid&&e.toggleRowGrid(...a)),style:k(e.vectorbackStyle)},[d("span",de,[p(r,{icon:"geo:turf-point-grid"})])],4),d("li",{onClick:o[3]||(o[3]=(...a)=>e.selectXYZ&&e.selectXYZ(...a)),style:k(e.backgroundStyle)},[d("span",ce,[p(r,{icon:"arcticons:urlsanitizer"})])],4)])}const pe=I(re,[["render",me],["__scopeId","data-v-5a1316e0"]]),fe=R({name:"xViewContainer",props:{},components:{SwipeToolBar:_,XMapView:L,OtherTool:pe},setup(e,{attrs:o,slots:g,emit:v}){const c=u(document.body.clientHeight),l=u(document.body.clientWidth),r=O(),a=u(),y=[{label:"经纬度",value:"C"},{label:"墨卡托",value:"W"}],i=u("C"),j=u(!0);r.query.id,r.query?.type?.toString();const h=u();let f;function C(m){}function w(m){f=m.xmap,h.value=f,s.XMap=m.xmap,A.eventOn(U.LAYER_OPACITY_CHANGED,C)}let b="C",n;Q(()=>{X.windowResizeHandler(()=>{c.value=document.body.clientHeight,l.value=document.body.clientWidth})}),ee(()=>{let m=f?.map;m&&m.dispose()});const B=T(()=>f&&f.mapMenuState.dataPanel);let t=[],P=u(!1);const M=T(()=>t.length>0);function G(m){const $=i.value;$===b?a.value=n:$==="W"?a.value="EPSG:3857":a.value="EPSG:4326"}function W(m){switch(i.value){case"C":break;case"W":break;default:n.getUnits();break}}return{dataPanelVisible:B,visibleBatchDelete:M,isFinished:P,mapInitedHandler:w,layoutContentHeight:c,layoutContentWidth:l,mapRef:h,viewProjectionRef:a,enableXMap:j,PrjValue:i,prjOptions:y,prjChageHandler:G,dragSearchHandler:W}}}),ge={class:"datapanel"},ve={style:{position:"relative"}},be={style:{position:"relative","margin-top":"10px"}},ye={class:"prjSelectBar q-gutter-sm"};function we(e,o,g,v,c,l){const r=V("SwipeToolBar"),a=V("OtherTool"),y=V("XMapView");return S(),F(te,null,[e.enableXMap?(S(),ae(y,{key:0,hasLayerTree:!0,viewHeight:e.layoutContentHeight,viewProjection:e.viewProjectionRef,viewWidth:e.layoutContentWidth,initTDTLayers:["vec_c","cva_c"],onMapInited:e.mapInitedHandler},{mapLeftPanelGroup:H(()=>[oe(d("div",ge,[le(e.$slots,"dataPanel",{},void 0,!0)],512),[[ne,e.dataPanelVisible]])]),extendMenuGroup:H(()=>[d("div",ve,[p(r,{xmap:e.mapRef},null,8,["xmap"])]),d("div",be,[p(a,{xmap:e.mapRef,onDragBoxFeature:e.dragSearchHandler},null,8,["xmap","onDragBoxFeature"])])]),_:3},8,["viewHeight","viewProjection","viewWidth","onMapInited"])):D("",!0),d("div",ye,[p(E,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[0]||(o[0]=i=>e.PrjValue=i),e.prjChageHandler],val:"C",label:"经纬度"},null,8,["modelValue","onUpdate:modelValue"]),p(E,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[1]||(o[1]=i=>e.PrjValue=i),e.prjChageHandler],val:"W",label:"墨卡托"},null,8,["modelValue","onUpdate:modelValue"])])],64)}const De=I(fe,[["render",we],["__scopeId","data-v-9e393ef3"]]);export{De as default};
