import{G as g,a as x,x as S,b as w}from"./ol-exp-BZzGrai6.js";import{F as m,c as F,g as E,n as G}from"./xframelib-exp-B5TZbF78.js";import{ab as d}from"./vendor-BjjxFmO4.js";import{r as _}from"./xgis-ol-exp-CshjZaOS.js";import{d as b,b as M}from"./@vue-exp-18LRBxdm.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-C65O8cJc.js";const W=b({__name:"DragFileLoadLayerWidget",setup(I){const{importContent:L,exportDatasetAsGeoJSON:u,setDatasetCrsInfo:v,exportFileContent:A,importGeoJSON:H}=d.internal;let n;async function j(e){if(!(!e||e.length===0)){e.length;const o=Array.from(e),t=await d.import2DFiles(o);if(t&&t.length>0){const r=m.XMap,s=r.MapView.getProjection();t.forEach(c=>{const l=u(c.dataset,{}),f=new g().readFeatures(l,{dataProjection:"EPSG:4326",featureProjection:s}),i=new x({features:f}),p=i.getExtent(),y=_.getExtentFromTransform(p,s,"EPSG:4326"),P=S(y),a=c.dataset.layers[0]?.name??E();if(n=new w({source:i,properties:{center:P,bounds:y,lyrID:a,lyrName:a,lyrType:"vector",lyrGroup:a}}),n){r.map.addLayer(n);const h={id:a,name:a,alias:"",group:a,minZoom:1,maxZoom:24,visible:!0,opacity:1,type:"vector"};r.registerLayer(n,h)}})}}}async function D(e){if(G(e))m.Message.info(e);else if(Array.isArray(e)){const o=e;if(o.length===0)return;const t=await d.import2DFiles(o);if(t&&t.length>0){const r=m.XMap,s=r.MapView.getProjection();t.forEach(c=>{const l=u(c.dataset,{}),f=new g().readFeatures(l,{dataProjection:"EPSG:4326",featureProjection:s}),i=new x({features:f}),p=new w({source:i});p&&r.map.addLayer(p)})}}}return M(()=>{m.XMap&&(F.bindDropFileHanlder("map",j),F.onPasteHandler(D))}),(e,o)=>null}});export{W as default};
