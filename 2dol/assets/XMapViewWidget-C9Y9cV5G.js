import{a6 as O,a2 as H}from"./vendor-71nkuPi7.js";import{b as X}from"./vue-router-exp-ButTbbfG.js";import{B as s,h as L}from"./xframelib-exp-Dh6eGY1k.js";import{b as h,p as A,c as x,d as U,e as Y}from"./xgis-ol-exp-DhNIKuy9.js";import{x as N,y as z,c as q,G as Q}from"./ol-exp-64kmBCi6.js";import{d as Z,_ as I}from"./index-Cl6kQhfR.js";import{S as J}from"./SystemsEvent-DUQCZw_Q.js";import{d as R,r as u,w as K,a as j,S as F,P as S,U as B,Y as V,V as d,c as m,X as G,b as ee,o as te,Q as oe,$ as W,F as ae,E as ne,L as le,W as re}from"./@vue-exp-Mkau1HGZ.js";import"./@hprose-exp-B7dHRfib.js";import"./axios-exp-C7rfqWEd.js";import"./@iconify/vue-exp-DwwUNauw.js";import"./monaco-editor-exp-B01XOe8A.js";const ie=R({name:"otherTool",props:{xmap:{type:Object},isguest:O().def(!1)},emits:["dragBoxFeature"],components:{},setup(e,{emit:a}){const f=u(""),g=u(""),c=u("");K(()=>e.xmap,()=>{l=!1,v=!1,t=!1});let l=!1;function r(){l?g.value="background-color:#fff":g.value="background-color:#808080",l=!l,s.DebugLayer&&(s.Logger().info(s.DebugLayer,l,"调试网格图层"),s.DebugLayer.setVisible(l))}let t=!1;function b(){if(!e.xmap)return;const o=e.xmap.map;t?(o?.un("click",i),f.value="background-color:#fff"):(o?.on("click",i),f.value="background-color:#808080"),t=!t}function i(o){}const T=j(()=>{let o="";return h.dataPanel&&(o="background-color:#ccc"),o});function C(){const o=h.dataPanel;h.dataPanel=!o}const y=j(()=>e.isguest);function P(){if(!n)return;const o=n.getGeometry(),k=new q(o);s.DrawFeatureTool&&s.DrawFeatureTool.addFeature(k);const E=new Q().writeFeature(k);h.dataPanel=!0,a("dragBoxFeature",E)}function w(){s.DrawFeatureTool&&s.DrawFeatureTool.clear()}let v=!1,n;function D(){if(!e.xmap)return;const o=e.xmap.map;v?(o&&(n&&(n.un("boxend",P),n.un("boxstart",w),o.removeInteraction(n)),w(),Z(J.System_ImageKeyWord,"")),c.value="background-color:#fff"):(o&&(s.Message?.info("请按住Ctrl+鼠标左键拉框查询"),n=new N({condition:z}),o.addInteraction(n),n.on("boxend",P),n.on("boxstart",w)),c.value="background-color:#808080"),v=!v}return{selectXYZ:b,backgroundStyle:f,backSelectStyle:c,notification,toggleRowGrid:r,vectorbackStyle:g,dataPanelSelected:T,changedataPanel:C,isGuestComputed:y,drawSelect:D}}}),se={class:"tool-container"},ue={title:"列表"},de={title:"反向定位"},ce={title:"网格图层"},pe={title:"瓦片链接"};function me(e,a,f,g,c,l){const r=F("Icon");return S(),B("ul",se,[e.isGuestComputed?G("",!0):(S(),B("li",{key:0,onClick:a[0]||(a[0]=(...t)=>e.changedataPanel&&e.changedataPanel(...t)),style:V(e.dataPanelSelected)},[d("span",ue,[m(r,{icon:"gis:map-legend-o"})])],4)),e.isGuestComputed?G("",!0):(S(),B("li",{key:1,onClick:a[1]||(a[1]=(...t)=>e.drawSelect&&e.drawSelect(...t)),style:V(e.backSelectStyle)},[d("span",de,[m(r,{icon:"teenyicons:drag-outline"})])],4)),d("li",{onClick:a[2]||(a[2]=(...t)=>e.toggleRowGrid&&e.toggleRowGrid(...t)),style:V(e.vectorbackStyle)},[d("span",ce,[m(r,{icon:"geo:turf-point-grid"})])],4),d("li",{onClick:a[3]||(a[3]=(...t)=>e.selectXYZ&&e.selectXYZ(...t)),style:V(e.backgroundStyle)},[d("span",pe,[m(r,{icon:"arcticons:urlsanitizer"})])],4)])}const fe=I(ie,[["render",me],["__scopeId","data-v-b75130d2"],["__file","otherTool.vue"]]),ge=R({name:"xViewContainer",props:{},components:{SwipeToolBar:A,XMapView:x,OtherTool:fe},setup(e,{attrs:a,slots:f,emit:g}){const c=u(document.body.clientHeight),l=u(document.body.clientWidth),r=X(),t=u(),b=[{label:"经纬度",value:"C"},{label:"墨卡托",value:"W"}],i=u("C"),T=u(!0);r.query.id,r.query?.type?.toString();const C=u();let y;function P(p){}function w(p){y=p.xmap,C.value=y,s.xMap=p.xmap,U.eventOn(Y.LAYER_OPACITY_CHANGED,P)}let v="C",n;ee(()=>{L.windowResizeHandler(()=>{c.value=document.body.clientHeight,l.value=document.body.clientWidth})}),te(()=>{let p=y?.map;p&&p.dispose()});const D=j(()=>h.dataPanel);let o=[],k=u(!1);const E=j(()=>o.length>0);function M(p){const $=i.value;$===v?t.value=n:$==="W"?t.value="EPSG:3857":t.value="EPSG:4326"}function _(p){switch(i.value){case"C":break;case"W":break;default:n.getUnits();break}}return{dataPanelVisible:D,visibleBatchDelete:E,isFinished:k,mapInitedHandler:w,layoutContentHeight:c,layoutContentWidth:l,mapRef:C,viewProjectionRef:t,enableXMap:T,PrjValue:i,prjOptions:b,prjChageHandler:M,dragSearchHandler:_}}}),ve={class:"datapanel"},be={style:{position:"relative"}},ye={style:{position:"relative","margin-top":"10px"}},we={class:"prjSelectBar q-gutter-sm"};function he(e,a,f,g,c,l){const r=F("SwipeToolBar"),t=F("OtherTool"),b=F("XMapView");return S(),B(ae,null,[e.enableXMap?(S(),oe(b,{key:0,hasLayerTree:!0,viewHeight:e.layoutContentHeight,viewProjection:e.viewProjectionRef,viewWidth:e.layoutContentWidth,initTDTLayers:["vec_c","cva_c"],onMapInited:e.mapInitedHandler},{mapLeftPanelGroup:W(()=>[ne(d("div",ve,[re(e.$slots,"dataPanel",{},void 0,!0)],512),[[le,e.dataPanelVisible]])]),extendMenuGroup:W(()=>[d("div",be,[m(r,{xmap:e.mapRef},null,8,["xmap"])]),d("div",ye,[m(t,{xmap:e.mapRef,onDragBoxFeature:e.dragSearchHandler},null,8,["xmap","onDragBoxFeature"])])]),_:3},8,["viewHeight","viewProjection","viewWidth","onMapInited"])):G("",!0),d("div",we,[m(H,{modelValue:e.PrjValue,"onUpdate:modelValue":[a[0]||(a[0]=i=>e.PrjValue=i),e.prjChageHandler],val:"C",label:"经纬度"},null,8,["modelValue","onUpdate:modelValue"]),m(H,{modelValue:e.PrjValue,"onUpdate:modelValue":[a[1]||(a[1]=i=>e.PrjValue=i),e.prjChageHandler],val:"W",label:"墨卡托"},null,8,["modelValue","onUpdate:modelValue"])])],64)}const Me=I(ge,[["render",he],["__scopeId","data-v-4b25b688"],["__file","XMapViewWidget.vue"]]);export{Me as default};
