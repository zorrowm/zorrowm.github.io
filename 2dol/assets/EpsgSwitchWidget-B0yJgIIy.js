import{K as E,$ as b,O as u,a8 as p,a9 as G,a6 as I,aa as L,H as M,J as U}from"./vendor-BjjxFmO4.js";import{r as w}from"./xgis-ol-exp-CshjZaOS.js";import{F as m,p as y,D}from"./xframelib-exp-B5TZbF78.js";import{d as R,r as V,b as N,w as T,O as f,S as B,D as S,P,_ as t,c as a,a6 as c,a2 as W,W as z,ab as X}from"./@vue-exp-18LRBxdm.js";import"./ol-exp-BZzGrai6.js";import"./@iconify/vue-exp-C65O8cJc.js";import"./axios-exp-C7rfqWEd.js";const O={class:"q-pa-sm no-wrap"},h=R({__name:"EpsgSwitchWidget",setup($){const l=V(),i=V(""),d=V("");function _(){if(!i.value)return;const s=i.value.toLocaleLowerCase();let e="";if(s.startsWith("epsg:"))e=s.substring(5);else{const n=Number(s);y(n)&&(e=n.toString())}if(!e){m.Message.warn("无效的EPSG代码！");return}const r=m.Config.ServiceURL.EPSGServiceURL??"https://epsg.gis.digsur.com",o=m.XMap;D("/epsg/"+e,r).then(n=>{if(n.data){d.value="",l.value="other";const v=n.data,x="EPSG:"+v.code,j=(v.kind==="projected"?v.pbox:v.bbox).split(",").map(Q=>Number(Q)),C={epsg:x,prjExtent:j,proj4:v.proj4},k=w.getProjection(C);k&&(d.value=x,o.setProjection(k),o.zoomTo(j))}else m.Message.warn("查询EPSG为空")})}let g;return N(()=>{if(m.XMap){const s=m.XMap,e=s.MapView.getProjection().getCode();switch(e){case"EPSG:4490":g="EPSG:4490",l.value="EPSG:4326";break;case"EPSG:4326":l.value="EPSG:4326";break;case"EPSG:3857":l.value="EPSG:3857";break;default:d.value=e,l.value="其他";break}T(()=>l.value,r=>{if(r)switch(r){case"EPSG:4326":g==="EPSG:4490"?s.setProjection(g):s.setProjection(r);break;case"EPSG:3857":s.setProjection(r);break;case"other":if(d.value){const o=w.getProjection({epsg:d.value});if(o){const n=o.getExtent();s.setProjection(o),s.zoomTo(n)}}break}})}}),(s,e)=>{const r=X("media");return f(),B("div",O,[S((f(),P(U,null,{default:t(()=>[S((f(),P(E,{tag:"label"},{default:t(()=>[a(u,{avatar:""},{default:t(()=>[a(b,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),val:"EPSG:4326",color:"primary"},null,8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(p,null,{default:t(()=>e[5]||(e[5]=[c("经纬度")])),_:1}),a(p,{caption:""},{default:t(()=>e[6]||(e[6]=[c("EPSG:4326")])),_:1})]),_:1})]),_:1})),[[G]]),S((f(),P(E,{tag:"label"},{default:t(()=>[a(u,{avatar:""},{default:t(()=>[a(b,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),val:"EPSG:3857",color:"primary"},null,8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(p,null,{default:t(()=>e[7]||(e[7]=[c("Web墨卡托")])),_:1}),a(p,{caption:""},{default:t(()=>e[8]||(e[8]=[c("EPSG:3857 ")])),_:1})]),_:1})]),_:1})),[[G]]),S((f(),P(E,{tag:"label"},{default:t(()=>[a(u,{avatar:""},{default:t(()=>[a(b,{modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value=o),val:"other",color:"primary"},null,8,["modelValue"])]),_:1}),a(u,null,{default:t(()=>[a(p,null,{default:t(()=>e[9]||(e[9]=[c("其他")])),_:1}),a(p,{caption:""},{default:t(()=>[c(W(d.value),1)]),_:1})]),_:1}),a(u,{side:""},{default:t(()=>[a(I,{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value=o),label:"输入EPSG查询",dense:!0},{append:t(()=>[i.value!==""?(f(),P(L,{key:0,name:"close",onClick:e[3]||(e[3]=o=>i.value=""),class:"cursor-pointer"})):z("",!0)]),after:t(()=>[a(M,{round:"",dense:"",flat:"",icon:"search",style:{"z-index":"10"},onClick:_})]),_:1},8,["modelValue"])]),_:1})]),_:1})),[[G]])]),_:1})),[[r,"row.gt.sm"]])])}}});export{h as default};
