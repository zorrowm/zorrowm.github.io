import{a7 as X,a8 as O,a3 as $}from"./vendor-CcHNtcKJ.js";import{b as L}from"./vue-router-exp-B0kidEOa.js";import{B as s,h as A}from"./xframelib-exp-CxzDUbp4.js";import{I as h,W as x,X as U,H as Y,p as N}from"./xgis-ol-exp-DABivj7e.js";import{w as q,x as z,c as Z,G as J}from"./ol-exp-DkhKL1MQ.js";import{d as K,_ as W}from"./index-Dh7qfFcw.js";import{S as Q}from"./SystemsEvent-DUQCZw_Q.js";import{d as _,r as u,w as ee,a as j,_ as F,X as S,$ as B,a3 as V,a0 as d,c as m,a2 as E,b as ae,o as te,Y as oe,a6 as I,F as ne,E as le,L as re,a1 as ie}from"./@vue-exp-DTehQd6t.js";import"./@hprose-exp-CYjcO8Nw.js";import"./axios-exp-B_zfNCMU.js";import"./@iconify/vue-exp-Ct1khs4G.js";const se=_({name:"otherTool",props:{xmap:{type:Object},isguest:X().def(!1)},emits:["dragBoxFeature"],components:{},setup(e,{emit:o}){const f=u(""),g=u(""),c=u("");ee(()=>e.xmap,()=>{l=!1,v=!1,a=!1});let l=!1;function r(){l?g.value="background-color:#fff":g.value="background-color:#808080",l=!l,s.DebugLayer&&(s.Logger().info(s.DebugLayer,l,"调试网格图层"),s.DebugLayer.setVisible(l))}let a=!1;function b(){if(!e.xmap)return;const t=e.xmap.map;a?(t?.un("click",i),f.value="background-color:#fff"):(t?.on("click",i),f.value="background-color:#808080"),a=!a}function i(t){}const T=j(()=>{let t="";return h.dataPanel&&(t="background-color:#ccc"),t});function C(){const t=h.dataPanel;h.dataPanel=!t}const w=j(()=>e.isguest);function P(){if(!n)return;const t=n.getGeometry(),k=new Z(t);s.DrawFeatureTool&&s.DrawFeatureTool.addFeature(k);const D=new J().writeFeature(k);h.dataPanel=!0,o("dragBoxFeature",D)}function y(){s.DrawFeatureTool&&s.DrawFeatureTool.clear()}let v=!1,n;function H(){if(!e.xmap)return;const t=e.xmap.map;v?(t&&(n&&(n.un("boxend",P),n.un("boxstart",y),t.removeInteraction(n)),y(),K(Q.System_ImageKeyWord,"")),c.value="background-color:#fff"):(t&&(s.Message?.info("请按住Ctrl+鼠标左键拉框查询"),n=new q({condition:z}),t.addInteraction(n),n.on("boxend",P),n.on("boxstart",y)),c.value="background-color:#808080"),v=!v}return{selectXYZ:b,backgroundStyle:f,backSelectStyle:c,notification:O,toggleRowGrid:r,vectorbackStyle:g,dataPanelSelected:T,changedataPanel:C,isGuestComputed:w,drawSelect:H}}}),ue={class:"tool-container"},de={title:"列表"},ce={title:"反向定位"},pe={title:"网格图层"},me={title:"瓦片链接"};function fe(e,o,f,g,c,l){const r=F("Icon");return S(),B("ul",ue,[e.isGuestComputed?E("",!0):(S(),B("li",{key:0,onClick:o[0]||(o[0]=(...a)=>e.changedataPanel&&e.changedataPanel(...a)),style:V(e.dataPanelSelected)},[d("span",de,[m(r,{icon:"gis:map-legend-o"})])],4)),e.isGuestComputed?E("",!0):(S(),B("li",{key:1,onClick:o[1]||(o[1]=(...a)=>e.drawSelect&&e.drawSelect(...a)),style:V(e.backSelectStyle)},[d("span",ce,[m(r,{icon:"teenyicons:drag-outline"})])],4)),d("li",{onClick:o[2]||(o[2]=(...a)=>e.toggleRowGrid&&e.toggleRowGrid(...a)),style:V(e.vectorbackStyle)},[d("span",pe,[m(r,{icon:"geo:turf-point-grid"})])],4),d("li",{onClick:o[3]||(o[3]=(...a)=>e.selectXYZ&&e.selectXYZ(...a)),style:V(e.backgroundStyle)},[d("span",me,[m(r,{icon:"arcticons:urlsanitizer"})])],4)])}const ge=W(se,[["render",fe],["__scopeId","data-v-93fca2ea"],["__file","otherTool.vue"]]),ve=_({name:"xViewContainer",props:{},components:{SwipeToolBar:x,XMapView:U,OtherTool:ge},setup(e,{attrs:o,slots:f,emit:g}){const c=u(document.body.clientHeight),l=u(document.body.clientWidth),r=L(),a=u(),b=[{label:"经纬度",value:"C"},{label:"墨卡托",value:"W"}],i=u("C"),T=u(!0);r.query.id,r.query?.type?.toString();const C=u();let w;function P(p){}function y(p){w=p.xmap,C.value=w,s.xMap=p.xmap,Y.eventOn(N.LAYER_OPACITY_CHANGED,P)}let v="C",n;ae(()=>{A.windowResizeHandler(()=>{c.value=document.body.clientHeight,l.value=document.body.clientWidth})}),te(()=>{let p=w?.map;p&&p.dispose()});const H=j(()=>h.dataPanel);let t=[],k=u(!1);const D=j(()=>t.length>0);function G(p){const M=i.value;M===v?a.value=n:M==="W"?a.value="EPSG:3857":a.value="EPSG:4326"}function R(p){switch(i.value){case"C":break;case"W":break;default:n.getUnits();break}}return{dataPanelVisible:H,visibleBatchDelete:D,isFinished:k,mapInitedHandler:y,layoutContentHeight:c,layoutContentWidth:l,mapRef:C,viewProjectionRef:a,enableXMap:T,PrjValue:i,prjOptions:b,prjChageHandler:G,dragSearchHandler:R}}}),be={class:"datapanel"},we={style:{position:"relative"}},ye={style:{position:"relative","margin-top":"10px"}},he={class:"prjSelectBar q-gutter-sm"};function Se(e,o,f,g,c,l){const r=F("SwipeToolBar"),a=F("OtherTool"),b=F("XMapView");return S(),B(ne,null,[e.enableXMap?(S(),oe(b,{key:0,hasLayerTree:!0,viewHeight:e.layoutContentHeight,viewProjection:e.viewProjectionRef,viewWidth:e.layoutContentWidth,initTDTLayers:["vec_c","cva_c"],onMapInited:e.mapInitedHandler},{mapLeftPanelGroup:I(()=>[le(d("div",be,[ie(e.$slots,"dataPanel",{},void 0,!0)],512),[[re,e.dataPanelVisible]])]),extendMenuGroup:I(()=>[d("div",we,[m(r,{xmap:e.mapRef},null,8,["xmap"])]),d("div",ye,[m(a,{xmap:e.mapRef,onDragBoxFeature:e.dragSearchHandler},null,8,["xmap","onDragBoxFeature"])])]),_:3},8,["viewHeight","viewProjection","viewWidth","onMapInited"])):E("",!0),d("div",he,[m($,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[0]||(o[0]=i=>e.PrjValue=i),e.prjChageHandler],val:"C",label:"经纬度"},null,8,["modelValue","onUpdate:modelValue"]),m($,{modelValue:e.PrjValue,"onUpdate:modelValue":[o[1]||(o[1]=i=>e.PrjValue=i),e.prjChageHandler],val:"W",label:"墨卡托"},null,8,["modelValue","onUpdate:modelValue"])])],64)}const Ge=W(ve,[["render",Se],["__scopeId","data-v-4b25b688"],["__file","XMapViewWidget.vue"]]);export{Ge as default};
