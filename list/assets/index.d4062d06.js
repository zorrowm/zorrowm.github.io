import{d as C,I as b,r as w,J as B,L as M,f as R,Y as F,q as D,n as P,B as i,u as k,i as v,b as U,M as V,j as l,w as u,N as T,t as S,c as I,R as O,X as E,T as L,U as A,W as N,Z as W,a0 as $}from"./vendor.74212744.js";import{_ as q}from"./logo.a5e5eb92.js";import{_ as X}from"./index.a372dc25.js";import"./expansion-moment.3d0a52e0.js";import"./expansion-axios.5452c070.js";const Y=C({setup(){const e=i.t,s=b({username:"",password:""}),m=w(),f=w(),y=w("\u7EDF\u4E00\u7528\u6237\u9A8C\u8BC1\u670D\u52A1"),c=B(),p=M();let t=d();console.log(t,"011111111111");let r;function d(){let n=document.URL.indexOf("redirect=");if(n>0)return document.URL.substring(n+9)}const g=async()=>{if(s.username.trim()===""||s.password.trim()=="")return i.Message?.warn(e("sys.login.loginEmtyWarnInfo"));let n={username:s.username.trim(),pwd:O.MD5(s.password)};const o=await E(n);if(!o){i.Message?.warn(e("sys.login.loginFailTitle"));return}if(o.isSuccess){const a=d()||"/";if(c)if(console.log(a,"toPath"),a.startsWith("http://")||a.startsWith("https://")){const h=k();window.open(a+"?tk="+h.token,"_self")}else c.replace(a).then(h=>{p.name=="login"&&c.replace("/")});i.Message?.msg(e("sys.login.loginSuccessTitle"))}else i.Message?.warn(o.ResultDescription||e("sys.login.loginFailTitle"))};R(async()=>{if(t=d(),console.log(t,"11111111111"),t&&(r=p.query?.tk?.toString()),r){console.log("\u8FDB\u884C\u9A8C\u8BC1token!!!");const n=await F(r);console.log(n,"\u8F93\u51FAcheckToken\u7684\u7ED3\u679C00");const o=n?.data;if(o)if(o.isSuccess){D(o.resultValue),P(o.resultValue.doubleToken),i.Message?.msg(e("sys.login.loginSuccessTitle"));const a=k();a&&(t?.indexOf("?")>0?t+="&tk="+a.token:t+="?tk="+a.token,c.replace(t).then(h=>{p.name=="login"&&c.replace("/")}))}else i.Message?.warn(e("sys.login.loginTokenFailInfo"))}});function _(){m.value&&(m.value.placeholder=e("sys.login.accountPlaceholder")),f.value&&(f.value.placeholder=e("sys.login.passwordPlaceholder"))}return{t:e,formState:s,onblur:_,nameInput:m,pwdInput:f,systemTitle:y,handleSubmit:g}}}),j={class:"bgc-image"},x=T("img",{src:q,alt:"",class:"logo"},null,-1),J={style:{"text-align":"center"}};function Q(e,s,m,f,y,c){const p=v("UserOutlined"),t=L,r=A,d=v("LockOutlined"),g=N,_=W,n=$;return U(),V("div",j,[x,l(n,{class:"login-view",ref:"formRef",model:e.formState,rules:e.rules},{default:u(()=>[T("p",J,S(e.systemTitle),1),l(r,{name:"username",ref:"name"},{default:u(()=>[l(t,{placeholder:e.t("sys.login.accountPlaceholder"),class:"login-input",value:e.formState.username,"onUpdate:value":s[0]||(s[0]=o=>e.formState.username=o)},{prefix:u(()=>[l(p,{style:{color:"rgba(0, 0, 0, 0.5)"}})]),_:1},8,["placeholder","value"])]),_:1},512),l(r,{name:"password"},{default:u(()=>[l(g,{placeholder:e.t("sys.login.passwordPlaceholder"),class:"login-input",value:e.formState.password,"onUpdate:value":s[1]||(s[1]=o=>e.formState.password=o)},{prefix:u(()=>[l(d,{style:{color:"rgba(0, 0, 0, 0.5)"}})]),_:1},8,["placeholder","value"])]),_:1}),l(r,null,{default:u(()=>[l(_,{onClick:e.handleSubmit,class:"login-button"},{default:u(()=>[I(S(e.t("sys.login.loginButton")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}var ee=X(Y,[["render",Q]]);export{ee as default};
