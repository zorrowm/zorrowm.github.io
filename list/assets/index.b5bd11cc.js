import{d as T,I,r as f,B as a,J as M,L as b,u as h,V,f as P,Y as B,q as C,n as F,b as R,M as $,N as s,t as d,P as y,Q as w,R as q,X as D}from"./vendor.74212744.js";import{_ as U}from"./logo.a5e5eb92.js";import{_ as E}from"./index.a372dc25.js";import"./expansion-moment.3d0a52e0.js";import"./expansion-axios.5452c070.js";var N="./img/login/name.png",W="./img/login/password.png";const X=T({setup(){const e=a.t,o=I({username:"",password:""}),u=f(),p=f(),_=f(a.Config.UI?.SiteTitle),n=M(),t=b();let r=decodeURIComponent(t.query?.redirect||"/");const v=h();let g;if(v){V(v),n&&n.replace(r).then(c=>{t.name=="login"&&n.replace("/")});return}const k=async()=>{if(o.username.trim()===""||o.password.trim()=="")return a.Message?.warn(e("sys.login.loginEmtyWarnInfo"));let c={username:o.username.trim(),pwd:q.MD5(o.password)};const l=await D(c);if(!l){a.Message?.warn(e("sys.login.loginFailTitle"));return}if(l.isSuccess){const i=decodeURIComponent(t.query?.redirect||"/");if(n)if(console.log(i,"toPath"),i.startsWith("http://")||i.startsWith("https://")){const m=h();window.open(i+"#/?tk="+m.token,"_self")}else n.replace(i).then(m=>{t.name=="login"&&n.replace("/")});a.Message?.msg(e("sys.login.loginSuccessTitle"))}else a.Message?.warn(l.ResultDescription||e("sys.login.loginFailTitle"))};P(async()=>{if(r&&(g=t.query?.tk?.toString()),g){const c=await B(g);console.log(c,"\u8F93\u51FAcheckToken\u7684\u7ED3\u679C00");const l=c?.data;if(l)if(l.isSuccess){C(l.resultValue),F(l.resultValue.doubleToken),a.Message?.msg(e("sys.login.loginSuccessTitle"));const i=h();i&&(r?.indexOf("?")>0?r+="&tk="+i.token:r+="?tk="+i.token,n.replace(r).then(m=>{t.name=="login"&&n.replace("/")}))}else a.Message?.warn(e("sys.login.loginTokenFailInfo"))}});function S(){u.value&&(u.value.placeholder=e("sys.login.accountPlaceholder")),p.value&&(p.value.placeholder=e("sys.login.passwordPlaceholder"))}return{formState:o,systemTitle:_,handleSubmit:k,t:e,onblur:S,nameInput:u,pwdInput:p}}}),Y={class:"container"},A={class:"login-logo"},J=s("img",{src:U,alt:""},null,-1),L={class:"login-title"},O={class:"login"},Q={class:"login-top"},j={class:"login-center clearfix"},z=s("div",{class:"login-center-img"},[s("img",{src:N})],-1),G={class:"login-center-input"},H=["placeholder"],K={class:"login-center-input-text"},Z={class:"login-center clearfix"},x=s("div",{class:"login-center-img"},[s("img",{src:W})],-1),ee={class:"login-center-input"},se=["placeholder"],oe={class:"login-center-input-text"};function te(e,o,u,p,_,n){return R(),$("div",Y,[s("div",A,[J,s("span",L,d(e.systemTitle),1)]),s("div",O,[s("div",Q,d(e.t("sys.login.signInFormTitle")),1),s("div",j,[z,s("div",G,[y(s("input",{ref:"nameInput",type:"text",placeholder:e.t("sys.login.accountPlaceholder"),onfocus:"this.placeholder=''",onBlur:o[0]||(o[0]=t=>e.onblur()),"onUpdate:modelValue":o[1]||(o[1]=t=>e.formState.username=t)},null,40,H),[[w,e.formState.username]]),s("div",K,d(e.t("sys.login.userName")),1)])]),s("div",Z,[x,s("div",ee,[y(s("input",{ref:"pwdInput",type:"password",placeholder:e.t("sys.login.passwordPlaceholder"),onfocus:"this.placeholder=''",onBlur:o[2]||(o[2]=t=>e.onblur()),"onUpdate:modelValue":o[3]||(o[3]=t=>e.formState.password=t)},null,40,se),[[w,e.formState.password]]),s("div",oe,d(e.t("sys.login.password")),1)])]),s("div",{class:"login-button",onClick:o[4]||(o[4]=(...t)=>e.handleSubmit&&e.handleSubmit(...t))},d(e.t("sys.login.loginButton")),1)])])}var ce=E(X,[["render",te]]);export{ce as default};
