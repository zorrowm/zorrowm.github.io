import{o as C}from"./domTool-Dunoo3KF.js";import{l as V}from"./xframelib-exp-BHnis-8Y.js";import{d as k,a as A,r as w,l as x,w as F,aa as H,W as d,x as c,a6 as q,L as P}from"./@vue-exp-BMz8X7Pi.js";function B(a,l="default",p){if(!a||!Reflect.has(a,l)||!V(a[l]))return null;const m=a[l];return m?m(p):null}const L={value:{type:Boolean,default:!1},isSlot:{type:Boolean,default:!1},text:{type:[String],default:"请按住滑块拖动"},successText:{type:[String],default:"验证通过"},height:{type:[Number,String],default:40},width:{type:[Number,String],default:220},circle:{type:Boolean,default:!1},wrapStyle:{type:Object,default:()=>({})},contentStyle:{type:Object,default:()=>({})},barStyle:{type:Object,default:()=>({})},actionStyle:{type:Object,default:()=>({})}};({...L});const K=k({name:"BaseDargVerify",props:L,emits:["success","update:value","change","start","move","end"],setup(a,{emit:l,slots:p,expose:m}){const n=A({isMoving:!1,isPassing:!1,moveDistance:0,toLeft:!1,startTime:0,endTime:0}),O=w(null),v=w(null),S=w(null),h=w(null);C(document,"mouseup",()=>{n.isMoving&&g()});const W=x(()=>{const{height:t,actionStyle:s}=a,o=`${parseInt(t)}px`;return{left:0,width:o,height:o,...s}}),j=x(()=>{const{height:t,width:s,circle:o,wrapStyle:e}=a,i=parseInt(t);return{width:`${parseInt(s)}px`,height:`${i}px`,lineHeight:`${i}px`,borderRadius:o?i/2+"px":0,...e}}),X=x(()=>{const{height:t,circle:s,barStyle:o}=a,e=parseInt(t);return{height:`${e}px`,borderRadius:s?e/2+"px 0 0 "+e/2+"px":0,...o}}),D=x(()=>{const{height:t,width:s,contentStyle:o}=a,e=`${parseInt(t)}px`,i=`${parseInt(s)}px`;return{height:e,width:i,...o}});F(()=>n.isPassing,t=>{if(t){const{startTime:s,endTime:o}=n,e=(o-s)/1e3;l("success",{isPassing:t,time:e.toFixed(1)}),l("update:value",t),l("change",t)}}),H(()=>{n.isPassing=!!a.value});function b(t){return t.pageX||t.touches[0].pageX}function E(t){if(n.isPassing)return;const s=c(h);s&&(l("start",t),n.moveDistance=b(t)-parseInt(s.style.left.replace("px",""),10),n.startTime=new Date().getTime(),n.isMoving=!0)}function $(t){const s=parseInt(t.style.width),{width:o}=a,e=parseInt(o);return{offset:e-s-6,widthNum:e,actionWidth:s}}function I(t){const{isMoving:s,moveDistance:o}=n;if(s){const e=c(h),i=c(v);if(!e||!i)return;const{offset:r,widthNum:u,actionWidth:y}=$(e),f=b(t)-o;l("move",{event:t,moveDistance:o,moveX:f}),f>0&&f<=r?(e.style.left=`${f}px`,i.style.width=`${f+y/2}px`):f>r&&(e.style.left=`${u-y}px`,i.style.width=`${u-y/2}px`,a.isSlot||M())}}function T(t){const{isMoving:s,isPassing:o,moveDistance:e}=n;if(s&&!o){l("end",t);const i=c(h),r=c(v);if(!i||!r)return;const u=b(t)-e,{offset:y,widthNum:f,actionWidth:N}=$(i);u<y?a.isSlot?setTimeout(()=>{if(!a.value)g();else{const R=c(S);R&&(R.style.width=`${parseInt(r.style.width)}px`)}},0):g():(i.style.left=`${f-N}px`,r.style.width=`${f-N/2}px`,M()),n.isMoving=!1}}function M(){if(a.isSlot){g();return}n.endTime=new Date().getTime(),n.isPassing=!0,n.isMoving=!1}function g(){n.isMoving=!1,n.isPassing=!1,n.moveDistance=0,n.toLeft=!1,n.startTime=0,n.endTime=0;const t=c(h),s=c(v),o=c(S);!t||!s||!o||(n.toLeft=!0,setTimeout(()=>{n.toLeft=!1,t.style.left="0",s.style.width="0"},300),o.style.width=c(D).width)}return m({resume:g}),()=>{const t=()=>{const e=["darg-verify-bar"];return n.toLeft&&e.push("to-left"),d("div",{class:e,ref:v,style:c(X)},[q(" ")])},s=()=>{const e=["darg-verify-content"],{isPassing:i}=n,{text:r,successText:u}=a;return i&&e.push("success"),d("div",{class:e,ref:S,style:c(D)},[B(p,"text",i)||(i?u:r)])},o=()=>{const e=["darg-verify-action"],{toLeft:i,isPassing:r}=n;return i&&e.push("to-left"),d("div",{class:e,onMousedown:E,onTouchstart:E,style:c(W),ref:h},[B(p,"actionIcon",r)||(r?d(P("Icon"),{icon:"ant-design:check-outlined",color:"#666"},null):d(P("Icon"),{icon:"ant-design:double-right-outlined",color:"#666"},null))])};return d("div",{class:"darg-verify",ref:O,style:c(j),onMousemove:I,onTouchmove:I,onMouseleave:T,onMouseup:T,onTouchend:T},[t(),s(),o()])}}});export{K as B};
